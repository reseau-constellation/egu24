function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["assets/index-CQxI6A9X.js","assets/index-DtVrj2pT.js","assets/index-BljJQh6Q.js","assets/os-LYVib_3U.js","assets/index-CqGV8aGV.js"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const S of document.querySelectorAll('link[rel="modulepreload"]'))E(S);new MutationObserver(S=>{for(const C of S)if(C.type==="childList")for(const A of C.addedNodes)A.tagName==="LINK"&&A.rel==="modulepreload"&&E(A)}).observe(document,{childList:!0,subtree:!0});function _(S){const C={};return S.integrity&&(C.integrity=S.integrity),S.referrerPolicy&&(C.referrerPolicy=S.referrerPolicy),S.crossOrigin==="use-credentials"?C.credentials="include":S.crossOrigin==="anonymous"?C.credentials="omit":C.credentials="same-origin",C}function E(S){if(S.ep)return;S.ep=!0;const C=_(S);fetch(S.href,C)}})();const global$1=typeof global<"u"?global:typeof self<"u"?self:typeof window<"u"?window:{};function defaultSetTimout$1(){throw new Error("setTimeout has not been defined")}function defaultClearTimeout$1(){throw new Error("clearTimeout has not been defined")}var cachedSetTimeout$1=defaultSetTimout$1,cachedClearTimeout$1=defaultClearTimeout$1;typeof global$1.setTimeout=="function"&&(cachedSetTimeout$1=setTimeout);typeof global$1.clearTimeout=="function"&&(cachedClearTimeout$1=clearTimeout);function runTimeout$1(n){if(cachedSetTimeout$1===setTimeout)return setTimeout(n,0);if((cachedSetTimeout$1===defaultSetTimout$1||!cachedSetTimeout$1)&&setTimeout)return cachedSetTimeout$1=setTimeout,setTimeout(n,0);try{return cachedSetTimeout$1(n,0)}catch{try{return cachedSetTimeout$1.call(null,n,0)}catch{return cachedSetTimeout$1.call(this,n,0)}}}function runClearTimeout$1(n){if(cachedClearTimeout$1===clearTimeout)return clearTimeout(n);if((cachedClearTimeout$1===defaultClearTimeout$1||!cachedClearTimeout$1)&&clearTimeout)return cachedClearTimeout$1=clearTimeout,clearTimeout(n);try{return cachedClearTimeout$1(n)}catch{try{return cachedClearTimeout$1.call(null,n)}catch{return cachedClearTimeout$1.call(this,n)}}}var queue$2=[],draining$1=!1,currentQueue$1,queueIndex$1=-1;function cleanUpNextTick$1(){!draining$1||!currentQueue$1||(draining$1=!1,currentQueue$1.length?queue$2=currentQueue$1.concat(queue$2):queueIndex$1=-1,queue$2.length&&drainQueue$1())}function drainQueue$1(){if(!draining$1){var n=runTimeout$1(cleanUpNextTick$1);draining$1=!0;for(var r=queue$2.length;r;){for(currentQueue$1=queue$2,queue$2=[];++queueIndex$1<r;)currentQueue$1&&currentQueue$1[queueIndex$1].run();queueIndex$1=-1,r=queue$2.length}currentQueue$1=null,draining$1=!1,runClearTimeout$1(n)}}function nextTick$4(n){var r=new Array(arguments.length-1);if(arguments.length>1)for(var _=1;_<arguments.length;_++)r[_-1]=arguments[_];queue$2.push(new Item$1(n,r)),queue$2.length===1&&!draining$1&&runTimeout$1(drainQueue$1)}function Item$1(n,r){this.fun=n,this.array=r}Item$1.prototype.run=function(){this.fun.apply(null,this.array)};var title$2="browser",platform$4="browser",browser$h=!0,env$1={},argv$1=[],version$7="",versions$1={},release$1={},config$1={};function noop$8(){}var on$1=noop$8,addListener$1=noop$8,once$2=noop$8,off$1=noop$8,removeListener$1=noop$8,removeAllListeners$1=noop$8,emit$2=noop$8;function binding$1(n){throw new Error("process.binding is not supported")}function cwd$1(){return"/"}function chdir$1(n){throw new Error("process.chdir is not supported")}function umask$1(){return 0}var performance$2=global$1.performance||{},performanceNow$1=performance$2.now||performance$2.mozNow||performance$2.msNow||performance$2.oNow||performance$2.webkitNow||function(){return new Date().getTime()};function hrtime$1(n){var r=performanceNow$1.call(performance$2)*.001,_=Math.floor(r),E=Math.floor(r%1*1e9);return n&&(_=_-n[0],E=E-n[1],E<0&&(_--,E+=1e9)),[_,E]}var startTime$1=new Date;function uptime$1(){var n=new Date,r=n-startTime$1;return r/1e3}var browser$1$2={nextTick:nextTick$4,title:title$2,browser:browser$h,env:env$1,argv:argv$1,version:version$7,versions:versions$1,on:on$1,addListener:addListener$1,once:once$2,off:off$1,removeListener:removeListener$1,removeAllListeners:removeAllListeners$1,emit:emit$2,binding:binding$1,cwd:cwd$1,chdir:chdir$1,umask:umask$1,hrtime:hrtime$1,platform:platform$4,release:release$1,config:config$1,uptime:uptime$1},commonjsGlobal=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function getDefaultExportFromCjs(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}function getAugmentedNamespace(n){if(n.__esModule)return n;var r=n.default;if(typeof r=="function"){var _=function E(){return this instanceof E?Reflect.construct(r,arguments,this.constructor):r.apply(this,arguments)};_.prototype=r.prototype}else _={};return Object.defineProperty(_,"__esModule",{value:!0}),Object.keys(n).forEach(function(E){var S=Object.getOwnPropertyDescriptor(n,E);Object.defineProperty(_,E,S.get?S:{enumerable:!0,get:function(){return n[E]}})}),_}var buffer$2={},base64Js={};base64Js.byteLength=byteLength$2;base64Js.toByteArray=toByteArray$1;base64Js.fromByteArray=fromByteArray$1;var lookup$2=[],revLookup$1=[],Arr$1=typeof Uint8Array<"u"?Uint8Array:Array,code$9="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(var i=0,len=code$9.length;i<len;++i)lookup$2[i]=code$9[i],revLookup$1[code$9.charCodeAt(i)]=i;revLookup$1[45]=62;revLookup$1[95]=63;function getLens(n){var r=n.length;if(r%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var _=n.indexOf("=");_===-1&&(_=r);var E=_===r?0:4-_%4;return[_,E]}function byteLength$2(n){var r=getLens(n),_=r[0],E=r[1];return(_+E)*3/4-E}function _byteLength(n,r,_){return(r+_)*3/4-_}function toByteArray$1(n){var r,_=getLens(n),E=_[0],S=_[1],C=new Arr$1(_byteLength(n,E,S)),A=0,I=S>0?E-4:E,B;for(B=0;B<I;B+=4)r=revLookup$1[n.charCodeAt(B)]<<18|revLookup$1[n.charCodeAt(B+1)]<<12|revLookup$1[n.charCodeAt(B+2)]<<6|revLookup$1[n.charCodeAt(B+3)],C[A++]=r>>16&255,C[A++]=r>>8&255,C[A++]=r&255;return S===2&&(r=revLookup$1[n.charCodeAt(B)]<<2|revLookup$1[n.charCodeAt(B+1)]>>4,C[A++]=r&255),S===1&&(r=revLookup$1[n.charCodeAt(B)]<<10|revLookup$1[n.charCodeAt(B+1)]<<4|revLookup$1[n.charCodeAt(B+2)]>>2,C[A++]=r>>8&255,C[A++]=r&255),C}function tripletToBase64$1(n){return lookup$2[n>>18&63]+lookup$2[n>>12&63]+lookup$2[n>>6&63]+lookup$2[n&63]}function encodeChunk$1(n,r,_){for(var E,S=[],C=r;C<_;C+=3)E=(n[C]<<16&16711680)+(n[C+1]<<8&65280)+(n[C+2]&255),S.push(tripletToBase64$1(E));return S.join("")}function fromByteArray$1(n){for(var r,_=n.length,E=_%3,S=[],C=16383,A=0,I=_-E;A<I;A+=C)S.push(encodeChunk$1(n,A,A+C>I?I:A+C));return E===1?(r=n[_-1],S.push(lookup$2[r>>2]+lookup$2[r<<4&63]+"==")):E===2&&(r=(n[_-2]<<8)+n[_-1],S.push(lookup$2[r>>10]+lookup$2[r>>4&63]+lookup$2[r<<2&63]+"=")),S.join("")}var ieee754={};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */ieee754.read=function(n,r,_,E,S){var C,A,I=S*8-E-1,B=(1<<I)-1,O=B>>1,N=-7,U=_?S-1:0,j=_?-1:1,z=n[r+U];for(U+=j,C=z&(1<<-N)-1,z>>=-N,N+=I;N>0;C=C*256+n[r+U],U+=j,N-=8);for(A=C&(1<<-N)-1,C>>=-N,N+=E;N>0;A=A*256+n[r+U],U+=j,N-=8);if(C===0)C=1-O;else{if(C===B)return A?NaN:(z?-1:1)*(1/0);A=A+Math.pow(2,E),C=C-O}return(z?-1:1)*A*Math.pow(2,C-E)};ieee754.write=function(n,r,_,E,S,C){var A,I,B,O=C*8-S-1,N=(1<<O)-1,U=N>>1,j=S===23?Math.pow(2,-24)-Math.pow(2,-77):0,z=E?0:C-1,Z=E?1:-1,X=r<0||r===0&&1/r<0?1:0;for(r=Math.abs(r),isNaN(r)||r===1/0?(I=isNaN(r)?1:0,A=N):(A=Math.floor(Math.log(r)/Math.LN2),r*(B=Math.pow(2,-A))<1&&(A--,B*=2),A+U>=1?r+=j/B:r+=j*Math.pow(2,1-U),r*B>=2&&(A++,B/=2),A+U>=N?(I=0,A=N):A+U>=1?(I=(r*B-1)*Math.pow(2,S),A=A+U):(I=r*Math.pow(2,U-1)*Math.pow(2,S),A=0));S>=8;n[_+z]=I&255,z+=Z,I/=256,S-=8);for(A=A<<S|I,O+=S;O>0;n[_+z]=A&255,z+=Z,A/=256,O-=8);n[_+z-Z]|=X*128};/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */(function(n){const r=base64Js,_=ieee754,E=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;n.Buffer=I,n.SlowBuffer=oe,n.INSPECT_MAX_BYTES=50;const S=2147483647;n.kMaxLength=S,I.TYPED_ARRAY_SUPPORT=C(),!I.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function C(){try{const xt=new Uint8Array(1),pt={foo:function(){return 42}};return Object.setPrototypeOf(pt,Uint8Array.prototype),Object.setPrototypeOf(xt,pt),xt.foo()===42}catch{return!1}}Object.defineProperty(I.prototype,"parent",{enumerable:!0,get:function(){if(I.isBuffer(this))return this.buffer}}),Object.defineProperty(I.prototype,"offset",{enumerable:!0,get:function(){if(I.isBuffer(this))return this.byteOffset}});function A(xt){if(xt>S)throw new RangeError('The value "'+xt+'" is invalid for option "size"');const pt=new Uint8Array(xt);return Object.setPrototypeOf(pt,I.prototype),pt}function I(xt,pt,yt){if(typeof xt=="number"){if(typeof pt=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return U(xt)}return B(xt,pt,yt)}I.poolSize=8192;function B(xt,pt,yt){if(typeof xt=="string")return j(xt,pt);if(ArrayBuffer.isView(xt))return Z(xt);if(xt==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof xt);if(Mt(xt,ArrayBuffer)||xt&&Mt(xt.buffer,ArrayBuffer)||typeof SharedArrayBuffer<"u"&&(Mt(xt,SharedArrayBuffer)||xt&&Mt(xt.buffer,SharedArrayBuffer)))return X(xt,pt,yt);if(typeof xt=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');const Bt=xt.valueOf&&xt.valueOf();if(Bt!=null&&Bt!==xt)return I.from(Bt,pt,yt);const Ht=Q(xt);if(Ht)return Ht;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof xt[Symbol.toPrimitive]=="function")return I.from(xt[Symbol.toPrimitive]("string"),pt,yt);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof xt)}I.from=function(xt,pt,yt){return B(xt,pt,yt)},Object.setPrototypeOf(I.prototype,Uint8Array.prototype),Object.setPrototypeOf(I,Uint8Array);function O(xt){if(typeof xt!="number")throw new TypeError('"size" argument must be of type number');if(xt<0)throw new RangeError('The value "'+xt+'" is invalid for option "size"')}function N(xt,pt,yt){return O(xt),xt<=0?A(xt):pt!==void 0?typeof yt=="string"?A(xt).fill(pt,yt):A(xt).fill(pt):A(xt)}I.alloc=function(xt,pt,yt){return N(xt,pt,yt)};function U(xt){return O(xt),A(xt<0?0:se(xt)|0)}I.allocUnsafe=function(xt){return U(xt)},I.allocUnsafeSlow=function(xt){return U(xt)};function j(xt,pt){if((typeof pt!="string"||pt==="")&&(pt="utf8"),!I.isEncoding(pt))throw new TypeError("Unknown encoding: "+pt);const yt=ue(xt,pt)|0;let Bt=A(yt);const Ht=Bt.write(xt,pt);return Ht!==yt&&(Bt=Bt.slice(0,Ht)),Bt}function z(xt){const pt=xt.length<0?0:se(xt.length)|0,yt=A(pt);for(let Bt=0;Bt<pt;Bt+=1)yt[Bt]=xt[Bt]&255;return yt}function Z(xt){if(Mt(xt,Uint8Array)){const pt=new Uint8Array(xt);return X(pt.buffer,pt.byteOffset,pt.byteLength)}return z(xt)}function X(xt,pt,yt){if(pt<0||xt.byteLength<pt)throw new RangeError('"offset" is outside of buffer bounds');if(xt.byteLength<pt+(yt||0))throw new RangeError('"length" is outside of buffer bounds');let Bt;return pt===void 0&&yt===void 0?Bt=new Uint8Array(xt):yt===void 0?Bt=new Uint8Array(xt,pt):Bt=new Uint8Array(xt,pt,yt),Object.setPrototypeOf(Bt,I.prototype),Bt}function Q(xt){if(I.isBuffer(xt)){const pt=se(xt.length)|0,yt=A(pt);return yt.length===0||xt.copy(yt,0,0,pt),yt}if(xt.length!==void 0)return typeof xt.length!="number"||Wt(xt.length)?A(0):z(xt);if(xt.type==="Buffer"&&Array.isArray(xt.data))return z(xt.data)}function se(xt){if(xt>=S)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+S.toString(16)+" bytes");return xt|0}function oe(xt){return+xt!=xt&&(xt=0),I.alloc(+xt)}I.isBuffer=function(pt){return pt!=null&&pt._isBuffer===!0&&pt!==I.prototype},I.compare=function(pt,yt){if(Mt(pt,Uint8Array)&&(pt=I.from(pt,pt.offset,pt.byteLength)),Mt(yt,Uint8Array)&&(yt=I.from(yt,yt.offset,yt.byteLength)),!I.isBuffer(pt)||!I.isBuffer(yt))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(pt===yt)return 0;let Bt=pt.length,Ht=yt.length;for(let nr=0,Qt=Math.min(Bt,Ht);nr<Qt;++nr)if(pt[nr]!==yt[nr]){Bt=pt[nr],Ht=yt[nr];break}return Bt<Ht?-1:Ht<Bt?1:0},I.isEncoding=function(pt){switch(String(pt).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},I.concat=function(pt,yt){if(!Array.isArray(pt))throw new TypeError('"list" argument must be an Array of Buffers');if(pt.length===0)return I.alloc(0);let Bt;if(yt===void 0)for(yt=0,Bt=0;Bt<pt.length;++Bt)yt+=pt[Bt].length;const Ht=I.allocUnsafe(yt);let nr=0;for(Bt=0;Bt<pt.length;++Bt){let Qt=pt[Bt];if(Mt(Qt,Uint8Array))nr+Qt.length>Ht.length?(I.isBuffer(Qt)||(Qt=I.from(Qt)),Qt.copy(Ht,nr)):Uint8Array.prototype.set.call(Ht,Qt,nr);else if(I.isBuffer(Qt))Qt.copy(Ht,nr);else throw new TypeError('"list" argument must be an Array of Buffers');nr+=Qt.length}return Ht};function ue(xt,pt){if(I.isBuffer(xt))return xt.length;if(ArrayBuffer.isView(xt)||Mt(xt,ArrayBuffer))return xt.byteLength;if(typeof xt!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof xt);const yt=xt.length,Bt=arguments.length>2&&arguments[2]===!0;if(!Bt&&yt===0)return 0;let Ht=!1;for(;;)switch(pt){case"ascii":case"latin1":case"binary":return yt;case"utf8":case"utf-8":return St(xt).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return yt*2;case"hex":return yt>>>1;case"base64":return Ft(xt).length;default:if(Ht)return Bt?-1:St(xt).length;pt=(""+pt).toLowerCase(),Ht=!0}}I.byteLength=ue;function we(xt,pt,yt){let Bt=!1;if((pt===void 0||pt<0)&&(pt=0),pt>this.length||((yt===void 0||yt>this.length)&&(yt=this.length),yt<=0)||(yt>>>=0,pt>>>=0,yt<=pt))return"";for(xt||(xt="utf8");;)switch(xt){case"hex":return je(this,pt,yt);case"utf8":case"utf-8":return _e(this,pt,yt);case"ascii":return Be(this,pt,yt);case"latin1":case"binary":return Ge(this,pt,yt);case"base64":return Ce(this,pt,yt);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Ve(this,pt,yt);default:if(Bt)throw new TypeError("Unknown encoding: "+xt);xt=(xt+"").toLowerCase(),Bt=!0}}I.prototype._isBuffer=!0;function Te(xt,pt,yt){const Bt=xt[pt];xt[pt]=xt[yt],xt[yt]=Bt}I.prototype.swap16=function(){const pt=this.length;if(pt%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let yt=0;yt<pt;yt+=2)Te(this,yt,yt+1);return this},I.prototype.swap32=function(){const pt=this.length;if(pt%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let yt=0;yt<pt;yt+=4)Te(this,yt,yt+3),Te(this,yt+1,yt+2);return this},I.prototype.swap64=function(){const pt=this.length;if(pt%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let yt=0;yt<pt;yt+=8)Te(this,yt,yt+7),Te(this,yt+1,yt+6),Te(this,yt+2,yt+5),Te(this,yt+3,yt+4);return this},I.prototype.toString=function(){const pt=this.length;return pt===0?"":arguments.length===0?_e(this,0,pt):we.apply(this,arguments)},I.prototype.toLocaleString=I.prototype.toString,I.prototype.equals=function(pt){if(!I.isBuffer(pt))throw new TypeError("Argument must be a Buffer");return this===pt?!0:I.compare(this,pt)===0},I.prototype.inspect=function(){let pt="";const yt=n.INSPECT_MAX_BYTES;return pt=this.toString("hex",0,yt).replace(/(.{2})/g,"$1 ").trim(),this.length>yt&&(pt+=" ... "),"<Buffer "+pt+">"},E&&(I.prototype[E]=I.prototype.inspect),I.prototype.compare=function(pt,yt,Bt,Ht,nr){if(Mt(pt,Uint8Array)&&(pt=I.from(pt,pt.offset,pt.byteLength)),!I.isBuffer(pt))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof pt);if(yt===void 0&&(yt=0),Bt===void 0&&(Bt=pt?pt.length:0),Ht===void 0&&(Ht=0),nr===void 0&&(nr=this.length),yt<0||Bt>pt.length||Ht<0||nr>this.length)throw new RangeError("out of range index");if(Ht>=nr&&yt>=Bt)return 0;if(Ht>=nr)return-1;if(yt>=Bt)return 1;if(yt>>>=0,Bt>>>=0,Ht>>>=0,nr>>>=0,this===pt)return 0;let Qt=nr-Ht,xr=Bt-yt;const kr=Math.min(Qt,xr),Sr=this.slice(Ht,nr),$r=pt.slice(yt,Bt);for(let Rr=0;Rr<kr;++Rr)if(Sr[Rr]!==$r[Rr]){Qt=Sr[Rr],xr=$r[Rr];break}return Qt<xr?-1:xr<Qt?1:0};function xe(xt,pt,yt,Bt,Ht){if(xt.length===0)return-1;if(typeof yt=="string"?(Bt=yt,yt=0):yt>2147483647?yt=2147483647:yt<-2147483648&&(yt=-2147483648),yt=+yt,Wt(yt)&&(yt=Ht?0:xt.length-1),yt<0&&(yt=xt.length+yt),yt>=xt.length){if(Ht)return-1;yt=xt.length-1}else if(yt<0)if(Ht)yt=0;else return-1;if(typeof pt=="string"&&(pt=I.from(pt,Bt)),I.isBuffer(pt))return pt.length===0?-1:Re(xt,pt,yt,Bt,Ht);if(typeof pt=="number")return pt=pt&255,typeof Uint8Array.prototype.indexOf=="function"?Ht?Uint8Array.prototype.indexOf.call(xt,pt,yt):Uint8Array.prototype.lastIndexOf.call(xt,pt,yt):Re(xt,[pt],yt,Bt,Ht);throw new TypeError("val must be string, number or Buffer")}function Re(xt,pt,yt,Bt,Ht){let nr=1,Qt=xt.length,xr=pt.length;if(Bt!==void 0&&(Bt=String(Bt).toLowerCase(),Bt==="ucs2"||Bt==="ucs-2"||Bt==="utf16le"||Bt==="utf-16le")){if(xt.length<2||pt.length<2)return-1;nr=2,Qt/=2,xr/=2,yt/=2}function kr($r,Rr){return nr===1?$r[Rr]:$r.readUInt16BE(Rr*nr)}let Sr;if(Ht){let $r=-1;for(Sr=yt;Sr<Qt;Sr++)if(kr(xt,Sr)===kr(pt,$r===-1?0:Sr-$r)){if($r===-1&&($r=Sr),Sr-$r+1===xr)return $r*nr}else $r!==-1&&(Sr-=Sr-$r),$r=-1}else for(yt+xr>Qt&&(yt=Qt-xr),Sr=yt;Sr>=0;Sr--){let $r=!0;for(let Rr=0;Rr<xr;Rr++)if(kr(xt,Sr+Rr)!==kr(pt,Rr)){$r=!1;break}if($r)return Sr}return-1}I.prototype.includes=function(pt,yt,Bt){return this.indexOf(pt,yt,Bt)!==-1},I.prototype.indexOf=function(pt,yt,Bt){return xe(this,pt,yt,Bt,!0)},I.prototype.lastIndexOf=function(pt,yt,Bt){return xe(this,pt,yt,Bt,!1)};function Ne(xt,pt,yt,Bt){yt=Number(yt)||0;const Ht=xt.length-yt;Bt?(Bt=Number(Bt),Bt>Ht&&(Bt=Ht)):Bt=Ht;const nr=pt.length;Bt>nr/2&&(Bt=nr/2);let Qt;for(Qt=0;Qt<Bt;++Qt){const xr=parseInt(pt.substr(Qt*2,2),16);if(Wt(xr))return Qt;xt[yt+Qt]=xr}return Qt}function Fe(xt,pt,yt,Bt){return qt(St(pt,xt.length-yt),xt,yt,Bt)}function ht(xt,pt,yt,Bt){return qt($t(pt),xt,yt,Bt)}function nt(xt,pt,yt,Bt){return qt(Ft(pt),xt,yt,Bt)}function Ee(xt,pt,yt,Bt){return qt(kt(pt,xt.length-yt),xt,yt,Bt)}I.prototype.write=function(pt,yt,Bt,Ht){if(yt===void 0)Ht="utf8",Bt=this.length,yt=0;else if(Bt===void 0&&typeof yt=="string")Ht=yt,Bt=this.length,yt=0;else if(isFinite(yt))yt=yt>>>0,isFinite(Bt)?(Bt=Bt>>>0,Ht===void 0&&(Ht="utf8")):(Ht=Bt,Bt=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");const nr=this.length-yt;if((Bt===void 0||Bt>nr)&&(Bt=nr),pt.length>0&&(Bt<0||yt<0)||yt>this.length)throw new RangeError("Attempt to write outside buffer bounds");Ht||(Ht="utf8");let Qt=!1;for(;;)switch(Ht){case"hex":return Ne(this,pt,yt,Bt);case"utf8":case"utf-8":return Fe(this,pt,yt,Bt);case"ascii":case"latin1":case"binary":return ht(this,pt,yt,Bt);case"base64":return nt(this,pt,yt,Bt);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Ee(this,pt,yt,Bt);default:if(Qt)throw new TypeError("Unknown encoding: "+Ht);Ht=(""+Ht).toLowerCase(),Qt=!0}},I.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function Ce(xt,pt,yt){return pt===0&&yt===xt.length?r.fromByteArray(xt):r.fromByteArray(xt.slice(pt,yt))}function _e(xt,pt,yt){yt=Math.min(xt.length,yt);const Bt=[];let Ht=pt;for(;Ht<yt;){const nr=xt[Ht];let Qt=null,xr=nr>239?4:nr>223?3:nr>191?2:1;if(Ht+xr<=yt){let kr,Sr,$r,Rr;switch(xr){case 1:nr<128&&(Qt=nr);break;case 2:kr=xt[Ht+1],(kr&192)===128&&(Rr=(nr&31)<<6|kr&63,Rr>127&&(Qt=Rr));break;case 3:kr=xt[Ht+1],Sr=xt[Ht+2],(kr&192)===128&&(Sr&192)===128&&(Rr=(nr&15)<<12|(kr&63)<<6|Sr&63,Rr>2047&&(Rr<55296||Rr>57343)&&(Qt=Rr));break;case 4:kr=xt[Ht+1],Sr=xt[Ht+2],$r=xt[Ht+3],(kr&192)===128&&(Sr&192)===128&&($r&192)===128&&(Rr=(nr&15)<<18|(kr&63)<<12|(Sr&63)<<6|$r&63,Rr>65535&&Rr<1114112&&(Qt=Rr))}}Qt===null?(Qt=65533,xr=1):Qt>65535&&(Qt-=65536,Bt.push(Qt>>>10&1023|55296),Qt=56320|Qt&1023),Bt.push(Qt),Ht+=xr}return He(Bt)}const Ie=4096;function He(xt){const pt=xt.length;if(pt<=Ie)return String.fromCharCode.apply(String,xt);let yt="",Bt=0;for(;Bt<pt;)yt+=String.fromCharCode.apply(String,xt.slice(Bt,Bt+=Ie));return yt}function Be(xt,pt,yt){let Bt="";yt=Math.min(xt.length,yt);for(let Ht=pt;Ht<yt;++Ht)Bt+=String.fromCharCode(xt[Ht]&127);return Bt}function Ge(xt,pt,yt){let Bt="";yt=Math.min(xt.length,yt);for(let Ht=pt;Ht<yt;++Ht)Bt+=String.fromCharCode(xt[Ht]);return Bt}function je(xt,pt,yt){const Bt=xt.length;(!pt||pt<0)&&(pt=0),(!yt||yt<0||yt>Bt)&&(yt=Bt);let Ht="";for(let nr=pt;nr<yt;++nr)Ht+=Zt[xt[nr]];return Ht}function Ve(xt,pt,yt){const Bt=xt.slice(pt,yt);let Ht="";for(let nr=0;nr<Bt.length-1;nr+=2)Ht+=String.fromCharCode(Bt[nr]+Bt[nr+1]*256);return Ht}I.prototype.slice=function(pt,yt){const Bt=this.length;pt=~~pt,yt=yt===void 0?Bt:~~yt,pt<0?(pt+=Bt,pt<0&&(pt=0)):pt>Bt&&(pt=Bt),yt<0?(yt+=Bt,yt<0&&(yt=0)):yt>Bt&&(yt=Bt),yt<pt&&(yt=pt);const Ht=this.subarray(pt,yt);return Object.setPrototypeOf(Ht,I.prototype),Ht};function Pe(xt,pt,yt){if(xt%1!==0||xt<0)throw new RangeError("offset is not uint");if(xt+pt>yt)throw new RangeError("Trying to access beyond buffer length")}I.prototype.readUintLE=I.prototype.readUIntLE=function(pt,yt,Bt){pt=pt>>>0,yt=yt>>>0,Bt||Pe(pt,yt,this.length);let Ht=this[pt],nr=1,Qt=0;for(;++Qt<yt&&(nr*=256);)Ht+=this[pt+Qt]*nr;return Ht},I.prototype.readUintBE=I.prototype.readUIntBE=function(pt,yt,Bt){pt=pt>>>0,yt=yt>>>0,Bt||Pe(pt,yt,this.length);let Ht=this[pt+--yt],nr=1;for(;yt>0&&(nr*=256);)Ht+=this[pt+--yt]*nr;return Ht},I.prototype.readUint8=I.prototype.readUInt8=function(pt,yt){return pt=pt>>>0,yt||Pe(pt,1,this.length),this[pt]},I.prototype.readUint16LE=I.prototype.readUInt16LE=function(pt,yt){return pt=pt>>>0,yt||Pe(pt,2,this.length),this[pt]|this[pt+1]<<8},I.prototype.readUint16BE=I.prototype.readUInt16BE=function(pt,yt){return pt=pt>>>0,yt||Pe(pt,2,this.length),this[pt]<<8|this[pt+1]},I.prototype.readUint32LE=I.prototype.readUInt32LE=function(pt,yt){return pt=pt>>>0,yt||Pe(pt,4,this.length),(this[pt]|this[pt+1]<<8|this[pt+2]<<16)+this[pt+3]*16777216},I.prototype.readUint32BE=I.prototype.readUInt32BE=function(pt,yt){return pt=pt>>>0,yt||Pe(pt,4,this.length),this[pt]*16777216+(this[pt+1]<<16|this[pt+2]<<8|this[pt+3])},I.prototype.readBigUInt64LE=Yt(function(pt){pt=pt>>>0,Et(pt,"offset");const yt=this[pt],Bt=this[pt+7];(yt===void 0||Bt===void 0)&&Ye(pt,this.length-8);const Ht=yt+this[++pt]*2**8+this[++pt]*2**16+this[++pt]*2**24,nr=this[++pt]+this[++pt]*2**8+this[++pt]*2**16+Bt*2**24;return BigInt(Ht)+(BigInt(nr)<<BigInt(32))}),I.prototype.readBigUInt64BE=Yt(function(pt){pt=pt>>>0,Et(pt,"offset");const yt=this[pt],Bt=this[pt+7];(yt===void 0||Bt===void 0)&&Ye(pt,this.length-8);const Ht=yt*2**24+this[++pt]*2**16+this[++pt]*2**8+this[++pt],nr=this[++pt]*2**24+this[++pt]*2**16+this[++pt]*2**8+Bt;return(BigInt(Ht)<<BigInt(32))+BigInt(nr)}),I.prototype.readIntLE=function(pt,yt,Bt){pt=pt>>>0,yt=yt>>>0,Bt||Pe(pt,yt,this.length);let Ht=this[pt],nr=1,Qt=0;for(;++Qt<yt&&(nr*=256);)Ht+=this[pt+Qt]*nr;return nr*=128,Ht>=nr&&(Ht-=Math.pow(2,8*yt)),Ht},I.prototype.readIntBE=function(pt,yt,Bt){pt=pt>>>0,yt=yt>>>0,Bt||Pe(pt,yt,this.length);let Ht=yt,nr=1,Qt=this[pt+--Ht];for(;Ht>0&&(nr*=256);)Qt+=this[pt+--Ht]*nr;return nr*=128,Qt>=nr&&(Qt-=Math.pow(2,8*yt)),Qt},I.prototype.readInt8=function(pt,yt){return pt=pt>>>0,yt||Pe(pt,1,this.length),this[pt]&128?(255-this[pt]+1)*-1:this[pt]},I.prototype.readInt16LE=function(pt,yt){pt=pt>>>0,yt||Pe(pt,2,this.length);const Bt=this[pt]|this[pt+1]<<8;return Bt&32768?Bt|4294901760:Bt},I.prototype.readInt16BE=function(pt,yt){pt=pt>>>0,yt||Pe(pt,2,this.length);const Bt=this[pt+1]|this[pt]<<8;return Bt&32768?Bt|4294901760:Bt},I.prototype.readInt32LE=function(pt,yt){return pt=pt>>>0,yt||Pe(pt,4,this.length),this[pt]|this[pt+1]<<8|this[pt+2]<<16|this[pt+3]<<24},I.prototype.readInt32BE=function(pt,yt){return pt=pt>>>0,yt||Pe(pt,4,this.length),this[pt]<<24|this[pt+1]<<16|this[pt+2]<<8|this[pt+3]},I.prototype.readBigInt64LE=Yt(function(pt){pt=pt>>>0,Et(pt,"offset");const yt=this[pt],Bt=this[pt+7];(yt===void 0||Bt===void 0)&&Ye(pt,this.length-8);const Ht=this[pt+4]+this[pt+5]*2**8+this[pt+6]*2**16+(Bt<<24);return(BigInt(Ht)<<BigInt(32))+BigInt(yt+this[++pt]*2**8+this[++pt]*2**16+this[++pt]*2**24)}),I.prototype.readBigInt64BE=Yt(function(pt){pt=pt>>>0,Et(pt,"offset");const yt=this[pt],Bt=this[pt+7];(yt===void 0||Bt===void 0)&&Ye(pt,this.length-8);const Ht=(yt<<24)+this[++pt]*2**16+this[++pt]*2**8+this[++pt];return(BigInt(Ht)<<BigInt(32))+BigInt(this[++pt]*2**24+this[++pt]*2**16+this[++pt]*2**8+Bt)}),I.prototype.readFloatLE=function(pt,yt){return pt=pt>>>0,yt||Pe(pt,4,this.length),_.read(this,pt,!0,23,4)},I.prototype.readFloatBE=function(pt,yt){return pt=pt>>>0,yt||Pe(pt,4,this.length),_.read(this,pt,!1,23,4)},I.prototype.readDoubleLE=function(pt,yt){return pt=pt>>>0,yt||Pe(pt,8,this.length),_.read(this,pt,!0,52,8)},I.prototype.readDoubleBE=function(pt,yt){return pt=pt>>>0,yt||Pe(pt,8,this.length),_.read(this,pt,!1,52,8)};function Me(xt,pt,yt,Bt,Ht,nr){if(!I.isBuffer(xt))throw new TypeError('"buffer" argument must be a Buffer instance');if(pt>Ht||pt<nr)throw new RangeError('"value" argument is out of bounds');if(yt+Bt>xt.length)throw new RangeError("Index out of range")}I.prototype.writeUintLE=I.prototype.writeUIntLE=function(pt,yt,Bt,Ht){if(pt=+pt,yt=yt>>>0,Bt=Bt>>>0,!Ht){const xr=Math.pow(2,8*Bt)-1;Me(this,pt,yt,Bt,xr,0)}let nr=1,Qt=0;for(this[yt]=pt&255;++Qt<Bt&&(nr*=256);)this[yt+Qt]=pt/nr&255;return yt+Bt},I.prototype.writeUintBE=I.prototype.writeUIntBE=function(pt,yt,Bt,Ht){if(pt=+pt,yt=yt>>>0,Bt=Bt>>>0,!Ht){const xr=Math.pow(2,8*Bt)-1;Me(this,pt,yt,Bt,xr,0)}let nr=Bt-1,Qt=1;for(this[yt+nr]=pt&255;--nr>=0&&(Qt*=256);)this[yt+nr]=pt/Qt&255;return yt+Bt},I.prototype.writeUint8=I.prototype.writeUInt8=function(pt,yt,Bt){return pt=+pt,yt=yt>>>0,Bt||Me(this,pt,yt,1,255,0),this[yt]=pt&255,yt+1},I.prototype.writeUint16LE=I.prototype.writeUInt16LE=function(pt,yt,Bt){return pt=+pt,yt=yt>>>0,Bt||Me(this,pt,yt,2,65535,0),this[yt]=pt&255,this[yt+1]=pt>>>8,yt+2},I.prototype.writeUint16BE=I.prototype.writeUInt16BE=function(pt,yt,Bt){return pt=+pt,yt=yt>>>0,Bt||Me(this,pt,yt,2,65535,0),this[yt]=pt>>>8,this[yt+1]=pt&255,yt+2},I.prototype.writeUint32LE=I.prototype.writeUInt32LE=function(pt,yt,Bt){return pt=+pt,yt=yt>>>0,Bt||Me(this,pt,yt,4,4294967295,0),this[yt+3]=pt>>>24,this[yt+2]=pt>>>16,this[yt+1]=pt>>>8,this[yt]=pt&255,yt+4},I.prototype.writeUint32BE=I.prototype.writeUInt32BE=function(pt,yt,Bt){return pt=+pt,yt=yt>>>0,Bt||Me(this,pt,yt,4,4294967295,0),this[yt]=pt>>>24,this[yt+1]=pt>>>16,this[yt+2]=pt>>>8,this[yt+3]=pt&255,yt+4};function tt(xt,pt,yt,Bt,Ht){ft(pt,Bt,Ht,xt,yt,7);let nr=Number(pt&BigInt(4294967295));xt[yt++]=nr,nr=nr>>8,xt[yt++]=nr,nr=nr>>8,xt[yt++]=nr,nr=nr>>8,xt[yt++]=nr;let Qt=Number(pt>>BigInt(32)&BigInt(4294967295));return xt[yt++]=Qt,Qt=Qt>>8,xt[yt++]=Qt,Qt=Qt>>8,xt[yt++]=Qt,Qt=Qt>>8,xt[yt++]=Qt,yt}function Ke(xt,pt,yt,Bt,Ht){ft(pt,Bt,Ht,xt,yt,7);let nr=Number(pt&BigInt(4294967295));xt[yt+7]=nr,nr=nr>>8,xt[yt+6]=nr,nr=nr>>8,xt[yt+5]=nr,nr=nr>>8,xt[yt+4]=nr;let Qt=Number(pt>>BigInt(32)&BigInt(4294967295));return xt[yt+3]=Qt,Qt=Qt>>8,xt[yt+2]=Qt,Qt=Qt>>8,xt[yt+1]=Qt,Qt=Qt>>8,xt[yt]=Qt,yt+8}I.prototype.writeBigUInt64LE=Yt(function(pt,yt=0){return tt(this,pt,yt,BigInt(0),BigInt("0xffffffffffffffff"))}),I.prototype.writeBigUInt64BE=Yt(function(pt,yt=0){return Ke(this,pt,yt,BigInt(0),BigInt("0xffffffffffffffff"))}),I.prototype.writeIntLE=function(pt,yt,Bt,Ht){if(pt=+pt,yt=yt>>>0,!Ht){const kr=Math.pow(2,8*Bt-1);Me(this,pt,yt,Bt,kr-1,-kr)}let nr=0,Qt=1,xr=0;for(this[yt]=pt&255;++nr<Bt&&(Qt*=256);)pt<0&&xr===0&&this[yt+nr-1]!==0&&(xr=1),this[yt+nr]=(pt/Qt>>0)-xr&255;return yt+Bt},I.prototype.writeIntBE=function(pt,yt,Bt,Ht){if(pt=+pt,yt=yt>>>0,!Ht){const kr=Math.pow(2,8*Bt-1);Me(this,pt,yt,Bt,kr-1,-kr)}let nr=Bt-1,Qt=1,xr=0;for(this[yt+nr]=pt&255;--nr>=0&&(Qt*=256);)pt<0&&xr===0&&this[yt+nr+1]!==0&&(xr=1),this[yt+nr]=(pt/Qt>>0)-xr&255;return yt+Bt},I.prototype.writeInt8=function(pt,yt,Bt){return pt=+pt,yt=yt>>>0,Bt||Me(this,pt,yt,1,127,-128),pt<0&&(pt=255+pt+1),this[yt]=pt&255,yt+1},I.prototype.writeInt16LE=function(pt,yt,Bt){return pt=+pt,yt=yt>>>0,Bt||Me(this,pt,yt,2,32767,-32768),this[yt]=pt&255,this[yt+1]=pt>>>8,yt+2},I.prototype.writeInt16BE=function(pt,yt,Bt){return pt=+pt,yt=yt>>>0,Bt||Me(this,pt,yt,2,32767,-32768),this[yt]=pt>>>8,this[yt+1]=pt&255,yt+2},I.prototype.writeInt32LE=function(pt,yt,Bt){return pt=+pt,yt=yt>>>0,Bt||Me(this,pt,yt,4,2147483647,-2147483648),this[yt]=pt&255,this[yt+1]=pt>>>8,this[yt+2]=pt>>>16,this[yt+3]=pt>>>24,yt+4},I.prototype.writeInt32BE=function(pt,yt,Bt){return pt=+pt,yt=yt>>>0,Bt||Me(this,pt,yt,4,2147483647,-2147483648),pt<0&&(pt=4294967295+pt+1),this[yt]=pt>>>24,this[yt+1]=pt>>>16,this[yt+2]=pt>>>8,this[yt+3]=pt&255,yt+4},I.prototype.writeBigInt64LE=Yt(function(pt,yt=0){return tt(this,pt,yt,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),I.prototype.writeBigInt64BE=Yt(function(pt,yt=0){return Ke(this,pt,yt,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});function mt(xt,pt,yt,Bt,Ht,nr){if(yt+Bt>xt.length)throw new RangeError("Index out of range");if(yt<0)throw new RangeError("Index out of range")}function ct(xt,pt,yt,Bt,Ht){return pt=+pt,yt=yt>>>0,Ht||mt(xt,pt,yt,4),_.write(xt,pt,yt,Bt,23,4),yt+4}I.prototype.writeFloatLE=function(pt,yt,Bt){return ct(this,pt,yt,!0,Bt)},I.prototype.writeFloatBE=function(pt,yt,Bt){return ct(this,pt,yt,!1,Bt)};function Qe(xt,pt,yt,Bt,Ht){return pt=+pt,yt=yt>>>0,Ht||mt(xt,pt,yt,8),_.write(xt,pt,yt,Bt,52,8),yt+8}I.prototype.writeDoubleLE=function(pt,yt,Bt){return Qe(this,pt,yt,!0,Bt)},I.prototype.writeDoubleBE=function(pt,yt,Bt){return Qe(this,pt,yt,!1,Bt)},I.prototype.copy=function(pt,yt,Bt,Ht){if(!I.isBuffer(pt))throw new TypeError("argument should be a Buffer");if(Bt||(Bt=0),!Ht&&Ht!==0&&(Ht=this.length),yt>=pt.length&&(yt=pt.length),yt||(yt=0),Ht>0&&Ht<Bt&&(Ht=Bt),Ht===Bt||pt.length===0||this.length===0)return 0;if(yt<0)throw new RangeError("targetStart out of bounds");if(Bt<0||Bt>=this.length)throw new RangeError("Index out of range");if(Ht<0)throw new RangeError("sourceEnd out of bounds");Ht>this.length&&(Ht=this.length),pt.length-yt<Ht-Bt&&(Ht=pt.length-yt+Bt);const nr=Ht-Bt;return this===pt&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(yt,Bt,Ht):Uint8Array.prototype.set.call(pt,this.subarray(Bt,Ht),yt),nr},I.prototype.fill=function(pt,yt,Bt,Ht){if(typeof pt=="string"){if(typeof yt=="string"?(Ht=yt,yt=0,Bt=this.length):typeof Bt=="string"&&(Ht=Bt,Bt=this.length),Ht!==void 0&&typeof Ht!="string")throw new TypeError("encoding must be a string");if(typeof Ht=="string"&&!I.isEncoding(Ht))throw new TypeError("Unknown encoding: "+Ht);if(pt.length===1){const Qt=pt.charCodeAt(0);(Ht==="utf8"&&Qt<128||Ht==="latin1")&&(pt=Qt)}}else typeof pt=="number"?pt=pt&255:typeof pt=="boolean"&&(pt=Number(pt));if(yt<0||this.length<yt||this.length<Bt)throw new RangeError("Out of range index");if(Bt<=yt)return this;yt=yt>>>0,Bt=Bt===void 0?this.length:Bt>>>0,pt||(pt=0);let nr;if(typeof pt=="number")for(nr=yt;nr<Bt;++nr)this[nr]=pt;else{const Qt=I.isBuffer(pt)?pt:I.from(pt,Ht),xr=Qt.length;if(xr===0)throw new TypeError('The value "'+pt+'" is invalid for argument "value"');for(nr=0;nr<Bt-yt;++nr)this[nr+yt]=Qt[nr%xr]}return this};const dt={};function vt(xt,pt,yt){dt[xt]=class extends yt{constructor(){super(),Object.defineProperty(this,"message",{value:pt.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${xt}]`,this.stack,delete this.name}get code(){return xt}set code(Ht){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:Ht,writable:!0})}toString(){return`${this.name} [${xt}]: ${this.message}`}}}vt("ERR_BUFFER_OUT_OF_BOUNDS",function(xt){return xt?`${xt} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),vt("ERR_INVALID_ARG_TYPE",function(xt,pt){return`The "${xt}" argument must be of type number. Received type ${typeof pt}`},TypeError),vt("ERR_OUT_OF_RANGE",function(xt,pt,yt){let Bt=`The value of "${xt}" is out of range.`,Ht=yt;return Number.isInteger(yt)&&Math.abs(yt)>2**32?Ht=At(String(yt)):typeof yt=="bigint"&&(Ht=String(yt),(yt>BigInt(2)**BigInt(32)||yt<-(BigInt(2)**BigInt(32)))&&(Ht=At(Ht)),Ht+="n"),Bt+=` It must be ${pt}. Received ${Ht}`,Bt},RangeError);function At(xt){let pt="",yt=xt.length;const Bt=xt[0]==="-"?1:0;for(;yt>=Bt+4;yt-=3)pt=`_${xt.slice(yt-3,yt)}${pt}`;return`${xt.slice(0,yt)}${pt}`}function bt(xt,pt,yt){Et(pt,"offset"),(xt[pt]===void 0||xt[pt+yt]===void 0)&&Ye(pt,xt.length-(yt+1))}function ft(xt,pt,yt,Bt,Ht,nr){if(xt>yt||xt<pt){const Qt=typeof pt=="bigint"?"n":"";let xr;throw nr>3?pt===0||pt===BigInt(0)?xr=`>= 0${Qt} and < 2${Qt} ** ${(nr+1)*8}${Qt}`:xr=`>= -(2${Qt} ** ${(nr+1)*8-1}${Qt}) and < 2 ** ${(nr+1)*8-1}${Qt}`:xr=`>= ${pt}${Qt} and <= ${yt}${Qt}`,new dt.ERR_OUT_OF_RANGE("value",xr,xt)}bt(Bt,Ht,nr)}function Et(xt,pt){if(typeof xt!="number")throw new dt.ERR_INVALID_ARG_TYPE(pt,"number",xt)}function Ye(xt,pt,yt){throw Math.floor(xt)!==xt?(Et(xt,yt),new dt.ERR_OUT_OF_RANGE(yt||"offset","an integer",xt)):pt<0?new dt.ERR_BUFFER_OUT_OF_BOUNDS:new dt.ERR_OUT_OF_RANGE(yt||"offset",`>= ${yt?1:0} and <= ${pt}`,xt)}const Ct=/[^+/0-9A-Za-z-_]/g;function Pt(xt){if(xt=xt.split("=")[0],xt=xt.trim().replace(Ct,""),xt.length<2)return"";for(;xt.length%4!==0;)xt=xt+"=";return xt}function St(xt,pt){pt=pt||1/0;let yt;const Bt=xt.length;let Ht=null;const nr=[];for(let Qt=0;Qt<Bt;++Qt){if(yt=xt.charCodeAt(Qt),yt>55295&&yt<57344){if(!Ht){if(yt>56319){(pt-=3)>-1&&nr.push(239,191,189);continue}else if(Qt+1===Bt){(pt-=3)>-1&&nr.push(239,191,189);continue}Ht=yt;continue}if(yt<56320){(pt-=3)>-1&&nr.push(239,191,189),Ht=yt;continue}yt=(Ht-55296<<10|yt-56320)+65536}else Ht&&(pt-=3)>-1&&nr.push(239,191,189);if(Ht=null,yt<128){if((pt-=1)<0)break;nr.push(yt)}else if(yt<2048){if((pt-=2)<0)break;nr.push(yt>>6|192,yt&63|128)}else if(yt<65536){if((pt-=3)<0)break;nr.push(yt>>12|224,yt>>6&63|128,yt&63|128)}else if(yt<1114112){if((pt-=4)<0)break;nr.push(yt>>18|240,yt>>12&63|128,yt>>6&63|128,yt&63|128)}else throw new Error("Invalid code point")}return nr}function $t(xt){const pt=[];for(let yt=0;yt<xt.length;++yt)pt.push(xt.charCodeAt(yt)&255);return pt}function kt(xt,pt){let yt,Bt,Ht;const nr=[];for(let Qt=0;Qt<xt.length&&!((pt-=2)<0);++Qt)yt=xt.charCodeAt(Qt),Bt=yt>>8,Ht=yt%256,nr.push(Ht),nr.push(Bt);return nr}function Ft(xt){return r.toByteArray(Pt(xt))}function qt(xt,pt,yt,Bt){let Ht;for(Ht=0;Ht<Bt&&!(Ht+yt>=pt.length||Ht>=xt.length);++Ht)pt[Ht+yt]=xt[Ht];return Ht}function Mt(xt,pt){return xt instanceof pt||xt!=null&&xt.constructor!=null&&xt.constructor.name!=null&&xt.constructor.name===pt.name}function Wt(xt){return xt!==xt}const Zt=function(){const xt="0123456789abcdef",pt=new Array(256);for(let yt=0;yt<16;++yt){const Bt=yt*16;for(let Ht=0;Ht<16;++Ht)pt[Bt+Ht]=xt[yt]+xt[Ht]}return pt}();function Yt(xt){return typeof BigInt>"u"?ur:xt}function ur(){throw new Error("BigInt not supported")}})(buffer$2);window.Buffer=buffer$2.Buffer;window.process=browser$1$2;/**
* @vue/shared v3.4.21
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/function makeMap(n,r){const _=new Set(n.split(","));return r?E=>_.has(E.toLowerCase()):E=>_.has(E)}const EMPTY_OBJ={},EMPTY_ARR=[],NOOP=()=>{},NO=()=>!1,isOn$1=n=>n.charCodeAt(0)===111&&n.charCodeAt(1)===110&&(n.charCodeAt(2)>122||n.charCodeAt(2)<97),isModelListener=n=>n.startsWith("onUpdate:"),extend$2=Object.assign,remove$1=(n,r)=>{const _=n.indexOf(r);_>-1&&n.splice(_,1)},hasOwnProperty$5=Object.prototype.hasOwnProperty,hasOwn$3=(n,r)=>hasOwnProperty$5.call(n,r),isArray$6=Array.isArray,isMap$4=n=>toTypeString(n)==="[object Map]",isSet$4=n=>toTypeString(n)==="[object Set]",isFunction$2=n=>typeof n=="function",isString$5=n=>typeof n=="string",isSymbol$3=n=>typeof n=="symbol",isObject$2=n=>n!==null&&typeof n=="object",isPromise$6=n=>(isObject$2(n)||isFunction$2(n))&&isFunction$2(n.then)&&isFunction$2(n.catch),objectToString$1=Object.prototype.toString,toTypeString=n=>objectToString$1.call(n),toRawType=n=>toTypeString(n).slice(8,-1),isPlainObject$2=n=>toTypeString(n)==="[object Object]",isIntegerKey=n=>isString$5(n)&&n!=="NaN"&&n[0]!=="-"&&""+parseInt(n,10)===n,isReservedProp=makeMap(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),cacheStringFunction=n=>{const r=Object.create(null);return _=>r[_]||(r[_]=n(_))},camelizeRE=/-(\w)/g,camelize=cacheStringFunction(n=>n.replace(camelizeRE,(r,_)=>_?_.toUpperCase():"")),hyphenateRE=/\B([A-Z])/g,hyphenate=cacheStringFunction(n=>n.replace(hyphenateRE,"-$1").toLowerCase()),capitalize=cacheStringFunction(n=>n.charAt(0).toUpperCase()+n.slice(1)),toHandlerKey=cacheStringFunction(n=>n?`on${capitalize(n)}`:""),hasChanged=(n,r)=>!Object.is(n,r),invokeArrayFns=(n,r)=>{for(let _=0;_<n.length;_++)n[_](r)},def$t=(n,r,_)=>{Object.defineProperty(n,r,{configurable:!0,enumerable:!1,value:_})},looseToNumber=n=>{const r=parseFloat(n);return isNaN(r)?n:r},toNumber=n=>{const r=isString$5(n)?Number(n):NaN;return isNaN(r)?n:r};let _globalThis;const getGlobalThis=()=>_globalThis||(_globalThis=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global$1<"u"?global$1:{});function normalizeStyle(n){if(isArray$6(n)){const r={};for(let _=0;_<n.length;_++){const E=n[_],S=isString$5(E)?parseStringStyle(E):normalizeStyle(E);if(S)for(const C in S)r[C]=S[C]}return r}else if(isString$5(n)||isObject$2(n))return n}const listDelimiterRE=/;(?![^(]*\))/g,propertyDelimiterRE=/:([^]+)/,styleCommentRE=/\/\*[^]*?\*\//g;function parseStringStyle(n){const r={};return n.replace(styleCommentRE,"").split(listDelimiterRE).forEach(_=>{if(_){const E=_.split(propertyDelimiterRE);E.length>1&&(r[E[0].trim()]=E[1].trim())}}),r}function normalizeClass(n){let r="";if(isString$5(n))r=n;else if(isArray$6(n))for(let _=0;_<n.length;_++){const E=normalizeClass(n[_]);E&&(r+=E+" ")}else if(isObject$2(n))for(const _ in n)n[_]&&(r+=_+" ");return r.trim()}function normalizeProps(n){if(!n)return null;let{class:r,style:_}=n;return r&&!isString$5(r)&&(n.class=normalizeClass(r)),_&&(n.style=normalizeStyle(_)),n}const specialBooleanAttrs="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",isSpecialBooleanAttr=makeMap(specialBooleanAttrs);function includeBooleanAttr(n){return!!n||n===""}const toDisplayString=n=>isString$5(n)?n:n==null?"":isArray$6(n)||isObject$2(n)&&(n.toString===objectToString$1||!isFunction$2(n.toString))?JSON.stringify(n,replacer,2):String(n),replacer=(n,r)=>r&&r.__v_isRef?replacer(n,r.value):isMap$4(r)?{[`Map(${r.size})`]:[...r.entries()].reduce((_,[E,S],C)=>(_[stringifySymbol(E,C)+" =>"]=S,_),{})}:isSet$4(r)?{[`Set(${r.size})`]:[...r.values()].map(_=>stringifySymbol(_))}:isSymbol$3(r)?stringifySymbol(r):isObject$2(r)&&!isArray$6(r)&&!isPlainObject$2(r)?String(r):r,stringifySymbol=(n,r="")=>{var _;return isSymbol$3(n)?`Symbol(${(_=n.description)!=null?_:r})`:n};/**
* @vue/reactivity v3.4.21
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let activeEffectScope;class EffectScope{constructor(r=!1){this.detached=r,this._active=!0,this.effects=[],this.cleanups=[],this.parent=activeEffectScope,!r&&activeEffectScope&&(this.index=(activeEffectScope.scopes||(activeEffectScope.scopes=[])).push(this)-1)}get active(){return this._active}run(r){if(this._active){const _=activeEffectScope;try{return activeEffectScope=this,r()}finally{activeEffectScope=_}}}on(){activeEffectScope=this}off(){activeEffectScope=this.parent}stop(r){if(this._active){let _,E;for(_=0,E=this.effects.length;_<E;_++)this.effects[_].stop();for(_=0,E=this.cleanups.length;_<E;_++)this.cleanups[_]();if(this.scopes)for(_=0,E=this.scopes.length;_<E;_++)this.scopes[_].stop(!0);if(!this.detached&&this.parent&&!r){const S=this.parent.scopes.pop();S&&S!==this&&(this.parent.scopes[this.index]=S,S.index=this.index)}this.parent=void 0,this._active=!1}}}function effectScope(n){return new EffectScope(n)}function recordEffectScope(n,r=activeEffectScope){r&&r.active&&r.effects.push(n)}function getCurrentScope(){return activeEffectScope}function onScopeDispose(n){activeEffectScope&&activeEffectScope.cleanups.push(n)}let activeEffect;class ReactiveEffect{constructor(r,_,E,S){this.fn=r,this.trigger=_,this.scheduler=E,this.active=!0,this.deps=[],this._dirtyLevel=4,this._trackId=0,this._runnings=0,this._shouldSchedule=!1,this._depsLength=0,recordEffectScope(this,S)}get dirty(){if(this._dirtyLevel===2||this._dirtyLevel===3){this._dirtyLevel=1,pauseTracking();for(let r=0;r<this._depsLength;r++){const _=this.deps[r];if(_.computed&&(triggerComputed(_.computed),this._dirtyLevel>=4))break}this._dirtyLevel===1&&(this._dirtyLevel=0),resetTracking()}return this._dirtyLevel>=4}set dirty(r){this._dirtyLevel=r?4:0}run(){if(this._dirtyLevel=0,!this.active)return this.fn();let r=shouldTrack,_=activeEffect;try{return shouldTrack=!0,activeEffect=this,this._runnings++,preCleanupEffect(this),this.fn()}finally{postCleanupEffect(this),this._runnings--,activeEffect=_,shouldTrack=r}}stop(){var r;this.active&&(preCleanupEffect(this),postCleanupEffect(this),(r=this.onStop)==null||r.call(this),this.active=!1)}}function triggerComputed(n){return n.value}function preCleanupEffect(n){n._trackId++,n._depsLength=0}function postCleanupEffect(n){if(n.deps.length>n._depsLength){for(let r=n._depsLength;r<n.deps.length;r++)cleanupDepEffect(n.deps[r],n);n.deps.length=n._depsLength}}function cleanupDepEffect(n,r){const _=n.get(r);_!==void 0&&r._trackId!==_&&(n.delete(r),n.size===0&&n.cleanup())}let shouldTrack=!0,pauseScheduleStack=0;const trackStack=[];function pauseTracking(){trackStack.push(shouldTrack),shouldTrack=!1}function resetTracking(){const n=trackStack.pop();shouldTrack=n===void 0?!0:n}function pauseScheduling(){pauseScheduleStack++}function resetScheduling(){for(pauseScheduleStack--;!pauseScheduleStack&&queueEffectSchedulers.length;)queueEffectSchedulers.shift()()}function trackEffect(n,r,_){if(r.get(n)!==n._trackId){r.set(n,n._trackId);const E=n.deps[n._depsLength];E!==r?(E&&cleanupDepEffect(E,n),n.deps[n._depsLength++]=r):n._depsLength++}}const queueEffectSchedulers=[];function triggerEffects(n,r,_){pauseScheduling();for(const E of n.keys()){let S;E._dirtyLevel<r&&(S??(S=n.get(E)===E._trackId))&&(E._shouldSchedule||(E._shouldSchedule=E._dirtyLevel===0),E._dirtyLevel=r),E._shouldSchedule&&(S??(S=n.get(E)===E._trackId))&&(E.trigger(),(!E._runnings||E.allowRecurse)&&E._dirtyLevel!==2&&(E._shouldSchedule=!1,E.scheduler&&queueEffectSchedulers.push(E.scheduler)))}resetScheduling()}const createDep=(n,r)=>{const _=new Map;return _.cleanup=n,_.computed=r,_},targetMap=new WeakMap,ITERATE_KEY=Symbol(""),MAP_KEY_ITERATE_KEY=Symbol("");function track(n,r,_){if(shouldTrack&&activeEffect){let E=targetMap.get(n);E||targetMap.set(n,E=new Map);let S=E.get(_);S||E.set(_,S=createDep(()=>E.delete(_))),trackEffect(activeEffect,S)}}function trigger(n,r,_,E,S,C){const A=targetMap.get(n);if(!A)return;let I=[];if(r==="clear")I=[...A.values()];else if(_==="length"&&isArray$6(n)){const B=Number(E);A.forEach((O,N)=>{(N==="length"||!isSymbol$3(N)&&N>=B)&&I.push(O)})}else switch(_!==void 0&&I.push(A.get(_)),r){case"add":isArray$6(n)?isIntegerKey(_)&&I.push(A.get("length")):(I.push(A.get(ITERATE_KEY)),isMap$4(n)&&I.push(A.get(MAP_KEY_ITERATE_KEY)));break;case"delete":isArray$6(n)||(I.push(A.get(ITERATE_KEY)),isMap$4(n)&&I.push(A.get(MAP_KEY_ITERATE_KEY)));break;case"set":isMap$4(n)&&I.push(A.get(ITERATE_KEY));break}pauseScheduling();for(const B of I)B&&triggerEffects(B,4);resetScheduling()}function getDepFromReactive(n,r){var _;return(_=targetMap.get(n))==null?void 0:_.get(r)}const isNonTrackableKeys=makeMap("__proto__,__v_isRef,__isVue"),builtInSymbols=new Set(Object.getOwnPropertyNames(Symbol).filter(n=>n!=="arguments"&&n!=="caller").map(n=>Symbol[n]).filter(isSymbol$3)),arrayInstrumentations=createArrayInstrumentations();function createArrayInstrumentations(){const n={};return["includes","indexOf","lastIndexOf"].forEach(r=>{n[r]=function(..._){const E=toRaw(this);for(let C=0,A=this.length;C<A;C++)track(E,"get",C+"");const S=E[r](..._);return S===-1||S===!1?E[r](..._.map(toRaw)):S}}),["push","pop","shift","unshift","splice"].forEach(r=>{n[r]=function(..._){pauseTracking(),pauseScheduling();const E=toRaw(this)[r].apply(this,_);return resetScheduling(),resetTracking(),E}}),n}function hasOwnProperty$4(n){const r=toRaw(this);return track(r,"has",n),r.hasOwnProperty(n)}class BaseReactiveHandler{constructor(r=!1,_=!1){this._isReadonly=r,this._isShallow=_}get(r,_,E){const S=this._isReadonly,C=this._isShallow;if(_==="__v_isReactive")return!S;if(_==="__v_isReadonly")return S;if(_==="__v_isShallow")return C;if(_==="__v_raw")return E===(S?C?shallowReadonlyMap:readonlyMap:C?shallowReactiveMap:reactiveMap).get(r)||Object.getPrototypeOf(r)===Object.getPrototypeOf(E)?r:void 0;const A=isArray$6(r);if(!S){if(A&&hasOwn$3(arrayInstrumentations,_))return Reflect.get(arrayInstrumentations,_,E);if(_==="hasOwnProperty")return hasOwnProperty$4}const I=Reflect.get(r,_,E);return(isSymbol$3(_)?builtInSymbols.has(_):isNonTrackableKeys(_))||(S||track(r,"get",_),C)?I:isRef(I)?A&&isIntegerKey(_)?I:I.value:isObject$2(I)?S?readonly$3(I):reactive(I):I}}class MutableReactiveHandler extends BaseReactiveHandler{constructor(r=!1){super(!1,r)}set(r,_,E,S){let C=r[_];if(!this._isShallow){const B=isReadonly(C);if(!isShallow(E)&&!isReadonly(E)&&(C=toRaw(C),E=toRaw(E)),!isArray$6(r)&&isRef(C)&&!isRef(E))return B?!1:(C.value=E,!0)}const A=isArray$6(r)&&isIntegerKey(_)?Number(_)<r.length:hasOwn$3(r,_),I=Reflect.set(r,_,E,S);return r===toRaw(S)&&(A?hasChanged(E,C)&&trigger(r,"set",_,E):trigger(r,"add",_,E)),I}deleteProperty(r,_){const E=hasOwn$3(r,_);r[_];const S=Reflect.deleteProperty(r,_);return S&&E&&trigger(r,"delete",_,void 0),S}has(r,_){const E=Reflect.has(r,_);return(!isSymbol$3(_)||!builtInSymbols.has(_))&&track(r,"has",_),E}ownKeys(r){return track(r,"iterate",isArray$6(r)?"length":ITERATE_KEY),Reflect.ownKeys(r)}}class ReadonlyReactiveHandler extends BaseReactiveHandler{constructor(r=!1){super(!0,r)}set(r,_){return!0}deleteProperty(r,_){return!0}}const mutableHandlers=new MutableReactiveHandler,readonlyHandlers=new ReadonlyReactiveHandler,shallowReactiveHandlers=new MutableReactiveHandler(!0),toShallow=n=>n,getProto$3=n=>Reflect.getPrototypeOf(n);function get$6(n,r,_=!1,E=!1){n=n.__v_raw;const S=toRaw(n),C=toRaw(r);_||(hasChanged(r,C)&&track(S,"get",r),track(S,"get",C));const{has:A}=getProto$3(S),I=E?toShallow:_?toReadonly:toReactive;if(A.call(S,r))return I(n.get(r));if(A.call(S,C))return I(n.get(C));n!==S&&n.get(r)}function has$3(n,r=!1){const _=this.__v_raw,E=toRaw(_),S=toRaw(n);return r||(hasChanged(n,S)&&track(E,"has",n),track(E,"has",S)),n===S?_.has(n):_.has(n)||_.has(S)}function size(n,r=!1){return n=n.__v_raw,!r&&track(toRaw(n),"iterate",ITERATE_KEY),Reflect.get(n,"size",n)}function add$1(n){n=toRaw(n);const r=toRaw(this);return getProto$3(r).has.call(r,n)||(r.add(n),trigger(r,"add",n,n)),this}function set$3(n,r){r=toRaw(r);const _=toRaw(this),{has:E,get:S}=getProto$3(_);let C=E.call(_,n);C||(n=toRaw(n),C=E.call(_,n));const A=S.call(_,n);return _.set(n,r),C?hasChanged(r,A)&&trigger(_,"set",n,r):trigger(_,"add",n,r),this}function deleteEntry(n){const r=toRaw(this),{has:_,get:E}=getProto$3(r);let S=_.call(r,n);S||(n=toRaw(n),S=_.call(r,n)),E&&E.call(r,n);const C=r.delete(n);return S&&trigger(r,"delete",n,void 0),C}function clear$2(){const n=toRaw(this),r=n.size!==0,_=n.clear();return r&&trigger(n,"clear",void 0,void 0),_}function createForEach(n,r){return function(E,S){const C=this,A=C.__v_raw,I=toRaw(A),B=r?toShallow:n?toReadonly:toReactive;return!n&&track(I,"iterate",ITERATE_KEY),A.forEach((O,N)=>E.call(S,B(O),B(N),C))}}function createIterableMethod(n,r,_){return function(...E){const S=this.__v_raw,C=toRaw(S),A=isMap$4(C),I=n==="entries"||n===Symbol.iterator&&A,B=n==="keys"&&A,O=S[n](...E),N=_?toShallow:r?toReadonly:toReactive;return!r&&track(C,"iterate",B?MAP_KEY_ITERATE_KEY:ITERATE_KEY),{next(){const{value:U,done:j}=O.next();return j?{value:U,done:j}:{value:I?[N(U[0]),N(U[1])]:N(U),done:j}},[Symbol.iterator](){return this}}}}function createReadonlyMethod(n){return function(...r){return n==="delete"?!1:n==="clear"?void 0:this}}function createInstrumentations(){const n={get(C){return get$6(this,C)},get size(){return size(this)},has:has$3,add:add$1,set:set$3,delete:deleteEntry,clear:clear$2,forEach:createForEach(!1,!1)},r={get(C){return get$6(this,C,!1,!0)},get size(){return size(this)},has:has$3,add:add$1,set:set$3,delete:deleteEntry,clear:clear$2,forEach:createForEach(!1,!0)},_={get(C){return get$6(this,C,!0)},get size(){return size(this,!0)},has(C){return has$3.call(this,C,!0)},add:createReadonlyMethod("add"),set:createReadonlyMethod("set"),delete:createReadonlyMethod("delete"),clear:createReadonlyMethod("clear"),forEach:createForEach(!0,!1)},E={get(C){return get$6(this,C,!0,!0)},get size(){return size(this,!0)},has(C){return has$3.call(this,C,!0)},add:createReadonlyMethod("add"),set:createReadonlyMethod("set"),delete:createReadonlyMethod("delete"),clear:createReadonlyMethod("clear"),forEach:createForEach(!0,!0)};return["keys","values","entries",Symbol.iterator].forEach(C=>{n[C]=createIterableMethod(C,!1,!1),_[C]=createIterableMethod(C,!0,!1),r[C]=createIterableMethod(C,!1,!0),E[C]=createIterableMethod(C,!0,!0)}),[n,_,r,E]}const[mutableInstrumentations,readonlyInstrumentations,shallowInstrumentations,shallowReadonlyInstrumentations]=createInstrumentations();function createInstrumentationGetter(n,r){const _=r?n?shallowReadonlyInstrumentations:shallowInstrumentations:n?readonlyInstrumentations:mutableInstrumentations;return(E,S,C)=>S==="__v_isReactive"?!n:S==="__v_isReadonly"?n:S==="__v_raw"?E:Reflect.get(hasOwn$3(_,S)&&S in E?_:E,S,C)}const mutableCollectionHandlers={get:createInstrumentationGetter(!1,!1)},shallowCollectionHandlers={get:createInstrumentationGetter(!1,!0)},readonlyCollectionHandlers={get:createInstrumentationGetter(!0,!1)},reactiveMap=new WeakMap,shallowReactiveMap=new WeakMap,readonlyMap=new WeakMap,shallowReadonlyMap=new WeakMap;function targetTypeMap(n){switch(n){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function getTargetType(n){return n.__v_skip||!Object.isExtensible(n)?0:targetTypeMap(toRawType(n))}function reactive(n){return isReadonly(n)?n:createReactiveObject(n,!1,mutableHandlers,mutableCollectionHandlers,reactiveMap)}function shallowReactive(n){return createReactiveObject(n,!1,shallowReactiveHandlers,shallowCollectionHandlers,shallowReactiveMap)}function readonly$3(n){return createReactiveObject(n,!0,readonlyHandlers,readonlyCollectionHandlers,readonlyMap)}function createReactiveObject(n,r,_,E,S){if(!isObject$2(n)||n.__v_raw&&!(r&&n.__v_isReactive))return n;const C=S.get(n);if(C)return C;const A=getTargetType(n);if(A===0)return n;const I=new Proxy(n,A===2?E:_);return S.set(n,I),I}function isReactive(n){return isReadonly(n)?isReactive(n.__v_raw):!!(n&&n.__v_isReactive)}function isReadonly(n){return!!(n&&n.__v_isReadonly)}function isShallow(n){return!!(n&&n.__v_isShallow)}function isProxy(n){return isReactive(n)||isReadonly(n)}function toRaw(n){const r=n&&n.__v_raw;return r?toRaw(r):n}function markRaw(n){return Object.isExtensible(n)&&def$t(n,"__v_skip",!0),n}const toReactive=n=>isObject$2(n)?reactive(n):n,toReadonly=n=>isObject$2(n)?readonly$3(n):n;class ComputedRefImpl{constructor(r,_,E,S){this.getter=r,this._setter=_,this.dep=void 0,this.__v_isRef=!0,this.__v_isReadonly=!1,this.effect=new ReactiveEffect(()=>r(this._value),()=>triggerRefValue(this,this.effect._dirtyLevel===2?2:3)),this.effect.computed=this,this.effect.active=this._cacheable=!S,this.__v_isReadonly=E}get value(){const r=toRaw(this);return(!r._cacheable||r.effect.dirty)&&hasChanged(r._value,r._value=r.effect.run())&&triggerRefValue(r,4),trackRefValue(r),r.effect._dirtyLevel>=2&&triggerRefValue(r,2),r._value}set value(r){this._setter(r)}get _dirty(){return this.effect.dirty}set _dirty(r){this.effect.dirty=r}}function computed$1(n,r,_=!1){let E,S;const C=isFunction$2(n);return C?(E=n,S=NOOP):(E=n.get,S=n.set),new ComputedRefImpl(E,S,C||!S,_)}function trackRefValue(n){var r;shouldTrack&&activeEffect&&(n=toRaw(n),trackEffect(activeEffect,(r=n.dep)!=null?r:n.dep=createDep(()=>n.dep=void 0,n instanceof ComputedRefImpl?n:void 0)))}function triggerRefValue(n,r=4,_){n=toRaw(n);const E=n.dep;E&&triggerEffects(E,r)}function isRef(n){return!!(n&&n.__v_isRef===!0)}function ref$2(n){return createRef(n,!1)}function shallowRef(n){return createRef(n,!0)}function createRef(n,r){return isRef(n)?n:new RefImpl(n,r)}class RefImpl{constructor(r,_){this.__v_isShallow=_,this.dep=void 0,this.__v_isRef=!0,this._rawValue=_?r:toRaw(r),this._value=_?r:toReactive(r)}get value(){return trackRefValue(this),this._value}set value(r){const _=this.__v_isShallow||isShallow(r)||isReadonly(r);r=_?r:toRaw(r),hasChanged(r,this._rawValue)&&(this._rawValue=r,this._value=_?r:toReactive(r),triggerRefValue(this,4))}}function unref(n){return isRef(n)?n.value:n}const shallowUnwrapHandlers={get:(n,r,_)=>unref(Reflect.get(n,r,_)),set:(n,r,_,E)=>{const S=n[r];return isRef(S)&&!isRef(_)?(S.value=_,!0):Reflect.set(n,r,_,E)}};function proxyRefs(n){return isReactive(n)?n:new Proxy(n,shallowUnwrapHandlers)}function toRefs(n){const r=isArray$6(n)?new Array(n.length):{};for(const _ in n)r[_]=propertyToRef(n,_);return r}class ObjectRefImpl{constructor(r,_,E){this._object=r,this._key=_,this._defaultValue=E,this.__v_isRef=!0}get value(){const r=this._object[this._key];return r===void 0?this._defaultValue:r}set value(r){this._object[this._key]=r}get dep(){return getDepFromReactive(toRaw(this._object),this._key)}}class GetterRefImpl{constructor(r){this._getter=r,this.__v_isRef=!0,this.__v_isReadonly=!0}get value(){return this._getter()}}function toRef(n,r,_){return isRef(n)?n:isFunction$2(n)?new GetterRefImpl(n):isObject$2(n)&&arguments.length>1?propertyToRef(n,r,_):ref$2(n)}function propertyToRef(n,r,_){const E=n[r];return isRef(E)?E:new ObjectRefImpl(n,r,_)}/**
* @vue/runtime-core v3.4.21
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/const stack=[];function warn$1(n,...r){pauseTracking();const _=stack.length?stack[stack.length-1].component:null,E=_&&_.appContext.config.warnHandler,S=getComponentTrace();if(E)callWithErrorHandling(E,_,11,[n+r.map(C=>{var A,I;return(I=(A=C.toString)==null?void 0:A.call(C))!=null?I:JSON.stringify(C)}).join(""),_&&_.proxy,S.map(({vnode:C})=>`at <${formatComponentName(_,C.type)}>`).join(`
`),S]);else{const C=[`[Vue warn]: ${n}`,...r];S.length&&C.push(`
`,...formatTrace(S)),console.warn(...C)}resetTracking()}function getComponentTrace(){let n=stack[stack.length-1];if(!n)return[];const r=[];for(;n;){const _=r[0];_&&_.vnode===n?_.recurseCount++:r.push({vnode:n,recurseCount:0});const E=n.component&&n.component.parent;n=E&&E.vnode}return r}function formatTrace(n){const r=[];return n.forEach((_,E)=>{r.push(...E===0?[]:[`
`],...formatTraceEntry(_))}),r}function formatTraceEntry({vnode:n,recurseCount:r}){const _=r>0?`... (${r} recursive calls)`:"",E=n.component?n.component.parent==null:!1,S=` at <${formatComponentName(n.component,n.type,E)}`,C=">"+_;return n.props?[S,...formatProps(n.props),C]:[S+C]}function formatProps(n){const r=[],_=Object.keys(n);return _.slice(0,3).forEach(E=>{r.push(...formatProp(E,n[E]))}),_.length>3&&r.push(" ..."),r}function formatProp(n,r,_){return isString$5(r)?(r=JSON.stringify(r),_?r:[`${n}=${r}`]):typeof r=="number"||typeof r=="boolean"||r==null?_?r:[`${n}=${r}`]:isRef(r)?(r=formatProp(n,toRaw(r.value),!0),_?r:[`${n}=Ref<`,r,">"]):isFunction$2(r)?[`${n}=fn${r.name?`<${r.name}>`:""}`]:(r=toRaw(r),_?r:[`${n}=`,r])}function callWithErrorHandling(n,r,_,E){try{return E?n(...E):n()}catch(S){handleError(S,r,_)}}function callWithAsyncErrorHandling(n,r,_,E){if(isFunction$2(n)){const C=callWithErrorHandling(n,r,_,E);return C&&isPromise$6(C)&&C.catch(A=>{handleError(A,r,_)}),C}const S=[];for(let C=0;C<n.length;C++)S.push(callWithAsyncErrorHandling(n[C],r,_,E));return S}function handleError(n,r,_,E=!0){const S=r?r.vnode:null;if(r){let C=r.parent;const A=r.proxy,I=`https://vuejs.org/error-reference/#runtime-${_}`;for(;C;){const O=C.ec;if(O){for(let N=0;N<O.length;N++)if(O[N](n,A,I)===!1)return}C=C.parent}const B=r.appContext.config.errorHandler;if(B){callWithErrorHandling(B,null,10,[n,A,I]);return}}logError(n,_,S,E)}function logError(n,r,_,E=!0){console.error(n)}let isFlushing=!1,isFlushPending=!1;const queue$1=[];let flushIndex=0;const pendingPostFlushCbs=[];let activePostFlushCbs=null,postFlushIndex=0;const resolvedPromise=Promise.resolve();let currentFlushPromise=null;function nextTick$3(n){const r=currentFlushPromise||resolvedPromise;return n?r.then(this?n.bind(this):n):r}function findInsertionIndex(n){let r=flushIndex+1,_=queue$1.length;for(;r<_;){const E=r+_>>>1,S=queue$1[E],C=getId(S);C<n||C===n&&S.pre?r=E+1:_=E}return r}function queueJob(n){(!queue$1.length||!queue$1.includes(n,isFlushing&&n.allowRecurse?flushIndex+1:flushIndex))&&(n.id==null?queue$1.push(n):queue$1.splice(findInsertionIndex(n.id),0,n),queueFlush())}function queueFlush(){!isFlushing&&!isFlushPending&&(isFlushPending=!0,currentFlushPromise=resolvedPromise.then(flushJobs))}function invalidateJob(n){const r=queue$1.indexOf(n);r>flushIndex&&queue$1.splice(r,1)}function queuePostFlushCb(n){isArray$6(n)?pendingPostFlushCbs.push(...n):(!activePostFlushCbs||!activePostFlushCbs.includes(n,n.allowRecurse?postFlushIndex+1:postFlushIndex))&&pendingPostFlushCbs.push(n),queueFlush()}function flushPreFlushCbs(n,r,_=isFlushing?flushIndex+1:0){for(;_<queue$1.length;_++){const E=queue$1[_];if(E&&E.pre){if(n&&E.id!==n.uid)continue;queue$1.splice(_,1),_--,E()}}}function flushPostFlushCbs(n){if(pendingPostFlushCbs.length){const r=[...new Set(pendingPostFlushCbs)].sort((_,E)=>getId(_)-getId(E));if(pendingPostFlushCbs.length=0,activePostFlushCbs){activePostFlushCbs.push(...r);return}for(activePostFlushCbs=r,postFlushIndex=0;postFlushIndex<activePostFlushCbs.length;postFlushIndex++)activePostFlushCbs[postFlushIndex]();activePostFlushCbs=null,postFlushIndex=0}}const getId=n=>n.id==null?1/0:n.id,comparator$1=(n,r)=>{const _=getId(n)-getId(r);if(_===0){if(n.pre&&!r.pre)return-1;if(r.pre&&!n.pre)return 1}return _};function flushJobs(n){isFlushPending=!1,isFlushing=!0,queue$1.sort(comparator$1);try{for(flushIndex=0;flushIndex<queue$1.length;flushIndex++){const r=queue$1[flushIndex];r&&r.active!==!1&&callWithErrorHandling(r,null,14)}}finally{flushIndex=0,queue$1.length=0,flushPostFlushCbs(),isFlushing=!1,currentFlushPromise=null,(queue$1.length||pendingPostFlushCbs.length)&&flushJobs()}}function emit$1(n,r,..._){if(n.isUnmounted)return;const E=n.vnode.props||EMPTY_OBJ;let S=_;const C=r.startsWith("update:"),A=C&&r.slice(7);if(A&&A in E){const N=`${A==="modelValue"?"model":A}Modifiers`,{number:U,trim:j}=E[N]||EMPTY_OBJ;j&&(S=_.map(z=>isString$5(z)?z.trim():z)),U&&(S=_.map(looseToNumber))}let I,B=E[I=toHandlerKey(r)]||E[I=toHandlerKey(camelize(r))];!B&&C&&(B=E[I=toHandlerKey(hyphenate(r))]),B&&callWithAsyncErrorHandling(B,n,6,S);const O=E[I+"Once"];if(O){if(!n.emitted)n.emitted={};else if(n.emitted[I])return;n.emitted[I]=!0,callWithAsyncErrorHandling(O,n,6,S)}}function normalizeEmitsOptions(n,r,_=!1){const E=r.emitsCache,S=E.get(n);if(S!==void 0)return S;const C=n.emits;let A={},I=!1;if(!isFunction$2(n)){const B=O=>{const N=normalizeEmitsOptions(O,r,!0);N&&(I=!0,extend$2(A,N))};!_&&r.mixins.length&&r.mixins.forEach(B),n.extends&&B(n.extends),n.mixins&&n.mixins.forEach(B)}return!C&&!I?(isObject$2(n)&&E.set(n,null),null):(isArray$6(C)?C.forEach(B=>A[B]=null):extend$2(A,C),isObject$2(n)&&E.set(n,A),A)}function isEmitListener(n,r){return!n||!isOn$1(r)?!1:(r=r.slice(2).replace(/Once$/,""),hasOwn$3(n,r[0].toLowerCase()+r.slice(1))||hasOwn$3(n,hyphenate(r))||hasOwn$3(n,r))}let currentRenderingInstance=null,currentScopeId=null;function setCurrentRenderingInstance(n){const r=currentRenderingInstance;return currentRenderingInstance=n,currentScopeId=n&&n.type.__scopeId||null,r}function pushScopeId(n){currentScopeId=n}function popScopeId(){currentScopeId=null}function withCtx(n,r=currentRenderingInstance,_){if(!r||n._n)return n;const E=(...S)=>{E._d&&setBlockTracking(-1);const C=setCurrentRenderingInstance(r);let A;try{A=n(...S)}finally{setCurrentRenderingInstance(C),E._d&&setBlockTracking(1)}return A};return E._n=!0,E._c=!0,E._d=!0,E}function markAttrsAccessed(){}function renderComponentRoot(n){const{type:r,vnode:_,proxy:E,withProxy:S,props:C,propsOptions:[A],slots:I,attrs:B,emit:O,render:N,renderCache:U,data:j,setupState:z,ctx:Z,inheritAttrs:X}=n;let Q,se;const oe=setCurrentRenderingInstance(n);try{if(_.shapeFlag&4){const we=S||E,Te=we;Q=normalizeVNode(N.call(Te,we,U,C,z,j,Z)),se=B}else{const we=r;Q=normalizeVNode(we.length>1?we(C,{attrs:B,slots:I,emit:O}):we(C,null)),se=r.props?B:getFunctionalFallthrough(B)}}catch(we){blockStack.length=0,handleError(we,n,1),Q=createVNode(Comment)}let ue=Q;if(se&&X!==!1){const we=Object.keys(se),{shapeFlag:Te}=ue;we.length&&Te&7&&(A&&we.some(isModelListener)&&(se=filterModelListeners(se,A)),ue=cloneVNode(ue,se))}return _.dirs&&(ue=cloneVNode(ue),ue.dirs=ue.dirs?ue.dirs.concat(_.dirs):_.dirs),_.transition&&(ue.transition=_.transition),Q=ue,setCurrentRenderingInstance(oe),Q}const getFunctionalFallthrough=n=>{let r;for(const _ in n)(_==="class"||_==="style"||isOn$1(_))&&((r||(r={}))[_]=n[_]);return r},filterModelListeners=(n,r)=>{const _={};for(const E in n)(!isModelListener(E)||!(E.slice(9)in r))&&(_[E]=n[E]);return _};function shouldUpdateComponent(n,r,_){const{props:E,children:S,component:C}=n,{props:A,children:I,patchFlag:B}=r,O=C.emitsOptions;if(r.dirs||r.transition)return!0;if(_&&B>=0){if(B&1024)return!0;if(B&16)return E?hasPropsChanged(E,A,O):!!A;if(B&8){const N=r.dynamicProps;for(let U=0;U<N.length;U++){const j=N[U];if(A[j]!==E[j]&&!isEmitListener(O,j))return!0}}}else return(S||I)&&(!I||!I.$stable)?!0:E===A?!1:E?A?hasPropsChanged(E,A,O):!0:!!A;return!1}function hasPropsChanged(n,r,_){const E=Object.keys(r);if(E.length!==Object.keys(n).length)return!0;for(let S=0;S<E.length;S++){const C=E[S];if(r[C]!==n[C]&&!isEmitListener(_,C))return!0}return!1}function updateHOCHostEl({vnode:n,parent:r},_){for(;r;){const E=r.subTree;if(E.suspense&&E.suspense.activeBranch===n&&(E.el=n.el),E===n)(n=r.vnode).el=_,r=r.parent;else break}}const COMPONENTS="components",DIRECTIVES="directives";function resolveComponent(n,r){return resolveAsset(COMPONENTS,n,!0,r)||n}const NULL_DYNAMIC_COMPONENT=Symbol.for("v-ndc");function resolveDynamicComponent(n){return isString$5(n)?resolveAsset(COMPONENTS,n,!1)||n:n||NULL_DYNAMIC_COMPONENT}function resolveDirective(n){return resolveAsset(DIRECTIVES,n)}function resolveAsset(n,r,_=!0,E=!1){const S=currentRenderingInstance||currentInstance;if(S){const C=S.type;if(n===COMPONENTS){const I=getComponentName(C,!1);if(I&&(I===r||I===camelize(r)||I===capitalize(camelize(r))))return C}const A=resolve$a(S[n]||C[n],r)||resolve$a(S.appContext[n],r);return!A&&E?C:A}}function resolve$a(n,r){return n&&(n[r]||n[camelize(r)]||n[capitalize(camelize(r))])}const isSuspense=n=>n.__isSuspense;function queueEffectWithSuspense(n,r){r&&r.pendingBranch?isArray$6(n)?r.effects.push(...n):r.effects.push(n):queuePostFlushCb(n)}const ssrContextKey=Symbol.for("v-scx"),useSSRContext=()=>inject$1(ssrContextKey);function watchEffect(n,r){return doWatch(n,null,r)}const INITIAL_WATCHER_VALUE={};function watch(n,r,_){return doWatch(n,r,_)}function doWatch(n,r,{immediate:_,deep:E,flush:S,once:C,onTrack:A,onTrigger:I}=EMPTY_OBJ){if(r&&C){const xe=r;r=(...Re)=>{xe(...Re),Te()}}const B=currentInstance,O=xe=>E===!0?xe:traverse$2(xe,E===!1?1:void 0);let N,U=!1,j=!1;if(isRef(n)?(N=()=>n.value,U=isShallow(n)):isReactive(n)?(N=()=>O(n),U=!0):isArray$6(n)?(j=!0,U=n.some(xe=>isReactive(xe)||isShallow(xe)),N=()=>n.map(xe=>{if(isRef(xe))return xe.value;if(isReactive(xe))return O(xe);if(isFunction$2(xe))return callWithErrorHandling(xe,B,2)})):isFunction$2(n)?r?N=()=>callWithErrorHandling(n,B,2):N=()=>(z&&z(),callWithAsyncErrorHandling(n,B,3,[Z])):N=NOOP,r&&E){const xe=N;N=()=>traverse$2(xe())}let z,Z=xe=>{z=ue.onStop=()=>{callWithErrorHandling(xe,B,4),z=ue.onStop=void 0}},X;if(isInSSRComponentSetup)if(Z=NOOP,r?_&&callWithAsyncErrorHandling(r,B,3,[N(),j?[]:void 0,Z]):N(),S==="sync"){const xe=useSSRContext();X=xe.__watcherHandles||(xe.__watcherHandles=[])}else return NOOP;let Q=j?new Array(n.length).fill(INITIAL_WATCHER_VALUE):INITIAL_WATCHER_VALUE;const se=()=>{if(!(!ue.active||!ue.dirty))if(r){const xe=ue.run();(E||U||(j?xe.some((Re,Ne)=>hasChanged(Re,Q[Ne])):hasChanged(xe,Q)))&&(z&&z(),callWithAsyncErrorHandling(r,B,3,[xe,Q===INITIAL_WATCHER_VALUE?void 0:j&&Q[0]===INITIAL_WATCHER_VALUE?[]:Q,Z]),Q=xe)}else ue.run()};se.allowRecurse=!!r;let oe;S==="sync"?oe=se:S==="post"?oe=()=>queuePostRenderEffect(se,B&&B.suspense):(se.pre=!0,B&&(se.id=B.uid),oe=()=>queueJob(se));const ue=new ReactiveEffect(N,NOOP,oe),we=getCurrentScope(),Te=()=>{ue.stop(),we&&remove$1(we.effects,ue)};return r?_?se():Q=ue.run():S==="post"?queuePostRenderEffect(ue.run.bind(ue),B&&B.suspense):ue.run(),X&&X.push(Te),Te}function instanceWatch(n,r,_){const E=this.proxy,S=isString$5(n)?n.includes(".")?createPathGetter(E,n):()=>E[n]:n.bind(E,E);let C;isFunction$2(r)?C=r:(C=r.handler,_=r);const A=setCurrentInstance(this),I=doWatch(S,C.bind(E),_);return A(),I}function createPathGetter(n,r){const _=r.split(".");return()=>{let E=n;for(let S=0;S<_.length&&E;S++)E=E[_[S]];return E}}function traverse$2(n,r,_=0,E){if(!isObject$2(n)||n.__v_skip)return n;if(r&&r>0){if(_>=r)return n;_++}if(E=E||new Set,E.has(n))return n;if(E.add(n),isRef(n))traverse$2(n.value,r,_,E);else if(isArray$6(n))for(let S=0;S<n.length;S++)traverse$2(n[S],r,_,E);else if(isSet$4(n)||isMap$4(n))n.forEach(S=>{traverse$2(S,r,_,E)});else if(isPlainObject$2(n))for(const S in n)traverse$2(n[S],r,_,E);return n}function withDirectives(n,r){if(currentRenderingInstance===null)return n;const _=getExposeProxy(currentRenderingInstance)||currentRenderingInstance.proxy,E=n.dirs||(n.dirs=[]);for(let S=0;S<r.length;S++){let[C,A,I,B=EMPTY_OBJ]=r[S];C&&(isFunction$2(C)&&(C={mounted:C,updated:C}),C.deep&&traverse$2(A),E.push({dir:C,instance:_,value:A,oldValue:void 0,arg:I,modifiers:B}))}return n}function invokeDirectiveHook(n,r,_,E){const S=n.dirs,C=r&&r.dirs;for(let A=0;A<S.length;A++){const I=S[A];C&&(I.oldValue=C[A].value);let B=I.dir[E];B&&(pauseTracking(),callWithAsyncErrorHandling(B,_,8,[n.el,I,n,r]),resetTracking())}}const leaveCbKey=Symbol("_leaveCb"),enterCbKey$1=Symbol("_enterCb");function useTransitionState(){const n={isMounted:!1,isLeaving:!1,isUnmounting:!1,leavingVNodes:new Map};return onMounted(()=>{n.isMounted=!0}),onBeforeUnmount(()=>{n.isUnmounting=!0}),n}const TransitionHookValidator=[Function,Array],BaseTransitionPropsValidators={mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:TransitionHookValidator,onEnter:TransitionHookValidator,onAfterEnter:TransitionHookValidator,onEnterCancelled:TransitionHookValidator,onBeforeLeave:TransitionHookValidator,onLeave:TransitionHookValidator,onAfterLeave:TransitionHookValidator,onLeaveCancelled:TransitionHookValidator,onBeforeAppear:TransitionHookValidator,onAppear:TransitionHookValidator,onAfterAppear:TransitionHookValidator,onAppearCancelled:TransitionHookValidator},BaseTransitionImpl={name:"BaseTransition",props:BaseTransitionPropsValidators,setup(n,{slots:r}){const _=getCurrentInstance$1(),E=useTransitionState();return()=>{const S=r.default&&getTransitionRawChildren(r.default(),!0);if(!S||!S.length)return;let C=S[0];if(S.length>1){for(const j of S)if(j.type!==Comment){C=j;break}}const A=toRaw(n),{mode:I}=A;if(E.isLeaving)return emptyPlaceholder(C);const B=getKeepAliveChild(C);if(!B)return emptyPlaceholder(C);const O=resolveTransitionHooks(B,A,E,_);setTransitionHooks(B,O);const N=_.subTree,U=N&&getKeepAliveChild(N);if(U&&U.type!==Comment&&!isSameVNodeType(B,U)){const j=resolveTransitionHooks(U,A,E,_);if(setTransitionHooks(U,j),I==="out-in")return E.isLeaving=!0,j.afterLeave=()=>{E.isLeaving=!1,_.update.active!==!1&&(_.effect.dirty=!0,_.update())},emptyPlaceholder(C);I==="in-out"&&B.type!==Comment&&(j.delayLeave=(z,Z,X)=>{const Q=getLeavingNodesForType(E,U);Q[String(U.key)]=U,z[leaveCbKey]=()=>{Z(),z[leaveCbKey]=void 0,delete O.delayedLeave},O.delayedLeave=X})}return C}}},BaseTransition=BaseTransitionImpl;function getLeavingNodesForType(n,r){const{leavingVNodes:_}=n;let E=_.get(r.type);return E||(E=Object.create(null),_.set(r.type,E)),E}function resolveTransitionHooks(n,r,_,E){const{appear:S,mode:C,persisted:A=!1,onBeforeEnter:I,onEnter:B,onAfterEnter:O,onEnterCancelled:N,onBeforeLeave:U,onLeave:j,onAfterLeave:z,onLeaveCancelled:Z,onBeforeAppear:X,onAppear:Q,onAfterAppear:se,onAppearCancelled:oe}=r,ue=String(n.key),we=getLeavingNodesForType(_,n),Te=(Ne,Fe)=>{Ne&&callWithAsyncErrorHandling(Ne,E,9,Fe)},xe=(Ne,Fe)=>{const ht=Fe[1];Te(Ne,Fe),isArray$6(Ne)?Ne.every(nt=>nt.length<=1)&&ht():Ne.length<=1&&ht()},Re={mode:C,persisted:A,beforeEnter(Ne){let Fe=I;if(!_.isMounted)if(S)Fe=X||I;else return;Ne[leaveCbKey]&&Ne[leaveCbKey](!0);const ht=we[ue];ht&&isSameVNodeType(n,ht)&&ht.el[leaveCbKey]&&ht.el[leaveCbKey](),Te(Fe,[Ne])},enter(Ne){let Fe=B,ht=O,nt=N;if(!_.isMounted)if(S)Fe=Q||B,ht=se||O,nt=oe||N;else return;let Ee=!1;const Ce=Ne[enterCbKey$1]=_e=>{Ee||(Ee=!0,_e?Te(nt,[Ne]):Te(ht,[Ne]),Re.delayedLeave&&Re.delayedLeave(),Ne[enterCbKey$1]=void 0)};Fe?xe(Fe,[Ne,Ce]):Ce()},leave(Ne,Fe){const ht=String(n.key);if(Ne[enterCbKey$1]&&Ne[enterCbKey$1](!0),_.isUnmounting)return Fe();Te(U,[Ne]);let nt=!1;const Ee=Ne[leaveCbKey]=Ce=>{nt||(nt=!0,Fe(),Ce?Te(Z,[Ne]):Te(z,[Ne]),Ne[leaveCbKey]=void 0,we[ht]===n&&delete we[ht])};we[ht]=n,j?xe(j,[Ne,Ee]):Ee()},clone(Ne){return resolveTransitionHooks(Ne,r,_,E)}};return Re}function emptyPlaceholder(n){if(isKeepAlive(n))return n=cloneVNode(n),n.children=null,n}function getKeepAliveChild(n){return isKeepAlive(n)?n.children?n.children[0]:void 0:n}function setTransitionHooks(n,r){n.shapeFlag&6&&n.component?setTransitionHooks(n.component.subTree,r):n.shapeFlag&128?(n.ssContent.transition=r.clone(n.ssContent),n.ssFallback.transition=r.clone(n.ssFallback)):n.transition=r}function getTransitionRawChildren(n,r=!1,_){let E=[],S=0;for(let C=0;C<n.length;C++){let A=n[C];const I=_==null?A.key:String(_)+String(A.key!=null?A.key:C);A.type===Fragment?(A.patchFlag&128&&S++,E=E.concat(getTransitionRawChildren(A.children,r,I))):(r||A.type!==Comment)&&E.push(I!=null?cloneVNode(A,{key:I}):A)}if(S>1)for(let C=0;C<E.length;C++)E[C].patchFlag=-2;return E}/*! #__NO_SIDE_EFFECTS__ */function defineComponent$1(n,r){return isFunction$2(n)?extend$2({name:n.name},r,{setup:n}):n}const isAsyncWrapper=n=>!!n.type.__asyncLoader,isKeepAlive=n=>n.type.__isKeepAlive;function onActivated(n,r){registerKeepAliveHook(n,"a",r)}function onDeactivated(n,r){registerKeepAliveHook(n,"da",r)}function registerKeepAliveHook(n,r,_=currentInstance){const E=n.__wdc||(n.__wdc=()=>{let S=_;for(;S;){if(S.isDeactivated)return;S=S.parent}return n()});if(injectHook(r,E,_),_){let S=_.parent;for(;S&&S.parent;)isKeepAlive(S.parent.vnode)&&injectToKeepAliveRoot(E,r,_,S),S=S.parent}}function injectToKeepAliveRoot(n,r,_,E){const S=injectHook(r,n,E,!0);onUnmounted(()=>{remove$1(E[r],S)},_)}function injectHook(n,r,_=currentInstance,E=!1){if(_){const S=_[n]||(_[n]=[]),C=r.__weh||(r.__weh=(...A)=>{if(_.isUnmounted)return;pauseTracking();const I=setCurrentInstance(_),B=callWithAsyncErrorHandling(r,_,n,A);return I(),resetTracking(),B});return E?S.unshift(C):S.push(C),C}}const createHook=n=>(r,_=currentInstance)=>(!isInSSRComponentSetup||n==="sp")&&injectHook(n,(...E)=>r(...E),_),onBeforeMount=createHook("bm"),onMounted=createHook("m"),onBeforeUpdate=createHook("bu"),onUpdated=createHook("u"),onBeforeUnmount=createHook("bum"),onUnmounted=createHook("um"),onServerPrefetch=createHook("sp"),onRenderTriggered=createHook("rtg"),onRenderTracked=createHook("rtc");function onErrorCaptured(n,r=currentInstance){injectHook("ec",n,r)}function renderList(n,r,_,E){let S;const C=_&&_[E];if(isArray$6(n)||isString$5(n)){S=new Array(n.length);for(let A=0,I=n.length;A<I;A++)S[A]=r(n[A],A,void 0,C&&C[A])}else if(typeof n=="number"){S=new Array(n);for(let A=0;A<n;A++)S[A]=r(A+1,A,void 0,C&&C[A])}else if(isObject$2(n))if(n[Symbol.iterator])S=Array.from(n,(A,I)=>r(A,I,void 0,C&&C[I]));else{const A=Object.keys(n);S=new Array(A.length);for(let I=0,B=A.length;I<B;I++){const O=A[I];S[I]=r(n[O],O,I,C&&C[I])}}else S=[];return _&&(_[E]=S),S}function renderSlot(n,r,_={},E,S){if(currentRenderingInstance.isCE||currentRenderingInstance.parent&&isAsyncWrapper(currentRenderingInstance.parent)&&currentRenderingInstance.parent.isCE)return r!=="default"&&(_.name=r),createVNode("slot",_,E&&E());let C=n[r];C&&C._c&&(C._d=!1),openBlock();const A=C&&ensureValidVNode(C(_)),I=createBlock(Fragment,{key:_.key||A&&A.key||`_${r}`},A||(E?E():[]),A&&n._===1?64:-2);return!S&&I.scopeId&&(I.slotScopeIds=[I.scopeId+"-s"]),C&&C._c&&(C._d=!0),I}function ensureValidVNode(n){return n.some(r=>isVNode(r)?!(r.type===Comment||r.type===Fragment&&!ensureValidVNode(r.children)):!0)?n:null}const getPublicInstance=n=>n?isStatefulComponent(n)?getExposeProxy(n)||n.proxy:getPublicInstance(n.parent):null,publicPropertiesMap=extend$2(Object.create(null),{$:n=>n,$el:n=>n.vnode.el,$data:n=>n.data,$props:n=>n.props,$attrs:n=>n.attrs,$slots:n=>n.slots,$refs:n=>n.refs,$parent:n=>getPublicInstance(n.parent),$root:n=>getPublicInstance(n.root),$emit:n=>n.emit,$options:n=>resolveMergedOptions(n),$forceUpdate:n=>n.f||(n.f=()=>{n.effect.dirty=!0,queueJob(n.update)}),$nextTick:n=>n.n||(n.n=nextTick$3.bind(n.proxy)),$watch:n=>instanceWatch.bind(n)}),hasSetupBinding=(n,r)=>n!==EMPTY_OBJ&&!n.__isScriptSetup&&hasOwn$3(n,r),PublicInstanceProxyHandlers={get({_:n},r){const{ctx:_,setupState:E,data:S,props:C,accessCache:A,type:I,appContext:B}=n;let O;if(r[0]!=="$"){const z=A[r];if(z!==void 0)switch(z){case 1:return E[r];case 2:return S[r];case 4:return _[r];case 3:return C[r]}else{if(hasSetupBinding(E,r))return A[r]=1,E[r];if(S!==EMPTY_OBJ&&hasOwn$3(S,r))return A[r]=2,S[r];if((O=n.propsOptions[0])&&hasOwn$3(O,r))return A[r]=3,C[r];if(_!==EMPTY_OBJ&&hasOwn$3(_,r))return A[r]=4,_[r];shouldCacheAccess&&(A[r]=0)}}const N=publicPropertiesMap[r];let U,j;if(N)return r==="$attrs"&&track(n,"get",r),N(n);if((U=I.__cssModules)&&(U=U[r]))return U;if(_!==EMPTY_OBJ&&hasOwn$3(_,r))return A[r]=4,_[r];if(j=B.config.globalProperties,hasOwn$3(j,r))return j[r]},set({_:n},r,_){const{data:E,setupState:S,ctx:C}=n;return hasSetupBinding(S,r)?(S[r]=_,!0):E!==EMPTY_OBJ&&hasOwn$3(E,r)?(E[r]=_,!0):hasOwn$3(n.props,r)||r[0]==="$"&&r.slice(1)in n?!1:(C[r]=_,!0)},has({_:{data:n,setupState:r,accessCache:_,ctx:E,appContext:S,propsOptions:C}},A){let I;return!!_[A]||n!==EMPTY_OBJ&&hasOwn$3(n,A)||hasSetupBinding(r,A)||(I=C[0])&&hasOwn$3(I,A)||hasOwn$3(E,A)||hasOwn$3(publicPropertiesMap,A)||hasOwn$3(S.config.globalProperties,A)},defineProperty(n,r,_){return _.get!=null?n._.accessCache[r]=0:hasOwn$3(_,"value")&&this.set(n,r,_.value,null),Reflect.defineProperty(n,r,_)}};function normalizePropsOrEmits(n){return isArray$6(n)?n.reduce((r,_)=>(r[_]=null,r),{}):n}let shouldCacheAccess=!0;function applyOptions(n){const r=resolveMergedOptions(n),_=n.proxy,E=n.ctx;shouldCacheAccess=!1,r.beforeCreate&&callHook$1(r.beforeCreate,n,"bc");const{data:S,computed:C,methods:A,watch:I,provide:B,inject:O,created:N,beforeMount:U,mounted:j,beforeUpdate:z,updated:Z,activated:X,deactivated:Q,beforeDestroy:se,beforeUnmount:oe,destroyed:ue,unmounted:we,render:Te,renderTracked:xe,renderTriggered:Re,errorCaptured:Ne,serverPrefetch:Fe,expose:ht,inheritAttrs:nt,components:Ee,directives:Ce,filters:_e}=r;if(O&&resolveInjections(O,E,null),A)for(const Be in A){const Ge=A[Be];isFunction$2(Ge)&&(E[Be]=Ge.bind(_))}if(S){const Be=S.call(_,_);isObject$2(Be)&&(n.data=reactive(Be))}if(shouldCacheAccess=!0,C)for(const Be in C){const Ge=C[Be],je=isFunction$2(Ge)?Ge.bind(_,_):isFunction$2(Ge.get)?Ge.get.bind(_,_):NOOP,Ve=!isFunction$2(Ge)&&isFunction$2(Ge.set)?Ge.set.bind(_):NOOP,Pe=computed({get:je,set:Ve});Object.defineProperty(E,Be,{enumerable:!0,configurable:!0,get:()=>Pe.value,set:Me=>Pe.value=Me})}if(I)for(const Be in I)createWatcher(I[Be],E,_,Be);if(B){const Be=isFunction$2(B)?B.call(_):B;Reflect.ownKeys(Be).forEach(Ge=>{provide(Ge,Be[Ge])})}N&&callHook$1(N,n,"c");function He(Be,Ge){isArray$6(Ge)?Ge.forEach(je=>Be(je.bind(_))):Ge&&Be(Ge.bind(_))}if(He(onBeforeMount,U),He(onMounted,j),He(onBeforeUpdate,z),He(onUpdated,Z),He(onActivated,X),He(onDeactivated,Q),He(onErrorCaptured,Ne),He(onRenderTracked,xe),He(onRenderTriggered,Re),He(onBeforeUnmount,oe),He(onUnmounted,we),He(onServerPrefetch,Fe),isArray$6(ht))if(ht.length){const Be=n.exposed||(n.exposed={});ht.forEach(Ge=>{Object.defineProperty(Be,Ge,{get:()=>_[Ge],set:je=>_[Ge]=je})})}else n.exposed||(n.exposed={});Te&&n.render===NOOP&&(n.render=Te),nt!=null&&(n.inheritAttrs=nt),Ee&&(n.components=Ee),Ce&&(n.directives=Ce)}function resolveInjections(n,r,_=NOOP){isArray$6(n)&&(n=normalizeInject(n));for(const E in n){const S=n[E];let C;isObject$2(S)?"default"in S?C=inject$1(S.from||E,S.default,!0):C=inject$1(S.from||E):C=inject$1(S),isRef(C)?Object.defineProperty(r,E,{enumerable:!0,configurable:!0,get:()=>C.value,set:A=>C.value=A}):r[E]=C}}function callHook$1(n,r,_){callWithAsyncErrorHandling(isArray$6(n)?n.map(E=>E.bind(r.proxy)):n.bind(r.proxy),r,_)}function createWatcher(n,r,_,E){const S=E.includes(".")?createPathGetter(_,E):()=>_[E];if(isString$5(n)){const C=r[n];isFunction$2(C)&&watch(S,C)}else if(isFunction$2(n))watch(S,n.bind(_));else if(isObject$2(n))if(isArray$6(n))n.forEach(C=>createWatcher(C,r,_,E));else{const C=isFunction$2(n.handler)?n.handler.bind(_):r[n.handler];isFunction$2(C)&&watch(S,C,n)}}function resolveMergedOptions(n){const r=n.type,{mixins:_,extends:E}=r,{mixins:S,optionsCache:C,config:{optionMergeStrategies:A}}=n.appContext,I=C.get(r);let B;return I?B=I:!S.length&&!_&&!E?B=r:(B={},S.length&&S.forEach(O=>mergeOptions$b(B,O,A,!0)),mergeOptions$b(B,r,A)),isObject$2(r)&&C.set(r,B),B}function mergeOptions$b(n,r,_,E=!1){const{mixins:S,extends:C}=r;C&&mergeOptions$b(n,C,_,!0),S&&S.forEach(A=>mergeOptions$b(n,A,_,!0));for(const A in r)if(!(E&&A==="expose")){const I=internalOptionMergeStrats[A]||_&&_[A];n[A]=I?I(n[A],r[A]):r[A]}return n}const internalOptionMergeStrats={data:mergeDataFn,props:mergeEmitsOrPropsOptions,emits:mergeEmitsOrPropsOptions,methods:mergeObjectOptions,computed:mergeObjectOptions,beforeCreate:mergeAsArray,created:mergeAsArray,beforeMount:mergeAsArray,mounted:mergeAsArray,beforeUpdate:mergeAsArray,updated:mergeAsArray,beforeDestroy:mergeAsArray,beforeUnmount:mergeAsArray,destroyed:mergeAsArray,unmounted:mergeAsArray,activated:mergeAsArray,deactivated:mergeAsArray,errorCaptured:mergeAsArray,serverPrefetch:mergeAsArray,components:mergeObjectOptions,directives:mergeObjectOptions,watch:mergeWatchOptions,provide:mergeDataFn,inject:mergeInject};function mergeDataFn(n,r){return r?n?function(){return extend$2(isFunction$2(n)?n.call(this,this):n,isFunction$2(r)?r.call(this,this):r)}:r:n}function mergeInject(n,r){return mergeObjectOptions(normalizeInject(n),normalizeInject(r))}function normalizeInject(n){if(isArray$6(n)){const r={};for(let _=0;_<n.length;_++)r[n[_]]=n[_];return r}return n}function mergeAsArray(n,r){return n?[...new Set([].concat(n,r))]:r}function mergeObjectOptions(n,r){return n?extend$2(Object.create(null),n,r):r}function mergeEmitsOrPropsOptions(n,r){return n?isArray$6(n)&&isArray$6(r)?[...new Set([...n,...r])]:extend$2(Object.create(null),normalizePropsOrEmits(n),normalizePropsOrEmits(r??{})):r}function mergeWatchOptions(n,r){if(!n)return r;if(!r)return n;const _=extend$2(Object.create(null),n);for(const E in r)_[E]=mergeAsArray(n[E],r[E]);return _}function createAppContext(){return{app:null,config:{isNativeTag:NO,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let uid$1=0;function createAppAPI(n,r){return function(E,S=null){isFunction$2(E)||(E=extend$2({},E)),S!=null&&!isObject$2(S)&&(S=null);const C=createAppContext(),A=new WeakSet;let I=!1;const B=C.app={_uid:uid$1++,_component:E,_props:S,_container:null,_context:C,_instance:null,version:version$6,get config(){return C.config},set config(O){},use(O,...N){return A.has(O)||(O&&isFunction$2(O.install)?(A.add(O),O.install(B,...N)):isFunction$2(O)&&(A.add(O),O(B,...N))),B},mixin(O){return C.mixins.includes(O)||C.mixins.push(O),B},component(O,N){return N?(C.components[O]=N,B):C.components[O]},directive(O,N){return N?(C.directives[O]=N,B):C.directives[O]},mount(O,N,U){if(!I){const j=createVNode(E,S);return j.appContext=C,U===!0?U="svg":U===!1&&(U=void 0),N&&r?r(j,O):n(j,O,U),I=!0,B._container=O,O.__vue_app__=B,getExposeProxy(j.component)||j.component.proxy}},unmount(){I&&(n(null,B._container),delete B._container.__vue_app__)},provide(O,N){return C.provides[O]=N,B},runWithContext(O){const N=currentApp;currentApp=B;try{return O()}finally{currentApp=N}}};return B}}let currentApp=null;function provide(n,r){if(currentInstance){let _=currentInstance.provides;const E=currentInstance.parent&&currentInstance.parent.provides;E===_&&(_=currentInstance.provides=Object.create(E)),_[n]=r}}function inject$1(n,r,_=!1){const E=currentInstance||currentRenderingInstance;if(E||currentApp){const S=E?E.parent==null?E.vnode.appContext&&E.vnode.appContext.provides:E.parent.provides:currentApp._context.provides;if(S&&n in S)return S[n];if(arguments.length>1)return _&&isFunction$2(r)?r.call(E&&E.proxy):r}}function initProps(n,r,_,E=!1){const S={},C={};def$t(C,InternalObjectKey,1),n.propsDefaults=Object.create(null),setFullProps(n,r,S,C);for(const A in n.propsOptions[0])A in S||(S[A]=void 0);_?n.props=E?S:shallowReactive(S):n.type.props?n.props=S:n.props=C,n.attrs=C}function updateProps(n,r,_,E){const{props:S,attrs:C,vnode:{patchFlag:A}}=n,I=toRaw(S),[B]=n.propsOptions;let O=!1;if((E||A>0)&&!(A&16)){if(A&8){const N=n.vnode.dynamicProps;for(let U=0;U<N.length;U++){let j=N[U];if(isEmitListener(n.emitsOptions,j))continue;const z=r[j];if(B)if(hasOwn$3(C,j))z!==C[j]&&(C[j]=z,O=!0);else{const Z=camelize(j);S[Z]=resolvePropValue(B,I,Z,z,n,!1)}else z!==C[j]&&(C[j]=z,O=!0)}}}else{setFullProps(n,r,S,C)&&(O=!0);let N;for(const U in I)(!r||!hasOwn$3(r,U)&&((N=hyphenate(U))===U||!hasOwn$3(r,N)))&&(B?_&&(_[U]!==void 0||_[N]!==void 0)&&(S[U]=resolvePropValue(B,I,U,void 0,n,!0)):delete S[U]);if(C!==I)for(const U in C)(!r||!hasOwn$3(r,U))&&(delete C[U],O=!0)}O&&trigger(n,"set","$attrs")}function setFullProps(n,r,_,E){const[S,C]=n.propsOptions;let A=!1,I;if(r)for(let B in r){if(isReservedProp(B))continue;const O=r[B];let N;S&&hasOwn$3(S,N=camelize(B))?!C||!C.includes(N)?_[N]=O:(I||(I={}))[N]=O:isEmitListener(n.emitsOptions,B)||(!(B in E)||O!==E[B])&&(E[B]=O,A=!0)}if(C){const B=toRaw(_),O=I||EMPTY_OBJ;for(let N=0;N<C.length;N++){const U=C[N];_[U]=resolvePropValue(S,B,U,O[U],n,!hasOwn$3(O,U))}}return A}function resolvePropValue(n,r,_,E,S,C){const A=n[_];if(A!=null){const I=hasOwn$3(A,"default");if(I&&E===void 0){const B=A.default;if(A.type!==Function&&!A.skipFactory&&isFunction$2(B)){const{propsDefaults:O}=S;if(_ in O)E=O[_];else{const N=setCurrentInstance(S);E=O[_]=B.call(null,r),N()}}else E=B}A[0]&&(C&&!I?E=!1:A[1]&&(E===""||E===hyphenate(_))&&(E=!0))}return E}function normalizePropsOptions(n,r,_=!1){const E=r.propsCache,S=E.get(n);if(S)return S;const C=n.props,A={},I=[];let B=!1;if(!isFunction$2(n)){const N=U=>{B=!0;const[j,z]=normalizePropsOptions(U,r,!0);extend$2(A,j),z&&I.push(...z)};!_&&r.mixins.length&&r.mixins.forEach(N),n.extends&&N(n.extends),n.mixins&&n.mixins.forEach(N)}if(!C&&!B)return isObject$2(n)&&E.set(n,EMPTY_ARR),EMPTY_ARR;if(isArray$6(C))for(let N=0;N<C.length;N++){const U=camelize(C[N]);validatePropName(U)&&(A[U]=EMPTY_OBJ)}else if(C)for(const N in C){const U=camelize(N);if(validatePropName(U)){const j=C[N],z=A[U]=isArray$6(j)||isFunction$2(j)?{type:j}:extend$2({},j);if(z){const Z=getTypeIndex(Boolean,z.type),X=getTypeIndex(String,z.type);z[0]=Z>-1,z[1]=X<0||Z<X,(Z>-1||hasOwn$3(z,"default"))&&I.push(U)}}}const O=[A,I];return isObject$2(n)&&E.set(n,O),O}function validatePropName(n){return n[0]!=="$"&&!isReservedProp(n)}function getType(n){return n===null?"null":typeof n=="function"?n.name||"":typeof n=="object"&&n.constructor&&n.constructor.name||""}function isSameType(n,r){return getType(n)===getType(r)}function getTypeIndex(n,r){return isArray$6(r)?r.findIndex(_=>isSameType(_,n)):isFunction$2(r)&&isSameType(r,n)?0:-1}const isInternalKey=n=>n[0]==="_"||n==="$stable",normalizeSlotValue=n=>isArray$6(n)?n.map(normalizeVNode):[normalizeVNode(n)],normalizeSlot$1=(n,r,_)=>{if(r._n)return r;const E=withCtx((...S)=>normalizeSlotValue(r(...S)),_);return E._c=!1,E},normalizeObjectSlots=(n,r,_)=>{const E=n._ctx;for(const S in n){if(isInternalKey(S))continue;const C=n[S];if(isFunction$2(C))r[S]=normalizeSlot$1(S,C,E);else if(C!=null){const A=normalizeSlotValue(C);r[S]=()=>A}}},normalizeVNodeSlots=(n,r)=>{const _=normalizeSlotValue(r);n.slots.default=()=>_},initSlots=(n,r)=>{if(n.vnode.shapeFlag&32){const _=r._;_?(n.slots=toRaw(r),def$t(r,"_",_)):normalizeObjectSlots(r,n.slots={})}else n.slots={},r&&normalizeVNodeSlots(n,r);def$t(n.slots,InternalObjectKey,1)},updateSlots=(n,r,_)=>{const{vnode:E,slots:S}=n;let C=!0,A=EMPTY_OBJ;if(E.shapeFlag&32){const I=r._;I?_&&I===1?C=!1:(extend$2(S,r),!_&&I===1&&delete S._):(C=!r.$stable,normalizeObjectSlots(r,S)),A=r}else r&&(normalizeVNodeSlots(n,r),A={default:1});if(C)for(const I in S)!isInternalKey(I)&&A[I]==null&&delete S[I]};function setRef(n,r,_,E,S=!1){if(isArray$6(n)){n.forEach((j,z)=>setRef(j,r&&(isArray$6(r)?r[z]:r),_,E,S));return}if(isAsyncWrapper(E)&&!S)return;const C=E.shapeFlag&4?getExposeProxy(E.component)||E.component.proxy:E.el,A=S?null:C,{i:I,r:B}=n,O=r&&r.r,N=I.refs===EMPTY_OBJ?I.refs={}:I.refs,U=I.setupState;if(O!=null&&O!==B&&(isString$5(O)?(N[O]=null,hasOwn$3(U,O)&&(U[O]=null)):isRef(O)&&(O.value=null)),isFunction$2(B))callWithErrorHandling(B,I,12,[A,N]);else{const j=isString$5(B),z=isRef(B);if(j||z){const Z=()=>{if(n.f){const X=j?hasOwn$3(U,B)?U[B]:N[B]:B.value;S?isArray$6(X)&&remove$1(X,C):isArray$6(X)?X.includes(C)||X.push(C):j?(N[B]=[C],hasOwn$3(U,B)&&(U[B]=N[B])):(B.value=[C],n.k&&(N[n.k]=B.value))}else j?(N[B]=A,hasOwn$3(U,B)&&(U[B]=A)):z&&(B.value=A,n.k&&(N[n.k]=A))};A?(Z.id=-1,queuePostRenderEffect(Z,_)):Z()}}}const queuePostRenderEffect=queueEffectWithSuspense;function createRenderer(n){return baseCreateRenderer(n)}function baseCreateRenderer(n,r){const _=getGlobalThis();_.__VUE__=!0;const{insert:E,remove:S,patchProp:C,createElement:A,createText:I,createComment:B,setText:O,setElementText:N,parentNode:U,nextSibling:j,setScopeId:z=NOOP,insertStaticContent:Z}=n,X=(Et,Ye,Ct,Pt=null,St=null,$t=null,kt=void 0,Ft=null,qt=!!Ye.dynamicChildren)=>{if(Et===Ye)return;Et&&!isSameVNodeType(Et,Ye)&&(Pt=Qe(Et),Me(Et,St,$t,!0),Et=null),Ye.patchFlag===-2&&(qt=!1,Ye.dynamicChildren=null);const{type:Mt,ref:Wt,shapeFlag:Zt}=Ye;switch(Mt){case Text:Q(Et,Ye,Ct,Pt);break;case Comment:se(Et,Ye,Ct,Pt);break;case Static:Et==null&&oe(Ye,Ct,Pt,kt);break;case Fragment:Ee(Et,Ye,Ct,Pt,St,$t,kt,Ft,qt);break;default:Zt&1?Te(Et,Ye,Ct,Pt,St,$t,kt,Ft,qt):Zt&6?Ce(Et,Ye,Ct,Pt,St,$t,kt,Ft,qt):(Zt&64||Zt&128)&&Mt.process(Et,Ye,Ct,Pt,St,$t,kt,Ft,qt,At)}Wt!=null&&St&&setRef(Wt,Et&&Et.ref,$t,Ye||Et,!Ye)},Q=(Et,Ye,Ct,Pt)=>{if(Et==null)E(Ye.el=I(Ye.children),Ct,Pt);else{const St=Ye.el=Et.el;Ye.children!==Et.children&&O(St,Ye.children)}},se=(Et,Ye,Ct,Pt)=>{Et==null?E(Ye.el=B(Ye.children||""),Ct,Pt):Ye.el=Et.el},oe=(Et,Ye,Ct,Pt)=>{[Et.el,Et.anchor]=Z(Et.children,Ye,Ct,Pt,Et.el,Et.anchor)},ue=({el:Et,anchor:Ye},Ct,Pt)=>{let St;for(;Et&&Et!==Ye;)St=j(Et),E(Et,Ct,Pt),Et=St;E(Ye,Ct,Pt)},we=({el:Et,anchor:Ye})=>{let Ct;for(;Et&&Et!==Ye;)Ct=j(Et),S(Et),Et=Ct;S(Ye)},Te=(Et,Ye,Ct,Pt,St,$t,kt,Ft,qt)=>{Ye.type==="svg"?kt="svg":Ye.type==="math"&&(kt="mathml"),Et==null?xe(Ye,Ct,Pt,St,$t,kt,Ft,qt):Fe(Et,Ye,St,$t,kt,Ft,qt)},xe=(Et,Ye,Ct,Pt,St,$t,kt,Ft)=>{let qt,Mt;const{props:Wt,shapeFlag:Zt,transition:Yt,dirs:ur}=Et;if(qt=Et.el=A(Et.type,$t,Wt&&Wt.is,Wt),Zt&8?N(qt,Et.children):Zt&16&&Ne(Et.children,qt,null,Pt,St,resolveChildrenNamespace(Et,$t),kt,Ft),ur&&invokeDirectiveHook(Et,null,Pt,"created"),Re(qt,Et,Et.scopeId,kt,Pt),Wt){for(const pt in Wt)pt!=="value"&&!isReservedProp(pt)&&C(qt,pt,null,Wt[pt],$t,Et.children,Pt,St,ct);"value"in Wt&&C(qt,"value",null,Wt.value,$t),(Mt=Wt.onVnodeBeforeMount)&&invokeVNodeHook(Mt,Pt,Et)}ur&&invokeDirectiveHook(Et,null,Pt,"beforeMount");const xt=needTransition(St,Yt);xt&&Yt.beforeEnter(qt),E(qt,Ye,Ct),((Mt=Wt&&Wt.onVnodeMounted)||xt||ur)&&queuePostRenderEffect(()=>{Mt&&invokeVNodeHook(Mt,Pt,Et),xt&&Yt.enter(qt),ur&&invokeDirectiveHook(Et,null,Pt,"mounted")},St)},Re=(Et,Ye,Ct,Pt,St)=>{if(Ct&&z(Et,Ct),Pt)for(let $t=0;$t<Pt.length;$t++)z(Et,Pt[$t]);if(St){let $t=St.subTree;if(Ye===$t){const kt=St.vnode;Re(Et,kt,kt.scopeId,kt.slotScopeIds,St.parent)}}},Ne=(Et,Ye,Ct,Pt,St,$t,kt,Ft,qt=0)=>{for(let Mt=qt;Mt<Et.length;Mt++){const Wt=Et[Mt]=Ft?cloneIfMounted(Et[Mt]):normalizeVNode(Et[Mt]);X(null,Wt,Ye,Ct,Pt,St,$t,kt,Ft)}},Fe=(Et,Ye,Ct,Pt,St,$t,kt)=>{const Ft=Ye.el=Et.el;let{patchFlag:qt,dynamicChildren:Mt,dirs:Wt}=Ye;qt|=Et.patchFlag&16;const Zt=Et.props||EMPTY_OBJ,Yt=Ye.props||EMPTY_OBJ;let ur;if(Ct&&toggleRecurse(Ct,!1),(ur=Yt.onVnodeBeforeUpdate)&&invokeVNodeHook(ur,Ct,Ye,Et),Wt&&invokeDirectiveHook(Ye,Et,Ct,"beforeUpdate"),Ct&&toggleRecurse(Ct,!0),Mt?ht(Et.dynamicChildren,Mt,Ft,Ct,Pt,resolveChildrenNamespace(Ye,St),$t):kt||Ge(Et,Ye,Ft,null,Ct,Pt,resolveChildrenNamespace(Ye,St),$t,!1),qt>0){if(qt&16)nt(Ft,Ye,Zt,Yt,Ct,Pt,St);else if(qt&2&&Zt.class!==Yt.class&&C(Ft,"class",null,Yt.class,St),qt&4&&C(Ft,"style",Zt.style,Yt.style,St),qt&8){const xt=Ye.dynamicProps;for(let pt=0;pt<xt.length;pt++){const yt=xt[pt],Bt=Zt[yt],Ht=Yt[yt];(Ht!==Bt||yt==="value")&&C(Ft,yt,Bt,Ht,St,Et.children,Ct,Pt,ct)}}qt&1&&Et.children!==Ye.children&&N(Ft,Ye.children)}else!kt&&Mt==null&&nt(Ft,Ye,Zt,Yt,Ct,Pt,St);((ur=Yt.onVnodeUpdated)||Wt)&&queuePostRenderEffect(()=>{ur&&invokeVNodeHook(ur,Ct,Ye,Et),Wt&&invokeDirectiveHook(Ye,Et,Ct,"updated")},Pt)},ht=(Et,Ye,Ct,Pt,St,$t,kt)=>{for(let Ft=0;Ft<Ye.length;Ft++){const qt=Et[Ft],Mt=Ye[Ft],Wt=qt.el&&(qt.type===Fragment||!isSameVNodeType(qt,Mt)||qt.shapeFlag&70)?U(qt.el):Ct;X(qt,Mt,Wt,null,Pt,St,$t,kt,!0)}},nt=(Et,Ye,Ct,Pt,St,$t,kt)=>{if(Ct!==Pt){if(Ct!==EMPTY_OBJ)for(const Ft in Ct)!isReservedProp(Ft)&&!(Ft in Pt)&&C(Et,Ft,Ct[Ft],null,kt,Ye.children,St,$t,ct);for(const Ft in Pt){if(isReservedProp(Ft))continue;const qt=Pt[Ft],Mt=Ct[Ft];qt!==Mt&&Ft!=="value"&&C(Et,Ft,Mt,qt,kt,Ye.children,St,$t,ct)}"value"in Pt&&C(Et,"value",Ct.value,Pt.value,kt)}},Ee=(Et,Ye,Ct,Pt,St,$t,kt,Ft,qt)=>{const Mt=Ye.el=Et?Et.el:I(""),Wt=Ye.anchor=Et?Et.anchor:I("");let{patchFlag:Zt,dynamicChildren:Yt,slotScopeIds:ur}=Ye;ur&&(Ft=Ft?Ft.concat(ur):ur),Et==null?(E(Mt,Ct,Pt),E(Wt,Ct,Pt),Ne(Ye.children||[],Ct,Wt,St,$t,kt,Ft,qt)):Zt>0&&Zt&64&&Yt&&Et.dynamicChildren?(ht(Et.dynamicChildren,Yt,Ct,St,$t,kt,Ft),(Ye.key!=null||St&&Ye===St.subTree)&&traverseStaticChildren(Et,Ye,!0)):Ge(Et,Ye,Ct,Wt,St,$t,kt,Ft,qt)},Ce=(Et,Ye,Ct,Pt,St,$t,kt,Ft,qt)=>{Ye.slotScopeIds=Ft,Et==null?Ye.shapeFlag&512?St.ctx.activate(Ye,Ct,Pt,kt,qt):_e(Ye,Ct,Pt,St,$t,kt,qt):Ie(Et,Ye,qt)},_e=(Et,Ye,Ct,Pt,St,$t,kt)=>{const Ft=Et.component=createComponentInstance(Et,Pt,St);if(isKeepAlive(Et)&&(Ft.ctx.renderer=At),setupComponent(Ft),Ft.asyncDep){if(St&&St.registerDep(Ft,He),!Et.el){const qt=Ft.subTree=createVNode(Comment);se(null,qt,Ye,Ct)}}else He(Ft,Et,Ye,Ct,St,$t,kt)},Ie=(Et,Ye,Ct)=>{const Pt=Ye.component=Et.component;if(shouldUpdateComponent(Et,Ye,Ct))if(Pt.asyncDep&&!Pt.asyncResolved){Be(Pt,Ye,Ct);return}else Pt.next=Ye,invalidateJob(Pt.update),Pt.effect.dirty=!0,Pt.update();else Ye.el=Et.el,Pt.vnode=Ye},He=(Et,Ye,Ct,Pt,St,$t,kt)=>{const Ft=()=>{if(Et.isMounted){let{next:Wt,bu:Zt,u:Yt,parent:ur,vnode:xt}=Et;{const nr=locateNonHydratedAsyncRoot(Et);if(nr){Wt&&(Wt.el=xt.el,Be(Et,Wt,kt)),nr.asyncDep.then(()=>{Et.isUnmounted||Ft()});return}}let pt=Wt,yt;toggleRecurse(Et,!1),Wt?(Wt.el=xt.el,Be(Et,Wt,kt)):Wt=xt,Zt&&invokeArrayFns(Zt),(yt=Wt.props&&Wt.props.onVnodeBeforeUpdate)&&invokeVNodeHook(yt,ur,Wt,xt),toggleRecurse(Et,!0);const Bt=renderComponentRoot(Et),Ht=Et.subTree;Et.subTree=Bt,X(Ht,Bt,U(Ht.el),Qe(Ht),Et,St,$t),Wt.el=Bt.el,pt===null&&updateHOCHostEl(Et,Bt.el),Yt&&queuePostRenderEffect(Yt,St),(yt=Wt.props&&Wt.props.onVnodeUpdated)&&queuePostRenderEffect(()=>invokeVNodeHook(yt,ur,Wt,xt),St)}else{let Wt;const{el:Zt,props:Yt}=Ye,{bm:ur,m:xt,parent:pt}=Et,yt=isAsyncWrapper(Ye);if(toggleRecurse(Et,!1),ur&&invokeArrayFns(ur),!yt&&(Wt=Yt&&Yt.onVnodeBeforeMount)&&invokeVNodeHook(Wt,pt,Ye),toggleRecurse(Et,!0),Zt&&ft){const Bt=()=>{Et.subTree=renderComponentRoot(Et),ft(Zt,Et.subTree,Et,St,null)};yt?Ye.type.__asyncLoader().then(()=>!Et.isUnmounted&&Bt()):Bt()}else{const Bt=Et.subTree=renderComponentRoot(Et);X(null,Bt,Ct,Pt,Et,St,$t),Ye.el=Bt.el}if(xt&&queuePostRenderEffect(xt,St),!yt&&(Wt=Yt&&Yt.onVnodeMounted)){const Bt=Ye;queuePostRenderEffect(()=>invokeVNodeHook(Wt,pt,Bt),St)}(Ye.shapeFlag&256||pt&&isAsyncWrapper(pt.vnode)&&pt.vnode.shapeFlag&256)&&Et.a&&queuePostRenderEffect(Et.a,St),Et.isMounted=!0,Ye=Ct=Pt=null}},qt=Et.effect=new ReactiveEffect(Ft,NOOP,()=>queueJob(Mt),Et.scope),Mt=Et.update=()=>{qt.dirty&&qt.run()};Mt.id=Et.uid,toggleRecurse(Et,!0),Mt()},Be=(Et,Ye,Ct)=>{Ye.component=Et;const Pt=Et.vnode.props;Et.vnode=Ye,Et.next=null,updateProps(Et,Ye.props,Pt,Ct),updateSlots(Et,Ye.children,Ct),pauseTracking(),flushPreFlushCbs(Et),resetTracking()},Ge=(Et,Ye,Ct,Pt,St,$t,kt,Ft,qt=!1)=>{const Mt=Et&&Et.children,Wt=Et?Et.shapeFlag:0,Zt=Ye.children,{patchFlag:Yt,shapeFlag:ur}=Ye;if(Yt>0){if(Yt&128){Ve(Mt,Zt,Ct,Pt,St,$t,kt,Ft,qt);return}else if(Yt&256){je(Mt,Zt,Ct,Pt,St,$t,kt,Ft,qt);return}}ur&8?(Wt&16&&ct(Mt,St,$t),Zt!==Mt&&N(Ct,Zt)):Wt&16?ur&16?Ve(Mt,Zt,Ct,Pt,St,$t,kt,Ft,qt):ct(Mt,St,$t,!0):(Wt&8&&N(Ct,""),ur&16&&Ne(Zt,Ct,Pt,St,$t,kt,Ft,qt))},je=(Et,Ye,Ct,Pt,St,$t,kt,Ft,qt)=>{Et=Et||EMPTY_ARR,Ye=Ye||EMPTY_ARR;const Mt=Et.length,Wt=Ye.length,Zt=Math.min(Mt,Wt);let Yt;for(Yt=0;Yt<Zt;Yt++){const ur=Ye[Yt]=qt?cloneIfMounted(Ye[Yt]):normalizeVNode(Ye[Yt]);X(Et[Yt],ur,Ct,null,St,$t,kt,Ft,qt)}Mt>Wt?ct(Et,St,$t,!0,!1,Zt):Ne(Ye,Ct,Pt,St,$t,kt,Ft,qt,Zt)},Ve=(Et,Ye,Ct,Pt,St,$t,kt,Ft,qt)=>{let Mt=0;const Wt=Ye.length;let Zt=Et.length-1,Yt=Wt-1;for(;Mt<=Zt&&Mt<=Yt;){const ur=Et[Mt],xt=Ye[Mt]=qt?cloneIfMounted(Ye[Mt]):normalizeVNode(Ye[Mt]);if(isSameVNodeType(ur,xt))X(ur,xt,Ct,null,St,$t,kt,Ft,qt);else break;Mt++}for(;Mt<=Zt&&Mt<=Yt;){const ur=Et[Zt],xt=Ye[Yt]=qt?cloneIfMounted(Ye[Yt]):normalizeVNode(Ye[Yt]);if(isSameVNodeType(ur,xt))X(ur,xt,Ct,null,St,$t,kt,Ft,qt);else break;Zt--,Yt--}if(Mt>Zt){if(Mt<=Yt){const ur=Yt+1,xt=ur<Wt?Ye[ur].el:Pt;for(;Mt<=Yt;)X(null,Ye[Mt]=qt?cloneIfMounted(Ye[Mt]):normalizeVNode(Ye[Mt]),Ct,xt,St,$t,kt,Ft,qt),Mt++}}else if(Mt>Yt)for(;Mt<=Zt;)Me(Et[Mt],St,$t,!0),Mt++;else{const ur=Mt,xt=Mt,pt=new Map;for(Mt=xt;Mt<=Yt;Mt++){const Sr=Ye[Mt]=qt?cloneIfMounted(Ye[Mt]):normalizeVNode(Ye[Mt]);Sr.key!=null&&pt.set(Sr.key,Mt)}let yt,Bt=0;const Ht=Yt-xt+1;let nr=!1,Qt=0;const xr=new Array(Ht);for(Mt=0;Mt<Ht;Mt++)xr[Mt]=0;for(Mt=ur;Mt<=Zt;Mt++){const Sr=Et[Mt];if(Bt>=Ht){Me(Sr,St,$t,!0);continue}let $r;if(Sr.key!=null)$r=pt.get(Sr.key);else for(yt=xt;yt<=Yt;yt++)if(xr[yt-xt]===0&&isSameVNodeType(Sr,Ye[yt])){$r=yt;break}$r===void 0?Me(Sr,St,$t,!0):(xr[$r-xt]=Mt+1,$r>=Qt?Qt=$r:nr=!0,X(Sr,Ye[$r],Ct,null,St,$t,kt,Ft,qt),Bt++)}const kr=nr?getSequence(xr):EMPTY_ARR;for(yt=kr.length-1,Mt=Ht-1;Mt>=0;Mt--){const Sr=xt+Mt,$r=Ye[Sr],Rr=Sr+1<Wt?Ye[Sr+1].el:Pt;xr[Mt]===0?X(null,$r,Ct,Rr,St,$t,kt,Ft,qt):nr&&(yt<0||Mt!==kr[yt]?Pe($r,Ct,Rr,2):yt--)}}},Pe=(Et,Ye,Ct,Pt,St=null)=>{const{el:$t,type:kt,transition:Ft,children:qt,shapeFlag:Mt}=Et;if(Mt&6){Pe(Et.component.subTree,Ye,Ct,Pt);return}if(Mt&128){Et.suspense.move(Ye,Ct,Pt);return}if(Mt&64){kt.move(Et,Ye,Ct,At);return}if(kt===Fragment){E($t,Ye,Ct);for(let Zt=0;Zt<qt.length;Zt++)Pe(qt[Zt],Ye,Ct,Pt);E(Et.anchor,Ye,Ct);return}if(kt===Static){ue(Et,Ye,Ct);return}if(Pt!==2&&Mt&1&&Ft)if(Pt===0)Ft.beforeEnter($t),E($t,Ye,Ct),queuePostRenderEffect(()=>Ft.enter($t),St);else{const{leave:Zt,delayLeave:Yt,afterLeave:ur}=Ft,xt=()=>E($t,Ye,Ct),pt=()=>{Zt($t,()=>{xt(),ur&&ur()})};Yt?Yt($t,xt,pt):pt()}else E($t,Ye,Ct)},Me=(Et,Ye,Ct,Pt=!1,St=!1)=>{const{type:$t,props:kt,ref:Ft,children:qt,dynamicChildren:Mt,shapeFlag:Wt,patchFlag:Zt,dirs:Yt}=Et;if(Ft!=null&&setRef(Ft,null,Ct,Et,!0),Wt&256){Ye.ctx.deactivate(Et);return}const ur=Wt&1&&Yt,xt=!isAsyncWrapper(Et);let pt;if(xt&&(pt=kt&&kt.onVnodeBeforeUnmount)&&invokeVNodeHook(pt,Ye,Et),Wt&6)mt(Et.component,Ct,Pt);else{if(Wt&128){Et.suspense.unmount(Ct,Pt);return}ur&&invokeDirectiveHook(Et,null,Ye,"beforeUnmount"),Wt&64?Et.type.remove(Et,Ye,Ct,St,At,Pt):Mt&&($t!==Fragment||Zt>0&&Zt&64)?ct(Mt,Ye,Ct,!1,!0):($t===Fragment&&Zt&384||!St&&Wt&16)&&ct(qt,Ye,Ct),Pt&&tt(Et)}(xt&&(pt=kt&&kt.onVnodeUnmounted)||ur)&&queuePostRenderEffect(()=>{pt&&invokeVNodeHook(pt,Ye,Et),ur&&invokeDirectiveHook(Et,null,Ye,"unmounted")},Ct)},tt=Et=>{const{type:Ye,el:Ct,anchor:Pt,transition:St}=Et;if(Ye===Fragment){Ke(Ct,Pt);return}if(Ye===Static){we(Et);return}const $t=()=>{S(Ct),St&&!St.persisted&&St.afterLeave&&St.afterLeave()};if(Et.shapeFlag&1&&St&&!St.persisted){const{leave:kt,delayLeave:Ft}=St,qt=()=>kt(Ct,$t);Ft?Ft(Et.el,$t,qt):qt()}else $t()},Ke=(Et,Ye)=>{let Ct;for(;Et!==Ye;)Ct=j(Et),S(Et),Et=Ct;S(Ye)},mt=(Et,Ye,Ct)=>{const{bum:Pt,scope:St,update:$t,subTree:kt,um:Ft}=Et;Pt&&invokeArrayFns(Pt),St.stop(),$t&&($t.active=!1,Me(kt,Et,Ye,Ct)),Ft&&queuePostRenderEffect(Ft,Ye),queuePostRenderEffect(()=>{Et.isUnmounted=!0},Ye),Ye&&Ye.pendingBranch&&!Ye.isUnmounted&&Et.asyncDep&&!Et.asyncResolved&&Et.suspenseId===Ye.pendingId&&(Ye.deps--,Ye.deps===0&&Ye.resolve())},ct=(Et,Ye,Ct,Pt=!1,St=!1,$t=0)=>{for(let kt=$t;kt<Et.length;kt++)Me(Et[kt],Ye,Ct,Pt,St)},Qe=Et=>Et.shapeFlag&6?Qe(Et.component.subTree):Et.shapeFlag&128?Et.suspense.next():j(Et.anchor||Et.el);let dt=!1;const vt=(Et,Ye,Ct)=>{Et==null?Ye._vnode&&Me(Ye._vnode,null,null,!0):X(Ye._vnode||null,Et,Ye,null,null,null,Ct),dt||(dt=!0,flushPreFlushCbs(),flushPostFlushCbs(),dt=!1),Ye._vnode=Et},At={p:X,um:Me,m:Pe,r:tt,mt:_e,mc:Ne,pc:Ge,pbc:ht,n:Qe,o:n};let bt,ft;return r&&([bt,ft]=r(At)),{render:vt,hydrate:bt,createApp:createAppAPI(vt,bt)}}function resolveChildrenNamespace({type:n,props:r},_){return _==="svg"&&n==="foreignObject"||_==="mathml"&&n==="annotation-xml"&&r&&r.encoding&&r.encoding.includes("html")?void 0:_}function toggleRecurse({effect:n,update:r},_){n.allowRecurse=r.allowRecurse=_}function needTransition(n,r){return(!n||n&&!n.pendingBranch)&&r&&!r.persisted}function traverseStaticChildren(n,r,_=!1){const E=n.children,S=r.children;if(isArray$6(E)&&isArray$6(S))for(let C=0;C<E.length;C++){const A=E[C];let I=S[C];I.shapeFlag&1&&!I.dynamicChildren&&((I.patchFlag<=0||I.patchFlag===32)&&(I=S[C]=cloneIfMounted(S[C]),I.el=A.el),_||traverseStaticChildren(A,I)),I.type===Text&&(I.el=A.el)}}function getSequence(n){const r=n.slice(),_=[0];let E,S,C,A,I;const B=n.length;for(E=0;E<B;E++){const O=n[E];if(O!==0){if(S=_[_.length-1],n[S]<O){r[E]=S,_.push(E);continue}for(C=0,A=_.length-1;C<A;)I=C+A>>1,n[_[I]]<O?C=I+1:A=I;O<n[_[C]]&&(C>0&&(r[E]=_[C-1]),_[C]=E)}}for(C=_.length,A=_[C-1];C-- >0;)_[C]=A,A=r[A];return _}function locateNonHydratedAsyncRoot(n){const r=n.subTree.component;if(r)return r.asyncDep&&!r.asyncResolved?r:locateNonHydratedAsyncRoot(r)}const isTeleport=n=>n.__isTeleport,isTeleportDisabled=n=>n&&(n.disabled||n.disabled===""),isTargetSVG=n=>typeof SVGElement<"u"&&n instanceof SVGElement,isTargetMathML=n=>typeof MathMLElement=="function"&&n instanceof MathMLElement,resolveTarget=(n,r)=>{const _=n&&n.to;return isString$5(_)?r?r(_):null:_},TeleportImpl={name:"Teleport",__isTeleport:!0,process(n,r,_,E,S,C,A,I,B,O){const{mc:N,pc:U,pbc:j,o:{insert:z,querySelector:Z,createText:X,createComment:Q}}=O,se=isTeleportDisabled(r.props);let{shapeFlag:oe,children:ue,dynamicChildren:we}=r;if(n==null){const Te=r.el=X(""),xe=r.anchor=X("");z(Te,_,E),z(xe,_,E);const Re=r.target=resolveTarget(r.props,Z),Ne=r.targetAnchor=X("");Re&&(z(Ne,Re),A==="svg"||isTargetSVG(Re)?A="svg":(A==="mathml"||isTargetMathML(Re))&&(A="mathml"));const Fe=(ht,nt)=>{oe&16&&N(ue,ht,nt,S,C,A,I,B)};se?Fe(_,xe):Re&&Fe(Re,Ne)}else{r.el=n.el;const Te=r.anchor=n.anchor,xe=r.target=n.target,Re=r.targetAnchor=n.targetAnchor,Ne=isTeleportDisabled(n.props),Fe=Ne?_:xe,ht=Ne?Te:Re;if(A==="svg"||isTargetSVG(xe)?A="svg":(A==="mathml"||isTargetMathML(xe))&&(A="mathml"),we?(j(n.dynamicChildren,we,Fe,S,C,A,I),traverseStaticChildren(n,r,!0)):B||U(n,r,Fe,ht,S,C,A,I,!1),se)Ne?r.props&&n.props&&r.props.to!==n.props.to&&(r.props.to=n.props.to):moveTeleport(r,_,Te,O,1);else if((r.props&&r.props.to)!==(n.props&&n.props.to)){const nt=r.target=resolveTarget(r.props,Z);nt&&moveTeleport(r,nt,null,O,0)}else Ne&&moveTeleport(r,xe,Re,O,1)}updateCssVars(r)},remove(n,r,_,E,{um:S,o:{remove:C}},A){const{shapeFlag:I,children:B,anchor:O,targetAnchor:N,target:U,props:j}=n;if(U&&C(N),A&&C(O),I&16){const z=A||!isTeleportDisabled(j);for(let Z=0;Z<B.length;Z++){const X=B[Z];S(X,r,_,z,!!X.dynamicChildren)}}},move:moveTeleport,hydrate:hydrateTeleport};function moveTeleport(n,r,_,{o:{insert:E},m:S},C=2){C===0&&E(n.targetAnchor,r,_);const{el:A,anchor:I,shapeFlag:B,children:O,props:N}=n,U=C===2;if(U&&E(A,r,_),(!U||isTeleportDisabled(N))&&B&16)for(let j=0;j<O.length;j++)S(O[j],r,_,2);U&&E(I,r,_)}function hydrateTeleport(n,r,_,E,S,C,{o:{nextSibling:A,parentNode:I,querySelector:B}},O){const N=r.target=resolveTarget(r.props,B);if(N){const U=N._lpa||N.firstChild;if(r.shapeFlag&16)if(isTeleportDisabled(r.props))r.anchor=O(A(n),r,I(n),_,E,S,C),r.targetAnchor=U;else{r.anchor=A(n);let j=U;for(;j;)if(j=A(j),j&&j.nodeType===8&&j.data==="teleport anchor"){r.targetAnchor=j,N._lpa=r.targetAnchor&&A(r.targetAnchor);break}O(U,r,N,_,E,S,C)}updateCssVars(r)}return r.anchor&&A(r.anchor)}const Teleport=TeleportImpl;function updateCssVars(n){const r=n.ctx;if(r&&r.ut){let _=n.children[0].el;for(;_&&_!==n.targetAnchor;)_.nodeType===1&&_.setAttribute("data-v-owner",r.uid),_=_.nextSibling;r.ut()}}const Fragment=Symbol.for("v-fgt"),Text=Symbol.for("v-txt"),Comment=Symbol.for("v-cmt"),Static=Symbol.for("v-stc"),blockStack=[];let currentBlock=null;function openBlock(n=!1){blockStack.push(currentBlock=n?null:[])}function closeBlock(){blockStack.pop(),currentBlock=blockStack[blockStack.length-1]||null}let isBlockTreeEnabled=1;function setBlockTracking(n){isBlockTreeEnabled+=n}function setupBlock(n){return n.dynamicChildren=isBlockTreeEnabled>0?currentBlock||EMPTY_ARR:null,closeBlock(),isBlockTreeEnabled>0&&currentBlock&&currentBlock.push(n),n}function createElementBlock(n,r,_,E,S,C){return setupBlock(createBaseVNode(n,r,_,E,S,C,!0))}function createBlock(n,r,_,E,S){return setupBlock(createVNode(n,r,_,E,S,!0))}function isVNode(n){return n?n.__v_isVNode===!0:!1}function isSameVNodeType(n,r){return n.type===r.type&&n.key===r.key}const InternalObjectKey="__vInternal",normalizeKey=({key:n})=>n??null,normalizeRef=({ref:n,ref_key:r,ref_for:_})=>(typeof n=="number"&&(n=""+n),n!=null?isString$5(n)||isRef(n)||isFunction$2(n)?{i:currentRenderingInstance,r:n,k:r,f:!!_}:n:null);function createBaseVNode(n,r=null,_=null,E=0,S=null,C=n===Fragment?0:1,A=!1,I=!1){const B={__v_isVNode:!0,__v_skip:!0,type:n,props:r,key:r&&normalizeKey(r),ref:r&&normalizeRef(r),scopeId:currentScopeId,slotScopeIds:null,children:_,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetAnchor:null,staticCount:0,shapeFlag:C,patchFlag:E,dynamicProps:S,dynamicChildren:null,appContext:null,ctx:currentRenderingInstance};return I?(normalizeChildren(B,_),C&128&&n.normalize(B)):_&&(B.shapeFlag|=isString$5(_)?8:16),isBlockTreeEnabled>0&&!A&&currentBlock&&(B.patchFlag>0||C&6)&&B.patchFlag!==32&&currentBlock.push(B),B}const createVNode=_createVNode;function _createVNode(n,r=null,_=null,E=0,S=null,C=!1){if((!n||n===NULL_DYNAMIC_COMPONENT)&&(n=Comment),isVNode(n)){const I=cloneVNode(n,r,!0);return _&&normalizeChildren(I,_),isBlockTreeEnabled>0&&!C&&currentBlock&&(I.shapeFlag&6?currentBlock[currentBlock.indexOf(n)]=I:currentBlock.push(I)),I.patchFlag|=-2,I}if(isClassComponent(n)&&(n=n.__vccOpts),r){r=guardReactiveProps(r);let{class:I,style:B}=r;I&&!isString$5(I)&&(r.class=normalizeClass(I)),isObject$2(B)&&(isProxy(B)&&!isArray$6(B)&&(B=extend$2({},B)),r.style=normalizeStyle(B))}const A=isString$5(n)?1:isSuspense(n)?128:isTeleport(n)?64:isObject$2(n)?4:isFunction$2(n)?2:0;return createBaseVNode(n,r,_,E,S,A,C,!0)}function guardReactiveProps(n){return n?isProxy(n)||InternalObjectKey in n?extend$2({},n):n:null}function cloneVNode(n,r,_=!1){const{props:E,ref:S,patchFlag:C,children:A}=n,I=r?mergeProps(E||{},r):E;return{__v_isVNode:!0,__v_skip:!0,type:n.type,props:I,key:I&&normalizeKey(I),ref:r&&r.ref?_&&S?isArray$6(S)?S.concat(normalizeRef(r)):[S,normalizeRef(r)]:normalizeRef(r):S,scopeId:n.scopeId,slotScopeIds:n.slotScopeIds,children:A,target:n.target,targetAnchor:n.targetAnchor,staticCount:n.staticCount,shapeFlag:n.shapeFlag,patchFlag:r&&n.type!==Fragment?C===-1?16:C|16:C,dynamicProps:n.dynamicProps,dynamicChildren:n.dynamicChildren,appContext:n.appContext,dirs:n.dirs,transition:n.transition,component:n.component,suspense:n.suspense,ssContent:n.ssContent&&cloneVNode(n.ssContent),ssFallback:n.ssFallback&&cloneVNode(n.ssFallback),el:n.el,anchor:n.anchor,ctx:n.ctx,ce:n.ce}}function createTextVNode(n=" ",r=0){return createVNode(Text,null,n,r)}function createCommentVNode(n="",r=!1){return r?(openBlock(),createBlock(Comment,null,n)):createVNode(Comment,null,n)}function normalizeVNode(n){return n==null||typeof n=="boolean"?createVNode(Comment):isArray$6(n)?createVNode(Fragment,null,n.slice()):typeof n=="object"?cloneIfMounted(n):createVNode(Text,null,String(n))}function cloneIfMounted(n){return n.el===null&&n.patchFlag!==-1||n.memo?n:cloneVNode(n)}function normalizeChildren(n,r){let _=0;const{shapeFlag:E}=n;if(r==null)r=null;else if(isArray$6(r))_=16;else if(typeof r=="object")if(E&65){const S=r.default;S&&(S._c&&(S._d=!1),normalizeChildren(n,S()),S._c&&(S._d=!0));return}else{_=32;const S=r._;!S&&!(InternalObjectKey in r)?r._ctx=currentRenderingInstance:S===3&&currentRenderingInstance&&(currentRenderingInstance.slots._===1?r._=1:(r._=2,n.patchFlag|=1024))}else isFunction$2(r)?(r={default:r,_ctx:currentRenderingInstance},_=32):(r=String(r),E&64?(_=16,r=[createTextVNode(r)]):_=8);n.children=r,n.shapeFlag|=_}function mergeProps(...n){const r={};for(let _=0;_<n.length;_++){const E=n[_];for(const S in E)if(S==="class")r.class!==E.class&&(r.class=normalizeClass([r.class,E.class]));else if(S==="style")r.style=normalizeStyle([r.style,E.style]);else if(isOn$1(S)){const C=r[S],A=E[S];A&&C!==A&&!(isArray$6(C)&&C.includes(A))&&(r[S]=C?[].concat(C,A):A)}else S!==""&&(r[S]=E[S])}return r}function invokeVNodeHook(n,r,_,E=null){callWithAsyncErrorHandling(n,r,7,[_,E])}const emptyAppContext=createAppContext();let uid=0;function createComponentInstance(n,r,_){const E=n.type,S=(r?r.appContext:n.appContext)||emptyAppContext,C={uid:uid++,vnode:n,type:E,parent:r,appContext:S,root:null,next:null,subTree:null,effect:null,update:null,scope:new EffectScope(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:r?r.provides:Object.create(S.provides),accessCache:null,renderCache:[],components:null,directives:null,propsOptions:normalizePropsOptions(E,S),emitsOptions:normalizeEmitsOptions(E,S),emit:null,emitted:null,propsDefaults:EMPTY_OBJ,inheritAttrs:E.inheritAttrs,ctx:EMPTY_OBJ,data:EMPTY_OBJ,props:EMPTY_OBJ,attrs:EMPTY_OBJ,slots:EMPTY_OBJ,refs:EMPTY_OBJ,setupState:EMPTY_OBJ,setupContext:null,attrsProxy:null,slotsProxy:null,suspense:_,suspenseId:_?_.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return C.ctx={_:C},C.root=r?r.root:C,C.emit=emit$1.bind(null,C),n.ce&&n.ce(C),C}let currentInstance=null;const getCurrentInstance$1=()=>currentInstance||currentRenderingInstance;let internalSetCurrentInstance,setInSSRSetupState;{const n=getGlobalThis(),r=(_,E)=>{let S;return(S=n[_])||(S=n[_]=[]),S.push(E),C=>{S.length>1?S.forEach(A=>A(C)):S[0](C)}};internalSetCurrentInstance=r("__VUE_INSTANCE_SETTERS__",_=>currentInstance=_),setInSSRSetupState=r("__VUE_SSR_SETTERS__",_=>isInSSRComponentSetup=_)}const setCurrentInstance=n=>{const r=currentInstance;return internalSetCurrentInstance(n),n.scope.on(),()=>{n.scope.off(),internalSetCurrentInstance(r)}},unsetCurrentInstance=()=>{currentInstance&&currentInstance.scope.off(),internalSetCurrentInstance(null)};function isStatefulComponent(n){return n.vnode.shapeFlag&4}let isInSSRComponentSetup=!1;function setupComponent(n,r=!1){r&&setInSSRSetupState(r);const{props:_,children:E}=n.vnode,S=isStatefulComponent(n);initProps(n,_,S,r),initSlots(n,E);const C=S?setupStatefulComponent(n,r):void 0;return r&&setInSSRSetupState(!1),C}function setupStatefulComponent(n,r){const _=n.type;n.accessCache=Object.create(null),n.proxy=markRaw(new Proxy(n.ctx,PublicInstanceProxyHandlers));const{setup:E}=_;if(E){const S=n.setupContext=E.length>1?createSetupContext(n):null,C=setCurrentInstance(n);pauseTracking();const A=callWithErrorHandling(E,n,0,[n.props,S]);if(resetTracking(),C(),isPromise$6(A)){if(A.then(unsetCurrentInstance,unsetCurrentInstance),r)return A.then(I=>{handleSetupResult(n,I,r)}).catch(I=>{handleError(I,n,0)});n.asyncDep=A}else handleSetupResult(n,A,r)}else finishComponentSetup(n,r)}function handleSetupResult(n,r,_){isFunction$2(r)?n.type.__ssrInlineRender?n.ssrRender=r:n.render=r:isObject$2(r)&&(n.setupState=proxyRefs(r)),finishComponentSetup(n,_)}let compile$1;function finishComponentSetup(n,r,_){const E=n.type;if(!n.render){if(!r&&compile$1&&!E.render){const S=E.template||resolveMergedOptions(n).template;if(S){const{isCustomElement:C,compilerOptions:A}=n.appContext.config,{delimiters:I,compilerOptions:B}=E,O=extend$2(extend$2({isCustomElement:C,delimiters:I},A),B);E.render=compile$1(S,O)}}n.render=E.render||NOOP}{const S=setCurrentInstance(n);pauseTracking();try{applyOptions(n)}finally{resetTracking(),S()}}}function getAttrsProxy(n){return n.attrsProxy||(n.attrsProxy=new Proxy(n.attrs,{get(r,_){return track(n,"get","$attrs"),r[_]}}))}function createSetupContext(n){const r=_=>{n.exposed=_||{}};return{get attrs(){return getAttrsProxy(n)},slots:n.slots,emit:n.emit,expose:r}}function getExposeProxy(n){if(n.exposed)return n.exposeProxy||(n.exposeProxy=new Proxy(proxyRefs(markRaw(n.exposed)),{get(r,_){if(_ in r)return r[_];if(_ in publicPropertiesMap)return publicPropertiesMap[_](n)},has(r,_){return _ in r||_ in publicPropertiesMap}}))}const classifyRE=/(?:^|[-_])(\w)/g,classify=n=>n.replace(classifyRE,r=>r.toUpperCase()).replace(/[-_]/g,"");function getComponentName(n,r=!0){return isFunction$2(n)?n.displayName||n.name:n.name||r&&n.__name}function formatComponentName(n,r,_=!1){let E=getComponentName(r);if(!E&&r.__file){const S=r.__file.match(/([^/\\]+)\.\w+$/);S&&(E=S[1])}if(!E&&n&&n.parent){const S=C=>{for(const A in C)if(C[A]===r)return A};E=S(n.components||n.parent.type.components)||S(n.appContext.components)}return E?classify(E):_?"App":"Anonymous"}function isClassComponent(n){return isFunction$2(n)&&"__vccOpts"in n}const computed=(n,r)=>computed$1(n,r,isInSSRComponentSetup);function h$2(n,r,_){const E=arguments.length;return E===2?isObject$2(r)&&!isArray$6(r)?isVNode(r)?createVNode(n,null,[r]):createVNode(n,r):createVNode(n,null,r):(E>3?_=Array.prototype.slice.call(arguments,2):E===3&&isVNode(_)&&(_=[_]),createVNode(n,r,_))}const version$6="3.4.21";/**
* @vue/runtime-dom v3.4.21
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/const svgNS="http://www.w3.org/2000/svg",mathmlNS="http://www.w3.org/1998/Math/MathML",doc=typeof document<"u"?document:null,templateContainer=doc&&doc.createElement("template"),nodeOps={insert:(n,r,_)=>{r.insertBefore(n,_||null)},remove:n=>{const r=n.parentNode;r&&r.removeChild(n)},createElement:(n,r,_,E)=>{const S=r==="svg"?doc.createElementNS(svgNS,n):r==="mathml"?doc.createElementNS(mathmlNS,n):doc.createElement(n,_?{is:_}:void 0);return n==="select"&&E&&E.multiple!=null&&S.setAttribute("multiple",E.multiple),S},createText:n=>doc.createTextNode(n),createComment:n=>doc.createComment(n),setText:(n,r)=>{n.nodeValue=r},setElementText:(n,r)=>{n.textContent=r},parentNode:n=>n.parentNode,nextSibling:n=>n.nextSibling,querySelector:n=>doc.querySelector(n),setScopeId(n,r){n.setAttribute(r,"")},insertStaticContent(n,r,_,E,S,C){const A=_?_.previousSibling:r.lastChild;if(S&&(S===C||S.nextSibling))for(;r.insertBefore(S.cloneNode(!0),_),!(S===C||!(S=S.nextSibling)););else{templateContainer.innerHTML=E==="svg"?`<svg>${n}</svg>`:E==="mathml"?`<math>${n}</math>`:n;const I=templateContainer.content;if(E==="svg"||E==="mathml"){const B=I.firstChild;for(;B.firstChild;)I.appendChild(B.firstChild);I.removeChild(B)}r.insertBefore(I,_)}return[A?A.nextSibling:r.firstChild,_?_.previousSibling:r.lastChild]}},TRANSITION="transition",ANIMATION="animation",vtcKey=Symbol("_vtc"),Transition$1=(n,{slots:r})=>h$2(BaseTransition,resolveTransitionProps(n),r);Transition$1.displayName="Transition";const DOMTransitionPropsValidators={name:String,type:String,css:{type:Boolean,default:!0},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String},TransitionPropsValidators=Transition$1.props=extend$2({},BaseTransitionPropsValidators,DOMTransitionPropsValidators),callHook=(n,r=[])=>{isArray$6(n)?n.forEach(_=>_(...r)):n&&n(...r)},hasExplicitCallback=n=>n?isArray$6(n)?n.some(r=>r.length>1):n.length>1:!1;function resolveTransitionProps(n){const r={};for(const Ee in n)Ee in DOMTransitionPropsValidators||(r[Ee]=n[Ee]);if(n.css===!1)return r;const{name:_="v",type:E,duration:S,enterFromClass:C=`${_}-enter-from`,enterActiveClass:A=`${_}-enter-active`,enterToClass:I=`${_}-enter-to`,appearFromClass:B=C,appearActiveClass:O=A,appearToClass:N=I,leaveFromClass:U=`${_}-leave-from`,leaveActiveClass:j=`${_}-leave-active`,leaveToClass:z=`${_}-leave-to`}=n,Z=normalizeDuration(S),X=Z&&Z[0],Q=Z&&Z[1],{onBeforeEnter:se,onEnter:oe,onEnterCancelled:ue,onLeave:we,onLeaveCancelled:Te,onBeforeAppear:xe=se,onAppear:Re=oe,onAppearCancelled:Ne=ue}=r,Fe=(Ee,Ce,_e)=>{removeTransitionClass(Ee,Ce?N:I),removeTransitionClass(Ee,Ce?O:A),_e&&_e()},ht=(Ee,Ce)=>{Ee._isLeaving=!1,removeTransitionClass(Ee,U),removeTransitionClass(Ee,z),removeTransitionClass(Ee,j),Ce&&Ce()},nt=Ee=>(Ce,_e)=>{const Ie=Ee?Re:oe,He=()=>Fe(Ce,Ee,_e);callHook(Ie,[Ce,He]),nextFrame(()=>{removeTransitionClass(Ce,Ee?B:C),addTransitionClass(Ce,Ee?N:I),hasExplicitCallback(Ie)||whenTransitionEnds(Ce,E,X,He)})};return extend$2(r,{onBeforeEnter(Ee){callHook(se,[Ee]),addTransitionClass(Ee,C),addTransitionClass(Ee,A)},onBeforeAppear(Ee){callHook(xe,[Ee]),addTransitionClass(Ee,B),addTransitionClass(Ee,O)},onEnter:nt(!1),onAppear:nt(!0),onLeave(Ee,Ce){Ee._isLeaving=!0;const _e=()=>ht(Ee,Ce);addTransitionClass(Ee,U),forceReflow(),addTransitionClass(Ee,j),nextFrame(()=>{Ee._isLeaving&&(removeTransitionClass(Ee,U),addTransitionClass(Ee,z),hasExplicitCallback(we)||whenTransitionEnds(Ee,E,Q,_e))}),callHook(we,[Ee,_e])},onEnterCancelled(Ee){Fe(Ee,!1),callHook(ue,[Ee])},onAppearCancelled(Ee){Fe(Ee,!0),callHook(Ne,[Ee])},onLeaveCancelled(Ee){ht(Ee),callHook(Te,[Ee])}})}function normalizeDuration(n){if(n==null)return null;if(isObject$2(n))return[NumberOf(n.enter),NumberOf(n.leave)];{const r=NumberOf(n);return[r,r]}}function NumberOf(n){return toNumber(n)}function addTransitionClass(n,r){r.split(/\s+/).forEach(_=>_&&n.classList.add(_)),(n[vtcKey]||(n[vtcKey]=new Set)).add(r)}function removeTransitionClass(n,r){r.split(/\s+/).forEach(E=>E&&n.classList.remove(E));const _=n[vtcKey];_&&(_.delete(r),_.size||(n[vtcKey]=void 0))}function nextFrame(n){requestAnimationFrame(()=>{requestAnimationFrame(n)})}let endId=0;function whenTransitionEnds(n,r,_,E){const S=n._endId=++endId,C=()=>{S===n._endId&&E()};if(_)return setTimeout(C,_);const{type:A,timeout:I,propCount:B}=getTransitionInfo(n,r);if(!A)return E();const O=A+"end";let N=0;const U=()=>{n.removeEventListener(O,j),C()},j=z=>{z.target===n&&++N>=B&&U()};setTimeout(()=>{N<B&&U()},I+1),n.addEventListener(O,j)}function getTransitionInfo(n,r){const _=window.getComputedStyle(n),E=Z=>(_[Z]||"").split(", "),S=E(`${TRANSITION}Delay`),C=E(`${TRANSITION}Duration`),A=getTimeout(S,C),I=E(`${ANIMATION}Delay`),B=E(`${ANIMATION}Duration`),O=getTimeout(I,B);let N=null,U=0,j=0;r===TRANSITION?A>0&&(N=TRANSITION,U=A,j=C.length):r===ANIMATION?O>0&&(N=ANIMATION,U=O,j=B.length):(U=Math.max(A,O),N=U>0?A>O?TRANSITION:ANIMATION:null,j=N?N===TRANSITION?C.length:B.length:0);const z=N===TRANSITION&&/\b(transform|all)(,|$)/.test(E(`${TRANSITION}Property`).toString());return{type:N,timeout:U,propCount:j,hasTransform:z}}function getTimeout(n,r){for(;n.length<r.length;)n=n.concat(n);return Math.max(...r.map((_,E)=>toMs(_)+toMs(n[E])))}function toMs(n){return n==="auto"?0:Number(n.slice(0,-1).replace(",","."))*1e3}function forceReflow(){return document.body.offsetHeight}function patchClass(n,r,_){const E=n[vtcKey];E&&(r=(r?[r,...E]:[...E]).join(" ")),r==null?n.removeAttribute("class"):_?n.setAttribute("class",r):n.className=r}const vShowOriginalDisplay=Symbol("_vod"),vShowHidden=Symbol("_vsh"),vShow={beforeMount(n,{value:r},{transition:_}){n[vShowOriginalDisplay]=n.style.display==="none"?"":n.style.display,_&&r?_.beforeEnter(n):setDisplay(n,r)},mounted(n,{value:r},{transition:_}){_&&r&&_.enter(n)},updated(n,{value:r,oldValue:_},{transition:E}){!r!=!_&&(E?r?(E.beforeEnter(n),setDisplay(n,!0),E.enter(n)):E.leave(n,()=>{setDisplay(n,!1)}):setDisplay(n,r))},beforeUnmount(n,{value:r}){setDisplay(n,r)}};function setDisplay(n,r){n.style.display=r?n[vShowOriginalDisplay]:"none",n[vShowHidden]=!r}const CSS_VAR_TEXT=Symbol(""),displayRE=/(^|;)\s*display\s*:/;function patchStyle(n,r,_){const E=n.style,S=isString$5(_);let C=!1;if(_&&!S){if(r)if(isString$5(r))for(const A of r.split(";")){const I=A.slice(0,A.indexOf(":")).trim();_[I]==null&&setStyle(E,I,"")}else for(const A in r)_[A]==null&&setStyle(E,A,"");for(const A in _)A==="display"&&(C=!0),setStyle(E,A,_[A])}else if(S){if(r!==_){const A=E[CSS_VAR_TEXT];A&&(_+=";"+A),E.cssText=_,C=displayRE.test(_)}}else r&&n.removeAttribute("style");vShowOriginalDisplay in n&&(n[vShowOriginalDisplay]=C?E.display:"",n[vShowHidden]&&(E.display="none"))}const importantRE=/\s*!important$/;function setStyle(n,r,_){if(isArray$6(_))_.forEach(E=>setStyle(n,r,E));else if(_==null&&(_=""),r.startsWith("--"))n.setProperty(r,_);else{const E=autoPrefix(n,r);importantRE.test(_)?n.setProperty(hyphenate(E),_.replace(importantRE,""),"important"):n[E]=_}}const prefixes$1=["Webkit","Moz","ms"],prefixCache={};function autoPrefix(n,r){const _=prefixCache[r];if(_)return _;let E=camelize(r);if(E!=="filter"&&E in n)return prefixCache[r]=E;E=capitalize(E);for(let S=0;S<prefixes$1.length;S++){const C=prefixes$1[S]+E;if(C in n)return prefixCache[r]=C}return r}const xlinkNS="http://www.w3.org/1999/xlink";function patchAttr(n,r,_,E,S){if(E&&r.startsWith("xlink:"))_==null?n.removeAttributeNS(xlinkNS,r.slice(6,r.length)):n.setAttributeNS(xlinkNS,r,_);else{const C=isSpecialBooleanAttr(r);_==null||C&&!includeBooleanAttr(_)?n.removeAttribute(r):n.setAttribute(r,C?"":_)}}function patchDOMProp(n,r,_,E,S,C,A){if(r==="innerHTML"||r==="textContent"){E&&A(E,S,C),n[r]=_??"";return}const I=n.tagName;if(r==="value"&&I!=="PROGRESS"&&!I.includes("-")){const O=I==="OPTION"?n.getAttribute("value")||"":n.value,N=_??"";(O!==N||!("_value"in n))&&(n.value=N),_==null&&n.removeAttribute(r),n._value=_;return}let B=!1;if(_===""||_==null){const O=typeof n[r];O==="boolean"?_=includeBooleanAttr(_):_==null&&O==="string"?(_="",B=!0):O==="number"&&(_=0,B=!0)}try{n[r]=_}catch{}B&&n.removeAttribute(r)}function addEventListener(n,r,_,E){n.addEventListener(r,_,E)}function removeEventListener(n,r,_,E){n.removeEventListener(r,_,E)}const veiKey=Symbol("_vei");function patchEvent(n,r,_,E,S=null){const C=n[veiKey]||(n[veiKey]={}),A=C[r];if(E&&A)A.value=E;else{const[I,B]=parseName(r);if(E){const O=C[r]=createInvoker(E,S);addEventListener(n,I,O,B)}else A&&(removeEventListener(n,I,A,B),C[r]=void 0)}}const optionsModifierRE=/(?:Once|Passive|Capture)$/;function parseName(n){let r;if(optionsModifierRE.test(n)){r={};let E;for(;E=n.match(optionsModifierRE);)n=n.slice(0,n.length-E[0].length),r[E[0].toLowerCase()]=!0}return[n[2]===":"?n.slice(3):hyphenate(n.slice(2)),r]}let cachedNow=0;const p$1=Promise.resolve(),getNow=()=>cachedNow||(p$1.then(()=>cachedNow=0),cachedNow=Date.now());function createInvoker(n,r){const _=E=>{if(!E._vts)E._vts=Date.now();else if(E._vts<=_.attached)return;callWithAsyncErrorHandling(patchStopImmediatePropagation(E,_.value),r,5,[E])};return _.value=n,_.attached=getNow(),_}function patchStopImmediatePropagation(n,r){if(isArray$6(r)){const _=n.stopImmediatePropagation;return n.stopImmediatePropagation=()=>{_.call(n),n._stopped=!0},r.map(E=>S=>!S._stopped&&E&&E(S))}else return r}const isNativeOn=n=>n.charCodeAt(0)===111&&n.charCodeAt(1)===110&&n.charCodeAt(2)>96&&n.charCodeAt(2)<123,patchProp=(n,r,_,E,S,C,A,I,B)=>{const O=S==="svg";r==="class"?patchClass(n,E,O):r==="style"?patchStyle(n,_,E):isOn$1(r)?isModelListener(r)||patchEvent(n,r,_,E,A):(r[0]==="."?(r=r.slice(1),!0):r[0]==="^"?(r=r.slice(1),!1):shouldSetAsProp(n,r,E,O))?patchDOMProp(n,r,E,C,A,I,B):(r==="true-value"?n._trueValue=E:r==="false-value"&&(n._falseValue=E),patchAttr(n,r,E,O))};function shouldSetAsProp(n,r,_,E){if(E)return!!(r==="innerHTML"||r==="textContent"||r in n&&isNativeOn(r)&&isFunction$2(_));if(r==="spellcheck"||r==="draggable"||r==="translate"||r==="form"||r==="list"&&n.tagName==="INPUT"||r==="type"&&n.tagName==="TEXTAREA")return!1;if(r==="width"||r==="height"){const S=n.tagName;if(S==="IMG"||S==="VIDEO"||S==="CANVAS"||S==="SOURCE")return!1}return isNativeOn(r)&&isString$5(_)?!1:r in n}const positionMap=new WeakMap,newPositionMap=new WeakMap,moveCbKey=Symbol("_moveCb"),enterCbKey=Symbol("_enterCb"),TransitionGroupImpl={name:"TransitionGroup",props:extend$2({},TransitionPropsValidators,{tag:String,moveClass:String}),setup(n,{slots:r}){const _=getCurrentInstance$1(),E=useTransitionState();let S,C;return onUpdated(()=>{if(!S.length)return;const A=n.moveClass||`${n.name||"v"}-move`;if(!hasCSSTransform(S[0].el,_.vnode.el,A))return;S.forEach(callPendingCbs),S.forEach(recordPosition);const I=S.filter(applyTranslation);forceReflow(),I.forEach(B=>{const O=B.el,N=O.style;addTransitionClass(O,A),N.transform=N.webkitTransform=N.transitionDuration="";const U=O[moveCbKey]=j=>{j&&j.target!==O||(!j||/transform$/.test(j.propertyName))&&(O.removeEventListener("transitionend",U),O[moveCbKey]=null,removeTransitionClass(O,A))};O.addEventListener("transitionend",U)})}),()=>{const A=toRaw(n),I=resolveTransitionProps(A);let B=A.tag||Fragment;S=C,C=r.default?getTransitionRawChildren(r.default()):[];for(let O=0;O<C.length;O++){const N=C[O];N.key!=null&&setTransitionHooks(N,resolveTransitionHooks(N,I,E,_))}if(S)for(let O=0;O<S.length;O++){const N=S[O];setTransitionHooks(N,resolveTransitionHooks(N,I,E,_)),positionMap.set(N,N.el.getBoundingClientRect())}return createVNode(B,null,C)}}},removeMode=n=>delete n.mode;TransitionGroupImpl.props;const TransitionGroup=TransitionGroupImpl;function callPendingCbs(n){const r=n.el;r[moveCbKey]&&r[moveCbKey](),r[enterCbKey]&&r[enterCbKey]()}function recordPosition(n){newPositionMap.set(n,n.el.getBoundingClientRect())}function applyTranslation(n){const r=positionMap.get(n),_=newPositionMap.get(n),E=r.left-_.left,S=r.top-_.top;if(E||S){const C=n.el.style;return C.transform=C.webkitTransform=`translate(${E}px,${S}px)`,C.transitionDuration="0s",n}}function hasCSSTransform(n,r,_){const E=n.cloneNode(),S=n[vtcKey];S&&S.forEach(I=>{I.split(/\s+/).forEach(B=>B&&E.classList.remove(B))}),_.split(/\s+/).forEach(I=>I&&E.classList.add(I)),E.style.display="none";const C=r.nodeType===1?r:r.parentNode;C.appendChild(E);const{hasTransform:A}=getTransitionInfo(E);return C.removeChild(E),A}const systemModifiers=["ctrl","shift","alt","meta"],modifierGuards={stop:n=>n.stopPropagation(),prevent:n=>n.preventDefault(),self:n=>n.target!==n.currentTarget,ctrl:n=>!n.ctrlKey,shift:n=>!n.shiftKey,alt:n=>!n.altKey,meta:n=>!n.metaKey,left:n=>"button"in n&&n.button!==0,middle:n=>"button"in n&&n.button!==1,right:n=>"button"in n&&n.button!==2,exact:(n,r)=>systemModifiers.some(_=>n[`${_}Key`]&&!r.includes(_))},withModifiers=(n,r)=>{const _=n._withMods||(n._withMods={}),E=r.join(".");return _[E]||(_[E]=(S,...C)=>{for(let A=0;A<r.length;A++){const I=modifierGuards[r[A]];if(I&&I(S,r))return}return n(S,...C)})},rendererOptions=extend$2({patchProp},nodeOps);let renderer;function ensureRenderer(){return renderer||(renderer=createRenderer(rendererOptions))}const render=(...n)=>{ensureRenderer().render(...n)},createApp=(...n)=>{const r=ensureRenderer().createApp(...n),{mount:_}=r;return r.mount=E=>{const S=normalizeContainer(E);if(!S)return;const C=r._component;!isFunction$2(C)&&!C.render&&!C.template&&(C.template=S.innerHTML),S.innerHTML="";const A=_(S,!1,resolveRootNamespace(S));return S instanceof Element&&(S.removeAttribute("v-cloak"),S.setAttribute("data-v-app","")),A},r};function resolveRootNamespace(n){if(n instanceof SVGElement)return"svg";if(typeof MathMLElement=="function"&&n instanceof MathMLElement)return"mathml"}function normalizeContainer(n){return isString$5(n)?document.querySelector(n):n}function useToggleScope(n,r){let _;function E(){_=effectScope(),_.run(()=>r.length?r(()=>{_?.stop(),E()}):r())}watch(n,S=>{S&&!_?E():S||(_?.stop(),_=void 0)},{immediate:!0}),onScopeDispose(()=>{_?.stop()})}const IN_BROWSER=typeof window<"u",SUPPORTS_INTERSECTION=IN_BROWSER&&"IntersectionObserver"in window,SUPPORTS_TOUCH=IN_BROWSER&&("ontouchstart"in window||window.navigator.maxTouchPoints>0);function getNestedValue(n,r,_){const E=r.length-1;if(E<0)return n===void 0?_:n;for(let S=0;S<E;S++){if(n==null)return _;n=n[r[S]]}return n==null||n[r[E]]===void 0?_:n[r[E]]}function deepEqual$2(n,r){if(n===r)return!0;if(n instanceof Date&&r instanceof Date&&n.getTime()!==r.getTime()||n!==Object(n)||r!==Object(r))return!1;const _=Object.keys(n);return _.length!==Object.keys(r).length?!1:_.every(E=>deepEqual$2(n[E],r[E]))}function getObjectValueByPath(n,r,_){return n==null||!r||typeof r!="string"?_:n[r]!==void 0?n[r]:(r=r.replace(/\[(\w+)\]/g,".$1"),r=r.replace(/^\./,""),getNestedValue(n,r.split("."),_))}function getPropertyFromItem(n,r,_){if(r===!0)return n===void 0?_:n;if(r==null||typeof r=="boolean")return _;if(n!==Object(n)){if(typeof r!="function")return _;const S=r(n,_);return typeof S>"u"?_:S}if(typeof r=="string")return getObjectValueByPath(n,r,_);if(Array.isArray(r))return getNestedValue(n,r,_);if(typeof r!="function")return _;const E=r(n,_);return typeof E>"u"?_:E}function createRange(n){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return Array.from({length:n},(_,E)=>r+E)}function convertToUnit(n){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"px";if(!(n==null||n===""))return isNaN(+n)?String(n):isFinite(+n)?`${Number(n)}${r}`:void 0}function isObject$1(n){return n!==null&&typeof n=="object"&&!Array.isArray(n)}function refElement(n){if(n&&"$el"in n){const r=n.$el;return r?.nodeType===Node.TEXT_NODE?r.nextElementSibling:r}return n}const keyCodes=Object.freeze({enter:13,tab:9,delete:46,esc:27,space:32,up:38,down:40,left:37,right:39,end:35,home:36,del:46,backspace:8,insert:45,pageup:33,pagedown:34,shift:16});function keys$3(n){return Object.keys(n)}function has$2(n,r){return r.every(_=>n.hasOwnProperty(_))}function pick(n,r){const _={},E=new Set(Object.keys(n));for(const S of r)E.has(S)&&(_[S]=n[S]);return _}function pickWithRest(n,r,_){const E=Object.create(null),S=Object.create(null);for(const C in n)r.some(A=>A instanceof RegExp?A.test(C):A===C)&&!_?.some(A=>A===C)?E[C]=n[C]:S[C]=n[C];return[E,S]}function omit(n,r){const _={...n};return r.forEach(E=>delete _[E]),_}const onRE=/^on[^a-z]/,isOn=n=>onRE.test(n),bubblingEvents=["onAfterscriptexecute","onAnimationcancel","onAnimationend","onAnimationiteration","onAnimationstart","onAuxclick","onBeforeinput","onBeforescriptexecute","onChange","onClick","onCompositionend","onCompositionstart","onCompositionupdate","onContextmenu","onCopy","onCut","onDblclick","onFocusin","onFocusout","onFullscreenchange","onFullscreenerror","onGesturechange","onGestureend","onGesturestart","onGotpointercapture","onInput","onKeydown","onKeypress","onKeyup","onLostpointercapture","onMousedown","onMousemove","onMouseout","onMouseover","onMouseup","onMousewheel","onPaste","onPointercancel","onPointerdown","onPointerenter","onPointerleave","onPointermove","onPointerout","onPointerover","onPointerup","onReset","onSelect","onSubmit","onTouchcancel","onTouchend","onTouchmove","onTouchstart","onTransitioncancel","onTransitionend","onTransitionrun","onTransitionstart","onWheel"];function filterInputAttrs(n){const[r,_]=pickWithRest(n,[onRE]),E=omit(r,bubblingEvents),[S,C]=pickWithRest(_,["class","style","id",/^data-/]);return Object.assign(S,r),Object.assign(C,E),[S,C]}function wrapInArray(n){return n==null?[]:Array.isArray(n)?n:[n]}function clamp(n){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,_=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;return Math.max(r,Math.min(_,n))}function padEnd(n,r){let _=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"0";return n+_.repeat(Math.max(0,r-n.length))}function padStart(n,r){return(arguments.length>2&&arguments[2]!==void 0?arguments[2]:"0").repeat(Math.max(0,r-n.length))+n}function chunk(n){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;const _=[];let E=0;for(;E<n.length;)_.push(n.substr(E,r)),E+=r;return _}function mergeDeep(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},_=arguments.length>2?arguments[2]:void 0;const E={};for(const S in n)E[S]=n[S];for(const S in r){const C=n[S],A=r[S];if(isObject$1(C)&&isObject$1(A)){E[S]=mergeDeep(C,A,_);continue}if(Array.isArray(C)&&Array.isArray(A)&&_){E[S]=_(C,A);continue}E[S]=A}return E}function flattenFragments(n){return n.map(r=>r.type===Fragment?flattenFragments(r.children):r).flat()}function toKebabCase(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";if(toKebabCase.cache.has(n))return toKebabCase.cache.get(n);const r=n.replace(/[^a-z]/gi,"-").replace(/\B([A-Z])/g,"-$1").toLowerCase();return toKebabCase.cache.set(n,r),r}toKebabCase.cache=new Map;function findChildrenWithProvide(n,r){if(!r||typeof r!="object")return[];if(Array.isArray(r))return r.map(_=>findChildrenWithProvide(n,_)).flat(1);if(Array.isArray(r.children))return r.children.map(_=>findChildrenWithProvide(n,_)).flat(1);if(r.component){if(Object.getOwnPropertySymbols(r.component.provides).includes(n))return[r.component];if(r.component.subTree)return findChildrenWithProvide(n,r.component.subTree).flat(1)}return[]}function destructComputed(n){const r=reactive({}),_=computed(n);return watchEffect(()=>{for(const E in _.value)r[E]=_.value[E]},{flush:"sync"}),toRefs(r)}function includes(n,r){return n.includes(r)}function eventName(n){return n[2].toLowerCase()+n.slice(3)}const EventProp=()=>[Function,Array];function hasEvent(n,r){return r="on"+capitalize(r),!!(n[r]||n[`${r}Once`]||n[`${r}Capture`]||n[`${r}OnceCapture`]||n[`${r}CaptureOnce`])}function callEvent(n){for(var r=arguments.length,_=new Array(r>1?r-1:0),E=1;E<r;E++)_[E-1]=arguments[E];if(Array.isArray(n))for(const S of n)S(..._);else typeof n=="function"&&n(..._)}function focusableChildren(n){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;const _=["button","[href]",'input:not([type="hidden"])',"select","textarea","[tabindex]"].map(E=>`${E}${r?':not([tabindex="-1"])':""}:not([disabled])`).join(", ");return[...n.querySelectorAll(_)]}function getNextElement(n,r,_){let E,S=n.indexOf(document.activeElement);const C=r==="next"?1:-1;do S+=C,E=n[S];while((!E||E.offsetParent==null||!(_?.(E)??!0))&&S<n.length&&S>=0);return E}function focusChild(n,r){const _=focusableChildren(n);if(!r)(n===document.activeElement||!n.contains(document.activeElement))&&_[0]?.focus();else if(r==="first")_[0]?.focus();else if(r==="last")_.at(-1)?.focus();else if(typeof r=="number")_[r]?.focus();else{const E=getNextElement(_,r);E?E.focus():focusChild(n,r==="next"?"first":"last")}}function matchesSelector(n,r){if(!(IN_BROWSER&&typeof CSS<"u"&&typeof CSS.supports<"u"&&CSS.supports(`selector(${r})`)))return null;try{return!!n&&n.matches(r)}catch{return null}}function defer(n,r){if(!IN_BROWSER||n===0)return r(),()=>{};const _=window.setTimeout(r,n);return()=>window.clearTimeout(_)}function isClickInsideElement(n,r){const _=n.clientX,E=n.clientY,S=r.getBoundingClientRect(),C=S.left,A=S.top,I=S.right,B=S.bottom;return _>=C&&_<=I&&E>=A&&E<=B}const block=["top","bottom"],inline=["start","end","left","right"];function parseAnchor(n,r){let[_,E]=n.split(" ");return E||(E=includes(block,_)?"start":includes(inline,_)?"top":"center"),{side:toPhysical(_,r),align:toPhysical(E,r)}}function toPhysical(n,r){return n==="start"?r?"right":"left":n==="end"?r?"left":"right":n}function flipSide(n){return{side:{center:"center",top:"bottom",bottom:"top",left:"right",right:"left"}[n.side],align:n.align}}function flipAlign(n){return{side:n.side,align:{center:"center",top:"bottom",bottom:"top",left:"right",right:"left"}[n.align]}}function flipCorner(n){return{side:n.align,align:n.side}}function getAxis(n){return includes(block,n.side)?"y":"x"}class Box{constructor(r){let{x:_,y:E,width:S,height:C}=r;this.x=_,this.y=E,this.width=S,this.height=C}get top(){return this.y}get bottom(){return this.y+this.height}get left(){return this.x}get right(){return this.x+this.width}}function getOverflow(n,r){return{x:{before:Math.max(0,r.left-n.left),after:Math.max(0,n.right-r.right)},y:{before:Math.max(0,r.top-n.top),after:Math.max(0,n.bottom-r.bottom)}}}function getTargetBox(n){return Array.isArray(n)?new Box({x:n[0],y:n[1],width:0,height:0}):n.getBoundingClientRect()}function nullifyTransforms(n){const r=n.getBoundingClientRect(),_=getComputedStyle(n),E=_.transform;if(E){let S,C,A,I,B;if(E.startsWith("matrix3d("))S=E.slice(9,-1).split(/, /),C=+S[0],A=+S[5],I=+S[12],B=+S[13];else if(E.startsWith("matrix("))S=E.slice(7,-1).split(/, /),C=+S[0],A=+S[3],I=+S[4],B=+S[5];else return new Box(r);const O=_.transformOrigin,N=r.x-I-(1-C)*parseFloat(O),U=r.y-B-(1-A)*parseFloat(O.slice(O.indexOf(" ")+1)),j=C?r.width/C:n.offsetWidth+1,z=A?r.height/A:n.offsetHeight+1;return new Box({x:N,y:U,width:j,height:z})}else return new Box(r)}function animate(n,r,_){if(typeof n.animate>"u")return{finished:Promise.resolve()};let E;try{E=n.animate(r,_)}catch{return{finished:Promise.resolve()}}return typeof E.finished>"u"&&(E.finished=new Promise(S=>{E.onfinish=()=>{S(E)}})),E}const handlers=new WeakMap;function bindProps(n,r){Object.keys(r).forEach(_=>{if(isOn(_)){const E=eventName(_),S=handlers.get(n);if(r[_]==null)S?.forEach(C=>{const[A,I]=C;A===E&&(n.removeEventListener(E,I),S.delete(C))});else if(!S||![...S].some(C=>C[0]===E&&C[1]===r[_])){n.addEventListener(E,r[_]);const C=S||new Set;C.add([E,r[_]]),handlers.has(n)||handlers.set(n,C)}}else r[_]==null?n.removeAttribute(_):n.setAttribute(_,r[_])})}function unbindProps(n,r){Object.keys(r).forEach(_=>{if(isOn(_)){const E=eventName(_),S=handlers.get(n);S?.forEach(C=>{const[A,I]=C;A===E&&(n.removeEventListener(E,I),S.delete(C))})}else n.removeAttribute(_)})}const mainTRC=2.4,Rco=.2126729,Gco=.7151522,Bco=.072175,normBG=.55,normTXT=.58,revTXT=.57,revBG=.62,blkThrs=.03,blkClmp=1.45,deltaYmin=5e-4,scaleBoW=1.25,scaleWoB=1.25,loConThresh=.078,loConFactor=12.82051282051282,loConOffset=.06,loClip=.001;function APCAcontrast(n,r){const _=(n.r/255)**mainTRC,E=(n.g/255)**mainTRC,S=(n.b/255)**mainTRC,C=(r.r/255)**mainTRC,A=(r.g/255)**mainTRC,I=(r.b/255)**mainTRC;let B=_*Rco+E*Gco+S*Bco,O=C*Rco+A*Gco+I*Bco;if(B<=blkThrs&&(B+=(blkThrs-B)**blkClmp),O<=blkThrs&&(O+=(blkThrs-O)**blkClmp),Math.abs(O-B)<deltaYmin)return 0;let N;if(O>B){const U=(O**normBG-B**normTXT)*scaleBoW;N=U<loClip?0:U<loConThresh?U-U*loConFactor*loConOffset:U-loConOffset}else{const U=(O**revBG-B**revTXT)*scaleWoB;N=U>-loClip?0:U>-loConThresh?U-U*loConFactor*loConOffset:U+loConOffset}return N*100}function consoleWarn(n){}function deprecate$1(n,r){r=Array.isArray(r)?r.slice(0,-1).map(_=>`'${_}'`).join(", ")+` or '${r.at(-1)}'`:`'${r}'`}const delta=.20689655172413793,cielabForwardTransform=n=>n>delta**3?Math.cbrt(n):n/(3*delta**2)+4/29,cielabReverseTransform=n=>n>delta?n**3:3*delta**2*(n-4/29);function fromXYZ$1(n){const r=cielabForwardTransform,_=r(n[1]);return[116*_-16,500*(r(n[0]/.95047)-_),200*(_-r(n[2]/1.08883))]}function toXYZ$1(n){const r=cielabReverseTransform,_=(n[0]+16)/116;return[r(_+n[1]/500)*.95047,r(_),r(_-n[2]/200)*1.08883]}const srgbForwardMatrix=[[3.2406,-1.5372,-.4986],[-.9689,1.8758,.0415],[.0557,-.204,1.057]],srgbForwardTransform=n=>n<=.0031308?n*12.92:1.055*n**(1/2.4)-.055,srgbReverseMatrix=[[.4124,.3576,.1805],[.2126,.7152,.0722],[.0193,.1192,.9505]],srgbReverseTransform=n=>n<=.04045?n/12.92:((n+.055)/1.055)**2.4;function fromXYZ(n){const r=Array(3),_=srgbForwardTransform,E=srgbForwardMatrix;for(let S=0;S<3;++S)r[S]=Math.round(clamp(_(E[S][0]*n[0]+E[S][1]*n[1]+E[S][2]*n[2]))*255);return{r:r[0],g:r[1],b:r[2]}}function toXYZ(n){let{r,g:_,b:E}=n;const S=[0,0,0],C=srgbReverseTransform,A=srgbReverseMatrix;r=C(r/255),_=C(_/255),E=C(E/255);for(let I=0;I<3;++I)S[I]=A[I][0]*r+A[I][1]*_+A[I][2]*E;return S}function isCssColor(n){return!!n&&/^(#|var\(--|(rgb|hsl)a?\()/.test(n)}function isParsableColor(n){return isCssColor(n)&&!/^((rgb|hsl)a?\()?var\(--/.test(n)}const cssColorRe=/^(?<fn>(?:rgb|hsl)a?)\((?<values>.+)\)/,mappers={rgb:(n,r,_,E)=>({r:n,g:r,b:_,a:E}),rgba:(n,r,_,E)=>({r:n,g:r,b:_,a:E}),hsl:(n,r,_,E)=>HSLtoRGB({h:n,s:r,l:_,a:E}),hsla:(n,r,_,E)=>HSLtoRGB({h:n,s:r,l:_,a:E}),hsv:(n,r,_,E)=>HSVtoRGB({h:n,s:r,v:_,a:E}),hsva:(n,r,_,E)=>HSVtoRGB({h:n,s:r,v:_,a:E})};function parseColor(n){if(typeof n=="number")return{r:(n&16711680)>>16,g:(n&65280)>>8,b:n&255};if(typeof n=="string"&&cssColorRe.test(n)){const{groups:r}=n.match(cssColorRe),{fn:_,values:E}=r,S=E.split(/,\s*/).map(C=>C.endsWith("%")&&["hsl","hsla","hsv","hsva"].includes(_)?parseFloat(C)/100:parseFloat(C));return mappers[_](...S)}else if(typeof n=="string"){let r=n.startsWith("#")?n.slice(1):n;return[3,4].includes(r.length)?r=r.split("").map(_=>_+_).join(""):[6,8].includes(r.length),HexToRGB(r)}else if(typeof n=="object"){if(has$2(n,["r","g","b"]))return n;if(has$2(n,["h","s","l"]))return HSVtoRGB(HSLtoHSV(n));if(has$2(n,["h","s","v"]))return HSVtoRGB(n)}throw new TypeError(`Invalid color: ${n==null?n:String(n)||n.constructor.name}
Expected #hex, #hexa, rgb(), rgba(), hsl(), hsla(), object or number`)}function HSVtoRGB(n){const{h:r,s:_,v:E,a:S}=n,C=I=>{const B=(I+r/60)%6;return E-E*_*Math.max(Math.min(B,4-B,1),0)},A=[C(5),C(3),C(1)].map(I=>Math.round(I*255));return{r:A[0],g:A[1],b:A[2],a:S}}function HSLtoRGB(n){return HSVtoRGB(HSLtoHSV(n))}function HSLtoHSV(n){const{h:r,s:_,l:E,a:S}=n,C=E+_*Math.min(E,1-E),A=C===0?0:2-2*E/C;return{h:r,s:A,v:C,a:S}}function toHex$1(n){const r=Math.round(n).toString(16);return("00".substr(0,2-r.length)+r).toUpperCase()}function RGBtoHex(n){let{r,g:_,b:E,a:S}=n;return`#${[toHex$1(r),toHex$1(_),toHex$1(E),S!==void 0?toHex$1(Math.round(S*255)):""].join("")}`}function HexToRGB(n){n=parseHex(n);let[r,_,E,S]=chunk(n,2).map(C=>parseInt(C,16));return S=S===void 0?S:S/255,{r,g:_,b:E,a:S}}function parseHex(n){return n.startsWith("#")&&(n=n.slice(1)),n=n.replace(/([^0-9a-f])/gi,"F"),(n.length===3||n.length===4)&&(n=n.split("").map(r=>r+r).join("")),n.length!==6&&(n=padEnd(padEnd(n,6),8,"F")),n}function lighten(n,r){const _=fromXYZ$1(toXYZ(n));return _[0]=_[0]+r*10,fromXYZ(toXYZ$1(_))}function darken(n,r){const _=fromXYZ$1(toXYZ(n));return _[0]=_[0]-r*10,fromXYZ(toXYZ$1(_))}function getLuma(n){const r=parseColor(n);return toXYZ(r)[1]}function getForeground(n){const r=Math.abs(APCAcontrast(parseColor(0),parseColor(n)));return Math.abs(APCAcontrast(parseColor(16777215),parseColor(n)))>Math.min(r,50)?"#fff":"#000"}function propsFactory(n,r){return _=>Object.keys(n).reduce((E,S)=>{const A=typeof n[S]=="object"&&n[S]!=null&&!Array.isArray(n[S])?n[S]:{type:n[S]};return _&&S in _?E[S]={...A,default:_[S]}:E[S]=A,r&&!E[S].source&&(E[S].source=r),E},{})}const makeComponentProps=propsFactory({class:[String,Array],style:{type:[String,Array,Object],default:null}},"component"),DefaultsSymbol=Symbol.for("vuetify:defaults");function createDefaults(n){return ref$2(n)}function injectDefaults(){const n=inject$1(DefaultsSymbol);if(!n)throw new Error("[Vuetify] Could not find defaults instance");return n}function provideDefaults(n,r){const _=injectDefaults(),E=ref$2(n),S=computed(()=>{if(unref(r?.disabled))return _.value;const A=unref(r?.scoped),I=unref(r?.reset),B=unref(r?.root);if(E.value==null&&!(A||I||B))return _.value;let O=mergeDeep(E.value,{prev:_.value});if(A)return O;if(I||B){const N=Number(I||1/0);for(let U=0;U<=N&&!(!O||!("prev"in O));U++)O=O.prev;return O&&typeof B=="string"&&B in O&&(O=mergeDeep(mergeDeep(O,{prev:O}),O[B])),O}return O.prev?mergeDeep(O.prev,O):O});return provide(DefaultsSymbol,S),S}function propIsDefined(n,r){return typeof n.props?.[r]<"u"||typeof n.props?.[toKebabCase(r)]<"u"}function internalUseDefaults(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=arguments.length>1?arguments[1]:void 0,_=arguments.length>2&&arguments[2]!==void 0?arguments[2]:injectDefaults();const E=getCurrentInstance("useDefaults");if(r=r??E.type.name??E.type.__name,!r)throw new Error("[Vuetify] Could not determine component name");const S=computed(()=>_.value?.[n._as??r]),C=new Proxy(n,{get(B,O){const N=Reflect.get(B,O);return O==="class"||O==="style"?[S.value?.[O],N].filter(U=>U!=null):typeof O=="string"&&!propIsDefined(E.vnode,O)?S.value?.[O]??_.value?.global?.[O]??N:N}}),A=shallowRef();watchEffect(()=>{if(S.value){const B=Object.entries(S.value).filter(O=>{let[N]=O;return N.startsWith(N[0].toUpperCase())});A.value=B.length?Object.fromEntries(B):void 0}else A.value=void 0});function I(){const B=injectSelf(DefaultsSymbol,E);provide(DefaultsSymbol,computed(()=>A.value?mergeDeep(B?.value??{},A.value):B?.value))}return{props:C,provideSubDefaults:I}}function defineComponent(n){if(n._setup=n._setup??n.setup,!n.name)return n;if(n._setup){n.props=propsFactory(n.props??{},n.name)();const r=Object.keys(n.props).filter(_=>_!=="class"&&_!=="style");n.filterProps=function(E){return pick(E,r)},n.props._as=String,n.setup=function(E,S){const C=injectDefaults();if(!C.value)return n._setup(E,S);const{props:A,provideSubDefaults:I}=internalUseDefaults(E,E._as??n.name,C),B=n._setup(A,S);return I(),B}}return n}function genericComponent(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return r=>(n?defineComponent:defineComponent$1)(r)}function createSimpleFunctional(n){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"div",_=arguments.length>2?arguments[2]:void 0;return genericComponent()({name:_??capitalize(camelize(n.replace(/__/g,"-"))),props:{tag:{type:String,default:r},...makeComponentProps()},setup(E,S){let{slots:C}=S;return()=>h$2(E.tag,{class:[n,E.class],style:E.style},C.default?.())}})}function attachedRoot(n){if(typeof n.getRootNode!="function"){for(;n.parentNode;)n=n.parentNode;return n!==document?null:document}const r=n.getRootNode();return r!==document&&r.getRootNode({composed:!0})!==document?null:r}const standardEasing="cubic-bezier(0.4, 0, 0.2, 1)",deceleratedEasing="cubic-bezier(0.0, 0, 0.2, 1)",acceleratedEasing="cubic-bezier(0.4, 0, 1, 1)";function getCurrentInstance(n,r){const _=getCurrentInstance$1();if(!_)throw new Error(`[Vuetify] ${n} ${r||"must be called from inside a setup function"}`);return _}function getCurrentInstanceName(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"composables";const r=getCurrentInstance(n).type;return toKebabCase(r?.aliasName||r?.name)}let _uid=0,_map=new WeakMap;function getUid(){const n=getCurrentInstance("getUid");if(_map.has(n))return _map.get(n);{const r=_uid++;return _map.set(n,r),r}}getUid.reset=()=>{_uid=0,_map=new WeakMap};function getScrollParent(n){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;for(;n;){if(r?isPotentiallyScrollable(n):hasScrollbar(n))return n;n=n.parentElement}return document.scrollingElement}function getScrollParents(n,r){const _=[];if(r&&n&&!r.contains(n))return _;for(;n&&(hasScrollbar(n)&&_.push(n),n!==r);)n=n.parentElement;return _}function hasScrollbar(n){if(!n||n.nodeType!==Node.ELEMENT_NODE)return!1;const r=window.getComputedStyle(n);return r.overflowY==="scroll"||r.overflowY==="auto"&&n.scrollHeight>n.clientHeight}function isPotentiallyScrollable(n){if(!n||n.nodeType!==Node.ELEMENT_NODE)return!1;const r=window.getComputedStyle(n);return["scroll","auto"].includes(r.overflowY)}function injectSelf(n){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:getCurrentInstance("injectSelf");const{provides:_}=r;if(_&&n in _)return _[n]}function isFixedPosition(n){for(;n;){if(window.getComputedStyle(n).position==="fixed")return!0;n=n.offsetParent}return!1}function useRender(n){const r=getCurrentInstance("useRender");r.render=n}function useProxiedModel(n,r,_){let E=arguments.length>3&&arguments[3]!==void 0?arguments[3]:U=>U,S=arguments.length>4&&arguments[4]!==void 0?arguments[4]:U=>U;const C=getCurrentInstance("useProxiedModel"),A=ref$2(n[r]!==void 0?n[r]:_),I=toKebabCase(r),O=computed(I!==r?()=>(n[r],!!((C.vnode.props?.hasOwnProperty(r)||C.vnode.props?.hasOwnProperty(I))&&(C.vnode.props?.hasOwnProperty(`onUpdate:${r}`)||C.vnode.props?.hasOwnProperty(`onUpdate:${I}`)))):()=>(n[r],!!(C.vnode.props?.hasOwnProperty(r)&&C.vnode.props?.hasOwnProperty(`onUpdate:${r}`))));useToggleScope(()=>!O.value,()=>{watch(()=>n[r],U=>{A.value=U})});const N=computed({get(){const U=n[r];return E(O.value?U:A.value)},set(U){const j=S(U),z=toRaw(O.value?n[r]:A.value);z===j||E(z)===U||(A.value=j,C?.emit(`update:${r}`,j))}});return Object.defineProperty(N,"externalValue",{get:()=>O.value?n[r]:A.value}),N}const en$2={badge:"Badge",open:"Open",close:"Close",confirmEdit:{ok:"OK",cancel:"Cancel"},dataIterator:{noResultsText:"No matching records found",loadingText:"Loading items..."},dataTable:{itemsPerPageText:"Rows per page:",ariaLabel:{sortDescending:"Sorted descending.",sortAscending:"Sorted ascending.",sortNone:"Not sorted.",activateNone:"Activate to remove sorting.",activateDescending:"Activate to sort descending.",activateAscending:"Activate to sort ascending."},sortBy:"Sort by"},dataFooter:{itemsPerPageText:"Items per page:",itemsPerPageAll:"All",nextPage:"Next page",prevPage:"Previous page",firstPage:"First page",lastPage:"Last page",pageText:"{0}-{1} of {2}"},dateRangeInput:{divider:"to"},datePicker:{itemsSelected:"{0} selected",range:{title:"Select dates",header:"Enter dates"},title:"Select date",header:"Enter date",input:{placeholder:"Enter date"}},noDataText:"No data available",carousel:{prev:"Previous visual",next:"Next visual",ariaLabel:{delimiter:"Carousel slide {0} of {1}"}},calendar:{moreEvents:"{0} more",today:"Today"},input:{clear:"Clear {0}",prependAction:"{0} prepended action",appendAction:"{0} appended action",otp:"Please enter OTP character {0}"},fileInput:{counter:"{0} files",counterSize:"{0} files ({1} in total)"},timePicker:{am:"AM",pm:"PM"},pagination:{ariaLabel:{root:"Pagination Navigation",next:"Next page",previous:"Previous page",page:"Go to page {0}",currentPage:"Page {0}, Current page",first:"First page",last:"Last page"}},stepper:{next:"Next",prev:"Previous"},rating:{ariaLabel:{item:"Rating {0} of {1}"}},loading:"Loading...",infiniteScroll:{loadMore:"Load more",empty:"No more"}},LANG_PREFIX="$vuetify.",replace=(n,r)=>n.replace(/\{(\d+)\}/g,(_,E)=>String(r[+E])),createTranslateFunction=(n,r,_)=>function(E){for(var S=arguments.length,C=new Array(S>1?S-1:0),A=1;A<S;A++)C[A-1]=arguments[A];if(!E.startsWith(LANG_PREFIX))return replace(E,C);const I=E.replace(LANG_PREFIX,""),B=n.value&&_.value[n.value],O=r.value&&_.value[r.value];let N=getObjectValueByPath(B,I,null);return N||(`${E}${n.value}`,N=getObjectValueByPath(O,I,null)),N||(N=E),typeof N!="string"&&(N=E),replace(N,C)};function createNumberFunction(n,r){return(_,E)=>new Intl.NumberFormat([n.value,r.value],E).format(_)}function useProvided(n,r,_){const E=useProxiedModel(n,r,n[r]??_.value);return E.value=n[r]??_.value,watch(_,S=>{n[r]==null&&(E.value=_.value)}),E}function createProvideFunction(n){return r=>{const _=useProvided(r,"locale",n.current),E=useProvided(r,"fallback",n.fallback),S=useProvided(r,"messages",n.messages);return{name:"vuetify",current:_,fallback:E,messages:S,t:createTranslateFunction(_,E,S),n:createNumberFunction(_,E),provide:createProvideFunction({current:_,fallback:E,messages:S})}}}function createVuetifyAdapter(n){const r=shallowRef(n?.locale??"en"),_=shallowRef(n?.fallback??"en"),E=ref$2({en:en$2,...n?.messages});return{name:"vuetify",current:r,fallback:_,messages:E,t:createTranslateFunction(r,_,E),n:createNumberFunction(r,_),provide:createProvideFunction({current:r,fallback:_,messages:E})}}const LocaleSymbol=Symbol.for("vuetify:locale");function isLocaleInstance(n){return n.name!=null}function createLocale(n){const r=n?.adapter&&isLocaleInstance(n?.adapter)?n?.adapter:createVuetifyAdapter(n),_=createRtl(r,n);return{...r,..._}}function useLocale(){const n=inject$1(LocaleSymbol);if(!n)throw new Error("[Vuetify] Could not find injected locale instance");return n}function provideLocale(n){const r=inject$1(LocaleSymbol);if(!r)throw new Error("[Vuetify] Could not find injected locale instance");const _=r.provide(n),E=provideRtl(_,r.rtl,n),S={..._,...E};return provide(LocaleSymbol,S),S}function genDefaults$3(){return{af:!1,ar:!0,bg:!1,ca:!1,ckb:!1,cs:!1,de:!1,el:!1,en:!1,es:!1,et:!1,fa:!0,fi:!1,fr:!1,hr:!1,hu:!1,he:!0,id:!1,it:!1,ja:!1,km:!1,ko:!1,lv:!1,lt:!1,nl:!1,no:!1,pl:!1,pt:!1,ro:!1,ru:!1,sk:!1,sl:!1,srCyrl:!1,srLatn:!1,sv:!1,th:!1,tr:!1,az:!1,uk:!1,vi:!1,zhHans:!1,zhHant:!1}}function createRtl(n,r){const _=ref$2(r?.rtl??genDefaults$3()),E=computed(()=>_.value[n.current.value]??!1);return{isRtl:E,rtl:_,rtlClasses:computed(()=>`v-locale--is-${E.value?"rtl":"ltr"}`)}}function provideRtl(n,r,_){const E=computed(()=>_.rtl??r.value[n.current.value]??!1);return{isRtl:E,rtl:r,rtlClasses:computed(()=>`v-locale--is-${E.value?"rtl":"ltr"}`)}}function useRtl(){const n=inject$1(LocaleSymbol);if(!n)throw new Error("[Vuetify] Could not find injected rtl instance");return{isRtl:n.isRtl,rtlClasses:n.rtlClasses}}const firstDay={"001":1,AD:1,AE:6,AF:6,AG:0,AI:1,AL:1,AM:1,AN:1,AR:1,AS:0,AT:1,AU:1,AX:1,AZ:1,BA:1,BD:0,BE:1,BG:1,BH:6,BM:1,BN:1,BR:0,BS:0,BT:0,BW:0,BY:1,BZ:0,CA:0,CH:1,CL:1,CM:1,CN:1,CO:0,CR:1,CY:1,CZ:1,DE:1,DJ:6,DK:1,DM:0,DO:0,DZ:6,EC:1,EE:1,EG:6,ES:1,ET:0,FI:1,FJ:1,FO:1,FR:1,GB:1,"GB-alt-variant":0,GE:1,GF:1,GP:1,GR:1,GT:0,GU:0,HK:0,HN:0,HR:1,HU:1,ID:0,IE:1,IL:0,IN:0,IQ:6,IR:6,IS:1,IT:1,JM:0,JO:6,JP:0,KE:0,KG:1,KH:0,KR:0,KW:6,KZ:1,LA:0,LB:1,LI:1,LK:1,LT:1,LU:1,LV:1,LY:6,MC:1,MD:1,ME:1,MH:0,MK:1,MM:0,MN:1,MO:0,MQ:1,MT:0,MV:5,MX:0,MY:1,MZ:0,NI:0,NL:1,NO:1,NP:0,NZ:1,OM:6,PA:0,PE:0,PH:0,PK:0,PL:1,PR:0,PT:0,PY:0,QA:6,RE:1,RO:1,RS:1,RU:1,SA:0,SD:6,SE:1,SG:0,SI:1,SK:1,SM:1,SV:0,SY:6,TH:0,TJ:1,TM:1,TR:1,TT:0,TW:0,UA:1,UM:0,US:0,UY:1,UZ:1,VA:1,VE:0,VI:0,VN:1,WS:0,XK:1,YE:0,ZA:0,ZW:0};function getWeekArray(n,r){const _=[];let E=[];const S=startOfMonth(n),C=endOfMonth(n),A=(S.getDay()-firstDay[r.slice(-2).toUpperCase()]+7)%7,I=(C.getDay()-firstDay[r.slice(-2).toUpperCase()]+7)%7;for(let B=0;B<A;B++){const O=new Date(S);O.setDate(O.getDate()-(A-B)),E.push(O)}for(let B=1;B<=C.getDate();B++){const O=new Date(n.getFullYear(),n.getMonth(),B);E.push(O),E.length===7&&(_.push(E),E=[])}for(let B=1;B<7-I;B++){const O=new Date(C);O.setDate(O.getDate()+B),E.push(O)}return E.length>0&&_.push(E),_}function startOfWeek(n){const r=new Date(n);for(;r.getDay()!==0;)r.setDate(r.getDate()-1);return r}function endOfWeek(n){const r=new Date(n);for(;r.getDay()!==6;)r.setDate(r.getDate()+1);return r}function startOfMonth(n){return new Date(n.getFullYear(),n.getMonth(),1)}function endOfMonth(n){return new Date(n.getFullYear(),n.getMonth()+1,0)}function parseLocalDate(n){const r=n.split("-").map(Number);return new Date(r[0],r[1]-1,r[2])}const _YYYMMDD=/^([12]\d{3}-([1-9]|0[1-9]|1[0-2])-([1-9]|0[1-9]|[12]\d|3[01]))$/;function date$2(n){if(n==null)return new Date;if(n instanceof Date)return n;if(typeof n=="string"){let r;if(_YYYMMDD.test(n))return parseLocalDate(n);if(r=Date.parse(n),!isNaN(r))return new Date(r)}return null}const sundayJanuarySecond2000=new Date(2e3,0,2);function getWeekdays(n){const r=firstDay[n.slice(-2).toUpperCase()];return createRange(7).map(_=>{const E=new Date(sundayJanuarySecond2000);return E.setDate(sundayJanuarySecond2000.getDate()+r+_),new Intl.DateTimeFormat(n,{weekday:"narrow"}).format(E)})}function format$6(n,r,_,E){const S=date$2(n)??new Date,C=E?.[r];if(typeof C=="function")return C(S,r,_);let A={};switch(r){case"fullDateWithWeekday":A={weekday:"long",day:"numeric",month:"long",year:"numeric"};break;case"hours12h":A={hour:"numeric",hour12:!0};break;case"normalDateWithWeekday":A={weekday:"short",day:"numeric",month:"short"};break;case"keyboardDate":A={day:"2-digit",month:"2-digit",year:"numeric"};break;case"monthAndDate":A={month:"long",day:"numeric"};break;case"monthAndYear":A={month:"long",year:"numeric"};break;case"month":A={month:"long"};break;case"monthShort":A={month:"short"};break;case"dayOfMonth":return new Intl.NumberFormat(_).format(S.getDate());case"shortDate":A={year:"2-digit",month:"numeric",day:"numeric"};break;case"weekdayShort":A={weekday:"short"};break;case"year":A={year:"numeric"};break;default:A=C??{timeZone:"UTC",timeZoneName:"short"}}return new Intl.DateTimeFormat(_,A).format(S)}function toISO(n,r){const _=n.toJsDate(r),E=_.getFullYear(),S=padStart(String(_.getMonth()+1),2,"0"),C=padStart(String(_.getDate()),2,"0");return`${E}-${S}-${C}`}function parseISO(n){const[r,_,E]=n.split("-").map(Number);return new Date(r,_-1,E)}function addMinutes(n,r){const _=new Date(n);return _.setMinutes(_.getMinutes()+r),_}function addHours(n,r){const _=new Date(n);return _.setHours(_.getHours()+r),_}function addDays(n,r){const _=new Date(n);return _.setDate(_.getDate()+r),_}function addWeeks(n,r){const _=new Date(n);return _.setDate(_.getDate()+r*7),_}function addMonths(n,r){const _=new Date(n);return _.setMonth(_.getMonth()+r),_}function getYear(n){return n.getFullYear()}function getMonth(n){return n.getMonth()}function getNextMonth(n){return new Date(n.getFullYear(),n.getMonth()+1,1)}function getHours(n){return n.getHours()}function getMinutes(n){return n.getMinutes()}function startOfYear(n){return new Date(n.getFullYear(),0,1)}function endOfYear(n){return new Date(n.getFullYear(),11,31)}function isWithinRange(n,r){return isAfter(n,r[0])&&isBefore(n,r[1])}function isValid(n){const r=new Date(n);return r instanceof Date&&!isNaN(r.getTime())}function isAfter(n,r){return n.getTime()>r.getTime()}function isBefore(n,r){return n.getTime()<r.getTime()}function isEqual$3(n,r){return n.getTime()===r.getTime()}function isSameDay(n,r){return n.getDate()===r.getDate()&&n.getMonth()===r.getMonth()&&n.getFullYear()===r.getFullYear()}function isSameMonth(n,r){return n.getMonth()===r.getMonth()&&n.getFullYear()===r.getFullYear()}function getDiff(n,r,_){const E=new Date(n),S=new Date(r);switch(_){case"years":return E.getFullYear()-S.getFullYear();case"quarters":return Math.floor((E.getMonth()-S.getMonth()+(E.getFullYear()-S.getFullYear())*12)/4);case"months":return E.getMonth()-S.getMonth()+(E.getFullYear()-S.getFullYear())*12;case"weeks":return Math.floor((E.getTime()-S.getTime())/(1e3*60*60*24*7));case"days":return Math.floor((E.getTime()-S.getTime())/(1e3*60*60*24));case"hours":return Math.floor((E.getTime()-S.getTime())/(1e3*60*60));case"minutes":return Math.floor((E.getTime()-S.getTime())/(1e3*60));case"seconds":return Math.floor((E.getTime()-S.getTime())/1e3);default:return E.getTime()-S.getTime()}}function setHours(n,r){const _=new Date(n);return _.setHours(r),_}function setMinutes(n,r){const _=new Date(n);return _.setMinutes(r),_}function setMonth(n,r){const _=new Date(n);return _.setMonth(r),_}function setYear(n,r){const _=new Date(n);return _.setFullYear(r),_}function startOfDay(n){return new Date(n.getFullYear(),n.getMonth(),n.getDate())}function endOfDay(n){return new Date(n.getFullYear(),n.getMonth(),n.getDate(),23,59,59,999)}class VuetifyDateAdapter{constructor(r){this.locale=r.locale,this.formats=r.formats}date(r){return date$2(r)}toJsDate(r){return r}toISO(r){return toISO(this,r)}parseISO(r){return parseISO(r)}addMinutes(r,_){return addMinutes(r,_)}addHours(r,_){return addHours(r,_)}addDays(r,_){return addDays(r,_)}addWeeks(r,_){return addWeeks(r,_)}addMonths(r,_){return addMonths(r,_)}getWeekArray(r){return getWeekArray(r,this.locale)}startOfWeek(r){return startOfWeek(r)}endOfWeek(r){return endOfWeek(r)}startOfMonth(r){return startOfMonth(r)}endOfMonth(r){return endOfMonth(r)}format(r,_){return format$6(r,_,this.locale,this.formats)}isEqual(r,_){return isEqual$3(r,_)}isValid(r){return isValid(r)}isWithinRange(r,_){return isWithinRange(r,_)}isAfter(r,_){return isAfter(r,_)}isBefore(r,_){return!isAfter(r,_)&&!isEqual$3(r,_)}isSameDay(r,_){return isSameDay(r,_)}isSameMonth(r,_){return isSameMonth(r,_)}setMinutes(r,_){return setMinutes(r,_)}setHours(r,_){return setHours(r,_)}setMonth(r,_){return setMonth(r,_)}setYear(r,_){return setYear(r,_)}getDiff(r,_,E){return getDiff(r,_,E)}getWeekdays(){return getWeekdays(this.locale)}getYear(r){return getYear(r)}getMonth(r){return getMonth(r)}getNextMonth(r){return getNextMonth(r)}getHours(r){return getHours(r)}getMinutes(r){return getMinutes(r)}startOfDay(r){return startOfDay(r)}endOfDay(r){return endOfDay(r)}startOfYear(r){return startOfYear(r)}endOfYear(r){return endOfYear(r)}}const DateOptionsSymbol=Symbol.for("vuetify:date-options"),DateAdapterSymbol=Symbol.for("vuetify:date-adapter");function createDate(n,r){const _=mergeDeep({adapter:VuetifyDateAdapter,locale:{af:"af-ZA",bg:"bg-BG",ca:"ca-ES",ckb:"",cs:"cs-CZ",de:"de-DE",el:"el-GR",en:"en-US",et:"et-EE",fa:"fa-IR",fi:"fi-FI",hr:"hr-HR",hu:"hu-HU",he:"he-IL",id:"id-ID",it:"it-IT",ja:"ja-JP",ko:"ko-KR",lv:"lv-LV",lt:"lt-LT",nl:"nl-NL",no:"no-NO",pl:"pl-PL",pt:"pt-PT",ro:"ro-RO",ru:"ru-RU",sk:"sk-SK",sl:"sl-SI",srCyrl:"sr-SP",srLatn:"sr-SP",sv:"sv-SE",th:"th-TH",tr:"tr-TR",az:"az-AZ",uk:"uk-UA",vi:"vi-VN",zhHans:"zh-CN",zhHant:"zh-TW"}},n);return{options:_,instance:createInstance$1(_,r)}}function createInstance$1(n,r){const _=reactive(typeof n.adapter=="function"?new n.adapter({locale:n.locale[r.current.value]??r.current.value,formats:n.formats}):n.adapter);return watch(r.current,E=>{_.locale=n.locale[E]??E??_.locale}),_}const breakpoints=["sm","md","lg","xl","xxl"],DisplaySymbol=Symbol.for("vuetify:display"),defaultDisplayOptions={mobileBreakpoint:"lg",thresholds:{xs:0,sm:600,md:960,lg:1280,xl:1920,xxl:2560}},parseDisplayOptions=function(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:defaultDisplayOptions;return mergeDeep(defaultDisplayOptions,n)};function getClientWidth(n){return IN_BROWSER&&!n?window.innerWidth:typeof n=="object"&&n.clientWidth||0}function getClientHeight(n){return IN_BROWSER&&!n?window.innerHeight:typeof n=="object"&&n.clientHeight||0}function getPlatform(n){const r=IN_BROWSER&&!n?window.navigator.userAgent:"ssr";function _(Z){return!!r.match(Z)}const E=_(/android/i),S=_(/iphone|ipad|ipod/i),C=_(/cordova/i),A=_(/electron/i),I=_(/chrome/i),B=_(/edge/i),O=_(/firefox/i),N=_(/opera/i),U=_(/win/i),j=_(/mac/i),z=_(/linux/i);return{android:E,ios:S,cordova:C,electron:A,chrome:I,edge:B,firefox:O,opera:N,win:U,mac:j,linux:z,touch:SUPPORTS_TOUCH,ssr:r==="ssr"}}function createDisplay(n,r){const{thresholds:_,mobileBreakpoint:E}=parseDisplayOptions(n),S=shallowRef(getClientHeight(r)),C=shallowRef(getPlatform(r)),A=reactive({}),I=shallowRef(getClientWidth(r));function B(){S.value=getClientHeight(),I.value=getClientWidth()}function O(){B(),C.value=getPlatform()}return watchEffect(()=>{const N=I.value<_.sm,U=I.value<_.md&&!N,j=I.value<_.lg&&!(U||N),z=I.value<_.xl&&!(j||U||N),Z=I.value<_.xxl&&!(z||j||U||N),X=I.value>=_.xxl,Q=N?"xs":U?"sm":j?"md":z?"lg":Z?"xl":"xxl",se=typeof E=="number"?E:_[E],oe=I.value<se;A.xs=N,A.sm=U,A.md=j,A.lg=z,A.xl=Z,A.xxl=X,A.smAndUp=!N,A.mdAndUp=!(N||U),A.lgAndUp=!(N||U||j),A.xlAndUp=!(N||U||j||z),A.smAndDown=!(j||z||Z||X),A.mdAndDown=!(z||Z||X),A.lgAndDown=!(Z||X),A.xlAndDown=!X,A.name=Q,A.height=S.value,A.width=I.value,A.mobile=oe,A.mobileBreakpoint=E,A.platform=C.value,A.thresholds=_}),IN_BROWSER&&window.addEventListener("resize",B,{passive:!0}),{...toRefs(A),update:O,ssr:!!r}}function useDisplay(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:getCurrentInstanceName();const _=inject$1(DisplaySymbol);if(!_)throw new Error("Could not find Vuetify display injection");const E=computed(()=>{if(!n.mobileBreakpoint)return _.mobile.value;const C=typeof n.mobileBreakpoint=="number"?n.mobileBreakpoint:_.thresholds.value[n.mobileBreakpoint];return _.width.value<C}),S=computed(()=>r?{[`${r}--mobile`]:E.value}:{});return{..._,displayClasses:S,mobile:E}}const GoToSymbol=Symbol.for("vuetify:goto");function genDefaults$2(){return{container:void 0,duration:300,layout:!1,offset:0,easing:"easeInOutCubic",patterns:{linear:n=>n,easeInQuad:n=>n**2,easeOutQuad:n=>n*(2-n),easeInOutQuad:n=>n<.5?2*n**2:-1+(4-2*n)*n,easeInCubic:n=>n**3,easeOutCubic:n=>--n**3+1,easeInOutCubic:n=>n<.5?4*n**3:(n-1)*(2*n-2)*(2*n-2)+1,easeInQuart:n=>n**4,easeOutQuart:n=>1- --n**4,easeInOutQuart:n=>n<.5?8*n**4:1-8*--n**4,easeInQuint:n=>n**5,easeOutQuint:n=>1+--n**5,easeInOutQuint:n=>n<.5?16*n**5:1+16*--n**5}}}function createGoTo(n,r){return{rtl:r.isRtl,options:mergeDeep(genDefaults$2(),n)}}const aliases$1={collapse:"mdi-chevron-up",complete:"mdi-check",cancel:"mdi-close-circle",close:"mdi-close",delete:"mdi-close-circle",clear:"mdi-close-circle",success:"mdi-check-circle",info:"mdi-information",warning:"mdi-alert-circle",error:"mdi-close-circle",prev:"mdi-chevron-left",next:"mdi-chevron-right",checkboxOn:"mdi-checkbox-marked",checkboxOff:"mdi-checkbox-blank-outline",checkboxIndeterminate:"mdi-minus-box",delimiter:"mdi-circle",sortAsc:"mdi-arrow-up",sortDesc:"mdi-arrow-down",expand:"mdi-chevron-down",menu:"mdi-menu",subgroup:"mdi-menu-down",dropdown:"mdi-menu-down",radioOn:"mdi-radiobox-marked",radioOff:"mdi-radiobox-blank",edit:"mdi-pencil",ratingEmpty:"mdi-star-outline",ratingFull:"mdi-star",ratingHalf:"mdi-star-half-full",loading:"mdi-cached",first:"mdi-page-first",last:"mdi-page-last",unfold:"mdi-unfold-more-horizontal",file:"mdi-paperclip",plus:"mdi-plus",minus:"mdi-minus",calendar:"mdi-calendar",treeviewCollapse:"mdi-menu-down",treeviewExpand:"mdi-menu-right",eyeDropper:"mdi-eyedropper"},mdi={component:n=>h$2(VClassIcon,{...n,class:"mdi"})},IconValue=[String,Function,Object,Array],IconSymbol=Symbol.for("vuetify:icons"),makeIconProps=propsFactory({icon:{type:IconValue},tag:{type:String,required:!0}},"icon"),VComponentIcon=genericComponent()({name:"VComponentIcon",props:makeIconProps(),setup(n,r){let{slots:_}=r;return()=>{const E=n.icon;return createVNode(n.tag,null,{default:()=>[n.icon?createVNode(E,null,null):_.default?.()]})}}}),VSvgIcon=defineComponent({name:"VSvgIcon",inheritAttrs:!1,props:makeIconProps(),setup(n,r){let{attrs:_}=r;return()=>createVNode(n.tag,mergeProps(_,{style:null}),{default:()=>[createVNode("svg",{class:"v-icon__svg",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",role:"img","aria-hidden":"true"},[Array.isArray(n.icon)?n.icon.map(E=>Array.isArray(E)?createVNode("path",{d:E[0],"fill-opacity":E[1]},null):createVNode("path",{d:E},null)):createVNode("path",{d:n.icon},null)])]})}});defineComponent({name:"VLigatureIcon",props:makeIconProps(),setup(n){return()=>createVNode(n.tag,null,{default:()=>[n.icon]})}});const VClassIcon=defineComponent({name:"VClassIcon",props:makeIconProps(),setup(n){return()=>createVNode(n.tag,{class:n.icon},null)}});function genDefaults$1(){return{svg:{component:VSvgIcon},class:{component:VClassIcon}}}function createIcons(n){const r=genDefaults$1(),_=n?.defaultSet??"mdi";return _==="mdi"&&!r.mdi&&(r.mdi=mdi),mergeDeep({defaultSet:_,sets:r,aliases:{...aliases$1,vuetify:["M8.2241 14.2009L12 21L22 3H14.4459L8.2241 14.2009Z",["M7.26303 12.4733L7.00113 12L2 3H12.5261C12.5261 3 12.5261 3 12.5261 3L7.26303 12.4733Z",.6]],"vuetify-outline":"svg:M7.26 12.47 12.53 3H2L7.26 12.47ZM14.45 3 8.22 14.2 12 21 22 3H14.45ZM18.6 5 12 16.88 10.51 14.2 15.62 5ZM7.26 8.35 5.4 5H9.13L7.26 8.35Z"}},n)}const useIcon=n=>{const r=inject$1(IconSymbol);if(!r)throw new Error("Missing Vuetify Icons provide!");return{iconData:computed(()=>{const E=unref(n);if(!E)return{component:VComponentIcon};let S=E;if(typeof S=="string"&&(S=S.trim(),S.startsWith("$")&&(S=r.aliases?.[S.slice(1)])),!S)throw new Error(`Could not find aliased icon "${E}"`);if(Array.isArray(S))return{component:VSvgIcon,icon:S};if(typeof S!="string")return{component:VComponentIcon,icon:S};const C=Object.keys(r.sets).find(B=>typeof S=="string"&&S.startsWith(`${B}:`)),A=C?S.slice(C.length+1):S;return{component:r.sets[C??r.defaultSet].component,icon:A}})}},ThemeSymbol=Symbol.for("vuetify:theme"),makeThemeProps=propsFactory({theme:String},"theme");function genDefaults(){return{defaultTheme:"light",variations:{colors:[],lighten:0,darken:0},themes:{light:{dark:!1,colors:{background:"#FFFFFF",surface:"#FFFFFF","surface-bright":"#FFFFFF","surface-light":"#EEEEEE","surface-variant":"#424242","on-surface-variant":"#EEEEEE",primary:"#1867C0","primary-darken-1":"#1F5592",secondary:"#48A9A6","secondary-darken-1":"#018786",error:"#B00020",info:"#2196F3",success:"#4CAF50",warning:"#FB8C00"},variables:{"border-color":"#000000","border-opacity":.12,"high-emphasis-opacity":.87,"medium-emphasis-opacity":.6,"disabled-opacity":.38,"idle-opacity":.04,"hover-opacity":.04,"focus-opacity":.12,"selected-opacity":.08,"activated-opacity":.12,"pressed-opacity":.12,"dragged-opacity":.08,"theme-kbd":"#212529","theme-on-kbd":"#FFFFFF","theme-code":"#F5F5F5","theme-on-code":"#000000"}},dark:{dark:!0,colors:{background:"#121212",surface:"#212121","surface-bright":"#ccbfd6","surface-light":"#424242","surface-variant":"#a3a3a3","on-surface-variant":"#424242",primary:"#2196F3","primary-darken-1":"#277CC1",secondary:"#54B6B2","secondary-darken-1":"#48A9A6",error:"#CF6679",info:"#2196F3",success:"#4CAF50",warning:"#FB8C00"},variables:{"border-color":"#FFFFFF","border-opacity":.12,"high-emphasis-opacity":1,"medium-emphasis-opacity":.7,"disabled-opacity":.5,"idle-opacity":.1,"hover-opacity":.04,"focus-opacity":.12,"selected-opacity":.08,"activated-opacity":.12,"pressed-opacity":.16,"dragged-opacity":.08,"theme-kbd":"#212529","theme-on-kbd":"#FFFFFF","theme-code":"#343434","theme-on-code":"#CCCCCC"}}}}}function parseThemeOptions(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:genDefaults();const r=genDefaults();if(!n)return{...r,isDisabled:!0};const _={};for(const[E,S]of Object.entries(n.themes??{})){const C=S.dark||E==="dark"?r.themes?.dark:r.themes?.light;_[E]=mergeDeep(C,S)}return mergeDeep(r,{...n,themes:_})}function createTheme(n){const r=parseThemeOptions(n),_=ref$2(r.defaultTheme),E=ref$2(r.themes),S=computed(()=>{const N={};for(const[U,j]of Object.entries(E.value)){const z=N[U]={...j,colors:{...j.colors}};if(r.variations)for(const Z of r.variations.colors){const X=z.colors[Z];if(X)for(const Q of["lighten","darken"]){const se=Q==="lighten"?lighten:darken;for(const oe of createRange(r.variations[Q],1))z.colors[`${Z}-${Q}-${oe}`]=RGBtoHex(se(parseColor(X),oe))}}for(const Z of Object.keys(z.colors)){if(/^on-[a-z]/.test(Z)||z.colors[`on-${Z}`])continue;const X=`on-${Z}`,Q=parseColor(z.colors[Z]);z.colors[X]=getForeground(Q)}}return N}),C=computed(()=>S.value[_.value]),A=computed(()=>{const N=[];C.value.dark&&createCssClass(N,":root",["color-scheme: dark"]),createCssClass(N,":root",genCssVariables(C.value));for(const[Z,X]of Object.entries(S.value))createCssClass(N,`.v-theme--${Z}`,[`color-scheme: ${X.dark?"dark":"normal"}`,...genCssVariables(X)]);const U=[],j=[],z=new Set(Object.values(S.value).flatMap(Z=>Object.keys(Z.colors)));for(const Z of z)/^on-[a-z]/.test(Z)?createCssClass(j,`.${Z}`,[`color: rgb(var(--v-theme-${Z})) !important`]):(createCssClass(U,`.bg-${Z}`,[`--v-theme-overlay-multiplier: var(--v-theme-${Z}-overlay-multiplier)`,`background-color: rgb(var(--v-theme-${Z})) !important`,`color: rgb(var(--v-theme-on-${Z})) !important`]),createCssClass(j,`.text-${Z}`,[`color: rgb(var(--v-theme-${Z})) !important`]),createCssClass(j,`.border-${Z}`,[`--v-border-color: var(--v-theme-${Z})`]));return N.push(...U,...j),N.map((Z,X)=>X===0?Z:`    ${Z}`).join("")});function I(){return{style:[{children:A.value,id:"vuetify-theme-stylesheet",nonce:r.cspNonce||!1}]}}function B(N){if(r.isDisabled)return;const U=N._context.provides.usehead;if(U)if(U.push){const j=U.push(I);IN_BROWSER&&watch(A,()=>{j.patch(I)})}else IN_BROWSER?(U.addHeadObjs(computed(I)),watchEffect(()=>U.updateDOM())):U.addHeadObjs(I());else{let z=function(){if(typeof document<"u"&&!j){const Z=document.createElement("style");Z.type="text/css",Z.id="vuetify-theme-stylesheet",r.cspNonce&&Z.setAttribute("nonce",r.cspNonce),j=Z,document.head.appendChild(j)}j&&(j.innerHTML=A.value)},j=IN_BROWSER?document.getElementById("vuetify-theme-stylesheet"):null;IN_BROWSER?watch(A,z,{immediate:!0}):z()}}const O=computed(()=>r.isDisabled?void 0:`v-theme--${_.value}`);return{install:B,isDisabled:r.isDisabled,name:_,themes:E,current:C,computedThemes:S,themeClasses:O,styles:A,global:{name:_,current:C}}}function provideTheme(n){getCurrentInstance("provideTheme");const r=inject$1(ThemeSymbol,null);if(!r)throw new Error("Could not find Vuetify theme injection");const _=computed(()=>n.theme??r.name.value),E=computed(()=>r.themes.value[_.value]),S=computed(()=>r.isDisabled?void 0:`v-theme--${_.value}`),C={...r,name:_,current:E,themeClasses:S};return provide(ThemeSymbol,C),C}function createCssClass(n,r,_){n.push(`${r} {
`,..._.map(E=>`  ${E};
`),`}
`)}function genCssVariables(n){const r=n.dark?2:1,_=n.dark?1:2,E=[];for(const[S,C]of Object.entries(n.colors)){const A=parseColor(C);E.push(`--v-theme-${S}: ${A.r},${A.g},${A.b}`),S.startsWith("on-")||E.push(`--v-theme-${S}-overlay-multiplier: ${getLuma(C)>.18?r:_}`)}for(const[S,C]of Object.entries(n.variables)){const A=typeof C=="string"&&C.startsWith("#")?parseColor(C):void 0,I=A?`${A.r}, ${A.g}, ${A.b}`:void 0;E.push(`--v-${S}: ${I??C}`)}return E}function useResizeObserver(n){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"content";const _=ref$2(),E=ref$2();if(IN_BROWSER){const S=new ResizeObserver(C=>{n?.(C,S),C.length&&(r==="content"?E.value=C[0].contentRect:E.value=C[0].target.getBoundingClientRect())});onBeforeUnmount(()=>{S.disconnect()}),watch(_,(C,A)=>{A&&(S.unobserve(refElement(A)),E.value=void 0),C&&S.observe(refElement(C))},{flush:"post"})}return{resizeRef:_,contentRect:readonly$3(E)}}const VuetifyLayoutKey=Symbol.for("vuetify:layout"),VuetifyLayoutItemKey=Symbol.for("vuetify:layout-item"),ROOT_ZINDEX=1e3,makeLayoutProps=propsFactory({overlaps:{type:Array,default:()=>[]},fullHeight:Boolean},"layout");function useLayout(){const n=inject$1(VuetifyLayoutKey);if(!n)throw new Error("[Vuetify] Could not find injected layout");return{getLayoutItem:n.getLayoutItem,mainRect:n.mainRect,mainStyles:n.mainStyles}}const generateLayers=(n,r,_,E)=>{let S={top:0,left:0,right:0,bottom:0};const C=[{id:"",layer:{...S}}];for(const A of n){const I=r.get(A),B=_.get(A),O=E.get(A);if(!I||!B||!O)continue;const N={...S,[I.value]:parseInt(S[I.value],10)+(O.value?parseInt(B.value,10):0)};C.push({id:A,layer:N}),S=N}return C};function createLayout(n){const r=inject$1(VuetifyLayoutKey,null),_=computed(()=>r?r.rootZIndex.value-100:ROOT_ZINDEX),E=ref$2([]),S=reactive(new Map),C=reactive(new Map),A=reactive(new Map),I=reactive(new Map),B=reactive(new Map),{resizeRef:O,contentRect:N}=useResizeObserver(),U=computed(()=>{const xe=new Map,Re=n.overlaps??[];for(const Ne of Re.filter(Fe=>Fe.includes(":"))){const[Fe,ht]=Ne.split(":");if(!E.value.includes(Fe)||!E.value.includes(ht))continue;const nt=S.get(Fe),Ee=S.get(ht),Ce=C.get(Fe),_e=C.get(ht);!nt||!Ee||!Ce||!_e||(xe.set(ht,{position:nt.value,amount:parseInt(Ce.value,10)}),xe.set(Fe,{position:Ee.value,amount:-parseInt(_e.value,10)}))}return xe}),j=computed(()=>{const xe=[...new Set([...A.values()].map(Ne=>Ne.value))].sort((Ne,Fe)=>Ne-Fe),Re=[];for(const Ne of xe){const Fe=E.value.filter(ht=>A.get(ht)?.value===Ne);Re.push(...Fe)}return generateLayers(Re,S,C,I)}),z=computed(()=>!Array.from(B.values()).some(xe=>xe.value)),Z=computed(()=>j.value[j.value.length-1].layer),X=computed(()=>({"--v-layout-left":convertToUnit(Z.value.left),"--v-layout-right":convertToUnit(Z.value.right),"--v-layout-top":convertToUnit(Z.value.top),"--v-layout-bottom":convertToUnit(Z.value.bottom),...z.value?void 0:{transition:"none"}})),Q=computed(()=>j.value.slice(1).map((xe,Re)=>{let{id:Ne}=xe;const{layer:Fe}=j.value[Re],ht=C.get(Ne),nt=S.get(Ne);return{id:Ne,...Fe,size:Number(ht.value),position:nt.value}})),se=xe=>Q.value.find(Re=>Re.id===xe),oe=getCurrentInstance("createLayout"),ue=shallowRef(!1);onMounted(()=>{ue.value=!0}),provide(VuetifyLayoutKey,{register:(xe,Re)=>{let{id:Ne,order:Fe,position:ht,layoutSize:nt,elementSize:Ee,active:Ce,disableTransitions:_e,absolute:Ie}=Re;A.set(Ne,Fe),S.set(Ne,ht),C.set(Ne,nt),I.set(Ne,Ce),_e&&B.set(Ne,_e);const Be=findChildrenWithProvide(VuetifyLayoutItemKey,oe?.vnode).indexOf(xe);Be>-1?E.value.splice(Be,0,Ne):E.value.push(Ne);const Ge=computed(()=>Q.value.findIndex(Me=>Me.id===Ne)),je=computed(()=>_.value+j.value.length*2-Ge.value*2),Ve=computed(()=>{const Me=ht.value==="left"||ht.value==="right",tt=ht.value==="right",Ke=ht.value==="bottom",mt={[ht.value]:0,zIndex:je.value,transform:`translate${Me?"X":"Y"}(${(Ce.value?0:-110)*(tt||Ke?-1:1)}%)`,position:Ie.value||_.value!==ROOT_ZINDEX?"absolute":"fixed",...z.value?void 0:{transition:"none"}};if(!ue.value)return mt;const ct=Q.value[Ge.value];if(!ct)throw new Error(`[Vuetify] Could not find layout item "${Ne}"`);const Qe=U.value.get(Ne);return Qe&&(ct[Qe.position]+=Qe.amount),{...mt,height:Me?`calc(100% - ${ct.top}px - ${ct.bottom}px)`:Ee.value?`${Ee.value}px`:void 0,left:tt?void 0:`${ct.left}px`,right:tt?`${ct.right}px`:void 0,top:ht.value!=="bottom"?`${ct.top}px`:void 0,bottom:ht.value!=="top"?`${ct.bottom}px`:void 0,width:Me?Ee.value?`${Ee.value}px`:void 0:`calc(100% - ${ct.left}px - ${ct.right}px)`}}),Pe=computed(()=>({zIndex:je.value-1}));return{layoutItemStyles:Ve,layoutItemScrimStyles:Pe,zIndex:je}},unregister:xe=>{A.delete(xe),S.delete(xe),C.delete(xe),I.delete(xe),B.delete(xe),E.value=E.value.filter(Re=>Re!==xe)},mainRect:Z,mainStyles:X,getLayoutItem:se,items:Q,layoutRect:N,rootZIndex:_});const we=computed(()=>["v-layout",{"v-layout--full-height":n.fullHeight}]),Te=computed(()=>({zIndex:r?_.value:void 0,position:r?"relative":void 0,overflow:r?"hidden":void 0}));return{layoutClasses:we,layoutStyles:Te,getLayoutItem:se,items:Q,layoutRect:N,layoutRef:O}}function createVuetify(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{blueprint:r,..._}=n,E=mergeDeep(r,_),{aliases:S={},components:C={},directives:A={}}=E,I=createDefaults(E.defaults),B=createDisplay(E.display,E.ssr),O=createTheme(E.theme),N=createIcons(E.icons),U=createLocale(E.locale),j=createDate(E.date,U),z=createGoTo(E.goTo,U);return{install:X=>{for(const Q in A)X.directive(Q,A[Q]);for(const Q in C)X.component(Q,C[Q]);for(const Q in S)X.component(Q,defineComponent({...S[Q],name:Q,aliasName:S[Q].name}));if(O.install(X),X.provide(DefaultsSymbol,I),X.provide(DisplaySymbol,B),X.provide(ThemeSymbol,O),X.provide(IconSymbol,N),X.provide(LocaleSymbol,U),X.provide(DateOptionsSymbol,j.options),X.provide(DateAdapterSymbol,j.instance),X.provide(GoToSymbol,z),IN_BROWSER&&E.ssr)if(X.$nuxt)X.$nuxt.hook("app:suspense:resolve",()=>{B.update()});else{const{mount:Q}=X;X.mount=function(){const se=Q(...arguments);return nextTick$3(()=>B.update()),X.mount=Q,se}}getUid.reset(),X.mixin({computed:{$vuetify(){return reactive({defaults:inject.call(this,DefaultsSymbol),display:inject.call(this,DisplaySymbol),theme:inject.call(this,ThemeSymbol),icons:inject.call(this,IconSymbol),locale:inject.call(this,LocaleSymbol),date:inject.call(this,DateAdapterSymbol)})}}})},defaults:I,display:B,theme:O,icons:N,locale:U,date:j,goTo:z}}const version$5="3.5.9";createVuetify.version=version$5;function inject(n){const r=this.$,_=r.parent?.provides??r.vnode.appContext?.provides;if(_&&n in _)return _[n]}const vuetify=createVuetify({});/*!
  * vue-router v4.3.0
  * (c) 2024 Eduardo San Martin Morote
  * @license MIT
  */const isBrowser$1=typeof document<"u";function isESModule(n){return n.__esModule||n[Symbol.toStringTag]==="Module"}const assign$3=Object.assign;function applyToParams(n,r){const _={};for(const E in r){const S=r[E];_[E]=isArray$5(S)?S.map(n):n(S)}return _}const noop$7=()=>{},isArray$5=Array.isArray,HASH_RE=/#/g,AMPERSAND_RE=/&/g,SLASH_RE=/\//g,EQUAL_RE=/=/g,IM_RE=/\?/g,PLUS_RE=/\+/g,ENC_BRACKET_OPEN_RE=/%5B/g,ENC_BRACKET_CLOSE_RE=/%5D/g,ENC_CARET_RE=/%5E/g,ENC_BACKTICK_RE=/%60/g,ENC_CURLY_OPEN_RE=/%7B/g,ENC_PIPE_RE=/%7C/g,ENC_CURLY_CLOSE_RE=/%7D/g,ENC_SPACE_RE=/%20/g;function commonEncode(n){return encodeURI(""+n).replace(ENC_PIPE_RE,"|").replace(ENC_BRACKET_OPEN_RE,"[").replace(ENC_BRACKET_CLOSE_RE,"]")}function encodeHash(n){return commonEncode(n).replace(ENC_CURLY_OPEN_RE,"{").replace(ENC_CURLY_CLOSE_RE,"}").replace(ENC_CARET_RE,"^")}function encodeQueryValue(n){return commonEncode(n).replace(PLUS_RE,"%2B").replace(ENC_SPACE_RE,"+").replace(HASH_RE,"%23").replace(AMPERSAND_RE,"%26").replace(ENC_BACKTICK_RE,"`").replace(ENC_CURLY_OPEN_RE,"{").replace(ENC_CURLY_CLOSE_RE,"}").replace(ENC_CARET_RE,"^")}function encodeQueryKey(n){return encodeQueryValue(n).replace(EQUAL_RE,"%3D")}function encodePath(n){return commonEncode(n).replace(HASH_RE,"%23").replace(IM_RE,"%3F")}function encodeParam(n){return n==null?"":encodePath(n).replace(SLASH_RE,"%2F")}function decode$v(n){try{return decodeURIComponent(""+n)}catch{}return""+n}const TRAILING_SLASH_RE=/\/$/,removeTrailingSlash=n=>n.replace(TRAILING_SLASH_RE,"");function parseURL(n,r,_="/"){let E,S={},C="",A="";const I=r.indexOf("#");let B=r.indexOf("?");return I<B&&I>=0&&(B=-1),B>-1&&(E=r.slice(0,B),C=r.slice(B+1,I>-1?I:r.length),S=n(C)),I>-1&&(E=E||r.slice(0,I),A=r.slice(I,r.length)),E=resolveRelativePath(E??r,_),{fullPath:E+(C&&"?")+C+A,path:E,query:S,hash:decode$v(A)}}function stringifyURL(n,r){const _=r.query?n(r.query):"";return r.path+(_&&"?")+_+(r.hash||"")}function stripBase(n,r){return!r||!n.toLowerCase().startsWith(r.toLowerCase())?n:n.slice(r.length)||"/"}function isSameRouteLocation(n,r,_){const E=r.matched.length-1,S=_.matched.length-1;return E>-1&&E===S&&isSameRouteRecord(r.matched[E],_.matched[S])&&isSameRouteLocationParams(r.params,_.params)&&n(r.query)===n(_.query)&&r.hash===_.hash}function isSameRouteRecord(n,r){return(n.aliasOf||n)===(r.aliasOf||r)}function isSameRouteLocationParams(n,r){if(Object.keys(n).length!==Object.keys(r).length)return!1;for(const _ in n)if(!isSameRouteLocationParamsValue(n[_],r[_]))return!1;return!0}function isSameRouteLocationParamsValue(n,r){return isArray$5(n)?isEquivalentArray(n,r):isArray$5(r)?isEquivalentArray(r,n):n===r}function isEquivalentArray(n,r){return isArray$5(r)?n.length===r.length&&n.every((_,E)=>_===r[E]):n.length===1&&n[0]===r}function resolveRelativePath(n,r){if(n.startsWith("/"))return n;if(!n)return r;const _=r.split("/"),E=n.split("/"),S=E[E.length-1];(S===".."||S===".")&&E.push("");let C=_.length-1,A,I;for(A=0;A<E.length;A++)if(I=E[A],I!==".")if(I==="..")C>1&&C--;else break;return _.slice(0,C).join("/")+"/"+E.slice(A).join("/")}var NavigationType;(function(n){n.pop="pop",n.push="push"})(NavigationType||(NavigationType={}));var NavigationDirection;(function(n){n.back="back",n.forward="forward",n.unknown=""})(NavigationDirection||(NavigationDirection={}));function normalizeBase(n){if(!n)if(isBrowser$1){const r=document.querySelector("base");n=r&&r.getAttribute("href")||"/",n=n.replace(/^\w+:\/\/[^\/]+/,"")}else n="/";return n[0]!=="/"&&n[0]!=="#"&&(n="/"+n),removeTrailingSlash(n)}const BEFORE_HASH_RE=/^[^#]+#/;function createHref(n,r){return n.replace(BEFORE_HASH_RE,"#")+r}function getElementPosition(n,r){const _=document.documentElement.getBoundingClientRect(),E=n.getBoundingClientRect();return{behavior:r.behavior,left:E.left-_.left-(r.left||0),top:E.top-_.top-(r.top||0)}}const computeScrollPosition=()=>({left:window.scrollX,top:window.scrollY});function scrollToPosition(n){let r;if("el"in n){const _=n.el,E=typeof _=="string"&&_.startsWith("#"),S=typeof _=="string"?E?document.getElementById(_.slice(1)):document.querySelector(_):_;if(!S)return;r=getElementPosition(S,n)}else r=n;"scrollBehavior"in document.documentElement.style?window.scrollTo(r):window.scrollTo(r.left!=null?r.left:window.scrollX,r.top!=null?r.top:window.scrollY)}function getScrollKey(n,r){return(history.state?history.state.position-r:-1)+n}const scrollPositions=new Map;function saveScrollPosition(n,r){scrollPositions.set(n,r)}function getSavedScrollPosition(n){const r=scrollPositions.get(n);return scrollPositions.delete(n),r}let createBaseLocation=()=>location.protocol+"//"+location.host;function createCurrentLocation(n,r){const{pathname:_,search:E,hash:S}=r,C=n.indexOf("#");if(C>-1){let I=S.includes(n.slice(C))?n.slice(C).length:1,B=S.slice(I);return B[0]!=="/"&&(B="/"+B),stripBase(B,"")}return stripBase(_,n)+E+S}function useHistoryListeners(n,r,_,E){let S=[],C=[],A=null;const I=({state:j})=>{const z=createCurrentLocation(n,location),Z=_.value,X=r.value;let Q=0;if(j){if(_.value=z,r.value=j,A&&A===Z){A=null;return}Q=X?j.position-X.position:0}else E(z);S.forEach(se=>{se(_.value,Z,{delta:Q,type:NavigationType.pop,direction:Q?Q>0?NavigationDirection.forward:NavigationDirection.back:NavigationDirection.unknown})})};function B(){A=_.value}function O(j){S.push(j);const z=()=>{const Z=S.indexOf(j);Z>-1&&S.splice(Z,1)};return C.push(z),z}function N(){const{history:j}=window;j.state&&j.replaceState(assign$3({},j.state,{scroll:computeScrollPosition()}),"")}function U(){for(const j of C)j();C=[],window.removeEventListener("popstate",I),window.removeEventListener("beforeunload",N)}return window.addEventListener("popstate",I),window.addEventListener("beforeunload",N,{passive:!0}),{pauseListeners:B,listen:O,destroy:U}}function buildState(n,r,_,E=!1,S=!1){return{back:n,current:r,forward:_,replaced:E,position:window.history.length,scroll:S?computeScrollPosition():null}}function useHistoryStateNavigation(n){const{history:r,location:_}=window,E={value:createCurrentLocation(n,_)},S={value:r.state};S.value||C(E.value,{back:null,current:E.value,forward:null,position:r.length-1,replaced:!0,scroll:null},!0);function C(B,O,N){const U=n.indexOf("#"),j=U>-1?(_.host&&document.querySelector("base")?n:n.slice(U))+B:createBaseLocation()+n+B;try{r[N?"replaceState":"pushState"](O,"",j),S.value=O}catch(z){console.error(z),_[N?"replace":"assign"](j)}}function A(B,O){const N=assign$3({},r.state,buildState(S.value.back,B,S.value.forward,!0),O,{position:S.value.position});C(B,N,!0),E.value=B}function I(B,O){const N=assign$3({},S.value,r.state,{forward:B,scroll:computeScrollPosition()});C(N.current,N,!0);const U=assign$3({},buildState(E.value,B,null),{position:N.position+1},O);C(B,U,!1),E.value=B}return{location:E,state:S,push:I,replace:A}}function createWebHistory(n){n=normalizeBase(n);const r=useHistoryStateNavigation(n),_=useHistoryListeners(n,r.state,r.location,r.replace);function E(C,A=!0){A||_.pauseListeners(),history.go(C)}const S=assign$3({location:"",base:n,go:E,createHref:createHref.bind(null,n)},r,_);return Object.defineProperty(S,"location",{enumerable:!0,get:()=>r.location.value}),Object.defineProperty(S,"state",{enumerable:!0,get:()=>r.state.value}),S}function createWebHashHistory(n){return n=location.host?n||location.pathname+location.search:"",n.includes("#")||(n+="#"),createWebHistory(n)}function isRouteLocation(n){return typeof n=="string"||n&&typeof n=="object"}function isRouteName(n){return typeof n=="string"||typeof n=="symbol"}const START_LOCATION_NORMALIZED={path:"/",name:void 0,params:{},query:{},hash:"",fullPath:"/",matched:[],meta:{},redirectedFrom:void 0},NavigationFailureSymbol=Symbol("");var NavigationFailureType;(function(n){n[n.aborted=4]="aborted",n[n.cancelled=8]="cancelled",n[n.duplicated=16]="duplicated"})(NavigationFailureType||(NavigationFailureType={}));function createRouterError(n,r){return assign$3(new Error,{type:n,[NavigationFailureSymbol]:!0},r)}function isNavigationFailure(n,r){return n instanceof Error&&NavigationFailureSymbol in n&&(r==null||!!(n.type&r))}const BASE_PARAM_PATTERN="[^/]+?",BASE_PATH_PARSER_OPTIONS={sensitive:!1,strict:!1,start:!0,end:!0},REGEX_CHARS_RE=/[.+*?^${}()[\]/\\]/g;function tokensToParser(n,r){const _=assign$3({},BASE_PATH_PARSER_OPTIONS,r),E=[];let S=_.start?"^":"";const C=[];for(const O of n){const N=O.length?[]:[90];_.strict&&!O.length&&(S+="/");for(let U=0;U<O.length;U++){const j=O[U];let z=40+(_.sensitive?.25:0);if(j.type===0)U||(S+="/"),S+=j.value.replace(REGEX_CHARS_RE,"\\$&"),z+=40;else if(j.type===1){const{value:Z,repeatable:X,optional:Q,regexp:se}=j;C.push({name:Z,repeatable:X,optional:Q});const oe=se||BASE_PARAM_PATTERN;if(oe!==BASE_PARAM_PATTERN){z+=10;try{new RegExp(`(${oe})`)}catch(we){throw new Error(`Invalid custom RegExp for param "${Z}" (${oe}): `+we.message)}}let ue=X?`((?:${oe})(?:/(?:${oe}))*)`:`(${oe})`;U||(ue=Q&&O.length<2?`(?:/${ue})`:"/"+ue),Q&&(ue+="?"),S+=ue,z+=20,Q&&(z+=-8),X&&(z+=-20),oe===".*"&&(z+=-50)}N.push(z)}E.push(N)}if(_.strict&&_.end){const O=E.length-1;E[O][E[O].length-1]+=.7000000000000001}_.strict||(S+="/?"),_.end?S+="$":_.strict&&(S+="(?:/|$)");const A=new RegExp(S,_.sensitive?"":"i");function I(O){const N=O.match(A),U={};if(!N)return null;for(let j=1;j<N.length;j++){const z=N[j]||"",Z=C[j-1];U[Z.name]=z&&Z.repeatable?z.split("/"):z}return U}function B(O){let N="",U=!1;for(const j of n){(!U||!N.endsWith("/"))&&(N+="/"),U=!1;for(const z of j)if(z.type===0)N+=z.value;else if(z.type===1){const{value:Z,repeatable:X,optional:Q}=z,se=Z in O?O[Z]:"";if(isArray$5(se)&&!X)throw new Error(`Provided param "${Z}" is an array but it is not repeatable (* or + modifiers)`);const oe=isArray$5(se)?se.join("/"):se;if(!oe)if(Q)j.length<2&&(N.endsWith("/")?N=N.slice(0,-1):U=!0);else throw new Error(`Missing required param "${Z}"`);N+=oe}}return N||"/"}return{re:A,score:E,keys:C,parse:I,stringify:B}}function compareScoreArray(n,r){let _=0;for(;_<n.length&&_<r.length;){const E=r[_]-n[_];if(E)return E;_++}return n.length<r.length?n.length===1&&n[0]===80?-1:1:n.length>r.length?r.length===1&&r[0]===80?1:-1:0}function comparePathParserScore(n,r){let _=0;const E=n.score,S=r.score;for(;_<E.length&&_<S.length;){const C=compareScoreArray(E[_],S[_]);if(C)return C;_++}if(Math.abs(S.length-E.length)===1){if(isLastScoreNegative(E))return 1;if(isLastScoreNegative(S))return-1}return S.length-E.length}function isLastScoreNegative(n){const r=n[n.length-1];return n.length>0&&r[r.length-1]<0}const ROOT_TOKEN={type:0,value:""},VALID_PARAM_RE=/[a-zA-Z0-9_]/;function tokenizePath(n){if(!n)return[[]];if(n==="/")return[[ROOT_TOKEN]];if(!n.startsWith("/"))throw new Error(`Invalid path "${n}"`);function r(z){throw new Error(`ERR (${_})/"${O}": ${z}`)}let _=0,E=_;const S=[];let C;function A(){C&&S.push(C),C=[]}let I=0,B,O="",N="";function U(){O&&(_===0?C.push({type:0,value:O}):_===1||_===2||_===3?(C.length>1&&(B==="*"||B==="+")&&r(`A repeatable param (${O}) must be alone in its segment. eg: '/:ids+.`),C.push({type:1,value:O,regexp:N,repeatable:B==="*"||B==="+",optional:B==="*"||B==="?"})):r("Invalid state to consume buffer"),O="")}function j(){O+=B}for(;I<n.length;){if(B=n[I++],B==="\\"&&_!==2){E=_,_=4;continue}switch(_){case 0:B==="/"?(O&&U(),A()):B===":"?(U(),_=1):j();break;case 4:j(),_=E;break;case 1:B==="("?_=2:VALID_PARAM_RE.test(B)?j():(U(),_=0,B!=="*"&&B!=="?"&&B!=="+"&&I--);break;case 2:B===")"?N[N.length-1]=="\\"?N=N.slice(0,-1)+B:_=3:N+=B;break;case 3:U(),_=0,B!=="*"&&B!=="?"&&B!=="+"&&I--,N="";break;default:r("Unknown state");break}}return _===2&&r(`Unfinished custom RegExp for param "${O}"`),U(),A(),S}function createRouteRecordMatcher(n,r,_){const E=tokensToParser(tokenizePath(n.path),_),S=assign$3(E,{record:n,parent:r,children:[],alias:[]});return r&&!S.record.aliasOf==!r.record.aliasOf&&r.children.push(S),S}function createRouterMatcher(n,r){const _=[],E=new Map;r=mergeOptions$a({strict:!1,end:!0,sensitive:!1},r);function S(N){return E.get(N)}function C(N,U,j){const z=!j,Z=normalizeRouteRecord(N);Z.aliasOf=j&&j.record;const X=mergeOptions$a(r,N),Q=[Z];if("alias"in N){const ue=typeof N.alias=="string"?[N.alias]:N.alias;for(const we of ue)Q.push(assign$3({},Z,{components:j?j.record.components:Z.components,path:we,aliasOf:j?j.record:Z}))}let se,oe;for(const ue of Q){const{path:we}=ue;if(U&&we[0]!=="/"){const Te=U.record.path,xe=Te[Te.length-1]==="/"?"":"/";ue.path=U.record.path+(we&&xe+we)}if(se=createRouteRecordMatcher(ue,U,X),j?j.alias.push(se):(oe=oe||se,oe!==se&&oe.alias.push(se),z&&N.name&&!isAliasRecord(se)&&A(N.name)),Z.children){const Te=Z.children;for(let xe=0;xe<Te.length;xe++)C(Te[xe],se,j&&j.children[xe])}j=j||se,(se.record.components&&Object.keys(se.record.components).length||se.record.name||se.record.redirect)&&B(se)}return oe?()=>{A(oe)}:noop$7}function A(N){if(isRouteName(N)){const U=E.get(N);U&&(E.delete(N),_.splice(_.indexOf(U),1),U.children.forEach(A),U.alias.forEach(A))}else{const U=_.indexOf(N);U>-1&&(_.splice(U,1),N.record.name&&E.delete(N.record.name),N.children.forEach(A),N.alias.forEach(A))}}function I(){return _}function B(N){let U=0;for(;U<_.length&&comparePathParserScore(N,_[U])>=0&&(N.record.path!==_[U].record.path||!isRecordChildOf(N,_[U]));)U++;_.splice(U,0,N),N.record.name&&!isAliasRecord(N)&&E.set(N.record.name,N)}function O(N,U){let j,z={},Z,X;if("name"in N&&N.name){if(j=E.get(N.name),!j)throw createRouterError(1,{location:N});X=j.record.name,z=assign$3(paramsFromLocation(U.params,j.keys.filter(oe=>!oe.optional).concat(j.parent?j.parent.keys.filter(oe=>oe.optional):[]).map(oe=>oe.name)),N.params&&paramsFromLocation(N.params,j.keys.map(oe=>oe.name))),Z=j.stringify(z)}else if(N.path!=null)Z=N.path,j=_.find(oe=>oe.re.test(Z)),j&&(z=j.parse(Z),X=j.record.name);else{if(j=U.name?E.get(U.name):_.find(oe=>oe.re.test(U.path)),!j)throw createRouterError(1,{location:N,currentLocation:U});X=j.record.name,z=assign$3({},U.params,N.params),Z=j.stringify(z)}const Q=[];let se=j;for(;se;)Q.unshift(se.record),se=se.parent;return{name:X,path:Z,params:z,matched:Q,meta:mergeMetaFields(Q)}}return n.forEach(N=>C(N)),{addRoute:C,resolve:O,removeRoute:A,getRoutes:I,getRecordMatcher:S}}function paramsFromLocation(n,r){const _={};for(const E of r)E in n&&(_[E]=n[E]);return _}function normalizeRouteRecord(n){return{path:n.path,redirect:n.redirect,name:n.name,meta:n.meta||{},aliasOf:void 0,beforeEnter:n.beforeEnter,props:normalizeRecordProps(n),children:n.children||[],instances:{},leaveGuards:new Set,updateGuards:new Set,enterCallbacks:{},components:"components"in n?n.components||null:n.component&&{default:n.component}}}function normalizeRecordProps(n){const r={},_=n.props||!1;if("component"in n)r.default=_;else for(const E in n.components)r[E]=typeof _=="object"?_[E]:_;return r}function isAliasRecord(n){for(;n;){if(n.record.aliasOf)return!0;n=n.parent}return!1}function mergeMetaFields(n){return n.reduce((r,_)=>assign$3(r,_.meta),{})}function mergeOptions$a(n,r){const _={};for(const E in n)_[E]=E in r?r[E]:n[E];return _}function isRecordChildOf(n,r){return r.children.some(_=>_===n||isRecordChildOf(n,_))}function parseQuery(n){const r={};if(n===""||n==="?")return r;const E=(n[0]==="?"?n.slice(1):n).split("&");for(let S=0;S<E.length;++S){const C=E[S].replace(PLUS_RE," "),A=C.indexOf("="),I=decode$v(A<0?C:C.slice(0,A)),B=A<0?null:decode$v(C.slice(A+1));if(I in r){let O=r[I];isArray$5(O)||(O=r[I]=[O]),O.push(B)}else r[I]=B}return r}function stringifyQuery(n){let r="";for(let _ in n){const E=n[_];if(_=encodeQueryKey(_),E==null){E!==void 0&&(r+=(r.length?"&":"")+_);continue}(isArray$5(E)?E.map(C=>C&&encodeQueryValue(C)):[E&&encodeQueryValue(E)]).forEach(C=>{C!==void 0&&(r+=(r.length?"&":"")+_,C!=null&&(r+="="+C))})}return r}function normalizeQuery(n){const r={};for(const _ in n){const E=n[_];E!==void 0&&(r[_]=isArray$5(E)?E.map(S=>S==null?null:""+S):E==null?E:""+E)}return r}const matchedRouteKey=Symbol(""),viewDepthKey=Symbol(""),routerKey=Symbol(""),routeLocationKey=Symbol(""),routerViewLocationKey=Symbol("");function useCallbacks(){let n=[];function r(E){return n.push(E),()=>{const S=n.indexOf(E);S>-1&&n.splice(S,1)}}function _(){n=[]}return{add:r,list:()=>n.slice(),reset:_}}function guardToPromiseFn(n,r,_,E,S,C=A=>A()){const A=E&&(E.enterCallbacks[S]=E.enterCallbacks[S]||[]);return()=>new Promise((I,B)=>{const O=j=>{j===!1?B(createRouterError(4,{from:_,to:r})):j instanceof Error?B(j):isRouteLocation(j)?B(createRouterError(2,{from:r,to:j})):(A&&E.enterCallbacks[S]===A&&typeof j=="function"&&A.push(j),I())},N=C(()=>n.call(E&&E.instances[S],r,_,O));let U=Promise.resolve(N);n.length<3&&(U=U.then(O)),U.catch(j=>B(j))})}function extractComponentsGuards(n,r,_,E,S=C=>C()){const C=[];for(const A of n)for(const I in A.components){let B=A.components[I];if(!(r!=="beforeRouteEnter"&&!A.instances[I]))if(isRouteComponent(B)){const N=(B.__vccOpts||B)[r];N&&C.push(guardToPromiseFn(N,_,E,A,I,S))}else{let O=B();C.push(()=>O.then(N=>{if(!N)return Promise.reject(new Error(`Couldn't resolve component "${I}" at "${A.path}"`));const U=isESModule(N)?N.default:N;A.components[I]=U;const z=(U.__vccOpts||U)[r];return z&&guardToPromiseFn(z,_,E,A,I,S)()}))}}return C}function isRouteComponent(n){return typeof n=="object"||"displayName"in n||"props"in n||"__vccOpts"in n}function useLink$1(n){const r=inject$1(routerKey),_=inject$1(routeLocationKey),E=computed(()=>r.resolve(unref(n.to))),S=computed(()=>{const{matched:B}=E.value,{length:O}=B,N=B[O-1],U=_.matched;if(!N||!U.length)return-1;const j=U.findIndex(isSameRouteRecord.bind(null,N));if(j>-1)return j;const z=getOriginalPath(B[O-2]);return O>1&&getOriginalPath(N)===z&&U[U.length-1].path!==z?U.findIndex(isSameRouteRecord.bind(null,B[O-2])):j}),C=computed(()=>S.value>-1&&includesParams(_.params,E.value.params)),A=computed(()=>S.value>-1&&S.value===_.matched.length-1&&isSameRouteLocationParams(_.params,E.value.params));function I(B={}){return guardEvent(B)?r[unref(n.replace)?"replace":"push"](unref(n.to)).catch(noop$7):Promise.resolve()}return{route:E,href:computed(()=>E.value.href),isActive:C,isExactActive:A,navigate:I}}const RouterLinkImpl=defineComponent$1({name:"RouterLink",compatConfig:{MODE:3},props:{to:{type:[String,Object],required:!0},replace:Boolean,activeClass:String,exactActiveClass:String,custom:Boolean,ariaCurrentValue:{type:String,default:"page"}},useLink:useLink$1,setup(n,{slots:r}){const _=reactive(useLink$1(n)),{options:E}=inject$1(routerKey),S=computed(()=>({[getLinkClass(n.activeClass,E.linkActiveClass,"router-link-active")]:_.isActive,[getLinkClass(n.exactActiveClass,E.linkExactActiveClass,"router-link-exact-active")]:_.isExactActive}));return()=>{const C=r.default&&r.default(_);return n.custom?C:h$2("a",{"aria-current":_.isExactActive?n.ariaCurrentValue:null,href:_.href,onClick:_.navigate,class:S.value},C)}}}),RouterLink=RouterLinkImpl;function guardEvent(n){if(!(n.metaKey||n.altKey||n.ctrlKey||n.shiftKey)&&!n.defaultPrevented&&!(n.button!==void 0&&n.button!==0)){if(n.currentTarget&&n.currentTarget.getAttribute){const r=n.currentTarget.getAttribute("target");if(/\b_blank\b/i.test(r))return}return n.preventDefault&&n.preventDefault(),!0}}function includesParams(n,r){for(const _ in r){const E=r[_],S=n[_];if(typeof E=="string"){if(E!==S)return!1}else if(!isArray$5(S)||S.length!==E.length||E.some((C,A)=>C!==S[A]))return!1}return!0}function getOriginalPath(n){return n?n.aliasOf?n.aliasOf.path:n.path:""}const getLinkClass=(n,r,_)=>n??r??_,RouterViewImpl=defineComponent$1({name:"RouterView",inheritAttrs:!1,props:{name:{type:String,default:"default"},route:Object},compatConfig:{MODE:3},setup(n,{attrs:r,slots:_}){const E=inject$1(routerViewLocationKey),S=computed(()=>n.route||E.value),C=inject$1(viewDepthKey,0),A=computed(()=>{let O=unref(C);const{matched:N}=S.value;let U;for(;(U=N[O])&&!U.components;)O++;return O}),I=computed(()=>S.value.matched[A.value]);provide(viewDepthKey,computed(()=>A.value+1)),provide(matchedRouteKey,I),provide(routerViewLocationKey,S);const B=ref$2();return watch(()=>[B.value,I.value,n.name],([O,N,U],[j,z,Z])=>{N&&(N.instances[U]=O,z&&z!==N&&O&&O===j&&(N.leaveGuards.size||(N.leaveGuards=z.leaveGuards),N.updateGuards.size||(N.updateGuards=z.updateGuards))),O&&N&&(!z||!isSameRouteRecord(N,z)||!j)&&(N.enterCallbacks[U]||[]).forEach(X=>X(O))},{flush:"post"}),()=>{const O=S.value,N=n.name,U=I.value,j=U&&U.components[N];if(!j)return normalizeSlot(_.default,{Component:j,route:O});const z=U.props[N],Z=z?z===!0?O.params:typeof z=="function"?z(O):z:null,Q=h$2(j,assign$3({},Z,r,{onVnodeUnmounted:se=>{se.component.isUnmounted&&(U.instances[N]=null)},ref:B}));return normalizeSlot(_.default,{Component:Q,route:O})||Q}}});function normalizeSlot(n,r){if(!n)return null;const _=n(r);return _.length===1?_[0]:_}const RouterView=RouterViewImpl;function createRouter(n){const r=createRouterMatcher(n.routes,n),_=n.parseQuery||parseQuery,E=n.stringifyQuery||stringifyQuery,S=n.history,C=useCallbacks(),A=useCallbacks(),I=useCallbacks(),B=shallowRef(START_LOCATION_NORMALIZED);let O=START_LOCATION_NORMALIZED;isBrowser$1&&n.scrollBehavior&&"scrollRestoration"in history&&(history.scrollRestoration="manual");const N=applyToParams.bind(null,Qe=>""+Qe),U=applyToParams.bind(null,encodeParam),j=applyToParams.bind(null,decode$v);function z(Qe,dt){let vt,At;return isRouteName(Qe)?(vt=r.getRecordMatcher(Qe),At=dt):At=Qe,r.addRoute(At,vt)}function Z(Qe){const dt=r.getRecordMatcher(Qe);dt&&r.removeRoute(dt)}function X(){return r.getRoutes().map(Qe=>Qe.record)}function Q(Qe){return!!r.getRecordMatcher(Qe)}function se(Qe,dt){if(dt=assign$3({},dt||B.value),typeof Qe=="string"){const Ye=parseURL(_,Qe,dt.path),Ct=r.resolve({path:Ye.path},dt),Pt=S.createHref(Ye.fullPath);return assign$3(Ye,Ct,{params:j(Ct.params),hash:decode$v(Ye.hash),redirectedFrom:void 0,href:Pt})}let vt;if(Qe.path!=null)vt=assign$3({},Qe,{path:parseURL(_,Qe.path,dt.path).path});else{const Ye=assign$3({},Qe.params);for(const Ct in Ye)Ye[Ct]==null&&delete Ye[Ct];vt=assign$3({},Qe,{params:U(Ye)}),dt.params=U(dt.params)}const At=r.resolve(vt,dt),bt=Qe.hash||"";At.params=N(j(At.params));const ft=stringifyURL(E,assign$3({},Qe,{hash:encodeHash(bt),path:At.path})),Et=S.createHref(ft);return assign$3({fullPath:ft,hash:bt,query:E===stringifyQuery?normalizeQuery(Qe.query):Qe.query||{}},At,{redirectedFrom:void 0,href:Et})}function oe(Qe){return typeof Qe=="string"?parseURL(_,Qe,B.value.path):assign$3({},Qe)}function ue(Qe,dt){if(O!==Qe)return createRouterError(8,{from:dt,to:Qe})}function we(Qe){return Re(Qe)}function Te(Qe){return we(assign$3(oe(Qe),{replace:!0}))}function xe(Qe){const dt=Qe.matched[Qe.matched.length-1];if(dt&&dt.redirect){const{redirect:vt}=dt;let At=typeof vt=="function"?vt(Qe):vt;return typeof At=="string"&&(At=At.includes("?")||At.includes("#")?At=oe(At):{path:At},At.params={}),assign$3({query:Qe.query,hash:Qe.hash,params:At.path!=null?{}:Qe.params},At)}}function Re(Qe,dt){const vt=O=se(Qe),At=B.value,bt=Qe.state,ft=Qe.force,Et=Qe.replace===!0,Ye=xe(vt);if(Ye)return Re(assign$3(oe(Ye),{state:typeof Ye=="object"?assign$3({},bt,Ye.state):bt,force:ft,replace:Et}),dt||vt);const Ct=vt;Ct.redirectedFrom=dt;let Pt;return!ft&&isSameRouteLocation(E,At,vt)&&(Pt=createRouterError(16,{to:Ct,from:At}),Pe(At,At,!0,!1)),(Pt?Promise.resolve(Pt):ht(Ct,At)).catch(St=>isNavigationFailure(St)?isNavigationFailure(St,2)?St:Ve(St):Ge(St,Ct,At)).then(St=>{if(St){if(isNavigationFailure(St,2))return Re(assign$3({replace:Et},oe(St.to),{state:typeof St.to=="object"?assign$3({},bt,St.to.state):bt,force:ft}),dt||Ct)}else St=Ee(Ct,At,!0,Et,bt);return nt(Ct,At,St),St})}function Ne(Qe,dt){const vt=ue(Qe,dt);return vt?Promise.reject(vt):Promise.resolve()}function Fe(Qe){const dt=Ke.values().next().value;return dt&&typeof dt.runWithContext=="function"?dt.runWithContext(Qe):Qe()}function ht(Qe,dt){let vt;const[At,bt,ft]=extractChangingRecords(Qe,dt);vt=extractComponentsGuards(At.reverse(),"beforeRouteLeave",Qe,dt);for(const Ye of At)Ye.leaveGuards.forEach(Ct=>{vt.push(guardToPromiseFn(Ct,Qe,dt))});const Et=Ne.bind(null,Qe,dt);return vt.push(Et),ct(vt).then(()=>{vt=[];for(const Ye of C.list())vt.push(guardToPromiseFn(Ye,Qe,dt));return vt.push(Et),ct(vt)}).then(()=>{vt=extractComponentsGuards(bt,"beforeRouteUpdate",Qe,dt);for(const Ye of bt)Ye.updateGuards.forEach(Ct=>{vt.push(guardToPromiseFn(Ct,Qe,dt))});return vt.push(Et),ct(vt)}).then(()=>{vt=[];for(const Ye of ft)if(Ye.beforeEnter)if(isArray$5(Ye.beforeEnter))for(const Ct of Ye.beforeEnter)vt.push(guardToPromiseFn(Ct,Qe,dt));else vt.push(guardToPromiseFn(Ye.beforeEnter,Qe,dt));return vt.push(Et),ct(vt)}).then(()=>(Qe.matched.forEach(Ye=>Ye.enterCallbacks={}),vt=extractComponentsGuards(ft,"beforeRouteEnter",Qe,dt,Fe),vt.push(Et),ct(vt))).then(()=>{vt=[];for(const Ye of A.list())vt.push(guardToPromiseFn(Ye,Qe,dt));return vt.push(Et),ct(vt)}).catch(Ye=>isNavigationFailure(Ye,8)?Ye:Promise.reject(Ye))}function nt(Qe,dt,vt){I.list().forEach(At=>Fe(()=>At(Qe,dt,vt)))}function Ee(Qe,dt,vt,At,bt){const ft=ue(Qe,dt);if(ft)return ft;const Et=dt===START_LOCATION_NORMALIZED,Ye=isBrowser$1?history.state:{};vt&&(At||Et?S.replace(Qe.fullPath,assign$3({scroll:Et&&Ye&&Ye.scroll},bt)):S.push(Qe.fullPath,bt)),B.value=Qe,Pe(Qe,dt,vt,Et),Ve()}let Ce;function _e(){Ce||(Ce=S.listen((Qe,dt,vt)=>{if(!mt.listening)return;const At=se(Qe),bt=xe(At);if(bt){Re(assign$3(bt,{replace:!0}),At).catch(noop$7);return}O=At;const ft=B.value;isBrowser$1&&saveScrollPosition(getScrollKey(ft.fullPath,vt.delta),computeScrollPosition()),ht(At,ft).catch(Et=>isNavigationFailure(Et,12)?Et:isNavigationFailure(Et,2)?(Re(Et.to,At).then(Ye=>{isNavigationFailure(Ye,20)&&!vt.delta&&vt.type===NavigationType.pop&&S.go(-1,!1)}).catch(noop$7),Promise.reject()):(vt.delta&&S.go(-vt.delta,!1),Ge(Et,At,ft))).then(Et=>{Et=Et||Ee(At,ft,!1),Et&&(vt.delta&&!isNavigationFailure(Et,8)?S.go(-vt.delta,!1):vt.type===NavigationType.pop&&isNavigationFailure(Et,20)&&S.go(-1,!1)),nt(At,ft,Et)}).catch(noop$7)}))}let Ie=useCallbacks(),He=useCallbacks(),Be;function Ge(Qe,dt,vt){Ve(Qe);const At=He.list();return At.length?At.forEach(bt=>bt(Qe,dt,vt)):console.error(Qe),Promise.reject(Qe)}function je(){return Be&&B.value!==START_LOCATION_NORMALIZED?Promise.resolve():new Promise((Qe,dt)=>{Ie.add([Qe,dt])})}function Ve(Qe){return Be||(Be=!Qe,_e(),Ie.list().forEach(([dt,vt])=>Qe?vt(Qe):dt()),Ie.reset()),Qe}function Pe(Qe,dt,vt,At){const{scrollBehavior:bt}=n;if(!isBrowser$1||!bt)return Promise.resolve();const ft=!vt&&getSavedScrollPosition(getScrollKey(Qe.fullPath,0))||(At||!vt)&&history.state&&history.state.scroll||null;return nextTick$3().then(()=>bt(Qe,dt,ft)).then(Et=>Et&&scrollToPosition(Et)).catch(Et=>Ge(Et,Qe,dt))}const Me=Qe=>S.go(Qe);let tt;const Ke=new Set,mt={currentRoute:B,listening:!0,addRoute:z,removeRoute:Z,hasRoute:Q,getRoutes:X,resolve:se,options:n,push:we,replace:Te,go:Me,back:()=>Me(-1),forward:()=>Me(1),beforeEach:C.add,beforeResolve:A.add,afterEach:I.add,onError:He.add,isReady:je,install(Qe){const dt=this;Qe.component("RouterLink",RouterLink),Qe.component("RouterView",RouterView),Qe.config.globalProperties.$router=dt,Object.defineProperty(Qe.config.globalProperties,"$route",{enumerable:!0,get:()=>unref(B)}),isBrowser$1&&!tt&&B.value===START_LOCATION_NORMALIZED&&(tt=!0,we(S.location).catch(bt=>{}));const vt={};for(const bt in START_LOCATION_NORMALIZED)Object.defineProperty(vt,bt,{get:()=>B.value[bt],enumerable:!0});Qe.provide(routerKey,dt),Qe.provide(routeLocationKey,shallowReactive(vt)),Qe.provide(routerViewLocationKey,B);const At=Qe.unmount;Ke.add(Qe),Qe.unmount=function(){Ke.delete(Qe),Ke.size<1&&(O=START_LOCATION_NORMALIZED,Ce&&Ce(),Ce=null,B.value=START_LOCATION_NORMALIZED,tt=!1,Be=!1),At()}}};function ct(Qe){return Qe.reduce((dt,vt)=>dt.then(()=>Fe(vt)),Promise.resolve())}return mt}function extractChangingRecords(n,r){const _=[],E=[],S=[],C=Math.max(r.matched.length,n.matched.length);for(let A=0;A<C;A++){const I=r.matched[A];I&&(n.matched.find(O=>isSameRouteRecord(O,I))?E.push(I):_.push(I));const B=n.matched[A];B&&(r.matched.find(O=>isSameRouteRecord(O,B))||S.push(B))}return[_,E,S]}const _imports_0="data:image/svg+xml,%3csvg%20id='Layer_1'%20data-name='Layer%201'%20xmlns='http://www.w3.org/2000/svg'%20height='220'%20width='400'%20viewBox='0%200%20200%20110'%3e%3cdefs%3e%3cstyle%3e.cls-1{fill:%231697f6;}.cls-2{fill:%237bc6ff;}.cls-3{fill:%231867c0;}.cls-4{fill:%23aeddff;}.l{stroke:rgb(255,255,255);stroke-width:0.5}%3c/style%3e%3c/defs%3e%3cline%20class='l'%20x1='70.1742129851985'%20y1='1.87'%20x2='34.3464829934943'%20y2='10.01'%20/%3e%3cline%20class='l'%20x1='67.306684713793'%20y1='16.47'%20x2='34.3464829934943'%20y2='10.01'%20/%3e%3cline%20class='l'%20x1='34.3464829934943'%20y1='10.01'%20x2='22.5783740121382'%20y2='31.93'%20/%3e%3cline%20class='l'%20x1='22.5783740121382'%20y1='31.93'%20x2='13.8115094092477'%20y2='56.91'%20/%3e%3cline%20class='l'%20x1='13.8115094092477'%20y1='56.91'%20x2='46.9376282583068'%20y2='69.76'%20/%3e%3cline%20class='l'%20x1='46.9376282583068'%20y1='69.76'%20x2='86.0040169410121'%20y2='61.32'%20/%3e%3cline%20class='l'%20x1='86.0040169410121'%20y1='61.32'%20x2='91.0120944854386'%20y2='54.13'%20/%3e%3cline%20class='l'%20x1='86.0040169410121'%20y1='61.32'%20x2='100.419159062132'%20y2='66.30'%20/%3e%3cline%20class='l'%20x1='91.0120944854386'%20y1='54.13'%20x2='112.68938567'%20y2='63.71'%20/%3e%3cline%20class='l'%20x1='100.419159062132'%20y1='66.30'%20x2='112.68938567'%20y2='63.71'%20/%3e%3cline%20class='l'%20x1='112.68938567'%20y1='63.71'%20x2='97.9593284722526'%20y2='84.10'%20/%3e%3cline%20class='l'%20x1='97.9593284722526'%20y1='84.10'%20x2='88.4938654324761'%20y2='82.18'%20/%3e%3cline%20class='l'%20x1='88.4938654324761'%20y1='82.18'%20x2='69.5525695323757'%20y2='90.44'%20/%3e%3cline%20class='l'%20x1='69.5525695323757'%20y1='90.44'%20x2='64.1411605466533'%20y2='94.60'%20/%3e%3cline%20class='l'%20x1='112.68938567'%20y1='63.71'%20x2='136.188490590752'%20y2='68.42'%20/%3e%3cline%20class='l'%20x1='136.188490590752'%20y1='68.42'%20x2='157.031284111252'%20y2='83.37'%20/%3e%3cline%20class='l'%20x1='136.188490590752'%20y1='68.42'%20x2='142.952888267913'%20y2='53.85'%20/%3e%3cline%20class='l'%20x1='112.68938567'%20y1='63.71'%20x2='142.952888267913'%20y2='53.85'%20/%3e%3cline%20class='l'%20x1='142.952888267913'%20y1='53.85'%20x2='137.021896694756'%20y2='38.01'%20/%3e%3cline%20class='l'%20x1='91.0120944854386'%20y1='54.13'%20x2='137.021896694756'%20y2='38.01'%20/%3e%3cline%20class='l'%20x1='137.021896694756'%20y1='38.01'%20x2='142.973627909008'%20y2='29.65'%20/%3e%3cline%20class='l'%20x1='137.021896694756'%20y1='38.01'%20x2='162.02953761516'%20y2='50.80'%20/%3e%3cline%20class='l'%20x1='142.952888267913'%20y1='53.85'%20x2='162.02953761516'%20y2='50.80'%20/%3e%3cline%20class='l'%20x1='162.02953761516'%20y1='50.80'%20x2='185.910142776055'%20y2='57.71'%20/%3e%3ccircle%20class='cls-1'%20cx='70.1742129851985'%20cy='1.87'%20r='2'/%3e%3ccircle%20class='cls-2'%20cx='67.306684713793'%20cy='16.47'%20r='5'/%3e%3ccircle%20class='cls-3'%20cx='34.3464829934943'%20cy='10.01'%20r='3'/%3e%3ccircle%20class='cls-4'%20cx='22.5783740121382'%20cy='31.93'%20r='3'/%3e%3ccircle%20class='cls-1'%20cx='13.8115094092477'%20cy='56.91'%20r='2'/%3e%3ccircle%20class='cls-2'%20cx='46.9376282583068'%20cy='69.76'%20r='6'/%3e%3ccircle%20class='cls-3'%20cx='86.0040169410121'%20cy='61.32'%20r='4'/%3e%3ccircle%20class='cls-4'%20cx='91.0120944854386'%20cy='54.13'%20r='2'/%3e%3ccircle%20class='cls-1'%20cx='112.68938567'%20cy='63.71'%20r='5'/%3e%3ccircle%20class='cls-2'%20cx='100.419159062132'%20cy='66.30'%20r='2'/%3e%3ccircle%20class='cls-3'%20cx='88.4938654324761'%20cy='82.18'%20r='4'/%3e%3ccircle%20class='cls-4'%20cx='97.9593284722526'%20cy='84.10'%20r='3'/%3e%3ccircle%20class='cls-1'%20cx='69.5525695323757'%20cy='90.44'%20r='5'/%3e%3ccircle%20class='cls-2'%20cx='64.1411605466533'%20cy='94.60'%20r='2'/%3e%3ccircle%20class='cls-3'%20cx='157.031284111252'%20cy='83.37'%20r='3'/%3e%3ccircle%20class='cls-4'%20cx='136.188490590752'%20cy='68.42'%20r='5'/%3e%3ccircle%20class='cls-1'%20cx='142.952888267913'%20cy='53.85'%20r='2'/%3e%3ccircle%20class='cls-2'%20cx='162.02953761516'%20cy='50.80'%20r='4'/%3e%3ccircle%20class='cls-3'%20cx='185.910142776055'%20cy='57.71'%20r='4'/%3e%3ccircle%20class='cls-4'%20cx='137.021896694756'%20cy='38.01'%20r='5'/%3e%3ccircle%20class='cls-1'%20cx='142.973627909008'%20cy='29.65'%20r='3'/%3e%3c/svg%3e",_imports_1="/egu24/assets/logo cours-DlfUC8gZ.png";let getRandomValues;const rnds8=new Uint8Array(16);function rng(){if(!getRandomValues&&(getRandomValues=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!getRandomValues))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return getRandomValues(rnds8)}const byteToHex=[];for(let n=0;n<256;++n)byteToHex.push((n+256).toString(16).slice(1));function unsafeStringify(n,r=0){return byteToHex[n[r+0]]+byteToHex[n[r+1]]+byteToHex[n[r+2]]+byteToHex[n[r+3]]+"-"+byteToHex[n[r+4]]+byteToHex[n[r+5]]+"-"+byteToHex[n[r+6]]+byteToHex[n[r+7]]+"-"+byteToHex[n[r+8]]+byteToHex[n[r+9]]+"-"+byteToHex[n[r+10]]+byteToHex[n[r+11]]+byteToHex[n[r+12]]+byteToHex[n[r+13]]+byteToHex[n[r+14]]+byteToHex[n[r+15]]}const randomUUID=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),native={randomUUID};function v4(n,r,_){if(native.randomUUID&&!r&&!n)return native.randomUUID();n=n||{};const E=n.random||(n.rng||rng)();if(E[6]=E[6]&15|64,E[8]=E[8]&63|128,r){_=_||0;for(let S=0;S<16;++S)r[_+S]=E[S];return r}return unsafeStringify(E)}const scriptRel="modulepreload",assetsURL=function(n){return"/egu24/"+n},seen={},__vitePreload=function(r,_,E){let S=Promise.resolve();if(_&&_.length>0){const C=document.getElementsByTagName("link");S=Promise.all(_.map(A=>{if(A=assetsURL(A),A in seen)return;seen[A]=!0;const I=A.endsWith(".css"),B=I?'[rel="stylesheet"]':"";if(!!E)for(let U=C.length-1;U>=0;U--){const j=C[U];if(j.href===A&&(!I||j.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${A}"]${B}`))return;const N=document.createElement("link");if(N.rel=I?"stylesheet":scriptRel,I||(N.as="script",N.crossOrigin=""),N.href=A,document.head.appendChild(N),I)return new Promise((U,j)=>{N.addEventListener("load",U),N.addEventListener("error",()=>j(new Error(`Unable to preload CSS for ${A}`)))})}))}return S.then(()=>r()).catch(C=>{const A=new Event("vite:preloadError",{cancelable:!0});if(A.payload=C,window.dispatchEvent(A),!A.defaultPrevented)throw C})};var lookup$1=[],revLookup=[],Arr=typeof Uint8Array<"u"?Uint8Array:Array,inited=!1;function init$3(){inited=!0;for(var n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",r=0,_=n.length;r<_;++r)lookup$1[r]=n[r],revLookup[n.charCodeAt(r)]=r;revLookup[45]=62,revLookup[95]=63}function toByteArray(n){inited||init$3();var r,_,E,S,C,A,I=n.length;if(I%4>0)throw new Error("Invalid string. Length must be a multiple of 4");C=n[I-2]==="="?2:n[I-1]==="="?1:0,A=new Arr(I*3/4-C),E=C>0?I-4:I;var B=0;for(r=0,_=0;r<E;r+=4,_+=3)S=revLookup[n.charCodeAt(r)]<<18|revLookup[n.charCodeAt(r+1)]<<12|revLookup[n.charCodeAt(r+2)]<<6|revLookup[n.charCodeAt(r+3)],A[B++]=S>>16&255,A[B++]=S>>8&255,A[B++]=S&255;return C===2?(S=revLookup[n.charCodeAt(r)]<<2|revLookup[n.charCodeAt(r+1)]>>4,A[B++]=S&255):C===1&&(S=revLookup[n.charCodeAt(r)]<<10|revLookup[n.charCodeAt(r+1)]<<4|revLookup[n.charCodeAt(r+2)]>>2,A[B++]=S>>8&255,A[B++]=S&255),A}function tripletToBase64(n){return lookup$1[n>>18&63]+lookup$1[n>>12&63]+lookup$1[n>>6&63]+lookup$1[n&63]}function encodeChunk(n,r,_){for(var E,S=[],C=r;C<_;C+=3)E=(n[C]<<16)+(n[C+1]<<8)+n[C+2],S.push(tripletToBase64(E));return S.join("")}function fromByteArray(n){inited||init$3();for(var r,_=n.length,E=_%3,S="",C=[],A=16383,I=0,B=_-E;I<B;I+=A)C.push(encodeChunk(n,I,I+A>B?B:I+A));return E===1?(r=n[_-1],S+=lookup$1[r>>2],S+=lookup$1[r<<4&63],S+="=="):E===2&&(r=(n[_-2]<<8)+n[_-1],S+=lookup$1[r>>10],S+=lookup$1[r>>4&63],S+=lookup$1[r<<2&63],S+="="),C.push(S),C.join("")}function read$7(n,r,_,E,S){var C,A,I=S*8-E-1,B=(1<<I)-1,O=B>>1,N=-7,U=_?S-1:0,j=_?-1:1,z=n[r+U];for(U+=j,C=z&(1<<-N)-1,z>>=-N,N+=I;N>0;C=C*256+n[r+U],U+=j,N-=8);for(A=C&(1<<-N)-1,C>>=-N,N+=E;N>0;A=A*256+n[r+U],U+=j,N-=8);if(C===0)C=1-O;else{if(C===B)return A?NaN:(z?-1:1)*(1/0);A=A+Math.pow(2,E),C=C-O}return(z?-1:1)*A*Math.pow(2,C-E)}function write$2(n,r,_,E,S,C){var A,I,B,O=C*8-S-1,N=(1<<O)-1,U=N>>1,j=S===23?Math.pow(2,-24)-Math.pow(2,-77):0,z=E?0:C-1,Z=E?1:-1,X=r<0||r===0&&1/r<0?1:0;for(r=Math.abs(r),isNaN(r)||r===1/0?(I=isNaN(r)?1:0,A=N):(A=Math.floor(Math.log(r)/Math.LN2),r*(B=Math.pow(2,-A))<1&&(A--,B*=2),A+U>=1?r+=j/B:r+=j*Math.pow(2,1-U),r*B>=2&&(A++,B/=2),A+U>=N?(I=0,A=N):A+U>=1?(I=(r*B-1)*Math.pow(2,S),A=A+U):(I=r*Math.pow(2,U-1)*Math.pow(2,S),A=0));S>=8;n[_+z]=I&255,z+=Z,I/=256,S-=8);for(A=A<<S|I,O+=S;O>0;n[_+z]=A&255,z+=Z,A/=256,O-=8);n[_+z-Z]|=X*128}var toString$b={}.toString,isArray$4=Array.isArray||function(n){return toString$b.call(n)=="[object Array]"};/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
 * @license  MIT
 */var INSPECT_MAX_BYTES=50;Buffer$4.TYPED_ARRAY_SUPPORT=global$1.TYPED_ARRAY_SUPPORT!==void 0?global$1.TYPED_ARRAY_SUPPORT:!0;kMaxLength();function kMaxLength(){return Buffer$4.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function createBuffer(n,r){if(kMaxLength()<r)throw new RangeError("Invalid typed array length");return Buffer$4.TYPED_ARRAY_SUPPORT?(n=new Uint8Array(r),n.__proto__=Buffer$4.prototype):(n===null&&(n=new Buffer$4(r)),n.length=r),n}function Buffer$4(n,r,_){if(!Buffer$4.TYPED_ARRAY_SUPPORT&&!(this instanceof Buffer$4))return new Buffer$4(n,r,_);if(typeof n=="number"){if(typeof r=="string")throw new Error("If encoding is specified then the first argument must be a string");return allocUnsafe$3(this,n)}return from$6(this,n,r,_)}Buffer$4.poolSize=8192;Buffer$4._augment=function(n){return n.__proto__=Buffer$4.prototype,n};function from$6(n,r,_,E){if(typeof r=="number")throw new TypeError('"value" argument must not be a number');return typeof ArrayBuffer<"u"&&r instanceof ArrayBuffer?fromArrayBuffer(n,r,_,E):typeof r=="string"?fromString$8(n,r,_):fromObject(n,r)}Buffer$4.from=function(n,r,_){return from$6(null,n,r,_)};Buffer$4.TYPED_ARRAY_SUPPORT&&(Buffer$4.prototype.__proto__=Uint8Array.prototype,Buffer$4.__proto__=Uint8Array,typeof Symbol<"u"&&Symbol.species&&Buffer$4[Symbol.species]);function assertSize(n){if(typeof n!="number")throw new TypeError('"size" argument must be a number');if(n<0)throw new RangeError('"size" argument must not be negative')}function alloc$4(n,r,_,E){return assertSize(r),r<=0?createBuffer(n,r):_!==void 0?typeof E=="string"?createBuffer(n,r).fill(_,E):createBuffer(n,r).fill(_):createBuffer(n,r)}Buffer$4.alloc=function(n,r,_){return alloc$4(null,n,r,_)};function allocUnsafe$3(n,r){if(assertSize(r),n=createBuffer(n,r<0?0:checked(r)|0),!Buffer$4.TYPED_ARRAY_SUPPORT)for(var _=0;_<r;++_)n[_]=0;return n}Buffer$4.allocUnsafe=function(n){return allocUnsafe$3(null,n)};Buffer$4.allocUnsafeSlow=function(n){return allocUnsafe$3(null,n)};function fromString$8(n,r,_){if((typeof _!="string"||_==="")&&(_="utf8"),!Buffer$4.isEncoding(_))throw new TypeError('"encoding" must be a valid string encoding');var E=byteLength$1(r,_)|0;n=createBuffer(n,E);var S=n.write(r,_);return S!==E&&(n=n.slice(0,S)),n}function fromArrayLike(n,r){var _=r.length<0?0:checked(r.length)|0;n=createBuffer(n,_);for(var E=0;E<_;E+=1)n[E]=r[E]&255;return n}function fromArrayBuffer(n,r,_,E){if(r.byteLength,_<0||r.byteLength<_)throw new RangeError("'offset' is out of bounds");if(r.byteLength<_+(E||0))throw new RangeError("'length' is out of bounds");return _===void 0&&E===void 0?r=new Uint8Array(r):E===void 0?r=new Uint8Array(r,_):r=new Uint8Array(r,_,E),Buffer$4.TYPED_ARRAY_SUPPORT?(n=r,n.__proto__=Buffer$4.prototype):n=fromArrayLike(n,r),n}function fromObject(n,r){if(internalIsBuffer(r)){var _=checked(r.length)|0;return n=createBuffer(n,_),n.length===0||r.copy(n,0,0,_),n}if(r){if(typeof ArrayBuffer<"u"&&r.buffer instanceof ArrayBuffer||"length"in r)return typeof r.length!="number"||isnan(r.length)?createBuffer(n,0):fromArrayLike(n,r);if(r.type==="Buffer"&&isArray$4(r.data))return fromArrayLike(n,r.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}function checked(n){if(n>=kMaxLength())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+kMaxLength().toString(16)+" bytes");return n|0}Buffer$4.isBuffer=isBuffer$5;function internalIsBuffer(n){return!!(n!=null&&n._isBuffer)}Buffer$4.compare=function(r,_){if(!internalIsBuffer(r)||!internalIsBuffer(_))throw new TypeError("Arguments must be Buffers");if(r===_)return 0;for(var E=r.length,S=_.length,C=0,A=Math.min(E,S);C<A;++C)if(r[C]!==_[C]){E=r[C],S=_[C];break}return E<S?-1:S<E?1:0};Buffer$4.isEncoding=function(r){switch(String(r).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}};Buffer$4.concat=function(r,_){if(!isArray$4(r))throw new TypeError('"list" argument must be an Array of Buffers');if(r.length===0)return Buffer$4.alloc(0);var E;if(_===void 0)for(_=0,E=0;E<r.length;++E)_+=r[E].length;var S=Buffer$4.allocUnsafe(_),C=0;for(E=0;E<r.length;++E){var A=r[E];if(!internalIsBuffer(A))throw new TypeError('"list" argument must be an Array of Buffers');A.copy(S,C),C+=A.length}return S};function byteLength$1(n,r){if(internalIsBuffer(n))return n.length;if(typeof ArrayBuffer<"u"&&typeof ArrayBuffer.isView=="function"&&(ArrayBuffer.isView(n)||n instanceof ArrayBuffer))return n.byteLength;typeof n!="string"&&(n=""+n);var _=n.length;if(_===0)return 0;for(var E=!1;;)switch(r){case"ascii":case"latin1":case"binary":return _;case"utf8":case"utf-8":case void 0:return utf8ToBytes$4(n).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return _*2;case"hex":return _>>>1;case"base64":return base64ToBytes(n).length;default:if(E)return utf8ToBytes$4(n).length;r=(""+r).toLowerCase(),E=!0}}Buffer$4.byteLength=byteLength$1;function slowToString(n,r,_){var E=!1;if((r===void 0||r<0)&&(r=0),r>this.length||((_===void 0||_>this.length)&&(_=this.length),_<=0)||(_>>>=0,r>>>=0,_<=r))return"";for(n||(n="utf8");;)switch(n){case"hex":return hexSlice(this,r,_);case"utf8":case"utf-8":return utf8Slice$1(this,r,_);case"ascii":return asciiSlice(this,r,_);case"latin1":case"binary":return latin1Slice(this,r,_);case"base64":return base64Slice(this,r,_);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return utf16leSlice(this,r,_);default:if(E)throw new TypeError("Unknown encoding: "+n);n=(n+"").toLowerCase(),E=!0}}Buffer$4.prototype._isBuffer=!0;function swap(n,r,_){var E=n[r];n[r]=n[_],n[_]=E}Buffer$4.prototype.swap16=function(){var r=this.length;if(r%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var _=0;_<r;_+=2)swap(this,_,_+1);return this};Buffer$4.prototype.swap32=function(){var r=this.length;if(r%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var _=0;_<r;_+=4)swap(this,_,_+3),swap(this,_+1,_+2);return this};Buffer$4.prototype.swap64=function(){var r=this.length;if(r%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var _=0;_<r;_+=8)swap(this,_,_+7),swap(this,_+1,_+6),swap(this,_+2,_+5),swap(this,_+3,_+4);return this};Buffer$4.prototype.toString=function(){var r=this.length|0;return r===0?"":arguments.length===0?utf8Slice$1(this,0,r):slowToString.apply(this,arguments)};Buffer$4.prototype.equals=function(r){if(!internalIsBuffer(r))throw new TypeError("Argument must be a Buffer");return this===r?!0:Buffer$4.compare(this,r)===0};Buffer$4.prototype.inspect=function(){var r="",_=INSPECT_MAX_BYTES;return this.length>0&&(r=this.toString("hex",0,_).match(/.{2}/g).join(" "),this.length>_&&(r+=" ... ")),"<Buffer "+r+">"};Buffer$4.prototype.compare=function(r,_,E,S,C){if(!internalIsBuffer(r))throw new TypeError("Argument must be a Buffer");if(_===void 0&&(_=0),E===void 0&&(E=r?r.length:0),S===void 0&&(S=0),C===void 0&&(C=this.length),_<0||E>r.length||S<0||C>this.length)throw new RangeError("out of range index");if(S>=C&&_>=E)return 0;if(S>=C)return-1;if(_>=E)return 1;if(_>>>=0,E>>>=0,S>>>=0,C>>>=0,this===r)return 0;for(var A=C-S,I=E-_,B=Math.min(A,I),O=this.slice(S,C),N=r.slice(_,E),U=0;U<B;++U)if(O[U]!==N[U]){A=O[U],I=N[U];break}return A<I?-1:I<A?1:0};function bidirectionalIndexOf(n,r,_,E,S){if(n.length===0)return-1;if(typeof _=="string"?(E=_,_=0):_>2147483647?_=2147483647:_<-2147483648&&(_=-2147483648),_=+_,isNaN(_)&&(_=S?0:n.length-1),_<0&&(_=n.length+_),_>=n.length){if(S)return-1;_=n.length-1}else if(_<0)if(S)_=0;else return-1;if(typeof r=="string"&&(r=Buffer$4.from(r,E)),internalIsBuffer(r))return r.length===0?-1:arrayIndexOf(n,r,_,E,S);if(typeof r=="number")return r=r&255,Buffer$4.TYPED_ARRAY_SUPPORT&&typeof Uint8Array.prototype.indexOf=="function"?S?Uint8Array.prototype.indexOf.call(n,r,_):Uint8Array.prototype.lastIndexOf.call(n,r,_):arrayIndexOf(n,[r],_,E,S);throw new TypeError("val must be string, number or Buffer")}function arrayIndexOf(n,r,_,E,S){var C=1,A=n.length,I=r.length;if(E!==void 0&&(E=String(E).toLowerCase(),E==="ucs2"||E==="ucs-2"||E==="utf16le"||E==="utf-16le")){if(n.length<2||r.length<2)return-1;C=2,A/=2,I/=2,_/=2}function B(z,Z){return C===1?z[Z]:z.readUInt16BE(Z*C)}var O;if(S){var N=-1;for(O=_;O<A;O++)if(B(n,O)===B(r,N===-1?0:O-N)){if(N===-1&&(N=O),O-N+1===I)return N*C}else N!==-1&&(O-=O-N),N=-1}else for(_+I>A&&(_=A-I),O=_;O>=0;O--){for(var U=!0,j=0;j<I;j++)if(B(n,O+j)!==B(r,j)){U=!1;break}if(U)return O}return-1}Buffer$4.prototype.includes=function(r,_,E){return this.indexOf(r,_,E)!==-1};Buffer$4.prototype.indexOf=function(r,_,E){return bidirectionalIndexOf(this,r,_,E,!0)};Buffer$4.prototype.lastIndexOf=function(r,_,E){return bidirectionalIndexOf(this,r,_,E,!1)};function hexWrite(n,r,_,E){_=Number(_)||0;var S=n.length-_;E?(E=Number(E),E>S&&(E=S)):E=S;var C=r.length;if(C%2!==0)throw new TypeError("Invalid hex string");E>C/2&&(E=C/2);for(var A=0;A<E;++A){var I=parseInt(r.substr(A*2,2),16);if(isNaN(I))return A;n[_+A]=I}return A}function utf8Write(n,r,_,E){return blitBuffer(utf8ToBytes$4(r,n.length-_),n,_,E)}function asciiWrite(n,r,_,E){return blitBuffer(asciiToBytes(r),n,_,E)}function latin1Write(n,r,_,E){return asciiWrite(n,r,_,E)}function base64Write(n,r,_,E){return blitBuffer(base64ToBytes(r),n,_,E)}function ucs2Write(n,r,_,E){return blitBuffer(utf16leToBytes(r,n.length-_),n,_,E)}Buffer$4.prototype.write=function(r,_,E,S){if(_===void 0)S="utf8",E=this.length,_=0;else if(E===void 0&&typeof _=="string")S=_,E=this.length,_=0;else if(isFinite(_))_=_|0,isFinite(E)?(E=E|0,S===void 0&&(S="utf8")):(S=E,E=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");var C=this.length-_;if((E===void 0||E>C)&&(E=C),r.length>0&&(E<0||_<0)||_>this.length)throw new RangeError("Attempt to write outside buffer bounds");S||(S="utf8");for(var A=!1;;)switch(S){case"hex":return hexWrite(this,r,_,E);case"utf8":case"utf-8":return utf8Write(this,r,_,E);case"ascii":return asciiWrite(this,r,_,E);case"latin1":case"binary":return latin1Write(this,r,_,E);case"base64":return base64Write(this,r,_,E);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return ucs2Write(this,r,_,E);default:if(A)throw new TypeError("Unknown encoding: "+S);S=(""+S).toLowerCase(),A=!0}};Buffer$4.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function base64Slice(n,r,_){return r===0&&_===n.length?fromByteArray(n):fromByteArray(n.slice(r,_))}function utf8Slice$1(n,r,_){_=Math.min(n.length,_);for(var E=[],S=r;S<_;){var C=n[S],A=null,I=C>239?4:C>223?3:C>191?2:1;if(S+I<=_){var B,O,N,U;switch(I){case 1:C<128&&(A=C);break;case 2:B=n[S+1],(B&192)===128&&(U=(C&31)<<6|B&63,U>127&&(A=U));break;case 3:B=n[S+1],O=n[S+2],(B&192)===128&&(O&192)===128&&(U=(C&15)<<12|(B&63)<<6|O&63,U>2047&&(U<55296||U>57343)&&(A=U));break;case 4:B=n[S+1],O=n[S+2],N=n[S+3],(B&192)===128&&(O&192)===128&&(N&192)===128&&(U=(C&15)<<18|(B&63)<<12|(O&63)<<6|N&63,U>65535&&U<1114112&&(A=U))}}A===null?(A=65533,I=1):A>65535&&(A-=65536,E.push(A>>>10&1023|55296),A=56320|A&1023),E.push(A),S+=I}return decodeCodePointsArray$1(E)}var MAX_ARGUMENTS_LENGTH$1=4096;function decodeCodePointsArray$1(n){var r=n.length;if(r<=MAX_ARGUMENTS_LENGTH$1)return String.fromCharCode.apply(String,n);for(var _="",E=0;E<r;)_+=String.fromCharCode.apply(String,n.slice(E,E+=MAX_ARGUMENTS_LENGTH$1));return _}function asciiSlice(n,r,_){var E="";_=Math.min(n.length,_);for(var S=r;S<_;++S)E+=String.fromCharCode(n[S]&127);return E}function latin1Slice(n,r,_){var E="";_=Math.min(n.length,_);for(var S=r;S<_;++S)E+=String.fromCharCode(n[S]);return E}function hexSlice(n,r,_){var E=n.length;(!r||r<0)&&(r=0),(!_||_<0||_>E)&&(_=E);for(var S="",C=r;C<_;++C)S+=toHex(n[C]);return S}function utf16leSlice(n,r,_){for(var E=n.slice(r,_),S="",C=0;C<E.length;C+=2)S+=String.fromCharCode(E[C]+E[C+1]*256);return S}Buffer$4.prototype.slice=function(r,_){var E=this.length;r=~~r,_=_===void 0?E:~~_,r<0?(r+=E,r<0&&(r=0)):r>E&&(r=E),_<0?(_+=E,_<0&&(_=0)):_>E&&(_=E),_<r&&(_=r);var S;if(Buffer$4.TYPED_ARRAY_SUPPORT)S=this.subarray(r,_),S.__proto__=Buffer$4.prototype;else{var C=_-r;S=new Buffer$4(C,void 0);for(var A=0;A<C;++A)S[A]=this[A+r]}return S};function checkOffset(n,r,_){if(n%1!==0||n<0)throw new RangeError("offset is not uint");if(n+r>_)throw new RangeError("Trying to access beyond buffer length")}Buffer$4.prototype.readUIntLE=function(r,_,E){r=r|0,_=_|0,E||checkOffset(r,_,this.length);for(var S=this[r],C=1,A=0;++A<_&&(C*=256);)S+=this[r+A]*C;return S};Buffer$4.prototype.readUIntBE=function(r,_,E){r=r|0,_=_|0,E||checkOffset(r,_,this.length);for(var S=this[r+--_],C=1;_>0&&(C*=256);)S+=this[r+--_]*C;return S};Buffer$4.prototype.readUInt8=function(r,_){return _||checkOffset(r,1,this.length),this[r]};Buffer$4.prototype.readUInt16LE=function(r,_){return _||checkOffset(r,2,this.length),this[r]|this[r+1]<<8};Buffer$4.prototype.readUInt16BE=function(r,_){return _||checkOffset(r,2,this.length),this[r]<<8|this[r+1]};Buffer$4.prototype.readUInt32LE=function(r,_){return _||checkOffset(r,4,this.length),(this[r]|this[r+1]<<8|this[r+2]<<16)+this[r+3]*16777216};Buffer$4.prototype.readUInt32BE=function(r,_){return _||checkOffset(r,4,this.length),this[r]*16777216+(this[r+1]<<16|this[r+2]<<8|this[r+3])};Buffer$4.prototype.readIntLE=function(r,_,E){r=r|0,_=_|0,E||checkOffset(r,_,this.length);for(var S=this[r],C=1,A=0;++A<_&&(C*=256);)S+=this[r+A]*C;return C*=128,S>=C&&(S-=Math.pow(2,8*_)),S};Buffer$4.prototype.readIntBE=function(r,_,E){r=r|0,_=_|0,E||checkOffset(r,_,this.length);for(var S=_,C=1,A=this[r+--S];S>0&&(C*=256);)A+=this[r+--S]*C;return C*=128,A>=C&&(A-=Math.pow(2,8*_)),A};Buffer$4.prototype.readInt8=function(r,_){return _||checkOffset(r,1,this.length),this[r]&128?(255-this[r]+1)*-1:this[r]};Buffer$4.prototype.readInt16LE=function(r,_){_||checkOffset(r,2,this.length);var E=this[r]|this[r+1]<<8;return E&32768?E|4294901760:E};Buffer$4.prototype.readInt16BE=function(r,_){_||checkOffset(r,2,this.length);var E=this[r+1]|this[r]<<8;return E&32768?E|4294901760:E};Buffer$4.prototype.readInt32LE=function(r,_){return _||checkOffset(r,4,this.length),this[r]|this[r+1]<<8|this[r+2]<<16|this[r+3]<<24};Buffer$4.prototype.readInt32BE=function(r,_){return _||checkOffset(r,4,this.length),this[r]<<24|this[r+1]<<16|this[r+2]<<8|this[r+3]};Buffer$4.prototype.readFloatLE=function(r,_){return _||checkOffset(r,4,this.length),read$7(this,r,!0,23,4)};Buffer$4.prototype.readFloatBE=function(r,_){return _||checkOffset(r,4,this.length),read$7(this,r,!1,23,4)};Buffer$4.prototype.readDoubleLE=function(r,_){return _||checkOffset(r,8,this.length),read$7(this,r,!0,52,8)};Buffer$4.prototype.readDoubleBE=function(r,_){return _||checkOffset(r,8,this.length),read$7(this,r,!1,52,8)};function checkInt(n,r,_,E,S,C){if(!internalIsBuffer(n))throw new TypeError('"buffer" argument must be a Buffer instance');if(r>S||r<C)throw new RangeError('"value" argument is out of bounds');if(_+E>n.length)throw new RangeError("Index out of range")}Buffer$4.prototype.writeUIntLE=function(r,_,E,S){if(r=+r,_=_|0,E=E|0,!S){var C=Math.pow(2,8*E)-1;checkInt(this,r,_,E,C,0)}var A=1,I=0;for(this[_]=r&255;++I<E&&(A*=256);)this[_+I]=r/A&255;return _+E};Buffer$4.prototype.writeUIntBE=function(r,_,E,S){if(r=+r,_=_|0,E=E|0,!S){var C=Math.pow(2,8*E)-1;checkInt(this,r,_,E,C,0)}var A=E-1,I=1;for(this[_+A]=r&255;--A>=0&&(I*=256);)this[_+A]=r/I&255;return _+E};Buffer$4.prototype.writeUInt8=function(r,_,E){return r=+r,_=_|0,E||checkInt(this,r,_,1,255,0),Buffer$4.TYPED_ARRAY_SUPPORT||(r=Math.floor(r)),this[_]=r&255,_+1};function objectWriteUInt16(n,r,_,E){r<0&&(r=65535+r+1);for(var S=0,C=Math.min(n.length-_,2);S<C;++S)n[_+S]=(r&255<<8*(E?S:1-S))>>>(E?S:1-S)*8}Buffer$4.prototype.writeUInt16LE=function(r,_,E){return r=+r,_=_|0,E||checkInt(this,r,_,2,65535,0),Buffer$4.TYPED_ARRAY_SUPPORT?(this[_]=r&255,this[_+1]=r>>>8):objectWriteUInt16(this,r,_,!0),_+2};Buffer$4.prototype.writeUInt16BE=function(r,_,E){return r=+r,_=_|0,E||checkInt(this,r,_,2,65535,0),Buffer$4.TYPED_ARRAY_SUPPORT?(this[_]=r>>>8,this[_+1]=r&255):objectWriteUInt16(this,r,_,!1),_+2};function objectWriteUInt32(n,r,_,E){r<0&&(r=4294967295+r+1);for(var S=0,C=Math.min(n.length-_,4);S<C;++S)n[_+S]=r>>>(E?S:3-S)*8&255}Buffer$4.prototype.writeUInt32LE=function(r,_,E){return r=+r,_=_|0,E||checkInt(this,r,_,4,4294967295,0),Buffer$4.TYPED_ARRAY_SUPPORT?(this[_+3]=r>>>24,this[_+2]=r>>>16,this[_+1]=r>>>8,this[_]=r&255):objectWriteUInt32(this,r,_,!0),_+4};Buffer$4.prototype.writeUInt32BE=function(r,_,E){return r=+r,_=_|0,E||checkInt(this,r,_,4,4294967295,0),Buffer$4.TYPED_ARRAY_SUPPORT?(this[_]=r>>>24,this[_+1]=r>>>16,this[_+2]=r>>>8,this[_+3]=r&255):objectWriteUInt32(this,r,_,!1),_+4};Buffer$4.prototype.writeIntLE=function(r,_,E,S){if(r=+r,_=_|0,!S){var C=Math.pow(2,8*E-1);checkInt(this,r,_,E,C-1,-C)}var A=0,I=1,B=0;for(this[_]=r&255;++A<E&&(I*=256);)r<0&&B===0&&this[_+A-1]!==0&&(B=1),this[_+A]=(r/I>>0)-B&255;return _+E};Buffer$4.prototype.writeIntBE=function(r,_,E,S){if(r=+r,_=_|0,!S){var C=Math.pow(2,8*E-1);checkInt(this,r,_,E,C-1,-C)}var A=E-1,I=1,B=0;for(this[_+A]=r&255;--A>=0&&(I*=256);)r<0&&B===0&&this[_+A+1]!==0&&(B=1),this[_+A]=(r/I>>0)-B&255;return _+E};Buffer$4.prototype.writeInt8=function(r,_,E){return r=+r,_=_|0,E||checkInt(this,r,_,1,127,-128),Buffer$4.TYPED_ARRAY_SUPPORT||(r=Math.floor(r)),r<0&&(r=255+r+1),this[_]=r&255,_+1};Buffer$4.prototype.writeInt16LE=function(r,_,E){return r=+r,_=_|0,E||checkInt(this,r,_,2,32767,-32768),Buffer$4.TYPED_ARRAY_SUPPORT?(this[_]=r&255,this[_+1]=r>>>8):objectWriteUInt16(this,r,_,!0),_+2};Buffer$4.prototype.writeInt16BE=function(r,_,E){return r=+r,_=_|0,E||checkInt(this,r,_,2,32767,-32768),Buffer$4.TYPED_ARRAY_SUPPORT?(this[_]=r>>>8,this[_+1]=r&255):objectWriteUInt16(this,r,_,!1),_+2};Buffer$4.prototype.writeInt32LE=function(r,_,E){return r=+r,_=_|0,E||checkInt(this,r,_,4,2147483647,-2147483648),Buffer$4.TYPED_ARRAY_SUPPORT?(this[_]=r&255,this[_+1]=r>>>8,this[_+2]=r>>>16,this[_+3]=r>>>24):objectWriteUInt32(this,r,_,!0),_+4};Buffer$4.prototype.writeInt32BE=function(r,_,E){return r=+r,_=_|0,E||checkInt(this,r,_,4,2147483647,-2147483648),r<0&&(r=4294967295+r+1),Buffer$4.TYPED_ARRAY_SUPPORT?(this[_]=r>>>24,this[_+1]=r>>>16,this[_+2]=r>>>8,this[_+3]=r&255):objectWriteUInt32(this,r,_,!1),_+4};function checkIEEE754(n,r,_,E,S,C){if(_+E>n.length)throw new RangeError("Index out of range");if(_<0)throw new RangeError("Index out of range")}function writeFloat(n,r,_,E,S){return S||checkIEEE754(n,r,_,4),write$2(n,r,_,E,23,4),_+4}Buffer$4.prototype.writeFloatLE=function(r,_,E){return writeFloat(this,r,_,!0,E)};Buffer$4.prototype.writeFloatBE=function(r,_,E){return writeFloat(this,r,_,!1,E)};function writeDouble(n,r,_,E,S){return S||checkIEEE754(n,r,_,8),write$2(n,r,_,E,52,8),_+8}Buffer$4.prototype.writeDoubleLE=function(r,_,E){return writeDouble(this,r,_,!0,E)};Buffer$4.prototype.writeDoubleBE=function(r,_,E){return writeDouble(this,r,_,!1,E)};Buffer$4.prototype.copy=function(r,_,E,S){if(E||(E=0),!S&&S!==0&&(S=this.length),_>=r.length&&(_=r.length),_||(_=0),S>0&&S<E&&(S=E),S===E||r.length===0||this.length===0)return 0;if(_<0)throw new RangeError("targetStart out of bounds");if(E<0||E>=this.length)throw new RangeError("sourceStart out of bounds");if(S<0)throw new RangeError("sourceEnd out of bounds");S>this.length&&(S=this.length),r.length-_<S-E&&(S=r.length-_+E);var C=S-E,A;if(this===r&&E<_&&_<S)for(A=C-1;A>=0;--A)r[A+_]=this[A+E];else if(C<1e3||!Buffer$4.TYPED_ARRAY_SUPPORT)for(A=0;A<C;++A)r[A+_]=this[A+E];else Uint8Array.prototype.set.call(r,this.subarray(E,E+C),_);return C};Buffer$4.prototype.fill=function(r,_,E,S){if(typeof r=="string"){if(typeof _=="string"?(S=_,_=0,E=this.length):typeof E=="string"&&(S=E,E=this.length),r.length===1){var C=r.charCodeAt(0);C<256&&(r=C)}if(S!==void 0&&typeof S!="string")throw new TypeError("encoding must be a string");if(typeof S=="string"&&!Buffer$4.isEncoding(S))throw new TypeError("Unknown encoding: "+S)}else typeof r=="number"&&(r=r&255);if(_<0||this.length<_||this.length<E)throw new RangeError("Out of range index");if(E<=_)return this;_=_>>>0,E=E===void 0?this.length:E>>>0,r||(r=0);var A;if(typeof r=="number")for(A=_;A<E;++A)this[A]=r;else{var I=internalIsBuffer(r)?r:utf8ToBytes$4(new Buffer$4(r,S).toString()),B=I.length;for(A=0;A<E-_;++A)this[A+_]=I[A%B]}return this};var INVALID_BASE64_RE=/[^+\/0-9A-Za-z-_]/g;function base64clean(n){if(n=stringtrim(n).replace(INVALID_BASE64_RE,""),n.length<2)return"";for(;n.length%4!==0;)n=n+"=";return n}function stringtrim(n){return n.trim?n.trim():n.replace(/^\s+|\s+$/g,"")}function toHex(n){return n<16?"0"+n.toString(16):n.toString(16)}function utf8ToBytes$4(n,r){r=r||1/0;for(var _,E=n.length,S=null,C=[],A=0;A<E;++A){if(_=n.charCodeAt(A),_>55295&&_<57344){if(!S){if(_>56319){(r-=3)>-1&&C.push(239,191,189);continue}else if(A+1===E){(r-=3)>-1&&C.push(239,191,189);continue}S=_;continue}if(_<56320){(r-=3)>-1&&C.push(239,191,189),S=_;continue}_=(S-55296<<10|_-56320)+65536}else S&&(r-=3)>-1&&C.push(239,191,189);if(S=null,_<128){if((r-=1)<0)break;C.push(_)}else if(_<2048){if((r-=2)<0)break;C.push(_>>6|192,_&63|128)}else if(_<65536){if((r-=3)<0)break;C.push(_>>12|224,_>>6&63|128,_&63|128)}else if(_<1114112){if((r-=4)<0)break;C.push(_>>18|240,_>>12&63|128,_>>6&63|128,_&63|128)}else throw new Error("Invalid code point")}return C}function asciiToBytes(n){for(var r=[],_=0;_<n.length;++_)r.push(n.charCodeAt(_)&255);return r}function utf16leToBytes(n,r){for(var _,E,S,C=[],A=0;A<n.length&&!((r-=2)<0);++A)_=n.charCodeAt(A),E=_>>8,S=_%256,C.push(S),C.push(E);return C}function base64ToBytes(n){return toByteArray(base64clean(n))}function blitBuffer(n,r,_,E){for(var S=0;S<E&&!(S+_>=r.length||S>=n.length);++S)r[S+_]=n[S];return S}function isnan(n){return n!==n}function isBuffer$5(n){return n!=null&&(!!n._isBuffer||isFastBuffer(n)||isSlowBuffer(n))}function isFastBuffer(n){return!!n.constructor&&typeof n.constructor.isBuffer=="function"&&n.constructor.isBuffer(n)}function isSlowBuffer(n){return typeof n.readFloatLE=="function"&&typeof n.slice=="function"&&isFastBuffer(n.slice(0,0))}function defaultSetTimout(){throw new Error("setTimeout has not been defined")}function defaultClearTimeout(){throw new Error("clearTimeout has not been defined")}var cachedSetTimeout=defaultSetTimout,cachedClearTimeout=defaultClearTimeout;typeof global$1.setTimeout=="function"&&(cachedSetTimeout=setTimeout);typeof global$1.clearTimeout=="function"&&(cachedClearTimeout=clearTimeout);function runTimeout(n){if(cachedSetTimeout===setTimeout)return setTimeout(n,0);if((cachedSetTimeout===defaultSetTimout||!cachedSetTimeout)&&setTimeout)return cachedSetTimeout=setTimeout,setTimeout(n,0);try{return cachedSetTimeout(n,0)}catch{try{return cachedSetTimeout.call(null,n,0)}catch{return cachedSetTimeout.call(this,n,0)}}}function runClearTimeout(n){if(cachedClearTimeout===clearTimeout)return clearTimeout(n);if((cachedClearTimeout===defaultClearTimeout||!cachedClearTimeout)&&clearTimeout)return cachedClearTimeout=clearTimeout,clearTimeout(n);try{return cachedClearTimeout(n)}catch{try{return cachedClearTimeout.call(null,n)}catch{return cachedClearTimeout.call(this,n)}}}var queue=[],draining=!1,currentQueue,queueIndex=-1;function cleanUpNextTick(){!draining||!currentQueue||(draining=!1,currentQueue.length?queue=currentQueue.concat(queue):queueIndex=-1,queue.length&&drainQueue())}function drainQueue(){if(!draining){var n=runTimeout(cleanUpNextTick);draining=!0;for(var r=queue.length;r;){for(currentQueue=queue,queue=[];++queueIndex<r;)currentQueue&&currentQueue[queueIndex].run();queueIndex=-1,r=queue.length}currentQueue=null,draining=!1,runClearTimeout(n)}}function nextTick$2(n){var r=new Array(arguments.length-1);if(arguments.length>1)for(var _=1;_<arguments.length;_++)r[_-1]=arguments[_];queue.push(new Item(n,r)),queue.length===1&&!draining&&runTimeout(drainQueue)}function Item(n,r){this.fun=n,this.array=r}Item.prototype.run=function(){this.fun.apply(null,this.array)};var title$1="browser",platform$3="browser",browser$g=!0,env={},argv=[],version$4="",versions={},release={},config={};function noop$6(){}var on=noop$6,addListener=noop$6,once$1=noop$6,off=noop$6,removeListener=noop$6,removeAllListeners=noop$6,emit=noop$6;function binding(n){throw new Error("process.binding is not supported")}function cwd(){return"/"}function chdir(n){throw new Error("process.chdir is not supported")}function umask(){return 0}var performance$1=global$1.performance||{},performanceNow=performance$1.now||performance$1.mozNow||performance$1.msNow||performance$1.oNow||performance$1.webkitNow||function(){return new Date().getTime()};function hrtime(n){var r=performanceNow.call(performance$1)*.001,_=Math.floor(r),E=Math.floor(r%1*1e9);return n&&(_=_-n[0],E=E-n[1],E<0&&(_--,E+=1e9)),[_,E]}var startTime=new Date;function uptime(){var n=new Date,r=n-startTime;return r/1e3}var browser$1$1={nextTick:nextTick$2,title:title$1,browser:browser$g,env,argv,version:version$4,versions,on,addListener,once:once$1,off,removeListener,removeAllListeners,emit,binding,cwd,chdir,umask,hrtime,platform:platform$3,release,config,uptime};function commonjsRequire(n){throw new Error('Could not dynamically require "'+n+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var jszip_min={exports:{}};(function(n,r){(function(_){n.exports=_()})(function(){return function _(E,S,C){function A(O,N){if(!S[O]){if(!E[O]){var U=typeof commonjsRequire=="function"&&commonjsRequire;if(!N&&U)return U(O,!0);if(I)return I(O,!0);var j=new Error("Cannot find module '"+O+"'");throw j.code="MODULE_NOT_FOUND",j}var z=S[O]={exports:{}};E[O][0].call(z.exports,function(Z){var X=E[O][1][Z];return A(X||Z)},z,z.exports,_,E,S,C)}return S[O].exports}for(var I=typeof commonjsRequire=="function"&&commonjsRequire,B=0;B<C.length;B++)A(C[B]);return A}({1:[function(_,E,S){var C=_("./utils"),A=_("./support"),I="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";S.encode=function(B){for(var O,N,U,j,z,Z,X,Q=[],se=0,oe=B.length,ue=oe,we=C.getTypeOf(B)!=="string";se<B.length;)ue=oe-se,U=we?(O=B[se++],N=se<oe?B[se++]:0,se<oe?B[se++]:0):(O=B.charCodeAt(se++),N=se<oe?B.charCodeAt(se++):0,se<oe?B.charCodeAt(se++):0),j=O>>2,z=(3&O)<<4|N>>4,Z=1<ue?(15&N)<<2|U>>6:64,X=2<ue?63&U:64,Q.push(I.charAt(j)+I.charAt(z)+I.charAt(Z)+I.charAt(X));return Q.join("")},S.decode=function(B){var O,N,U,j,z,Z,X=0,Q=0,se="data:";if(B.substr(0,se.length)===se)throw new Error("Invalid base64 input, it looks like a data url.");var oe,ue=3*(B=B.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(B.charAt(B.length-1)===I.charAt(64)&&ue--,B.charAt(B.length-2)===I.charAt(64)&&ue--,ue%1!=0)throw new Error("Invalid base64 input, bad content length.");for(oe=A.uint8array?new Uint8Array(0|ue):new Array(0|ue);X<B.length;)O=I.indexOf(B.charAt(X++))<<2|(j=I.indexOf(B.charAt(X++)))>>4,N=(15&j)<<4|(z=I.indexOf(B.charAt(X++)))>>2,U=(3&z)<<6|(Z=I.indexOf(B.charAt(X++))),oe[Q++]=O,z!==64&&(oe[Q++]=N),Z!==64&&(oe[Q++]=U);return oe}},{"./support":30,"./utils":32}],2:[function(_,E,S){var C=_("./external"),A=_("./stream/DataWorker"),I=_("./stream/Crc32Probe"),B=_("./stream/DataLengthProbe");function O(N,U,j,z,Z){this.compressedSize=N,this.uncompressedSize=U,this.crc32=j,this.compression=z,this.compressedContent=Z}O.prototype={getContentWorker:function(){var N=new A(C.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new B("data_length")),U=this;return N.on("end",function(){if(this.streamInfo.data_length!==U.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),N},getCompressedWorker:function(){return new A(C.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},O.createWorkerFrom=function(N,U,j){return N.pipe(new I).pipe(new B("uncompressedSize")).pipe(U.compressWorker(j)).pipe(new B("compressedSize")).withStreamInfo("compression",U)},E.exports=O},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(_,E,S){var C=_("./stream/GenericWorker");S.STORE={magic:"\0\0",compressWorker:function(){return new C("STORE compression")},uncompressWorker:function(){return new C("STORE decompression")}},S.DEFLATE=_("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(_,E,S){var C=_("./utils"),A=function(){for(var I,B=[],O=0;O<256;O++){I=O;for(var N=0;N<8;N++)I=1&I?3988292384^I>>>1:I>>>1;B[O]=I}return B}();E.exports=function(I,B){return I!==void 0&&I.length?C.getTypeOf(I)!=="string"?function(O,N,U,j){var z=A,Z=j+U;O^=-1;for(var X=j;X<Z;X++)O=O>>>8^z[255&(O^N[X])];return-1^O}(0|B,I,I.length,0):function(O,N,U,j){var z=A,Z=j+U;O^=-1;for(var X=j;X<Z;X++)O=O>>>8^z[255&(O^N.charCodeAt(X))];return-1^O}(0|B,I,I.length,0):0}},{"./utils":32}],5:[function(_,E,S){S.base64=!1,S.binary=!1,S.dir=!1,S.createFolders=!0,S.date=null,S.compression=null,S.compressionOptions=null,S.comment=null,S.unixPermissions=null,S.dosPermissions=null},{}],6:[function(_,E,S){var C=null;C=typeof Promise<"u"?Promise:_("lie"),E.exports={Promise:C}},{lie:37}],7:[function(_,E,S){var C=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Uint32Array<"u",A=_("pako"),I=_("./utils"),B=_("./stream/GenericWorker"),O=C?"uint8array":"array";function N(U,j){B.call(this,"FlateWorker/"+U),this._pako=null,this._pakoAction=U,this._pakoOptions=j,this.meta={}}S.magic="\b\0",I.inherits(N,B),N.prototype.processChunk=function(U){this.meta=U.meta,this._pako===null&&this._createPako(),this._pako.push(I.transformTo(O,U.data),!1)},N.prototype.flush=function(){B.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)},N.prototype.cleanUp=function(){B.prototype.cleanUp.call(this),this._pako=null},N.prototype._createPako=function(){this._pako=new A[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var U=this;this._pako.onData=function(j){U.push({data:j,meta:U.meta})}},S.compressWorker=function(U){return new N("Deflate",U)},S.uncompressWorker=function(){return new N("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(_,E,S){function C(z,Z){var X,Q="";for(X=0;X<Z;X++)Q+=String.fromCharCode(255&z),z>>>=8;return Q}function A(z,Z,X,Q,se,oe){var ue,we,Te=z.file,xe=z.compression,Re=oe!==O.utf8encode,Ne=I.transformTo("string",oe(Te.name)),Fe=I.transformTo("string",O.utf8encode(Te.name)),ht=Te.comment,nt=I.transformTo("string",oe(ht)),Ee=I.transformTo("string",O.utf8encode(ht)),Ce=Fe.length!==Te.name.length,_e=Ee.length!==ht.length,Ie="",He="",Be="",Ge=Te.dir,je=Te.date,Ve={crc32:0,compressedSize:0,uncompressedSize:0};Z&&!X||(Ve.crc32=z.crc32,Ve.compressedSize=z.compressedSize,Ve.uncompressedSize=z.uncompressedSize);var Pe=0;Z&&(Pe|=8),Re||!Ce&&!_e||(Pe|=2048);var Me=0,tt=0;Ge&&(Me|=16),se==="UNIX"?(tt=798,Me|=function(mt,ct){var Qe=mt;return mt||(Qe=ct?16893:33204),(65535&Qe)<<16}(Te.unixPermissions,Ge)):(tt=20,Me|=function(mt){return 63&(mt||0)}(Te.dosPermissions)),ue=je.getUTCHours(),ue<<=6,ue|=je.getUTCMinutes(),ue<<=5,ue|=je.getUTCSeconds()/2,we=je.getUTCFullYear()-1980,we<<=4,we|=je.getUTCMonth()+1,we<<=5,we|=je.getUTCDate(),Ce&&(He=C(1,1)+C(N(Ne),4)+Fe,Ie+="up"+C(He.length,2)+He),_e&&(Be=C(1,1)+C(N(nt),4)+Ee,Ie+="uc"+C(Be.length,2)+Be);var Ke="";return Ke+=`
\0`,Ke+=C(Pe,2),Ke+=xe.magic,Ke+=C(ue,2),Ke+=C(we,2),Ke+=C(Ve.crc32,4),Ke+=C(Ve.compressedSize,4),Ke+=C(Ve.uncompressedSize,4),Ke+=C(Ne.length,2),Ke+=C(Ie.length,2),{fileRecord:U.LOCAL_FILE_HEADER+Ke+Ne+Ie,dirRecord:U.CENTRAL_FILE_HEADER+C(tt,2)+Ke+C(nt.length,2)+"\0\0\0\0"+C(Me,4)+C(Q,4)+Ne+Ie+nt}}var I=_("../utils"),B=_("../stream/GenericWorker"),O=_("../utf8"),N=_("../crc32"),U=_("../signature");function j(z,Z,X,Q){B.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=Z,this.zipPlatform=X,this.encodeFileName=Q,this.streamFiles=z,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}I.inherits(j,B),j.prototype.push=function(z){var Z=z.meta.percent||0,X=this.entriesCount,Q=this._sources.length;this.accumulate?this.contentBuffer.push(z):(this.bytesWritten+=z.data.length,B.prototype.push.call(this,{data:z.data,meta:{currentFile:this.currentFile,percent:X?(Z+100*(X-Q-1))/X:100}}))},j.prototype.openedSource=function(z){this.currentSourceOffset=this.bytesWritten,this.currentFile=z.file.name;var Z=this.streamFiles&&!z.file.dir;if(Z){var X=A(z,Z,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:X.fileRecord,meta:{percent:0}})}else this.accumulate=!0},j.prototype.closedSource=function(z){this.accumulate=!1;var Z=this.streamFiles&&!z.file.dir,X=A(z,Z,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(X.dirRecord),Z)this.push({data:function(Q){return U.DATA_DESCRIPTOR+C(Q.crc32,4)+C(Q.compressedSize,4)+C(Q.uncompressedSize,4)}(z),meta:{percent:100}});else for(this.push({data:X.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},j.prototype.flush=function(){for(var z=this.bytesWritten,Z=0;Z<this.dirRecords.length;Z++)this.push({data:this.dirRecords[Z],meta:{percent:100}});var X=this.bytesWritten-z,Q=function(se,oe,ue,we,Te){var xe=I.transformTo("string",Te(we));return U.CENTRAL_DIRECTORY_END+"\0\0\0\0"+C(se,2)+C(se,2)+C(oe,4)+C(ue,4)+C(xe.length,2)+xe}(this.dirRecords.length,X,z,this.zipComment,this.encodeFileName);this.push({data:Q,meta:{percent:100}})},j.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},j.prototype.registerPrevious=function(z){this._sources.push(z);var Z=this;return z.on("data",function(X){Z.processChunk(X)}),z.on("end",function(){Z.closedSource(Z.previous.streamInfo),Z._sources.length?Z.prepareNextSource():Z.end()}),z.on("error",function(X){Z.error(X)}),this},j.prototype.resume=function(){return!!B.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},j.prototype.error=function(z){var Z=this._sources;if(!B.prototype.error.call(this,z))return!1;for(var X=0;X<Z.length;X++)try{Z[X].error(z)}catch{}return!0},j.prototype.lock=function(){B.prototype.lock.call(this);for(var z=this._sources,Z=0;Z<z.length;Z++)z[Z].lock()},E.exports=j},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(_,E,S){var C=_("../compressions"),A=_("./ZipFileWorker");S.generateWorker=function(I,B,O){var N=new A(B.streamFiles,O,B.platform,B.encodeFileName),U=0;try{I.forEach(function(j,z){U++;var Z=function(oe,ue){var we=oe||ue,Te=C[we];if(!Te)throw new Error(we+" is not a valid compression method !");return Te}(z.options.compression,B.compression),X=z.options.compressionOptions||B.compressionOptions||{},Q=z.dir,se=z.date;z._compressWorker(Z,X).withStreamInfo("file",{name:j,dir:Q,date:se,comment:z.comment||"",unixPermissions:z.unixPermissions,dosPermissions:z.dosPermissions}).pipe(N)}),N.entriesCount=U}catch(j){N.error(j)}return N}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(_,E,S){function C(){if(!(this instanceof C))return new C;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var A=new C;for(var I in this)typeof this[I]!="function"&&(A[I]=this[I]);return A}}(C.prototype=_("./object")).loadAsync=_("./load"),C.support=_("./support"),C.defaults=_("./defaults"),C.version="3.10.1",C.loadAsync=function(A,I){return new C().loadAsync(A,I)},C.external=_("./external"),E.exports=C},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(_,E,S){var C=_("./utils"),A=_("./external"),I=_("./utf8"),B=_("./zipEntries"),O=_("./stream/Crc32Probe"),N=_("./nodejsUtils");function U(j){return new A.Promise(function(z,Z){var X=j.decompressed.getContentWorker().pipe(new O);X.on("error",function(Q){Z(Q)}).on("end",function(){X.streamInfo.crc32!==j.decompressed.crc32?Z(new Error("Corrupted zip : CRC32 mismatch")):z()}).resume()})}E.exports=function(j,z){var Z=this;return z=C.extend(z||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:I.utf8decode}),N.isNode&&N.isStream(j)?A.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):C.prepareContent("the loaded zip file",j,!0,z.optimizedBinaryString,z.base64).then(function(X){var Q=new B(z);return Q.load(X),Q}).then(function(X){var Q=[A.Promise.resolve(X)],se=X.files;if(z.checkCRC32)for(var oe=0;oe<se.length;oe++)Q.push(U(se[oe]));return A.Promise.all(Q)}).then(function(X){for(var Q=X.shift(),se=Q.files,oe=0;oe<se.length;oe++){var ue=se[oe],we=ue.fileNameStr,Te=C.resolve(ue.fileNameStr);Z.file(Te,ue.decompressed,{binary:!0,optimizedBinaryString:!0,date:ue.date,dir:ue.dir,comment:ue.fileCommentStr.length?ue.fileCommentStr:null,unixPermissions:ue.unixPermissions,dosPermissions:ue.dosPermissions,createFolders:z.createFolders}),ue.dir||(Z.file(Te).unsafeOriginalName=we)}return Q.zipComment.length&&(Z.comment=Q.zipComment),Z})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(_,E,S){var C=_("../utils"),A=_("../stream/GenericWorker");function I(B,O){A.call(this,"Nodejs stream input adapter for "+B),this._upstreamEnded=!1,this._bindStream(O)}C.inherits(I,A),I.prototype._bindStream=function(B){var O=this;(this._stream=B).pause(),B.on("data",function(N){O.push({data:N,meta:{percent:0}})}).on("error",function(N){O.isPaused?this.generatedError=N:O.error(N)}).on("end",function(){O.isPaused?O._upstreamEnded=!0:O.end()})},I.prototype.pause=function(){return!!A.prototype.pause.call(this)&&(this._stream.pause(),!0)},I.prototype.resume=function(){return!!A.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},E.exports=I},{"../stream/GenericWorker":28,"../utils":32}],13:[function(_,E,S){var C=_("readable-stream").Readable;function A(I,B,O){C.call(this,B),this._helper=I;var N=this;I.on("data",function(U,j){N.push(U)||N._helper.pause(),O&&O(j)}).on("error",function(U){N.emit("error",U)}).on("end",function(){N.push(null)})}_("../utils").inherits(A,C),A.prototype._read=function(){this._helper.resume()},E.exports=A},{"../utils":32,"readable-stream":16}],14:[function(_,E,S){E.exports={isNode:typeof Buffer$4<"u",newBufferFrom:function(C,A){if(Buffer$4.from&&Buffer$4.from!==Uint8Array.from)return Buffer$4.from(C,A);if(typeof C=="number")throw new Error('The "data" argument must not be a number');return new Buffer$4(C,A)},allocBuffer:function(C){if(Buffer$4.alloc)return Buffer$4.alloc(C);var A=new Buffer$4(C);return A.fill(0),A},isBuffer:function(C){return Buffer$4.isBuffer(C)},isStream:function(C){return C&&typeof C.on=="function"&&typeof C.pause=="function"&&typeof C.resume=="function"}}},{}],15:[function(_,E,S){function C(Te,xe,Re){var Ne,Fe=I.getTypeOf(xe),ht=I.extend(Re||{},N);ht.date=ht.date||new Date,ht.compression!==null&&(ht.compression=ht.compression.toUpperCase()),typeof ht.unixPermissions=="string"&&(ht.unixPermissions=parseInt(ht.unixPermissions,8)),ht.unixPermissions&&16384&ht.unixPermissions&&(ht.dir=!0),ht.dosPermissions&&16&ht.dosPermissions&&(ht.dir=!0),ht.dir&&(Te=se(Te)),ht.createFolders&&(Ne=Q(Te))&&oe.call(this,Ne,!0);var nt=Fe==="string"&&ht.binary===!1&&ht.base64===!1;Re&&Re.binary!==void 0||(ht.binary=!nt),(xe instanceof U&&xe.uncompressedSize===0||ht.dir||!xe||xe.length===0)&&(ht.base64=!1,ht.binary=!0,xe="",ht.compression="STORE",Fe="string");var Ee=null;Ee=xe instanceof U||xe instanceof B?xe:Z.isNode&&Z.isStream(xe)?new X(Te,xe):I.prepareContent(Te,xe,ht.binary,ht.optimizedBinaryString,ht.base64);var Ce=new j(Te,Ee,ht);this.files[Te]=Ce}var A=_("./utf8"),I=_("./utils"),B=_("./stream/GenericWorker"),O=_("./stream/StreamHelper"),N=_("./defaults"),U=_("./compressedObject"),j=_("./zipObject"),z=_("./generate"),Z=_("./nodejsUtils"),X=_("./nodejs/NodejsStreamInputAdapter"),Q=function(Te){Te.slice(-1)==="/"&&(Te=Te.substring(0,Te.length-1));var xe=Te.lastIndexOf("/");return 0<xe?Te.substring(0,xe):""},se=function(Te){return Te.slice(-1)!=="/"&&(Te+="/"),Te},oe=function(Te,xe){return xe=xe!==void 0?xe:N.createFolders,Te=se(Te),this.files[Te]||C.call(this,Te,null,{dir:!0,createFolders:xe}),this.files[Te]};function ue(Te){return Object.prototype.toString.call(Te)==="[object RegExp]"}var we={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(Te){var xe,Re,Ne;for(xe in this.files)Ne=this.files[xe],(Re=xe.slice(this.root.length,xe.length))&&xe.slice(0,this.root.length)===this.root&&Te(Re,Ne)},filter:function(Te){var xe=[];return this.forEach(function(Re,Ne){Te(Re,Ne)&&xe.push(Ne)}),xe},file:function(Te,xe,Re){if(arguments.length!==1)return Te=this.root+Te,C.call(this,Te,xe,Re),this;if(ue(Te)){var Ne=Te;return this.filter(function(ht,nt){return!nt.dir&&Ne.test(ht)})}var Fe=this.files[this.root+Te];return Fe&&!Fe.dir?Fe:null},folder:function(Te){if(!Te)return this;if(ue(Te))return this.filter(function(Fe,ht){return ht.dir&&Te.test(Fe)});var xe=this.root+Te,Re=oe.call(this,xe),Ne=this.clone();return Ne.root=Re.name,Ne},remove:function(Te){Te=this.root+Te;var xe=this.files[Te];if(xe||(Te.slice(-1)!=="/"&&(Te+="/"),xe=this.files[Te]),xe&&!xe.dir)delete this.files[Te];else for(var Re=this.filter(function(Fe,ht){return ht.name.slice(0,Te.length)===Te}),Ne=0;Ne<Re.length;Ne++)delete this.files[Re[Ne].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(Te){var xe,Re={};try{if((Re=I.extend(Te||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:A.utf8encode})).type=Re.type.toLowerCase(),Re.compression=Re.compression.toUpperCase(),Re.type==="binarystring"&&(Re.type="string"),!Re.type)throw new Error("No output type specified.");I.checkSupport(Re.type),Re.platform!=="darwin"&&Re.platform!=="freebsd"&&Re.platform!=="linux"&&Re.platform!=="sunos"||(Re.platform="UNIX"),Re.platform==="win32"&&(Re.platform="DOS");var Ne=Re.comment||this.comment||"";xe=z.generateWorker(this,Re,Ne)}catch(Fe){(xe=new B("error")).error(Fe)}return new O(xe,Re.type||"string",Re.mimeType)},generateAsync:function(Te,xe){return this.generateInternalStream(Te).accumulate(xe)},generateNodeStream:function(Te,xe){return(Te=Te||{}).type||(Te.type="nodebuffer"),this.generateInternalStream(Te).toNodejsStream(xe)}};E.exports=we},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(_,E,S){E.exports=_("stream")},{stream:void 0}],17:[function(_,E,S){var C=_("./DataReader");function A(I){C.call(this,I);for(var B=0;B<this.data.length;B++)I[B]=255&I[B]}_("../utils").inherits(A,C),A.prototype.byteAt=function(I){return this.data[this.zero+I]},A.prototype.lastIndexOfSignature=function(I){for(var B=I.charCodeAt(0),O=I.charCodeAt(1),N=I.charCodeAt(2),U=I.charCodeAt(3),j=this.length-4;0<=j;--j)if(this.data[j]===B&&this.data[j+1]===O&&this.data[j+2]===N&&this.data[j+3]===U)return j-this.zero;return-1},A.prototype.readAndCheckSignature=function(I){var B=I.charCodeAt(0),O=I.charCodeAt(1),N=I.charCodeAt(2),U=I.charCodeAt(3),j=this.readData(4);return B===j[0]&&O===j[1]&&N===j[2]&&U===j[3]},A.prototype.readData=function(I){if(this.checkOffset(I),I===0)return[];var B=this.data.slice(this.zero+this.index,this.zero+this.index+I);return this.index+=I,B},E.exports=A},{"../utils":32,"./DataReader":18}],18:[function(_,E,S){var C=_("../utils");function A(I){this.data=I,this.length=I.length,this.index=0,this.zero=0}A.prototype={checkOffset:function(I){this.checkIndex(this.index+I)},checkIndex:function(I){if(this.length<this.zero+I||I<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+I+"). Corrupted zip ?")},setIndex:function(I){this.checkIndex(I),this.index=I},skip:function(I){this.setIndex(this.index+I)},byteAt:function(){},readInt:function(I){var B,O=0;for(this.checkOffset(I),B=this.index+I-1;B>=this.index;B--)O=(O<<8)+this.byteAt(B);return this.index+=I,O},readString:function(I){return C.transformTo("string",this.readData(I))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var I=this.readInt(4);return new Date(Date.UTC(1980+(I>>25&127),(I>>21&15)-1,I>>16&31,I>>11&31,I>>5&63,(31&I)<<1))}},E.exports=A},{"../utils":32}],19:[function(_,E,S){var C=_("./Uint8ArrayReader");function A(I){C.call(this,I)}_("../utils").inherits(A,C),A.prototype.readData=function(I){this.checkOffset(I);var B=this.data.slice(this.zero+this.index,this.zero+this.index+I);return this.index+=I,B},E.exports=A},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(_,E,S){var C=_("./DataReader");function A(I){C.call(this,I)}_("../utils").inherits(A,C),A.prototype.byteAt=function(I){return this.data.charCodeAt(this.zero+I)},A.prototype.lastIndexOfSignature=function(I){return this.data.lastIndexOf(I)-this.zero},A.prototype.readAndCheckSignature=function(I){return I===this.readData(4)},A.prototype.readData=function(I){this.checkOffset(I);var B=this.data.slice(this.zero+this.index,this.zero+this.index+I);return this.index+=I,B},E.exports=A},{"../utils":32,"./DataReader":18}],21:[function(_,E,S){var C=_("./ArrayReader");function A(I){C.call(this,I)}_("../utils").inherits(A,C),A.prototype.readData=function(I){if(this.checkOffset(I),I===0)return new Uint8Array(0);var B=this.data.subarray(this.zero+this.index,this.zero+this.index+I);return this.index+=I,B},E.exports=A},{"../utils":32,"./ArrayReader":17}],22:[function(_,E,S){var C=_("../utils"),A=_("../support"),I=_("./ArrayReader"),B=_("./StringReader"),O=_("./NodeBufferReader"),N=_("./Uint8ArrayReader");E.exports=function(U){var j=C.getTypeOf(U);return C.checkSupport(j),j!=="string"||A.uint8array?j==="nodebuffer"?new O(U):A.uint8array?new N(C.transformTo("uint8array",U)):new I(C.transformTo("array",U)):new B(U)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(_,E,S){S.LOCAL_FILE_HEADER="PK",S.CENTRAL_FILE_HEADER="PK",S.CENTRAL_DIRECTORY_END="PK",S.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07",S.ZIP64_CENTRAL_DIRECTORY_END="PK",S.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(_,E,S){var C=_("./GenericWorker"),A=_("../utils");function I(B){C.call(this,"ConvertWorker to "+B),this.destType=B}A.inherits(I,C),I.prototype.processChunk=function(B){this.push({data:A.transformTo(this.destType,B.data),meta:B.meta})},E.exports=I},{"../utils":32,"./GenericWorker":28}],25:[function(_,E,S){var C=_("./GenericWorker"),A=_("../crc32");function I(){C.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}_("../utils").inherits(I,C),I.prototype.processChunk=function(B){this.streamInfo.crc32=A(B.data,this.streamInfo.crc32||0),this.push(B)},E.exports=I},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(_,E,S){var C=_("../utils"),A=_("./GenericWorker");function I(B){A.call(this,"DataLengthProbe for "+B),this.propName=B,this.withStreamInfo(B,0)}C.inherits(I,A),I.prototype.processChunk=function(B){if(B){var O=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=O+B.data.length}A.prototype.processChunk.call(this,B)},E.exports=I},{"../utils":32,"./GenericWorker":28}],27:[function(_,E,S){var C=_("../utils"),A=_("./GenericWorker");function I(B){A.call(this,"DataWorker");var O=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,B.then(function(N){O.dataIsReady=!0,O.data=N,O.max=N&&N.length||0,O.type=C.getTypeOf(N),O.isPaused||O._tickAndRepeat()},function(N){O.error(N)})}C.inherits(I,A),I.prototype.cleanUp=function(){A.prototype.cleanUp.call(this),this.data=null},I.prototype.resume=function(){return!!A.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,C.delay(this._tickAndRepeat,[],this)),!0)},I.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(C.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},I.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var B=null,O=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":B=this.data.substring(this.index,O);break;case"uint8array":B=this.data.subarray(this.index,O);break;case"array":case"nodebuffer":B=this.data.slice(this.index,O)}return this.index=O,this.push({data:B,meta:{percent:this.max?this.index/this.max*100:0}})},E.exports=I},{"../utils":32,"./GenericWorker":28}],28:[function(_,E,S){function C(A){this.name=A||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}C.prototype={push:function(A){this.emit("data",A)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(A){this.emit("error",A)}return!0},error:function(A){return!this.isFinished&&(this.isPaused?this.generatedError=A:(this.isFinished=!0,this.emit("error",A),this.previous&&this.previous.error(A),this.cleanUp()),!0)},on:function(A,I){return this._listeners[A].push(I),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(A,I){if(this._listeners[A])for(var B=0;B<this._listeners[A].length;B++)this._listeners[A][B].call(this,I)},pipe:function(A){return A.registerPrevious(this)},registerPrevious:function(A){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=A.streamInfo,this.mergeStreamInfo(),this.previous=A;var I=this;return A.on("data",function(B){I.processChunk(B)}),A.on("end",function(){I.end()}),A.on("error",function(B){I.error(B)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var A=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),A=!0),this.previous&&this.previous.resume(),!A},flush:function(){},processChunk:function(A){this.push(A)},withStreamInfo:function(A,I){return this.extraStreamInfo[A]=I,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var A in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,A)&&(this.streamInfo[A]=this.extraStreamInfo[A])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var A="Worker "+this.name;return this.previous?this.previous+" -> "+A:A}},E.exports=C},{}],29:[function(_,E,S){var C=_("../utils"),A=_("./ConvertWorker"),I=_("./GenericWorker"),B=_("../base64"),O=_("../support"),N=_("../external"),U=null;if(O.nodestream)try{U=_("../nodejs/NodejsStreamOutputAdapter")}catch{}function j(Z,X){return new N.Promise(function(Q,se){var oe=[],ue=Z._internalType,we=Z._outputType,Te=Z._mimeType;Z.on("data",function(xe,Re){oe.push(xe),X&&X(Re)}).on("error",function(xe){oe=[],se(xe)}).on("end",function(){try{var xe=function(Re,Ne,Fe){switch(Re){case"blob":return C.newBlob(C.transformTo("arraybuffer",Ne),Fe);case"base64":return B.encode(Ne);default:return C.transformTo(Re,Ne)}}(we,function(Re,Ne){var Fe,ht=0,nt=null,Ee=0;for(Fe=0;Fe<Ne.length;Fe++)Ee+=Ne[Fe].length;switch(Re){case"string":return Ne.join("");case"array":return Array.prototype.concat.apply([],Ne);case"uint8array":for(nt=new Uint8Array(Ee),Fe=0;Fe<Ne.length;Fe++)nt.set(Ne[Fe],ht),ht+=Ne[Fe].length;return nt;case"nodebuffer":return Buffer$4.concat(Ne);default:throw new Error("concat : unsupported type '"+Re+"'")}}(ue,oe),Te);Q(xe)}catch(Re){se(Re)}oe=[]}).resume()})}function z(Z,X,Q){var se=X;switch(X){case"blob":case"arraybuffer":se="uint8array";break;case"base64":se="string"}try{this._internalType=se,this._outputType=X,this._mimeType=Q,C.checkSupport(se),this._worker=Z.pipe(new A(se)),Z.lock()}catch(oe){this._worker=new I("error"),this._worker.error(oe)}}z.prototype={accumulate:function(Z){return j(this,Z)},on:function(Z,X){var Q=this;return Z==="data"?this._worker.on(Z,function(se){X.call(Q,se.data,se.meta)}):this._worker.on(Z,function(){C.delay(X,arguments,Q)}),this},resume:function(){return C.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(Z){if(C.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new U(this,{objectMode:this._outputType!=="nodebuffer"},Z)}},E.exports=z},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(_,E,S){if(S.base64=!0,S.array=!0,S.string=!0,S.arraybuffer=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u",S.nodebuffer=typeof Buffer$4<"u",S.uint8array=typeof Uint8Array<"u",typeof ArrayBuffer>"u")S.blob=!1;else{var C=new ArrayBuffer(0);try{S.blob=new Blob([C],{type:"application/zip"}).size===0}catch{try{var A=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);A.append(C),S.blob=A.getBlob("application/zip").size===0}catch{S.blob=!1}}}try{S.nodestream=!!_("readable-stream").Readable}catch{S.nodestream=!1}},{"readable-stream":16}],31:[function(_,E,S){for(var C=_("./utils"),A=_("./support"),I=_("./nodejsUtils"),B=_("./stream/GenericWorker"),O=new Array(256),N=0;N<256;N++)O[N]=252<=N?6:248<=N?5:240<=N?4:224<=N?3:192<=N?2:1;O[254]=O[254]=1;function U(){B.call(this,"utf-8 decode"),this.leftOver=null}function j(){B.call(this,"utf-8 encode")}S.utf8encode=function(z){return A.nodebuffer?I.newBufferFrom(z,"utf-8"):function(Z){var X,Q,se,oe,ue,we=Z.length,Te=0;for(oe=0;oe<we;oe++)(64512&(Q=Z.charCodeAt(oe)))==55296&&oe+1<we&&(64512&(se=Z.charCodeAt(oe+1)))==56320&&(Q=65536+(Q-55296<<10)+(se-56320),oe++),Te+=Q<128?1:Q<2048?2:Q<65536?3:4;for(X=A.uint8array?new Uint8Array(Te):new Array(Te),oe=ue=0;ue<Te;oe++)(64512&(Q=Z.charCodeAt(oe)))==55296&&oe+1<we&&(64512&(se=Z.charCodeAt(oe+1)))==56320&&(Q=65536+(Q-55296<<10)+(se-56320),oe++),Q<128?X[ue++]=Q:(Q<2048?X[ue++]=192|Q>>>6:(Q<65536?X[ue++]=224|Q>>>12:(X[ue++]=240|Q>>>18,X[ue++]=128|Q>>>12&63),X[ue++]=128|Q>>>6&63),X[ue++]=128|63&Q);return X}(z)},S.utf8decode=function(z){return A.nodebuffer?C.transformTo("nodebuffer",z).toString("utf-8"):function(Z){var X,Q,se,oe,ue=Z.length,we=new Array(2*ue);for(X=Q=0;X<ue;)if((se=Z[X++])<128)we[Q++]=se;else if(4<(oe=O[se]))we[Q++]=65533,X+=oe-1;else{for(se&=oe===2?31:oe===3?15:7;1<oe&&X<ue;)se=se<<6|63&Z[X++],oe--;1<oe?we[Q++]=65533:se<65536?we[Q++]=se:(se-=65536,we[Q++]=55296|se>>10&1023,we[Q++]=56320|1023&se)}return we.length!==Q&&(we.subarray?we=we.subarray(0,Q):we.length=Q),C.applyFromCharCode(we)}(z=C.transformTo(A.uint8array?"uint8array":"array",z))},C.inherits(U,B),U.prototype.processChunk=function(z){var Z=C.transformTo(A.uint8array?"uint8array":"array",z.data);if(this.leftOver&&this.leftOver.length){if(A.uint8array){var X=Z;(Z=new Uint8Array(X.length+this.leftOver.length)).set(this.leftOver,0),Z.set(X,this.leftOver.length)}else Z=this.leftOver.concat(Z);this.leftOver=null}var Q=function(oe,ue){var we;for((ue=ue||oe.length)>oe.length&&(ue=oe.length),we=ue-1;0<=we&&(192&oe[we])==128;)we--;return we<0||we===0?ue:we+O[oe[we]]>ue?we:ue}(Z),se=Z;Q!==Z.length&&(A.uint8array?(se=Z.subarray(0,Q),this.leftOver=Z.subarray(Q,Z.length)):(se=Z.slice(0,Q),this.leftOver=Z.slice(Q,Z.length))),this.push({data:S.utf8decode(se),meta:z.meta})},U.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:S.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},S.Utf8DecodeWorker=U,C.inherits(j,B),j.prototype.processChunk=function(z){this.push({data:S.utf8encode(z.data),meta:z.meta})},S.Utf8EncodeWorker=j},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(_,E,S){var C=_("./support"),A=_("./base64"),I=_("./nodejsUtils"),B=_("./external");function O(X){return X}function N(X,Q){for(var se=0;se<X.length;++se)Q[se]=255&X.charCodeAt(se);return Q}_("setimmediate"),S.newBlob=function(X,Q){S.checkSupport("blob");try{return new Blob([X],{type:Q})}catch{try{var se=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return se.append(X),se.getBlob(Q)}catch{throw new Error("Bug : can't construct the Blob.")}}};var U={stringifyByChunk:function(X,Q,se){var oe=[],ue=0,we=X.length;if(we<=se)return String.fromCharCode.apply(null,X);for(;ue<we;)Q==="array"||Q==="nodebuffer"?oe.push(String.fromCharCode.apply(null,X.slice(ue,Math.min(ue+se,we)))):oe.push(String.fromCharCode.apply(null,X.subarray(ue,Math.min(ue+se,we)))),ue+=se;return oe.join("")},stringifyByChar:function(X){for(var Q="",se=0;se<X.length;se++)Q+=String.fromCharCode(X[se]);return Q},applyCanBeUsed:{uint8array:function(){try{return C.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch{return!1}}(),nodebuffer:function(){try{return C.nodebuffer&&String.fromCharCode.apply(null,I.allocBuffer(1)).length===1}catch{return!1}}()}};function j(X){var Q=65536,se=S.getTypeOf(X),oe=!0;if(se==="uint8array"?oe=U.applyCanBeUsed.uint8array:se==="nodebuffer"&&(oe=U.applyCanBeUsed.nodebuffer),oe)for(;1<Q;)try{return U.stringifyByChunk(X,se,Q)}catch{Q=Math.floor(Q/2)}return U.stringifyByChar(X)}function z(X,Q){for(var se=0;se<X.length;se++)Q[se]=X[se];return Q}S.applyFromCharCode=j;var Z={};Z.string={string:O,array:function(X){return N(X,new Array(X.length))},arraybuffer:function(X){return Z.string.uint8array(X).buffer},uint8array:function(X){return N(X,new Uint8Array(X.length))},nodebuffer:function(X){return N(X,I.allocBuffer(X.length))}},Z.array={string:j,array:O,arraybuffer:function(X){return new Uint8Array(X).buffer},uint8array:function(X){return new Uint8Array(X)},nodebuffer:function(X){return I.newBufferFrom(X)}},Z.arraybuffer={string:function(X){return j(new Uint8Array(X))},array:function(X){return z(new Uint8Array(X),new Array(X.byteLength))},arraybuffer:O,uint8array:function(X){return new Uint8Array(X)},nodebuffer:function(X){return I.newBufferFrom(new Uint8Array(X))}},Z.uint8array={string:j,array:function(X){return z(X,new Array(X.length))},arraybuffer:function(X){return X.buffer},uint8array:O,nodebuffer:function(X){return I.newBufferFrom(X)}},Z.nodebuffer={string:j,array:function(X){return z(X,new Array(X.length))},arraybuffer:function(X){return Z.nodebuffer.uint8array(X).buffer},uint8array:function(X){return z(X,new Uint8Array(X.length))},nodebuffer:O},S.transformTo=function(X,Q){if(Q=Q||"",!X)return Q;S.checkSupport(X);var se=S.getTypeOf(Q);return Z[se][X](Q)},S.resolve=function(X){for(var Q=X.split("/"),se=[],oe=0;oe<Q.length;oe++){var ue=Q[oe];ue==="."||ue===""&&oe!==0&&oe!==Q.length-1||(ue===".."?se.pop():se.push(ue))}return se.join("/")},S.getTypeOf=function(X){return typeof X=="string"?"string":Object.prototype.toString.call(X)==="[object Array]"?"array":C.nodebuffer&&I.isBuffer(X)?"nodebuffer":C.uint8array&&X instanceof Uint8Array?"uint8array":C.arraybuffer&&X instanceof ArrayBuffer?"arraybuffer":void 0},S.checkSupport=function(X){if(!C[X.toLowerCase()])throw new Error(X+" is not supported by this platform")},S.MAX_VALUE_16BITS=65535,S.MAX_VALUE_32BITS=-1,S.pretty=function(X){var Q,se,oe="";for(se=0;se<(X||"").length;se++)oe+="\\x"+((Q=X.charCodeAt(se))<16?"0":"")+Q.toString(16).toUpperCase();return oe},S.delay=function(X,Q,se){setImmediate(function(){X.apply(se||null,Q||[])})},S.inherits=function(X,Q){function se(){}se.prototype=Q.prototype,X.prototype=new se},S.extend=function(){var X,Q,se={};for(X=0;X<arguments.length;X++)for(Q in arguments[X])Object.prototype.hasOwnProperty.call(arguments[X],Q)&&se[Q]===void 0&&(se[Q]=arguments[X][Q]);return se},S.prepareContent=function(X,Q,se,oe,ue){return B.Promise.resolve(Q).then(function(we){return C.blob&&(we instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(we))!==-1)&&typeof FileReader<"u"?new B.Promise(function(Te,xe){var Re=new FileReader;Re.onload=function(Ne){Te(Ne.target.result)},Re.onerror=function(Ne){xe(Ne.target.error)},Re.readAsArrayBuffer(we)}):we}).then(function(we){var Te=S.getTypeOf(we);return Te?(Te==="arraybuffer"?we=S.transformTo("uint8array",we):Te==="string"&&(ue?we=A.decode(we):se&&oe!==!0&&(we=function(xe){return N(xe,C.uint8array?new Uint8Array(xe.length):new Array(xe.length))}(we))),we):B.Promise.reject(new Error("Can't read the data of '"+X+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(_,E,S){var C=_("./reader/readerFor"),A=_("./utils"),I=_("./signature"),B=_("./zipEntry"),O=_("./support");function N(U){this.files=[],this.loadOptions=U}N.prototype={checkSignature:function(U){if(!this.reader.readAndCheckSignature(U)){this.reader.index-=4;var j=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+A.pretty(j)+", expected "+A.pretty(U)+")")}},isSignature:function(U,j){var z=this.reader.index;this.reader.setIndex(U);var Z=this.reader.readString(4)===j;return this.reader.setIndex(z),Z},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var U=this.reader.readData(this.zipCommentLength),j=O.uint8array?"uint8array":"array",z=A.transformTo(j,U);this.zipComment=this.loadOptions.decodeFileName(z)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var U,j,z,Z=this.zip64EndOfCentralSize-44;0<Z;)U=this.reader.readInt(2),j=this.reader.readInt(4),z=this.reader.readData(j),this.zip64ExtensibleData[U]={id:U,length:j,value:z}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var U,j;for(U=0;U<this.files.length;U++)j=this.files[U],this.reader.setIndex(j.localHeaderOffset),this.checkSignature(I.LOCAL_FILE_HEADER),j.readLocalPart(this.reader),j.handleUTF8(),j.processAttributes()},readCentralDir:function(){var U;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(I.CENTRAL_FILE_HEADER);)(U=new B({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(U);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var U=this.reader.lastIndexOfSignature(I.CENTRAL_DIRECTORY_END);if(U<0)throw this.isSignature(0,I.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(U);var j=U;if(this.checkSignature(I.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===A.MAX_VALUE_16BITS||this.diskWithCentralDirStart===A.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===A.MAX_VALUE_16BITS||this.centralDirRecords===A.MAX_VALUE_16BITS||this.centralDirSize===A.MAX_VALUE_32BITS||this.centralDirOffset===A.MAX_VALUE_32BITS){if(this.zip64=!0,(U=this.reader.lastIndexOfSignature(I.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(U),this.checkSignature(I.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,I.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(I.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(I.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var z=this.centralDirOffset+this.centralDirSize;this.zip64&&(z+=20,z+=12+this.zip64EndOfCentralSize);var Z=j-z;if(0<Z)this.isSignature(j,I.CENTRAL_FILE_HEADER)||(this.reader.zero=Z);else if(Z<0)throw new Error("Corrupted zip: missing "+Math.abs(Z)+" bytes.")},prepareReader:function(U){this.reader=C(U)},load:function(U){this.prepareReader(U),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},E.exports=N},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(_,E,S){var C=_("./reader/readerFor"),A=_("./utils"),I=_("./compressedObject"),B=_("./crc32"),O=_("./utf8"),N=_("./compressions"),U=_("./support");function j(z,Z){this.options=z,this.loadOptions=Z}j.prototype={isEncrypted:function(){return(1&this.bitFlag)==1},useUTF8:function(){return(2048&this.bitFlag)==2048},readLocalPart:function(z){var Z,X;if(z.skip(22),this.fileNameLength=z.readInt(2),X=z.readInt(2),this.fileName=z.readData(this.fileNameLength),z.skip(X),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if((Z=function(Q){for(var se in N)if(Object.prototype.hasOwnProperty.call(N,se)&&N[se].magic===Q)return N[se];return null}(this.compressionMethod))===null)throw new Error("Corrupted zip : compression "+A.pretty(this.compressionMethod)+" unknown (inner file : "+A.transformTo("string",this.fileName)+")");this.decompressed=new I(this.compressedSize,this.uncompressedSize,this.crc32,Z,z.readData(this.compressedSize))},readCentralPart:function(z){this.versionMadeBy=z.readInt(2),z.skip(2),this.bitFlag=z.readInt(2),this.compressionMethod=z.readString(2),this.date=z.readDate(),this.crc32=z.readInt(4),this.compressedSize=z.readInt(4),this.uncompressedSize=z.readInt(4);var Z=z.readInt(2);if(this.extraFieldsLength=z.readInt(2),this.fileCommentLength=z.readInt(2),this.diskNumberStart=z.readInt(2),this.internalFileAttributes=z.readInt(2),this.externalFileAttributes=z.readInt(4),this.localHeaderOffset=z.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");z.skip(Z),this.readExtraFields(z),this.parseZIP64ExtraField(z),this.fileComment=z.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var z=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),z==0&&(this.dosPermissions=63&this.externalFileAttributes),z==3&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||this.fileNameStr.slice(-1)!=="/"||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var z=C(this.extraFields[1].value);this.uncompressedSize===A.MAX_VALUE_32BITS&&(this.uncompressedSize=z.readInt(8)),this.compressedSize===A.MAX_VALUE_32BITS&&(this.compressedSize=z.readInt(8)),this.localHeaderOffset===A.MAX_VALUE_32BITS&&(this.localHeaderOffset=z.readInt(8)),this.diskNumberStart===A.MAX_VALUE_32BITS&&(this.diskNumberStart=z.readInt(4))}},readExtraFields:function(z){var Z,X,Q,se=z.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});z.index+4<se;)Z=z.readInt(2),X=z.readInt(2),Q=z.readData(X),this.extraFields[Z]={id:Z,length:X,value:Q};z.setIndex(se)},handleUTF8:function(){var z=U.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=O.utf8decode(this.fileName),this.fileCommentStr=O.utf8decode(this.fileComment);else{var Z=this.findExtraFieldUnicodePath();if(Z!==null)this.fileNameStr=Z;else{var X=A.transformTo(z,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(X)}var Q=this.findExtraFieldUnicodeComment();if(Q!==null)this.fileCommentStr=Q;else{var se=A.transformTo(z,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(se)}}},findExtraFieldUnicodePath:function(){var z=this.extraFields[28789];if(z){var Z=C(z.value);return Z.readInt(1)!==1||B(this.fileName)!==Z.readInt(4)?null:O.utf8decode(Z.readData(z.length-5))}return null},findExtraFieldUnicodeComment:function(){var z=this.extraFields[25461];if(z){var Z=C(z.value);return Z.readInt(1)!==1||B(this.fileComment)!==Z.readInt(4)?null:O.utf8decode(Z.readData(z.length-5))}return null}},E.exports=j},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(_,E,S){function C(Z,X,Q){this.name=Z,this.dir=Q.dir,this.date=Q.date,this.comment=Q.comment,this.unixPermissions=Q.unixPermissions,this.dosPermissions=Q.dosPermissions,this._data=X,this._dataBinary=Q.binary,this.options={compression:Q.compression,compressionOptions:Q.compressionOptions}}var A=_("./stream/StreamHelper"),I=_("./stream/DataWorker"),B=_("./utf8"),O=_("./compressedObject"),N=_("./stream/GenericWorker");C.prototype={internalStream:function(Z){var X=null,Q="string";try{if(!Z)throw new Error("No output type specified.");var se=(Q=Z.toLowerCase())==="string"||Q==="text";Q!=="binarystring"&&Q!=="text"||(Q="string"),X=this._decompressWorker();var oe=!this._dataBinary;oe&&!se&&(X=X.pipe(new B.Utf8EncodeWorker)),!oe&&se&&(X=X.pipe(new B.Utf8DecodeWorker))}catch(ue){(X=new N("error")).error(ue)}return new A(X,Q,"")},async:function(Z,X){return this.internalStream(Z).accumulate(X)},nodeStream:function(Z,X){return this.internalStream(Z||"nodebuffer").toNodejsStream(X)},_compressWorker:function(Z,X){if(this._data instanceof O&&this._data.compression.magic===Z.magic)return this._data.getCompressedWorker();var Q=this._decompressWorker();return this._dataBinary||(Q=Q.pipe(new B.Utf8EncodeWorker)),O.createWorkerFrom(Q,Z,X)},_decompressWorker:function(){return this._data instanceof O?this._data.getContentWorker():this._data instanceof N?this._data:new I(this._data)}};for(var U=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],j=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},z=0;z<U.length;z++)C.prototype[U[z]]=j;E.exports=C},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(_,E,S){(function(C){var A,I,B=C.MutationObserver||C.WebKitMutationObserver;if(B){var O=0,N=new B(Z),U=C.document.createTextNode("");N.observe(U,{characterData:!0}),A=function(){U.data=O=++O%2}}else if(C.setImmediate||C.MessageChannel===void 0)A="document"in C&&"onreadystatechange"in C.document.createElement("script")?function(){var X=C.document.createElement("script");X.onreadystatechange=function(){Z(),X.onreadystatechange=null,X.parentNode.removeChild(X),X=null},C.document.documentElement.appendChild(X)}:function(){setTimeout(Z,0)};else{var j=new C.MessageChannel;j.port1.onmessage=Z,A=function(){j.port2.postMessage(0)}}var z=[];function Z(){var X,Q;I=!0;for(var se=z.length;se;){for(Q=z,z=[],X=-1;++X<se;)Q[X]();se=z.length}I=!1}E.exports=function(X){z.push(X)!==1||I||A()}}).call(this,typeof commonjsGlobal<"u"?commonjsGlobal:typeof self<"u"?self:typeof window<"u"?window:{})},{}],37:[function(_,E,S){var C=_("immediate");function A(){}var I={},B=["REJECTED"],O=["FULFILLED"],N=["PENDING"];function U(se){if(typeof se!="function")throw new TypeError("resolver must be a function");this.state=N,this.queue=[],this.outcome=void 0,se!==A&&X(this,se)}function j(se,oe,ue){this.promise=se,typeof oe=="function"&&(this.onFulfilled=oe,this.callFulfilled=this.otherCallFulfilled),typeof ue=="function"&&(this.onRejected=ue,this.callRejected=this.otherCallRejected)}function z(se,oe,ue){C(function(){var we;try{we=oe(ue)}catch(Te){return I.reject(se,Te)}we===se?I.reject(se,new TypeError("Cannot resolve promise with itself")):I.resolve(se,we)})}function Z(se){var oe=se&&se.then;if(se&&(typeof se=="object"||typeof se=="function")&&typeof oe=="function")return function(){oe.apply(se,arguments)}}function X(se,oe){var ue=!1;function we(Re){ue||(ue=!0,I.reject(se,Re))}function Te(Re){ue||(ue=!0,I.resolve(se,Re))}var xe=Q(function(){oe(Te,we)});xe.status==="error"&&we(xe.value)}function Q(se,oe){var ue={};try{ue.value=se(oe),ue.status="success"}catch(we){ue.status="error",ue.value=we}return ue}(E.exports=U).prototype.finally=function(se){if(typeof se!="function")return this;var oe=this.constructor;return this.then(function(ue){return oe.resolve(se()).then(function(){return ue})},function(ue){return oe.resolve(se()).then(function(){throw ue})})},U.prototype.catch=function(se){return this.then(null,se)},U.prototype.then=function(se,oe){if(typeof se!="function"&&this.state===O||typeof oe!="function"&&this.state===B)return this;var ue=new this.constructor(A);return this.state!==N?z(ue,this.state===O?se:oe,this.outcome):this.queue.push(new j(ue,se,oe)),ue},j.prototype.callFulfilled=function(se){I.resolve(this.promise,se)},j.prototype.otherCallFulfilled=function(se){z(this.promise,this.onFulfilled,se)},j.prototype.callRejected=function(se){I.reject(this.promise,se)},j.prototype.otherCallRejected=function(se){z(this.promise,this.onRejected,se)},I.resolve=function(se,oe){var ue=Q(Z,oe);if(ue.status==="error")return I.reject(se,ue.value);var we=ue.value;if(we)X(se,we);else{se.state=O,se.outcome=oe;for(var Te=-1,xe=se.queue.length;++Te<xe;)se.queue[Te].callFulfilled(oe)}return se},I.reject=function(se,oe){se.state=B,se.outcome=oe;for(var ue=-1,we=se.queue.length;++ue<we;)se.queue[ue].callRejected(oe);return se},U.resolve=function(se){return se instanceof this?se:I.resolve(new this(A),se)},U.reject=function(se){var oe=new this(A);return I.reject(oe,se)},U.all=function(se){var oe=this;if(Object.prototype.toString.call(se)!=="[object Array]")return this.reject(new TypeError("must be an array"));var ue=se.length,we=!1;if(!ue)return this.resolve([]);for(var Te=new Array(ue),xe=0,Re=-1,Ne=new this(A);++Re<ue;)Fe(se[Re],Re);return Ne;function Fe(ht,nt){oe.resolve(ht).then(function(Ee){Te[nt]=Ee,++xe!==ue||we||(we=!0,I.resolve(Ne,Te))},function(Ee){we||(we=!0,I.reject(Ne,Ee))})}},U.race=function(se){var oe=this;if(Object.prototype.toString.call(se)!=="[object Array]")return this.reject(new TypeError("must be an array"));var ue=se.length,we=!1;if(!ue)return this.resolve([]);for(var Te=-1,xe=new this(A);++Te<ue;)Re=se[Te],oe.resolve(Re).then(function(Ne){we||(we=!0,I.resolve(xe,Ne))},function(Ne){we||(we=!0,I.reject(xe,Ne))});var Re;return xe}},{immediate:36}],38:[function(_,E,S){var C={};(0,_("./lib/utils/common").assign)(C,_("./lib/deflate"),_("./lib/inflate"),_("./lib/zlib/constants")),E.exports=C},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(_,E,S){var C=_("./zlib/deflate"),A=_("./utils/common"),I=_("./utils/strings"),B=_("./zlib/messages"),O=_("./zlib/zstream"),N=Object.prototype.toString,U=0,j=-1,z=0,Z=8;function X(se){if(!(this instanceof X))return new X(se);this.options=A.assign({level:j,method:Z,chunkSize:16384,windowBits:15,memLevel:8,strategy:z,to:""},se||{});var oe=this.options;oe.raw&&0<oe.windowBits?oe.windowBits=-oe.windowBits:oe.gzip&&0<oe.windowBits&&oe.windowBits<16&&(oe.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new O,this.strm.avail_out=0;var ue=C.deflateInit2(this.strm,oe.level,oe.method,oe.windowBits,oe.memLevel,oe.strategy);if(ue!==U)throw new Error(B[ue]);if(oe.header&&C.deflateSetHeader(this.strm,oe.header),oe.dictionary){var we;if(we=typeof oe.dictionary=="string"?I.string2buf(oe.dictionary):N.call(oe.dictionary)==="[object ArrayBuffer]"?new Uint8Array(oe.dictionary):oe.dictionary,(ue=C.deflateSetDictionary(this.strm,we))!==U)throw new Error(B[ue]);this._dict_set=!0}}function Q(se,oe){var ue=new X(oe);if(ue.push(se,!0),ue.err)throw ue.msg||B[ue.err];return ue.result}X.prototype.push=function(se,oe){var ue,we,Te=this.strm,xe=this.options.chunkSize;if(this.ended)return!1;we=oe===~~oe?oe:oe===!0?4:0,typeof se=="string"?Te.input=I.string2buf(se):N.call(se)==="[object ArrayBuffer]"?Te.input=new Uint8Array(se):Te.input=se,Te.next_in=0,Te.avail_in=Te.input.length;do{if(Te.avail_out===0&&(Te.output=new A.Buf8(xe),Te.next_out=0,Te.avail_out=xe),(ue=C.deflate(Te,we))!==1&&ue!==U)return this.onEnd(ue),!(this.ended=!0);Te.avail_out!==0&&(Te.avail_in!==0||we!==4&&we!==2)||(this.options.to==="string"?this.onData(I.buf2binstring(A.shrinkBuf(Te.output,Te.next_out))):this.onData(A.shrinkBuf(Te.output,Te.next_out)))}while((0<Te.avail_in||Te.avail_out===0)&&ue!==1);return we===4?(ue=C.deflateEnd(this.strm),this.onEnd(ue),this.ended=!0,ue===U):we!==2||(this.onEnd(U),!(Te.avail_out=0))},X.prototype.onData=function(se){this.chunks.push(se)},X.prototype.onEnd=function(se){se===U&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=A.flattenChunks(this.chunks)),this.chunks=[],this.err=se,this.msg=this.strm.msg},S.Deflate=X,S.deflate=Q,S.deflateRaw=function(se,oe){return(oe=oe||{}).raw=!0,Q(se,oe)},S.gzip=function(se,oe){return(oe=oe||{}).gzip=!0,Q(se,oe)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(_,E,S){var C=_("./zlib/inflate"),A=_("./utils/common"),I=_("./utils/strings"),B=_("./zlib/constants"),O=_("./zlib/messages"),N=_("./zlib/zstream"),U=_("./zlib/gzheader"),j=Object.prototype.toString;function z(X){if(!(this instanceof z))return new z(X);this.options=A.assign({chunkSize:16384,windowBits:0,to:""},X||{});var Q=this.options;Q.raw&&0<=Q.windowBits&&Q.windowBits<16&&(Q.windowBits=-Q.windowBits,Q.windowBits===0&&(Q.windowBits=-15)),!(0<=Q.windowBits&&Q.windowBits<16)||X&&X.windowBits||(Q.windowBits+=32),15<Q.windowBits&&Q.windowBits<48&&!(15&Q.windowBits)&&(Q.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new N,this.strm.avail_out=0;var se=C.inflateInit2(this.strm,Q.windowBits);if(se!==B.Z_OK)throw new Error(O[se]);this.header=new U,C.inflateGetHeader(this.strm,this.header)}function Z(X,Q){var se=new z(Q);if(se.push(X,!0),se.err)throw se.msg||O[se.err];return se.result}z.prototype.push=function(X,Q){var se,oe,ue,we,Te,xe,Re=this.strm,Ne=this.options.chunkSize,Fe=this.options.dictionary,ht=!1;if(this.ended)return!1;oe=Q===~~Q?Q:Q===!0?B.Z_FINISH:B.Z_NO_FLUSH,typeof X=="string"?Re.input=I.binstring2buf(X):j.call(X)==="[object ArrayBuffer]"?Re.input=new Uint8Array(X):Re.input=X,Re.next_in=0,Re.avail_in=Re.input.length;do{if(Re.avail_out===0&&(Re.output=new A.Buf8(Ne),Re.next_out=0,Re.avail_out=Ne),(se=C.inflate(Re,B.Z_NO_FLUSH))===B.Z_NEED_DICT&&Fe&&(xe=typeof Fe=="string"?I.string2buf(Fe):j.call(Fe)==="[object ArrayBuffer]"?new Uint8Array(Fe):Fe,se=C.inflateSetDictionary(this.strm,xe)),se===B.Z_BUF_ERROR&&ht===!0&&(se=B.Z_OK,ht=!1),se!==B.Z_STREAM_END&&se!==B.Z_OK)return this.onEnd(se),!(this.ended=!0);Re.next_out&&(Re.avail_out!==0&&se!==B.Z_STREAM_END&&(Re.avail_in!==0||oe!==B.Z_FINISH&&oe!==B.Z_SYNC_FLUSH)||(this.options.to==="string"?(ue=I.utf8border(Re.output,Re.next_out),we=Re.next_out-ue,Te=I.buf2string(Re.output,ue),Re.next_out=we,Re.avail_out=Ne-we,we&&A.arraySet(Re.output,Re.output,ue,we,0),this.onData(Te)):this.onData(A.shrinkBuf(Re.output,Re.next_out)))),Re.avail_in===0&&Re.avail_out===0&&(ht=!0)}while((0<Re.avail_in||Re.avail_out===0)&&se!==B.Z_STREAM_END);return se===B.Z_STREAM_END&&(oe=B.Z_FINISH),oe===B.Z_FINISH?(se=C.inflateEnd(this.strm),this.onEnd(se),this.ended=!0,se===B.Z_OK):oe!==B.Z_SYNC_FLUSH||(this.onEnd(B.Z_OK),!(Re.avail_out=0))},z.prototype.onData=function(X){this.chunks.push(X)},z.prototype.onEnd=function(X){X===B.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=A.flattenChunks(this.chunks)),this.chunks=[],this.err=X,this.msg=this.strm.msg},S.Inflate=z,S.inflate=Z,S.inflateRaw=function(X,Q){return(Q=Q||{}).raw=!0,Z(X,Q)},S.ungzip=Z},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(_,E,S){var C=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";S.assign=function(B){for(var O=Array.prototype.slice.call(arguments,1);O.length;){var N=O.shift();if(N){if(typeof N!="object")throw new TypeError(N+"must be non-object");for(var U in N)N.hasOwnProperty(U)&&(B[U]=N[U])}}return B},S.shrinkBuf=function(B,O){return B.length===O?B:B.subarray?B.subarray(0,O):(B.length=O,B)};var A={arraySet:function(B,O,N,U,j){if(O.subarray&&B.subarray)B.set(O.subarray(N,N+U),j);else for(var z=0;z<U;z++)B[j+z]=O[N+z]},flattenChunks:function(B){var O,N,U,j,z,Z;for(O=U=0,N=B.length;O<N;O++)U+=B[O].length;for(Z=new Uint8Array(U),O=j=0,N=B.length;O<N;O++)z=B[O],Z.set(z,j),j+=z.length;return Z}},I={arraySet:function(B,O,N,U,j){for(var z=0;z<U;z++)B[j+z]=O[N+z]},flattenChunks:function(B){return[].concat.apply([],B)}};S.setTyped=function(B){B?(S.Buf8=Uint8Array,S.Buf16=Uint16Array,S.Buf32=Int32Array,S.assign(S,A)):(S.Buf8=Array,S.Buf16=Array,S.Buf32=Array,S.assign(S,I))},S.setTyped(C)},{}],42:[function(_,E,S){var C=_("./common"),A=!0,I=!0;try{String.fromCharCode.apply(null,[0])}catch{A=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{I=!1}for(var B=new C.Buf8(256),O=0;O<256;O++)B[O]=252<=O?6:248<=O?5:240<=O?4:224<=O?3:192<=O?2:1;function N(U,j){if(j<65537&&(U.subarray&&I||!U.subarray&&A))return String.fromCharCode.apply(null,C.shrinkBuf(U,j));for(var z="",Z=0;Z<j;Z++)z+=String.fromCharCode(U[Z]);return z}B[254]=B[254]=1,S.string2buf=function(U){var j,z,Z,X,Q,se=U.length,oe=0;for(X=0;X<se;X++)(64512&(z=U.charCodeAt(X)))==55296&&X+1<se&&(64512&(Z=U.charCodeAt(X+1)))==56320&&(z=65536+(z-55296<<10)+(Z-56320),X++),oe+=z<128?1:z<2048?2:z<65536?3:4;for(j=new C.Buf8(oe),X=Q=0;Q<oe;X++)(64512&(z=U.charCodeAt(X)))==55296&&X+1<se&&(64512&(Z=U.charCodeAt(X+1)))==56320&&(z=65536+(z-55296<<10)+(Z-56320),X++),z<128?j[Q++]=z:(z<2048?j[Q++]=192|z>>>6:(z<65536?j[Q++]=224|z>>>12:(j[Q++]=240|z>>>18,j[Q++]=128|z>>>12&63),j[Q++]=128|z>>>6&63),j[Q++]=128|63&z);return j},S.buf2binstring=function(U){return N(U,U.length)},S.binstring2buf=function(U){for(var j=new C.Buf8(U.length),z=0,Z=j.length;z<Z;z++)j[z]=U.charCodeAt(z);return j},S.buf2string=function(U,j){var z,Z,X,Q,se=j||U.length,oe=new Array(2*se);for(z=Z=0;z<se;)if((X=U[z++])<128)oe[Z++]=X;else if(4<(Q=B[X]))oe[Z++]=65533,z+=Q-1;else{for(X&=Q===2?31:Q===3?15:7;1<Q&&z<se;)X=X<<6|63&U[z++],Q--;1<Q?oe[Z++]=65533:X<65536?oe[Z++]=X:(X-=65536,oe[Z++]=55296|X>>10&1023,oe[Z++]=56320|1023&X)}return N(oe,Z)},S.utf8border=function(U,j){var z;for((j=j||U.length)>U.length&&(j=U.length),z=j-1;0<=z&&(192&U[z])==128;)z--;return z<0||z===0?j:z+B[U[z]]>j?z:j}},{"./common":41}],43:[function(_,E,S){E.exports=function(C,A,I,B){for(var O=65535&C|0,N=C>>>16&65535|0,U=0;I!==0;){for(I-=U=2e3<I?2e3:I;N=N+(O=O+A[B++]|0)|0,--U;);O%=65521,N%=65521}return O|N<<16|0}},{}],44:[function(_,E,S){E.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(_,E,S){var C=function(){for(var A,I=[],B=0;B<256;B++){A=B;for(var O=0;O<8;O++)A=1&A?3988292384^A>>>1:A>>>1;I[B]=A}return I}();E.exports=function(A,I,B,O){var N=C,U=O+B;A^=-1;for(var j=O;j<U;j++)A=A>>>8^N[255&(A^I[j])];return-1^A}},{}],46:[function(_,E,S){var C,A=_("../utils/common"),I=_("./trees"),B=_("./adler32"),O=_("./crc32"),N=_("./messages"),U=0,j=4,z=0,Z=-2,X=-1,Q=4,se=2,oe=8,ue=9,we=286,Te=30,xe=19,Re=2*we+1,Ne=15,Fe=3,ht=258,nt=ht+Fe+1,Ee=42,Ce=113,_e=1,Ie=2,He=3,Be=4;function Ge(Ye,Ct){return Ye.msg=N[Ct],Ct}function je(Ye){return(Ye<<1)-(4<Ye?9:0)}function Ve(Ye){for(var Ct=Ye.length;0<=--Ct;)Ye[Ct]=0}function Pe(Ye){var Ct=Ye.state,Pt=Ct.pending;Pt>Ye.avail_out&&(Pt=Ye.avail_out),Pt!==0&&(A.arraySet(Ye.output,Ct.pending_buf,Ct.pending_out,Pt,Ye.next_out),Ye.next_out+=Pt,Ct.pending_out+=Pt,Ye.total_out+=Pt,Ye.avail_out-=Pt,Ct.pending-=Pt,Ct.pending===0&&(Ct.pending_out=0))}function Me(Ye,Ct){I._tr_flush_block(Ye,0<=Ye.block_start?Ye.block_start:-1,Ye.strstart-Ye.block_start,Ct),Ye.block_start=Ye.strstart,Pe(Ye.strm)}function tt(Ye,Ct){Ye.pending_buf[Ye.pending++]=Ct}function Ke(Ye,Ct){Ye.pending_buf[Ye.pending++]=Ct>>>8&255,Ye.pending_buf[Ye.pending++]=255&Ct}function mt(Ye,Ct){var Pt,St,$t=Ye.max_chain_length,kt=Ye.strstart,Ft=Ye.prev_length,qt=Ye.nice_match,Mt=Ye.strstart>Ye.w_size-nt?Ye.strstart-(Ye.w_size-nt):0,Wt=Ye.window,Zt=Ye.w_mask,Yt=Ye.prev,ur=Ye.strstart+ht,xt=Wt[kt+Ft-1],pt=Wt[kt+Ft];Ye.prev_length>=Ye.good_match&&($t>>=2),qt>Ye.lookahead&&(qt=Ye.lookahead);do if(Wt[(Pt=Ct)+Ft]===pt&&Wt[Pt+Ft-1]===xt&&Wt[Pt]===Wt[kt]&&Wt[++Pt]===Wt[kt+1]){kt+=2,Pt++;do;while(Wt[++kt]===Wt[++Pt]&&Wt[++kt]===Wt[++Pt]&&Wt[++kt]===Wt[++Pt]&&Wt[++kt]===Wt[++Pt]&&Wt[++kt]===Wt[++Pt]&&Wt[++kt]===Wt[++Pt]&&Wt[++kt]===Wt[++Pt]&&Wt[++kt]===Wt[++Pt]&&kt<ur);if(St=ht-(ur-kt),kt=ur-ht,Ft<St){if(Ye.match_start=Ct,qt<=(Ft=St))break;xt=Wt[kt+Ft-1],pt=Wt[kt+Ft]}}while((Ct=Yt[Ct&Zt])>Mt&&--$t!=0);return Ft<=Ye.lookahead?Ft:Ye.lookahead}function ct(Ye){var Ct,Pt,St,$t,kt,Ft,qt,Mt,Wt,Zt,Yt=Ye.w_size;do{if($t=Ye.window_size-Ye.lookahead-Ye.strstart,Ye.strstart>=Yt+(Yt-nt)){for(A.arraySet(Ye.window,Ye.window,Yt,Yt,0),Ye.match_start-=Yt,Ye.strstart-=Yt,Ye.block_start-=Yt,Ct=Pt=Ye.hash_size;St=Ye.head[--Ct],Ye.head[Ct]=Yt<=St?St-Yt:0,--Pt;);for(Ct=Pt=Yt;St=Ye.prev[--Ct],Ye.prev[Ct]=Yt<=St?St-Yt:0,--Pt;);$t+=Yt}if(Ye.strm.avail_in===0)break;if(Ft=Ye.strm,qt=Ye.window,Mt=Ye.strstart+Ye.lookahead,Wt=$t,Zt=void 0,Zt=Ft.avail_in,Wt<Zt&&(Zt=Wt),Pt=Zt===0?0:(Ft.avail_in-=Zt,A.arraySet(qt,Ft.input,Ft.next_in,Zt,Mt),Ft.state.wrap===1?Ft.adler=B(Ft.adler,qt,Zt,Mt):Ft.state.wrap===2&&(Ft.adler=O(Ft.adler,qt,Zt,Mt)),Ft.next_in+=Zt,Ft.total_in+=Zt,Zt),Ye.lookahead+=Pt,Ye.lookahead+Ye.insert>=Fe)for(kt=Ye.strstart-Ye.insert,Ye.ins_h=Ye.window[kt],Ye.ins_h=(Ye.ins_h<<Ye.hash_shift^Ye.window[kt+1])&Ye.hash_mask;Ye.insert&&(Ye.ins_h=(Ye.ins_h<<Ye.hash_shift^Ye.window[kt+Fe-1])&Ye.hash_mask,Ye.prev[kt&Ye.w_mask]=Ye.head[Ye.ins_h],Ye.head[Ye.ins_h]=kt,kt++,Ye.insert--,!(Ye.lookahead+Ye.insert<Fe)););}while(Ye.lookahead<nt&&Ye.strm.avail_in!==0)}function Qe(Ye,Ct){for(var Pt,St;;){if(Ye.lookahead<nt){if(ct(Ye),Ye.lookahead<nt&&Ct===U)return _e;if(Ye.lookahead===0)break}if(Pt=0,Ye.lookahead>=Fe&&(Ye.ins_h=(Ye.ins_h<<Ye.hash_shift^Ye.window[Ye.strstart+Fe-1])&Ye.hash_mask,Pt=Ye.prev[Ye.strstart&Ye.w_mask]=Ye.head[Ye.ins_h],Ye.head[Ye.ins_h]=Ye.strstart),Pt!==0&&Ye.strstart-Pt<=Ye.w_size-nt&&(Ye.match_length=mt(Ye,Pt)),Ye.match_length>=Fe)if(St=I._tr_tally(Ye,Ye.strstart-Ye.match_start,Ye.match_length-Fe),Ye.lookahead-=Ye.match_length,Ye.match_length<=Ye.max_lazy_match&&Ye.lookahead>=Fe){for(Ye.match_length--;Ye.strstart++,Ye.ins_h=(Ye.ins_h<<Ye.hash_shift^Ye.window[Ye.strstart+Fe-1])&Ye.hash_mask,Pt=Ye.prev[Ye.strstart&Ye.w_mask]=Ye.head[Ye.ins_h],Ye.head[Ye.ins_h]=Ye.strstart,--Ye.match_length!=0;);Ye.strstart++}else Ye.strstart+=Ye.match_length,Ye.match_length=0,Ye.ins_h=Ye.window[Ye.strstart],Ye.ins_h=(Ye.ins_h<<Ye.hash_shift^Ye.window[Ye.strstart+1])&Ye.hash_mask;else St=I._tr_tally(Ye,0,Ye.window[Ye.strstart]),Ye.lookahead--,Ye.strstart++;if(St&&(Me(Ye,!1),Ye.strm.avail_out===0))return _e}return Ye.insert=Ye.strstart<Fe-1?Ye.strstart:Fe-1,Ct===j?(Me(Ye,!0),Ye.strm.avail_out===0?He:Be):Ye.last_lit&&(Me(Ye,!1),Ye.strm.avail_out===0)?_e:Ie}function dt(Ye,Ct){for(var Pt,St,$t;;){if(Ye.lookahead<nt){if(ct(Ye),Ye.lookahead<nt&&Ct===U)return _e;if(Ye.lookahead===0)break}if(Pt=0,Ye.lookahead>=Fe&&(Ye.ins_h=(Ye.ins_h<<Ye.hash_shift^Ye.window[Ye.strstart+Fe-1])&Ye.hash_mask,Pt=Ye.prev[Ye.strstart&Ye.w_mask]=Ye.head[Ye.ins_h],Ye.head[Ye.ins_h]=Ye.strstart),Ye.prev_length=Ye.match_length,Ye.prev_match=Ye.match_start,Ye.match_length=Fe-1,Pt!==0&&Ye.prev_length<Ye.max_lazy_match&&Ye.strstart-Pt<=Ye.w_size-nt&&(Ye.match_length=mt(Ye,Pt),Ye.match_length<=5&&(Ye.strategy===1||Ye.match_length===Fe&&4096<Ye.strstart-Ye.match_start)&&(Ye.match_length=Fe-1)),Ye.prev_length>=Fe&&Ye.match_length<=Ye.prev_length){for($t=Ye.strstart+Ye.lookahead-Fe,St=I._tr_tally(Ye,Ye.strstart-1-Ye.prev_match,Ye.prev_length-Fe),Ye.lookahead-=Ye.prev_length-1,Ye.prev_length-=2;++Ye.strstart<=$t&&(Ye.ins_h=(Ye.ins_h<<Ye.hash_shift^Ye.window[Ye.strstart+Fe-1])&Ye.hash_mask,Pt=Ye.prev[Ye.strstart&Ye.w_mask]=Ye.head[Ye.ins_h],Ye.head[Ye.ins_h]=Ye.strstart),--Ye.prev_length!=0;);if(Ye.match_available=0,Ye.match_length=Fe-1,Ye.strstart++,St&&(Me(Ye,!1),Ye.strm.avail_out===0))return _e}else if(Ye.match_available){if((St=I._tr_tally(Ye,0,Ye.window[Ye.strstart-1]))&&Me(Ye,!1),Ye.strstart++,Ye.lookahead--,Ye.strm.avail_out===0)return _e}else Ye.match_available=1,Ye.strstart++,Ye.lookahead--}return Ye.match_available&&(St=I._tr_tally(Ye,0,Ye.window[Ye.strstart-1]),Ye.match_available=0),Ye.insert=Ye.strstart<Fe-1?Ye.strstart:Fe-1,Ct===j?(Me(Ye,!0),Ye.strm.avail_out===0?He:Be):Ye.last_lit&&(Me(Ye,!1),Ye.strm.avail_out===0)?_e:Ie}function vt(Ye,Ct,Pt,St,$t){this.good_length=Ye,this.max_lazy=Ct,this.nice_length=Pt,this.max_chain=St,this.func=$t}function At(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=oe,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new A.Buf16(2*Re),this.dyn_dtree=new A.Buf16(2*(2*Te+1)),this.bl_tree=new A.Buf16(2*(2*xe+1)),Ve(this.dyn_ltree),Ve(this.dyn_dtree),Ve(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new A.Buf16(Ne+1),this.heap=new A.Buf16(2*we+1),Ve(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new A.Buf16(2*we+1),Ve(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function bt(Ye){var Ct;return Ye&&Ye.state?(Ye.total_in=Ye.total_out=0,Ye.data_type=se,(Ct=Ye.state).pending=0,Ct.pending_out=0,Ct.wrap<0&&(Ct.wrap=-Ct.wrap),Ct.status=Ct.wrap?Ee:Ce,Ye.adler=Ct.wrap===2?0:1,Ct.last_flush=U,I._tr_init(Ct),z):Ge(Ye,Z)}function ft(Ye){var Ct=bt(Ye);return Ct===z&&function(Pt){Pt.window_size=2*Pt.w_size,Ve(Pt.head),Pt.max_lazy_match=C[Pt.level].max_lazy,Pt.good_match=C[Pt.level].good_length,Pt.nice_match=C[Pt.level].nice_length,Pt.max_chain_length=C[Pt.level].max_chain,Pt.strstart=0,Pt.block_start=0,Pt.lookahead=0,Pt.insert=0,Pt.match_length=Pt.prev_length=Fe-1,Pt.match_available=0,Pt.ins_h=0}(Ye.state),Ct}function Et(Ye,Ct,Pt,St,$t,kt){if(!Ye)return Z;var Ft=1;if(Ct===X&&(Ct=6),St<0?(Ft=0,St=-St):15<St&&(Ft=2,St-=16),$t<1||ue<$t||Pt!==oe||St<8||15<St||Ct<0||9<Ct||kt<0||Q<kt)return Ge(Ye,Z);St===8&&(St=9);var qt=new At;return(Ye.state=qt).strm=Ye,qt.wrap=Ft,qt.gzhead=null,qt.w_bits=St,qt.w_size=1<<qt.w_bits,qt.w_mask=qt.w_size-1,qt.hash_bits=$t+7,qt.hash_size=1<<qt.hash_bits,qt.hash_mask=qt.hash_size-1,qt.hash_shift=~~((qt.hash_bits+Fe-1)/Fe),qt.window=new A.Buf8(2*qt.w_size),qt.head=new A.Buf16(qt.hash_size),qt.prev=new A.Buf16(qt.w_size),qt.lit_bufsize=1<<$t+6,qt.pending_buf_size=4*qt.lit_bufsize,qt.pending_buf=new A.Buf8(qt.pending_buf_size),qt.d_buf=1*qt.lit_bufsize,qt.l_buf=3*qt.lit_bufsize,qt.level=Ct,qt.strategy=kt,qt.method=Pt,ft(Ye)}C=[new vt(0,0,0,0,function(Ye,Ct){var Pt=65535;for(Pt>Ye.pending_buf_size-5&&(Pt=Ye.pending_buf_size-5);;){if(Ye.lookahead<=1){if(ct(Ye),Ye.lookahead===0&&Ct===U)return _e;if(Ye.lookahead===0)break}Ye.strstart+=Ye.lookahead,Ye.lookahead=0;var St=Ye.block_start+Pt;if((Ye.strstart===0||Ye.strstart>=St)&&(Ye.lookahead=Ye.strstart-St,Ye.strstart=St,Me(Ye,!1),Ye.strm.avail_out===0)||Ye.strstart-Ye.block_start>=Ye.w_size-nt&&(Me(Ye,!1),Ye.strm.avail_out===0))return _e}return Ye.insert=0,Ct===j?(Me(Ye,!0),Ye.strm.avail_out===0?He:Be):(Ye.strstart>Ye.block_start&&(Me(Ye,!1),Ye.strm.avail_out),_e)}),new vt(4,4,8,4,Qe),new vt(4,5,16,8,Qe),new vt(4,6,32,32,Qe),new vt(4,4,16,16,dt),new vt(8,16,32,32,dt),new vt(8,16,128,128,dt),new vt(8,32,128,256,dt),new vt(32,128,258,1024,dt),new vt(32,258,258,4096,dt)],S.deflateInit=function(Ye,Ct){return Et(Ye,Ct,oe,15,8,0)},S.deflateInit2=Et,S.deflateReset=ft,S.deflateResetKeep=bt,S.deflateSetHeader=function(Ye,Ct){return Ye&&Ye.state?Ye.state.wrap!==2?Z:(Ye.state.gzhead=Ct,z):Z},S.deflate=function(Ye,Ct){var Pt,St,$t,kt;if(!Ye||!Ye.state||5<Ct||Ct<0)return Ye?Ge(Ye,Z):Z;if(St=Ye.state,!Ye.output||!Ye.input&&Ye.avail_in!==0||St.status===666&&Ct!==j)return Ge(Ye,Ye.avail_out===0?-5:Z);if(St.strm=Ye,Pt=St.last_flush,St.last_flush=Ct,St.status===Ee)if(St.wrap===2)Ye.adler=0,tt(St,31),tt(St,139),tt(St,8),St.gzhead?(tt(St,(St.gzhead.text?1:0)+(St.gzhead.hcrc?2:0)+(St.gzhead.extra?4:0)+(St.gzhead.name?8:0)+(St.gzhead.comment?16:0)),tt(St,255&St.gzhead.time),tt(St,St.gzhead.time>>8&255),tt(St,St.gzhead.time>>16&255),tt(St,St.gzhead.time>>24&255),tt(St,St.level===9?2:2<=St.strategy||St.level<2?4:0),tt(St,255&St.gzhead.os),St.gzhead.extra&&St.gzhead.extra.length&&(tt(St,255&St.gzhead.extra.length),tt(St,St.gzhead.extra.length>>8&255)),St.gzhead.hcrc&&(Ye.adler=O(Ye.adler,St.pending_buf,St.pending,0)),St.gzindex=0,St.status=69):(tt(St,0),tt(St,0),tt(St,0),tt(St,0),tt(St,0),tt(St,St.level===9?2:2<=St.strategy||St.level<2?4:0),tt(St,3),St.status=Ce);else{var Ft=oe+(St.w_bits-8<<4)<<8;Ft|=(2<=St.strategy||St.level<2?0:St.level<6?1:St.level===6?2:3)<<6,St.strstart!==0&&(Ft|=32),Ft+=31-Ft%31,St.status=Ce,Ke(St,Ft),St.strstart!==0&&(Ke(St,Ye.adler>>>16),Ke(St,65535&Ye.adler)),Ye.adler=1}if(St.status===69)if(St.gzhead.extra){for($t=St.pending;St.gzindex<(65535&St.gzhead.extra.length)&&(St.pending!==St.pending_buf_size||(St.gzhead.hcrc&&St.pending>$t&&(Ye.adler=O(Ye.adler,St.pending_buf,St.pending-$t,$t)),Pe(Ye),$t=St.pending,St.pending!==St.pending_buf_size));)tt(St,255&St.gzhead.extra[St.gzindex]),St.gzindex++;St.gzhead.hcrc&&St.pending>$t&&(Ye.adler=O(Ye.adler,St.pending_buf,St.pending-$t,$t)),St.gzindex===St.gzhead.extra.length&&(St.gzindex=0,St.status=73)}else St.status=73;if(St.status===73)if(St.gzhead.name){$t=St.pending;do{if(St.pending===St.pending_buf_size&&(St.gzhead.hcrc&&St.pending>$t&&(Ye.adler=O(Ye.adler,St.pending_buf,St.pending-$t,$t)),Pe(Ye),$t=St.pending,St.pending===St.pending_buf_size)){kt=1;break}kt=St.gzindex<St.gzhead.name.length?255&St.gzhead.name.charCodeAt(St.gzindex++):0,tt(St,kt)}while(kt!==0);St.gzhead.hcrc&&St.pending>$t&&(Ye.adler=O(Ye.adler,St.pending_buf,St.pending-$t,$t)),kt===0&&(St.gzindex=0,St.status=91)}else St.status=91;if(St.status===91)if(St.gzhead.comment){$t=St.pending;do{if(St.pending===St.pending_buf_size&&(St.gzhead.hcrc&&St.pending>$t&&(Ye.adler=O(Ye.adler,St.pending_buf,St.pending-$t,$t)),Pe(Ye),$t=St.pending,St.pending===St.pending_buf_size)){kt=1;break}kt=St.gzindex<St.gzhead.comment.length?255&St.gzhead.comment.charCodeAt(St.gzindex++):0,tt(St,kt)}while(kt!==0);St.gzhead.hcrc&&St.pending>$t&&(Ye.adler=O(Ye.adler,St.pending_buf,St.pending-$t,$t)),kt===0&&(St.status=103)}else St.status=103;if(St.status===103&&(St.gzhead.hcrc?(St.pending+2>St.pending_buf_size&&Pe(Ye),St.pending+2<=St.pending_buf_size&&(tt(St,255&Ye.adler),tt(St,Ye.adler>>8&255),Ye.adler=0,St.status=Ce)):St.status=Ce),St.pending!==0){if(Pe(Ye),Ye.avail_out===0)return St.last_flush=-1,z}else if(Ye.avail_in===0&&je(Ct)<=je(Pt)&&Ct!==j)return Ge(Ye,-5);if(St.status===666&&Ye.avail_in!==0)return Ge(Ye,-5);if(Ye.avail_in!==0||St.lookahead!==0||Ct!==U&&St.status!==666){var qt=St.strategy===2?function(Mt,Wt){for(var Zt;;){if(Mt.lookahead===0&&(ct(Mt),Mt.lookahead===0)){if(Wt===U)return _e;break}if(Mt.match_length=0,Zt=I._tr_tally(Mt,0,Mt.window[Mt.strstart]),Mt.lookahead--,Mt.strstart++,Zt&&(Me(Mt,!1),Mt.strm.avail_out===0))return _e}return Mt.insert=0,Wt===j?(Me(Mt,!0),Mt.strm.avail_out===0?He:Be):Mt.last_lit&&(Me(Mt,!1),Mt.strm.avail_out===0)?_e:Ie}(St,Ct):St.strategy===3?function(Mt,Wt){for(var Zt,Yt,ur,xt,pt=Mt.window;;){if(Mt.lookahead<=ht){if(ct(Mt),Mt.lookahead<=ht&&Wt===U)return _e;if(Mt.lookahead===0)break}if(Mt.match_length=0,Mt.lookahead>=Fe&&0<Mt.strstart&&(Yt=pt[ur=Mt.strstart-1])===pt[++ur]&&Yt===pt[++ur]&&Yt===pt[++ur]){xt=Mt.strstart+ht;do;while(Yt===pt[++ur]&&Yt===pt[++ur]&&Yt===pt[++ur]&&Yt===pt[++ur]&&Yt===pt[++ur]&&Yt===pt[++ur]&&Yt===pt[++ur]&&Yt===pt[++ur]&&ur<xt);Mt.match_length=ht-(xt-ur),Mt.match_length>Mt.lookahead&&(Mt.match_length=Mt.lookahead)}if(Mt.match_length>=Fe?(Zt=I._tr_tally(Mt,1,Mt.match_length-Fe),Mt.lookahead-=Mt.match_length,Mt.strstart+=Mt.match_length,Mt.match_length=0):(Zt=I._tr_tally(Mt,0,Mt.window[Mt.strstart]),Mt.lookahead--,Mt.strstart++),Zt&&(Me(Mt,!1),Mt.strm.avail_out===0))return _e}return Mt.insert=0,Wt===j?(Me(Mt,!0),Mt.strm.avail_out===0?He:Be):Mt.last_lit&&(Me(Mt,!1),Mt.strm.avail_out===0)?_e:Ie}(St,Ct):C[St.level].func(St,Ct);if(qt!==He&&qt!==Be||(St.status=666),qt===_e||qt===He)return Ye.avail_out===0&&(St.last_flush=-1),z;if(qt===Ie&&(Ct===1?I._tr_align(St):Ct!==5&&(I._tr_stored_block(St,0,0,!1),Ct===3&&(Ve(St.head),St.lookahead===0&&(St.strstart=0,St.block_start=0,St.insert=0))),Pe(Ye),Ye.avail_out===0))return St.last_flush=-1,z}return Ct!==j?z:St.wrap<=0?1:(St.wrap===2?(tt(St,255&Ye.adler),tt(St,Ye.adler>>8&255),tt(St,Ye.adler>>16&255),tt(St,Ye.adler>>24&255),tt(St,255&Ye.total_in),tt(St,Ye.total_in>>8&255),tt(St,Ye.total_in>>16&255),tt(St,Ye.total_in>>24&255)):(Ke(St,Ye.adler>>>16),Ke(St,65535&Ye.adler)),Pe(Ye),0<St.wrap&&(St.wrap=-St.wrap),St.pending!==0?z:1)},S.deflateEnd=function(Ye){var Ct;return Ye&&Ye.state?(Ct=Ye.state.status)!==Ee&&Ct!==69&&Ct!==73&&Ct!==91&&Ct!==103&&Ct!==Ce&&Ct!==666?Ge(Ye,Z):(Ye.state=null,Ct===Ce?Ge(Ye,-3):z):Z},S.deflateSetDictionary=function(Ye,Ct){var Pt,St,$t,kt,Ft,qt,Mt,Wt,Zt=Ct.length;if(!Ye||!Ye.state||(kt=(Pt=Ye.state).wrap)===2||kt===1&&Pt.status!==Ee||Pt.lookahead)return Z;for(kt===1&&(Ye.adler=B(Ye.adler,Ct,Zt,0)),Pt.wrap=0,Zt>=Pt.w_size&&(kt===0&&(Ve(Pt.head),Pt.strstart=0,Pt.block_start=0,Pt.insert=0),Wt=new A.Buf8(Pt.w_size),A.arraySet(Wt,Ct,Zt-Pt.w_size,Pt.w_size,0),Ct=Wt,Zt=Pt.w_size),Ft=Ye.avail_in,qt=Ye.next_in,Mt=Ye.input,Ye.avail_in=Zt,Ye.next_in=0,Ye.input=Ct,ct(Pt);Pt.lookahead>=Fe;){for(St=Pt.strstart,$t=Pt.lookahead-(Fe-1);Pt.ins_h=(Pt.ins_h<<Pt.hash_shift^Pt.window[St+Fe-1])&Pt.hash_mask,Pt.prev[St&Pt.w_mask]=Pt.head[Pt.ins_h],Pt.head[Pt.ins_h]=St,St++,--$t;);Pt.strstart=St,Pt.lookahead=Fe-1,ct(Pt)}return Pt.strstart+=Pt.lookahead,Pt.block_start=Pt.strstart,Pt.insert=Pt.lookahead,Pt.lookahead=0,Pt.match_length=Pt.prev_length=Fe-1,Pt.match_available=0,Ye.next_in=qt,Ye.input=Mt,Ye.avail_in=Ft,Pt.wrap=kt,z},S.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(_,E,S){E.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(_,E,S){E.exports=function(C,A){var I,B,O,N,U,j,z,Z,X,Q,se,oe,ue,we,Te,xe,Re,Ne,Fe,ht,nt,Ee,Ce,_e,Ie;I=C.state,B=C.next_in,_e=C.input,O=B+(C.avail_in-5),N=C.next_out,Ie=C.output,U=N-(A-C.avail_out),j=N+(C.avail_out-257),z=I.dmax,Z=I.wsize,X=I.whave,Q=I.wnext,se=I.window,oe=I.hold,ue=I.bits,we=I.lencode,Te=I.distcode,xe=(1<<I.lenbits)-1,Re=(1<<I.distbits)-1;e:do{ue<15&&(oe+=_e[B++]<<ue,ue+=8,oe+=_e[B++]<<ue,ue+=8),Ne=we[oe&xe];t:for(;;){if(oe>>>=Fe=Ne>>>24,ue-=Fe,(Fe=Ne>>>16&255)===0)Ie[N++]=65535&Ne;else{if(!(16&Fe)){if(!(64&Fe)){Ne=we[(65535&Ne)+(oe&(1<<Fe)-1)];continue t}if(32&Fe){I.mode=12;break e}C.msg="invalid literal/length code",I.mode=30;break e}ht=65535&Ne,(Fe&=15)&&(ue<Fe&&(oe+=_e[B++]<<ue,ue+=8),ht+=oe&(1<<Fe)-1,oe>>>=Fe,ue-=Fe),ue<15&&(oe+=_e[B++]<<ue,ue+=8,oe+=_e[B++]<<ue,ue+=8),Ne=Te[oe&Re];r:for(;;){if(oe>>>=Fe=Ne>>>24,ue-=Fe,!(16&(Fe=Ne>>>16&255))){if(!(64&Fe)){Ne=Te[(65535&Ne)+(oe&(1<<Fe)-1)];continue r}C.msg="invalid distance code",I.mode=30;break e}if(nt=65535&Ne,ue<(Fe&=15)&&(oe+=_e[B++]<<ue,(ue+=8)<Fe&&(oe+=_e[B++]<<ue,ue+=8)),z<(nt+=oe&(1<<Fe)-1)){C.msg="invalid distance too far back",I.mode=30;break e}if(oe>>>=Fe,ue-=Fe,(Fe=N-U)<nt){if(X<(Fe=nt-Fe)&&I.sane){C.msg="invalid distance too far back",I.mode=30;break e}if(Ce=se,(Ee=0)===Q){if(Ee+=Z-Fe,Fe<ht){for(ht-=Fe;Ie[N++]=se[Ee++],--Fe;);Ee=N-nt,Ce=Ie}}else if(Q<Fe){if(Ee+=Z+Q-Fe,(Fe-=Q)<ht){for(ht-=Fe;Ie[N++]=se[Ee++],--Fe;);if(Ee=0,Q<ht){for(ht-=Fe=Q;Ie[N++]=se[Ee++],--Fe;);Ee=N-nt,Ce=Ie}}}else if(Ee+=Q-Fe,Fe<ht){for(ht-=Fe;Ie[N++]=se[Ee++],--Fe;);Ee=N-nt,Ce=Ie}for(;2<ht;)Ie[N++]=Ce[Ee++],Ie[N++]=Ce[Ee++],Ie[N++]=Ce[Ee++],ht-=3;ht&&(Ie[N++]=Ce[Ee++],1<ht&&(Ie[N++]=Ce[Ee++]))}else{for(Ee=N-nt;Ie[N++]=Ie[Ee++],Ie[N++]=Ie[Ee++],Ie[N++]=Ie[Ee++],2<(ht-=3););ht&&(Ie[N++]=Ie[Ee++],1<ht&&(Ie[N++]=Ie[Ee++]))}break}}break}}while(B<O&&N<j);B-=ht=ue>>3,oe&=(1<<(ue-=ht<<3))-1,C.next_in=B,C.next_out=N,C.avail_in=B<O?O-B+5:5-(B-O),C.avail_out=N<j?j-N+257:257-(N-j),I.hold=oe,I.bits=ue}},{}],49:[function(_,E,S){var C=_("../utils/common"),A=_("./adler32"),I=_("./crc32"),B=_("./inffast"),O=_("./inftrees"),N=1,U=2,j=0,z=-2,Z=1,X=852,Q=592;function se(Ee){return(Ee>>>24&255)+(Ee>>>8&65280)+((65280&Ee)<<8)+((255&Ee)<<24)}function oe(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new C.Buf16(320),this.work=new C.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function ue(Ee){var Ce;return Ee&&Ee.state?(Ce=Ee.state,Ee.total_in=Ee.total_out=Ce.total=0,Ee.msg="",Ce.wrap&&(Ee.adler=1&Ce.wrap),Ce.mode=Z,Ce.last=0,Ce.havedict=0,Ce.dmax=32768,Ce.head=null,Ce.hold=0,Ce.bits=0,Ce.lencode=Ce.lendyn=new C.Buf32(X),Ce.distcode=Ce.distdyn=new C.Buf32(Q),Ce.sane=1,Ce.back=-1,j):z}function we(Ee){var Ce;return Ee&&Ee.state?((Ce=Ee.state).wsize=0,Ce.whave=0,Ce.wnext=0,ue(Ee)):z}function Te(Ee,Ce){var _e,Ie;return Ee&&Ee.state?(Ie=Ee.state,Ce<0?(_e=0,Ce=-Ce):(_e=1+(Ce>>4),Ce<48&&(Ce&=15)),Ce&&(Ce<8||15<Ce)?z:(Ie.window!==null&&Ie.wbits!==Ce&&(Ie.window=null),Ie.wrap=_e,Ie.wbits=Ce,we(Ee))):z}function xe(Ee,Ce){var _e,Ie;return Ee?(Ie=new oe,(Ee.state=Ie).window=null,(_e=Te(Ee,Ce))!==j&&(Ee.state=null),_e):z}var Re,Ne,Fe=!0;function ht(Ee){if(Fe){var Ce;for(Re=new C.Buf32(512),Ne=new C.Buf32(32),Ce=0;Ce<144;)Ee.lens[Ce++]=8;for(;Ce<256;)Ee.lens[Ce++]=9;for(;Ce<280;)Ee.lens[Ce++]=7;for(;Ce<288;)Ee.lens[Ce++]=8;for(O(N,Ee.lens,0,288,Re,0,Ee.work,{bits:9}),Ce=0;Ce<32;)Ee.lens[Ce++]=5;O(U,Ee.lens,0,32,Ne,0,Ee.work,{bits:5}),Fe=!1}Ee.lencode=Re,Ee.lenbits=9,Ee.distcode=Ne,Ee.distbits=5}function nt(Ee,Ce,_e,Ie){var He,Be=Ee.state;return Be.window===null&&(Be.wsize=1<<Be.wbits,Be.wnext=0,Be.whave=0,Be.window=new C.Buf8(Be.wsize)),Ie>=Be.wsize?(C.arraySet(Be.window,Ce,_e-Be.wsize,Be.wsize,0),Be.wnext=0,Be.whave=Be.wsize):(Ie<(He=Be.wsize-Be.wnext)&&(He=Ie),C.arraySet(Be.window,Ce,_e-Ie,He,Be.wnext),(Ie-=He)?(C.arraySet(Be.window,Ce,_e-Ie,Ie,0),Be.wnext=Ie,Be.whave=Be.wsize):(Be.wnext+=He,Be.wnext===Be.wsize&&(Be.wnext=0),Be.whave<Be.wsize&&(Be.whave+=He))),0}S.inflateReset=we,S.inflateReset2=Te,S.inflateResetKeep=ue,S.inflateInit=function(Ee){return xe(Ee,15)},S.inflateInit2=xe,S.inflate=function(Ee,Ce){var _e,Ie,He,Be,Ge,je,Ve,Pe,Me,tt,Ke,mt,ct,Qe,dt,vt,At,bt,ft,Et,Ye,Ct,Pt,St,$t=0,kt=new C.Buf8(4),Ft=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!Ee||!Ee.state||!Ee.output||!Ee.input&&Ee.avail_in!==0)return z;(_e=Ee.state).mode===12&&(_e.mode=13),Ge=Ee.next_out,He=Ee.output,Ve=Ee.avail_out,Be=Ee.next_in,Ie=Ee.input,je=Ee.avail_in,Pe=_e.hold,Me=_e.bits,tt=je,Ke=Ve,Ct=j;e:for(;;)switch(_e.mode){case Z:if(_e.wrap===0){_e.mode=13;break}for(;Me<16;){if(je===0)break e;je--,Pe+=Ie[Be++]<<Me,Me+=8}if(2&_e.wrap&&Pe===35615){kt[_e.check=0]=255&Pe,kt[1]=Pe>>>8&255,_e.check=I(_e.check,kt,2,0),Me=Pe=0,_e.mode=2;break}if(_e.flags=0,_e.head&&(_e.head.done=!1),!(1&_e.wrap)||(((255&Pe)<<8)+(Pe>>8))%31){Ee.msg="incorrect header check",_e.mode=30;break}if((15&Pe)!=8){Ee.msg="unknown compression method",_e.mode=30;break}if(Me-=4,Ye=8+(15&(Pe>>>=4)),_e.wbits===0)_e.wbits=Ye;else if(Ye>_e.wbits){Ee.msg="invalid window size",_e.mode=30;break}_e.dmax=1<<Ye,Ee.adler=_e.check=1,_e.mode=512&Pe?10:12,Me=Pe=0;break;case 2:for(;Me<16;){if(je===0)break e;je--,Pe+=Ie[Be++]<<Me,Me+=8}if(_e.flags=Pe,(255&_e.flags)!=8){Ee.msg="unknown compression method",_e.mode=30;break}if(57344&_e.flags){Ee.msg="unknown header flags set",_e.mode=30;break}_e.head&&(_e.head.text=Pe>>8&1),512&_e.flags&&(kt[0]=255&Pe,kt[1]=Pe>>>8&255,_e.check=I(_e.check,kt,2,0)),Me=Pe=0,_e.mode=3;case 3:for(;Me<32;){if(je===0)break e;je--,Pe+=Ie[Be++]<<Me,Me+=8}_e.head&&(_e.head.time=Pe),512&_e.flags&&(kt[0]=255&Pe,kt[1]=Pe>>>8&255,kt[2]=Pe>>>16&255,kt[3]=Pe>>>24&255,_e.check=I(_e.check,kt,4,0)),Me=Pe=0,_e.mode=4;case 4:for(;Me<16;){if(je===0)break e;je--,Pe+=Ie[Be++]<<Me,Me+=8}_e.head&&(_e.head.xflags=255&Pe,_e.head.os=Pe>>8),512&_e.flags&&(kt[0]=255&Pe,kt[1]=Pe>>>8&255,_e.check=I(_e.check,kt,2,0)),Me=Pe=0,_e.mode=5;case 5:if(1024&_e.flags){for(;Me<16;){if(je===0)break e;je--,Pe+=Ie[Be++]<<Me,Me+=8}_e.length=Pe,_e.head&&(_e.head.extra_len=Pe),512&_e.flags&&(kt[0]=255&Pe,kt[1]=Pe>>>8&255,_e.check=I(_e.check,kt,2,0)),Me=Pe=0}else _e.head&&(_e.head.extra=null);_e.mode=6;case 6:if(1024&_e.flags&&(je<(mt=_e.length)&&(mt=je),mt&&(_e.head&&(Ye=_e.head.extra_len-_e.length,_e.head.extra||(_e.head.extra=new Array(_e.head.extra_len)),C.arraySet(_e.head.extra,Ie,Be,mt,Ye)),512&_e.flags&&(_e.check=I(_e.check,Ie,mt,Be)),je-=mt,Be+=mt,_e.length-=mt),_e.length))break e;_e.length=0,_e.mode=7;case 7:if(2048&_e.flags){if(je===0)break e;for(mt=0;Ye=Ie[Be+mt++],_e.head&&Ye&&_e.length<65536&&(_e.head.name+=String.fromCharCode(Ye)),Ye&&mt<je;);if(512&_e.flags&&(_e.check=I(_e.check,Ie,mt,Be)),je-=mt,Be+=mt,Ye)break e}else _e.head&&(_e.head.name=null);_e.length=0,_e.mode=8;case 8:if(4096&_e.flags){if(je===0)break e;for(mt=0;Ye=Ie[Be+mt++],_e.head&&Ye&&_e.length<65536&&(_e.head.comment+=String.fromCharCode(Ye)),Ye&&mt<je;);if(512&_e.flags&&(_e.check=I(_e.check,Ie,mt,Be)),je-=mt,Be+=mt,Ye)break e}else _e.head&&(_e.head.comment=null);_e.mode=9;case 9:if(512&_e.flags){for(;Me<16;){if(je===0)break e;je--,Pe+=Ie[Be++]<<Me,Me+=8}if(Pe!==(65535&_e.check)){Ee.msg="header crc mismatch",_e.mode=30;break}Me=Pe=0}_e.head&&(_e.head.hcrc=_e.flags>>9&1,_e.head.done=!0),Ee.adler=_e.check=0,_e.mode=12;break;case 10:for(;Me<32;){if(je===0)break e;je--,Pe+=Ie[Be++]<<Me,Me+=8}Ee.adler=_e.check=se(Pe),Me=Pe=0,_e.mode=11;case 11:if(_e.havedict===0)return Ee.next_out=Ge,Ee.avail_out=Ve,Ee.next_in=Be,Ee.avail_in=je,_e.hold=Pe,_e.bits=Me,2;Ee.adler=_e.check=1,_e.mode=12;case 12:if(Ce===5||Ce===6)break e;case 13:if(_e.last){Pe>>>=7&Me,Me-=7&Me,_e.mode=27;break}for(;Me<3;){if(je===0)break e;je--,Pe+=Ie[Be++]<<Me,Me+=8}switch(_e.last=1&Pe,Me-=1,3&(Pe>>>=1)){case 0:_e.mode=14;break;case 1:if(ht(_e),_e.mode=20,Ce!==6)break;Pe>>>=2,Me-=2;break e;case 2:_e.mode=17;break;case 3:Ee.msg="invalid block type",_e.mode=30}Pe>>>=2,Me-=2;break;case 14:for(Pe>>>=7&Me,Me-=7&Me;Me<32;){if(je===0)break e;je--,Pe+=Ie[Be++]<<Me,Me+=8}if((65535&Pe)!=(Pe>>>16^65535)){Ee.msg="invalid stored block lengths",_e.mode=30;break}if(_e.length=65535&Pe,Me=Pe=0,_e.mode=15,Ce===6)break e;case 15:_e.mode=16;case 16:if(mt=_e.length){if(je<mt&&(mt=je),Ve<mt&&(mt=Ve),mt===0)break e;C.arraySet(He,Ie,Be,mt,Ge),je-=mt,Be+=mt,Ve-=mt,Ge+=mt,_e.length-=mt;break}_e.mode=12;break;case 17:for(;Me<14;){if(je===0)break e;je--,Pe+=Ie[Be++]<<Me,Me+=8}if(_e.nlen=257+(31&Pe),Pe>>>=5,Me-=5,_e.ndist=1+(31&Pe),Pe>>>=5,Me-=5,_e.ncode=4+(15&Pe),Pe>>>=4,Me-=4,286<_e.nlen||30<_e.ndist){Ee.msg="too many length or distance symbols",_e.mode=30;break}_e.have=0,_e.mode=18;case 18:for(;_e.have<_e.ncode;){for(;Me<3;){if(je===0)break e;je--,Pe+=Ie[Be++]<<Me,Me+=8}_e.lens[Ft[_e.have++]]=7&Pe,Pe>>>=3,Me-=3}for(;_e.have<19;)_e.lens[Ft[_e.have++]]=0;if(_e.lencode=_e.lendyn,_e.lenbits=7,Pt={bits:_e.lenbits},Ct=O(0,_e.lens,0,19,_e.lencode,0,_e.work,Pt),_e.lenbits=Pt.bits,Ct){Ee.msg="invalid code lengths set",_e.mode=30;break}_e.have=0,_e.mode=19;case 19:for(;_e.have<_e.nlen+_e.ndist;){for(;vt=($t=_e.lencode[Pe&(1<<_e.lenbits)-1])>>>16&255,At=65535&$t,!((dt=$t>>>24)<=Me);){if(je===0)break e;je--,Pe+=Ie[Be++]<<Me,Me+=8}if(At<16)Pe>>>=dt,Me-=dt,_e.lens[_e.have++]=At;else{if(At===16){for(St=dt+2;Me<St;){if(je===0)break e;je--,Pe+=Ie[Be++]<<Me,Me+=8}if(Pe>>>=dt,Me-=dt,_e.have===0){Ee.msg="invalid bit length repeat",_e.mode=30;break}Ye=_e.lens[_e.have-1],mt=3+(3&Pe),Pe>>>=2,Me-=2}else if(At===17){for(St=dt+3;Me<St;){if(je===0)break e;je--,Pe+=Ie[Be++]<<Me,Me+=8}Me-=dt,Ye=0,mt=3+(7&(Pe>>>=dt)),Pe>>>=3,Me-=3}else{for(St=dt+7;Me<St;){if(je===0)break e;je--,Pe+=Ie[Be++]<<Me,Me+=8}Me-=dt,Ye=0,mt=11+(127&(Pe>>>=dt)),Pe>>>=7,Me-=7}if(_e.have+mt>_e.nlen+_e.ndist){Ee.msg="invalid bit length repeat",_e.mode=30;break}for(;mt--;)_e.lens[_e.have++]=Ye}}if(_e.mode===30)break;if(_e.lens[256]===0){Ee.msg="invalid code -- missing end-of-block",_e.mode=30;break}if(_e.lenbits=9,Pt={bits:_e.lenbits},Ct=O(N,_e.lens,0,_e.nlen,_e.lencode,0,_e.work,Pt),_e.lenbits=Pt.bits,Ct){Ee.msg="invalid literal/lengths set",_e.mode=30;break}if(_e.distbits=6,_e.distcode=_e.distdyn,Pt={bits:_e.distbits},Ct=O(U,_e.lens,_e.nlen,_e.ndist,_e.distcode,0,_e.work,Pt),_e.distbits=Pt.bits,Ct){Ee.msg="invalid distances set",_e.mode=30;break}if(_e.mode=20,Ce===6)break e;case 20:_e.mode=21;case 21:if(6<=je&&258<=Ve){Ee.next_out=Ge,Ee.avail_out=Ve,Ee.next_in=Be,Ee.avail_in=je,_e.hold=Pe,_e.bits=Me,B(Ee,Ke),Ge=Ee.next_out,He=Ee.output,Ve=Ee.avail_out,Be=Ee.next_in,Ie=Ee.input,je=Ee.avail_in,Pe=_e.hold,Me=_e.bits,_e.mode===12&&(_e.back=-1);break}for(_e.back=0;vt=($t=_e.lencode[Pe&(1<<_e.lenbits)-1])>>>16&255,At=65535&$t,!((dt=$t>>>24)<=Me);){if(je===0)break e;je--,Pe+=Ie[Be++]<<Me,Me+=8}if(vt&&!(240&vt)){for(bt=dt,ft=vt,Et=At;vt=($t=_e.lencode[Et+((Pe&(1<<bt+ft)-1)>>bt)])>>>16&255,At=65535&$t,!(bt+(dt=$t>>>24)<=Me);){if(je===0)break e;je--,Pe+=Ie[Be++]<<Me,Me+=8}Pe>>>=bt,Me-=bt,_e.back+=bt}if(Pe>>>=dt,Me-=dt,_e.back+=dt,_e.length=At,vt===0){_e.mode=26;break}if(32&vt){_e.back=-1,_e.mode=12;break}if(64&vt){Ee.msg="invalid literal/length code",_e.mode=30;break}_e.extra=15&vt,_e.mode=22;case 22:if(_e.extra){for(St=_e.extra;Me<St;){if(je===0)break e;je--,Pe+=Ie[Be++]<<Me,Me+=8}_e.length+=Pe&(1<<_e.extra)-1,Pe>>>=_e.extra,Me-=_e.extra,_e.back+=_e.extra}_e.was=_e.length,_e.mode=23;case 23:for(;vt=($t=_e.distcode[Pe&(1<<_e.distbits)-1])>>>16&255,At=65535&$t,!((dt=$t>>>24)<=Me);){if(je===0)break e;je--,Pe+=Ie[Be++]<<Me,Me+=8}if(!(240&vt)){for(bt=dt,ft=vt,Et=At;vt=($t=_e.distcode[Et+((Pe&(1<<bt+ft)-1)>>bt)])>>>16&255,At=65535&$t,!(bt+(dt=$t>>>24)<=Me);){if(je===0)break e;je--,Pe+=Ie[Be++]<<Me,Me+=8}Pe>>>=bt,Me-=bt,_e.back+=bt}if(Pe>>>=dt,Me-=dt,_e.back+=dt,64&vt){Ee.msg="invalid distance code",_e.mode=30;break}_e.offset=At,_e.extra=15&vt,_e.mode=24;case 24:if(_e.extra){for(St=_e.extra;Me<St;){if(je===0)break e;je--,Pe+=Ie[Be++]<<Me,Me+=8}_e.offset+=Pe&(1<<_e.extra)-1,Pe>>>=_e.extra,Me-=_e.extra,_e.back+=_e.extra}if(_e.offset>_e.dmax){Ee.msg="invalid distance too far back",_e.mode=30;break}_e.mode=25;case 25:if(Ve===0)break e;if(mt=Ke-Ve,_e.offset>mt){if((mt=_e.offset-mt)>_e.whave&&_e.sane){Ee.msg="invalid distance too far back",_e.mode=30;break}ct=mt>_e.wnext?(mt-=_e.wnext,_e.wsize-mt):_e.wnext-mt,mt>_e.length&&(mt=_e.length),Qe=_e.window}else Qe=He,ct=Ge-_e.offset,mt=_e.length;for(Ve<mt&&(mt=Ve),Ve-=mt,_e.length-=mt;He[Ge++]=Qe[ct++],--mt;);_e.length===0&&(_e.mode=21);break;case 26:if(Ve===0)break e;He[Ge++]=_e.length,Ve--,_e.mode=21;break;case 27:if(_e.wrap){for(;Me<32;){if(je===0)break e;je--,Pe|=Ie[Be++]<<Me,Me+=8}if(Ke-=Ve,Ee.total_out+=Ke,_e.total+=Ke,Ke&&(Ee.adler=_e.check=_e.flags?I(_e.check,He,Ke,Ge-Ke):A(_e.check,He,Ke,Ge-Ke)),Ke=Ve,(_e.flags?Pe:se(Pe))!==_e.check){Ee.msg="incorrect data check",_e.mode=30;break}Me=Pe=0}_e.mode=28;case 28:if(_e.wrap&&_e.flags){for(;Me<32;){if(je===0)break e;je--,Pe+=Ie[Be++]<<Me,Me+=8}if(Pe!==(4294967295&_e.total)){Ee.msg="incorrect length check",_e.mode=30;break}Me=Pe=0}_e.mode=29;case 29:Ct=1;break e;case 30:Ct=-3;break e;case 31:return-4;case 32:default:return z}return Ee.next_out=Ge,Ee.avail_out=Ve,Ee.next_in=Be,Ee.avail_in=je,_e.hold=Pe,_e.bits=Me,(_e.wsize||Ke!==Ee.avail_out&&_e.mode<30&&(_e.mode<27||Ce!==4))&&nt(Ee,Ee.output,Ee.next_out,Ke-Ee.avail_out)?(_e.mode=31,-4):(tt-=Ee.avail_in,Ke-=Ee.avail_out,Ee.total_in+=tt,Ee.total_out+=Ke,_e.total+=Ke,_e.wrap&&Ke&&(Ee.adler=_e.check=_e.flags?I(_e.check,He,Ke,Ee.next_out-Ke):A(_e.check,He,Ke,Ee.next_out-Ke)),Ee.data_type=_e.bits+(_e.last?64:0)+(_e.mode===12?128:0)+(_e.mode===20||_e.mode===15?256:0),(tt==0&&Ke===0||Ce===4)&&Ct===j&&(Ct=-5),Ct)},S.inflateEnd=function(Ee){if(!Ee||!Ee.state)return z;var Ce=Ee.state;return Ce.window&&(Ce.window=null),Ee.state=null,j},S.inflateGetHeader=function(Ee,Ce){var _e;return Ee&&Ee.state&&2&(_e=Ee.state).wrap?((_e.head=Ce).done=!1,j):z},S.inflateSetDictionary=function(Ee,Ce){var _e,Ie=Ce.length;return Ee&&Ee.state?(_e=Ee.state).wrap!==0&&_e.mode!==11?z:_e.mode===11&&A(1,Ce,Ie,0)!==_e.check?-3:nt(Ee,Ce,Ie,Ie)?(_e.mode=31,-4):(_e.havedict=1,j):z},S.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(_,E,S){var C=_("../utils/common"),A=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],I=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],B=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],O=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];E.exports=function(N,U,j,z,Z,X,Q,se){var oe,ue,we,Te,xe,Re,Ne,Fe,ht,nt=se.bits,Ee=0,Ce=0,_e=0,Ie=0,He=0,Be=0,Ge=0,je=0,Ve=0,Pe=0,Me=null,tt=0,Ke=new C.Buf16(16),mt=new C.Buf16(16),ct=null,Qe=0;for(Ee=0;Ee<=15;Ee++)Ke[Ee]=0;for(Ce=0;Ce<z;Ce++)Ke[U[j+Ce]]++;for(He=nt,Ie=15;1<=Ie&&Ke[Ie]===0;Ie--);if(Ie<He&&(He=Ie),Ie===0)return Z[X++]=20971520,Z[X++]=20971520,se.bits=1,0;for(_e=1;_e<Ie&&Ke[_e]===0;_e++);for(He<_e&&(He=_e),Ee=je=1;Ee<=15;Ee++)if(je<<=1,(je-=Ke[Ee])<0)return-1;if(0<je&&(N===0||Ie!==1))return-1;for(mt[1]=0,Ee=1;Ee<15;Ee++)mt[Ee+1]=mt[Ee]+Ke[Ee];for(Ce=0;Ce<z;Ce++)U[j+Ce]!==0&&(Q[mt[U[j+Ce]]++]=Ce);if(Re=N===0?(Me=ct=Q,19):N===1?(Me=A,tt-=257,ct=I,Qe-=257,256):(Me=B,ct=O,-1),Ee=_e,xe=X,Ge=Ce=Pe=0,we=-1,Te=(Ve=1<<(Be=He))-1,N===1&&852<Ve||N===2&&592<Ve)return 1;for(;;){for(Ne=Ee-Ge,ht=Q[Ce]<Re?(Fe=0,Q[Ce]):Q[Ce]>Re?(Fe=ct[Qe+Q[Ce]],Me[tt+Q[Ce]]):(Fe=96,0),oe=1<<Ee-Ge,_e=ue=1<<Be;Z[xe+(Pe>>Ge)+(ue-=oe)]=Ne<<24|Fe<<16|ht|0,ue!==0;);for(oe=1<<Ee-1;Pe&oe;)oe>>=1;if(oe!==0?(Pe&=oe-1,Pe+=oe):Pe=0,Ce++,--Ke[Ee]==0){if(Ee===Ie)break;Ee=U[j+Q[Ce]]}if(He<Ee&&(Pe&Te)!==we){for(Ge===0&&(Ge=He),xe+=_e,je=1<<(Be=Ee-Ge);Be+Ge<Ie&&!((je-=Ke[Be+Ge])<=0);)Be++,je<<=1;if(Ve+=1<<Be,N===1&&852<Ve||N===2&&592<Ve)return 1;Z[we=Pe&Te]=He<<24|Be<<16|xe-X|0}}return Pe!==0&&(Z[xe+Pe]=Ee-Ge<<24|64<<16|0),se.bits=He,0}},{"../utils/common":41}],51:[function(_,E,S){E.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(_,E,S){var C=_("../utils/common"),A=0,I=1;function B($t){for(var kt=$t.length;0<=--kt;)$t[kt]=0}var O=0,N=29,U=256,j=U+1+N,z=30,Z=19,X=2*j+1,Q=15,se=16,oe=7,ue=256,we=16,Te=17,xe=18,Re=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],Ne=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],Fe=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],ht=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],nt=new Array(2*(j+2));B(nt);var Ee=new Array(2*z);B(Ee);var Ce=new Array(512);B(Ce);var _e=new Array(256);B(_e);var Ie=new Array(N);B(Ie);var He,Be,Ge,je=new Array(z);function Ve($t,kt,Ft,qt,Mt){this.static_tree=$t,this.extra_bits=kt,this.extra_base=Ft,this.elems=qt,this.max_length=Mt,this.has_stree=$t&&$t.length}function Pe($t,kt){this.dyn_tree=$t,this.max_code=0,this.stat_desc=kt}function Me($t){return $t<256?Ce[$t]:Ce[256+($t>>>7)]}function tt($t,kt){$t.pending_buf[$t.pending++]=255&kt,$t.pending_buf[$t.pending++]=kt>>>8&255}function Ke($t,kt,Ft){$t.bi_valid>se-Ft?($t.bi_buf|=kt<<$t.bi_valid&65535,tt($t,$t.bi_buf),$t.bi_buf=kt>>se-$t.bi_valid,$t.bi_valid+=Ft-se):($t.bi_buf|=kt<<$t.bi_valid&65535,$t.bi_valid+=Ft)}function mt($t,kt,Ft){Ke($t,Ft[2*kt],Ft[2*kt+1])}function ct($t,kt){for(var Ft=0;Ft|=1&$t,$t>>>=1,Ft<<=1,0<--kt;);return Ft>>>1}function Qe($t,kt,Ft){var qt,Mt,Wt=new Array(Q+1),Zt=0;for(qt=1;qt<=Q;qt++)Wt[qt]=Zt=Zt+Ft[qt-1]<<1;for(Mt=0;Mt<=kt;Mt++){var Yt=$t[2*Mt+1];Yt!==0&&($t[2*Mt]=ct(Wt[Yt]++,Yt))}}function dt($t){var kt;for(kt=0;kt<j;kt++)$t.dyn_ltree[2*kt]=0;for(kt=0;kt<z;kt++)$t.dyn_dtree[2*kt]=0;for(kt=0;kt<Z;kt++)$t.bl_tree[2*kt]=0;$t.dyn_ltree[2*ue]=1,$t.opt_len=$t.static_len=0,$t.last_lit=$t.matches=0}function vt($t){8<$t.bi_valid?tt($t,$t.bi_buf):0<$t.bi_valid&&($t.pending_buf[$t.pending++]=$t.bi_buf),$t.bi_buf=0,$t.bi_valid=0}function At($t,kt,Ft,qt){var Mt=2*kt,Wt=2*Ft;return $t[Mt]<$t[Wt]||$t[Mt]===$t[Wt]&&qt[kt]<=qt[Ft]}function bt($t,kt,Ft){for(var qt=$t.heap[Ft],Mt=Ft<<1;Mt<=$t.heap_len&&(Mt<$t.heap_len&&At(kt,$t.heap[Mt+1],$t.heap[Mt],$t.depth)&&Mt++,!At(kt,qt,$t.heap[Mt],$t.depth));)$t.heap[Ft]=$t.heap[Mt],Ft=Mt,Mt<<=1;$t.heap[Ft]=qt}function ft($t,kt,Ft){var qt,Mt,Wt,Zt,Yt=0;if($t.last_lit!==0)for(;qt=$t.pending_buf[$t.d_buf+2*Yt]<<8|$t.pending_buf[$t.d_buf+2*Yt+1],Mt=$t.pending_buf[$t.l_buf+Yt],Yt++,qt===0?mt($t,Mt,kt):(mt($t,(Wt=_e[Mt])+U+1,kt),(Zt=Re[Wt])!==0&&Ke($t,Mt-=Ie[Wt],Zt),mt($t,Wt=Me(--qt),Ft),(Zt=Ne[Wt])!==0&&Ke($t,qt-=je[Wt],Zt)),Yt<$t.last_lit;);mt($t,ue,kt)}function Et($t,kt){var Ft,qt,Mt,Wt=kt.dyn_tree,Zt=kt.stat_desc.static_tree,Yt=kt.stat_desc.has_stree,ur=kt.stat_desc.elems,xt=-1;for($t.heap_len=0,$t.heap_max=X,Ft=0;Ft<ur;Ft++)Wt[2*Ft]!==0?($t.heap[++$t.heap_len]=xt=Ft,$t.depth[Ft]=0):Wt[2*Ft+1]=0;for(;$t.heap_len<2;)Wt[2*(Mt=$t.heap[++$t.heap_len]=xt<2?++xt:0)]=1,$t.depth[Mt]=0,$t.opt_len--,Yt&&($t.static_len-=Zt[2*Mt+1]);for(kt.max_code=xt,Ft=$t.heap_len>>1;1<=Ft;Ft--)bt($t,Wt,Ft);for(Mt=ur;Ft=$t.heap[1],$t.heap[1]=$t.heap[$t.heap_len--],bt($t,Wt,1),qt=$t.heap[1],$t.heap[--$t.heap_max]=Ft,$t.heap[--$t.heap_max]=qt,Wt[2*Mt]=Wt[2*Ft]+Wt[2*qt],$t.depth[Mt]=($t.depth[Ft]>=$t.depth[qt]?$t.depth[Ft]:$t.depth[qt])+1,Wt[2*Ft+1]=Wt[2*qt+1]=Mt,$t.heap[1]=Mt++,bt($t,Wt,1),2<=$t.heap_len;);$t.heap[--$t.heap_max]=$t.heap[1],function(pt,yt){var Bt,Ht,nr,Qt,xr,kr,Sr=yt.dyn_tree,$r=yt.max_code,Rr=yt.stat_desc.static_tree,Dr=yt.stat_desc.has_stree,tn=yt.stat_desc.extra_bits,Jr=yt.stat_desc.extra_base,Pr=yt.stat_desc.max_length,Wr=0;for(Qt=0;Qt<=Q;Qt++)pt.bl_count[Qt]=0;for(Sr[2*pt.heap[pt.heap_max]+1]=0,Bt=pt.heap_max+1;Bt<X;Bt++)Pr<(Qt=Sr[2*Sr[2*(Ht=pt.heap[Bt])+1]+1]+1)&&(Qt=Pr,Wr++),Sr[2*Ht+1]=Qt,$r<Ht||(pt.bl_count[Qt]++,xr=0,Jr<=Ht&&(xr=tn[Ht-Jr]),kr=Sr[2*Ht],pt.opt_len+=kr*(Qt+xr),Dr&&(pt.static_len+=kr*(Rr[2*Ht+1]+xr)));if(Wr!==0){do{for(Qt=Pr-1;pt.bl_count[Qt]===0;)Qt--;pt.bl_count[Qt]--,pt.bl_count[Qt+1]+=2,pt.bl_count[Pr]--,Wr-=2}while(0<Wr);for(Qt=Pr;Qt!==0;Qt--)for(Ht=pt.bl_count[Qt];Ht!==0;)$r<(nr=pt.heap[--Bt])||(Sr[2*nr+1]!==Qt&&(pt.opt_len+=(Qt-Sr[2*nr+1])*Sr[2*nr],Sr[2*nr+1]=Qt),Ht--)}}($t,kt),Qe(Wt,xt,$t.bl_count)}function Ye($t,kt,Ft){var qt,Mt,Wt=-1,Zt=kt[1],Yt=0,ur=7,xt=4;for(Zt===0&&(ur=138,xt=3),kt[2*(Ft+1)+1]=65535,qt=0;qt<=Ft;qt++)Mt=Zt,Zt=kt[2*(qt+1)+1],++Yt<ur&&Mt===Zt||(Yt<xt?$t.bl_tree[2*Mt]+=Yt:Mt!==0?(Mt!==Wt&&$t.bl_tree[2*Mt]++,$t.bl_tree[2*we]++):Yt<=10?$t.bl_tree[2*Te]++:$t.bl_tree[2*xe]++,Wt=Mt,xt=(Yt=0)===Zt?(ur=138,3):Mt===Zt?(ur=6,3):(ur=7,4))}function Ct($t,kt,Ft){var qt,Mt,Wt=-1,Zt=kt[1],Yt=0,ur=7,xt=4;for(Zt===0&&(ur=138,xt=3),qt=0;qt<=Ft;qt++)if(Mt=Zt,Zt=kt[2*(qt+1)+1],!(++Yt<ur&&Mt===Zt)){if(Yt<xt)for(;mt($t,Mt,$t.bl_tree),--Yt!=0;);else Mt!==0?(Mt!==Wt&&(mt($t,Mt,$t.bl_tree),Yt--),mt($t,we,$t.bl_tree),Ke($t,Yt-3,2)):Yt<=10?(mt($t,Te,$t.bl_tree),Ke($t,Yt-3,3)):(mt($t,xe,$t.bl_tree),Ke($t,Yt-11,7));Wt=Mt,xt=(Yt=0)===Zt?(ur=138,3):Mt===Zt?(ur=6,3):(ur=7,4)}}B(je);var Pt=!1;function St($t,kt,Ft,qt){Ke($t,(O<<1)+(qt?1:0),3),function(Mt,Wt,Zt,Yt){vt(Mt),Yt&&(tt(Mt,Zt),tt(Mt,~Zt)),C.arraySet(Mt.pending_buf,Mt.window,Wt,Zt,Mt.pending),Mt.pending+=Zt}($t,kt,Ft,!0)}S._tr_init=function($t){Pt||(function(){var kt,Ft,qt,Mt,Wt,Zt=new Array(Q+1);for(Mt=qt=0;Mt<N-1;Mt++)for(Ie[Mt]=qt,kt=0;kt<1<<Re[Mt];kt++)_e[qt++]=Mt;for(_e[qt-1]=Mt,Mt=Wt=0;Mt<16;Mt++)for(je[Mt]=Wt,kt=0;kt<1<<Ne[Mt];kt++)Ce[Wt++]=Mt;for(Wt>>=7;Mt<z;Mt++)for(je[Mt]=Wt<<7,kt=0;kt<1<<Ne[Mt]-7;kt++)Ce[256+Wt++]=Mt;for(Ft=0;Ft<=Q;Ft++)Zt[Ft]=0;for(kt=0;kt<=143;)nt[2*kt+1]=8,kt++,Zt[8]++;for(;kt<=255;)nt[2*kt+1]=9,kt++,Zt[9]++;for(;kt<=279;)nt[2*kt+1]=7,kt++,Zt[7]++;for(;kt<=287;)nt[2*kt+1]=8,kt++,Zt[8]++;for(Qe(nt,j+1,Zt),kt=0;kt<z;kt++)Ee[2*kt+1]=5,Ee[2*kt]=ct(kt,5);He=new Ve(nt,Re,U+1,j,Q),Be=new Ve(Ee,Ne,0,z,Q),Ge=new Ve(new Array(0),Fe,0,Z,oe)}(),Pt=!0),$t.l_desc=new Pe($t.dyn_ltree,He),$t.d_desc=new Pe($t.dyn_dtree,Be),$t.bl_desc=new Pe($t.bl_tree,Ge),$t.bi_buf=0,$t.bi_valid=0,dt($t)},S._tr_stored_block=St,S._tr_flush_block=function($t,kt,Ft,qt){var Mt,Wt,Zt=0;0<$t.level?($t.strm.data_type===2&&($t.strm.data_type=function(Yt){var ur,xt=4093624447;for(ur=0;ur<=31;ur++,xt>>>=1)if(1&xt&&Yt.dyn_ltree[2*ur]!==0)return A;if(Yt.dyn_ltree[18]!==0||Yt.dyn_ltree[20]!==0||Yt.dyn_ltree[26]!==0)return I;for(ur=32;ur<U;ur++)if(Yt.dyn_ltree[2*ur]!==0)return I;return A}($t)),Et($t,$t.l_desc),Et($t,$t.d_desc),Zt=function(Yt){var ur;for(Ye(Yt,Yt.dyn_ltree,Yt.l_desc.max_code),Ye(Yt,Yt.dyn_dtree,Yt.d_desc.max_code),Et(Yt,Yt.bl_desc),ur=Z-1;3<=ur&&Yt.bl_tree[2*ht[ur]+1]===0;ur--);return Yt.opt_len+=3*(ur+1)+5+5+4,ur}($t),Mt=$t.opt_len+3+7>>>3,(Wt=$t.static_len+3+7>>>3)<=Mt&&(Mt=Wt)):Mt=Wt=Ft+5,Ft+4<=Mt&&kt!==-1?St($t,kt,Ft,qt):$t.strategy===4||Wt===Mt?(Ke($t,2+(qt?1:0),3),ft($t,nt,Ee)):(Ke($t,4+(qt?1:0),3),function(Yt,ur,xt,pt){var yt;for(Ke(Yt,ur-257,5),Ke(Yt,xt-1,5),Ke(Yt,pt-4,4),yt=0;yt<pt;yt++)Ke(Yt,Yt.bl_tree[2*ht[yt]+1],3);Ct(Yt,Yt.dyn_ltree,ur-1),Ct(Yt,Yt.dyn_dtree,xt-1)}($t,$t.l_desc.max_code+1,$t.d_desc.max_code+1,Zt+1),ft($t,$t.dyn_ltree,$t.dyn_dtree)),dt($t),qt&&vt($t)},S._tr_tally=function($t,kt,Ft){return $t.pending_buf[$t.d_buf+2*$t.last_lit]=kt>>>8&255,$t.pending_buf[$t.d_buf+2*$t.last_lit+1]=255&kt,$t.pending_buf[$t.l_buf+$t.last_lit]=255&Ft,$t.last_lit++,kt===0?$t.dyn_ltree[2*Ft]++:($t.matches++,kt--,$t.dyn_ltree[2*(_e[Ft]+U+1)]++,$t.dyn_dtree[2*Me(kt)]++),$t.last_lit===$t.lit_bufsize-1},S._tr_align=function($t){Ke($t,2,3),mt($t,ue,nt),function(kt){kt.bi_valid===16?(tt(kt,kt.bi_buf),kt.bi_buf=0,kt.bi_valid=0):8<=kt.bi_valid&&(kt.pending_buf[kt.pending++]=255&kt.bi_buf,kt.bi_buf>>=8,kt.bi_valid-=8)}($t)}},{"../utils/common":41}],53:[function(_,E,S){E.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(_,E,S){(function(C){(function(A,I){if(!A.setImmediate){var B,O,N,U,j=1,z={},Z=!1,X=A.document,Q=Object.getPrototypeOf&&Object.getPrototypeOf(A);Q=Q&&Q.setTimeout?Q:A,B={}.toString.call(A.process)==="[object process]"?function(we){browser$1$1.nextTick(function(){oe(we)})}:function(){if(A.postMessage&&!A.importScripts){var we=!0,Te=A.onmessage;return A.onmessage=function(){we=!1},A.postMessage("","*"),A.onmessage=Te,we}}()?(U="setImmediate$"+Math.random()+"$",A.addEventListener?A.addEventListener("message",ue,!1):A.attachEvent("onmessage",ue),function(we){A.postMessage(U+we,"*")}):A.MessageChannel?((N=new MessageChannel).port1.onmessage=function(we){oe(we.data)},function(we){N.port2.postMessage(we)}):X&&"onreadystatechange"in X.createElement("script")?(O=X.documentElement,function(we){var Te=X.createElement("script");Te.onreadystatechange=function(){oe(we),Te.onreadystatechange=null,O.removeChild(Te),Te=null},O.appendChild(Te)}):function(we){setTimeout(oe,0,we)},Q.setImmediate=function(we){typeof we!="function"&&(we=new Function(""+we));for(var Te=new Array(arguments.length-1),xe=0;xe<Te.length;xe++)Te[xe]=arguments[xe+1];var Re={callback:we,args:Te};return z[j]=Re,B(j),j++},Q.clearImmediate=se}function se(we){delete z[we]}function oe(we){if(Z)setTimeout(oe,0,we);else{var Te=z[we];if(Te){Z=!0;try{(function(xe){var Re=xe.callback,Ne=xe.args;switch(Ne.length){case 0:Re();break;case 1:Re(Ne[0]);break;case 2:Re(Ne[0],Ne[1]);break;case 3:Re(Ne[0],Ne[1],Ne[2]);break;default:Re.apply(I,Ne)}})(Te)}finally{se(we),Z=!1}}}}function ue(we){we.source===A&&typeof we.data=="string"&&we.data.indexOf(U)===0&&oe(+we.data.slice(U.length))}})(typeof self>"u"?C===void 0?this:C:self)}).call(this,typeof commonjsGlobal<"u"?commonjsGlobal:typeof self<"u"?self:typeof window<"u"?window:{})},{}]},{},[10])(10)})})(jszip_min);var jszip_minExports=jszip_min.exports;const JSZip=getDefaultExportFromCjs(jszip_minExports),e$1=(()=>{if(typeof self>"u")return!1;if("top"in self&&self!==top)try{top.window.document._=0}catch{return!1}return"showOpenFilePicker"in self})();e$1?Promise.resolve().then(function(){return l}):Promise.resolve().then(function(){return v$1});e$1?Promise.resolve().then(function(){return y$1}):Promise.resolve().then(function(){return b$1});const a=e$1?Promise.resolve().then(function(){return m$1}):Promise.resolve().then(function(){return k$1});async function o(...n){return(await a).default(...n)}const s$2=async n=>{const r=await n.getFile();return r.handle=n,r};var c=async(n=[{}])=>{Array.isArray(n)||(n=[n]);const r=[];n.forEach((S,C)=>{r[C]={description:S.description||"Files",accept:{}},S.mimeTypes?S.mimeTypes.map(A=>{r[C].accept[A]=S.extensions||[]}):r[C].accept["*/*"]=S.extensions||[]});const _=await window.showOpenFilePicker({id:n[0].id,startIn:n[0].startIn,types:r,multiple:n[0].multiple||!1,excludeAcceptAllOption:n[0].excludeAcceptAllOption||!1}),E=await Promise.all(_.map(s$2));return n[0].multiple?E:E[0]},l={__proto__:null,default:c};function u(n){function r(_){if(Object(_)!==_)return Promise.reject(new TypeError(_+" is not an object."));var E=_.done;return Promise.resolve(_.value).then(function(S){return{value:S,done:E}})}return u=function(_){this.s=_,this.n=_.next},u.prototype={s:null,n:null,next:function(){return r(this.n.apply(this.s,arguments))},return:function(_){var E=this.s.return;return E===void 0?Promise.resolve({value:_,done:!0}):r(E.apply(this.s,arguments))},throw:function(_){var E=this.s.return;return E===void 0?Promise.reject(_):r(E.apply(this.s,arguments))}},new u(n)}const p=async(n,r,_=n.name,E)=>{const S=[],C=[];var A,I=!1,B=!1;try{for(var O,N=function(U){var j,z,Z,X=2;for(typeof Symbol<"u"&&(z=Symbol.asyncIterator,Z=Symbol.iterator);X--;){if(z&&(j=U[z])!=null)return j.call(U);if(Z&&(j=U[Z])!=null)return new u(j.call(U));z="@@asyncIterator",Z="@@iterator"}throw new TypeError("Object is not async iterable")}(n.values());I=!(O=await N.next()).done;I=!1){const U=O.value,j=`${_}/${U.name}`;U.kind==="file"?C.push(U.getFile().then(z=>(z.directoryHandle=n,z.handle=U,Object.defineProperty(z,"webkitRelativePath",{configurable:!0,enumerable:!0,get:()=>j})))):U.kind!=="directory"||!r||E&&E(U)||S.push(p(U,r,j,E))}}catch(U){B=!0,A=U}finally{try{I&&N.return!=null&&await N.return()}finally{if(B)throw A}}return[...(await Promise.all(S)).flat(),...await Promise.all(C)]};var d=async(n={})=>{n.recursive=n.recursive||!1,n.mode=n.mode||"read";const r=await window.showDirectoryPicker({id:n.id,startIn:n.startIn,mode:n.mode});return(await(await r.values()).next()).done?[r]:p(r,n.recursive,void 0,n.skipDirectory)},y$1={__proto__:null,default:d},f$1=async(n,r=[{}],_=null,E=!1,S=null)=>{Array.isArray(r)||(r=[r]),r[0].fileName=r[0].fileName||"Untitled";const C=[];let A=null;if(n instanceof Blob&&n.type?A=n.type:n.headers&&n.headers.get("content-type")&&(A=n.headers.get("content-type")),r.forEach((O,N)=>{C[N]={description:O.description||"Files",accept:{}},O.mimeTypes?(N===0&&A&&O.mimeTypes.push(A),O.mimeTypes.map(U=>{C[N].accept[U]=O.extensions||[]})):A?C[N].accept[A]=O.extensions||[]:C[N].accept["*/*"]=O.extensions||[]}),_)try{await _.getFile()}catch(O){if(_=null,E)throw O}const I=_||await window.showSaveFilePicker({suggestedName:r[0].fileName,id:r[0].id,startIn:r[0].startIn,types:C,excludeAcceptAllOption:r[0].excludeAcceptAllOption||!1});!_&&S&&S(I);const B=await I.createWritable();return"stream"in n?(await n.stream().pipeTo(B),I):"body"in n?(await n.body.pipeTo(B),I):(await B.write(await n),await B.close(),I)},m$1={__proto__:null,default:f$1},w=async(n=[{}])=>(Array.isArray(n)||(n=[n]),new Promise((r,_)=>{const E=document.createElement("input");E.type="file";const S=[...n.map(B=>B.mimeTypes||[]),...n.map(B=>B.extensions||[])].join();E.multiple=n[0].multiple||!1,E.accept=S||"",E.style.display="none",document.body.append(E);const C=B=>{typeof A=="function"&&A(),r(B)},A=n[0].legacySetup&&n[0].legacySetup(C,()=>A(_),E),I=()=>{window.removeEventListener("focus",I),E.remove()};E.addEventListener("click",()=>{window.addEventListener("focus",I)}),E.addEventListener("change",()=>{window.removeEventListener("focus",I),E.remove(),C(E.multiple?Array.from(E.files):E.files[0])}),"showPicker"in HTMLInputElement.prototype?E.showPicker():E.click()})),v$1={__proto__:null,default:w},h$1=async(n=[{}])=>(Array.isArray(n)||(n=[n]),n[0].recursive=n[0].recursive||!1,new Promise((r,_)=>{const E=document.createElement("input");E.type="file",E.webkitdirectory=!0;const S=A=>{typeof C=="function"&&C(),r(A)},C=n[0].legacySetup&&n[0].legacySetup(S,()=>C(_),E);E.addEventListener("change",()=>{let A=Array.from(E.files);n[0].recursive?n[0].recursive&&n[0].skipDirectory&&(A=A.filter(I=>I.webkitRelativePath.split("/").every(B=>!n[0].skipDirectory({name:B,kind:"directory"})))):A=A.filter(I=>I.webkitRelativePath.split("/").length===2),S(A)}),"showPicker"in HTMLInputElement.prototype?E.showPicker():E.click()})),b$1={__proto__:null,default:h$1},P=async(n,r={})=>{Array.isArray(r)&&(r=r[0]);const _=document.createElement("a");let E=n;"body"in n&&(E=await async function(A,I){const B=A.getReader(),O=new ReadableStream({start:j=>async function z(){return B.read().then(({done:Z,value:X})=>{if(!Z)return j.enqueue(X),z();j.close()})}()}),N=new Response(O),U=await N.blob();return B.releaseLock(),new Blob([U],{type:I})}(n.body,n.headers.get("content-type"))),_.download=r.fileName||"Untitled",_.href=URL.createObjectURL(await E);const S=()=>{typeof C=="function"&&C()},C=r.legacySetup&&r.legacySetup(S,()=>C(),_);return _.addEventListener("click",()=>{setTimeout(()=>URL.revokeObjectURL(_.href),3e4),S()}),_.click(),null},k$1={__proto__:null,default:P};function normalizeArray(n,r){for(var _=0,E=n.length-1;E>=0;E--){var S=n[E];S==="."?n.splice(E,1):S===".."?(n.splice(E,1),_++):_&&(n.splice(E,1),_--)}if(r)for(;_--;_)n.unshift("..");return n}var splitPathRe=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/,splitPath=function(n){return splitPathRe.exec(n).slice(1)};function resolve$9(){for(var n="",r=!1,_=arguments.length-1;_>=-1&&!r;_--){var E=_>=0?arguments[_]:"/";if(typeof E!="string")throw new TypeError("Arguments to path.resolve must be strings");if(!E)continue;n=E+"/"+n,r=E.charAt(0)==="/"}return n=normalizeArray(filter$2(n.split("/"),function(S){return!!S}),!r).join("/"),(r?"/":"")+n||"."}function normalize$1(n){var r=isAbsolute(n),_=substr(n,-1)==="/";return n=normalizeArray(filter$2(n.split("/"),function(E){return!!E}),!r).join("/"),!n&&!r&&(n="."),n&&_&&(n+="/"),(r?"/":"")+n}function isAbsolute(n){return n.charAt(0)==="/"}function join(){var n=Array.prototype.slice.call(arguments,0);return normalize$1(filter$2(n,function(r,_){if(typeof r!="string")throw new TypeError("Arguments to path.join must be strings");return r}).join("/"))}function relative(n,r){n=resolve$9(n).substr(1),r=resolve$9(r).substr(1);function _(O){for(var N=0;N<O.length&&O[N]==="";N++);for(var U=O.length-1;U>=0&&O[U]==="";U--);return N>U?[]:O.slice(N,U-N+1)}for(var E=_(n.split("/")),S=_(r.split("/")),C=Math.min(E.length,S.length),A=C,I=0;I<C;I++)if(E[I]!==S[I]){A=I;break}for(var B=[],I=A;I<E.length;I++)B.push("..");return B=B.concat(S.slice(A)),B.join("/")}var sep="/",delimiter=":";function dirname(n){var r=splitPath(n),_=r[0],E=r[1];return!_&&!E?".":(E&&(E=E.substr(0,E.length-1)),_+E)}function basename(n,r){var _=splitPath(n)[2];return r&&_.substr(-1*r.length)===r&&(_=_.substr(0,_.length-r.length)),_}function extname(n){return splitPath(n)[3]}const path={extname,basename,dirname,sep,delimiter,relative,join,isAbsolute,normalize:normalize$1,resolve:resolve$9};function filter$2(n,r){if(n.filter)return n.filter(r);for(var _=[],E=0;E<n.length;E++)r(n[E],E,n)&&_.push(n[E]);return _}var substr="ab".substr(-1)==="b"?function(n,r,_){return n.substr(r,_)}:function(n,r,_){return r<0&&(r=n.length+r),n.substr(r,_)};const path$1=Object.freeze(Object.defineProperty({__proto__:null,basename,default:path,delimiter,dirname,extname,isAbsolute,join,normalize:normalize$1,relative,resolve:resolve$9,sep},Symbol.toStringTag,{value:"Module"}));function isElectron$1(){return!!(typeof window<"u"&&typeof window.process=="object"&&window.process.type==="renderer"||typeof browser$1$1<"u"&&typeof browser$1$1.versions=="object"&&browser$1$1.versions.electron||typeof navigator=="object"&&typeof navigator.userAgent=="string"&&navigator.userAgent.indexOf("Electron")>=0)}var isElectron_1=isElectron$1;const detectElectron=getDefaultExportFromCjs(isElectron_1),isEnvWithDom=typeof window=="object"&&typeof document=="object"&&document.nodeType===9,isElectron=detectElectron(),isBrowser=isEnvWithDom&&!isElectron,isElectronMain=isElectron&&!isEnvWithDom,isElectronRenderer=isElectron&&isEnvWithDom,isNode=typeof globalThis.process<"u"&&typeof globalThis.process.release<"u"&&globalThis.process.release.name==="node"&&!isElectron,isWebWorker=typeof importScripts=="function"&&typeof self<"u"&&typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope,isReactNative=typeof navigator<"u"&&navigator.product==="ReactNative";function traduire(n,r){const _=r.find(S=>n[S]!==void 0);return _?n[_]:void 0}async function zipper(n,r,_){_.endsWith(".zip")||(_=`${_}.zip`);const E=new JSZip;for(const C of n)E.file(C.nom,C.octets);const S=E.folder("sfip");for(const C of r)S.file(C.nom,C.octets);await sauvegarderFichierZip({fichierZip:E,nomFichier:_})}async function sauvegarderFichierZip({fichierZip:n,nomFichier:r}){if(isNode||isElectronMain){const _=await __vitePreload(()=>Promise.resolve().then(()=>__viteBrowserExternal),void 0),E=n.generateNodeStream();_.mkdirSync(path.dirname(r),{recursive:!0});const S=_.createWriteStream(r),C=E.pipe(S);return new Promise(A=>C.on("finish",A))}else{const _=await n.generateAsync({type:"blob"});await o(_,{fileName:r})}}var encode_1$4=encode$q,MSB$8=128,REST$8=127,MSBALL$4=~REST$8,INT$4=Math.pow(2,31);function encode$q(n,r,_){r=r||[],_=_||0;for(var E=_;n>=INT$4;)r[_++]=n&255|MSB$8,n/=128;for(;n&MSBALL$4;)r[_++]=n&255|MSB$8,n>>>=7;return r[_]=n|0,encode$q.bytes=_-E+1,r}var decode$u=read$6,MSB$1$3=128,REST$1$3=127;function read$6(n,E){var _=0,E=E||0,S=0,C=E,A,I=n.length;do{if(C>=I)throw read$6.bytes=0,new RangeError("Could not decode varint");A=n[C++],_+=S<28?(A&REST$1$3)<<S:(A&REST$1$3)*Math.pow(2,S),S+=7}while(A>=MSB$1$3);return read$6.bytes=C-E,_}var N1$5=Math.pow(2,7),N2$5=Math.pow(2,14),N3$5=Math.pow(2,21),N4$5=Math.pow(2,28),N5$5=Math.pow(2,35),N6$5=Math.pow(2,42),N7$5=Math.pow(2,49),N8$4=Math.pow(2,56),N9$4=Math.pow(2,63),length$6=function(n){return n<N1$5?1:n<N2$5?2:n<N3$5?3:n<N4$5?4:n<N5$5?5:n<N6$5?6:n<N7$5?7:n<N8$4?8:n<N9$4?9:10},varint$6={encode:encode_1$4,decode:decode$u,encodingLength:length$6},_brrp_varint$2=varint$6;const decode$t=(n,r=0)=>[_brrp_varint$2.decode(n,r),_brrp_varint$2.decode.bytes],encodeTo$2=(n,r,_=0)=>(_brrp_varint$2.encode(n,r,_),r),encodingLength$3=n=>_brrp_varint$2.encodingLength(n),equals$7=(n,r)=>{if(n===r)return!0;if(n.byteLength!==r.byteLength)return!1;for(let _=0;_<n.byteLength;_++)if(n[_]!==r[_])return!1;return!0},coerce$4=n=>{if(n instanceof Uint8Array&&n.constructor.name==="Uint8Array")return n;if(n instanceof ArrayBuffer)return new Uint8Array(n);if(ArrayBuffer.isView(n))return new Uint8Array(n.buffer,n.byteOffset,n.byteLength);throw new Error("Unknown type, must be binary type")},fromString$7=n=>new TextEncoder().encode(n),toString$a=n=>new TextDecoder().decode(n),create$7=(n,r)=>{const _=r.byteLength,E=encodingLength$3(n),S=E+encodingLength$3(_),C=new Uint8Array(S+_);return encodeTo$2(n,C,0),encodeTo$2(_,C,E),C.set(r,S),new Digest$2(n,_,r,C)},decode$s=n=>{const r=coerce$4(n),[_,E]=decode$t(r),[S,C]=decode$t(r.subarray(E)),A=r.subarray(E+C);if(A.byteLength!==S)throw new Error("Incorrect length");return new Digest$2(_,S,A,r)},equals$6=(n,r)=>n===r?!0:n.code===r.code&&n.size===r.size&&equals$7(n.bytes,r.bytes);let Digest$2=class{constructor(r,_,E,S){this.code=r,this.size=_,this.digest=E,this.bytes=S}};function base$7(n,r){if(n.length>=255)throw new TypeError("Alphabet too long");for(var _=new Uint8Array(256),E=0;E<_.length;E++)_[E]=255;for(var S=0;S<n.length;S++){var C=n.charAt(S),A=C.charCodeAt(0);if(_[A]!==255)throw new TypeError(C+" is ambiguous");_[A]=S}var I=n.length,B=n.charAt(0),O=Math.log(I)/Math.log(256),N=Math.log(256)/Math.log(I);function U(Z){if(Z instanceof Uint8Array||(ArrayBuffer.isView(Z)?Z=new Uint8Array(Z.buffer,Z.byteOffset,Z.byteLength):Array.isArray(Z)&&(Z=Uint8Array.from(Z))),!(Z instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(Z.length===0)return"";for(var X=0,Q=0,se=0,oe=Z.length;se!==oe&&Z[se]===0;)se++,X++;for(var ue=(oe-se)*N+1>>>0,we=new Uint8Array(ue);se!==oe;){for(var Te=Z[se],xe=0,Re=ue-1;(Te!==0||xe<Q)&&Re!==-1;Re--,xe++)Te+=256*we[Re]>>>0,we[Re]=Te%I>>>0,Te=Te/I>>>0;if(Te!==0)throw new Error("Non-zero carry");Q=xe,se++}for(var Ne=ue-Q;Ne!==ue&&we[Ne]===0;)Ne++;for(var Fe=B.repeat(X);Ne<ue;++Ne)Fe+=n.charAt(we[Ne]);return Fe}function j(Z){if(typeof Z!="string")throw new TypeError("Expected String");if(Z.length===0)return new Uint8Array;var X=0;if(Z[X]!==" "){for(var Q=0,se=0;Z[X]===B;)Q++,X++;for(var oe=(Z.length-X)*O+1>>>0,ue=new Uint8Array(oe);Z[X];){var we=_[Z.charCodeAt(X)];if(we===255)return;for(var Te=0,xe=oe-1;(we!==0||Te<se)&&xe!==-1;xe--,Te++)we+=I*ue[xe]>>>0,ue[xe]=we%256>>>0,we=we/256>>>0;if(we!==0)throw new Error("Non-zero carry");se=Te,X++}if(Z[X]!==" "){for(var Re=oe-se;Re!==oe&&ue[Re]===0;)Re++;for(var Ne=new Uint8Array(Q+(oe-Re)),Fe=Q;Re!==oe;)Ne[Fe++]=ue[Re++];return Ne}}}function z(Z){var X=j(Z);if(X)return X;throw new Error(`Non-${r} character`)}return{encode:U,decodeUnsafe:j,decode:z}}var src$6=base$7,_brrp__multiformats_scope_baseX$2=src$6;let Encoder$3=class{constructor(r,_,E){this.name=r,this.prefix=_,this.baseEncode=E}encode(r){if(r instanceof Uint8Array)return`${this.prefix}${this.baseEncode(r)}`;throw Error("Unknown type, must be binary type")}},Decoder$4=class{constructor(r,_,E){if(this.name=r,this.prefix=_,_.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=_.codePointAt(0),this.baseDecode=E}decode(r){if(typeof r=="string"){if(r.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(r)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(r.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(r){return or$4(this,r)}},ComposedDecoder$2=class{constructor(r){this.decoders=r}or(r){return or$4(this,r)}decode(r){const _=r[0],E=this.decoders[_];if(E)return E.decode(r);throw RangeError(`Unable to decode multibase string ${JSON.stringify(r)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}};const or$4=(n,r)=>new ComposedDecoder$2({...n.decoders||{[n.prefix]:n},...r.decoders||{[r.prefix]:r}});let Codec$2=class{constructor(r,_,E,S){this.name=r,this.prefix=_,this.baseEncode=E,this.baseDecode=S,this.encoder=new Encoder$3(r,_,E),this.decoder=new Decoder$4(r,_,S)}encode(r){return this.encoder.encode(r)}decode(r){return this.decoder.decode(r)}};const from$5=({name:n,prefix:r,encode:_,decode:E})=>new Codec$2(n,r,_,E),baseX$3=({prefix:n,name:r,alphabet:_})=>{const{encode:E,decode:S}=_brrp__multiformats_scope_baseX$2(_,r);return from$5({prefix:n,name:r,encode:E,decode:C=>coerce$4(S(C))})},decode$r=(n,r,_,E)=>{const S={};for(let N=0;N<r.length;++N)S[r[N]]=N;let C=n.length;for(;n[C-1]==="=";)--C;const A=new Uint8Array(C*_/8|0);let I=0,B=0,O=0;for(let N=0;N<C;++N){const U=S[n[N]];if(U===void 0)throw new SyntaxError(`Non-${E} character`);B=B<<_|U,I+=_,I>=8&&(I-=8,A[O++]=255&B>>I)}if(I>=_||255&B<<8-I)throw new SyntaxError("Unexpected end of data");return A},encode$p=(n,r,_)=>{const E=r[r.length-1]==="=",S=(1<<_)-1;let C="",A=0,I=0;for(let B=0;B<n.length;++B)for(I=I<<8|n[B],A+=8;A>_;)A-=_,C+=r[S&I>>A];if(A&&(C+=r[S&I<<_-A]),E)for(;C.length*_&7;)C+="=";return C},rfc4648$4=({name:n,prefix:r,bitsPerChar:_,alphabet:E})=>from$5({prefix:r,name:n,encode(S){return encode$p(S,E,_)},decode(S){return decode$r(S,E,_,n)}}),base58btc$2=baseX$3({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),base58flickr$2=baseX$3({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),base58$2=Object.freeze(Object.defineProperty({__proto__:null,base58btc:base58btc$2,base58flickr:base58flickr$2},Symbol.toStringTag,{value:"Module"})),base32$4=rfc4648$4({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),base32upper$2=rfc4648$4({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),base32pad$2=rfc4648$4({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),base32padupper$2=rfc4648$4({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),base32hex$2=rfc4648$4({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),base32hexupper$2=rfc4648$4({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),base32hexpad$2=rfc4648$4({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),base32hexpadupper$2=rfc4648$4({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),base32z$2=rfc4648$4({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),base32$5=Object.freeze(Object.defineProperty({__proto__:null,base32:base32$4,base32hex:base32hex$2,base32hexpad:base32hexpad$2,base32hexpadupper:base32hexpadupper$2,base32hexupper:base32hexupper$2,base32pad:base32pad$2,base32padupper:base32padupper$2,base32upper:base32upper$2,base32z:base32z$2},Symbol.toStringTag,{value:"Module"}));let CID$2=class Fn{constructor(r,_,E,S){this.code=_,this.version=r,this.multihash=E,this.bytes=S,this.byteOffset=S.byteOffset,this.byteLength=S.byteLength,this.asCID=this,this._baseCache=new Map,Object.defineProperties(this,{byteOffset:hidden,byteLength:hidden,code:readonly$2,version:readonly$2,multihash:readonly$2,bytes:readonly$2,_baseCache:hidden,asCID:hidden})}toV0(){switch(this.version){case 0:return this;default:{const{code:r,multihash:_}=this;if(r!==DAG_PB_CODE$2)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(_.code!==SHA_256_CODE$2)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return Fn.createV0(_)}}}toV1(){switch(this.version){case 0:{const{code:r,digest:_}=this.multihash,E=create$7(r,_);return Fn.createV1(this.code,E)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}equals(r){return r&&this.code===r.code&&this.version===r.version&&equals$6(this.multihash,r.multihash)}toString(r){const{bytes:_,version:E,_baseCache:S}=this;switch(E){case 0:return toStringV0$2(_,S,r||base58btc$2.encoder);default:return toStringV1$2(_,S,r||base32$4.encoder)}}toJSON(){return{code:this.code,version:this.version,hash:this.multihash.bytes}}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return"CID("+this.toString()+")"}static isCID(r){return deprecate(/^0\.0/,IS_CID_DEPRECATION),!!(r&&(r[cidSymbol$2]||r.asCID===r))}get toBaseEncodedString(){throw new Error("Deprecated, use .toString()")}get codec(){throw new Error('"codec" property is deprecated, use integer "code" property instead')}get buffer(){throw new Error("Deprecated .buffer property, use .bytes to get Uint8Array instead")}get multibaseName(){throw new Error('"multibaseName" property is deprecated')}get prefix(){throw new Error('"prefix" property is deprecated')}static asCID(r){if(r instanceof Fn)return r;if(r!=null&&r.asCID===r){const{version:_,code:E,multihash:S,bytes:C}=r;return new Fn(_,E,S,C||encodeCID$2(_,E,S.bytes))}else if(r!=null&&r[cidSymbol$2]===!0){const{version:_,multihash:E,code:S}=r,C=decode$s(E);return Fn.create(_,S,C)}else return null}static create(r,_,E){if(typeof _!="number")throw new Error("String codecs are no longer supported");switch(r){case 0:{if(_!==DAG_PB_CODE$2)throw new Error(`Version 0 CID must use dag-pb (code: ${DAG_PB_CODE$2}) block encoding`);return new Fn(r,_,E,E.bytes)}case 1:{const S=encodeCID$2(r,_,E.bytes);return new Fn(r,_,E,S)}default:throw new Error("Invalid version")}}static createV0(r){return Fn.create(0,DAG_PB_CODE$2,r)}static createV1(r,_){return Fn.create(1,r,_)}static decode(r){const[_,E]=Fn.decodeFirst(r);if(E.length)throw new Error("Incorrect length");return _}static decodeFirst(r){const _=Fn.inspectBytes(r),E=_.size-_.multihashSize,S=coerce$4(r.subarray(E,E+_.multihashSize));if(S.byteLength!==_.multihashSize)throw new Error("Incorrect length");const C=S.subarray(_.multihashSize-_.digestSize),A=new Digest$2(_.multihashCode,_.digestSize,C,S);return[_.version===0?Fn.createV0(A):Fn.createV1(_.codec,A),r.subarray(_.size)]}static inspectBytes(r){let _=0;const E=()=>{const[U,j]=decode$t(r.subarray(_));return _+=j,U};let S=E(),C=DAG_PB_CODE$2;if(S===18?(S=0,_=0):S===1&&(C=E()),S!==0&&S!==1)throw new RangeError(`Invalid CID version ${S}`);const A=_,I=E(),B=E(),O=_+B,N=O-A;return{version:S,codec:C,multihashCode:I,digestSize:B,multihashSize:N,size:O}}static parse(r,_){const[E,S]=parseCIDtoBytes$2(r,_),C=Fn.decode(S);return C._baseCache.set(E,r),C}};const parseCIDtoBytes$2=(n,r)=>{switch(n[0]){case"Q":{const _=r||base58btc$2;return[base58btc$2.prefix,_.decode(`${base58btc$2.prefix}${n}`)]}case base58btc$2.prefix:{const _=r||base58btc$2;return[base58btc$2.prefix,_.decode(n)]}case base32$4.prefix:{const _=r||base32$4;return[base32$4.prefix,_.decode(n)]}default:{if(r==null)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[n[0],r.decode(n)]}}},toStringV0$2=(n,r,_)=>{const{prefix:E}=_;if(E!==base58btc$2.prefix)throw Error(`Cannot string encode V0 in ${_.name} encoding`);const S=r.get(E);if(S==null){const C=_.encode(n).slice(1);return r.set(E,C),C}else return S},toStringV1$2=(n,r,_)=>{const{prefix:E}=_,S=r.get(E);if(S==null){const C=_.encode(n);return r.set(E,C),C}else return S},DAG_PB_CODE$2=112,SHA_256_CODE$2=18,encodeCID$2=(n,r,_)=>{const E=encodingLength$3(n),S=E+encodingLength$3(r),C=new Uint8Array(S+_.byteLength);return encodeTo$2(n,C,0),encodeTo$2(r,C,E),C.set(_,S),C},cidSymbol$2=Symbol.for("@ipld/js-cid/CID"),readonly$2={writable:!1,configurable:!1,enumerable:!0},hidden={writable:!1,enumerable:!1,configurable:!1},version$3="0.0.0-dev",deprecate=(n,r)=>{if(n.test(version$3))console.warn(r);else throw new Error(r)},IS_CID_DEPRECATION=`CID.isCID(v) is deprecated and will be removed in the next major release.
Following code pattern:

if (CID.isCID(value)) {
  doSomethingWithCID(value)
}

Is replaced with:

const cid = CID.asCID(value)
if (cid) {
  // Make sure to use cid instead of value
  doSomethingWithCID(cid)
}
`;function asUint8Array$2(n){return globalThis.Buffer!=null?new Uint8Array(n.buffer,n.byteOffset,n.byteLength):n}function alloc$3(n=0){return globalThis.Buffer?.alloc!=null?asUint8Array$2(globalThis.Buffer.alloc(n)):new Uint8Array(n)}function allocUnsafe$2(n=0){return globalThis.Buffer?.allocUnsafe!=null?asUint8Array$2(globalThis.Buffer.allocUnsafe(n)):new Uint8Array(n)}function concat$7(n,r){r==null&&(r=n.reduce((S,C)=>S+C.length,0));const _=allocUnsafe$2(r);let E=0;for(const S of n)_.set(S,E),E+=S.length;return asUint8Array$2(_)}function cidValide(n){if(typeof n=="string")try{return CID$2.parse(n),!0}catch{return!1}return!1}async function toBuffer$2(n,r){let _=new Uint8Array(0);for await(const E of n)if(_=concat$7([_,E],_.length+E.length),r!==void 0&&_.length>r)return null;return _}var events$2={exports:{}},R=typeof Reflect=="object"?Reflect:null,ReflectApply=R&&typeof R.apply=="function"?R.apply:function(r,_,E){return Function.prototype.apply.call(r,_,E)},ReflectOwnKeys;R&&typeof R.ownKeys=="function"?ReflectOwnKeys=R.ownKeys:Object.getOwnPropertySymbols?ReflectOwnKeys=function(r){return Object.getOwnPropertyNames(r).concat(Object.getOwnPropertySymbols(r))}:ReflectOwnKeys=function(r){return Object.getOwnPropertyNames(r)};function ProcessEmitWarning(n){console&&console.warn&&console.warn(n)}var NumberIsNaN=Number.isNaN||function(r){return r!==r};function EventEmitter$2(){EventEmitter$2.init.call(this)}events$2.exports=EventEmitter$2;var once_1=events$2.exports.once=once;EventEmitter$2.EventEmitter=EventEmitter$2;EventEmitter$2.prototype._events=void 0;EventEmitter$2.prototype._eventsCount=0;EventEmitter$2.prototype._maxListeners=void 0;var defaultMaxListeners=10;function checkListener(n){if(typeof n!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof n)}Object.defineProperty(EventEmitter$2,"defaultMaxListeners",{enumerable:!0,get:function(){return defaultMaxListeners},set:function(n){if(typeof n!="number"||n<0||NumberIsNaN(n))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+n+".");defaultMaxListeners=n}});EventEmitter$2.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};EventEmitter$2.prototype.setMaxListeners=function(r){if(typeof r!="number"||r<0||NumberIsNaN(r))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+r+".");return this._maxListeners=r,this};function _getMaxListeners(n){return n._maxListeners===void 0?EventEmitter$2.defaultMaxListeners:n._maxListeners}EventEmitter$2.prototype.getMaxListeners=function(){return _getMaxListeners(this)};EventEmitter$2.prototype.emit=function(r){for(var _=[],E=1;E<arguments.length;E++)_.push(arguments[E]);var S=r==="error",C=this._events;if(C!==void 0)S=S&&C.error===void 0;else if(!S)return!1;if(S){var A;if(_.length>0&&(A=_[0]),A instanceof Error)throw A;var I=new Error("Unhandled error."+(A?" ("+A.message+")":""));throw I.context=A,I}var B=C[r];if(B===void 0)return!1;if(typeof B=="function")ReflectApply(B,this,_);else for(var O=B.length,N=arrayClone(B,O),E=0;E<O;++E)ReflectApply(N[E],this,_);return!0};function _addListener(n,r,_,E){var S,C,A;if(checkListener(_),C=n._events,C===void 0?(C=n._events=Object.create(null),n._eventsCount=0):(C.newListener!==void 0&&(n.emit("newListener",r,_.listener?_.listener:_),C=n._events),A=C[r]),A===void 0)A=C[r]=_,++n._eventsCount;else if(typeof A=="function"?A=C[r]=E?[_,A]:[A,_]:E?A.unshift(_):A.push(_),S=_getMaxListeners(n),S>0&&A.length>S&&!A.warned){A.warned=!0;var I=new Error("Possible EventEmitter memory leak detected. "+A.length+" "+String(r)+" listeners added. Use emitter.setMaxListeners() to increase limit");I.name="MaxListenersExceededWarning",I.emitter=n,I.type=r,I.count=A.length,ProcessEmitWarning(I)}return n}EventEmitter$2.prototype.addListener=function(r,_){return _addListener(this,r,_,!1)};EventEmitter$2.prototype.on=EventEmitter$2.prototype.addListener;EventEmitter$2.prototype.prependListener=function(r,_){return _addListener(this,r,_,!0)};function onceWrapper(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function _onceWrap(n,r,_){var E={fired:!1,wrapFn:void 0,target:n,type:r,listener:_},S=onceWrapper.bind(E);return S.listener=_,E.wrapFn=S,S}EventEmitter$2.prototype.once=function(r,_){return checkListener(_),this.on(r,_onceWrap(this,r,_)),this};EventEmitter$2.prototype.prependOnceListener=function(r,_){return checkListener(_),this.prependListener(r,_onceWrap(this,r,_)),this};EventEmitter$2.prototype.removeListener=function(r,_){var E,S,C,A,I;if(checkListener(_),S=this._events,S===void 0)return this;if(E=S[r],E===void 0)return this;if(E===_||E.listener===_)--this._eventsCount===0?this._events=Object.create(null):(delete S[r],S.removeListener&&this.emit("removeListener",r,E.listener||_));else if(typeof E!="function"){for(C=-1,A=E.length-1;A>=0;A--)if(E[A]===_||E[A].listener===_){I=E[A].listener,C=A;break}if(C<0)return this;C===0?E.shift():spliceOne(E,C),E.length===1&&(S[r]=E[0]),S.removeListener!==void 0&&this.emit("removeListener",r,I||_)}return this};EventEmitter$2.prototype.off=EventEmitter$2.prototype.removeListener;EventEmitter$2.prototype.removeAllListeners=function(r){var _,E,S;if(E=this._events,E===void 0)return this;if(E.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):E[r]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete E[r]),this;if(arguments.length===0){var C=Object.keys(E),A;for(S=0;S<C.length;++S)A=C[S],A!=="removeListener"&&this.removeAllListeners(A);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(_=E[r],typeof _=="function")this.removeListener(r,_);else if(_!==void 0)for(S=_.length-1;S>=0;S--)this.removeListener(r,_[S]);return this};function _listeners(n,r,_){var E=n._events;if(E===void 0)return[];var S=E[r];return S===void 0?[]:typeof S=="function"?_?[S.listener||S]:[S]:_?unwrapListeners(S):arrayClone(S,S.length)}EventEmitter$2.prototype.listeners=function(r){return _listeners(this,r,!0)};EventEmitter$2.prototype.rawListeners=function(r){return _listeners(this,r,!1)};EventEmitter$2.listenerCount=function(n,r){return typeof n.listenerCount=="function"?n.listenerCount(r):listenerCount$1.call(n,r)};EventEmitter$2.prototype.listenerCount=listenerCount$1;function listenerCount$1(n){var r=this._events;if(r!==void 0){var _=r[n];if(typeof _=="function")return 1;if(_!==void 0)return _.length}return 0}EventEmitter$2.prototype.eventNames=function(){return this._eventsCount>0?ReflectOwnKeys(this._events):[]};function arrayClone(n,r){for(var _=new Array(r),E=0;E<r;++E)_[E]=n[E];return _}function spliceOne(n,r){for(;r+1<n.length;r++)n[r]=n[r+1];n.pop()}function unwrapListeners(n){for(var r=new Array(n.length),_=0;_<r.length;++_)r[_]=n[_].listener||n[_];return r}function once(n,r){return new Promise(function(_,E){function S(A){n.removeListener(r,C),E(A)}function C(){typeof n.removeListener=="function"&&n.removeListener("error",S),_([].slice.call(arguments))}eventTargetAgnosticAddListener(n,r,C,{once:!0}),r!=="error"&&addErrorHandlerIfEventEmitter(n,S,{once:!0})})}function addErrorHandlerIfEventEmitter(n,r,_){typeof n.on=="function"&&eventTargetAgnosticAddListener(n,"error",r,_)}function eventTargetAgnosticAddListener(n,r,_,E){if(typeof n.on=="function")E.once?n.once(r,_):n.on(r,_);else if(typeof n.addEventListener=="function")n.addEventListener(r,function S(C){E.once&&n.removeEventListener(r,S),_(C)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof n)}var eventsExports=events$2.exports;const EventEmitter$3=getDefaultExportFromCjs(eventsExports);class e{constructor(r){this.queue=void 0,this.maxConcurrent=void 0,this.count=void 0,this.queue=[],this.maxConcurrent=r,this.count=0}get canAcquire(){return this.count<this.maxConcurrent}acquire(){return this.canAcquire?(this.count++,Promise.resolve()):new Promise(r=>this.queue.push(r))}release(){const r=this.queue.shift();r?setTimeout(r,0):this.count--}}const t$2="_default";let s$1=class{constructor(r=1){this.semaphoreInstances=void 0,this.maxConcurrent=void 0,this.semaphoreInstances={},this.maxConcurrent=r}hasSemaphoreInstance(r=t$2){return!!this.semaphoreInstances[r]}getSemaphoreInstance(r=t$2){return this.hasSemaphoreInstance(r)||(this.semaphoreInstances[r]=new e(this.maxConcurrent)),this.semaphoreInstances[r]}tidy(r=t$2){this.hasSemaphoreInstance(r)&&this.getSemaphoreInstance(r).count===0&&delete this.semaphoreInstances[r]}canAcquire(r=t$2){return this.getSemaphoreInstance(r).canAcquire}acquire(r=t$2){return this.getSemaphoreInstance(r).acquire()}release(r=t$2){this.getSemaphoreInstance(r).release(),this.tidy(r)}count(r=t$2){return this.hasSemaphoreInstance(r)?this.getSemaphoreInstance(r).count:0}hasTasks(r=t$2){return this.count(r)>0}async request(r,_=t$2){try{return await this.acquire(_),await r()}finally{this.release(_)}}async requestIfAvailable(r,_=t$2){return this.canAcquire(_)?this.request(r,_):null}};var toStr$b=Object.prototype.toString,isArguments$3=function(r){var _=toStr$b.call(r),E=_==="[object Arguments]";return E||(E=_!=="[object Array]"&&r!==null&&typeof r=="object"&&typeof r.length=="number"&&r.length>=0&&toStr$b.call(r.callee)==="[object Function]"),E},implementation$c,hasRequiredImplementation;function requireImplementation(){if(hasRequiredImplementation)return implementation$c;hasRequiredImplementation=1;var n;if(!Object.keys){var r=Object.prototype.hasOwnProperty,_=Object.prototype.toString,E=isArguments$3,S=Object.prototype.propertyIsEnumerable,C=!S.call({toString:null},"toString"),A=S.call(function(){},"prototype"),I=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],B=function(j){var z=j.constructor;return z&&z.prototype===j},O={$applicationCache:!0,$console:!0,$external:!0,$frame:!0,$frameElement:!0,$frames:!0,$innerHeight:!0,$innerWidth:!0,$onmozfullscreenchange:!0,$onmozfullscreenerror:!0,$outerHeight:!0,$outerWidth:!0,$pageXOffset:!0,$pageYOffset:!0,$parent:!0,$scrollLeft:!0,$scrollTop:!0,$scrollX:!0,$scrollY:!0,$self:!0,$webkitIndexedDB:!0,$webkitStorageInfo:!0,$window:!0},N=function(){if(typeof window>"u")return!1;for(var j in window)try{if(!O["$"+j]&&r.call(window,j)&&window[j]!==null&&typeof window[j]=="object")try{B(window[j])}catch{return!0}}catch{return!0}return!1}(),U=function(j){if(typeof window>"u"||!N)return B(j);try{return B(j)}catch{return!1}};n=function(z){var Z=z!==null&&typeof z=="object",X=_.call(z)==="[object Function]",Q=E(z),se=Z&&_.call(z)==="[object String]",oe=[];if(!Z&&!X&&!Q)throw new TypeError("Object.keys called on a non-object");var ue=A&&X;if(se&&z.length>0&&!r.call(z,0))for(var we=0;we<z.length;++we)oe.push(String(we));if(Q&&z.length>0)for(var Te=0;Te<z.length;++Te)oe.push(String(Te));else for(var xe in z)!(ue&&xe==="prototype")&&r.call(z,xe)&&oe.push(String(xe));if(C)for(var Re=U(z),Ne=0;Ne<I.length;++Ne)!(Re&&I[Ne]==="constructor")&&r.call(z,I[Ne])&&oe.push(I[Ne]);return oe}}return implementation$c=n,implementation$c}var slice$1=Array.prototype.slice,isArgs=isArguments$3,origKeys=Object.keys,keysShim=origKeys?function(r){return origKeys(r)}:requireImplementation(),originalKeys=Object.keys;keysShim.shim=function(){if(Object.keys){var r=function(){var _=Object.keys(arguments);return _&&_.length===arguments.length}(1,2);r||(Object.keys=function(E){return isArgs(E)?originalKeys(slice$1.call(E)):originalKeys(E)})}else Object.keys=keysShim;return Object.keys||keysShim};var objectKeys$2=keysShim,esErrors=Error,_eval=EvalError,range$1=RangeError,ref$1=ReferenceError,syntax=SyntaxError,type$c=TypeError,uri$2=URIError,shams$1=function(){if(typeof Symbol!="function"||typeof Object.getOwnPropertySymbols!="function")return!1;if(typeof Symbol.iterator=="symbol")return!0;var r={},_=Symbol("test"),E=Object(_);if(typeof _=="string"||Object.prototype.toString.call(_)!=="[object Symbol]"||Object.prototype.toString.call(E)!=="[object Symbol]")return!1;var S=42;r[_]=S;for(_ in r)return!1;if(typeof Object.keys=="function"&&Object.keys(r).length!==0||typeof Object.getOwnPropertyNames=="function"&&Object.getOwnPropertyNames(r).length!==0)return!1;var C=Object.getOwnPropertySymbols(r);if(C.length!==1||C[0]!==_||!Object.prototype.propertyIsEnumerable.call(r,_))return!1;if(typeof Object.getOwnPropertyDescriptor=="function"){var A=Object.getOwnPropertyDescriptor(r,_);if(A.value!==S||A.enumerable!==!0)return!1}return!0},origSymbol=typeof Symbol<"u"&&Symbol,hasSymbolSham=shams$1,hasSymbols$5=function(){return typeof origSymbol!="function"||typeof Symbol!="function"||typeof origSymbol("foo")!="symbol"||typeof Symbol("bar")!="symbol"?!1:hasSymbolSham()},test={__proto__:null,foo:{}},$Object$1=Object,hasProto$1=function(){return{__proto__:test}.foo===test.foo&&!(test instanceof $Object$1)},ERROR_MESSAGE="Function.prototype.bind called on incompatible ",toStr$a=Object.prototype.toString,max$1=Math.max,funcType="[object Function]",concatty=function(r,_){for(var E=[],S=0;S<r.length;S+=1)E[S]=r[S];for(var C=0;C<_.length;C+=1)E[C+r.length]=_[C];return E},slicy=function(r,_){for(var E=[],S=_||0,C=0;S<r.length;S+=1,C+=1)E[C]=r[S];return E},joiny=function(n,r){for(var _="",E=0;E<n.length;E+=1)_+=n[E],E+1<n.length&&(_+=r);return _},implementation$b=function(r){var _=this;if(typeof _!="function"||toStr$a.apply(_)!==funcType)throw new TypeError(ERROR_MESSAGE+_);for(var E=slicy(arguments,1),S,C=function(){if(this instanceof S){var N=_.apply(this,concatty(E,arguments));return Object(N)===N?N:this}return _.apply(r,concatty(E,arguments))},A=max$1(0,_.length-E.length),I=[],B=0;B<A;B++)I[B]="$"+B;if(S=Function("binder","return function ("+joiny(I,",")+"){ return binder.apply(this,arguments); }")(C),_.prototype){var O=function(){};O.prototype=_.prototype,S.prototype=new O,O.prototype=null}return S},implementation$a=implementation$b,functionBind=Function.prototype.bind||implementation$a,call=Function.prototype.call,$hasOwn=Object.prototype.hasOwnProperty,bind$2=functionBind,hasown=bind$2.call(call,$hasOwn),undefined$1,$Error=esErrors,$EvalError=_eval,$RangeError=range$1,$ReferenceError=ref$1,$SyntaxError$2=syntax,$TypeError$6=type$c,$URIError=uri$2,$Function=Function,getEvalledConstructor=function(n){try{return $Function('"use strict"; return ('+n+").constructor;")()}catch{}},$gOPD$2=Object.getOwnPropertyDescriptor;if($gOPD$2)try{$gOPD$2({},"")}catch{$gOPD$2=null}var throwTypeError=function(){throw new $TypeError$6},ThrowTypeError=$gOPD$2?function(){try{return arguments.callee,throwTypeError}catch{try{return $gOPD$2(arguments,"callee").get}catch{return throwTypeError}}}():throwTypeError,hasSymbols$4=hasSymbols$5(),hasProto=hasProto$1(),getProto$2=Object.getPrototypeOf||(hasProto?function(n){return n.__proto__}:null),needsEval={},TypedArray=typeof Uint8Array>"u"||!getProto$2?undefined$1:getProto$2(Uint8Array),INTRINSICS={__proto__:null,"%AggregateError%":typeof AggregateError>"u"?undefined$1:AggregateError,"%Array%":Array,"%ArrayBuffer%":typeof ArrayBuffer>"u"?undefined$1:ArrayBuffer,"%ArrayIteratorPrototype%":hasSymbols$4&&getProto$2?getProto$2([][Symbol.iterator]()):undefined$1,"%AsyncFromSyncIteratorPrototype%":undefined$1,"%AsyncFunction%":needsEval,"%AsyncGenerator%":needsEval,"%AsyncGeneratorFunction%":needsEval,"%AsyncIteratorPrototype%":needsEval,"%Atomics%":typeof Atomics>"u"?undefined$1:Atomics,"%BigInt%":typeof BigInt>"u"?undefined$1:BigInt,"%BigInt64Array%":typeof BigInt64Array>"u"?undefined$1:BigInt64Array,"%BigUint64Array%":typeof BigUint64Array>"u"?undefined$1:BigUint64Array,"%Boolean%":Boolean,"%DataView%":typeof DataView>"u"?undefined$1:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":$Error,"%eval%":eval,"%EvalError%":$EvalError,"%Float32Array%":typeof Float32Array>"u"?undefined$1:Float32Array,"%Float64Array%":typeof Float64Array>"u"?undefined$1:Float64Array,"%FinalizationRegistry%":typeof FinalizationRegistry>"u"?undefined$1:FinalizationRegistry,"%Function%":$Function,"%GeneratorFunction%":needsEval,"%Int8Array%":typeof Int8Array>"u"?undefined$1:Int8Array,"%Int16Array%":typeof Int16Array>"u"?undefined$1:Int16Array,"%Int32Array%":typeof Int32Array>"u"?undefined$1:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":hasSymbols$4&&getProto$2?getProto$2(getProto$2([][Symbol.iterator]())):undefined$1,"%JSON%":typeof JSON=="object"?JSON:undefined$1,"%Map%":typeof Map>"u"?undefined$1:Map,"%MapIteratorPrototype%":typeof Map>"u"||!hasSymbols$4||!getProto$2?undefined$1:getProto$2(new Map()[Symbol.iterator]()),"%Math%":Math,"%Number%":Number,"%Object%":Object,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":typeof Promise>"u"?undefined$1:Promise,"%Proxy%":typeof Proxy>"u"?undefined$1:Proxy,"%RangeError%":$RangeError,"%ReferenceError%":$ReferenceError,"%Reflect%":typeof Reflect>"u"?undefined$1:Reflect,"%RegExp%":RegExp,"%Set%":typeof Set>"u"?undefined$1:Set,"%SetIteratorPrototype%":typeof Set>"u"||!hasSymbols$4||!getProto$2?undefined$1:getProto$2(new Set()[Symbol.iterator]()),"%SharedArrayBuffer%":typeof SharedArrayBuffer>"u"?undefined$1:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":hasSymbols$4&&getProto$2?getProto$2(""[Symbol.iterator]()):undefined$1,"%Symbol%":hasSymbols$4?Symbol:undefined$1,"%SyntaxError%":$SyntaxError$2,"%ThrowTypeError%":ThrowTypeError,"%TypedArray%":TypedArray,"%TypeError%":$TypeError$6,"%Uint8Array%":typeof Uint8Array>"u"?undefined$1:Uint8Array,"%Uint8ClampedArray%":typeof Uint8ClampedArray>"u"?undefined$1:Uint8ClampedArray,"%Uint16Array%":typeof Uint16Array>"u"?undefined$1:Uint16Array,"%Uint32Array%":typeof Uint32Array>"u"?undefined$1:Uint32Array,"%URIError%":$URIError,"%WeakMap%":typeof WeakMap>"u"?undefined$1:WeakMap,"%WeakRef%":typeof WeakRef>"u"?undefined$1:WeakRef,"%WeakSet%":typeof WeakSet>"u"?undefined$1:WeakSet};if(getProto$2)try{null.error}catch(n){var errorProto=getProto$2(getProto$2(n));INTRINSICS["%Error.prototype%"]=errorProto}var doEval=function n(r){var _;if(r==="%AsyncFunction%")_=getEvalledConstructor("async function () {}");else if(r==="%GeneratorFunction%")_=getEvalledConstructor("function* () {}");else if(r==="%AsyncGeneratorFunction%")_=getEvalledConstructor("async function* () {}");else if(r==="%AsyncGenerator%"){var E=n("%AsyncGeneratorFunction%");E&&(_=E.prototype)}else if(r==="%AsyncIteratorPrototype%"){var S=n("%AsyncGenerator%");S&&getProto$2&&(_=getProto$2(S.prototype))}return INTRINSICS[r]=_,_},LEGACY_ALIASES={__proto__:null,"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},bind$1=functionBind,hasOwn$2=hasown,$concat$1=bind$1.call(Function.call,Array.prototype.concat),$spliceApply=bind$1.call(Function.apply,Array.prototype.splice),$replace$1=bind$1.call(Function.call,String.prototype.replace),$strSlice=bind$1.call(Function.call,String.prototype.slice),$exec$1=bind$1.call(Function.call,RegExp.prototype.exec),rePropName=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,reEscapeChar=/\\(\\)?/g,stringToPath=function(r){var _=$strSlice(r,0,1),E=$strSlice(r,-1);if(_==="%"&&E!=="%")throw new $SyntaxError$2("invalid intrinsic syntax, expected closing `%`");if(E==="%"&&_!=="%")throw new $SyntaxError$2("invalid intrinsic syntax, expected opening `%`");var S=[];return $replace$1(r,rePropName,function(C,A,I,B){S[S.length]=I?$replace$1(B,reEscapeChar,"$1"):A||C}),S},getBaseIntrinsic=function(r,_){var E=r,S;if(hasOwn$2(LEGACY_ALIASES,E)&&(S=LEGACY_ALIASES[E],E="%"+S[0]+"%"),hasOwn$2(INTRINSICS,E)){var C=INTRINSICS[E];if(C===needsEval&&(C=doEval(E)),typeof C>"u"&&!_)throw new $TypeError$6("intrinsic "+r+" exists, but is not available. Please file an issue!");return{alias:S,name:E,value:C}}throw new $SyntaxError$2("intrinsic "+r+" does not exist!")},getIntrinsic=function(r,_){if(typeof r!="string"||r.length===0)throw new $TypeError$6("intrinsic name must be a non-empty string");if(arguments.length>1&&typeof _!="boolean")throw new $TypeError$6('"allowMissing" argument must be a boolean');if($exec$1(/^%?[^%]*%?$/,r)===null)throw new $SyntaxError$2("`%` may not be present anywhere but at the beginning and end of the intrinsic name");var E=stringToPath(r),S=E.length>0?E[0]:"",C=getBaseIntrinsic("%"+S+"%",_),A=C.name,I=C.value,B=!1,O=C.alias;O&&(S=O[0],$spliceApply(E,$concat$1([0,1],O)));for(var N=1,U=!0;N<E.length;N+=1){var j=E[N],z=$strSlice(j,0,1),Z=$strSlice(j,-1);if((z==='"'||z==="'"||z==="`"||Z==='"'||Z==="'"||Z==="`")&&z!==Z)throw new $SyntaxError$2("property names with quotes must have matching quotes");if((j==="constructor"||!U)&&(B=!0),S+="."+j,A="%"+S+"%",hasOwn$2(INTRINSICS,A))I=INTRINSICS[A];else if(I!=null){if(!(j in I)){if(!_)throw new $TypeError$6("base intrinsic for "+r+" exists, but the property is not available.");return}if($gOPD$2&&N+1>=E.length){var X=$gOPD$2(I,j);U=!!X,U&&"get"in X&&!("originalValue"in X.get)?I=X.get:I=I[j]}else U=hasOwn$2(I,j),I=I[j];U&&!B&&(INTRINSICS[A]=I)}}return I},GetIntrinsic$8=getIntrinsic,$defineProperty$2=GetIntrinsic$8("%Object.defineProperty%",!0)||!1;if($defineProperty$2)try{$defineProperty$2({},"a",{value:1})}catch{$defineProperty$2=!1}var esDefineProperty=$defineProperty$2,GetIntrinsic$7=getIntrinsic,$gOPD$1=GetIntrinsic$7("%Object.getOwnPropertyDescriptor%",!0);if($gOPD$1)try{$gOPD$1([],"length")}catch{$gOPD$1=null}var gopd$1=$gOPD$1,$defineProperty$1=esDefineProperty,$SyntaxError$1=syntax,$TypeError$5=type$c,gopd=gopd$1,defineDataProperty$1=function(r,_,E){if(!r||typeof r!="object"&&typeof r!="function")throw new $TypeError$5("`obj` must be an object or a function`");if(typeof _!="string"&&typeof _!="symbol")throw new $TypeError$5("`property` must be a string or a symbol`");if(arguments.length>3&&typeof arguments[3]!="boolean"&&arguments[3]!==null)throw new $TypeError$5("`nonEnumerable`, if provided, must be a boolean or null");if(arguments.length>4&&typeof arguments[4]!="boolean"&&arguments[4]!==null)throw new $TypeError$5("`nonWritable`, if provided, must be a boolean or null");if(arguments.length>5&&typeof arguments[5]!="boolean"&&arguments[5]!==null)throw new $TypeError$5("`nonConfigurable`, if provided, must be a boolean or null");if(arguments.length>6&&typeof arguments[6]!="boolean")throw new $TypeError$5("`loose`, if provided, must be a boolean");var S=arguments.length>3?arguments[3]:null,C=arguments.length>4?arguments[4]:null,A=arguments.length>5?arguments[5]:null,I=arguments.length>6?arguments[6]:!1,B=!!gopd&&gopd(r,_);if($defineProperty$1)$defineProperty$1(r,_,{configurable:A===null&&B?B.configurable:!A,enumerable:S===null&&B?B.enumerable:!S,value:E,writable:C===null&&B?B.writable:!C});else if(I||!S&&!C&&!A)r[_]=E;else throw new $SyntaxError$1("This environment does not support defining a property as non-configurable, non-writable, or non-enumerable.")},$defineProperty=esDefineProperty,hasPropertyDescriptors=function(){return!!$defineProperty};hasPropertyDescriptors.hasArrayLengthDefineBug=function(){if(!$defineProperty)return null;try{return $defineProperty([],"length",{value:1}).length!==1}catch{return!0}};var hasPropertyDescriptors_1=hasPropertyDescriptors,keys$2=objectKeys$2,hasSymbols$3=typeof Symbol=="function"&&typeof Symbol("foo")=="symbol",toStr$9=Object.prototype.toString,concat$6=Array.prototype.concat,defineDataProperty=defineDataProperty$1,isFunction$1=function(n){return typeof n=="function"&&toStr$9.call(n)==="[object Function]"},supportsDescriptors$2=hasPropertyDescriptors_1(),defineProperty$2=function(n,r,_,E){if(r in n){if(E===!0){if(n[r]===_)return}else if(!isFunction$1(E)||!E())return}supportsDescriptors$2?defineDataProperty(n,r,_,!0):defineDataProperty(n,r,_)},defineProperties$1=function(n,r){var _=arguments.length>2?arguments[2]:{},E=keys$2(r);hasSymbols$3&&(E=concat$6.call(E,Object.getOwnPropertySymbols(r)));for(var S=0;S<E.length;S+=1)defineProperty$2(n,E[S],r[E[S]],_[E[S]])};defineProperties$1.supportsDescriptors=!!supportsDescriptors$2;var defineProperties_1=defineProperties$1,callBind$6={exports:{}},GetIntrinsic$6=getIntrinsic,define$6=defineDataProperty$1,hasDescriptors$1=hasPropertyDescriptors_1(),gOPD$4=gopd$1,$TypeError$4=type$c,$floor$1=GetIntrinsic$6("%Math.floor%"),setFunctionLength=function(r,_){if(typeof r!="function")throw new $TypeError$4("`fn` is not a function");if(typeof _!="number"||_<0||_>4294967295||$floor$1(_)!==_)throw new $TypeError$4("`length` must be a positive 32-bit integer");var E=arguments.length>2&&!!arguments[2],S=!0,C=!0;if("length"in r&&gOPD$4){var A=gOPD$4(r,"length");A&&!A.configurable&&(S=!1),A&&!A.writable&&(C=!1)}return(S||C||!E)&&(hasDescriptors$1?define$6(r,"length",_,!0,!0):define$6(r,"length",_)),r};(function(n){var r=functionBind,_=getIntrinsic,E=setFunctionLength,S=type$c,C=_("%Function.prototype.apply%"),A=_("%Function.prototype.call%"),I=_("%Reflect.apply%",!0)||r.call(A,C),B=esDefineProperty,O=_("%Math.max%");n.exports=function(j){if(typeof j!="function")throw new S("a function is required");var z=I(r,A,arguments);return E(z,1+O(0,j.length-(arguments.length-1)),!0)};var N=function(){return I(r,C,arguments)};B?B(n.exports,"apply",{value:N}):n.exports.apply=N})(callBind$6);var callBindExports=callBind$6.exports,GetIntrinsic$5=getIntrinsic,callBind$5=callBindExports,$indexOf$1=callBind$5(GetIntrinsic$5("String.prototype.indexOf")),callBound$c=function(r,_){var E=GetIntrinsic$5(r,!!_);return typeof E=="function"&&$indexOf$1(r,".prototype.")>-1?callBind$5(E):E},objectKeys$1=objectKeys$2,hasSymbols$2=shams$1(),callBound$b=callBound$c,toObject=Object,$push=callBound$b("Array.prototype.push"),$propIsEnumerable=callBound$b("Object.prototype.propertyIsEnumerable"),originalGetSymbols=hasSymbols$2?Object.getOwnPropertySymbols:null,implementation$9=function(r,_){if(r==null)throw new TypeError("target must be an object");var E=toObject(r);if(arguments.length===1)return E;for(var S=1;S<arguments.length;++S){var C=toObject(arguments[S]),A=objectKeys$1(C),I=hasSymbols$2&&(Object.getOwnPropertySymbols||originalGetSymbols);if(I)for(var B=I(C),O=0;O<B.length;++O){var N=B[O];$propIsEnumerable(C,N)&&$push(A,N)}for(var U=0;U<A.length;++U){var j=A[U];if($propIsEnumerable(C,j)){var z=C[j];E[j]=z}}}return E},implementation$8=implementation$9,lacksProperEnumerationOrder=function(){if(!Object.assign)return!1;for(var n="abcdefghijklmnopqrst",r=n.split(""),_={},E=0;E<r.length;++E)_[r[E]]=r[E];var S=Object.assign({},_),C="";for(var A in S)C+=A;return n!==C},assignHasPendingExceptions=function(){if(!Object.assign||!Object.preventExtensions)return!1;var n=Object.preventExtensions({1:2});try{Object.assign(n,"xy")}catch{return n[1]==="y"}return!1},polyfill$4=function(){return!Object.assign||lacksProperEnumerationOrder()||assignHasPendingExceptions()?implementation$8:Object.assign},define$5=defineProperties_1,getPolyfill$5=polyfill$4,shim$5=function(){var r=getPolyfill$5();return define$5(Object,{assign:r},{assign:function(){return Object.assign!==r}}),r},defineProperties=defineProperties_1,callBind$4=callBindExports,implementation$7=implementation$9,getPolyfill$4=polyfill$4,shim$4=shim$5,polyfill$3=callBind$4.apply(getPolyfill$4()),bound=function(r,_){return polyfill$3(Object,arguments)};defineProperties(bound,{getPolyfill:getPolyfill$4,implementation:implementation$7,shim:shim$4});var object_assign=bound,functionsHaveNames=function(){return typeof function(){}.name=="string"},gOPD$3=Object.getOwnPropertyDescriptor;if(gOPD$3)try{gOPD$3([],"length")}catch{gOPD$3=null}functionsHaveNames.functionsHaveConfigurableNames=function(){if(!functionsHaveNames()||!gOPD$3)return!1;var r=gOPD$3(function(){},"name");return!!r&&!!r.configurable};var $bind=Function.prototype.bind;functionsHaveNames.boundFunctionsHaveNames=function(){return functionsHaveNames()&&typeof $bind=="function"&&function(){}.bind().name!==""};var functionsHaveNames_1=functionsHaveNames,define$4=defineDataProperty$1,hasDescriptors=hasPropertyDescriptors_1(),functionsHaveConfigurableNames=functionsHaveNames_1.functionsHaveConfigurableNames(),$TypeError$3=type$c,setFunctionName$1=function(r,_){if(typeof r!="function")throw new $TypeError$3("`fn` is not a function");var E=arguments.length>2&&!!arguments[2];return(!E||functionsHaveConfigurableNames)&&(hasDescriptors?define$4(r,"name",_,!0,!0):define$4(r,"name",_)),r},setFunctionName=setFunctionName$1,$TypeError$2=type$c,$Object=Object,implementation$6=setFunctionName(function(){if(this==null||this!==$Object(this))throw new $TypeError$2("RegExp.prototype.flags getter called on non-object");var r="";return this.hasIndices&&(r+="d"),this.global&&(r+="g"),this.ignoreCase&&(r+="i"),this.multiline&&(r+="m"),this.dotAll&&(r+="s"),this.unicode&&(r+="u"),this.unicodeSets&&(r+="v"),this.sticky&&(r+="y"),r},"get flags",!0),implementation$5=implementation$6,supportsDescriptors$1=defineProperties_1.supportsDescriptors,$gOPD=Object.getOwnPropertyDescriptor,polyfill$2=function(){if(supportsDescriptors$1&&/a/mig.flags==="gim"){var r=$gOPD(RegExp.prototype,"flags");if(r&&typeof r.get=="function"&&typeof RegExp.prototype.dotAll=="boolean"&&typeof RegExp.prototype.hasIndices=="boolean"){var _="",E={};if(Object.defineProperty(E,"hasIndices",{get:function(){_+="d"}}),Object.defineProperty(E,"sticky",{get:function(){_+="y"}}),_==="dy")return r.get}}return implementation$5},supportsDescriptors=defineProperties_1.supportsDescriptors,getPolyfill$3=polyfill$2,gOPD$2=Object.getOwnPropertyDescriptor,defineProperty$1=Object.defineProperty,TypeErr=TypeError,getProto$1=Object.getPrototypeOf,regex=/a/,shim$3=function(){if(!supportsDescriptors||!getProto$1)throw new TypeErr("RegExp.prototype.flags requires a true ES5 environment that supports property descriptors");var r=getPolyfill$3(),_=getProto$1(regex),E=gOPD$2(_,"flags");return(!E||E.get!==r)&&defineProperty$1(_,"flags",{configurable:!0,enumerable:!1,get:r}),r},define$3=defineProperties_1,callBind$3=callBindExports,implementation$4=implementation$6,getPolyfill$2=polyfill$2,shim$2=shim$3,flagsBound=callBind$3(getPolyfill$2());define$3(flagsBound,{getPolyfill:getPolyfill$2,implementation:implementation$4,shim:shim$2});var regexp_prototype_flags=flagsBound,esGetIterator={exports:{}},hasSymbols$1=shams$1,shams=function(){return hasSymbols$1()&&!!Symbol.toStringTag},hasToStringTag$8=shams(),callBound$a=callBound$c,$toString$4=callBound$a("Object.prototype.toString"),isStandardArguments=function(r){return hasToStringTag$8&&r&&typeof r=="object"&&Symbol.toStringTag in r?!1:$toString$4(r)==="[object Arguments]"},isLegacyArguments=function(r){return isStandardArguments(r)?!0:r!==null&&typeof r=="object"&&typeof r.length=="number"&&r.length>=0&&$toString$4(r)!=="[object Array]"&&$toString$4(r.callee)==="[object Function]"},supportsStandardArguments=function(){return isStandardArguments(arguments)}();isStandardArguments.isLegacyArguments=isLegacyArguments;var isArguments$2=supportsStandardArguments?isStandardArguments:isLegacyArguments;const net={},__viteBrowserExternal=Object.freeze(Object.defineProperty({__proto__:null,default:net},Symbol.toStringTag,{value:"Module"})),require$$1$2=getAugmentedNamespace(__viteBrowserExternal);var hasMap=typeof Map=="function"&&Map.prototype,mapSizeDescriptor=Object.getOwnPropertyDescriptor&&hasMap?Object.getOwnPropertyDescriptor(Map.prototype,"size"):null,mapSize=hasMap&&mapSizeDescriptor&&typeof mapSizeDescriptor.get=="function"?mapSizeDescriptor.get:null,mapForEach=hasMap&&Map.prototype.forEach,hasSet=typeof Set=="function"&&Set.prototype,setSizeDescriptor=Object.getOwnPropertyDescriptor&&hasSet?Object.getOwnPropertyDescriptor(Set.prototype,"size"):null,setSize=hasSet&&setSizeDescriptor&&typeof setSizeDescriptor.get=="function"?setSizeDescriptor.get:null,setForEach=hasSet&&Set.prototype.forEach,hasWeakMap=typeof WeakMap=="function"&&WeakMap.prototype,weakMapHas=hasWeakMap?WeakMap.prototype.has:null,hasWeakSet=typeof WeakSet=="function"&&WeakSet.prototype,weakSetHas=hasWeakSet?WeakSet.prototype.has:null,hasWeakRef=typeof WeakRef=="function"&&WeakRef.prototype,weakRefDeref=hasWeakRef?WeakRef.prototype.deref:null,booleanValueOf=Boolean.prototype.valueOf,objectToString=Object.prototype.toString,functionToString=Function.prototype.toString,$match=String.prototype.match,$slice$1=String.prototype.slice,$replace=String.prototype.replace,$toUpperCase=String.prototype.toUpperCase,$toLowerCase=String.prototype.toLowerCase,$test=RegExp.prototype.test,$concat=Array.prototype.concat,$join=Array.prototype.join,$arrSlice=Array.prototype.slice,$floor=Math.floor,bigIntValueOf$1=typeof BigInt=="function"?BigInt.prototype.valueOf:null,gOPS=Object.getOwnPropertySymbols,symToString=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Symbol.prototype.toString:null,hasShammedSymbols=typeof Symbol=="function"&&typeof Symbol.iterator=="object",toStringTag=typeof Symbol=="function"&&Symbol.toStringTag&&(typeof Symbol.toStringTag===hasShammedSymbols||!0)?Symbol.toStringTag:null,isEnumerable=Object.prototype.propertyIsEnumerable,gPO$1=(typeof Reflect=="function"?Reflect.getPrototypeOf:Object.getPrototypeOf)||([].__proto__===Array.prototype?function(n){return n.__proto__}:null);function addNumericSeparator(n,r){if(n===1/0||n===-1/0||n!==n||n&&n>-1e3&&n<1e3||$test.call(/e/,r))return r;var _=/[0-9](?=(?:[0-9]{3})+(?![0-9]))/g;if(typeof n=="number"){var E=n<0?-$floor(-n):$floor(n);if(E!==n){var S=String(E),C=$slice$1.call(r,S.length+1);return $replace.call(S,_,"$&_")+"."+$replace.call($replace.call(C,/([0-9]{3})/g,"$&_"),/_$/,"")}}return $replace.call(r,_,"$&_")}var utilInspect=require$$1$2,inspectCustom=utilInspect.custom,inspectSymbol=isSymbol$2(inspectCustom)?inspectCustom:null,objectInspect=function n(r,_,E,S){var C=_||{};if(has$1(C,"quoteStyle")&&C.quoteStyle!=="single"&&C.quoteStyle!=="double")throw new TypeError('option "quoteStyle" must be "single" or "double"');if(has$1(C,"maxStringLength")&&(typeof C.maxStringLength=="number"?C.maxStringLength<0&&C.maxStringLength!==1/0:C.maxStringLength!==null))throw new TypeError('option "maxStringLength", if provided, must be a positive integer, Infinity, or `null`');var A=has$1(C,"customInspect")?C.customInspect:!0;if(typeof A!="boolean"&&A!=="symbol")throw new TypeError("option \"customInspect\", if provided, must be `true`, `false`, or `'symbol'`");if(has$1(C,"indent")&&C.indent!==null&&C.indent!=="	"&&!(parseInt(C.indent,10)===C.indent&&C.indent>0))throw new TypeError('option "indent" must be "\\t", an integer > 0, or `null`');if(has$1(C,"numericSeparator")&&typeof C.numericSeparator!="boolean")throw new TypeError('option "numericSeparator", if provided, must be `true` or `false`');var I=C.numericSeparator;if(typeof r>"u")return"undefined";if(r===null)return"null";if(typeof r=="boolean")return r?"true":"false";if(typeof r=="string")return inspectString(r,C);if(typeof r=="number"){if(r===0)return 1/0/r>0?"0":"-0";var B=String(r);return I?addNumericSeparator(r,B):B}if(typeof r=="bigint"){var O=String(r)+"n";return I?addNumericSeparator(r,O):O}var N=typeof C.depth>"u"?5:C.depth;if(typeof E>"u"&&(E=0),E>=N&&N>0&&typeof r=="object")return isArray$3(r)?"[Array]":"[Object]";var U=getIndent(C,E);if(typeof S>"u")S=[];else if(indexOf$1(S,r)>=0)return"[Circular]";function j(Ce,_e,Ie){if(_e&&(S=$arrSlice.call(S),S.push(_e)),Ie){var He={depth:C.depth};return has$1(C,"quoteStyle")&&(He.quoteStyle=C.quoteStyle),n(Ce,He,E+1,S)}return n(Ce,C,E+1,S)}if(typeof r=="function"&&!isRegExp$1(r)){var z=nameOf(r),Z=arrObjKeys(r,j);return"[Function"+(z?": "+z:" (anonymous)")+"]"+(Z.length>0?" { "+$join.call(Z,", ")+" }":"")}if(isSymbol$2(r)){var X=hasShammedSymbols?$replace.call(String(r),/^(Symbol\(.*\))_[^)]*$/,"$1"):symToString.call(r);return typeof r=="object"&&!hasShammedSymbols?markBoxed(X):X}if(isElement(r)){for(var Q="<"+$toLowerCase.call(String(r.nodeName)),se=r.attributes||[],oe=0;oe<se.length;oe++)Q+=" "+se[oe].name+"="+wrapQuotes(quote(se[oe].value),"double",C);return Q+=">",r.childNodes&&r.childNodes.length&&(Q+="..."),Q+="</"+$toLowerCase.call(String(r.nodeName))+">",Q}if(isArray$3(r)){if(r.length===0)return"[]";var ue=arrObjKeys(r,j);return U&&!singleLineValues(ue)?"["+indentedJoin(ue,U)+"]":"[ "+$join.call(ue,", ")+" ]"}if(isError(r)){var we=arrObjKeys(r,j);return!("cause"in Error.prototype)&&"cause"in r&&!isEnumerable.call(r,"cause")?"{ ["+String(r)+"] "+$join.call($concat.call("[cause]: "+j(r.cause),we),", ")+" }":we.length===0?"["+String(r)+"]":"{ ["+String(r)+"] "+$join.call(we,", ")+" }"}if(typeof r=="object"&&A){if(inspectSymbol&&typeof r[inspectSymbol]=="function"&&utilInspect)return utilInspect(r,{depth:N-E});if(A!=="symbol"&&typeof r.inspect=="function")return r.inspect()}if(isMap$3(r)){var Te=[];return mapForEach&&mapForEach.call(r,function(Ce,_e){Te.push(j(_e,r,!0)+" => "+j(Ce,r))}),collectionOf("Map",mapSize.call(r),Te,U)}if(isSet$3(r)){var xe=[];return setForEach&&setForEach.call(r,function(Ce){xe.push(j(Ce,r))}),collectionOf("Set",setSize.call(r),xe,U)}if(isWeakMap$1(r))return weakCollectionOf("WeakMap");if(isWeakSet$1(r))return weakCollectionOf("WeakSet");if(isWeakRef(r))return weakCollectionOf("WeakRef");if(isNumber$2(r))return markBoxed(j(Number(r)));if(isBigInt$1(r))return markBoxed(j(bigIntValueOf$1.call(r)));if(isBoolean$2(r))return markBoxed(booleanValueOf.call(r));if(isString$4(r))return markBoxed(j(String(r)));if(typeof window<"u"&&r===window)return"{ [object Window] }";if(r===commonjsGlobal)return"{ [object globalThis] }";if(!isDate$2(r)&&!isRegExp$1(r)){var Re=arrObjKeys(r,j),Ne=gPO$1?gPO$1(r)===Object.prototype:r instanceof Object||r.constructor===Object,Fe=r instanceof Object?"":"null prototype",ht=!Ne&&toStringTag&&Object(r)===r&&toStringTag in r?$slice$1.call(toStr$8(r),8,-1):Fe?"Object":"",nt=Ne||typeof r.constructor!="function"?"":r.constructor.name?r.constructor.name+" ":"",Ee=nt+(ht||Fe?"["+$join.call($concat.call([],ht||[],Fe||[]),": ")+"] ":"");return Re.length===0?Ee+"{}":U?Ee+"{"+indentedJoin(Re,U)+"}":Ee+"{ "+$join.call(Re,", ")+" }"}return String(r)};function wrapQuotes(n,r,_){var E=(_.quoteStyle||r)==="double"?'"':"'";return E+n+E}function quote(n){return $replace.call(String(n),/"/g,"&quot;")}function isArray$3(n){return toStr$8(n)==="[object Array]"&&(!toStringTag||!(typeof n=="object"&&toStringTag in n))}function isDate$2(n){return toStr$8(n)==="[object Date]"&&(!toStringTag||!(typeof n=="object"&&toStringTag in n))}function isRegExp$1(n){return toStr$8(n)==="[object RegExp]"&&(!toStringTag||!(typeof n=="object"&&toStringTag in n))}function isError(n){return toStr$8(n)==="[object Error]"&&(!toStringTag||!(typeof n=="object"&&toStringTag in n))}function isString$4(n){return toStr$8(n)==="[object String]"&&(!toStringTag||!(typeof n=="object"&&toStringTag in n))}function isNumber$2(n){return toStr$8(n)==="[object Number]"&&(!toStringTag||!(typeof n=="object"&&toStringTag in n))}function isBoolean$2(n){return toStr$8(n)==="[object Boolean]"&&(!toStringTag||!(typeof n=="object"&&toStringTag in n))}function isSymbol$2(n){if(hasShammedSymbols)return n&&typeof n=="object"&&n instanceof Symbol;if(typeof n=="symbol")return!0;if(!n||typeof n!="object"||!symToString)return!1;try{return symToString.call(n),!0}catch{}return!1}function isBigInt$1(n){if(!n||typeof n!="object"||!bigIntValueOf$1)return!1;try{return bigIntValueOf$1.call(n),!0}catch{}return!1}var hasOwn$1=Object.prototype.hasOwnProperty||function(n){return n in this};function has$1(n,r){return hasOwn$1.call(n,r)}function toStr$8(n){return objectToString.call(n)}function nameOf(n){if(n.name)return n.name;var r=$match.call(functionToString.call(n),/^function\s*([\w$]+)/);return r?r[1]:null}function indexOf$1(n,r){if(n.indexOf)return n.indexOf(r);for(var _=0,E=n.length;_<E;_++)if(n[_]===r)return _;return-1}function isMap$3(n){if(!mapSize||!n||typeof n!="object")return!1;try{mapSize.call(n);try{setSize.call(n)}catch{return!0}return n instanceof Map}catch{}return!1}function isWeakMap$1(n){if(!weakMapHas||!n||typeof n!="object")return!1;try{weakMapHas.call(n,weakMapHas);try{weakSetHas.call(n,weakSetHas)}catch{return!0}return n instanceof WeakMap}catch{}return!1}function isWeakRef(n){if(!weakRefDeref||!n||typeof n!="object")return!1;try{return weakRefDeref.call(n),!0}catch{}return!1}function isSet$3(n){if(!setSize||!n||typeof n!="object")return!1;try{setSize.call(n);try{mapSize.call(n)}catch{return!0}return n instanceof Set}catch{}return!1}function isWeakSet$1(n){if(!weakSetHas||!n||typeof n!="object")return!1;try{weakSetHas.call(n,weakSetHas);try{weakMapHas.call(n,weakMapHas)}catch{return!0}return n instanceof WeakSet}catch{}return!1}function isElement(n){return!n||typeof n!="object"?!1:typeof HTMLElement<"u"&&n instanceof HTMLElement?!0:typeof n.nodeName=="string"&&typeof n.getAttribute=="function"}function inspectString(n,r){if(n.length>r.maxStringLength){var _=n.length-r.maxStringLength,E="... "+_+" more character"+(_>1?"s":"");return inspectString($slice$1.call(n,0,r.maxStringLength),r)+E}var S=$replace.call($replace.call(n,/(['\\])/g,"\\$1"),/[\x00-\x1f]/g,lowbyte);return wrapQuotes(S,"single",r)}function lowbyte(n){var r=n.charCodeAt(0),_={8:"b",9:"t",10:"n",12:"f",13:"r"}[r];return _?"\\"+_:"\\x"+(r<16?"0":"")+$toUpperCase.call(r.toString(16))}function markBoxed(n){return"Object("+n+")"}function weakCollectionOf(n){return n+" { ? }"}function collectionOf(n,r,_,E){var S=E?indentedJoin(_,E):$join.call(_,", ");return n+" ("+r+") {"+S+"}"}function singleLineValues(n){for(var r=0;r<n.length;r++)if(indexOf$1(n[r],`
`)>=0)return!1;return!0}function getIndent(n,r){var _;if(n.indent==="	")_="	";else if(typeof n.indent=="number"&&n.indent>0)_=$join.call(Array(n.indent+1)," ");else return null;return{base:_,prev:$join.call(Array(r+1),_)}}function indentedJoin(n,r){if(n.length===0)return"";var _=`
`+r.prev+r.base;return _+$join.call(n,","+_)+`
`+r.prev}function arrObjKeys(n,r){var _=isArray$3(n),E=[];if(_){E.length=n.length;for(var S=0;S<n.length;S++)E[S]=has$1(n,S)?r(n[S],n):""}var C=typeof gOPS=="function"?gOPS(n):[],A;if(hasShammedSymbols){A={};for(var I=0;I<C.length;I++)A["$"+C[I]]=C[I]}for(var B in n)has$1(n,B)&&(_&&String(Number(B))===B&&B<n.length||hasShammedSymbols&&A["$"+B]instanceof Symbol||($test.call(/[^\w$]/,B)?E.push(r(B,n)+": "+r(n[B],n)):E.push(B+": "+r(n[B],n))));if(typeof gOPS=="function")for(var O=0;O<C.length;O++)isEnumerable.call(n,C[O])&&E.push("["+r(C[O])+"]: "+r(n[C[O]],n));return E}var GetIntrinsic$4=getIntrinsic,callBound$9=callBound$c,inspect$3=objectInspect,$TypeError$1=type$c,$WeakMap$1=GetIntrinsic$4("%WeakMap%",!0),$Map$3=GetIntrinsic$4("%Map%",!0),$weakMapGet=callBound$9("WeakMap.prototype.get",!0),$weakMapSet=callBound$9("WeakMap.prototype.set",!0),$weakMapHas=callBound$9("WeakMap.prototype.has",!0),$mapGet$1=callBound$9("Map.prototype.get",!0),$mapSet=callBound$9("Map.prototype.set",!0),$mapHas$5=callBound$9("Map.prototype.has",!0),listGetNode=function(n,r){for(var _=n,E;(E=_.next)!==null;_=E)if(E.key===r)return _.next=E.next,E.next=n.next,n.next=E,E},listGet=function(n,r){var _=listGetNode(n,r);return _&&_.value},listSet=function(n,r,_){var E=listGetNode(n,r);E?E.value=_:n.next={key:r,next:n.next,value:_}},listHas=function(n,r){return!!listGetNode(n,r)},sideChannel=function(){var r,_,E,S={assert:function(C){if(!S.has(C))throw new $TypeError$1("Side channel does not contain "+inspect$3(C))},get:function(C){if($WeakMap$1&&C&&(typeof C=="object"||typeof C=="function")){if(r)return $weakMapGet(r,C)}else if($Map$3){if(_)return $mapGet$1(_,C)}else if(E)return listGet(E,C)},has:function(C){if($WeakMap$1&&C&&(typeof C=="object"||typeof C=="function")){if(r)return $weakMapHas(r,C)}else if($Map$3){if(_)return $mapHas$5(_,C)}else if(E)return listHas(E,C);return!1},set:function(C,A){$WeakMap$1&&C&&(typeof C=="object"||typeof C=="function")?(r||(r=new $WeakMap$1),$weakMapSet(r,C,A)):$Map$3?(_||(_=new $Map$3),$mapSet(_,C,A)):(E||(E={key:{},next:null}),listSet(E,C,A))}};return S},hasOwn=hasown,channel=sideChannel(),$TypeError=type$c,SLOT$1={assert:function(n,r){if(!n||typeof n!="object"&&typeof n!="function")throw new $TypeError("`O` is not an object");if(typeof r!="string")throw new $TypeError("`slot` must be a string");if(channel.assert(n),!SLOT$1.has(n,r))throw new $TypeError("`"+r+"` is not present on `O`")},get:function(n,r){if(!n||typeof n!="object"&&typeof n!="function")throw new $TypeError("`O` is not an object");if(typeof r!="string")throw new $TypeError("`slot` must be a string");var _=channel.get(n);return _&&_["$"+r]},has:function(n,r){if(!n||typeof n!="object"&&typeof n!="function")throw new $TypeError("`O` is not an object");if(typeof r!="string")throw new $TypeError("`slot` must be a string");var _=channel.get(n);return!!_&&hasOwn(_,"$"+r)},set:function(n,r,_){if(!n||typeof n!="object"&&typeof n!="function")throw new $TypeError("`O` is not an object");if(typeof r!="string")throw new $TypeError("`slot` must be a string");var E=channel.get(n);E||(E={},channel.set(n,E)),E["$"+r]=_}};Object.freeze&&Object.freeze(SLOT$1);var internalSlot=SLOT$1,SLOT=internalSlot,$SyntaxError=SyntaxError,$StopIteration=typeof StopIteration=="object"?StopIteration:null,stopIterationIterator=function(r){if(!$StopIteration)throw new $SyntaxError("this environment lacks StopIteration");SLOT.set(r,"[[Done]]",!1);var _={next:function(){var S=SLOT.get(this,"[[Iterator]]"),C=SLOT.get(S,"[[Done]]");try{return{done:C,value:C?void 0:S.next()}}catch(A){if(SLOT.set(S,"[[Done]]",!0),A!==$StopIteration)throw A;return{done:!0,value:void 0}}}};return SLOT.set(_,"[[Iterator]]",r),_},toString$9={}.toString,isarray$1=Array.isArray||function(n){return toString$9.call(n)=="[object Array]"},strValue=String.prototype.valueOf,tryStringObject=function(r){try{return strValue.call(r),!0}catch{return!1}},toStr$7=Object.prototype.toString,strClass="[object String]",hasToStringTag$7=shams(),isString$3=function(r){return typeof r=="string"?!0:typeof r!="object"?!1:hasToStringTag$7?tryStringObject(r):toStr$7.call(r)===strClass},$Map$2=typeof Map=="function"&&Map.prototype?Map:null,$Set$3=typeof Set=="function"&&Set.prototype?Set:null,exported$2;$Map$2||(exported$2=function(r){return!1});var $mapHas$4=$Map$2?Map.prototype.has:null,$setHas$4=$Set$3?Set.prototype.has:null;!exported$2&&!$mapHas$4&&(exported$2=function(r){return!1});var isMap$2=exported$2||function(r){if(!r||typeof r!="object")return!1;try{if($mapHas$4.call(r),$setHas$4)try{$setHas$4.call(r)}catch{return!0}return r instanceof $Map$2}catch{}return!1},$Map$1=typeof Map=="function"&&Map.prototype?Map:null,$Set$2=typeof Set=="function"&&Set.prototype?Set:null,exported$1;$Set$2||(exported$1=function(r){return!1});var $mapHas$3=$Map$1?Map.prototype.has:null,$setHas$3=$Set$2?Set.prototype.has:null;!exported$1&&!$setHas$3&&(exported$1=function(r){return!1});var isSet$2=exported$1||function(r){if(!r||typeof r!="object")return!1;try{if($setHas$3.call(r),$mapHas$3)try{$mapHas$3.call(r)}catch{return!0}return r instanceof $Set$2}catch{}return!1},isArguments$1=isArguments$2,getStopIterationIterator=stopIterationIterator;if(hasSymbols$5()||shams$1()){var $iterator=Symbol.iterator;esGetIterator.exports=function(r){if(r!=null&&typeof r[$iterator]<"u")return r[$iterator]();if(isArguments$1(r))return Array.prototype[$iterator].call(r)}}else{var isArray$2=isarray$1,isString$2=isString$3,GetIntrinsic$3=getIntrinsic,$Map=GetIntrinsic$3("%Map%",!0),$Set$1=GetIntrinsic$3("%Set%",!0),callBound$8=callBound$c,$arrayPush=callBound$8("Array.prototype.push"),$charCodeAt=callBound$8("String.prototype.charCodeAt"),$stringSlice=callBound$8("String.prototype.slice"),advanceStringIndex=function(r,_){var E=r.length;if(_+1>=E)return _+1;var S=$charCodeAt(r,_);if(S<55296||S>56319)return _+1;var C=$charCodeAt(r,_+1);return C<56320||C>57343?_+1:_+2},getArrayIterator=function(r){var _=0;return{next:function(){var S=_>=r.length,C;return S||(C=r[_],_+=1),{done:S,value:C}}}},getNonCollectionIterator=function(r,_){if(isArray$2(r)||isArguments$1(r))return getArrayIterator(r);if(isString$2(r)){var E=0;return{next:function(){var C=advanceStringIndex(r,E),A=$stringSlice(r,E,C);return E=C,{done:C>r.length,value:A}}}}if(_&&typeof r["_es6-shim iterator_"]<"u")return r["_es6-shim iterator_"]()};if(!$Map&&!$Set$1)esGetIterator.exports=function(r){if(r!=null)return getNonCollectionIterator(r,!0)};else{var isMap$1=isMap$2,isSet$1=isSet$2,$mapForEach=callBound$8("Map.prototype.forEach",!0),$setForEach=callBound$8("Set.prototype.forEach",!0);if(typeof browser$1$1>"u"||!browser$1$1.versions||!browser$1$1.versions.node)var $mapIterator=callBound$8("Map.prototype.iterator",!0),$setIterator=callBound$8("Set.prototype.iterator",!0);var $mapAtAtIterator=callBound$8("Map.prototype.@@iterator",!0)||callBound$8("Map.prototype._es6-shim iterator_",!0),$setAtAtIterator=callBound$8("Set.prototype.@@iterator",!0)||callBound$8("Set.prototype._es6-shim iterator_",!0),getCollectionIterator=function(r){if(isMap$1(r)){if($mapIterator)return getStopIterationIterator($mapIterator(r));if($mapAtAtIterator)return $mapAtAtIterator(r);if($mapForEach){var _=[];return $mapForEach(r,function(S,C){$arrayPush(_,[C,S])}),getArrayIterator(_)}}if(isSet$1(r)){if($setIterator)return getStopIterationIterator($setIterator(r));if($setAtAtIterator)return $setAtAtIterator(r);if($setForEach){var E=[];return $setForEach(r,function(S){$arrayPush(E,S)}),getArrayIterator(E)}}};esGetIterator.exports=function(r){return getCollectionIterator(r)||getNonCollectionIterator(r)}}}var esGetIteratorExports=esGetIterator.exports,numberIsNaN=function(n){return n!==n},implementation$3=function(r,_){return r===0&&_===0?1/r===1/_:!!(r===_||numberIsNaN(r)&&numberIsNaN(_))},implementation$2=implementation$3,polyfill$1=function(){return typeof Object.is=="function"?Object.is:implementation$2},getPolyfill$1=polyfill$1,define$2=defineProperties_1,shim$1=function(){var r=getPolyfill$1();return define$2(Object,{is:r},{is:function(){return Object.is!==r}}),r},define$1=defineProperties_1,callBind$2=callBindExports,implementation$1=implementation$3,getPolyfill=polyfill$1,shim=shim$1,polyfill=callBind$2(getPolyfill(),Object);define$1(polyfill,{getPolyfill,implementation:implementation$1,shim});var objectIs=polyfill,callBind$1=callBindExports,callBound$7=callBound$c,GetIntrinsic$2=getIntrinsic,$ArrayBuffer=GetIntrinsic$2("%ArrayBuffer%",!0),$byteLength$2=callBound$7("ArrayBuffer.prototype.byteLength",!0),$toString$3=callBound$7("Object.prototype.toString"),abSlice=!!$ArrayBuffer&&!$byteLength$2&&new $ArrayBuffer(0).slice,$abSlice=!!abSlice&&callBind$1(abSlice),isArrayBuffer$4=$byteLength$2||$abSlice?function(r){if(!r||typeof r!="object")return!1;try{return $byteLength$2?$byteLength$2(r):$abSlice(r,0),!0}catch{return!1}}:$ArrayBuffer?function(r){return $toString$3(r)==="[object ArrayBuffer]"}:function(r){return!1},getDay=Date.prototype.getDay,tryDateObject=function(r){try{return getDay.call(r),!0}catch{return!1}},toStr$6=Object.prototype.toString,dateClass="[object Date]",hasToStringTag$6=shams(),isDateObject=function(r){return typeof r!="object"||r===null?!1:hasToStringTag$6?tryDateObject(r):toStr$6.call(r)===dateClass},callBound$6=callBound$c,hasToStringTag$5=shams(),has,$exec,isRegexMarker,badStringifier;if(hasToStringTag$5){has=callBound$6("Object.prototype.hasOwnProperty"),$exec=callBound$6("RegExp.prototype.exec"),isRegexMarker={};var throwRegexMarker=function(){throw isRegexMarker};badStringifier={toString:throwRegexMarker,valueOf:throwRegexMarker},typeof Symbol.toPrimitive=="symbol"&&(badStringifier[Symbol.toPrimitive]=throwRegexMarker)}var $toString$2=callBound$6("Object.prototype.toString"),gOPD$1=Object.getOwnPropertyDescriptor,regexClass="[object RegExp]",isRegex$1=hasToStringTag$5?function(r){if(!r||typeof r!="object")return!1;var _=gOPD$1(r,"lastIndex"),E=_&&has(_,"value");if(!E)return!1;try{$exec(r,badStringifier)}catch(S){return S===isRegexMarker}}:function(r){return!r||typeof r!="object"&&typeof r!="function"?!1:$toString$2(r)===regexClass},callBound$5=callBound$c,$byteLength$1=callBound$5("SharedArrayBuffer.prototype.byteLength",!0),isSharedArrayBuffer$1=$byteLength$1?function(r){if(!r||typeof r!="object")return!1;try{return $byteLength$1(r),!0}catch{return!1}}:function(r){return!1},numToStr=Number.prototype.toString,tryNumberObject=function(r){try{return numToStr.call(r),!0}catch{return!1}},toStr$5=Object.prototype.toString,numClass="[object Number]",hasToStringTag$4=shams(),isNumberObject=function(r){return typeof r=="number"?!0:typeof r!="object"?!1:hasToStringTag$4?tryNumberObject(r):toStr$5.call(r)===numClass},callBound$4=callBound$c,$boolToStr=callBound$4("Boolean.prototype.toString"),$toString$1=callBound$4("Object.prototype.toString"),tryBooleanObject=function(r){try{return $boolToStr(r),!0}catch{return!1}},boolClass="[object Boolean]",hasToStringTag$3=shams(),isBooleanObject=function(r){return typeof r=="boolean"?!0:r===null||typeof r!="object"?!1:hasToStringTag$3&&Symbol.toStringTag in r?tryBooleanObject(r):$toString$1(r)===boolClass},isSymbol$1={exports:{}},toStr$4=Object.prototype.toString,hasSymbols=hasSymbols$5();if(hasSymbols){var symToStr=Symbol.prototype.toString,symStringRegex=/^Symbol\(.*\)$/,isSymbolObject=function(r){return typeof r.valueOf()!="symbol"?!1:symStringRegex.test(symToStr.call(r))};isSymbol$1.exports=function(r){if(typeof r=="symbol")return!0;if(toStr$4.call(r)!=="[object Symbol]")return!1;try{return isSymbolObject(r)}catch{return!1}}}else isSymbol$1.exports=function(r){return!1};var isSymbolExports=isSymbol$1.exports,isBigint={exports:{}},$BigInt=typeof BigInt<"u"&&BigInt,hasBigints=function(){return typeof $BigInt=="function"&&typeof BigInt=="function"&&typeof $BigInt(42)=="bigint"&&typeof BigInt(42)=="bigint"},hasBigInts=hasBigints();if(hasBigInts){var bigIntValueOf=BigInt.prototype.valueOf,tryBigInt=function(r){try{return bigIntValueOf.call(r),!0}catch{}return!1};isBigint.exports=function(r){return r===null||typeof r>"u"||typeof r=="boolean"||typeof r=="string"||typeof r=="number"||typeof r=="symbol"||typeof r=="function"?!1:typeof r=="bigint"?!0:tryBigInt(r)}}else isBigint.exports=function(r){return!1};var isBigintExports=isBigint.exports,isString$1=isString$3,isNumber$1=isNumberObject,isBoolean$1=isBooleanObject,isSymbol=isSymbolExports,isBigInt=isBigintExports,whichBoxedPrimitive$1=function(r){if(r==null||typeof r!="object"&&typeof r!="function")return null;if(isString$1(r))return"String";if(isNumber$1(r))return"Number";if(isBoolean$1(r))return"Boolean";if(isSymbol(r))return"Symbol";if(isBigInt(r))return"BigInt"},$WeakMap=typeof WeakMap=="function"&&WeakMap.prototype?WeakMap:null,$WeakSet$1=typeof WeakSet=="function"&&WeakSet.prototype?WeakSet:null,exported;$WeakMap||(exported=function(r){return!1});var $mapHas$2=$WeakMap?$WeakMap.prototype.has:null,$setHas$2=$WeakSet$1?$WeakSet$1.prototype.has:null;!exported&&!$mapHas$2&&(exported=function(r){return!1});var isWeakmap=exported||function(r){if(!r||typeof r!="object")return!1;try{if($mapHas$2.call(r,$mapHas$2),$setHas$2)try{$setHas$2.call(r,$setHas$2)}catch{return!0}return r instanceof $WeakMap}catch{}return!1},isWeakset={exports:{}},GetIntrinsic$1=getIntrinsic,callBound$3=callBound$c,$WeakSet=GetIntrinsic$1("%WeakSet%",!0),$setHas$1=callBound$3("WeakSet.prototype.has",!0);if($setHas$1){var $mapHas$1=callBound$3("WeakMap.prototype.has",!0);isWeakset.exports=function(r){if(!r||typeof r!="object")return!1;try{if($setHas$1(r,$setHas$1),$mapHas$1)try{$mapHas$1(r,$mapHas$1)}catch{return!0}return r instanceof $WeakSet}catch{}return!1}}else isWeakset.exports=function(r){return!1};var isWeaksetExports=isWeakset.exports,isMap=isMap$2,isSet=isSet$2,isWeakMap=isWeakmap,isWeakSet=isWeaksetExports,whichCollection$1=function(r){if(r&&typeof r=="object"){if(isMap(r))return"Map";if(isSet(r))return"Set";if(isWeakMap(r))return"WeakMap";if(isWeakSet(r))return"WeakSet"}return!1},fnToStr$1=Function.prototype.toString,reflectApply=typeof Reflect=="object"&&Reflect!==null&&Reflect.apply,badArrayLike,isCallableMarker;if(typeof reflectApply=="function"&&typeof Object.defineProperty=="function")try{badArrayLike=Object.defineProperty({},"length",{get:function(){throw isCallableMarker}}),isCallableMarker={},reflectApply(function(){throw 42},null,badArrayLike)}catch(n){n!==isCallableMarker&&(reflectApply=null)}else reflectApply=null;var constructorRegex=/^\s*class\b/,isES6ClassFn=function(r){try{var _=fnToStr$1.call(r);return constructorRegex.test(_)}catch{return!1}},tryFunctionObject=function(r){try{return isES6ClassFn(r)?!1:(fnToStr$1.call(r),!0)}catch{return!1}},toStr$3=Object.prototype.toString,objectClass="[object Object]",fnClass="[object Function]",genClass="[object GeneratorFunction]",ddaClass="[object HTMLAllCollection]",ddaClass2="[object HTML document.all class]",ddaClass3="[object HTMLCollection]",hasToStringTag$2=typeof Symbol=="function"&&!!Symbol.toStringTag,isIE68=!(0 in[,]),isDDA=function(){return!1};if(typeof document=="object"){var all$2=document.all;toStr$3.call(all$2)===toStr$3.call(document.all)&&(isDDA=function(r){if((isIE68||!r)&&(typeof r>"u"||typeof r=="object"))try{var _=toStr$3.call(r);return(_===ddaClass||_===ddaClass2||_===ddaClass3||_===objectClass)&&r("")==null}catch{}return!1})}var isCallable$1=reflectApply?function(r){if(isDDA(r))return!0;if(!r||typeof r!="function"&&typeof r!="object")return!1;try{reflectApply(r,null,badArrayLike)}catch(_){if(_!==isCallableMarker)return!1}return!isES6ClassFn(r)&&tryFunctionObject(r)}:function(r){if(isDDA(r))return!0;if(!r||typeof r!="function"&&typeof r!="object")return!1;if(hasToStringTag$2)return tryFunctionObject(r);if(isES6ClassFn(r))return!1;var _=toStr$3.call(r);return _!==fnClass&&_!==genClass&&!/^\[object HTML/.test(_)?!1:tryFunctionObject(r)},isCallable=isCallable$1,toStr$2=Object.prototype.toString,hasOwnProperty$3=Object.prototype.hasOwnProperty,forEachArray=function(r,_,E){for(var S=0,C=r.length;S<C;S++)hasOwnProperty$3.call(r,S)&&(E==null?_(r[S],S,r):_.call(E,r[S],S,r))},forEachString=function(r,_,E){for(var S=0,C=r.length;S<C;S++)E==null?_(r.charAt(S),S,r):_.call(E,r.charAt(S),S,r)},forEachObject=function(r,_,E){for(var S in r)hasOwnProperty$3.call(r,S)&&(E==null?_(r[S],S,r):_.call(E,r[S],S,r))},forEach$4=function(r,_,E){if(!isCallable(_))throw new TypeError("iterator must be a function");var S;arguments.length>=3&&(S=E),toStr$2.call(r)==="[object Array]"?forEachArray(r,_,S):typeof r=="string"?forEachString(r,_,S):forEachObject(r,_,S)},forEach_1=forEach$4,possibleTypedArrayNames=["Float32Array","Float64Array","Int8Array","Int16Array","Int32Array","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","BigInt64Array","BigUint64Array"],possibleNames=possibleTypedArrayNames,g$1=typeof globalThis>"u"?commonjsGlobal:globalThis,availableTypedArrays$1=function(){for(var r=[],_=0;_<possibleNames.length;_++)typeof g$1[possibleNames[_]]=="function"&&(r[r.length]=possibleNames[_]);return r},forEach$3=forEach_1,availableTypedArrays=availableTypedArrays$1,callBind=callBindExports,callBound$2=callBound$c,gOPD=gopd$1,$toString=callBound$2("Object.prototype.toString"),hasToStringTag$1=shams(),g=typeof globalThis>"u"?commonjsGlobal:globalThis,typedArrays=availableTypedArrays(),$slice=callBound$2("String.prototype.slice"),getPrototypeOf$1=Object.getPrototypeOf,$indexOf=callBound$2("Array.prototype.indexOf",!0)||function(r,_){for(var E=0;E<r.length;E+=1)if(r[E]===_)return E;return-1},cache$4={__proto__:null};hasToStringTag$1&&gOPD&&getPrototypeOf$1?forEach$3(typedArrays,function(n){var r=new g[n];if(Symbol.toStringTag in r){var _=getPrototypeOf$1(r),E=gOPD(_,Symbol.toStringTag);if(!E){var S=getPrototypeOf$1(_);E=gOPD(S,Symbol.toStringTag)}cache$4["$"+n]=callBind(E.get)}}):forEach$3(typedArrays,function(n){var r=new g[n],_=r.slice||r.set;_&&(cache$4["$"+n]=callBind(_))});var tryTypedArrays=function(r){var _=!1;return forEach$3(cache$4,function(E,S){if(!_)try{"$"+E(r)===S&&(_=$slice(S,1))}catch{}}),_},trySlices=function(r){var _=!1;return forEach$3(cache$4,function(E,S){if(!_)try{E(r),_=$slice(S,1)}catch{}}),_},whichTypedArray$2=function(r){if(!r||typeof r!="object")return!1;if(!hasToStringTag$1){var _=$slice($toString(r),8,-1);return $indexOf(typedArrays,_)>-1?_:_!=="Object"?!1:trySlices(r)}return gOPD?tryTypedArrays(r):null},callBound$1=callBound$c,$byteLength=callBound$1("ArrayBuffer.prototype.byteLength",!0),isArrayBuffer$3=isArrayBuffer$4,arrayBufferByteLength=function(r){return isArrayBuffer$3(r)?$byteLength?$byteLength(r):r.byteLength:NaN},assign$2=object_assign,callBound=callBound$c,flags=regexp_prototype_flags,GetIntrinsic=getIntrinsic,getIterator$1=esGetIteratorExports,getSideChannel=sideChannel,is$1=objectIs,isArguments=isArguments$2,isArray$1=isarray$1,isArrayBuffer$2=isArrayBuffer$4,isDate$1=isDateObject,isRegex=isRegex$1,isSharedArrayBuffer=isSharedArrayBuffer$1,objectKeys=objectKeys$2,whichBoxedPrimitive=whichBoxedPrimitive$1,whichCollection=whichCollection$1,whichTypedArray$1=whichTypedArray$2,byteLength=arrayBufferByteLength,sabByteLength=callBound("SharedArrayBuffer.prototype.byteLength",!0),$getTime=callBound("Date.prototype.getTime"),gPO=Object.getPrototypeOf,$objToString=callBound("Object.prototype.toString"),$Set=GetIntrinsic("%Set%",!0),$mapHas=callBound("Map.prototype.has",!0),$mapGet=callBound("Map.prototype.get",!0),$mapSize=callBound("Map.prototype.size",!0),$setAdd=callBound("Set.prototype.add",!0),$setDelete=callBound("Set.prototype.delete",!0),$setHas=callBound("Set.prototype.has",!0),$setSize=callBound("Set.prototype.size",!0);function setHasEqualElement(n,r,_,E){for(var S=getIterator$1(n),C;(C=S.next())&&!C.done;)if(internalDeepEqual(r,C.value,_,E))return $setDelete(n,C.value),!0;return!1}function findLooseMatchingPrimitives(n){if(typeof n>"u")return null;if(typeof n!="object")return typeof n=="symbol"?!1:typeof n=="string"||typeof n=="number"?+n==+n:!0}function mapMightHaveLoosePrim(n,r,_,E,S,C){var A=findLooseMatchingPrimitives(_);if(A!=null)return A;var I=$mapGet(r,A),B=assign$2({},S,{strict:!1});return typeof I>"u"&&!$mapHas(r,A)||!internalDeepEqual(E,I,B,C)?!1:!$mapHas(n,A)&&internalDeepEqual(E,I,B,C)}function setMightHaveLoosePrim(n,r,_){var E=findLooseMatchingPrimitives(_);return E??($setHas(r,E)&&!$setHas(n,E))}function mapHasEqualEntry(n,r,_,E,S,C){for(var A=getIterator$1(n),I,B;(I=A.next())&&!I.done;)if(B=I.value,internalDeepEqual(_,B,S,C)&&internalDeepEqual(E,$mapGet(r,B),S,C))return $setDelete(n,B),!0;return!1}function internalDeepEqual(n,r,_,E){var S=_||{};if(S.strict?is$1(n,r):n===r)return!0;var C=whichBoxedPrimitive(n),A=whichBoxedPrimitive(r);if(C!==A)return!1;if(!n||!r||typeof n!="object"&&typeof r!="object")return S.strict?is$1(n,r):n==r;var I=E.has(n),B=E.has(r),O;if(I&&B){if(E.get(n)===E.get(r))return!0}else O={};return I||E.set(n,O),B||E.set(r,O),objEquiv(n,r,S,E)}function isBuffer$4(n){return!n||typeof n!="object"||typeof n.length!="number"||typeof n.copy!="function"||typeof n.slice!="function"||n.length>0&&typeof n[0]!="number"?!1:!!(n.constructor&&n.constructor.isBuffer&&n.constructor.isBuffer(n))}function setEquiv(n,r,_,E){if($setSize(n)!==$setSize(r))return!1;for(var S=getIterator$1(n),C=getIterator$1(r),A,I,B;(A=S.next())&&!A.done;)if(A.value&&typeof A.value=="object")B||(B=new $Set),$setAdd(B,A.value);else if(!$setHas(r,A.value)){if(_.strict||!setMightHaveLoosePrim(n,r,A.value))return!1;B||(B=new $Set),$setAdd(B,A.value)}if(B){for(;(I=C.next())&&!I.done;)if(I.value&&typeof I.value=="object"){if(!setHasEqualElement(B,I.value,_.strict,E))return!1}else if(!_.strict&&!$setHas(n,I.value)&&!setHasEqualElement(B,I.value,_.strict,E))return!1;return $setSize(B)===0}return!0}function mapEquiv(n,r,_,E){if($mapSize(n)!==$mapSize(r))return!1;for(var S=getIterator$1(n),C=getIterator$1(r),A,I,B,O,N,U;(A=S.next())&&!A.done;)if(O=A.value[0],N=A.value[1],O&&typeof O=="object")B||(B=new $Set),$setAdd(B,O);else if(U=$mapGet(r,O),typeof U>"u"&&!$mapHas(r,O)||!internalDeepEqual(N,U,_,E)){if(_.strict||!mapMightHaveLoosePrim(n,r,O,N,_,E))return!1;B||(B=new $Set),$setAdd(B,O)}if(B){for(;(I=C.next())&&!I.done;)if(O=I.value[0],U=I.value[1],O&&typeof O=="object"){if(!mapHasEqualEntry(B,n,O,U,_,E))return!1}else if(!_.strict&&(!n.has(O)||!internalDeepEqual($mapGet(n,O),U,_,E))&&!mapHasEqualEntry(B,n,O,U,assign$2({},_,{strict:!1}),E))return!1;return $setSize(B)===0}return!0}function objEquiv(n,r,_,E){var S,C;if(typeof n!=typeof r||n==null||r==null||$objToString(n)!==$objToString(r)||isArguments(n)!==isArguments(r))return!1;var A=isArray$1(n),I=isArray$1(r);if(A!==I)return!1;var B=n instanceof Error,O=r instanceof Error;if(B!==O||(B||O)&&(n.name!==r.name||n.message!==r.message))return!1;var N=isRegex(n),U=isRegex(r);if(N!==U||(N||U)&&(n.source!==r.source||flags(n)!==flags(r)))return!1;var j=isDate$1(n),z=isDate$1(r);if(j!==z||(j||z)&&$getTime(n)!==$getTime(r)||_.strict&&gPO&&gPO(n)!==gPO(r))return!1;var Z=whichTypedArray$1(n),X=whichTypedArray$1(r);if(Z!==X)return!1;if(Z||X){if(n.length!==r.length)return!1;for(S=0;S<n.length;S++)if(n[S]!==r[S])return!1;return!0}var Q=isBuffer$4(n),se=isBuffer$4(r);if(Q!==se)return!1;if(Q||se){if(n.length!==r.length)return!1;for(S=0;S<n.length;S++)if(n[S]!==r[S])return!1;return!0}var oe=isArrayBuffer$2(n),ue=isArrayBuffer$2(r);if(oe!==ue)return!1;if(oe||ue)return byteLength(n)!==byteLength(r)?!1:typeof Uint8Array=="function"&&internalDeepEqual(new Uint8Array(n),new Uint8Array(r),_,E);var we=isSharedArrayBuffer(n),Te=isSharedArrayBuffer(r);if(we!==Te)return!1;if(we||Te)return sabByteLength(n)!==sabByteLength(r)?!1:typeof Uint8Array=="function"&&internalDeepEqual(new Uint8Array(n),new Uint8Array(r),_,E);if(typeof n!=typeof r)return!1;var xe=objectKeys(n),Re=objectKeys(r);if(xe.length!==Re.length)return!1;for(xe.sort(),Re.sort(),S=xe.length-1;S>=0;S--)if(xe[S]!=Re[S])return!1;for(S=xe.length-1;S>=0;S--)if(C=xe[S],!internalDeepEqual(n[C],r[C],_,E))return!1;var Ne=whichCollection(n),Fe=whichCollection(r);return Ne!==Fe?!1:Ne==="Set"||Fe==="Set"?setEquiv(n,r,_,E):Ne==="Map"?mapEquiv(n,r,_,E):!0}var deepEqual=function(r,_,E){return internalDeepEqual(r,_,E,getSideChannel())};const deepEqual$1=getDefaultExportFromCjs(deepEqual);class metteurUneFois extends eventsExports.EventEmitter{condition;rsultatPrt;fOublier;rsultat;f;constructor(r,_){super(),this.condition=_||(()=>!0),this.rsultatPrt=!1,this.f=r,this.initialiser()}async initialiser(){const r=async _=>{await this.condition(_)&&(this.rsultat=_,this.rsultatPrt=!0,this.fOublier&&this.lorsquePrt())};this.fOublier=await this.f(r),this.lorsquePrt()}lorsquePrt(){if(this.rsultatPrt){if(!this.fOublier)throw new Error("Fuite !!");this.fOublier&&this.fOublier(),this.emit("fini",this.rsultat)}}}const suivreBdDeFonction=async({fRacine:n,f:r,fSuivre:_})=>{let E,S,C=!0;const A=await n({fSuivreRacine:async I=>{I===void 0&&C&&(C=!1,await r(void 0)),I!==S&&(S=I,E&&await E(),S?E=await _({id:S,fSuivreBd:r}):(await r(void 0),E=void 0))}});return async()=>{await A(),E&&await E()}},uneFois=async function(n,r){const _=new metteurUneFois(n,r);return(await once_1(_,"fini"))[0]},faisRien=async()=>{},ignorerNonDfinis=n=>async r=>{if(r!==void 0)return await n(r)},attendreStabilit=n=>{let r=!1,_,E=faisRien;return S=>new Promise(C=>{if(r&&JSON.stringify(S)===_)return;r=!0,E(),_=JSON.stringify(S);const A=setTimeout(()=>C(!0),n);E=()=>{clearTimeout(A),C(!1)}})},suivreBdsDeFonctionListe=async({fListe:n,f:r,fBranche:_,fIdBdDeBranche:E=A=>A,fRduction:S=A=>[...new Set(A.flat())],fCode:C=A=>A})=>{const A={},I={};let B=!1;const O=async()=>{if(!B||Object.values(A).length&&Object.values(A).every(se=>!se.djvalue))return;const X=Object.values(A).map(se=>se.donnes).filter(se=>se!==void 0),Q=S(X);await r(Q)},N=new s$1,j=await n(async X=>{if(await N.acquire("racine"),X.some(Te=>typeof C(Te)!="string"))throw console.error("Dfinir fCode si les lments ne sont pas en format texte (chanes)."),new Error("Dfinir fCode si les lments ne sont pas en format texte (chanes).");const Q=Object.fromEntries(X.map(Te=>[C(Te),Te])),se=Object.keys(A);let oe=Object.keys(Q).filter(Te=>!se.includes(Te));const ue=se.filter(Te=>!Object.keys(Q).includes(Te)),we=Object.entries(Q).filter(Te=>!deepEqual$1(I[Te[0]],Te[1])).map(Te=>Te[0]);oe.push(...we),oe=[...new Set(oe)],await Promise.all(we.map(async Te=>{if(A[Te]){const xe=A[Te].fOublier;xe&&await xe(),delete A[Te]}})),await Promise.all(ue.map(async Te=>{const xe=A[Te].fOublier;xe&&await xe(),delete A[Te]})),await Promise.all(oe.map(async Te=>{A[Te]={djvalue:!1};const xe=Q[Te];I[Te]=xe;const Re=E(xe),Fe=await _(Re,async ht=>{A[Te].donnes=ht,A[Te].djvalue=!0,await O()},xe);A[Te].fOublier=Fe})),B=!0,await O(),N.release("racine")});let z;const Z=async()=>{await z(),await Promise.all(Object.values(A).map(X=>X.fOublier&&X.fOublier()))};return typeof j=="function"?(z=j,Z):(z=j.fOublier,Object.assign({},j,{fOublier:Z}))};var typeDetect$1={exports:{}};(function(n,r){(function(_,E){n.exports=E()})(commonjsGlobal,function(){var _=typeof Promise=="function",E=typeof self=="object"?self:commonjsGlobal,S=typeof Symbol<"u",C=typeof Map<"u",A=typeof Set<"u",I=typeof WeakMap<"u",B=typeof WeakSet<"u",O=typeof DataView<"u",N=S&&typeof Symbol.iterator<"u",U=S&&typeof Symbol.toStringTag<"u",j=A&&typeof Set.prototype.entries=="function",z=C&&typeof Map.prototype.entries=="function",Z=j&&Object.getPrototypeOf(new Set().entries()),X=z&&Object.getPrototypeOf(new Map().entries()),Q=N&&typeof Array.prototype[Symbol.iterator]=="function",se=Q&&Object.getPrototypeOf([][Symbol.iterator]()),oe=N&&typeof String.prototype[Symbol.iterator]=="function",ue=oe&&Object.getPrototypeOf(""[Symbol.iterator]()),we=8,Te=-1;function xe(Re){var Ne=typeof Re;if(Ne!=="object")return Ne;if(Re===null)return"null";if(Re===E)return"global";if(Array.isArray(Re)&&(U===!1||!(Symbol.toStringTag in Re)))return"Array";if(typeof window=="object"&&window!==null){if(typeof window.location=="object"&&Re===window.location)return"Location";if(typeof window.document=="object"&&Re===window.document)return"Document";if(typeof window.navigator=="object"){if(typeof window.navigator.mimeTypes=="object"&&Re===window.navigator.mimeTypes)return"MimeTypeArray";if(typeof window.navigator.plugins=="object"&&Re===window.navigator.plugins)return"PluginArray"}if((typeof window.HTMLElement=="function"||typeof window.HTMLElement=="object")&&Re instanceof window.HTMLElement){if(Re.tagName==="BLOCKQUOTE")return"HTMLQuoteElement";if(Re.tagName==="TD")return"HTMLTableDataCellElement";if(Re.tagName==="TH")return"HTMLTableHeaderCellElement"}}var Fe=U&&Re[Symbol.toStringTag];if(typeof Fe=="string")return Fe;var ht=Object.getPrototypeOf(Re);return ht===RegExp.prototype?"RegExp":ht===Date.prototype?"Date":_&&ht===Promise.prototype?"Promise":A&&ht===Set.prototype?"Set":C&&ht===Map.prototype?"Map":B&&ht===WeakSet.prototype?"WeakSet":I&&ht===WeakMap.prototype?"WeakMap":O&&ht===DataView.prototype?"DataView":C&&ht===X?"Map Iterator":A&&ht===Z?"Set Iterator":Q&&ht===se?"Array Iterator":oe&&ht===ue?"String Iterator":ht===null?"Object":Object.prototype.toString.call(Re).slice(we,Te)}return xe})})(typeDetect$1);var typeDetectExports=typeDetect$1.exports;const typeDetect=getDefaultExportFromCjs(typeDetectExports),isBufferExists=typeof Buffer<"u",isBufferFromExists=isBufferExists&&typeof Buffer.from<"u",isBuffer$3=isBufferExists?function(r){return Buffer.isBuffer(r)}:function(){return!1},copy$2=isBufferFromExists?function(r){return Buffer.from(r)}:isBufferExists?function(r){return new Buffer(r)}:function(r){return r};function detectType(n){return isBuffer$3(n)?"Buffer":typeDetect(n)}const collectionTypeSet=new Set(["Arguments","Array","Map","Object","Set"]);function get$5(n,r,_=null){switch(_||detectType(n)){case"Arguments":case"Array":case"Object":return n[r];case"Map":return n.get(r);case"Set":return r}}function isCollection(n){return collectionTypeSet.has(n)}function set$2(n,r,_,E=null){switch(E||detectType(n)){case"Arguments":case"Array":case"Object":n[r]=_;break;case"Map":n.set(r,_);break;case"Set":n.add(_);break}return n}const freeGlobalThis=typeof globalThis<"u"&&globalThis!==null&&globalThis.Object===Object&&globalThis,freeGlobal=typeof global<"u"&&global!==null&&global.Object===Object&&global,freeSelf=typeof self<"u"&&self!==null&&self.Object===Object&&self,globalObject=freeGlobalThis||freeGlobal||freeSelf||Function("return this")();function copyArrayBuffer(n){return n.slice(0)}function copyBoolean(n){return new Boolean(n.valueOf())}function copyDataView(n){return new DataView(n.buffer)}function copyBuffer(n){return copy$2(n)}function copyDate(n){return new Date(n.getTime())}function copyNumber(n){return new Number(n)}function copyRegExp(n){return new RegExp(n.source,n.flags)}function copyString(n){return new String(n)}function copyTypedArray(n,r){return globalObject[r].from?globalObject[r].from(n):new globalObject[r](n)}function shallowCopy(n){return n}function getEmptyArray(){return[]}function getEmptyMap(){return new Map}function getEmptyObject(){return{}}function getEmptySet(){return new Set}const copyMap=new Map([["ArrayBuffer",copyArrayBuffer],["Boolean",copyBoolean],["Buffer",copyBuffer],["DataView",copyDataView],["Date",copyDate],["Number",copyNumber],["RegExp",copyRegExp],["String",copyString],["Float32Array",copyTypedArray],["Float64Array",copyTypedArray],["Int16Array",copyTypedArray],["Int32Array",copyTypedArray],["Int8Array",copyTypedArray],["Uint16Array",copyTypedArray],["Uint32Array",copyTypedArray],["Uint8Array",copyTypedArray],["Uint8ClampedArray",copyTypedArray],["Array Iterator",shallowCopy],["Map Iterator",shallowCopy],["Promise",shallowCopy],["Set Iterator",shallowCopy],["String Iterator",shallowCopy],["function",shallowCopy],["global",shallowCopy],["WeakMap",shallowCopy],["WeakSet",shallowCopy],["boolean",shallowCopy],["null",shallowCopy],["number",shallowCopy],["string",shallowCopy],["symbol",shallowCopy],["undefined",shallowCopy],["Arguments",getEmptyArray],["Array",getEmptyArray],["Map",getEmptyMap],["Object",getEmptyObject],["Set",getEmptySet]]);function noop$5(){}function copy$1(n,r=null,_=noop$5){arguments.length===2&&typeof r=="function"&&(_=r,r=null);const E=r||detectType(n),S=copyMap.get(E);if(E==="Object"){const C=_(n,E);if(C!==void 0)return C}return S?S(n,E):n}function deepcopy(n,r={}){typeof r=="function"&&(r={customizer:r});const{customizer:_}=r,E=detectType(n);if(!isCollection(E))return recursiveCopy(n,null,null,null);const S=copy$1(n,E,_),C=new WeakMap([[n,S]]),A=new WeakSet([n]);return recursiveCopy(n,S,C,A)}function recursiveCopy(n,r,_,E,S){const C=detectType(n),A=copy$1(n,C);if(!isCollection(C))return A;let I;switch(C){case"Arguments":case"Array":I=Object.keys(n);break;case"Object":I=Object.keys(n),I.push(...Object.getOwnPropertySymbols(n));break;case"Map":case"Set":I=n.keys();break}for(let B of I){const O=get$5(n,B,C);if(E.has(O))set$2(r,B,_.get(O),C);else{const N=detectType(O),U=copy$1(O,N);isCollection(N)&&(_.set(O,U),E.add(O)),set$2(r,B,recursiveCopy(O,U,_,E),C)}}return r}const ___$1=" ",__$1="",__$1="/orbitdb/zdpuAqBsFnWsRo4DRZjyvDbuHXPck4PsD99GqUqnDaVMYYdRy",__$1="",__$1="/orbitdb/zdpuAtyjCoieAwksiuuvaYgVQfzFYSsB4isz5LuJqiiEnVdfS",$1={___:___$1,__:__$1,__:__$1,__:__$1,__:__$1},__$1=n=>(n=deepcopy(n),n.tableaux=n.tableaux.map(r=>({clef:r.clef,cols:r.cols.map(_=>({idColonne:_.idColonne,idVariable:_.idVariable,optionnelle:_.optionnelle}))})),n);let $1=class Wl{;_;_;;;constructor({:r,_:_,_:E,:S,:C}){this.=r,this._=_,this._=E,S=Wl._({:S,_:_,_:E,:C}),this.=__$1(S),this.=Object.assign({},$1,C)}static _({:r,_:_,_:E,:S}){const C=deepcopy(r),A=C.tableaux.find(B=>B.clef===_);if(!A)throw new Error("    .");return A.cols.find(B=>B.idColonne===(S?.__||__$1))||(A.cols.push({idVariable:S?.__||__$1,idColonne:S?.__||__$1}),C.tableaux=C.tableaux.map(B=>B.clef===_?A:B)),C.nues||(C.nues=[]),C.nues.includes(E)||C.nues.push(E),C}static async ({:r,:_,_:E,:S,:C}){if(!r.nues||!r.bds)throw new Error(" ");const A=await r.nues.crerNue({nueParent:S});_=this._({:_,_:E,_:A,:C});for(const O of _.tableaux){const N=await r.nues.ajouterTableauNue({idNue:A,clefTableau:O.clef});for(const U of O.cols)await r.nues.ajouterColonneTableauNue({idTableau:N,idVariable:U.idVariable,idColonne:U.idColonne}),U.index;_.motsClefs&&await r.nues.ajouterMotsClefsNue({idNue:A,idsMotsClefs:_.motsClefs})}const I={licence:_.licence,motsClefs:_.motsClefs,tableaux:_.tableaux.map(O=>O.clef===E?{clef:O.clef,cols:[...O.cols,{idColonne:C?.__||__$1,idVariable:C?.__||__$1}]}:O)},B=await r.bds.crerBdDeSchma({schma:I});return await r.nues.sauvegarderMtadonneNue({idNue:A,clef:___$1,valeur:B}),A}async __({:r}){return await suivreBdsDeFonctionListe({fListe:async _=>await this..nues.suivreNuesParents({idNue:this._,f:E=>_([this._,...E].reverse())}),f:async _=>await r(_),fBranche:async(_,E)=>await suivreBdDeFonction({fRacine:async({fSuivreRacine:S})=>await this.__({:S,:_}),f:ignorerNonDfinis(E),fSuivre:async({id:S,fSuivreBd:C})=>await this..bds.suivreDonnesDeTableauParClef({idBd:S,clefTableau:this._,f:C})})})}async _({:r,:_=!0}){return await this..nues.suivreDonnesTableauNue({idNue:this._,clefTableau:this._,hritage:_?["ascendance","descendance"]:["ascendance"],f:async E=>{await r(E.map(S=>({:S.idCompte,:S.lment.id,:S.lment.donnes})))},nRsultatsDsirs:1e3})}async __({:r}){return await this..bds.suivreDonnesDeTableauUnique({schmaBd:this.,idNueUnique:this._,clefTableau:this._,f:async _=>{const E=await this..obtIdCompte();await r(_.map(S=>({:E,:S.id,:S.donnes})))}})}async ({:r}){const _=S=>S[this..__]?S:{...S,[this..__]:Date.now()};return(await this..bds.ajouterlmentTableauUnique({schmaBd:this.,idNueUnique:this._,clefTableau:this._,vals:_(r)}))[0]}async _({:r}){return await this..bds.effacerlmentDeTableauUnique({schmaBd:this.,idNueUnique:this._,clefTableau:this._,idlment:r})}async _({:r,:_}){await this..bds.modifierlmentDeTableauUnique({schmaBd:this.,idNueUnique:this._,clefTableau:this._,vals:r,idlment:_})}async __({:r,:_}){const E=async S=>{const C=S[this..___];if(typeof C=="string")return await r(C)};return await this..nues.suivreMtadonnesNue({idNue:_||this._,f:E})}async __(){return await uneFois(async _=>await this.__({:_}))}async ({:r}){const _=await this.__(),E=Object.assign({},r.,{[this..__]:r.}),C=(await uneFois(async A=>await this.__({:A}))).find(A=>this.__(A.donnes,E));return C?(await this.__({:r,:C.id}),C.id):(await this..bds.ajouterlmentTableauParClef({idBd:_,clefTableau:this._,vals:E}))[0]}async __({:r}){const _=await this.__();await this..bds.effacerlmentDeTableauParClef({idBd:_,clefTableau:this._,idlment:r})}async __({:r,:_}){const E=await this.__();await this..bds.modifierlmentDeTableauParClef({idBd:E,clefTableau:this._,idlment:_,vals:{...r.,[this..__]:r.}})}__(r,_){return(this..tableaux.find(S=>S.clef===this._)?.cols.filter(S=>S.index).map(S=>S.idColonne)||[]).every(S=>r[S]===_[S])}async _({:r,:_=""}){const E={:[],:[]},S=async()=>{const I=[];for(const B of E.){const O=I.find(N=>this.__(N,B));if(O){const N=O[this..__],U=B[this..__];N&&U&&U>N&&(I.splice(I.indexOf(O),1),I.push(B))}else I.push(B)}for(const B of E.){const O=I.find(N=>this.__(N,B));O&&I.splice(I.indexOf(O),1),I.push(B)}return await r(I)},A=[await this.__({:async I=>{E.=I.map(B=>B.donnes),await S()}})];if(_===""){const I=await this._({:async B=>{E.=B.map(O=>({[this..__]:O.,...O.})),await S()}});A.push(I.fOublier)}else if(_===""){const I=await this.__({:async B=>{E.=B.map(O=>({[this..__]:O.,...O.})),await S()}});A.push(I)}return async()=>{await Promise.all(A.map(I=>I()))}}};const __="",__="",___="_",___="_",___="_",__="",___="/orbitdb/zdpuAt9PVUHGEyrL43tWDmpBUrgoPPWZHX7AGXWk4ZhEZ1oik",__="/orbitdb/zdpuAt9PVUHGEyrL43tWDmpBUrgoPPWZHX7AGXWk4ZhEZ1oik",___="/orbitdb/zdpuB1TEfuUWUQ2dPf8PHQFCg5n3zzx2xRhmimdF7tv6SSu9s",___="/orbitdb/zdpuAtmGaeNicerk2ByPa4oQMtSPgdNovQp6ZC6c2fJqF64Sb",___="/orbitdb/zdpuAyBg5f4Lxabv7YHVrxpNbBQW6dzxwH6wfQVMKZjECnkry",__="/orbitdb/zdpuAnEhqhCW51yfohfHWzjLgDPyuY2ySVmTBW7upAidVbwnX",___="/orbitdb/zdpuAoNDXakfzK2DxJAozuR2V9TYha5bvzjQHN5VnAm4jvL6S",___="/orbitdb/zdpuAsViPqnpRhUwN6kL7cSyLFaxSEkK233cJAChJMtc2vwLT",__={motsClefs:[___,___],licence:"ODbl-1_0",tableaux:[{clef:__,cols:[{idVariable:__,idColonne:__,index:!0},{idVariable:___,idColonne:___},{idVariable:___,idColonne:___,index:!0},{idVariable:___,idColonne:___},{idVariable:__,idColonne:__},{idVariable:__$1,idColonne:__$1}]}]},___=n=>({:n.donnes[__],:new Date(n.donnes[__$1]),:n.donnes[__$1],:n.donnes[__],_:n.donnes[___],_:n.donnes[___],_:n.donnes[___],:n.id}),___=n=>({:n.,:n.,:{:n.[__],:new Date(n.[__$1]),:n.[__],_:n.[___],_:n.[___],_:n.[___]}}),___=n=>({:n.,:n.,:{[__]:n..,[__$1]:n...getTime(),[__]:n..,[___]:n.._,[___]:n.._,[___]:n.._}}),__=n=>{const r=new Set(n.map(E=>E.)),_={};for(const E of r){_[E]||(_[E]={});const S=n.filter(C=>C.===E);for(const C of S)_[E][C._]=C.}return _},_=(...n)=>{const r={};for(const _ of n)for(const E of Object.keys(_)){r[E]||(r[E]={});for(const[S,C]of Object.entries(_[E]))r[E][S]=C}return r},__=n=>{const r={};for(const _ in n){const E=_.split(".");for(const S of Object.keys(n[_])){r[S]||(r[S]={});let C=r[S];for(const[A,I]of E.entries())A===E.length-1?C[I]=n[_][S]:((C[I]===void 0||typeof C[I]=="string")&&(C[I]={}),C=C[I])}}return r},__=n=>{const r={};function*_({:E,:S}){S=S||[];for(const[C,A]of Object.entries(E)){const I=[...S,C];if(typeof A=="string")yield{:I.join("."),:A};else for(const{:B,:O}of _({:A,:I}))yield{:B,:O}}}for(const E of Object.keys(n))for(const{:S,:C}of _({:n[E]}))r[S]||(r[S]={}),r[S][E]=C;return r},_=async()=>{};class {_;_;_;;constructor({:r,_:_,_:E,:S}){if(this._=v4(),S){if(!r)throw new Error;this.=new $1({:r,_:__,_:S,:__})}this._=_||{},this._=E}static async ({:r,:_=___}){return await $1.({:r,:_,:__,_:__})}async _({:r,:_=""}){const E={:Object.keys(this._),:[],:[]},S=async()=>await r([...new Set([...Object.values(E).flat()])]),C=[],A=await this.__({:async I=>(E.=Object.keys(I),await S())});if(C.push(A),_===""){const I=await this.___({:async B=>{E.=B.map(O=>O..),await S()}});C.push(I)}else if(_===""){const I=(await this.__({:async B=>{E.=B.map(O=>O..),await S()}})).fOublier;C.push(I)}return async()=>{await Promise.all(C.map(I=>I()))}}async _({:r="",:_}){const E={:Object.values(this._).map(A=>Object.keys(A)).flat()},S=async()=>{await _([...new Set(Object.values(E).flat())])};S();const C=[];if(this.){const A=await this..__({:async I=>{E.=I.map(B=>B.donnes[___]),await S()}});C.push(A),r===""?C.push(await this.___({:async I=>{E.=I.map(B=>B.[___]),await S()}})):r===""&&C.push((await this.__({:async I=>{E.=I.map(B=>B.[___]),await S()}})).fOublier)}return async()=>{await Promise.all(C.map(A=>A()))}}async __({:r}){const _={:[]},E=async()=>{const S=_(__(_..map(C=>___(C))),this._);await r(S)};return await E(),this.?await this..__({:async S=>{_.=S,await E()}}):_}async _({:r,:_=""}){if(await r(this._),!this.)return _;const E={},S=await this...obtIdCompte(),C=async()=>{const I=[...new Set([...Object.keys(this._),...(E.||[]).map(O=>O.)])],B={};for(const O of I){const N=E.?.filter(Z=>Z.===O)||[],U=E.?.filter(Z=>Z..===O)||[],j=[...new Set([...U.map(Z=>Z.._),...N.map(Z=>Z._)])],z={};for(const Z of j){const X=U.filter(oe=>oe.._===Z).sort((oe,ue)=>oe.===S&&ue.!==S||oe...getTime()>ue...getTime()?-1:1)[0],Q=N.find(oe=>oe._===Z),se=X?Q&&Q.>X...getTime()?Q:X.:Q;se&&(z[Z]=se.)}B[O]=Object.assign({},this._[O]||{},z)}return await r(B)},A=[];if(this.){const I=await this..__({:async B=>{E.=B.map(O=>O.donnes),await C()}});A.push(I)}return _===""?A.push(await this.___({:async I=>{E.=I,await C()}})):_===""&&A.push((await this.__({:async I=>{E.=I,await C()}})).fOublier),async()=>{await Promise.all(A.map(I=>I()))}}async __({:r,:_,:E}){return this.?await this.._({:async S=>await E(S.filter(C=>(!r||C.[__]===r)&&(!_||C.[___]===_)).map(___))}):{fOublier:_,fChangerProfondeur:_}}async ___({:r}){return this.?await this..__({:_=>{r(_.map(E=>___(E)))}}):_}async _({:r,:_,:E}){const S={},C=N=>{const U=[];for(const j of N)U.find(z=>z..===j..&&z.._===j.._)||U.push(j);return U},A=async()=>{if(S.)if(_===""){const N=S..length,U=S..filter(z=>S.?.[z]?.[r]),j=S.?.filter(z=>z.._===r&&S.?.includes(z..)&&!U.includes(z..))||[];return await E({:N,:U.length,:C(j).length})}else{if(!S.||!S.)return;const N=Object.fromEntries(S..map(X=>[X,this._&&S.?.[X]?.[this._]?.length||(S.?.[X]?Object.values(S.?.[X])[0]?.length:0)])),U=Object.values(N).reduce((X,Q)=>X+Q,0),j=S..filter(X=>S.?.[X]?.[r]),z=Object.entries(S.).filter(X=>X[1][r]).map(([X,Q])=>N[X]).reduce((X,Q)=>X+Q,0),Z=S.?.filter(X=>X.._===r&&S.?.includes(X..)&&!j.includes(X..)).map(X=>N[X..]||0).reduce((X,Q)=>X+Q,0)||0;return await E({:U,:z,:Z})}},I=await Promise.all([this._({:async N=>{S.=N,await A()}}),this._({:"",:async N=>{S.=N,await A()}})]),B=(await this.__({:r,:async N=>{S.=N,await A()}})).fOublier;return async()=>{await Promise.all(I.map(N=>N())),await B()}}async _({:r,:_,_:E,_:S,_:C}){if(!this.)throw new Error;const A={[__]:r,[__]:_,[___]:E};S&&(A[___]=S),C&&(A[___]=C),await this..({:A})}async __({:r}){if(!this.)throw new Error;await this.._({:r})}async ({:r}){if(!this.)throw new Error;return await this..({:___(r)})}async __({:r,_:_,:E=1e3}){if(!this.)throw new Error;const S=this.,C=B=>B.===r&&B._===_,I=(await uneFois(async B=>await S.__({:async O=>await B(O)}),async B=>!!B?.find(O=>C(O.donnes))||await attendreStabilit(E)(B)))?.find(B=>C(B.donnes))?.id;if(!I)throw new Error;return await this..__({:I})}async ({:r,:_,:E,:S=""}){const C={},A=async()=>{const I=C.?.[r]?.[_];return await E(I)};return await this._({:S,:async I=>{C.=I,await A()}})}}var lodash={exports:{}};/**
 * @license
 * Lodash <https://lodash.com/>
 * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
 * Released under MIT license <https://lodash.com/license>
 * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
 * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 */lodash.exports;(function(n,r){(function(){var _,E="4.17.21",S=200,C="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",A="Expected a function",I="Invalid `variable` option passed into `_.template`",B="__lodash_hash_undefined__",O=500,N="__lodash_placeholder__",U=1,j=2,z=4,Z=1,X=2,Q=1,se=2,oe=4,ue=8,we=16,Te=32,xe=64,Re=128,Ne=256,Fe=512,ht=30,nt="...",Ee=800,Ce=16,_e=1,Ie=2,He=3,Be=1/0,Ge=9007199254740991,je=17976931348623157e292,Ve=NaN,Pe=4294967295,Me=Pe-1,tt=Pe>>>1,Ke=[["ary",Re],["bind",Q],["bindKey",se],["curry",ue],["curryRight",we],["flip",Fe],["partial",Te],["partialRight",xe],["rearg",Ne]],mt="[object Arguments]",ct="[object Array]",Qe="[object AsyncFunction]",dt="[object Boolean]",vt="[object Date]",At="[object DOMException]",bt="[object Error]",ft="[object Function]",Et="[object GeneratorFunction]",Ye="[object Map]",Ct="[object Number]",Pt="[object Null]",St="[object Object]",$t="[object Promise]",kt="[object Proxy]",Ft="[object RegExp]",qt="[object Set]",Mt="[object String]",Wt="[object Symbol]",Zt="[object Undefined]",Yt="[object WeakMap]",ur="[object WeakSet]",xt="[object ArrayBuffer]",pt="[object DataView]",yt="[object Float32Array]",Bt="[object Float64Array]",Ht="[object Int8Array]",nr="[object Int16Array]",Qt="[object Int32Array]",xr="[object Uint8Array]",kr="[object Uint8ClampedArray]",Sr="[object Uint16Array]",$r="[object Uint32Array]",Rr=/\b__p \+= '';/g,Dr=/\b(__p \+=) '' \+/g,tn=/(__e\(.*?\)|\b__t\)) \+\n'';/g,Jr=/&(?:amp|lt|gt|quot|#39);/g,Pr=/[&<>"']/g,Wr=RegExp(Jr.source),Qr=RegExp(Pr.source),Fr=/<%-([\s\S]+?)%>/g,an=/<%([\s\S]+?)%>/g,cn=/<%=([\s\S]+?)%>/g,Lr=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,ln=/^\w*$/,fn=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Or=/[\\^$.*+?()[\]{}|]/g,nn=RegExp(Or.source),rn=/^\s+/,Kt=/\s/,jt=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,wt=/\{\n\/\* \[wrapped with (.+)\] \*/,Rt=/,? & /,Tt=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,Dt=/[()=,{}\[\]\/\s]/,Ot=/\\(\\)?/g,Vt=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,Jt=/\w*$/,lr=/^[-+]0x[0-9a-f]+$/i,tr=/^0b[01]+$/i,ir=/^\[object .+?Constructor\]$/,sr=/^0o[0-7]+$/i,dr=/^(?:0|[1-9]\d*)$/,yr=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,Er=/($^)/,pr=/['\n\r\u2028\u2029\\]/g,_r="\\ud800-\\udfff",Ar="\\u0300-\\u036f",Ur="\\ufe20-\\ufe2f",Hr="\\u20d0-\\u20ff",Yr=Ar+Ur+Hr,dn="\\u2700-\\u27bf",pn="a-z\\xdf-\\xf6\\xf8-\\xff",wn="\\xac\\xb1\\xd7\\xf7",mn="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",Tn="\\u2000-\\u206f",Rn=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",hi="A-Z\\xc0-\\xd6\\xd8-\\xde",Di="\\ufe0e\\ufe0f",Oi=wn+mn+Tn+Rn,xi="[']",xs="["+_r+"]",as="["+Oi+"]",ci="["+Yr+"]",To="\\d+",Yl="["+dn+"]",Co="["+pn+"]",Ao="[^"+_r+Oi+To+dn+pn+hi+"]",ua="\\ud83c[\\udffb-\\udfff]",Zl="(?:"+ci+"|"+ua+")",Ro="[^"+_r+"]",fa="(?:\\ud83c[\\udde6-\\uddff]){2}",da="[\\ud800-\\udbff][\\udc00-\\udfff]",Ki="["+hi+"]",ko="\\u200d",Io="(?:"+Co+"|"+Ao+")",Ql="(?:"+Ki+"|"+Ao+")",Po="(?:"+xi+"(?:d|ll|m|re|s|t|ve))?",Bo="(?:"+xi+"(?:D|LL|M|RE|S|T|VE))?",Do=Zl+"?",Oo="["+Di+"]?",Jl="(?:"+ko+"(?:"+[Ro,fa,da].join("|")+")"+Oo+Do+")*",eu="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",tu="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",No=Oo+Do+Jl,ru="(?:"+[Yl,fa,da].join("|")+")"+No,nu="(?:"+[Ro+ci+"?",ci,fa,da,xs].join("|")+")",iu=RegExp(xi,"g"),su=RegExp(ci,"g"),ha=RegExp(ua+"(?="+ua+")|"+nu+No,"g"),au=RegExp([Ki+"?"+Co+"+"+Po+"(?="+[as,Ki,"$"].join("|")+")",Ql+"+"+Bo+"(?="+[as,Ki+Io,"$"].join("|")+")",Ki+"?"+Io+"+"+Po,Ki+"+"+Bo,tu,eu,To,ru].join("|"),"g"),ou=RegExp("["+ko+_r+Yr+Di+"]"),cu=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,lu=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],uu=-1,vn={};vn[yt]=vn[Bt]=vn[Ht]=vn[nr]=vn[Qt]=vn[xr]=vn[kr]=vn[Sr]=vn[$r]=!0,vn[mt]=vn[ct]=vn[xt]=vn[dt]=vn[pt]=vn[vt]=vn[bt]=vn[ft]=vn[Ye]=vn[Ct]=vn[St]=vn[Ft]=vn[qt]=vn[Mt]=vn[Yt]=!1;var yn={};yn[mt]=yn[ct]=yn[xt]=yn[pt]=yn[dt]=yn[vt]=yn[yt]=yn[Bt]=yn[Ht]=yn[nr]=yn[Qt]=yn[Ye]=yn[Ct]=yn[St]=yn[Ft]=yn[qt]=yn[Mt]=yn[Wt]=yn[xr]=yn[kr]=yn[Sr]=yn[$r]=!0,yn[bt]=yn[ft]=yn[Yt]=!1;var fu={:"A",:"A",:"A",:"A",:"A",:"A",:"a",:"a",:"a",:"a",:"a",:"a",:"C",:"c",:"D",:"d",:"E",:"E",:"E",:"E",:"e",:"e",:"e",:"e",:"I",:"I",:"I",:"I",:"i",:"i",:"i",:"i",:"N",:"n",:"O",:"O",:"O",:"O",:"O",:"O",:"o",:"o",:"o",:"o",:"o",:"o",:"U",:"U",:"U",:"U",:"u",:"u",:"u",:"u",:"Y",:"y",:"y",:"Ae",:"ae",:"Th",:"th",:"ss",:"A",:"A",:"A",:"a",:"a",:"a",:"C",:"C",:"C",:"C",:"c",:"c",:"c",:"c",:"D",:"D",:"d",:"d",:"E",:"E",:"E",:"E",:"E",:"e",:"e",:"e",:"e",:"e",:"G",:"G",:"G",:"G",:"g",:"g",:"g",:"g",:"H",:"H",:"h",:"h",:"I",:"I",:"I",:"I",:"I",:"i",:"i",:"i",:"i",:"i",:"J",:"j",:"K",:"k",:"k",:"L",:"L",:"L",:"L",:"L",:"l",:"l",:"l",:"l",:"l",:"N",:"N",:"N",:"N",:"n",:"n",:"n",:"n",:"O",:"O",:"O",:"o",:"o",:"o",:"R",:"R",:"R",:"r",:"r",:"r",:"S",:"S",:"S",:"S",:"s",:"s",:"s",:"s",:"T",:"T",:"T",:"t",:"t",:"t",:"U",:"U",:"U",:"U",:"U",:"U",:"u",:"u",:"u",:"u",:"u",:"u",:"W",:"w",:"Y",:"y",:"Y",:"Z",:"Z",:"Z",:"z",:"z",:"z",:"IJ",:"ij",:"Oe",:"oe",:"'n",:"s"},du={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},hu={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},pu={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},mu=parseFloat,gu=parseInt,Mo=typeof commonjsGlobal=="object"&&commonjsGlobal&&commonjsGlobal.Object===Object&&commonjsGlobal,yu=typeof self=="object"&&self&&self.Object===Object&&self,In=Mo||yu||Function("return this")(),pa=r&&!r.nodeType&&r,Ni=pa&&!0&&n&&!n.nodeType&&n,Lo=Ni&&Ni.exports===pa,ma=Lo&&Mo.process,Yn=function(){try{var ar=Ni&&Ni.require&&Ni.require("util").types;return ar||ma&&ma.binding&&ma.binding("util")}catch{}}(),Fo=Yn&&Yn.isArrayBuffer,Uo=Yn&&Yn.isDate,Vo=Yn&&Yn.isMap,qo=Yn&&Yn.isRegExp,jo=Yn&&Yn.isSet,Ho=Yn&&Yn.isTypedArray;function Hn(ar,gr,hr){switch(hr.length){case 0:return ar.call(gr);case 1:return ar.call(gr,hr[0]);case 2:return ar.call(gr,hr[0],hr[1]);case 3:return ar.call(gr,hr[0],hr[1],hr[2])}return ar.apply(gr,hr)}function vu(ar,gr,hr,Cr){for(var Vr=-1,sn=ar==null?0:ar.length;++Vr<sn;){var Cn=ar[Vr];gr(Cr,Cn,hr(Cn),ar)}return Cr}function Zn(ar,gr){for(var hr=-1,Cr=ar==null?0:ar.length;++hr<Cr&&gr(ar[hr],hr,ar)!==!1;);return ar}function bu(ar,gr){for(var hr=ar==null?0:ar.length;hr--&&gr(ar[hr],hr,ar)!==!1;);return ar}function Ko(ar,gr){for(var hr=-1,Cr=ar==null?0:ar.length;++hr<Cr;)if(!gr(ar[hr],hr,ar))return!1;return!0}function $i(ar,gr){for(var hr=-1,Cr=ar==null?0:ar.length,Vr=0,sn=[];++hr<Cr;){var Cn=ar[hr];gr(Cn,hr,ar)&&(sn[Vr++]=Cn)}return sn}function $s(ar,gr){var hr=ar==null?0:ar.length;return!!hr&&zi(ar,gr,0)>-1}function ga(ar,gr,hr){for(var Cr=-1,Vr=ar==null?0:ar.length;++Cr<Vr;)if(hr(gr,ar[Cr]))return!0;return!1}function _n(ar,gr){for(var hr=-1,Cr=ar==null?0:ar.length,Vr=Array(Cr);++hr<Cr;)Vr[hr]=gr(ar[hr],hr,ar);return Vr}function Ti(ar,gr){for(var hr=-1,Cr=gr.length,Vr=ar.length;++hr<Cr;)ar[Vr+hr]=gr[hr];return ar}function ya(ar,gr,hr,Cr){var Vr=-1,sn=ar==null?0:ar.length;for(Cr&&sn&&(hr=ar[++Vr]);++Vr<sn;)hr=gr(hr,ar[Vr],Vr,ar);return hr}function _u(ar,gr,hr,Cr){var Vr=ar==null?0:ar.length;for(Cr&&Vr&&(hr=ar[--Vr]);Vr--;)hr=gr(hr,ar[Vr],Vr,ar);return hr}function va(ar,gr){for(var hr=-1,Cr=ar==null?0:ar.length;++hr<Cr;)if(gr(ar[hr],hr,ar))return!0;return!1}var wu=ba("length");function Eu(ar){return ar.split("")}function Su(ar){return ar.match(Tt)||[]}function zo(ar,gr,hr){var Cr;return hr(ar,function(Vr,sn,Cn){if(gr(Vr,sn,Cn))return Cr=sn,!1}),Cr}function Ts(ar,gr,hr,Cr){for(var Vr=ar.length,sn=hr+(Cr?1:-1);Cr?sn--:++sn<Vr;)if(gr(ar[sn],sn,ar))return sn;return-1}function zi(ar,gr,hr){return gr===gr?Ou(ar,gr,hr):Ts(ar,Wo,hr)}function xu(ar,gr,hr,Cr){for(var Vr=hr-1,sn=ar.length;++Vr<sn;)if(Cr(ar[Vr],gr))return Vr;return-1}function Wo(ar){return ar!==ar}function Go(ar,gr){var hr=ar==null?0:ar.length;return hr?Ea(ar,gr)/hr:Ve}function ba(ar){return function(gr){return gr==null?_:gr[ar]}}function wa(ar){return function(gr){return ar==null?_:ar[gr]}}function Xo(ar,gr,hr,Cr,Vr){return Vr(ar,function(sn,Cn,gn){hr=Cr?(Cr=!1,sn):gr(hr,sn,Cn,gn)}),hr}function $u(ar,gr){var hr=ar.length;for(ar.sort(gr);hr--;)ar[hr]=ar[hr].value;return ar}function Ea(ar,gr){for(var hr,Cr=-1,Vr=ar.length;++Cr<Vr;){var sn=gr(ar[Cr]);sn!==_&&(hr=hr===_?sn:hr+sn)}return hr}function Sa(ar,gr){for(var hr=-1,Cr=Array(ar);++hr<ar;)Cr[hr]=gr(hr);return Cr}function Tu(ar,gr){return _n(gr,function(hr){return[hr,ar[hr]]})}function Yo(ar){return ar&&ar.slice(0,tc(ar)+1).replace(rn,"")}function Kn(ar){return function(gr){return ar(gr)}}function xa(ar,gr){return _n(gr,function(hr){return ar[hr]})}function os(ar,gr){return ar.has(gr)}function Zo(ar,gr){for(var hr=-1,Cr=ar.length;++hr<Cr&&zi(gr,ar[hr],0)>-1;);return hr}function Qo(ar,gr){for(var hr=ar.length;hr--&&zi(gr,ar[hr],0)>-1;);return hr}function Cu(ar,gr){for(var hr=ar.length,Cr=0;hr--;)ar[hr]===gr&&++Cr;return Cr}var Au=wa(fu),Ru=wa(du);function ku(ar){return"\\"+pu[ar]}function Iu(ar,gr){return ar==null?_:ar[gr]}function Wi(ar){return ou.test(ar)}function Pu(ar){return cu.test(ar)}function Bu(ar){for(var gr,hr=[];!(gr=ar.next()).done;)hr.push(gr.value);return hr}function $a(ar){var gr=-1,hr=Array(ar.size);return ar.forEach(function(Cr,Vr){hr[++gr]=[Vr,Cr]}),hr}function Jo(ar,gr){return function(hr){return ar(gr(hr))}}function Ci(ar,gr){for(var hr=-1,Cr=ar.length,Vr=0,sn=[];++hr<Cr;){var Cn=ar[hr];(Cn===gr||Cn===N)&&(ar[hr]=N,sn[Vr++]=hr)}return sn}function Cs(ar){var gr=-1,hr=Array(ar.size);return ar.forEach(function(Cr){hr[++gr]=Cr}),hr}function Du(ar){var gr=-1,hr=Array(ar.size);return ar.forEach(function(Cr){hr[++gr]=[Cr,Cr]}),hr}function Ou(ar,gr,hr){for(var Cr=hr-1,Vr=ar.length;++Cr<Vr;)if(ar[Cr]===gr)return Cr;return-1}function Nu(ar,gr,hr){for(var Cr=hr+1;Cr--;)if(ar[Cr]===gr)return Cr;return Cr}function Gi(ar){return Wi(ar)?Lu(ar):wu(ar)}function ii(ar){return Wi(ar)?Fu(ar):Eu(ar)}function tc(ar){for(var gr=ar.length;gr--&&Kt.test(ar.charAt(gr)););return gr}var Mu=wa(hu);function Lu(ar){for(var gr=ha.lastIndex=0;ha.test(ar);)++gr;return gr}function Fu(ar){return ar.match(ha)||[]}function Uu(ar){return ar.match(au)||[]}var Vu=function ar(gr){gr=gr==null?In:Xi.defaults(In.Object(),gr,Xi.pick(In,lu));var hr=gr.Array,Cr=gr.Date,Vr=gr.Error,sn=gr.Function,Cn=gr.Math,gn=gr.Object,Ta=gr.RegExp,qu=gr.String,Qn=gr.TypeError,As=hr.prototype,ju=sn.prototype,Yi=gn.prototype,Rs=gr["__core-js_shared__"],ks=ju.toString,hn=Yi.hasOwnProperty,Hu=0,rc=function(){var pe=/[^.]+$/.exec(Rs&&Rs.keys&&Rs.keys.IE_PROTO||"");return pe?"Symbol(src)_1."+pe:""}(),Is=Yi.toString,Ku=ks.call(gn),zu=In._,Wu=Ta("^"+ks.call(hn).replace(Or,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Ps=Lo?gr.Buffer:_,Ai=gr.Symbol,Bs=gr.Uint8Array,nc=Ps?Ps.allocUnsafe:_,Ds=Jo(gn.getPrototypeOf,gn),ic=gn.create,sc=Yi.propertyIsEnumerable,Os=As.splice,ac=Ai?Ai.isConcatSpreadable:_,cs=Ai?Ai.iterator:_,Mi=Ai?Ai.toStringTag:_,Ns=function(){try{var pe=qi(gn,"defineProperty");return pe({},"",{}),pe}catch{}}(),Gu=gr.clearTimeout!==In.clearTimeout&&gr.clearTimeout,Xu=Cr&&Cr.now!==In.Date.now&&Cr.now,Yu=gr.setTimeout!==In.setTimeout&&gr.setTimeout,Ms=Cn.ceil,Ls=Cn.floor,Ca=gn.getOwnPropertySymbols,Zu=Ps?Ps.isBuffer:_,oc=gr.isFinite,Qu=As.join,Ju=Jo(gn.keys,gn),An=Cn.max,Bn=Cn.min,ef=Cr.now,tf=gr.parseInt,cc=Cn.random,rf=As.reverse,Aa=qi(gr,"DataView"),us=qi(gr,"Map"),Ra=qi(gr,"Promise"),Zi=qi(gr,"Set"),fs=qi(gr,"WeakMap"),ds=qi(gn,"create"),Fs=fs&&new fs,Qi={},nf=ji(Aa),sf=ji(us),af=ji(Ra),of=ji(Zi),cf=ji(fs),Us=Ai?Ai.prototype:_,hs=Us?Us.valueOf:_,lc=Us?Us.toString:_;function Lt(pe){if(Sn(pe)&&!qr(pe)&&!(pe instanceof Xr)){if(pe instanceof Jn)return pe;if(hn.call(pe,"__wrapped__"))return fl(pe)}return new Jn(pe)}var Ji=function(){function pe(){}return function($e){if(!En($e))return{};if(ic)return ic($e);pe.prototype=$e;var et=new pe;return pe.prototype=_,et}}();function Vs(){}function Jn(pe,$e){this.__wrapped__=pe,this.__actions__=[],this.__chain__=!!$e,this.__index__=0,this.__values__=_}Lt.templateSettings={escape:Fr,evaluate:an,interpolate:cn,variable:"",imports:{_:Lt}},Lt.prototype=Vs.prototype,Lt.prototype.constructor=Lt,Jn.prototype=Ji(Vs.prototype),Jn.prototype.constructor=Jn;function Xr(pe){this.__wrapped__=pe,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=Pe,this.__views__=[]}function lf(){var pe=new Xr(this.__wrapped__);return pe.__actions__=Un(this.__actions__),pe.__dir__=this.__dir__,pe.__filtered__=this.__filtered__,pe.__iteratees__=Un(this.__iteratees__),pe.__takeCount__=this.__takeCount__,pe.__views__=Un(this.__views__),pe}function uf(){if(this.__filtered__){var pe=new Xr(this);pe.__dir__=-1,pe.__filtered__=!0}else pe=this.clone(),pe.__dir__*=-1;return pe}function ff(){var pe=this.__wrapped__.value(),$e=this.__dir__,et=qr(pe),_t=$e<0,It=et?pe.length:0,Ut=$d(0,It,this.__views__),Xt=Ut.start,er=Ut.end,cr=er-Xt,vr=_t?er:Xt-1,br=this.__iteratees__,wr=br.length,Tr=0,Ir=Bn(cr,this.__takeCount__);if(!et||!_t&&It==cr&&Ir==cr)return Bc(pe,this.__actions__);var Nr=[];e:for(;cr--&&Tr<Ir;){vr+=$e;for(var Kr=-1,Mr=pe[vr];++Kr<wr;){var Gr=br[Kr],Zr=Gr.iteratee,Gn=Gr.type,Ln=Zr(Mr);if(Gn==Ie)Mr=Ln;else if(!Ln){if(Gn==_e)continue e;break e}}Nr[Tr++]=Mr}return Nr}Xr.prototype=Ji(Vs.prototype),Xr.prototype.constructor=Xr;function Li(pe){var $e=-1,et=pe==null?0:pe.length;for(this.clear();++$e<et;){var _t=pe[$e];this.set(_t[0],_t[1])}}function df(){this.__data__=ds?ds(null):{},this.size=0}function hf(pe){var $e=this.has(pe)&&delete this.__data__[pe];return this.size-=$e?1:0,$e}function pf(pe){var $e=this.__data__;if(ds){var et=$e[pe];return et===B?_:et}return hn.call($e,pe)?$e[pe]:_}function mf(pe){var $e=this.__data__;return ds?$e[pe]!==_:hn.call($e,pe)}function gf(pe,$e){var et=this.__data__;return this.size+=this.has(pe)?0:1,et[pe]=ds&&$e===_?B:$e,this}Li.prototype.clear=df,Li.prototype.delete=hf,Li.prototype.get=pf,Li.prototype.has=mf,Li.prototype.set=gf;function mi(pe){var $e=-1,et=pe==null?0:pe.length;for(this.clear();++$e<et;){var _t=pe[$e];this.set(_t[0],_t[1])}}function yf(){this.__data__=[],this.size=0}function vf(pe){var $e=this.__data__,et=qs($e,pe);if(et<0)return!1;var _t=$e.length-1;return et==_t?$e.pop():Os.call($e,et,1),--this.size,!0}function bf(pe){var $e=this.__data__,et=qs($e,pe);return et<0?_:$e[et][1]}function _f(pe){return qs(this.__data__,pe)>-1}function wf(pe,$e){var et=this.__data__,_t=qs(et,pe);return _t<0?(++this.size,et.push([pe,$e])):et[_t][1]=$e,this}mi.prototype.clear=yf,mi.prototype.delete=vf,mi.prototype.get=bf,mi.prototype.has=_f,mi.prototype.set=wf;function gi(pe){var $e=-1,et=pe==null?0:pe.length;for(this.clear();++$e<et;){var _t=pe[$e];this.set(_t[0],_t[1])}}function Ef(){this.size=0,this.__data__={hash:new Li,map:new(us||mi),string:new Li}}function Sf(pe){var $e=ea(this,pe).delete(pe);return this.size-=$e?1:0,$e}function xf(pe){return ea(this,pe).get(pe)}function $f(pe){return ea(this,pe).has(pe)}function Tf(pe,$e){var et=ea(this,pe),_t=et.size;return et.set(pe,$e),this.size+=et.size==_t?0:1,this}gi.prototype.clear=Ef,gi.prototype.delete=Sf,gi.prototype.get=xf,gi.prototype.has=$f,gi.prototype.set=Tf;function Fi(pe){var $e=-1,et=pe==null?0:pe.length;for(this.__data__=new gi;++$e<et;)this.add(pe[$e])}function Cf(pe){return this.__data__.set(pe,B),this}function Af(pe){return this.__data__.has(pe)}Fi.prototype.add=Fi.prototype.push=Cf,Fi.prototype.has=Af;function si(pe){var $e=this.__data__=new mi(pe);this.size=$e.size}function Rf(){this.__data__=new mi,this.size=0}function kf(pe){var $e=this.__data__,et=$e.delete(pe);return this.size=$e.size,et}function If(pe){return this.__data__.get(pe)}function Pf(pe){return this.__data__.has(pe)}function Bf(pe,$e){var et=this.__data__;if(et instanceof mi){var _t=et.__data__;if(!us||_t.length<S-1)return _t.push([pe,$e]),this.size=++et.size,this;et=this.__data__=new gi(_t)}return et.set(pe,$e),this.size=et.size,this}si.prototype.clear=Rf,si.prototype.delete=kf,si.prototype.get=If,si.prototype.has=Pf,si.prototype.set=Bf;function uc(pe,$e){var et=qr(pe),_t=!et&&Hi(pe),It=!et&&!_t&&Bi(pe),Ut=!et&&!_t&&!It&&ns(pe),Xt=et||_t||It||Ut,er=Xt?Sa(pe.length,qu):[],cr=er.length;for(var vr in pe)($e||hn.call(pe,vr))&&!(Xt&&(vr=="length"||It&&(vr=="offset"||vr=="parent")||Ut&&(vr=="buffer"||vr=="byteLength"||vr=="byteOffset")||_i(vr,cr)))&&er.push(vr);return er}function fc(pe){var $e=pe.length;return $e?pe[Ua(0,$e-1)]:_}function Df(pe,$e){return ta(Un(pe),Ui($e,0,pe.length))}function Of(pe){return ta(Un(pe))}function ka(pe,$e,et){(et!==_&&!ai(pe[$e],et)||et===_&&!($e in pe))&&yi(pe,$e,et)}function ps(pe,$e,et){var _t=pe[$e];(!(hn.call(pe,$e)&&ai(_t,et))||et===_&&!($e in pe))&&yi(pe,$e,et)}function qs(pe,$e){for(var et=pe.length;et--;)if(ai(pe[et][0],$e))return et;return-1}function Nf(pe,$e,et,_t){return Ri(pe,function(It,Ut,Xt){$e(_t,It,et(It),Xt)}),_t}function dc(pe,$e){return pe&&ui($e,kn($e),pe)}function Mf(pe,$e){return pe&&ui($e,qn($e),pe)}function yi(pe,$e,et){$e=="__proto__"&&Ns?Ns(pe,$e,{configurable:!0,enumerable:!0,value:et,writable:!0}):pe[$e]=et}function Ia(pe,$e){for(var et=-1,_t=$e.length,It=hr(_t),Ut=pe==null;++et<_t;)It[et]=Ut?_:po(pe,$e[et]);return It}function Ui(pe,$e,et){return pe===pe&&(et!==_&&(pe=pe<=et?pe:et),$e!==_&&(pe=pe>=$e?pe:$e)),pe}function ei(pe,$e,et,_t,It,Ut){var Xt,er=$e&U,cr=$e&j,vr=$e&z;if(et&&(Xt=It?et(pe,_t,It,Ut):et(pe)),Xt!==_)return Xt;if(!En(pe))return pe;var br=qr(pe);if(br){if(Xt=Cd(pe),!er)return Un(pe,Xt)}else{var wr=Dn(pe),Tr=wr==ft||wr==Et;if(Bi(pe))return Nc(pe,er);if(wr==St||wr==mt||Tr&&!It){if(Xt=cr||Tr?{}:tl(pe),!er)return cr?md(pe,Mf(Xt,pe)):pd(pe,dc(Xt,pe))}else{if(!yn[wr])return It?pe:{};Xt=Ad(pe,wr,er)}}Ut||(Ut=new si);var Ir=Ut.get(pe);if(Ir)return Ir;Ut.set(pe,Xt),Il(pe)?pe.forEach(function(Mr){Xt.add(ei(Mr,$e,et,Mr,pe,Ut))}):Rl(pe)&&pe.forEach(function(Mr,Gr){Xt.set(Gr,ei(Mr,$e,et,Gr,pe,Ut))});var Nr=vr?cr?Za:Ya:cr?qn:kn,Kr=br?_:Nr(pe);return Zn(Kr||pe,function(Mr,Gr){Kr&&(Gr=Mr,Mr=pe[Gr]),ps(Xt,Gr,ei(Mr,$e,et,Gr,pe,Ut))}),Xt}function Lf(pe){var $e=kn(pe);return function(et){return hc(et,pe,$e)}}function hc(pe,$e,et){var _t=et.length;if(pe==null)return!_t;for(pe=gn(pe);_t--;){var It=et[_t],Ut=$e[It],Xt=pe[It];if(Xt===_&&!(It in pe)||!Ut(Xt))return!1}return!0}function pc(pe,$e,et){if(typeof pe!="function")throw new Qn(A);return Es(function(){pe.apply(_,et)},$e)}function gs(pe,$e,et,_t){var It=-1,Ut=$s,Xt=!0,er=pe.length,cr=[],vr=$e.length;if(!er)return cr;et&&($e=_n($e,Kn(et))),_t?(Ut=ga,Xt=!1):$e.length>=S&&(Ut=os,Xt=!1,$e=new Fi($e));e:for(;++It<er;){var br=pe[It],wr=et==null?br:et(br);if(br=_t||br!==0?br:0,Xt&&wr===wr){for(var Tr=vr;Tr--;)if($e[Tr]===wr)continue e;cr.push(br)}else Ut($e,wr,_t)||cr.push(br)}return cr}var Ri=Vc(li),mc=Vc(Ba,!0);function Ff(pe,$e){var et=!0;return Ri(pe,function(_t,It,Ut){return et=!!$e(_t,It,Ut),et}),et}function js(pe,$e,et){for(var _t=-1,It=pe.length;++_t<It;){var Ut=pe[_t],Xt=$e(Ut);if(Xt!=null&&(er===_?Xt===Xt&&!Wn(Xt):et(Xt,er)))var er=Xt,cr=Ut}return cr}function Uf(pe,$e,et,_t){var It=pe.length;for(et=jr(et),et<0&&(et=-et>It?0:It+et),_t=_t===_||_t>It?It:jr(_t),_t<0&&(_t+=It),_t=et>_t?0:Dl(_t);et<_t;)pe[et++]=$e;return pe}function gc(pe,$e){var et=[];return Ri(pe,function(_t,It,Ut){$e(_t,It,Ut)&&et.push(_t)}),et}function Pn(pe,$e,et,_t,It){var Ut=-1,Xt=pe.length;for(et||(et=kd),It||(It=[]);++Ut<Xt;){var er=pe[Ut];$e>0&&et(er)?$e>1?Pn(er,$e-1,et,_t,It):Ti(It,er):_t||(It[It.length]=er)}return It}var Pa=qc(),yc=qc(!0);function li(pe,$e){return pe&&Pa(pe,$e,kn)}function Ba(pe,$e){return pe&&yc(pe,$e,kn)}function Hs(pe,$e){return $i($e,function(et){return wi(pe[et])})}function Vi(pe,$e){$e=Ii($e,pe);for(var et=0,_t=$e.length;pe!=null&&et<_t;)pe=pe[fi($e[et++])];return et&&et==_t?pe:_}function vc(pe,$e,et){var _t=$e(pe);return qr(pe)?_t:Ti(_t,et(pe))}function Nn(pe){return pe==null?pe===_?Zt:Pt:Mi&&Mi in gn(pe)?xd(pe):Md(pe)}function Da(pe,$e){return pe>$e}function Vf(pe,$e){return pe!=null&&hn.call(pe,$e)}function qf(pe,$e){return pe!=null&&$e in gn(pe)}function jf(pe,$e,et){return pe>=Bn($e,et)&&pe<An($e,et)}function Oa(pe,$e,et){for(var _t=et?ga:$s,It=pe[0].length,Ut=pe.length,Xt=Ut,er=hr(Ut),cr=1/0,vr=[];Xt--;){var br=pe[Xt];Xt&&$e&&(br=_n(br,Kn($e))),cr=Bn(br.length,cr),er[Xt]=!et&&($e||It>=120&&br.length>=120)?new Fi(Xt&&br):_}br=pe[0];var wr=-1,Tr=er[0];e:for(;++wr<It&&vr.length<cr;){var Ir=br[wr],Nr=$e?$e(Ir):Ir;if(Ir=et||Ir!==0?Ir:0,!(Tr?os(Tr,Nr):_t(vr,Nr,et))){for(Xt=Ut;--Xt;){var Kr=er[Xt];if(!(Kr?os(Kr,Nr):_t(pe[Xt],Nr,et)))continue e}Tr&&Tr.push(Nr),vr.push(Ir)}}return vr}function Hf(pe,$e,et,_t){return li(pe,function(It,Ut,Xt){$e(_t,et(It),Ut,Xt)}),_t}function ys(pe,$e,et){$e=Ii($e,pe),pe=al(pe,$e);var _t=pe==null?pe:pe[fi(ri($e))];return _t==null?_:Hn(_t,pe,et)}function bc(pe){return Sn(pe)&&Nn(pe)==mt}function Kf(pe){return Sn(pe)&&Nn(pe)==xt}function zf(pe){return Sn(pe)&&Nn(pe)==vt}function vs(pe,$e,et,_t,It){return pe===$e?!0:pe==null||$e==null||!Sn(pe)&&!Sn($e)?pe!==pe&&$e!==$e:Wf(pe,$e,et,_t,vs,It)}function Wf(pe,$e,et,_t,It,Ut){var Xt=qr(pe),er=qr($e),cr=Xt?ct:Dn(pe),vr=er?ct:Dn($e);cr=cr==mt?St:cr,vr=vr==mt?St:vr;var br=cr==St,wr=vr==St,Tr=cr==vr;if(Tr&&Bi(pe)){if(!Bi($e))return!1;Xt=!0,br=!1}if(Tr&&!br)return Ut||(Ut=new si),Xt||ns(pe)?Qc(pe,$e,et,_t,It,Ut):Ed(pe,$e,cr,et,_t,It,Ut);if(!(et&Z)){var Ir=br&&hn.call(pe,"__wrapped__"),Nr=wr&&hn.call($e,"__wrapped__");if(Ir||Nr){var Kr=Ir?pe.value():pe,Mr=Nr?$e.value():$e;return Ut||(Ut=new si),It(Kr,Mr,et,_t,Ut)}}return Tr?(Ut||(Ut=new si),Sd(pe,$e,et,_t,It,Ut)):!1}function Gf(pe){return Sn(pe)&&Dn(pe)==Ye}function Na(pe,$e,et,_t){var It=et.length,Ut=It,Xt=!_t;if(pe==null)return!Ut;for(pe=gn(pe);It--;){var er=et[It];if(Xt&&er[2]?er[1]!==pe[er[0]]:!(er[0]in pe))return!1}for(;++It<Ut;){er=et[It];var cr=er[0],vr=pe[cr],br=er[1];if(Xt&&er[2]){if(vr===_&&!(cr in pe))return!1}else{var wr=new si;if(_t)var Tr=_t(vr,br,cr,pe,$e,wr);if(!(Tr===_?vs(br,vr,Z|X,_t,wr):Tr))return!1}}return!0}function _c(pe){if(!En(pe)||Pd(pe))return!1;var $e=wi(pe)?Wu:ir;return $e.test(ji(pe))}function Xf(pe){return Sn(pe)&&Nn(pe)==Ft}function Yf(pe){return Sn(pe)&&Dn(pe)==qt}function Zf(pe){return Sn(pe)&&oa(pe.length)&&!!vn[Nn(pe)]}function wc(pe){return typeof pe=="function"?pe:pe==null?jn:typeof pe=="object"?qr(pe)?xc(pe[0],pe[1]):Sc(pe):Kl(pe)}function Ma(pe){if(!ws(pe))return Ju(pe);var $e=[];for(var et in gn(pe))hn.call(pe,et)&&et!="constructor"&&$e.push(et);return $e}function Qf(pe){if(!En(pe))return Nd(pe);var $e=ws(pe),et=[];for(var _t in pe)_t=="constructor"&&($e||!hn.call(pe,_t))||et.push(_t);return et}function La(pe,$e){return pe<$e}function Ec(pe,$e){var et=-1,_t=Vn(pe)?hr(pe.length):[];return Ri(pe,function(It,Ut,Xt){_t[++et]=$e(It,Ut,Xt)}),_t}function Sc(pe){var $e=Ja(pe);return $e.length==1&&$e[0][2]?il($e[0][0],$e[0][1]):function(et){return et===pe||Na(et,pe,$e)}}function xc(pe,$e){return to(pe)&&rl($e)?il(fi(pe),$e):function(et){var _t=po(et,pe);return _t===_&&_t===$e?mo(et,pe):vs($e,_t,Z|X)}}function Ks(pe,$e,et,_t,It){pe!==$e&&Pa($e,function(Ut,Xt){if(It||(It=new si),En(Ut))Jf(pe,$e,Xt,et,Ks,_t,It);else{var er=_t?_t(no(pe,Xt),Ut,Xt+"",pe,$e,It):_;er===_&&(er=Ut),ka(pe,Xt,er)}},qn)}function Jf(pe,$e,et,_t,It,Ut,Xt){var er=no(pe,et),cr=no($e,et),vr=Xt.get(cr);if(vr){ka(pe,et,vr);return}var br=Ut?Ut(er,cr,et+"",pe,$e,Xt):_,wr=br===_;if(wr){var Tr=qr(cr),Ir=!Tr&&Bi(cr),Nr=!Tr&&!Ir&&ns(cr);br=cr,Tr||Ir||Nr?qr(er)?br=er:xn(er)?br=Un(er):Ir?(wr=!1,br=Nc(cr,!0)):Nr?(wr=!1,br=Mc(cr,!0)):br=[]:Ss(cr)||Hi(cr)?(br=er,Hi(er)?br=Ol(er):(!En(er)||wi(er))&&(br=tl(cr))):wr=!1}wr&&(Xt.set(cr,br),It(br,cr,_t,Ut,Xt),Xt.delete(cr)),ka(pe,et,br)}function $c(pe,$e){var et=pe.length;if(et)return $e+=$e<0?et:0,_i($e,et)?pe[$e]:_}function Tc(pe,$e,et){$e.length?$e=_n($e,function(Ut){return qr(Ut)?function(Xt){return Vi(Xt,Ut.length===1?Ut[0]:Ut)}:Ut}):$e=[jn];var _t=-1;$e=_n($e,Kn(Br()));var It=Ec(pe,function(Ut,Xt,er){var cr=_n($e,function(vr){return vr(Ut)});return{criteria:cr,index:++_t,value:Ut}});return $u(It,function(Ut,Xt){return hd(Ut,Xt,et)})}function ed(pe,$e){return Cc(pe,$e,function(et,_t){return mo(pe,_t)})}function Cc(pe,$e,et){for(var _t=-1,It=$e.length,Ut={};++_t<It;){var Xt=$e[_t],er=Vi(pe,Xt);et(er,Xt)&&bs(Ut,Ii(Xt,pe),er)}return Ut}function td(pe){return function($e){return Vi($e,pe)}}function Fa(pe,$e,et,_t){var It=_t?xu:zi,Ut=-1,Xt=$e.length,er=pe;for(pe===$e&&($e=Un($e)),et&&(er=_n(pe,Kn(et)));++Ut<Xt;)for(var cr=0,vr=$e[Ut],br=et?et(vr):vr;(cr=It(er,br,cr,_t))>-1;)er!==pe&&Os.call(er,cr,1),Os.call(pe,cr,1);return pe}function Ac(pe,$e){for(var et=pe?$e.length:0,_t=et-1;et--;){var It=$e[et];if(et==_t||It!==Ut){var Ut=It;_i(It)?Os.call(pe,It,1):ja(pe,It)}}return pe}function Ua(pe,$e){return pe+Ls(cc()*($e-pe+1))}function rd(pe,$e,et,_t){for(var It=-1,Ut=An(Ms(($e-pe)/(et||1)),0),Xt=hr(Ut);Ut--;)Xt[_t?Ut:++It]=pe,pe+=et;return Xt}function Va(pe,$e){var et="";if(!pe||$e<1||$e>Ge)return et;do $e%2&&(et+=pe),$e=Ls($e/2),$e&&(pe+=pe);while($e);return et}function zr(pe,$e){return so(sl(pe,$e,jn),pe+"")}function nd(pe){return fc(ss(pe))}function sd(pe,$e){var et=ss(pe);return ta(et,Ui($e,0,et.length))}function bs(pe,$e,et,_t){if(!En(pe))return pe;$e=Ii($e,pe);for(var It=-1,Ut=$e.length,Xt=Ut-1,er=pe;er!=null&&++It<Ut;){var cr=fi($e[It]),vr=et;if(cr==="__proto__"||cr==="constructor"||cr==="prototype")return pe;if(It!=Xt){var br=er[cr];vr=_t?_t(br,cr,er):_,vr===_&&(vr=En(br)?br:_i($e[It+1])?[]:{})}ps(er,cr,vr),er=er[cr]}return pe}var Rc=Fs?function(pe,$e){return Fs.set(pe,$e),pe}:jn,ad=Ns?function(pe,$e){return Ns(pe,"toString",{configurable:!0,enumerable:!1,value:bo($e),writable:!0})}:jn;function od(pe){return ta(ss(pe))}function ti(pe,$e,et){var _t=-1,It=pe.length;$e<0&&($e=-$e>It?0:It+$e),et=et>It?It:et,et<0&&(et+=It),It=$e>et?0:et-$e>>>0,$e>>>=0;for(var Ut=hr(It);++_t<It;)Ut[_t]=pe[_t+$e];return Ut}function cd(pe,$e){var et;return Ri(pe,function(_t,It,Ut){return et=$e(_t,It,Ut),!et}),!!et}function zs(pe,$e,et){var _t=0,It=pe==null?_t:pe.length;if(typeof $e=="number"&&$e===$e&&It<=tt){for(;_t<It;){var Ut=_t+It>>>1,Xt=pe[Ut];Xt!==null&&!Wn(Xt)&&(et?Xt<=$e:Xt<$e)?_t=Ut+1:It=Ut}return It}return qa(pe,$e,jn,et)}function qa(pe,$e,et,_t){var It=0,Ut=pe==null?0:pe.length;if(Ut===0)return 0;$e=et($e);for(var Xt=$e!==$e,er=$e===null,cr=Wn($e),vr=$e===_;It<Ut;){var br=Ls((It+Ut)/2),wr=et(pe[br]),Tr=wr!==_,Ir=wr===null,Nr=wr===wr,Kr=Wn(wr);if(Xt)var Mr=_t||Nr;else vr?Mr=Nr&&(_t||Tr):er?Mr=Nr&&Tr&&(_t||!Ir):cr?Mr=Nr&&Tr&&!Ir&&(_t||!Kr):Ir||Kr?Mr=!1:Mr=_t?wr<=$e:wr<$e;Mr?It=br+1:Ut=br}return Bn(Ut,Me)}function kc(pe,$e){for(var et=-1,_t=pe.length,It=0,Ut=[];++et<_t;){var Xt=pe[et],er=$e?$e(Xt):Xt;if(!et||!ai(er,cr)){var cr=er;Ut[It++]=Xt===0?0:Xt}}return Ut}function Ic(pe){return typeof pe=="number"?pe:Wn(pe)?Ve:+pe}function zn(pe){if(typeof pe=="string")return pe;if(qr(pe))return _n(pe,zn)+"";if(Wn(pe))return lc?lc.call(pe):"";var $e=pe+"";return $e=="0"&&1/pe==-Be?"-0":$e}function ki(pe,$e,et){var _t=-1,It=$s,Ut=pe.length,Xt=!0,er=[],cr=er;if(et)Xt=!1,It=ga;else if(Ut>=S){var vr=$e?null:_d(pe);if(vr)return Cs(vr);Xt=!1,It=os,cr=new Fi}else cr=$e?[]:er;e:for(;++_t<Ut;){var br=pe[_t],wr=$e?$e(br):br;if(br=et||br!==0?br:0,Xt&&wr===wr){for(var Tr=cr.length;Tr--;)if(cr[Tr]===wr)continue e;$e&&cr.push(wr),er.push(br)}else It(cr,wr,et)||(cr!==er&&cr.push(wr),er.push(br))}return er}function ja(pe,$e){return $e=Ii($e,pe),pe=al(pe,$e),pe==null||delete pe[fi(ri($e))]}function Pc(pe,$e,et,_t){return bs(pe,$e,et(Vi(pe,$e)),_t)}function Ws(pe,$e,et,_t){for(var It=pe.length,Ut=_t?It:-1;(_t?Ut--:++Ut<It)&&$e(pe[Ut],Ut,pe););return et?ti(pe,_t?0:Ut,_t?Ut+1:It):ti(pe,_t?Ut+1:0,_t?It:Ut)}function Bc(pe,$e){var et=pe;return et instanceof Xr&&(et=et.value()),ya($e,function(_t,It){return It.func.apply(It.thisArg,Ti([_t],It.args))},et)}function Ha(pe,$e,et){var _t=pe.length;if(_t<2)return _t?ki(pe[0]):[];for(var It=-1,Ut=hr(_t);++It<_t;)for(var Xt=pe[It],er=-1;++er<_t;)er!=It&&(Ut[It]=gs(Ut[It]||Xt,pe[er],$e,et));return ki(Pn(Ut,1),$e,et)}function Dc(pe,$e,et){for(var _t=-1,It=pe.length,Ut=$e.length,Xt={};++_t<It;){var er=_t<Ut?$e[_t]:_;et(Xt,pe[_t],er)}return Xt}function Ka(pe){return xn(pe)?pe:[]}function za(pe){return typeof pe=="function"?pe:jn}function Ii(pe,$e){return qr(pe)?pe:to(pe,$e)?[pe]:ul(un(pe))}var ld=zr;function Pi(pe,$e,et){var _t=pe.length;return et=et===_?_t:et,!$e&&et>=_t?pe:ti(pe,$e,et)}var Oc=Gu||function(pe){return In.clearTimeout(pe)};function Nc(pe,$e){if($e)return pe.slice();var et=pe.length,_t=nc?nc(et):new pe.constructor(et);return pe.copy(_t),_t}function Wa(pe){var $e=new pe.constructor(pe.byteLength);return new Bs($e).set(new Bs(pe)),$e}function ud(pe,$e){var et=$e?Wa(pe.buffer):pe.buffer;return new pe.constructor(et,pe.byteOffset,pe.byteLength)}function fd(pe){var $e=new pe.constructor(pe.source,Jt.exec(pe));return $e.lastIndex=pe.lastIndex,$e}function dd(pe){return hs?gn(hs.call(pe)):{}}function Mc(pe,$e){var et=$e?Wa(pe.buffer):pe.buffer;return new pe.constructor(et,pe.byteOffset,pe.length)}function Lc(pe,$e){if(pe!==$e){var et=pe!==_,_t=pe===null,It=pe===pe,Ut=Wn(pe),Xt=$e!==_,er=$e===null,cr=$e===$e,vr=Wn($e);if(!er&&!vr&&!Ut&&pe>$e||Ut&&Xt&&cr&&!er&&!vr||_t&&Xt&&cr||!et&&cr||!It)return 1;if(!_t&&!Ut&&!vr&&pe<$e||vr&&et&&It&&!_t&&!Ut||er&&et&&It||!Xt&&It||!cr)return-1}return 0}function hd(pe,$e,et){for(var _t=-1,It=pe.criteria,Ut=$e.criteria,Xt=It.length,er=et.length;++_t<Xt;){var cr=Lc(It[_t],Ut[_t]);if(cr){if(_t>=er)return cr;var vr=et[_t];return cr*(vr=="desc"?-1:1)}}return pe.index-$e.index}function Fc(pe,$e,et,_t){for(var It=-1,Ut=pe.length,Xt=et.length,er=-1,cr=$e.length,vr=An(Ut-Xt,0),br=hr(cr+vr),wr=!_t;++er<cr;)br[er]=$e[er];for(;++It<Xt;)(wr||It<Ut)&&(br[et[It]]=pe[It]);for(;vr--;)br[er++]=pe[It++];return br}function Uc(pe,$e,et,_t){for(var It=-1,Ut=pe.length,Xt=-1,er=et.length,cr=-1,vr=$e.length,br=An(Ut-er,0),wr=hr(br+vr),Tr=!_t;++It<br;)wr[It]=pe[It];for(var Ir=It;++cr<vr;)wr[Ir+cr]=$e[cr];for(;++Xt<er;)(Tr||It<Ut)&&(wr[Ir+et[Xt]]=pe[It++]);return wr}function Un(pe,$e){var et=-1,_t=pe.length;for($e||($e=hr(_t));++et<_t;)$e[et]=pe[et];return $e}function ui(pe,$e,et,_t){var It=!et;et||(et={});for(var Ut=-1,Xt=$e.length;++Ut<Xt;){var er=$e[Ut],cr=_t?_t(et[er],pe[er],er,et,pe):_;cr===_&&(cr=pe[er]),It?yi(et,er,cr):ps(et,er,cr)}return et}function pd(pe,$e){return ui(pe,eo(pe),$e)}function md(pe,$e){return ui(pe,Jc(pe),$e)}function Gs(pe,$e){return function(et,_t){var It=qr(et)?vu:Nf,Ut=$e?$e():{};return It(et,pe,Br(_t,2),Ut)}}function es(pe){return zr(function($e,et){var _t=-1,It=et.length,Ut=It>1?et[It-1]:_,Xt=It>2?et[2]:_;for(Ut=pe.length>3&&typeof Ut=="function"?(It--,Ut):_,Xt&&Mn(et[0],et[1],Xt)&&(Ut=It<3?_:Ut,It=1),$e=gn($e);++_t<It;){var er=et[_t];er&&pe($e,er,_t,Ut)}return $e})}function Vc(pe,$e){return function(et,_t){if(et==null)return et;if(!Vn(et))return pe(et,_t);for(var It=et.length,Ut=$e?It:-1,Xt=gn(et);($e?Ut--:++Ut<It)&&_t(Xt[Ut],Ut,Xt)!==!1;);return et}}function qc(pe){return function($e,et,_t){for(var It=-1,Ut=gn($e),Xt=_t($e),er=Xt.length;er--;){var cr=Xt[pe?er:++It];if(et(Ut[cr],cr,Ut)===!1)break}return $e}}function gd(pe,$e,et){var _t=$e&Q,It=_s(pe);function Ut(){var Xt=this&&this!==In&&this instanceof Ut?It:pe;return Xt.apply(_t?et:this,arguments)}return Ut}function jc(pe){return function($e){$e=un($e);var et=Wi($e)?ii($e):_,_t=et?et[0]:$e.charAt(0),It=et?Pi(et,1).join(""):$e.slice(1);return _t[pe]()+It}}function ts(pe){return function($e){return ya(jl(ql($e).replace(iu,"")),pe,"")}}function _s(pe){return function(){var $e=arguments;switch($e.length){case 0:return new pe;case 1:return new pe($e[0]);case 2:return new pe($e[0],$e[1]);case 3:return new pe($e[0],$e[1],$e[2]);case 4:return new pe($e[0],$e[1],$e[2],$e[3]);case 5:return new pe($e[0],$e[1],$e[2],$e[3],$e[4]);case 6:return new pe($e[0],$e[1],$e[2],$e[3],$e[4],$e[5]);case 7:return new pe($e[0],$e[1],$e[2],$e[3],$e[4],$e[5],$e[6])}var et=Ji(pe.prototype),_t=pe.apply(et,$e);return En(_t)?_t:et}}function yd(pe,$e,et){var _t=_s(pe);function It(){for(var Ut=arguments.length,Xt=hr(Ut),er=Ut,cr=rs(It);er--;)Xt[er]=arguments[er];var vr=Ut<3&&Xt[0]!==cr&&Xt[Ut-1]!==cr?[]:Ci(Xt,cr);if(Ut-=vr.length,Ut<et)return Gc(pe,$e,Xs,It.placeholder,_,Xt,vr,_,_,et-Ut);var br=this&&this!==In&&this instanceof It?_t:pe;return Hn(br,this,Xt)}return It}function Hc(pe){return function($e,et,_t){var It=gn($e);if(!Vn($e)){var Ut=Br(et,3);$e=kn($e),et=function(er){return Ut(It[er],er,It)}}var Xt=pe($e,et,_t);return Xt>-1?It[Ut?$e[Xt]:Xt]:_}}function Kc(pe){return bi(function($e){var et=$e.length,_t=et,It=Jn.prototype.thru;for(pe&&$e.reverse();_t--;){var Ut=$e[_t];if(typeof Ut!="function")throw new Qn(A);if(It&&!Xt&&Js(Ut)=="wrapper")var Xt=new Jn([],!0)}for(_t=Xt?_t:et;++_t<et;){Ut=$e[_t];var er=Js(Ut),cr=er=="wrapper"?Qa(Ut):_;cr&&ro(cr[0])&&cr[1]==(Re|ue|Te|Ne)&&!cr[4].length&&cr[9]==1?Xt=Xt[Js(cr[0])].apply(Xt,cr[3]):Xt=Ut.length==1&&ro(Ut)?Xt[er]():Xt.thru(Ut)}return function(){var vr=arguments,br=vr[0];if(Xt&&vr.length==1&&qr(br))return Xt.plant(br).value();for(var wr=0,Tr=et?$e[wr].apply(this,vr):br;++wr<et;)Tr=$e[wr].call(this,Tr);return Tr}})}function Xs(pe,$e,et,_t,It,Ut,Xt,er,cr,vr){var br=$e&Re,wr=$e&Q,Tr=$e&se,Ir=$e&(ue|we),Nr=$e&Fe,Kr=Tr?_:_s(pe);function Mr(){for(var Gr=arguments.length,Zr=hr(Gr),Gn=Gr;Gn--;)Zr[Gn]=arguments[Gn];if(Ir)var Ln=rs(Mr),Xn=Cu(Zr,Ln);if(_t&&(Zr=Fc(Zr,_t,It,Ir)),Ut&&(Zr=Uc(Zr,Ut,Xt,Ir)),Gr-=Xn,Ir&&Gr<vr){var $n=Ci(Zr,Ln);return Gc(pe,$e,Xs,Mr.placeholder,et,Zr,$n,er,cr,vr-Gr)}var oi=wr?et:this,Si=Tr?oi[pe]:pe;return Gr=Zr.length,er?Zr=Ld(Zr,er):Nr&&Gr>1&&Zr.reverse(),br&&cr<Gr&&(Zr.length=cr),this&&this!==In&&this instanceof Mr&&(Si=Kr||_s(Si)),Si.apply(oi,Zr)}return Mr}function zc(pe,$e){return function(et,_t){return Hf(et,pe,$e(_t),{})}}function Ys(pe,$e){return function(et,_t){var It;if(et===_&&_t===_)return $e;if(et!==_&&(It=et),_t!==_){if(It===_)return _t;typeof et=="string"||typeof _t=="string"?(et=zn(et),_t=zn(_t)):(et=Ic(et),_t=Ic(_t)),It=pe(et,_t)}return It}}function Ga(pe){return bi(function($e){return $e=_n($e,Kn(Br())),zr(function(et){var _t=this;return pe($e,function(It){return Hn(It,_t,et)})})})}function Zs(pe,$e){$e=$e===_?" ":zn($e);var et=$e.length;if(et<2)return et?Va($e,pe):$e;var _t=Va($e,Ms(pe/Gi($e)));return Wi($e)?Pi(ii(_t),0,pe).join(""):_t.slice(0,pe)}function bd(pe,$e,et,_t){var It=$e&Q,Ut=_s(pe);function Xt(){for(var er=-1,cr=arguments.length,vr=-1,br=_t.length,wr=hr(br+cr),Tr=this&&this!==In&&this instanceof Xt?Ut:pe;++vr<br;)wr[vr]=_t[vr];for(;cr--;)wr[vr++]=arguments[++er];return Hn(Tr,It?et:this,wr)}return Xt}function Wc(pe){return function($e,et,_t){return _t&&typeof _t!="number"&&Mn($e,et,_t)&&(et=_t=_),$e=Ei($e),et===_?(et=$e,$e=0):et=Ei(et),_t=_t===_?$e<et?1:-1:Ei(_t),rd($e,et,_t,pe)}}function Qs(pe){return function($e,et){return typeof $e=="string"&&typeof et=="string"||($e=ni($e),et=ni(et)),pe($e,et)}}function Gc(pe,$e,et,_t,It,Ut,Xt,er,cr,vr){var br=$e&ue,wr=br?Xt:_,Tr=br?_:Xt,Ir=br?Ut:_,Nr=br?_:Ut;$e|=br?Te:xe,$e&=~(br?xe:Te),$e&oe||($e&=~(Q|se));var Kr=[pe,$e,It,Ir,wr,Nr,Tr,er,cr,vr],Mr=et.apply(_,Kr);return ro(pe)&&ol(Mr,Kr),Mr.placeholder=_t,cl(Mr,pe,$e)}function Xa(pe){var $e=Cn[pe];return function(et,_t){if(et=ni(et),_t=_t==null?0:Bn(jr(_t),292),_t&&oc(et)){var It=(un(et)+"e").split("e"),Ut=$e(It[0]+"e"+(+It[1]+_t));return It=(un(Ut)+"e").split("e"),+(It[0]+"e"+(+It[1]-_t))}return $e(et)}}var _d=Zi&&1/Cs(new Zi([,-0]))[1]==Be?function(pe){return new Zi(pe)}:Eo;function Xc(pe){return function($e){var et=Dn($e);return et==Ye?$a($e):et==qt?Du($e):Tu($e,pe($e))}}function vi(pe,$e,et,_t,It,Ut,Xt,er){var cr=$e&se;if(!cr&&typeof pe!="function")throw new Qn(A);var vr=_t?_t.length:0;if(vr||($e&=~(Te|xe),_t=It=_),Xt=Xt===_?Xt:An(jr(Xt),0),er=er===_?er:jr(er),vr-=It?It.length:0,$e&xe){var br=_t,wr=It;_t=It=_}var Tr=cr?_:Qa(pe),Ir=[pe,$e,et,_t,It,br,wr,Ut,Xt,er];if(Tr&&Od(Ir,Tr),pe=Ir[0],$e=Ir[1],et=Ir[2],_t=Ir[3],It=Ir[4],er=Ir[9]=Ir[9]===_?cr?0:pe.length:An(Ir[9]-vr,0),!er&&$e&(ue|we)&&($e&=~(ue|we)),!$e||$e==Q)var Nr=gd(pe,$e,et);else $e==ue||$e==we?Nr=yd(pe,$e,er):($e==Te||$e==(Q|Te))&&!It.length?Nr=bd(pe,$e,et,_t):Nr=Xs.apply(_,Ir);var Kr=Tr?Rc:ol;return cl(Kr(Nr,Ir),pe,$e)}function Yc(pe,$e,et,_t){return pe===_||ai(pe,Yi[et])&&!hn.call(_t,et)?$e:pe}function Zc(pe,$e,et,_t,It,Ut){return En(pe)&&En($e)&&(Ut.set($e,pe),Ks(pe,$e,_,Zc,Ut),Ut.delete($e)),pe}function wd(pe){return Ss(pe)?_:pe}function Qc(pe,$e,et,_t,It,Ut){var Xt=et&Z,er=pe.length,cr=$e.length;if(er!=cr&&!(Xt&&cr>er))return!1;var vr=Ut.get(pe),br=Ut.get($e);if(vr&&br)return vr==$e&&br==pe;var wr=-1,Tr=!0,Ir=et&X?new Fi:_;for(Ut.set(pe,$e),Ut.set($e,pe);++wr<er;){var Nr=pe[wr],Kr=$e[wr];if(_t)var Mr=Xt?_t(Kr,Nr,wr,$e,pe,Ut):_t(Nr,Kr,wr,pe,$e,Ut);if(Mr!==_){if(Mr)continue;Tr=!1;break}if(Ir){if(!va($e,function(Gr,Zr){if(!os(Ir,Zr)&&(Nr===Gr||It(Nr,Gr,et,_t,Ut)))return Ir.push(Zr)})){Tr=!1;break}}else if(!(Nr===Kr||It(Nr,Kr,et,_t,Ut))){Tr=!1;break}}return Ut.delete(pe),Ut.delete($e),Tr}function Ed(pe,$e,et,_t,It,Ut,Xt){switch(et){case pt:if(pe.byteLength!=$e.byteLength||pe.byteOffset!=$e.byteOffset)return!1;pe=pe.buffer,$e=$e.buffer;case xt:return!(pe.byteLength!=$e.byteLength||!Ut(new Bs(pe),new Bs($e)));case dt:case vt:case Ct:return ai(+pe,+$e);case bt:return pe.name==$e.name&&pe.message==$e.message;case Ft:case Mt:return pe==$e+"";case Ye:var er=$a;case qt:var cr=_t&Z;if(er||(er=Cs),pe.size!=$e.size&&!cr)return!1;var vr=Xt.get(pe);if(vr)return vr==$e;_t|=X,Xt.set(pe,$e);var br=Qc(er(pe),er($e),_t,It,Ut,Xt);return Xt.delete(pe),br;case Wt:if(hs)return hs.call(pe)==hs.call($e)}return!1}function Sd(pe,$e,et,_t,It,Ut){var Xt=et&Z,er=Ya(pe),cr=er.length,vr=Ya($e),br=vr.length;if(cr!=br&&!Xt)return!1;for(var wr=cr;wr--;){var Tr=er[wr];if(!(Xt?Tr in $e:hn.call($e,Tr)))return!1}var Ir=Ut.get(pe),Nr=Ut.get($e);if(Ir&&Nr)return Ir==$e&&Nr==pe;var Kr=!0;Ut.set(pe,$e),Ut.set($e,pe);for(var Mr=Xt;++wr<cr;){Tr=er[wr];var Gr=pe[Tr],Zr=$e[Tr];if(_t)var Gn=Xt?_t(Zr,Gr,Tr,$e,pe,Ut):_t(Gr,Zr,Tr,pe,$e,Ut);if(!(Gn===_?Gr===Zr||It(Gr,Zr,et,_t,Ut):Gn)){Kr=!1;break}Mr||(Mr=Tr=="constructor")}if(Kr&&!Mr){var Ln=pe.constructor,Xn=$e.constructor;Ln!=Xn&&"constructor"in pe&&"constructor"in $e&&!(typeof Ln=="function"&&Ln instanceof Ln&&typeof Xn=="function"&&Xn instanceof Xn)&&(Kr=!1)}return Ut.delete(pe),Ut.delete($e),Kr}function bi(pe){return so(sl(pe,_,pl),pe+"")}function Ya(pe){return vc(pe,kn,eo)}function Za(pe){return vc(pe,qn,Jc)}var Qa=Fs?function(pe){return Fs.get(pe)}:Eo;function Js(pe){for(var $e=pe.name+"",et=Qi[$e],_t=hn.call(Qi,$e)?et.length:0;_t--;){var It=et[_t],Ut=It.func;if(Ut==null||Ut==pe)return It.name}return $e}function rs(pe){var $e=hn.call(Lt,"placeholder")?Lt:pe;return $e.placeholder}function Br(){var pe=Lt.iteratee||_o;return pe=pe===_o?wc:pe,arguments.length?pe(arguments[0],arguments[1]):pe}function ea(pe,$e){var et=pe.__data__;return Id($e)?et[typeof $e=="string"?"string":"hash"]:et.map}function Ja(pe){for(var $e=kn(pe),et=$e.length;et--;){var _t=$e[et],It=pe[_t];$e[et]=[_t,It,rl(It)]}return $e}function qi(pe,$e){var et=Iu(pe,$e);return _c(et)?et:_}function xd(pe){var $e=hn.call(pe,Mi),et=pe[Mi];try{pe[Mi]=_;var _t=!0}catch{}var It=Is.call(pe);return _t&&($e?pe[Mi]=et:delete pe[Mi]),It}var eo=Ca?function(pe){return pe==null?[]:(pe=gn(pe),$i(Ca(pe),function($e){return sc.call(pe,$e)}))}:So,Jc=Ca?function(pe){for(var $e=[];pe;)Ti($e,eo(pe)),pe=Ds(pe);return $e}:So,Dn=Nn;(Aa&&Dn(new Aa(new ArrayBuffer(1)))!=pt||us&&Dn(new us)!=Ye||Ra&&Dn(Ra.resolve())!=$t||Zi&&Dn(new Zi)!=qt||fs&&Dn(new fs)!=Yt)&&(Dn=function(pe){var $e=Nn(pe),et=$e==St?pe.constructor:_,_t=et?ji(et):"";if(_t)switch(_t){case nf:return pt;case sf:return Ye;case af:return $t;case of:return qt;case cf:return Yt}return $e});function $d(pe,$e,et){for(var _t=-1,It=et.length;++_t<It;){var Ut=et[_t],Xt=Ut.size;switch(Ut.type){case"drop":pe+=Xt;break;case"dropRight":$e-=Xt;break;case"take":$e=Bn($e,pe+Xt);break;case"takeRight":pe=An(pe,$e-Xt);break}}return{start:pe,end:$e}}function Td(pe){var $e=pe.match(wt);return $e?$e[1].split(Rt):[]}function el(pe,$e,et){$e=Ii($e,pe);for(var _t=-1,It=$e.length,Ut=!1;++_t<It;){var Xt=fi($e[_t]);if(!(Ut=pe!=null&&et(pe,Xt)))break;pe=pe[Xt]}return Ut||++_t!=It?Ut:(It=pe==null?0:pe.length,!!It&&oa(It)&&_i(Xt,It)&&(qr(pe)||Hi(pe)))}function Cd(pe){var $e=pe.length,et=new pe.constructor($e);return $e&&typeof pe[0]=="string"&&hn.call(pe,"index")&&(et.index=pe.index,et.input=pe.input),et}function tl(pe){return typeof pe.constructor=="function"&&!ws(pe)?Ji(Ds(pe)):{}}function Ad(pe,$e,et){var _t=pe.constructor;switch($e){case xt:return Wa(pe);case dt:case vt:return new _t(+pe);case pt:return ud(pe,et);case yt:case Bt:case Ht:case nr:case Qt:case xr:case kr:case Sr:case $r:return Mc(pe,et);case Ye:return new _t;case Ct:case Mt:return new _t(pe);case Ft:return fd(pe);case qt:return new _t;case Wt:return dd(pe)}}function Rd(pe,$e){var et=$e.length;if(!et)return pe;var _t=et-1;return $e[_t]=(et>1?"& ":"")+$e[_t],$e=$e.join(et>2?", ":" "),pe.replace(jt,`{
/* [wrapped with `+$e+`] */
`)}function kd(pe){return qr(pe)||Hi(pe)||!!(ac&&pe&&pe[ac])}function _i(pe,$e){var et=typeof pe;return $e=$e??Ge,!!$e&&(et=="number"||et!="symbol"&&dr.test(pe))&&pe>-1&&pe%1==0&&pe<$e}function Mn(pe,$e,et){if(!En(et))return!1;var _t=typeof $e;return(_t=="number"?Vn(et)&&_i($e,et.length):_t=="string"&&$e in et)?ai(et[$e],pe):!1}function to(pe,$e){if(qr(pe))return!1;var et=typeof pe;return et=="number"||et=="symbol"||et=="boolean"||pe==null||Wn(pe)?!0:ln.test(pe)||!Lr.test(pe)||$e!=null&&pe in gn($e)}function Id(pe){var $e=typeof pe;return $e=="string"||$e=="number"||$e=="symbol"||$e=="boolean"?pe!=="__proto__":pe===null}function ro(pe){var $e=Js(pe),et=Lt[$e];if(typeof et!="function"||!($e in Xr.prototype))return!1;if(pe===et)return!0;var _t=Qa(et);return!!_t&&pe===_t[0]}function Pd(pe){return!!rc&&rc in pe}var Bd=Rs?wi:xo;function ws(pe){var $e=pe&&pe.constructor,et=typeof $e=="function"&&$e.prototype||Yi;return pe===et}function rl(pe){return pe===pe&&!En(pe)}function il(pe,$e){return function(et){return et==null?!1:et[pe]===$e&&($e!==_||pe in gn(et))}}function Dd(pe){var $e=sa(pe,function(_t){return et.size===O&&et.clear(),_t}),et=$e.cache;return $e}function Od(pe,$e){var et=pe[1],_t=$e[1],It=et|_t,Ut=It<(Q|se|Re),Xt=_t==Re&&et==ue||_t==Re&&et==Ne&&pe[7].length<=$e[8]||_t==(Re|Ne)&&$e[7].length<=$e[8]&&et==ue;if(!(Ut||Xt))return pe;_t&Q&&(pe[2]=$e[2],It|=et&Q?0:oe);var er=$e[3];if(er){var cr=pe[3];pe[3]=cr?Fc(cr,er,$e[4]):er,pe[4]=cr?Ci(pe[3],N):$e[4]}return er=$e[5],er&&(cr=pe[5],pe[5]=cr?Uc(cr,er,$e[6]):er,pe[6]=cr?Ci(pe[5],N):$e[6]),er=$e[7],er&&(pe[7]=er),_t&Re&&(pe[8]=pe[8]==null?$e[8]:Bn(pe[8],$e[8])),pe[9]==null&&(pe[9]=$e[9]),pe[0]=$e[0],pe[1]=It,pe}function Nd(pe){var $e=[];if(pe!=null)for(var et in gn(pe))$e.push(et);return $e}function Md(pe){return Is.call(pe)}function sl(pe,$e,et){return $e=An($e===_?pe.length-1:$e,0),function(){for(var _t=arguments,It=-1,Ut=An(_t.length-$e,0),Xt=hr(Ut);++It<Ut;)Xt[It]=_t[$e+It];It=-1;for(var er=hr($e+1);++It<$e;)er[It]=_t[It];return er[$e]=et(Xt),Hn(pe,this,er)}}function al(pe,$e){return $e.length<2?pe:Vi(pe,ti($e,0,-1))}function Ld(pe,$e){for(var et=pe.length,_t=Bn($e.length,et),It=Un(pe);_t--;){var Ut=$e[_t];pe[_t]=_i(Ut,et)?It[Ut]:_}return pe}function no(pe,$e){if(!($e==="constructor"&&typeof pe[$e]=="function")&&$e!="__proto__")return pe[$e]}var ol=ll(Rc),Es=Yu||function(pe,$e){return In.setTimeout(pe,$e)},so=ll(ad);function cl(pe,$e,et){var _t=$e+"";return so(pe,Rd(_t,Fd(Td(_t),et)))}function ll(pe){var $e=0,et=0;return function(){var _t=ef(),It=Ce-(_t-et);if(et=_t,It>0){if(++$e>=Ee)return arguments[0]}else $e=0;return pe.apply(_,arguments)}}function ta(pe,$e){var et=-1,_t=pe.length,It=_t-1;for($e=$e===_?_t:$e;++et<$e;){var Ut=Ua(et,It),Xt=pe[Ut];pe[Ut]=pe[et],pe[et]=Xt}return pe.length=$e,pe}var ul=Dd(function(pe){var $e=[];return pe.charCodeAt(0)===46&&$e.push(""),pe.replace(fn,function(et,_t,It,Ut){$e.push(It?Ut.replace(Ot,"$1"):_t||et)}),$e});function fi(pe){if(typeof pe=="string"||Wn(pe))return pe;var $e=pe+"";return $e=="0"&&1/pe==-Be?"-0":$e}function ji(pe){if(pe!=null){try{return ks.call(pe)}catch{}try{return pe+""}catch{}}return""}function Fd(pe,$e){return Zn(Ke,function(et){var _t="_."+et[0];$e&et[1]&&!$s(pe,_t)&&pe.push(_t)}),pe.sort()}function fl(pe){if(pe instanceof Xr)return pe.clone();var $e=new Jn(pe.__wrapped__,pe.__chain__);return $e.__actions__=Un(pe.__actions__),$e.__index__=pe.__index__,$e.__values__=pe.__values__,$e}function Ud(pe,$e,et){(et?Mn(pe,$e,et):$e===_)?$e=1:$e=An(jr($e),0);var _t=pe==null?0:pe.length;if(!_t||$e<1)return[];for(var It=0,Ut=0,Xt=hr(Ms(_t/$e));It<_t;)Xt[Ut++]=ti(pe,It,It+=$e);return Xt}function Vd(pe){for(var $e=-1,et=pe==null?0:pe.length,_t=0,It=[];++$e<et;){var Ut=pe[$e];Ut&&(It[_t++]=Ut)}return It}function qd(){var pe=arguments.length;if(!pe)return[];for(var $e=hr(pe-1),et=arguments[0],_t=pe;_t--;)$e[_t-1]=arguments[_t];return Ti(qr(et)?Un(et):[et],Pn($e,1))}var jd=zr(function(pe,$e){return xn(pe)?gs(pe,Pn($e,1,xn,!0)):[]}),Hd=zr(function(pe,$e){var et=ri($e);return xn(et)&&(et=_),xn(pe)?gs(pe,Pn($e,1,xn,!0),Br(et,2)):[]}),Kd=zr(function(pe,$e){var et=ri($e);return xn(et)&&(et=_),xn(pe)?gs(pe,Pn($e,1,xn,!0),_,et):[]});function zd(pe,$e,et){var _t=pe==null?0:pe.length;return _t?($e=et||$e===_?1:jr($e),ti(pe,$e<0?0:$e,_t)):[]}function Wd(pe,$e,et){var _t=pe==null?0:pe.length;return _t?($e=et||$e===_?1:jr($e),$e=_t-$e,ti(pe,0,$e<0?0:$e)):[]}function Gd(pe,$e){return pe&&pe.length?Ws(pe,Br($e,3),!0,!0):[]}function Xd(pe,$e){return pe&&pe.length?Ws(pe,Br($e,3),!0):[]}function Yd(pe,$e,et,_t){var It=pe==null?0:pe.length;return It?(et&&typeof et!="number"&&Mn(pe,$e,et)&&(et=0,_t=It),Uf(pe,$e,et,_t)):[]}function dl(pe,$e,et){var _t=pe==null?0:pe.length;if(!_t)return-1;var It=et==null?0:jr(et);return It<0&&(It=An(_t+It,0)),Ts(pe,Br($e,3),It)}function hl(pe,$e,et){var _t=pe==null?0:pe.length;if(!_t)return-1;var It=_t-1;return et!==_&&(It=jr(et),It=et<0?An(_t+It,0):Bn(It,_t-1)),Ts(pe,Br($e,3),It,!0)}function pl(pe){var $e=pe==null?0:pe.length;return $e?Pn(pe,1):[]}function Zd(pe){var $e=pe==null?0:pe.length;return $e?Pn(pe,Be):[]}function Qd(pe,$e){var et=pe==null?0:pe.length;return et?($e=$e===_?1:jr($e),Pn(pe,$e)):[]}function Jd(pe){for(var $e=-1,et=pe==null?0:pe.length,_t={};++$e<et;){var It=pe[$e];_t[It[0]]=It[1]}return _t}function ml(pe){return pe&&pe.length?pe[0]:_}function eh(pe,$e,et){var _t=pe==null?0:pe.length;if(!_t)return-1;var It=et==null?0:jr(et);return It<0&&(It=An(_t+It,0)),zi(pe,$e,It)}function th(pe){var $e=pe==null?0:pe.length;return $e?ti(pe,0,-1):[]}var rh=zr(function(pe){var $e=_n(pe,Ka);return $e.length&&$e[0]===pe[0]?Oa($e):[]}),nh=zr(function(pe){var $e=ri(pe),et=_n(pe,Ka);return $e===ri(et)?$e=_:et.pop(),et.length&&et[0]===pe[0]?Oa(et,Br($e,2)):[]}),ih=zr(function(pe){var $e=ri(pe),et=_n(pe,Ka);return $e=typeof $e=="function"?$e:_,$e&&et.pop(),et.length&&et[0]===pe[0]?Oa(et,_,$e):[]});function sh(pe,$e){return pe==null?"":Qu.call(pe,$e)}function ri(pe){var $e=pe==null?0:pe.length;return $e?pe[$e-1]:_}function ah(pe,$e,et){var _t=pe==null?0:pe.length;if(!_t)return-1;var It=_t;return et!==_&&(It=jr(et),It=It<0?An(_t+It,0):Bn(It,_t-1)),$e===$e?Nu(pe,$e,It):Ts(pe,Wo,It,!0)}function oh(pe,$e){return pe&&pe.length?$c(pe,jr($e)):_}var ch=zr(gl);function gl(pe,$e){return pe&&pe.length&&$e&&$e.length?Fa(pe,$e):pe}function lh(pe,$e,et){return pe&&pe.length&&$e&&$e.length?Fa(pe,$e,Br(et,2)):pe}function uh(pe,$e,et){return pe&&pe.length&&$e&&$e.length?Fa(pe,$e,_,et):pe}var fh=bi(function(pe,$e){var et=pe==null?0:pe.length,_t=Ia(pe,$e);return Ac(pe,_n($e,function(It){return _i(It,et)?+It:It}).sort(Lc)),_t});function hh(pe,$e){var et=[];if(!(pe&&pe.length))return et;var _t=-1,It=[],Ut=pe.length;for($e=Br($e,3);++_t<Ut;){var Xt=pe[_t];$e(Xt,_t,pe)&&(et.push(Xt),It.push(_t))}return Ac(pe,It),et}function ao(pe){return pe==null?pe:rf.call(pe)}function ph(pe,$e,et){var _t=pe==null?0:pe.length;return _t?(et&&typeof et!="number"&&Mn(pe,$e,et)?($e=0,et=_t):($e=$e==null?0:jr($e),et=et===_?_t:jr(et)),ti(pe,$e,et)):[]}function mh(pe,$e){return zs(pe,$e)}function gh(pe,$e,et){return qa(pe,$e,Br(et,2))}function yh(pe,$e){var et=pe==null?0:pe.length;if(et){var _t=zs(pe,$e);if(_t<et&&ai(pe[_t],$e))return _t}return-1}function vh(pe,$e){return zs(pe,$e,!0)}function bh(pe,$e,et){return qa(pe,$e,Br(et,2),!0)}function _h(pe,$e){var et=pe==null?0:pe.length;if(et){var _t=zs(pe,$e,!0)-1;if(ai(pe[_t],$e))return _t}return-1}function wh(pe){return pe&&pe.length?kc(pe):[]}function Eh(pe,$e){return pe&&pe.length?kc(pe,Br($e,2)):[]}function Sh(pe){var $e=pe==null?0:pe.length;return $e?ti(pe,1,$e):[]}function xh(pe,$e,et){return pe&&pe.length?($e=et||$e===_?1:jr($e),ti(pe,0,$e<0?0:$e)):[]}function $h(pe,$e,et){var _t=pe==null?0:pe.length;return _t?($e=et||$e===_?1:jr($e),$e=_t-$e,ti(pe,$e<0?0:$e,_t)):[]}function Th(pe,$e){return pe&&pe.length?Ws(pe,Br($e,3),!1,!0):[]}function Ch(pe,$e){return pe&&pe.length?Ws(pe,Br($e,3)):[]}var Ah=zr(function(pe){return ki(Pn(pe,1,xn,!0))}),Rh=zr(function(pe){var $e=ri(pe);return xn($e)&&($e=_),ki(Pn(pe,1,xn,!0),Br($e,2))}),kh=zr(function(pe){var $e=ri(pe);return $e=typeof $e=="function"?$e:_,ki(Pn(pe,1,xn,!0),_,$e)});function Ih(pe){return pe&&pe.length?ki(pe):[]}function Ph(pe,$e){return pe&&pe.length?ki(pe,Br($e,2)):[]}function Bh(pe,$e){return $e=typeof $e=="function"?$e:_,pe&&pe.length?ki(pe,_,$e):[]}function oo(pe){if(!(pe&&pe.length))return[];var $e=0;return pe=$i(pe,function(et){if(xn(et))return $e=An(et.length,$e),!0}),Sa($e,function(et){return _n(pe,ba(et))})}function yl(pe,$e){if(!(pe&&pe.length))return[];var et=oo(pe);return $e==null?et:_n(et,function(_t){return Hn($e,_,_t)})}var Dh=zr(function(pe,$e){return xn(pe)?gs(pe,$e):[]}),Oh=zr(function(pe){return Ha($i(pe,xn))}),Nh=zr(function(pe){var $e=ri(pe);return xn($e)&&($e=_),Ha($i(pe,xn),Br($e,2))}),Mh=zr(function(pe){var $e=ri(pe);return $e=typeof $e=="function"?$e:_,Ha($i(pe,xn),_,$e)}),Lh=zr(oo);function Fh(pe,$e){return Dc(pe||[],$e||[],ps)}function Uh(pe,$e){return Dc(pe||[],$e||[],bs)}var Vh=zr(function(pe){var $e=pe.length,et=$e>1?pe[$e-1]:_;return et=typeof et=="function"?(pe.pop(),et):_,yl(pe,et)});function vl(pe){var $e=Lt(pe);return $e.__chain__=!0,$e}function qh(pe,$e){return $e(pe),pe}function ra(pe,$e){return $e(pe)}var jh=bi(function(pe){var $e=pe.length,et=$e?pe[0]:0,_t=this.__wrapped__,It=function(Ut){return Ia(Ut,pe)};return $e>1||this.__actions__.length||!(_t instanceof Xr)||!_i(et)?this.thru(It):(_t=_t.slice(et,+et+($e?1:0)),_t.__actions__.push({func:ra,args:[It],thisArg:_}),new Jn(_t,this.__chain__).thru(function(Ut){return $e&&!Ut.length&&Ut.push(_),Ut}))});function Hh(){return vl(this)}function Kh(){return new Jn(this.value(),this.__chain__)}function zh(){this.__values__===_&&(this.__values__=Pl(this.value()));var pe=this.__index__>=this.__values__.length,$e=pe?_:this.__values__[this.__index__++];return{done:pe,value:$e}}function Wh(){return this}function Gh(pe){for(var $e,et=this;et instanceof Vs;){var _t=fl(et);_t.__index__=0,_t.__values__=_,$e?It.__wrapped__=_t:$e=_t;var It=_t;et=et.__wrapped__}return It.__wrapped__=pe,$e}function Xh(){var pe=this.__wrapped__;if(pe instanceof Xr){var $e=pe;return this.__actions__.length&&($e=new Xr(this)),$e=$e.reverse(),$e.__actions__.push({func:ra,args:[ao],thisArg:_}),new Jn($e,this.__chain__)}return this.thru(ao)}function Yh(){return Bc(this.__wrapped__,this.__actions__)}var Zh=Gs(function(pe,$e,et){hn.call(pe,et)?++pe[et]:yi(pe,et,1)});function Qh(pe,$e,et){var _t=qr(pe)?Ko:Ff;return et&&Mn(pe,$e,et)&&($e=_),_t(pe,Br($e,3))}function Jh(pe,$e){var et=qr(pe)?$i:gc;return et(pe,Br($e,3))}var e0=Hc(dl),r0=Hc(hl);function n0(pe,$e){return Pn(na(pe,$e),1)}function i0(pe,$e){return Pn(na(pe,$e),Be)}function s0(pe,$e,et){return et=et===_?1:jr(et),Pn(na(pe,$e),et)}function bl(pe,$e){var et=qr(pe)?Zn:Ri;return et(pe,Br($e,3))}function _l(pe,$e){var et=qr(pe)?bu:mc;return et(pe,Br($e,3))}var a0=Gs(function(pe,$e,et){hn.call(pe,et)?pe[et].push($e):yi(pe,et,[$e])});function o0(pe,$e,et,_t){pe=Vn(pe)?pe:ss(pe),et=et&&!_t?jr(et):0;var It=pe.length;return et<0&&(et=An(It+et,0)),ca(pe)?et<=It&&pe.indexOf($e,et)>-1:!!It&&zi(pe,$e,et)>-1}var c0=zr(function(pe,$e,et){var _t=-1,It=typeof $e=="function",Ut=Vn(pe)?hr(pe.length):[];return Ri(pe,function(Xt){Ut[++_t]=It?Hn($e,Xt,et):ys(Xt,$e,et)}),Ut}),l0=Gs(function(pe,$e,et){yi(pe,et,$e)});function na(pe,$e){var et=qr(pe)?_n:Ec;return et(pe,Br($e,3))}function u0(pe,$e,et,_t){return pe==null?[]:(qr($e)||($e=$e==null?[]:[$e]),et=_t?_:et,qr(et)||(et=et==null?[]:[et]),Tc(pe,$e,et))}var f0=Gs(function(pe,$e,et){pe[et?0:1].push($e)},function(){return[[],[]]});function d0(pe,$e,et){var _t=qr(pe)?ya:Xo,It=arguments.length<3;return _t(pe,Br($e,4),et,It,Ri)}function h0(pe,$e,et){var _t=qr(pe)?_u:Xo,It=arguments.length<3;return _t(pe,Br($e,4),et,It,mc)}function p0(pe,$e){var et=qr(pe)?$i:gc;return et(pe,aa(Br($e,3)))}function m0(pe){var $e=qr(pe)?fc:nd;return $e(pe)}function g0(pe,$e,et){(et?Mn(pe,$e,et):$e===_)?$e=1:$e=jr($e);var _t=qr(pe)?Df:sd;return _t(pe,$e)}function y0(pe){var $e=qr(pe)?Of:od;return $e(pe)}function v0(pe){if(pe==null)return 0;if(Vn(pe))return ca(pe)?Gi(pe):pe.length;var $e=Dn(pe);return $e==Ye||$e==qt?pe.size:Ma(pe).length}function b0(pe,$e,et){var _t=qr(pe)?va:cd;return et&&Mn(pe,$e,et)&&($e=_),_t(pe,Br($e,3))}var _0=zr(function(pe,$e){if(pe==null)return[];var et=$e.length;return et>1&&Mn(pe,$e[0],$e[1])?$e=[]:et>2&&Mn($e[0],$e[1],$e[2])&&($e=[$e[0]]),Tc(pe,Pn($e,1),[])}),ia=Xu||function(){return In.Date.now()};function w0(pe,$e){if(typeof $e!="function")throw new Qn(A);return pe=jr(pe),function(){if(--pe<1)return $e.apply(this,arguments)}}function wl(pe,$e,et){return $e=et?_:$e,$e=pe&&$e==null?pe.length:$e,vi(pe,Re,_,_,_,_,$e)}function El(pe,$e){var et;if(typeof $e!="function")throw new Qn(A);return pe=jr(pe),function(){return--pe>0&&(et=$e.apply(this,arguments)),pe<=1&&($e=_),et}}var co=zr(function(pe,$e,et){var _t=Q;if(et.length){var It=Ci(et,rs(co));_t|=Te}return vi(pe,_t,$e,et,It)}),Sl=zr(function(pe,$e,et){var _t=Q|se;if(et.length){var It=Ci(et,rs(Sl));_t|=Te}return vi($e,_t,pe,et,It)});function xl(pe,$e,et){$e=et?_:$e;var _t=vi(pe,ue,_,_,_,_,_,$e);return _t.placeholder=xl.placeholder,_t}function $l(pe,$e,et){$e=et?_:$e;var _t=vi(pe,we,_,_,_,_,_,$e);return _t.placeholder=$l.placeholder,_t}function Tl(pe,$e,et){var _t,It,Ut,Xt,er,cr,vr=0,br=!1,wr=!1,Tr=!0;if(typeof pe!="function")throw new Qn(A);$e=ni($e)||0,En(et)&&(br=!!et.leading,wr="maxWait"in et,Ut=wr?An(ni(et.maxWait)||0,$e):Ut,Tr="trailing"in et?!!et.trailing:Tr);function Ir($n){var oi=_t,Si=It;return _t=It=_,vr=$n,Xt=pe.apply(Si,oi),Xt}function Nr($n){return vr=$n,er=Es(Gr,$e),br?Ir($n):Xt}function Kr($n){var oi=$n-cr,Si=$n-vr,zl=$e-oi;return wr?Bn(zl,Ut-Si):zl}function Mr($n){var oi=$n-cr,Si=$n-vr;return cr===_||oi>=$e||oi<0||wr&&Si>=Ut}function Gr(){var $n=ia();if(Mr($n))return Zr($n);er=Es(Gr,Kr($n))}function Zr($n){return er=_,Tr&&_t?Ir($n):(_t=It=_,Xt)}function Gn(){er!==_&&Oc(er),vr=0,_t=cr=It=er=_}function Ln(){return er===_?Xt:Zr(ia())}function Xn(){var $n=ia(),oi=Mr($n);if(_t=arguments,It=this,cr=$n,oi){if(er===_)return Nr(cr);if(wr)return Oc(er),er=Es(Gr,$e),Ir(cr)}return er===_&&(er=Es(Gr,$e)),Xt}return Xn.cancel=Gn,Xn.flush=Ln,Xn}var E0=zr(function(pe,$e){return pc(pe,1,$e)}),S0=zr(function(pe,$e,et){return pc(pe,ni($e)||0,et)});function x0(pe){return vi(pe,Fe)}function sa(pe,$e){if(typeof pe!="function"||$e!=null&&typeof $e!="function")throw new Qn(A);var et=function(){var _t=arguments,It=$e?$e.apply(this,_t):_t[0],Ut=et.cache;if(Ut.has(It))return Ut.get(It);var Xt=pe.apply(this,_t);return et.cache=Ut.set(It,Xt)||Ut,Xt};return et.cache=new(sa.Cache||gi),et}sa.Cache=gi;function aa(pe){if(typeof pe!="function")throw new Qn(A);return function(){var $e=arguments;switch($e.length){case 0:return!pe.call(this);case 1:return!pe.call(this,$e[0]);case 2:return!pe.call(this,$e[0],$e[1]);case 3:return!pe.call(this,$e[0],$e[1],$e[2])}return!pe.apply(this,$e)}}function $0(pe){return El(2,pe)}var T0=ld(function(pe,$e){$e=$e.length==1&&qr($e[0])?_n($e[0],Kn(Br())):_n(Pn($e,1),Kn(Br()));var et=$e.length;return zr(function(_t){for(var It=-1,Ut=Bn(_t.length,et);++It<Ut;)_t[It]=$e[It].call(this,_t[It]);return Hn(pe,this,_t)})}),lo=zr(function(pe,$e){var et=Ci($e,rs(lo));return vi(pe,Te,_,$e,et)}),Cl=zr(function(pe,$e){var et=Ci($e,rs(Cl));return vi(pe,xe,_,$e,et)}),C0=bi(function(pe,$e){return vi(pe,Ne,_,_,_,$e)});function A0(pe,$e){if(typeof pe!="function")throw new Qn(A);return $e=$e===_?$e:jr($e),zr(pe,$e)}function R0(pe,$e){if(typeof pe!="function")throw new Qn(A);return $e=$e==null?0:An(jr($e),0),zr(function(et){var _t=et[$e],It=Pi(et,0,$e);return _t&&Ti(It,_t),Hn(pe,this,It)})}function k0(pe,$e,et){var _t=!0,It=!0;if(typeof pe!="function")throw new Qn(A);return En(et)&&(_t="leading"in et?!!et.leading:_t,It="trailing"in et?!!et.trailing:It),Tl(pe,$e,{leading:_t,maxWait:$e,trailing:It})}function I0(pe){return wl(pe,1)}function P0(pe,$e){return lo(za($e),pe)}function B0(){if(!arguments.length)return[];var pe=arguments[0];return qr(pe)?pe:[pe]}function D0(pe){return ei(pe,z)}function O0(pe,$e){return $e=typeof $e=="function"?$e:_,ei(pe,z,$e)}function N0(pe){return ei(pe,U|z)}function M0(pe,$e){return $e=typeof $e=="function"?$e:_,ei(pe,U|z,$e)}function L0(pe,$e){return $e==null||hc(pe,$e,kn($e))}function ai(pe,$e){return pe===$e||pe!==pe&&$e!==$e}var F0=Qs(Da),U0=Qs(function(pe,$e){return pe>=$e}),Hi=bc(function(){return arguments}())?bc:function(pe){return Sn(pe)&&hn.call(pe,"callee")&&!sc.call(pe,"callee")},qr=hr.isArray,V0=Fo?Kn(Fo):Kf;function Vn(pe){return pe!=null&&oa(pe.length)&&!wi(pe)}function xn(pe){return Sn(pe)&&Vn(pe)}function q0(pe){return pe===!0||pe===!1||Sn(pe)&&Nn(pe)==dt}var Bi=Zu||xo,j0=Uo?Kn(Uo):zf;function H0(pe){return Sn(pe)&&pe.nodeType===1&&!Ss(pe)}function K0(pe){if(pe==null)return!0;if(Vn(pe)&&(qr(pe)||typeof pe=="string"||typeof pe.splice=="function"||Bi(pe)||ns(pe)||Hi(pe)))return!pe.length;var $e=Dn(pe);if($e==Ye||$e==qt)return!pe.size;if(ws(pe))return!Ma(pe).length;for(var et in pe)if(hn.call(pe,et))return!1;return!0}function z0(pe,$e){return vs(pe,$e)}function W0(pe,$e,et){et=typeof et=="function"?et:_;var _t=et?et(pe,$e):_;return _t===_?vs(pe,$e,_,et):!!_t}function fo(pe){if(!Sn(pe))return!1;var $e=Nn(pe);return $e==bt||$e==At||typeof pe.message=="string"&&typeof pe.name=="string"&&!Ss(pe)}function G0(pe){return typeof pe=="number"&&oc(pe)}function wi(pe){if(!En(pe))return!1;var $e=Nn(pe);return $e==ft||$e==Et||$e==Qe||$e==kt}function Al(pe){return typeof pe=="number"&&pe==jr(pe)}function oa(pe){return typeof pe=="number"&&pe>-1&&pe%1==0&&pe<=Ge}function En(pe){var $e=typeof pe;return pe!=null&&($e=="object"||$e=="function")}function Sn(pe){return pe!=null&&typeof pe=="object"}var Rl=Vo?Kn(Vo):Gf;function X0(pe,$e){return pe===$e||Na(pe,$e,Ja($e))}function Y0(pe,$e,et){return et=typeof et=="function"?et:_,Na(pe,$e,Ja($e),et)}function Z0(pe){return kl(pe)&&pe!=+pe}function Q0(pe){if(Bd(pe))throw new Vr(C);return _c(pe)}function J0(pe){return pe===null}function e1(pe){return pe==null}function kl(pe){return typeof pe=="number"||Sn(pe)&&Nn(pe)==Ct}function Ss(pe){if(!Sn(pe)||Nn(pe)!=St)return!1;var $e=Ds(pe);if($e===null)return!0;var et=hn.call($e,"constructor")&&$e.constructor;return typeof et=="function"&&et instanceof et&&ks.call(et)==Ku}var ho=qo?Kn(qo):Xf;function r1(pe){return Al(pe)&&pe>=-Ge&&pe<=Ge}var Il=jo?Kn(jo):Yf;function ca(pe){return typeof pe=="string"||!qr(pe)&&Sn(pe)&&Nn(pe)==Mt}function Wn(pe){return typeof pe=="symbol"||Sn(pe)&&Nn(pe)==Wt}var ns=Ho?Kn(Ho):Zf;function n1(pe){return pe===_}function i1(pe){return Sn(pe)&&Dn(pe)==Yt}function s1(pe){return Sn(pe)&&Nn(pe)==ur}var a1=Qs(La),o1=Qs(function(pe,$e){return pe<=$e});function Pl(pe){if(!pe)return[];if(Vn(pe))return ca(pe)?ii(pe):Un(pe);if(cs&&pe[cs])return Bu(pe[cs]());var $e=Dn(pe),et=$e==Ye?$a:$e==qt?Cs:ss;return et(pe)}function Ei(pe){if(!pe)return pe===0?pe:0;if(pe=ni(pe),pe===Be||pe===-Be){var $e=pe<0?-1:1;return $e*je}return pe===pe?pe:0}function jr(pe){var $e=Ei(pe),et=$e%1;return $e===$e?et?$e-et:$e:0}function Dl(pe){return pe?Ui(jr(pe),0,Pe):0}function ni(pe){if(typeof pe=="number")return pe;if(Wn(pe))return Ve;if(En(pe)){var $e=typeof pe.valueOf=="function"?pe.valueOf():pe;pe=En($e)?$e+"":$e}if(typeof pe!="string")return pe===0?pe:+pe;pe=Yo(pe);var et=tr.test(pe);return et||sr.test(pe)?gu(pe.slice(2),et?2:8):lr.test(pe)?Ve:+pe}function Ol(pe){return ui(pe,qn(pe))}function c1(pe){return pe?Ui(jr(pe),-Ge,Ge):pe===0?pe:0}function un(pe){return pe==null?"":zn(pe)}var l1=es(function(pe,$e){if(ws($e)||Vn($e)){ui($e,kn($e),pe);return}for(var et in $e)hn.call($e,et)&&ps(pe,et,$e[et])}),Nl=es(function(pe,$e){ui($e,qn($e),pe)}),la=es(function(pe,$e,et,_t){ui($e,qn($e),pe,_t)}),u1=es(function(pe,$e,et,_t){ui($e,kn($e),pe,_t)}),f1=bi(Ia);function d1(pe,$e){var et=Ji(pe);return $e==null?et:dc(et,$e)}var h1=zr(function(pe,$e){pe=gn(pe);var et=-1,_t=$e.length,It=_t>2?$e[2]:_;for(It&&Mn($e[0],$e[1],It)&&(_t=1);++et<_t;)for(var Ut=$e[et],Xt=qn(Ut),er=-1,cr=Xt.length;++er<cr;){var vr=Xt[er],br=pe[vr];(br===_||ai(br,Yi[vr])&&!hn.call(pe,vr))&&(pe[vr]=Ut[vr])}return pe}),p1=zr(function(pe){return pe.push(_,Zc),Hn(Ml,_,pe)});function m1(pe,$e){return zo(pe,Br($e,3),li)}function g1(pe,$e){return zo(pe,Br($e,3),Ba)}function y1(pe,$e){return pe==null?pe:Pa(pe,Br($e,3),qn)}function v1(pe,$e){return pe==null?pe:yc(pe,Br($e,3),qn)}function b1(pe,$e){return pe&&li(pe,Br($e,3))}function w1(pe,$e){return pe&&Ba(pe,Br($e,3))}function E1(pe){return pe==null?[]:Hs(pe,kn(pe))}function S1(pe){return pe==null?[]:Hs(pe,qn(pe))}function po(pe,$e,et){var _t=pe==null?_:Vi(pe,$e);return _t===_?et:_t}function x1(pe,$e){return pe!=null&&el(pe,$e,Vf)}function mo(pe,$e){return pe!=null&&el(pe,$e,qf)}var $1=zc(function(pe,$e,et){$e!=null&&typeof $e.toString!="function"&&($e=Is.call($e)),pe[$e]=et},bo(jn)),T1=zc(function(pe,$e,et){$e!=null&&typeof $e.toString!="function"&&($e=Is.call($e)),hn.call(pe,$e)?pe[$e].push(et):pe[$e]=[et]},Br),C1=zr(ys);function kn(pe){return Vn(pe)?uc(pe):Ma(pe)}function qn(pe){return Vn(pe)?uc(pe,!0):Qf(pe)}function A1(pe,$e){var et={};return $e=Br($e,3),li(pe,function(_t,It,Ut){yi(et,$e(_t,It,Ut),_t)}),et}function R1(pe,$e){var et={};return $e=Br($e,3),li(pe,function(_t,It,Ut){yi(et,It,$e(_t,It,Ut))}),et}var k1=es(function(pe,$e,et){Ks(pe,$e,et)}),Ml=es(function(pe,$e,et,_t){Ks(pe,$e,et,_t)}),I1=bi(function(pe,$e){var et={};if(pe==null)return et;var _t=!1;$e=_n($e,function(Ut){return Ut=Ii(Ut,pe),_t||(_t=Ut.length>1),Ut}),ui(pe,Za(pe),et),_t&&(et=ei(et,U|j|z,wd));for(var It=$e.length;It--;)ja(et,$e[It]);return et});function P1(pe,$e){return Ll(pe,aa(Br($e)))}var B1=bi(function(pe,$e){return pe==null?{}:ed(pe,$e)});function Ll(pe,$e){if(pe==null)return{};var et=_n(Za(pe),function(_t){return[_t]});return $e=Br($e),Cc(pe,et,function(_t,It){return $e(_t,It[0])})}function D1(pe,$e,et){$e=Ii($e,pe);var _t=-1,It=$e.length;for(It||(It=1,pe=_);++_t<It;){var Ut=pe==null?_:pe[fi($e[_t])];Ut===_&&(_t=It,Ut=et),pe=wi(Ut)?Ut.call(pe):Ut}return pe}function O1(pe,$e,et){return pe==null?pe:bs(pe,$e,et)}function M1(pe,$e,et,_t){return _t=typeof _t=="function"?_t:_,pe==null?pe:bs(pe,$e,et,_t)}var Fl=Xc(kn),Ul=Xc(qn);function L1(pe,$e,et){var _t=qr(pe),It=_t||Bi(pe)||ns(pe);if($e=Br($e,4),et==null){var Ut=pe&&pe.constructor;It?et=_t?new Ut:[]:En(pe)?et=wi(Ut)?Ji(Ds(pe)):{}:et={}}return(It?Zn:li)(pe,function(Xt,er,cr){return $e(et,Xt,er,cr)}),et}function F1(pe,$e){return pe==null?!0:ja(pe,$e)}function U1(pe,$e,et){return pe==null?pe:Pc(pe,$e,za(et))}function V1(pe,$e,et,_t){return _t=typeof _t=="function"?_t:_,pe==null?pe:Pc(pe,$e,za(et),_t)}function ss(pe){return pe==null?[]:xa(pe,kn(pe))}function q1(pe){return pe==null?[]:xa(pe,qn(pe))}function j1(pe,$e,et){return et===_&&(et=$e,$e=_),et!==_&&(et=ni(et),et=et===et?et:0),$e!==_&&($e=ni($e),$e=$e===$e?$e:0),Ui(ni(pe),$e,et)}function H1(pe,$e,et){return $e=Ei($e),et===_?(et=$e,$e=0):et=Ei(et),pe=ni(pe),jf(pe,$e,et)}function K1(pe,$e,et){if(et&&typeof et!="boolean"&&Mn(pe,$e,et)&&($e=et=_),et===_&&(typeof $e=="boolean"?(et=$e,$e=_):typeof pe=="boolean"&&(et=pe,pe=_)),pe===_&&$e===_?(pe=0,$e=1):(pe=Ei(pe),$e===_?($e=pe,pe=0):$e=Ei($e)),pe>$e){var _t=pe;pe=$e,$e=_t}if(et||pe%1||$e%1){var It=cc();return Bn(pe+It*($e-pe+mu("1e-"+((It+"").length-1))),$e)}return Ua(pe,$e)}var z1=ts(function(pe,$e,et){return $e=$e.toLowerCase(),pe+(et?Vl($e):$e)});function Vl(pe){return go(un(pe).toLowerCase())}function ql(pe){return pe=un(pe),pe&&pe.replace(yr,Au).replace(su,"")}function W1(pe,$e,et){pe=un(pe),$e=zn($e);var _t=pe.length;et=et===_?_t:Ui(jr(et),0,_t);var It=et;return et-=$e.length,et>=0&&pe.slice(et,It)==$e}function G1(pe){return pe=un(pe),pe&&Qr.test(pe)?pe.replace(Pr,Ru):pe}function X1(pe){return pe=un(pe),pe&&nn.test(pe)?pe.replace(Or,"\\$&"):pe}var Y1=ts(function(pe,$e,et){return pe+(et?"-":"")+$e.toLowerCase()}),Z1=ts(function(pe,$e,et){return pe+(et?" ":"")+$e.toLowerCase()}),Q1=jc("toLowerCase");function J1(pe,$e,et){pe=un(pe),$e=jr($e);var _t=$e?Gi(pe):0;if(!$e||_t>=$e)return pe;var It=($e-_t)/2;return Zs(Ls(It),et)+pe+Zs(Ms(It),et)}function ep(pe,$e,et){pe=un(pe),$e=jr($e);var _t=$e?Gi(pe):0;return $e&&_t<$e?pe+Zs($e-_t,et):pe}function tp(pe,$e,et){pe=un(pe),$e=jr($e);var _t=$e?Gi(pe):0;return $e&&_t<$e?Zs($e-_t,et)+pe:pe}function rp(pe,$e,et){return et||$e==null?$e=0:$e&&($e=+$e),tf(un(pe).replace(rn,""),$e||0)}function np(pe,$e,et){return(et?Mn(pe,$e,et):$e===_)?$e=1:$e=jr($e),Va(un(pe),$e)}function ip(){var pe=arguments,$e=un(pe[0]);return pe.length<3?$e:$e.replace(pe[1],pe[2])}var sp=ts(function(pe,$e,et){return pe+(et?"_":"")+$e.toLowerCase()});function ap(pe,$e,et){return et&&typeof et!="number"&&Mn(pe,$e,et)&&($e=et=_),et=et===_?Pe:et>>>0,et?(pe=un(pe),pe&&(typeof $e=="string"||$e!=null&&!ho($e))&&($e=zn($e),!$e&&Wi(pe))?Pi(ii(pe),0,et):pe.split($e,et)):[]}var op=ts(function(pe,$e,et){return pe+(et?" ":"")+go($e)});function lp(pe,$e,et){return pe=un(pe),et=et==null?0:Ui(jr(et),0,pe.length),$e=zn($e),pe.slice(et,et+$e.length)==$e}function up(pe,$e,et){var _t=Lt.templateSettings;et&&Mn(pe,$e,et)&&($e=_),pe=un(pe),$e=la({},$e,_t,Yc);var It=la({},$e.imports,_t.imports,Yc),Ut=kn(It),Xt=xa(It,Ut),er,cr,vr=0,br=$e.interpolate||Er,wr="__p += '",Tr=Ta(($e.escape||Er).source+"|"+br.source+"|"+(br===cn?Vt:Er).source+"|"+($e.evaluate||Er).source+"|$","g"),Ir="//# sourceURL="+(hn.call($e,"sourceURL")?($e.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++uu+"]")+`
`;pe.replace(Tr,function(Mr,Gr,Zr,Gn,Ln,Xn){return Zr||(Zr=Gn),wr+=pe.slice(vr,Xn).replace(pr,ku),Gr&&(er=!0,wr+=`' +
__e(`+Gr+`) +
'`),Ln&&(cr=!0,wr+=`';
`+Ln+`;
__p += '`),Zr&&(wr+=`' +
((__t = (`+Zr+`)) == null ? '' : __t) +
'`),vr=Xn+Mr.length,Mr}),wr+=`';
`;var Nr=hn.call($e,"variable")&&$e.variable;if(!Nr)wr=`with (obj) {
`+wr+`
}
`;else if(Dt.test(Nr))throw new Vr(I);wr=(cr?wr.replace(Rr,""):wr).replace(Dr,"$1").replace(tn,"$1;"),wr="function("+(Nr||"obj")+`) {
`+(Nr?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(er?", __e = _.escape":"")+(cr?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+wr+`return __p
}`;var Kr=Hl(function(){return sn(Ut,Ir+"return "+wr).apply(_,Xt)});if(Kr.source=wr,fo(Kr))throw Kr;return Kr}function fp(pe){return un(pe).toLowerCase()}function dp(pe){return un(pe).toUpperCase()}function hp(pe,$e,et){if(pe=un(pe),pe&&(et||$e===_))return Yo(pe);if(!pe||!($e=zn($e)))return pe;var _t=ii(pe),It=ii($e),Ut=Zo(_t,It),Xt=Qo(_t,It)+1;return Pi(_t,Ut,Xt).join("")}function pp(pe,$e,et){if(pe=un(pe),pe&&(et||$e===_))return pe.slice(0,tc(pe)+1);if(!pe||!($e=zn($e)))return pe;var _t=ii(pe),It=Qo(_t,ii($e))+1;return Pi(_t,0,It).join("")}function mp(pe,$e,et){if(pe=un(pe),pe&&(et||$e===_))return pe.replace(rn,"");if(!pe||!($e=zn($e)))return pe;var _t=ii(pe),It=Zo(_t,ii($e));return Pi(_t,It).join("")}function gp(pe,$e){var et=ht,_t=nt;if(En($e)){var It="separator"in $e?$e.separator:It;et="length"in $e?jr($e.length):et,_t="omission"in $e?zn($e.omission):_t}pe=un(pe);var Ut=pe.length;if(Wi(pe)){var Xt=ii(pe);Ut=Xt.length}if(et>=Ut)return pe;var er=et-Gi(_t);if(er<1)return _t;var cr=Xt?Pi(Xt,0,er).join(""):pe.slice(0,er);if(It===_)return cr+_t;if(Xt&&(er+=cr.length-er),ho(It)){if(pe.slice(er).search(It)){var vr,br=cr;for(It.global||(It=Ta(It.source,un(Jt.exec(It))+"g")),It.lastIndex=0;vr=It.exec(br);)var wr=vr.index;cr=cr.slice(0,wr===_?er:wr)}}else if(pe.indexOf(zn(It),er)!=er){var Tr=cr.lastIndexOf(It);Tr>-1&&(cr=cr.slice(0,Tr))}return cr+_t}function yp(pe){return pe=un(pe),pe&&Wr.test(pe)?pe.replace(Jr,Mu):pe}var vp=ts(function(pe,$e,et){return pe+(et?" ":"")+$e.toUpperCase()}),go=jc("toUpperCase");function jl(pe,$e,et){return pe=un(pe),$e=et?_:$e,$e===_?Pu(pe)?Uu(pe):Su(pe):pe.match($e)||[]}var Hl=zr(function(pe,$e){try{return Hn(pe,_,$e)}catch(et){return fo(et)?et:new Vr(et)}}),bp=bi(function(pe,$e){return Zn($e,function(et){et=fi(et),yi(pe,et,co(pe[et],pe))}),pe});function _p(pe){var $e=pe==null?0:pe.length,et=Br();return pe=$e?_n(pe,function(_t){if(typeof _t[1]!="function")throw new Qn(A);return[et(_t[0]),_t[1]]}):[],zr(function(_t){for(var It=-1;++It<$e;){var Ut=pe[It];if(Hn(Ut[0],this,_t))return Hn(Ut[1],this,_t)}})}function wp(pe){return Lf(ei(pe,U))}function bo(pe){return function(){return pe}}function Ep(pe,$e){return pe==null||pe!==pe?$e:pe}var Sp=Kc(),xp=Kc(!0);function jn(pe){return pe}function _o(pe){return wc(typeof pe=="function"?pe:ei(pe,U))}function $p(pe){return Sc(ei(pe,U))}function Tp(pe,$e){return xc(pe,ei($e,U))}var Cp=zr(function(pe,$e){return function(et){return ys(et,pe,$e)}}),Ap=zr(function(pe,$e){return function(et){return ys(pe,et,$e)}});function wo(pe,$e,et){var _t=kn($e),It=Hs($e,_t);et==null&&!(En($e)&&(It.length||!_t.length))&&(et=$e,$e=pe,pe=this,It=Hs($e,kn($e)));var Ut=!(En(et)&&"chain"in et)||!!et.chain,Xt=wi(pe);return Zn(It,function(er){var cr=$e[er];pe[er]=cr,Xt&&(pe.prototype[er]=function(){var vr=this.__chain__;if(Ut||vr){var br=pe(this.__wrapped__),wr=br.__actions__=Un(this.__actions__);return wr.push({func:cr,args:arguments,thisArg:pe}),br.__chain__=vr,br}return cr.apply(pe,Ti([this.value()],arguments))})}),pe}function Rp(){return In._===this&&(In._=zu),this}function Eo(){}function kp(pe){return pe=jr(pe),zr(function($e){return $c($e,pe)})}var Ip=Ga(_n),Pp=Ga(Ko),Bp=Ga(va);function Kl(pe){return to(pe)?ba(fi(pe)):td(pe)}function Dp(pe){return function($e){return pe==null?_:Vi(pe,$e)}}var Np=Wc(),Mp=Wc(!0);function So(){return[]}function xo(){return!1}function Lp(){return{}}function Up(){return""}function Vp(){return!0}function qp(pe,$e){if(pe=jr(pe),pe<1||pe>Ge)return[];var et=Pe,_t=Bn(pe,Pe);$e=Br($e),pe-=Pe;for(var It=Sa(_t,$e);++et<pe;)$e(et);return It}function jp(pe){return qr(pe)?_n(pe,fi):Wn(pe)?[pe]:Un(ul(un(pe)))}function Hp(pe){var $e=++Hu;return un(pe)+$e}var Kp=Ys(function(pe,$e){return pe+$e},0),zp=Xa("ceil"),Wp=Ys(function(pe,$e){return pe/$e},1),Gp=Xa("floor");function Xp(pe){return pe&&pe.length?js(pe,jn,Da):_}function Yp(pe,$e){return pe&&pe.length?js(pe,Br($e,2),Da):_}function Zp(pe){return Go(pe,jn)}function Qp(pe,$e){return Go(pe,Br($e,2))}function Jp(pe){return pe&&pe.length?js(pe,jn,La):_}function em(pe,$e){return pe&&pe.length?js(pe,Br($e,2),La):_}var tm=Ys(function(pe,$e){return pe*$e},1),nm=Xa("round"),im=Ys(function(pe,$e){return pe-$e},0);function sm(pe){return pe&&pe.length?Ea(pe,jn):0}function am(pe,$e){return pe&&pe.length?Ea(pe,Br($e,2)):0}return Lt.after=w0,Lt.ary=wl,Lt.assign=l1,Lt.assignIn=Nl,Lt.assignInWith=la,Lt.assignWith=u1,Lt.at=f1,Lt.before=El,Lt.bind=co,Lt.bindAll=bp,Lt.bindKey=Sl,Lt.castArray=B0,Lt.chain=vl,Lt.chunk=Ud,Lt.compact=Vd,Lt.concat=qd,Lt.cond=_p,Lt.conforms=wp,Lt.constant=bo,Lt.countBy=Zh,Lt.create=d1,Lt.curry=xl,Lt.curryRight=$l,Lt.debounce=Tl,Lt.defaults=h1,Lt.defaultsDeep=p1,Lt.defer=E0,Lt.delay=S0,Lt.difference=jd,Lt.differenceBy=Hd,Lt.differenceWith=Kd,Lt.drop=zd,Lt.dropRight=Wd,Lt.dropRightWhile=Gd,Lt.dropWhile=Xd,Lt.fill=Yd,Lt.filter=Jh,Lt.flatMap=n0,Lt.flatMapDeep=i0,Lt.flatMapDepth=s0,Lt.flatten=pl,Lt.flattenDeep=Zd,Lt.flattenDepth=Qd,Lt.flip=x0,Lt.flow=Sp,Lt.flowRight=xp,Lt.fromPairs=Jd,Lt.functions=E1,Lt.functionsIn=S1,Lt.groupBy=a0,Lt.initial=th,Lt.intersection=rh,Lt.intersectionBy=nh,Lt.intersectionWith=ih,Lt.invert=$1,Lt.invertBy=T1,Lt.invokeMap=c0,Lt.iteratee=_o,Lt.keyBy=l0,Lt.keys=kn,Lt.keysIn=qn,Lt.map=na,Lt.mapKeys=A1,Lt.mapValues=R1,Lt.matches=$p,Lt.matchesProperty=Tp,Lt.memoize=sa,Lt.merge=k1,Lt.mergeWith=Ml,Lt.method=Cp,Lt.methodOf=Ap,Lt.mixin=wo,Lt.negate=aa,Lt.nthArg=kp,Lt.omit=I1,Lt.omitBy=P1,Lt.once=$0,Lt.orderBy=u0,Lt.over=Ip,Lt.overArgs=T0,Lt.overEvery=Pp,Lt.overSome=Bp,Lt.partial=lo,Lt.partialRight=Cl,Lt.partition=f0,Lt.pick=B1,Lt.pickBy=Ll,Lt.property=Kl,Lt.propertyOf=Dp,Lt.pull=ch,Lt.pullAll=gl,Lt.pullAllBy=lh,Lt.pullAllWith=uh,Lt.pullAt=fh,Lt.range=Np,Lt.rangeRight=Mp,Lt.rearg=C0,Lt.reject=p0,Lt.remove=hh,Lt.rest=A0,Lt.reverse=ao,Lt.sampleSize=g0,Lt.set=O1,Lt.setWith=M1,Lt.shuffle=y0,Lt.slice=ph,Lt.sortBy=_0,Lt.sortedUniq=wh,Lt.sortedUniqBy=Eh,Lt.split=ap,Lt.spread=R0,Lt.tail=Sh,Lt.take=xh,Lt.takeRight=$h,Lt.takeRightWhile=Th,Lt.takeWhile=Ch,Lt.tap=qh,Lt.throttle=k0,Lt.thru=ra,Lt.toArray=Pl,Lt.toPairs=Fl,Lt.toPairsIn=Ul,Lt.toPath=jp,Lt.toPlainObject=Ol,Lt.transform=L1,Lt.unary=I0,Lt.union=Ah,Lt.unionBy=Rh,Lt.unionWith=kh,Lt.uniq=Ih,Lt.uniqBy=Ph,Lt.uniqWith=Bh,Lt.unset=F1,Lt.unzip=oo,Lt.unzipWith=yl,Lt.update=U1,Lt.updateWith=V1,Lt.values=ss,Lt.valuesIn=q1,Lt.without=Dh,Lt.words=jl,Lt.wrap=P0,Lt.xor=Oh,Lt.xorBy=Nh,Lt.xorWith=Mh,Lt.zip=Lh,Lt.zipObject=Fh,Lt.zipObjectDeep=Uh,Lt.zipWith=Vh,Lt.entries=Fl,Lt.entriesIn=Ul,Lt.extend=Nl,Lt.extendWith=la,wo(Lt,Lt),Lt.add=Kp,Lt.attempt=Hl,Lt.camelCase=z1,Lt.capitalize=Vl,Lt.ceil=zp,Lt.clamp=j1,Lt.clone=D0,Lt.cloneDeep=N0,Lt.cloneDeepWith=M0,Lt.cloneWith=O0,Lt.conformsTo=L0,Lt.deburr=ql,Lt.defaultTo=Ep,Lt.divide=Wp,Lt.endsWith=W1,Lt.eq=ai,Lt.escape=G1,Lt.escapeRegExp=X1,Lt.every=Qh,Lt.find=e0,Lt.findIndex=dl,Lt.findKey=m1,Lt.findLast=r0,Lt.findLastIndex=hl,Lt.findLastKey=g1,Lt.floor=Gp,Lt.forEach=bl,Lt.forEachRight=_l,Lt.forIn=y1,Lt.forInRight=v1,Lt.forOwn=b1,Lt.forOwnRight=w1,Lt.get=po,Lt.gt=F0,Lt.gte=U0,Lt.has=x1,Lt.hasIn=mo,Lt.head=ml,Lt.identity=jn,Lt.includes=o0,Lt.indexOf=eh,Lt.inRange=H1,Lt.invoke=C1,Lt.isArguments=Hi,Lt.isArray=qr,Lt.isArrayBuffer=V0,Lt.isArrayLike=Vn,Lt.isArrayLikeObject=xn,Lt.isBoolean=q0,Lt.isBuffer=Bi,Lt.isDate=j0,Lt.isElement=H0,Lt.isEmpty=K0,Lt.isEqual=z0,Lt.isEqualWith=W0,Lt.isError=fo,Lt.isFinite=G0,Lt.isFunction=wi,Lt.isInteger=Al,Lt.isLength=oa,Lt.isMap=Rl,Lt.isMatch=X0,Lt.isMatchWith=Y0,Lt.isNaN=Z0,Lt.isNative=Q0,Lt.isNil=e1,Lt.isNull=J0,Lt.isNumber=kl,Lt.isObject=En,Lt.isObjectLike=Sn,Lt.isPlainObject=Ss,Lt.isRegExp=ho,Lt.isSafeInteger=r1,Lt.isSet=Il,Lt.isString=ca,Lt.isSymbol=Wn,Lt.isTypedArray=ns,Lt.isUndefined=n1,Lt.isWeakMap=i1,Lt.isWeakSet=s1,Lt.join=sh,Lt.kebabCase=Y1,Lt.last=ri,Lt.lastIndexOf=ah,Lt.lowerCase=Z1,Lt.lowerFirst=Q1,Lt.lt=a1,Lt.lte=o1,Lt.max=Xp,Lt.maxBy=Yp,Lt.mean=Zp,Lt.meanBy=Qp,Lt.min=Jp,Lt.minBy=em,Lt.stubArray=So,Lt.stubFalse=xo,Lt.stubObject=Lp,Lt.stubString=Up,Lt.stubTrue=Vp,Lt.multiply=tm,Lt.nth=oh,Lt.noConflict=Rp,Lt.noop=Eo,Lt.now=ia,Lt.pad=J1,Lt.padEnd=ep,Lt.padStart=tp,Lt.parseInt=rp,Lt.random=K1,Lt.reduce=d0,Lt.reduceRight=h0,Lt.repeat=np,Lt.replace=ip,Lt.result=D1,Lt.round=nm,Lt.runInContext=ar,Lt.sample=m0,Lt.size=v0,Lt.snakeCase=sp,Lt.some=b0,Lt.sortedIndex=mh,Lt.sortedIndexBy=gh,Lt.sortedIndexOf=yh,Lt.sortedLastIndex=vh,Lt.sortedLastIndexBy=bh,Lt.sortedLastIndexOf=_h,Lt.startCase=op,Lt.startsWith=lp,Lt.subtract=im,Lt.sum=sm,Lt.sumBy=am,Lt.template=up,Lt.times=qp,Lt.toFinite=Ei,Lt.toInteger=jr,Lt.toLength=Dl,Lt.toLower=fp,Lt.toNumber=ni,Lt.toSafeInteger=c1,Lt.toString=un,Lt.toUpper=dp,Lt.trim=hp,Lt.trimEnd=pp,Lt.trimStart=mp,Lt.truncate=gp,Lt.unescape=yp,Lt.uniqueId=Hp,Lt.upperCase=vp,Lt.upperFirst=go,Lt.each=bl,Lt.eachRight=_l,Lt.first=ml,wo(Lt,function(){var pe={};return li(Lt,function($e,et){hn.call(Lt.prototype,et)||(pe[et]=$e)}),pe}(),{chain:!1}),Lt.VERSION=E,Zn(["bind","bindKey","curry","curryRight","partial","partialRight"],function(pe){Lt[pe].placeholder=Lt}),Zn(["drop","take"],function(pe,$e){Xr.prototype[pe]=function(et){et=et===_?1:An(jr(et),0);var _t=this.__filtered__&&!$e?new Xr(this):this.clone();return _t.__filtered__?_t.__takeCount__=Bn(et,_t.__takeCount__):_t.__views__.push({size:Bn(et,Pe),type:pe+(_t.__dir__<0?"Right":"")}),_t},Xr.prototype[pe+"Right"]=function(et){return this.reverse()[pe](et).reverse()}}),Zn(["filter","map","takeWhile"],function(pe,$e){var et=$e+1,_t=et==_e||et==He;Xr.prototype[pe]=function(It){var Ut=this.clone();return Ut.__iteratees__.push({iteratee:Br(It,3),type:et}),Ut.__filtered__=Ut.__filtered__||_t,Ut}}),Zn(["head","last"],function(pe,$e){var et="take"+($e?"Right":"");Xr.prototype[pe]=function(){return this[et](1).value()[0]}}),Zn(["initial","tail"],function(pe,$e){var et="drop"+($e?"":"Right");Xr.prototype[pe]=function(){return this.__filtered__?new Xr(this):this[et](1)}}),Xr.prototype.compact=function(){return this.filter(jn)},Xr.prototype.find=function(pe){return this.filter(pe).head()},Xr.prototype.findLast=function(pe){return this.reverse().find(pe)},Xr.prototype.invokeMap=zr(function(pe,$e){return typeof pe=="function"?new Xr(this):this.map(function(et){return ys(et,pe,$e)})}),Xr.prototype.reject=function(pe){return this.filter(aa(Br(pe)))},Xr.prototype.slice=function(pe,$e){pe=jr(pe);var et=this;return et.__filtered__&&(pe>0||$e<0)?new Xr(et):(pe<0?et=et.takeRight(-pe):pe&&(et=et.drop(pe)),$e!==_&&($e=jr($e),et=$e<0?et.dropRight(-$e):et.take($e-pe)),et)},Xr.prototype.takeRightWhile=function(pe){return this.reverse().takeWhile(pe).reverse()},Xr.prototype.toArray=function(){return this.take(Pe)},li(Xr.prototype,function(pe,$e){var et=/^(?:filter|find|map|reject)|While$/.test($e),_t=/^(?:head|last)$/.test($e),It=Lt[_t?"take"+($e=="last"?"Right":""):$e],Ut=_t||/^find/.test($e);It&&(Lt.prototype[$e]=function(){var Xt=this.__wrapped__,er=_t?[1]:arguments,cr=Xt instanceof Xr,vr=er[0],br=cr||qr(Xt),wr=function(Gr){var Zr=It.apply(Lt,Ti([Gr],er));return _t&&Tr?Zr[0]:Zr};br&&et&&typeof vr=="function"&&vr.length!=1&&(cr=br=!1);var Tr=this.__chain__,Ir=!!this.__actions__.length,Nr=Ut&&!Tr,Kr=cr&&!Ir;if(!Ut&&br){Xt=Kr?Xt:new Xr(this);var Mr=pe.apply(Xt,er);return Mr.__actions__.push({func:ra,args:[wr],thisArg:_}),new Jn(Mr,Tr)}return Nr&&Kr?pe.apply(this,er):(Mr=this.thru(wr),Nr?_t?Mr.value()[0]:Mr.value():Mr)})}),Zn(["pop","push","shift","sort","splice","unshift"],function(pe){var $e=As[pe],et=/^(?:push|sort|unshift)$/.test(pe)?"tap":"thru",_t=/^(?:pop|shift)$/.test(pe);Lt.prototype[pe]=function(){var It=arguments;if(_t&&!this.__chain__){var Ut=this.value();return $e.apply(qr(Ut)?Ut:[],It)}return this[et](function(Xt){return $e.apply(qr(Xt)?Xt:[],It)})}}),li(Xr.prototype,function(pe,$e){var et=Lt[$e];if(et){var _t=et.name+"";hn.call(Qi,_t)||(Qi[_t]=[]),Qi[_t].push({name:$e,func:et})}}),Qi[Xs(_,se).name]=[{name:"wrapper",func:_}],Xr.prototype.clone=lf,Xr.prototype.reverse=uf,Xr.prototype.value=ff,Lt.prototype.at=jh,Lt.prototype.chain=Hh,Lt.prototype.commit=Kh,Lt.prototype.next=zh,Lt.prototype.plant=Gh,Lt.prototype.reverse=Xh,Lt.prototype.toJSON=Lt.prototype.valueOf=Lt.prototype.value=Yh,Lt.prototype.first=Lt.prototype.head,cs&&(Lt.prototype[cs]=Wh),Lt},Xi=Vu();Ni?((Ni.exports=Xi)._=Xi,pa._=Xi):In._=Xi}).call(commonjsGlobal)})(lodash,lodash.exports);var lodashExports=lodash.exports;const pkg=getDefaultExportFromCjs(lodashExports),__=n=>n?.value?n.value:n;var isMergeableObject=function(r){return isNonNullObject(r)&&!isSpecial(r)};function isNonNullObject(n){return!!n&&typeof n=="object"}function isSpecial(n){var r=Object.prototype.toString.call(n);return r==="[object RegExp]"||r==="[object Date]"||isReactElement(n)}var canUseSymbol=typeof Symbol=="function"&&Symbol.for,REACT_ELEMENT_TYPE=canUseSymbol?Symbol.for("react.element"):60103;function isReactElement(n){return n.$$typeof===REACT_ELEMENT_TYPE}function emptyTarget(n){return Array.isArray(n)?[]:{}}function cloneUnlessOtherwiseSpecified(n,r){return r.clone!==!1&&r.isMergeableObject(n)?deepmerge(emptyTarget(n),n,r):n}function defaultArrayMerge(n,r,_){return n.concat(r).map(function(E){return cloneUnlessOtherwiseSpecified(E,_)})}function getMergeFunction(n,r){if(!r.customMerge)return deepmerge;var _=r.customMerge(n);return typeof _=="function"?_:deepmerge}function getEnumerableOwnPropertySymbols(n){return Object.getOwnPropertySymbols?Object.getOwnPropertySymbols(n).filter(function(r){return Object.propertyIsEnumerable.call(n,r)}):[]}function getKeys(n){return Object.keys(n).concat(getEnumerableOwnPropertySymbols(n))}function propertyIsOnObject(n,r){try{return r in n}catch{return!1}}function propertyIsUnsafe(n,r){return propertyIsOnObject(n,r)&&!(Object.hasOwnProperty.call(n,r)&&Object.propertyIsEnumerable.call(n,r))}function mergeObject(n,r,_){var E={};return _.isMergeableObject(n)&&getKeys(n).forEach(function(S){E[S]=cloneUnlessOtherwiseSpecified(n[S],_)}),getKeys(r).forEach(function(S){propertyIsUnsafe(n,S)||(propertyIsOnObject(n,S)&&_.isMergeableObject(r[S])?E[S]=getMergeFunction(S,_)(n[S],r[S],_):E[S]=cloneUnlessOtherwiseSpecified(r[S],_))}),E}function deepmerge(n,r,_){_=_||{},_.arrayMerge=_.arrayMerge||defaultArrayMerge,_.isMergeableObject=_.isMergeableObject||isMergeableObject,_.cloneUnlessOtherwiseSpecified=cloneUnlessOtherwiseSpecified;var E=Array.isArray(r),S=Array.isArray(n),C=E===S;return C?E?_.arrayMerge(n,r,_):mergeObject(n,r,_):cloneUnlessOtherwiseSpecified(r,_)}deepmerge.all=function(r,_){if(!Array.isArray(r))throw new Error("first argument should be an array");return r.reduce(function(E,S){return deepmerge(E,S,_)},{})};var deepmerge_1=deepmerge,cjs$1=deepmerge_1;const merge$3=getDefaultExportFromCjs(cjs$1),___=" ",__="",__="/orbitdb/zdpuAqBsFnWsRo4DRZjyvDbuHXPck4PsD99GqUqnDaVMYYdRy",__="",__="/orbitdb/zdpuAtyjCoieAwksiuuvaYgVQfzFYSsB4isz5LuJqiiEnVdfS",={___,__,__,__,__},__=n=>(n=deepcopy(n),n.tableaux=n.tableaux.map(r=>({clef:r.clef,cols:r.cols.map(_=>({idColonne:_.idColonne,idVariable:_.idVariable,optionnelle:_.optionnelle}))})),n);class {;_;_;;;constructor({:r,_:_,_:E,:S,:C}){this.=r,this._=_,this._=E,S=._({:S,_:_,_:E,:C}),this.=__(S),this.=Object.assign({},,C)}static _({:r,_:_,_:E,:S}){const C=deepcopy(r),A=C.tableaux.find(B=>B.clef===_);if(!A)throw new Error("    .");return A.cols.find(B=>B.idColonne===(S?.__||__))||(A.cols.push({idVariable:S?.__||__,idColonne:S?.__||__}),C.tableaux=C.tableaux.map(B=>B.clef===_?A:B)),C.nues||(C.nues=[]),C.nues.includes(E)||C.nues.push(E),C}static async ({:r,:_,_:E,:S,:C}){if(!r.nues||!r.bds)throw new Error(" ");const A=await r.nues.crerNue({nueParent:S});_=this._({:_,_:E,_:A,:C});for(const O of _.tableaux){const N=await r.nues.ajouterTableauNue({idNue:A,clefTableau:O.clef});for(const U of O.cols)await r.nues.ajouterColonneTableauNue({idTableau:N,idVariable:U.idVariable,idColonne:U.idColonne}),U.index;_.motsClefs&&await r.nues.ajouterMotsClefsNue({idNue:A,idsMotsClefs:_.motsClefs})}const I={licence:_.licence,motsClefs:_.motsClefs,tableaux:_.tableaux.map(O=>O.clef===E?{clef:O.clef,cols:[...O.cols,{idColonne:C?.__||__,idVariable:C?.__||__}]}:O)},B=await r.bds.crerBdDeSchma({schma:I});return await r.nues.sauvegarderMtadonneNue({idNue:A,clef:___,valeur:B}),A}async __({:r}){return await suivreBdsDeFonctionListe({fListe:async _=>await this..nues.suivreNuesParents({idNue:this._,f:E=>_([this._,...E].reverse())}),f:async _=>await r(_),fBranche:async(_,E)=>await suivreBdDeFonction({fRacine:async({fSuivreRacine:S})=>await this.__({:S,:_}),f:ignorerNonDfinis(E),fSuivre:async({id:S,fSuivreBd:C})=>await this..bds.suivreDonnesDeTableauParClef({idBd:S,clefTableau:this._,f:C})})})}async _({:r,:_=!0}){return await this..nues.suivreDonnesTableauNue({idNue:this._,clefTableau:this._,hritage:_?["ascendance","descendance"]:["ascendance"],f:async E=>{await r(E.map(S=>({:S.idCompte,:S.lment.id,:S.lment.donnes})))},nRsultatsDsirs:1e3})}async __({:r}){return await this..bds.suivreDonnesDeTableauUnique({schmaBd:this.,idNueUnique:this._,clefTableau:this._,f:async _=>{const E=await this..obtIdCompte();await r(_.map(S=>({:E,:S.id,:S.donnes})))}})}async ({:r}){const _=S=>S[this..__]?S:{...S,[this..__]:Date.now()};return(await this..bds.ajouterlmentTableauUnique({schmaBd:this.,idNueUnique:this._,clefTableau:this._,vals:_(r)}))[0]}async _({:r}){return await this..bds.effacerlmentDeTableauUnique({schmaBd:this.,idNueUnique:this._,clefTableau:this._,idlment:r})}async _({:r,:_}){await this..bds.modifierlmentDeTableauUnique({schmaBd:this.,idNueUnique:this._,clefTableau:this._,vals:r,idlment:_})}async __({:r,:_}){const E=async S=>{const C=S[this..___];if(typeof C=="string")return await r(C)};return await this..nues.suivreMtadonnesNue({idNue:_||this._,f:E})}async __(){return await uneFois(async _=>await this.__({:_}))}async ({:r}){const _=await this.__(),E=Object.assign({},r.,{[this..__]:r.}),C=(await uneFois(async A=>await this.__({:A}))).find(A=>this.__(A.donnes,E));return C?(await this.__({:r,:C.id}),C.id):(await this..bds.ajouterlmentTableauParClef({idBd:_,clefTableau:this._,vals:E}))[0]}async __({:r}){const _=await this.__();await this..bds.effacerlmentDeTableauParClef({idBd:_,clefTableau:this._,idlment:r})}async __({:r,:_}){const E=await this.__();await this..bds.modifierlmentDeTableauParClef({idBd:E,clefTableau:this._,idlment:_,vals:{...r.,[this..__]:r.}})}__(r,_){return(this..tableaux.find(S=>S.clef===this._)?.cols.filter(S=>S.index).map(S=>S.idColonne)||[]).every(S=>r[S]===_[S])}async _({:r,:_=""}){const E={:[],:[]},S=async()=>{const I=[];for(const B of E.){const O=I.find(N=>this.__(N,B));if(O){const N=O[this..__],U=B[this..__];N&&U&&U>N&&(I.splice(I.indexOf(O),1),I.push(B))}else I.push(B)}for(const B of E.){const O=I.find(N=>this.__(N,B));O&&I.splice(I.indexOf(O),1),I.push(B)}return await r(I)},A=[await this.__({:async I=>{E.=I.map(B=>B.donnes),await S()}})];if(_===""){const I=await this._({:async B=>{E.=B.map(O=>({[this..__]:O.,...O.})),await S()}});A.push(I.fOublier)}else if(_===""){const I=await this.__({:async B=>{E.=B.map(O=>({[this..__]:O.,...O.})),await S()}});A.push(I)}return async()=>{await Promise.all(A.map(I=>I()))}}}const jaqblKikajtzkChabl="chab'l",jaqblKikajtzkTzibanem="tzib'anem",runukMolajKel="/orbitdb/zdpuB2ZNKMRPnn8kwwL9UDY6VNdXxqxTUiEanjJ4Z6HuxEgWU",retalTzibNuchabl="/orbitdb/zdpuAqGK5ndjkaYFM5wkyEk4S6FpDH5hvpEWLq79edP9MmMpY",runukRucheelRunukChabl="runukChabl",runukRucheelRajilankChabl="rajilankChabl",runukRucheelRubiChabl="rubiChabl",runukRucheelRutzibanemChabl="rutzibanemChabl",runukRucheelRunukGlChabl="gl",runukRucheelRunukI1Chabl="i1",runukRucheelRunukI2Chabl="i2",runukRucheelRunukI3Chabl="i3",runukRujalojRunukChabl="/orbitdb/zdpuAqAZSmXwDoEPn4r94LP7yYvaY6kvxofyU2gchbAzkTEjN",runukRujalojRajilankChabl="/orbitdb/zdpuAx2asNr8YFLvEy8nP5u16SshcbMAhyHkZQm3hqEX2CEP6",runukRujalojRubiChabl="/orbitdb/zdpuAxRf1zitq3gpB6BnMrSuwcMLeFEUuUUGZZyhCwhjNqUjM",runukRujalojRutzibanemChabl="/orbitdb/zdpuAp5wKQEHAh8L5VGJr4Jdzn5363rX6zZmeFawBS4vRBihV",runukRujalojRunukGlChabl="/orbitdb/zdpuApxEECg9CrBGKtGqkYMU4zU51q6M1UuRvzz1PhQ5XTQWt",runukRujalojRunukI1Chabl="/orbitdb/zdpuApSr92X1P9KQS5EzJVrWTqA8RZ4rjZnPJwH5DTNmw35CY",runukRujalojRunukI2Chabl="/orbitdb/zdpuAv9jLJJzgo5FafC3ZeG2nGggEWttcb8hMbfwwbRQKW1DS",runukRujalojRunukI3Chabl="/orbitdb/zdpuApqihbDFFCdHudZaM64ahUMDwkpb38fpjw5gqYkP4xGJC",runukRucheelRunukTzib="runukTzib",runukRucheelRajilankTzib="rajilankTzib",runukRucheelRubiTzib="rubiTzib",runukRucheelRucholanemTzib="rucholanemTzib",runukRucheelRutzibTzib="rutzibTzib",runukRujalojRunukTzib="/orbitdb/zdpuB1o5fEEZFicWiQTL7RE8xv7v7X2SS5A7tNUAXaHQ9c58P",runukRujalojRajilankTzib="/orbitdb/zdpuAt4noCPbhfzRAZncCMndUPSCiYS5KnHDCPg17RFqV8qou",runukRujalojRubiTzib="/orbitdb/zdpuApC8sYxrezNAdgNFcLDcrEZhzMi7pv5A7VMZrCCiv2rb6",runukRujalojRucholanemTzib="/orbitdb/zdpuB14vFuP6aHNaXxoeWZvq1NRyx6HCUReoT4sxSk3kAFdZe",runukRujalojRutzibTzib="/orbitdb/zdpuAnXpasEMduNSXHxaeyGdZGmyU4NEwA3SEydj7jCDCY3Kz",RubanikilRuxeelTzij={licence:"ODbl-1_0",motsClefs:[retalTzibNuchabl],tableaux:[{cols:[{idColonne:runukRucheelRunukChabl,idVariable:runukRujalojRunukChabl,index:!0},{idColonne:runukRucheelRajilankChabl,idVariable:runukRujalojRajilankChabl},{idColonne:runukRucheelRubiChabl,idVariable:runukRujalojRubiChabl},{idColonne:runukRucheelRutzibanemChabl,idVariable:runukRujalojRutzibanemChabl},{idColonne:runukRucheelRunukGlChabl,idVariable:runukRujalojRunukGlChabl},{idColonne:runukRucheelRunukI1Chabl,idVariable:runukRujalojRunukI1Chabl},{idColonne:runukRucheelRunukI2Chabl,idVariable:runukRujalojRunukI2Chabl},{idColonne:runukRucheelRunukI3Chabl,idVariable:runukRujalojRunukI3Chabl}],clef:jaqblKikajtzkChabl},{cols:[{idColonne:runukRucheelRunukTzib,idVariable:runukRujalojRunukTzib,index:!0},{idColonne:runukRucheelRajilankTzib,idVariable:runukRujalojRajilankTzib},{idColonne:runukRucheelRubiTzib,idVariable:runukRujalojRubiTzib},{idColonne:runukRucheelRucholanemTzib,idVariable:runukRujalojRucholanemTzib},{idColonne:runukRucheelRutzibTzib,idVariable:runukRujalojRutzibTzib}],clef:jaqblKikajtzkTzibanem}]},tachojmisajKel=({chumil:n})=>{const r=new ({:n,_:jaqblKikajtzkChabl,:RubanikilRuxeelTzij,_:runukMolajKel}),_=new ({:n,_:jaqblKikajtzkTzibanem,:RubanikilRuxeelTzij,_:runukMolajKel});return{kelChabl:r,kelTzibanem:_}},kaq={aj:"Mayab'","rb'":"Kaqchikel",tz:"ltn",rn:{gl:"kaqc1270",i3:"cak"}},fr={aj:"latin","rb'":"franais",tz:"ltn",rn:{gl:"stan1290",i1:"fr",i2:"fra",i3:"fra"}},cst={aj:"latin","rb'":"castellano",rn:{gl:"stan1288",i1:"es"}},nl={aj:"latin","rb'":"Nederlands",rn:{gl:"dutc1256",i1:"nl"}},en$1={aj:"latin","rb'":"English",rn:{gl:"stan1293",i1:"en",i3:"eng"}},kny={"rb'":"Kanyen'k:ha",ajilank:"latin",rn:{}},sw={aj:"latin","rb'":"Kiswahili",rn:{}},yo$1={aj:"latin","rb'":"Yorb",rn:{gl:"yoru1245",i1:"yo"}},rw={"rb'":"Kinyarwanda",rn:{gl:"kiny1244",i1:"rw"},aj:"latin"},de$1={"rb'":"Deutsch",rn:{i1:"de",gl:"mode1258"},aj:"latin"},_retamablChabl={kaq,fr,:{aj:"","rb'":"",tz:"",rn:{gl:"tami1289",i1:"ta",i2:"tam",i3:"tam"}},cst,nl,en:en$1,:{aj:"","rb'":"",tz:"",rn:{gl:"west2386",i3:"pnb"}},:{aj:"","rb'":"",tz:"",rn:{gl:"panj1256",i1:"pa"}},:{aj:"","rb'":"",rn:{gl:"",i1:"hi"}},:{aj:"","rb'":"",rn:{gl:"guja1252",i1:"gu"}},:{aj:"","rb'":"",rn:{gl:"beng1280",i1:"bn"}},:{"rb'":"",rn:{gl:"telu1262",i1:"te"},aj:""},:{"rb'":"",rn:{},aj:""},:{"rb'":"",tz:"",rn:{i1:"ar"}},:{aj:"","rb'":"",tz:"",rn:{gl:"urdu1245",i1:"ur"}},:{aj:"","rb'":"",tz:"",rn:{gl:"cent1989",i1:"km"}},:{aj:"","rb'":"",tz:"",rn:{gl:"west2369",i1:"fa"}},:{aj:"","rb'":"",rn:{gl:"mara1378",i1:"mr"}},:{aj:"","rb'":"",rn:{gl:"mala1464",i1:"ml"}},:{aj:"","rb'":"",rn:{gl:"nepa1254",i1:"ne"}},:{"rb'":"",aj:"",rn:{}},"k'i":{aj:"Mayab'","rb'":"K'iche'",rn:{gl:"kich1262",i3:"quc"}},"tz'u":{aj:"Mayab'","rb'":"Tz'utujil",rn:{gl:"tzut1248",i3:"tzj"}},kny,:{aj:"","rb'":"",tz:"",rn:{gl:"sini1245",i1:"zh"}},:{aj:"","rb'":"",tz:"",rn:{gl:"taib1240",i3:"goyu"}},:{aj:"","rb'":"",rn:{gl:"nucl1643",i1:"ja"}},sw,yo:yo$1,rw,de:de$1},ltn={"rb'":"latin",ch:"",aj:"latin",tz:"[A-Za-z-----------------------]|\uD801[\uDF80-\uDF85\uDF87-\uDFB0\uDFB2-\uDFBA]|\uD837[\uDF00-\uDF1E\uDF25-\uDF2A]"},_retamablTzibanem={ltn,:{"rb'":"",ch:"",aj:"",tz:"[---------]|\uD807[\uDFC0-\uDFF1\uDFFF]"},:{"rb'":"",ch:"",aj:"",tz:"[--------------------]|\uD803[\uDE60-\uDE7E\uDEFD-\uDEFF]|\uD83B[\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB\uDEF0\uDEF1]"},:{"rb'":"",ch:"",aj:"",tz:"[--------------------]|\uD803[\uDE60-\uDE7E\uDEFD-\uDEFF]|\uD83B[\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB\uDEF0\uDEF1]"},:{"rb'":"",ch:"",aj:"",tz:"[--------][--------]"},:{"rb'":"",ch:"",aj:"",tz:"[------------]"},:{"rb'":"",ch:"",aj:"",tz:"[-----------]"},:{"rb'":"",ch:"",aj:"",tz:"[---------]"},:{"rb'":"",ch:"",aj:"",tz:"[----]"},:{"rb'":"",ch:"",aj:"",tz:"[----]|\uD806[\uDF00-\uDF09]"},:{"rb'":"",ch:"",aj:"",tz:"[---------]|\uD81B[\uDFE2\uDFE3\uDFF0\uDFF1]|[\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872\uD874-\uD879\uD880-\uD883\uD885-\uD887][\uDC00-\uDFFF]|\uD869[\uDC00-\uDEDF\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF39\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0]|\uD87E[\uDC00-\uDE1D]|\uD884[\uDC00-\uDF4A\uDF50-\uDFFF]|\uD888[\uDC00-\uDFAF]"},:{"rb'":"",ch:"",aj:"",tz:"[---------]|\uD81B[\uDFE2\uDFE3\uDFF0\uDFF1]|[\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872\uD874-\uD879\uD880-\uD883\uD885-\uD887][\uDC00-\uDFFF]|\uD869[\uDC00-\uDEDF\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF39\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0]|\uD87E[\uDC00-\uDE1D]|\uD884[\uDC00-\uDF4A\uDF50-\uDFFF]|\uD888[\uDC00-\uDFAF]"},:{"rb'":"",ch:"",aj:"",tz:"[--]|\uD82C[\uDC01-\uDD1F\uDD32\uDD50-\uDD52]||[-------]|\uD82B[\uDFF0-\uDFF3\uDFF5-\uDFFB\uDFFD\uDFFE]|\uD82C[\uDC00\uDD20-\uDD22\uDD55\uDD64-\uDD67]|[--]"}};class Nuchabl{retamablChablChumil;retamablTzibanemChumil;vnements;chumil;tamestajKel;constructor({chumil:r}){this.chumil=r,this.retamablChablChumil={},this.retamablTzibanemChumil={},this.vnements=new eventsExports.EventEmitter,this._tachojmisajKel()}async _tachojmisajKel(){if(this.chumil){const{kelChabl:r,kelTzibanem:_}=tachojmisajKel({chumil:this.chumil}),E=await r.__({:C=>{this.retamablChablChumil=tajalPaRubanikilRetamabalChabl(C),this.xujalRi()}}),S=await _.__({:C=>{this.retamablTzibanemChumil=tajalPaRubanikilRetamabalTzibanem(C),this.xujalRi()}});this.tamestajKel=async()=>{await Promise.all([E(),S()])}}}xujalRi(){this.vnements.emit("xujalRi'")}get retamablChabl(){return merge$3(_retamablChabl,this.retamablChablChumil)}get retamablTzibanem(){return merge$3(_retamablTzibanem,this.retamablTzibanemChumil)}get konojelChabl(){return Object.keys(this.retamablChabl)}get konojelTzibanem(){return Object.keys(this.retamablTzibanem)}runukChabl({chabl:r,runukulem:_}){const E=Object.keys(this.retamablChabl).find(C=>this.retamablChabl[C]["rb'"]===r);if(!_||!E)return E;_=_.toLowerCase();const S=this.retamablChabl[E].rn;return _==="iso"?[S.i1,S.i2,S.i3].find(C=>C):S[rkxnkNklm[_]||_]}rubiChabl({runuk:r,runukulem:_}){const E=_?.toLowerCase();let S;return E===void 0?S=this.retamablChabl[r]:E==="iso"?S=Object.values(this.retamablChabl).find(C=>[C.rn.i1,C.rn.i2,C.rn.i3].some(A=>A===r)):Object.keys(rkxnkNklm).includes(E)&&(S=Object.values(this.retamablChabl).find(C=>C.rn[rkxnkNklm[E]]===r)),S?S["rb'"]:void 0}rutzibanemChabl({runuk:r}){const E=this.retamablChabl[r]?.tz;if(E)return E;for(const S in this.konojelTzibanem){const C=this.rutzibTzibanem({runuk:S});if(C&&r.match(new RegExp(C,"g")))return S}}rajilankChabl({runuk:r}){const _=this.retamablChabl[r];if(_)return _.aj;const E=this.rutzibanemChabl({runuk:r});return E?this.rajilankTzibanem({runuk:E}):void 0}rubiTzibanem({runuk:r}){const _=this.retamablTzibanem[r];return _?_["rb'"]:void 0}runukTzibanem({tzibanem:r}){return Object.keys(this.retamablTzibanem).find(_=>this.retamablChabl[_]["rb'"]===r)}rucholanemTzibanem({runuk:r}){return this.retamablTzibanem[r]?.ch}rutzibTzibanem({runuk:r}){return this.retamablTzibanem[r]?.tz}rajilankTzibanem({runuk:r}){return this.retamablTzibanem[r]?.aj}tatzeqelbej(r){return this.vnements.on("xujalRi'",r),r(),()=>{this.vnements.off("xujalRi'",r)}}tatzeqelbejRetamablChabl({sm:r}){return this.tatzeqelbej(()=>r(this.retamablChabl))}tatzeqelbejRetamablTzibanem({sm:r}){return this.tatzeqelbej(()=>r(this.retamablTzibanem))}tatzeqelbejKonojelChabl({sm:r}){return this.tatzeqelbej(()=>r(this.konojelChabl))}tatzeqelbejKonojelTzibanem({sm:r}){return this.tatzeqelbej(()=>r(this.konojelTzibanem))}tatzeqelbejRunukChabl({sm:r,chabl:_,runukulem:E}){return this.tatzeqelbej(()=>r(this.runukChabl({chabl:_,runukulem:E})))}tatzeqelbejRubiChabl({sm:r,runuk:_,runukulem:E}){return this.tatzeqelbej(()=>r(this.rubiChabl({runuk:_,runukulem:E})))}tatzeqelbejRutzibanemChabl({sm:r,runuk:_}){return this.tatzeqelbej(()=>r(this.rutzibanemChabl({runuk:_})))}tatzeqelbejRajilankChabl({sm:r,runuk:_}){return this.tatzeqelbej(()=>r(this.rajilankChabl({runuk:_})))}tatzeqelbejRubiTzibanem({sm:r,runuk:_}){return this.tatzeqelbej(()=>r(this.rubiTzibanem({runuk:_})))}tatzeqelbejRunukTzibanem({sm:r,tzibanem:_}){return this.tatzeqelbej(()=>r(this.runukTzibanem({tzibanem:_})))}tatzeqelbejRucholanemTzibanem({sm:r,runuk:_}){return this.tatzeqelbej(()=>r(this.rucholanemTzibanem({runuk:_})))}tatzeqelbejRajilankTzibanem({sm:r,runuk:_}){return this.tatzeqelbej(()=>r(this.rajilankTzibanem({runuk:_})))}async tatzapij(){this.tamestajKel&&await this.tamestajKel()}}const rkxnkNklm={glottologue:"gl",iso1:"i1",iso2:"i2",iso3:"i3"},tajalPaRubanikilRetamabalChabl=n=>{const r={};for(const _ of n)r[_.donnes[runukRucheelRunukChabl]]={aj:_.donnes[runukRucheelRajilankChabl],"rb'":_.donnes[runukRucheelRubiChabl],tz:_.donnes[runukRucheelRutzibanemChabl],rn:{gl:_.donnes[runukRucheelRunukGlChabl],i1:_.donnes[runukRucheelRunukI1Chabl],i2:_.donnes[runukRucheelRunukI2Chabl],i3:_.donnes[runukRucheelRunukI3Chabl]}};return r},tajalPaRubanikilRetamabalTzibanem=n=>{const r={};for(const _ of n)r[_.donnes[runukRucheelRunukTzib]]={aj:_.donnes[runukRucheelRajilankTzib],"rb'":_.donnes[runukRucheelRubiTzib],ch:_.donnes[runukRucheelRucholanemTzib],tz:_.donnes[runukRucheelRutzibTzib]};return r};/*! js-cookie v3.0.5 | MIT */function assign$1(n){for(var r=1;r<arguments.length;r++){var _=arguments[r];for(var E in _)n[E]=_[E]}return n}var defaultConverter={read:function(n){return n[0]==='"'&&(n=n.slice(1,-1)),n.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent)},write:function(n){return encodeURIComponent(n).replace(/%(2[346BF]|3[AC-F]|40|5[BDE]|60|7[BCD])/g,decodeURIComponent)}};function init$2(n,r){function _(S,C,A){if(!(typeof document>"u")){A=assign$1({},r,A),typeof A.expires=="number"&&(A.expires=new Date(Date.now()+A.expires*864e5)),A.expires&&(A.expires=A.expires.toUTCString()),S=encodeURIComponent(S).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape);var I="";for(var B in A)A[B]&&(I+="; "+B,A[B]!==!0&&(I+="="+A[B].split(";")[0]));return document.cookie=S+"="+n.write(C,S)+I}}function E(S){if(!(typeof document>"u"||arguments.length&&!S)){for(var C=document.cookie?document.cookie.split("; "):[],A={},I=0;I<C.length;I++){var B=C[I].split("="),O=B.slice(1).join("=");try{var N=decodeURIComponent(B[0]);if(A[N]=n.read(O,N),S===N)break}catch{}}return S?A[S]:A}}return Object.create({set:_,get:E,remove:function(S,C){_(S,"",assign$1({},C,{expires:-1}))},withAttributes:function(S){return init$2(this.converter,assign$1({},this.attributes,S))},withConverter:function(S){return init$2(assign$1({},this.converter,S),this.attributes)}},{attributes:{value:Object.freeze(r)},converter:{value:Object.freeze(n)}})}var api$2=init$2(defaultConverter,{path:"/"});const __=".",__=".",_=()=>{const{_:n,_:r,:_}=inject$1("");return watchEffect(()=>{api$2.set(_?.||__,JSON.stringify(n.value))}),watchEffect(()=>{r.value?api$2.set(_?.||__,r.value):api$2.remove(_?.||__)}),{_:n,_:r}},_=({:n,:r=[],:_})=>({install:E=>{const S=api$2.get(_?.||__);let C;try{C=S?JSON.parse(S):void 0}catch{}const A=ref$2(Array.isArray(C)?C:[n,...r]),I=api$2.get(_?.||__),B=ref$2(I||void 0);E.provide("",{:_,_:A,_:B})}}),nuchabl_=()=>{const n=inject$1("nuch'ab'l");if(!n)throw new Error("Nuch'ab'l .");return n},_=()=>{const n=nuchabl_(),{_:r}=_(),_=computed(()=>r.value[0]),E=computed(()=>r.value.slice(1));return{:_,:E,_:I=>{Array.isArray(I)?I.length&&(r.value=I):r.value=[I,...r.value.filter(B=>B!==I)]},_:I=>computed(()=>{for(const O of r.value)if(I.value[O])return I.value[O];const B=n?.rutzibanemChabl({runuk:r.value[0]});for(const O of r.value)if(B&&B===n?.rutzibanemChabl({runuk:O}))return I.value[O];return Object.values(I.value)[0]}),__:I=>computed(()=>{const B=n?.rutzibanemChabl({runuk:__(I)||_.value});if(!B)return!1;const O=n?.rucholanemTzibanem({runuk:B});return O?O==="":!1})}},_=({:n,:r=[],:_})=>({install:E=>{const S=E.config.globalProperties.$constl;E.use(_({:n,:r,:_}));const C=new Nuchabl({chumil:S});E.provide("nuch'ab'l",C),E.config.globalProperties.$nuchabl=C}}),latin={:"",:"latn",:"0123456789",:"eE",:"."},_={latin,"Mayab'":{:"",:null,:""},"":{:"",:null,:""},:{:"",:null,:""},:{:"",:"deva",:"",:""},:{:"",:"guru",:"",:""},:{:"",:"gujr",:""}," ":{:"",:"mlym",:""},:{:"",:null,:"",:{"":10,"":100,"":1e3}},:{:"",:"taml",:"",:"",:{"":10,"":100,"":1e3}}," ":{:"",:"tamldec",:"",:""},:{:"",:"arabext",:"",:"",:"."},:{:"",:"arab",:"",:"",:"."},:{:"",:"orya",:""},:{:"",:"beng",:"",:""},:{:"",:"knda",:""},:{:"",:"telu",:""},"":{:"",:"brah",:""},"":{:"",:"cakm",:""},"":{:"",:"nkoo",:""},"":{:"",:"saur",:""}," ":{:"",:"olck",:""}," ":{:"",:"sinh",:""},:{:"",:null,:"",:{"":10,"":100,"":1e3}},"":{:"",:"bali",:""},"":{:"",:"cham",:""},"":{:"",:"java",:""},:{:"",:"thai",:"",:""},:{:"",:"laoo",:""},"":{:"",:"tibt",:""},"":{:"",:"mymrshan",:""},"":{:"",:"mymrtlng",:""},"":{:"",:"mymr",:""}," ":{:"",:"kali",:""},"":{:"",:"talu",:""},"":{:"",:"ahom",:""},"":{:"",:"bhks",:""},"":{:"",:"gong",:""},"":{:"",:"gonm",:""},"":{:"",:"rohg",:""},"  ":{:"",:"hmng",:""},"":{:"",:"hmng",:""},:{:"",:"khmr",:""}," - lek nai tam":{:"",:"lana",:""}," - lek hora":{:"",:"lanatham",:""},"":{:"",:"lepc",:""}," ":{:"",:"limb",:""}," ":{:"",:"mong",:""},"":{:"",:"mtei",:""},"":{:"",:"sund",:""},"":{:"",:"sind",:""},"":{:"",:"modi",:""},"":{:"",:"mroo",:""}," ":{:"",:"newa",:""},"":{:"",:"vaii",:""},"":{:"",:"osma",:""},"":{:"",:"shrd",:""},:{:"",:"ethi",:"0",:{"":10,"":20,"":30,"":40,"":50,"":60,"":70,"":80,"":90,"":100,"":1e4}}," ":{:"",:"sora",:""},"":{:"",:"takr",:""},"":{:"",:"tirh",:""}," ":{:"",:"wara",:""},"":{:"",:null,:""},"":{:"",:"wcho",:""},"":{:"",:"adlm",:""},:{:"",:"hans",:"",:"",:".",:{:10,:100,:1e3,:1e4,:1e8,:1e12,:1e16,:1e20,:1e24,:1e28,:1e32,:1e36,:1e40,:1e44}},:{:"",:"hanidec",:"",:"",:"."},:{:"",:null,:""}},_="",__="/orbitdb/zdpuB2ZNKMRPnn8kwwL9UDY6VNdXxqxTUiEanjJ4Z6HuxEgWU",__="/orbitdb/zdpuAwiHHcXVqXtC5d2zTBC3kP8LkpMxHyp1BjjxVCboH6nPb",___="",___="",____="",___="",___="",___="",___="",___="/orbitdb/zdpuAx2asNr8YFLvEy8nP5u16SshcbMAhyHkZQm3hqEX2CEP6",___="/orbitdb/zdpuAmMYvS8f9WH95y3tyxDPgLsWjXu2zoB2bAy78JNsMkCWn",____="/orbitdb/zdpuApW3gaGcGNtppzQQyzuzygfKiQ1WVtVpjQa21ALjqRUNo",___="/orbitdb/zdpuAzeaU4DA5WCaKBr1B23UA9gtvMoRiUtPgA1PsuRJvtA6k",___="/orbitdb/zdpuB2xXUJ3kcsmzqhqbvUDNRrRH63dLoj6jw238Xu85oSVJp",___="/orbitdb/zdpuAq1CqRxiFvcy7sUuB9wLPJ5Ex9Vrp6uFiyP7YB8G3T74s",___="/orbitdb/zdpuAwi62CTtS6Tpu8Zf2pBFKEUGo3F27QZXCib4CVGXyBPVa",_={licence:"ODbl-1_0",motsClefs:[__],tableaux:[{cols:[{idColonne:___,idVariable:___,index:!0},{idColonne:___,idVariable:___},{idColonne:____,idVariable:____},{idColonne:___,idVariable:___},{idColonne:___,idVariable:___},{idColonne:___,idVariable:___},{idColonne:___,idVariable:___}],clef:_}]},_=({:n})=>new ({:n,_,:_,_:__});class {_;;;_;constructor({:r}){this.=r,this._={},this.=new eventsExports.EventEmitter,this.__()}async __(){if(this.){const r=_({:this.});this._=await r.__({:_=>{this._=___(_),this._()}})}}_(){this..emit("")}get (){return merge$3(_,this._)}get (){return Object.keys(this.)}_({:r}){const _=this.[r];if(!_)throw Error(`   ${r}`);return _}_({:r,_:_}){const{:E,:S}=_,C=_.||".",A=[...E],I=r<0;r=Math.abs(r);const B=r.toString().split(".")[1];let O=this.__(r,A,S);return O.length===0&&(O=A[0]),I&&(O="-"+O),B&&(O+=C[0]+[...B].map(N=>E[parseInt(N)]).join("")),O}_({:r,_:_}){const E=_.,S=[..._.],C=_.||".",A=r[0]==="-";A?r=r.slice(1):r=r.replace(/^\++/,"");const[I,B]=r.split(C[0]);let O=0;if(I){const N=[...I].map(j=>E[j]||S.indexOf(j)).reverse(),U=j=>{const z=j[0],Z=j.slice(1).find(we=>we>z),X=(Z?j.slice(1).indexOf(Z):j.slice(1).length)+1,Q=j.slice(1,X),se=Q.length?U(Q):1,oe=j.slice(X),ue=oe.length?U(oe):0;return z*se+ue};O=U(N)}return B!==void 0&&B.length&&(O+=parseFloat("."+[...B].map(N=>S.indexOf(N).toString()).join(""))),A&&(O*=-1),O}_({:r,_:_}){const E=[..._.],S=E.length,C=(_.||".")[0];if(S===10){let N=r.toString();return N.includes(".")&&(N=N.replace(".",C)),Array.prototype.map.call(N,U=>U===C?U:E[parseInt(U)]).join("")}if(r===0)return E[0];const A=r<0;let I=r%1;I=parseFloat(I.toFixed(_(r))),r=Math.abs(r);let B="";for(;r;)B=E[Math.floor(r%S)]+B,r=Math.floor(r/S);I&&(B+=C);let O;for(;I!==0;)O=_(I),I*=S,B+=E[Math.floor(I)],I-=Math.floor(I),I=parseFloat(I.toFixed(O));return A&&(B="-"+B),B}_({:r,:_,_:E}){const S=[...E.],C=E.||"eE",A=S.length,I=E.||".";if(r=r.replace(/^\++/,""),C.split("").some(B=>r.includes(B))){const[B,O]=r.split(RegExp(C));return this._({:B,:_,_:E})*A**this.({:O,:_})}if(A===10){for(const[B,O]of S.entries())r=r.replace(O,B.toString());for(const B of I.split(""))r=r.replace(B,".");return parseFloat(r)}else{let B=0;const O=r.split(/\./);let N=O[0];const U=O[1],j=N[0]==="-";if(N=N.replace(/^-+/,""),N)for(const z of N)B*=A,B+=S.indexOf(z);if(U){let z=A;for(const Z of U)B+=S.indexOf(Z)/z,B=parseFloat(B.toFixed(_(1/z))),z*=A}return B=j?-B:B,B}}({:r,:_}){const E=this._({:_});return E.===""?this._({:r,_:E}):this._({:r,_:E})}({:r,:_}){const E=_?[_]:this.;for(const S of E)try{const C=this._({:S});return this._({:r,:S,_:C})}catch{continue}throw new Error(`${r}    .`)}_({:r,:_,_:E}){const S=E.;if(S==="")return this._({:r,:_,_:E});if(S==="")return this._({:r,_:E});throw Error(`    ${S}`)}__(r,_,E){let S=r,C="";for(const[A,I]of Object.entries(E).sort((B,O)=>O[1]-B[1])){const B=Math.floor(S/I);B&&(S-=B*I,B!==1&&(C+=this.__(B,_,E)),C+=A)}return S&&(C=C+_[Math.floor(S)]),C}(r){return this..on("",r),r(),()=>{this..off("",r)}}_({:r}){return this.(()=>r(this.))}_({:r,:_,:E}){return this.(()=>E(this.({:r,:_})))}_({:r,:_,:E}){return this.(()=>E(this.({:r,:_})))}async (){this._&&await this._()}}function _(n){const r=n.toString();if(r.includes("e")){const[_,E]=r.split("e-");return parseInt(E)+_.length}else return r.length}function ___(n){const r={};for(const _ of n){const E=_.donnes[___],S=_.donnes[___];if(E===""){const C={:E,:_.donnes[___],:_.donnes[____],:_.donnes[___],:_.donnes[___]};r[S]=C}else if(E===""){const C=_.donnes[___];if(!C)throw new Error(`${S}     .`);const A={:E,:_.donnes[___],:_.donnes[____],:_.donnes[___],:JSON.parse(C),:_.donnes[___]};r[S]=A}}return r}const _=()=>{const n=inject$1("");if(!n)throw new Error(" .");return n},_=()=>{const n=_(),r=nuchabl_(),{_:_}=_(),{:E}=_(),S=ref$2(r.rajilankChabl({runuk:E.value}));let C;watchEffect(()=>{C&&C(),C=r?.tatzeqelbejRajilankChabl({runuk:E.value,sm:j=>S.value=j})}),onUnmounted(()=>{C&&C()});const A=ref$2(n.);let I;watchEffect(()=>{I=n._({:j=>A.value=j})}),onUnmounted(()=>{I&&I()});const B=computed(()=>_.value||S.value||"");return{_:_,:B,_:A,_:(j,z)=>computed(()=>n.({:__(j),:z?__(z):B.value})),__:(j,z)=>computed(()=>[...__(j)].map(X=>{if([""," ","+","-","(",")"].includes(X))return X;try{const Q=n.({:X});return n.({:Q,:z?__(z):B.value})}catch{return X}}).join("")),_:(j,z)=>computed(()=>__(j).split(".").map(X=>n.({:parseInt(X),:z?__(z):B.value})).join("."))}},_=({:n,:r=[],:_})=>({install:E=>{const S=E.config.globalProperties.$constl;if(!E.config.globalProperties.$nuchabl){const I=_({:n,:r,:_});E.use(I)}const A=new ({:S});E.provide("",A),E.config.globalProperties.$=A}}),{isEqual:isEqual$2}=pkg,_=()=>{const n=inject$1("");if(!n)throw new Error(" .");return n};class _{;;constructor(){this.={},this.=new s$1}_({:r,:_}){return{_:r._,_:r._+_}}({:r,:_}){const{_:E,_:S}=this._({:r,:_});return this.[E]||(this.[E]={:r,:{}}),this.[E].[S]||(this.[E].[S]={:ref$2({}),:new Set,:void 0,:{:_}}),{:this.[E].[S].,:{:E,:S}}}async ({:r}){const _=v4(),{:E}=this.[r.],S=JSON.stringify(r);if(await this..acquire(S),!this.[r.].[r.].){const A=this.[r.].[r.].,I=await E._({:B=>{A.value=__(B)},:this.[r.].[r.]..});this.[r.].[r.].=I}const{:C}=this.[r.].[r.];return C.add(_),this..release(S),_}async ({:r,_:_}){const E=JSON.stringify(r);await this..acquire(E);const S=this.[r.].[r.];S&&(S..delete(_),S..size===0&&(S.&&await S.(),delete this.[r.].[r.]),Object.keys(this.[r.].).length||delete this.[r.]),this..release(E)}}const _=({:n="",:r})=>{r=r||_();const _=inject$1("");let E;const{:S,:C}=_.({:r,:n});return onMounted(async()=>{E=await _.({:C})}),onUnmounted(async()=>{E&&await _.({:C,_:E})}),{:S}},_=({:n="",:r}={:""})=>{const{:_,:E}=_(),{_:S}=_(),{:C}=_({:r,:n}),{__:A}=__({:n,:r}),I=(N,U,j)=>computed(()=>{const z=__(C.value||{});if(!z)return N;const Z=B.value.find(ue=>!!z[N]?.[ue]),X=Z?z[N][Z]:N,Q=ue=>typeof ue=="number"?S(ue).value:ue.value?ue.value:ue,se=(ue,we)=>{const Te=/@:([^\s\p{P}]+(\.[^\s\p{P}]+)*)/gu;ue=ue.replaceAll(Te,function(Re,Ne){const Fe=B.value.find(nt=>!!z[Ne]?.[nt]);return Fe?z[Ne][Fe]:Ne});const xe=/{([^{]+)}/g;return Array.isArray(we)?ue.replace(xe,function(Re,Ne){return Ne>=we.length?Ne:Q(we[Ne])}):typeof we=="object"?ue.replace(xe,function(Re,Ne){return(Ne=we[Ne])==null?"":Q(Ne)}):ue},oe=X.split("|");return oe.length<2?se(oe[0],typeof U!="number"?U:void 0):se(oe[typeof j=="number"?j:typeof U=="number"?U:0]||oe[oe.length-1],typeof U=="number"?{:U,n:U}:U)}),B=computed(()=>[_.value,...E.value,...A.value.filter(N=>N!==_.value&&!E.value.includes(N))]);return{:I,$:(N,U,j)=>I(N,U,j).value}},__=({:n,:r}={:""})=>{const _=r||_(),E=nuchabl_(),S=ref$2([]);let C;onMounted(async()=>{C=await _._({:U=>{isEqual$2(U,S.value)||(S.value=U)},:n})}),onUnmounted(async()=>{C&&await C()});const A=ref$2([]);let I;onMounted(async()=>{I=E.tatzeqelbejKonojelChabl({sm:U=>A.value=U})}),onUnmounted(async()=>{I&&I()});const B=computed(()=>[...new Set([...A.value,...S.value])]),O=computed(()=>B.value.map(U=>({:U,:E.rubiChabl({runuk:U})})).filter(U=>U.));return{__:B,_:O,_:U=>computed(()=>{const j=__(U);if(j)return O.value.find(z=>z.===j)?.})}},__=({:n,:r="",:_})=>{const E=_||_(),S=ref$2();let C;const A=__(n);return onMounted(async()=>{A&&(C=await E._({:A,:r,:I=>S.value=I}))}),onUnmounted(async()=>{C&&await C()}),typeof n!="string"&&watchEffect(async()=>{C&&await C(),n.value?C=await E._({:n.value,:r,:I=>S.value=I}):(S.value=void 0,C=void 0)}),{_:S}},_=({:n}={})=>{const r=n||_(),_=ref$2();let E;return onMounted(async()=>{E=await r._({:S=>_.value=S})}),onUnmounted(async()=>{E&&await E()}),{:_}},_=({:n}={})=>{const r=n||_(),_=ref$2({});let E;return onMounted(async()=>{E=await r.__({:S=>_.value=S})}),onUnmounted(async()=>{E&&await E()}),{_:_}},_=({:n}={})=>{const r=n||_(),_=ref$2([]);let E;return onMounted(async()=>{E=(await r.__({:S=>_.value=S})).fOublier}),onUnmounted(async()=>{E&&await E()}),{:_}},_$1=({:n,:r=[],:_,:E})=>({install:S=>{if(!S.config.globalProperties.$){const A=_({:n,:r,:E});S.use(A)}S.config.globalProperties.$=_,S.provide("",_),S.provide("",new _)}}),_=()=>({__,__,_,_,_,_}),_=({:n,:r=[],_:_,_:E,:S,:C,_:A="$constl"})=>({install:I=>{const B=I.config.globalProperties[A];if(S&&!B)throw Error(" .");const O=new ({:B,_:_,_:__(E),:S}),N=_$1({:n,:r,:O,:C});I.use(N)}}),makeBorderProps=propsFactory({border:[Boolean,Number,String]},"border");function useBorder(n){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:getCurrentInstanceName();return{borderClasses:computed(()=>{const E=isRef(n)?n.value:n.border,S=[];if(E===!0||E==="")S.push(`${r}--border`);else if(typeof E=="string"||E===0)for(const C of String(E).split(" "))S.push(`border-${C}`);return S})}}const allowedDensities=[null,"default","comfortable","compact"],makeDensityProps=propsFactory({density:{type:String,default:"default",validator:n=>allowedDensities.includes(n)}},"density");function useDensity(n){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:getCurrentInstanceName();return{densityClasses:computed(()=>`${r}--density-${n.density}`)}}const makeElevationProps=propsFactory({elevation:{type:[Number,String],validator(n){const r=parseInt(n);return!isNaN(r)&&r>=0&&r<=24}}},"elevation");function useElevation(n){return{elevationClasses:computed(()=>{const _=isRef(n)?n.value:n.elevation,E=[];return _==null||E.push(`elevation-${_}`),E})}}const makeRoundedProps=propsFactory({rounded:{type:[Boolean,Number,String],default:void 0},tile:Boolean},"rounded");function useRounded(n){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:getCurrentInstanceName();return{roundedClasses:computed(()=>{const E=isRef(n)?n.value:n.rounded,S=isRef(n)?n.value:n.tile,C=[];if(E===!0||E==="")C.push(`${r}--rounded`);else if(typeof E=="string"||E===0)for(const A of String(E).split(" "))C.push(`rounded-${A}`);else S&&C.push("rounded-0");return C})}}const makeTagProps=propsFactory({tag:{type:String,default:"div"}},"tag");function useColor(n){return destructComputed(()=>{const r=[],_={};if(n.value.background)if(isCssColor(n.value.background)){if(_.backgroundColor=n.value.background,!n.value.text&&isParsableColor(n.value.background)){const E=parseColor(n.value.background);if(E.a==null||E.a===1){const S=getForeground(E);_.color=S,_.caretColor=S}}}else r.push(`bg-${n.value.background}`);return n.value.text&&(isCssColor(n.value.text)?(_.color=n.value.text,_.caretColor=n.value.text):r.push(`text-${n.value.text}`)),{colorClasses:r,colorStyles:_}})}function useTextColor(n,r){const _=computed(()=>({text:isRef(n)?n.value:r?n[r]:null})),{colorClasses:E,colorStyles:S}=useColor(_);return{textColorClasses:E,textColorStyles:S}}function useBackgroundColor(n,r){const _=computed(()=>({background:isRef(n)?n.value:r?n[r]:null})),{colorClasses:E,colorStyles:S}=useColor(_);return{backgroundColorClasses:E,backgroundColorStyles:S}}const allowedVariants$1=["elevated","flat","tonal","outlined","text","plain"];function genOverlays(n,r){return createVNode(Fragment,null,[n&&createVNode("span",{key:"overlay",class:`${r}__overlay`},null),createVNode("span",{key:"underlay",class:`${r}__underlay`},null)])}const makeVariantProps=propsFactory({color:String,variant:{type:String,default:"elevated",validator:n=>allowedVariants$1.includes(n)}},"variant");function useVariant(n){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:getCurrentInstanceName();const _=computed(()=>{const{variant:C}=unref(n);return`${r}--variant-${C}`}),{colorClasses:E,colorStyles:S}=useColor(computed(()=>{const{variant:C,color:A}=unref(n);return{[["elevated","flat"].includes(C)?"background":"text"]:A}}));return{colorClasses:E,colorStyles:S,variantClasses:_}}const makeVBtnGroupProps=propsFactory({divided:Boolean,...makeBorderProps(),...makeComponentProps(),...makeDensityProps(),...makeElevationProps(),...makeRoundedProps(),...makeTagProps(),...makeThemeProps(),...makeVariantProps()},"VBtnGroup"),VBtnGroup=genericComponent()({name:"VBtnGroup",props:makeVBtnGroupProps(),setup(n,r){let{slots:_}=r;const{themeClasses:E}=provideTheme(n),{densityClasses:S}=useDensity(n),{borderClasses:C}=useBorder(n),{elevationClasses:A}=useElevation(n),{roundedClasses:I}=useRounded(n);provideDefaults({VBtn:{height:"auto",color:toRef(n,"color"),density:toRef(n,"density"),flat:!0,variant:toRef(n,"variant")}}),useRender(()=>createVNode(n.tag,{class:["v-btn-group",{"v-btn-group--divided":n.divided},E.value,C.value,S.value,A.value,I.value,n.class],style:n.style},_))}}),makeGroupProps=propsFactory({modelValue:{type:null,default:void 0},multiple:Boolean,mandatory:[Boolean,String],max:Number,selectedClass:String,disabled:Boolean},"group"),makeGroupItemProps=propsFactory({value:null,disabled:Boolean,selectedClass:String},"group-item");function useGroupItem(n,r){let _=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const E=getCurrentInstance("useGroupItem");if(!E)throw new Error("[Vuetify] useGroupItem composable must be used inside a component setup function");const S=getUid();provide(Symbol.for(`${r.description}:id`),S);const C=inject$1(r,null);if(!C){if(!_)return C;throw new Error(`[Vuetify] Could not find useGroup injection with symbol ${r.description}`)}const A=toRef(n,"value"),I=computed(()=>!!(C.disabled.value||n.disabled));C.register({id:S,value:A,disabled:I},E),onBeforeUnmount(()=>{C.unregister(S)});const B=computed(()=>C.isSelected(S)),O=computed(()=>B.value&&[C.selectedClass.value,n.selectedClass]);return watch(B,N=>{E.emit("group:selected",{value:N})},{flush:"sync"}),{id:S,isSelected:B,toggle:()=>C.select(S,!B.value),select:N=>C.select(S,N),selectedClass:O,value:A,disabled:I,group:C}}function useGroup(n,r){let _=!1;const E=reactive([]),S=useProxiedModel(n,"modelValue",[],j=>j==null?[]:getIds(E,wrapInArray(j)),j=>{const z=getValues(E,j);return n.multiple?z:z[0]}),C=getCurrentInstance("useGroup");function A(j,z){const Z=j,X=Symbol.for(`${r.description}:id`),se=findChildrenWithProvide(X,C?.vnode).indexOf(z);unref(Z.value)==null&&(Z.value=se),se>-1?E.splice(se,0,Z):E.push(Z)}function I(j){if(_)return;B();const z=E.findIndex(Z=>Z.id===j);E.splice(z,1)}function B(){const j=E.find(z=>!z.disabled);j&&n.mandatory==="force"&&!S.value.length&&(S.value=[j.id])}onMounted(()=>{B()}),onBeforeUnmount(()=>{_=!0});function O(j,z){const Z=E.find(X=>X.id===j);if(!(z&&Z?.disabled))if(n.multiple){const X=S.value.slice(),Q=X.findIndex(oe=>oe===j),se=~Q;if(z=z??!se,se&&n.mandatory&&X.length<=1||!se&&n.max!=null&&X.length+1>n.max)return;Q<0&&z?X.push(j):Q>=0&&!z&&X.splice(Q,1),S.value=X}else{const X=S.value.includes(j);if(n.mandatory&&X)return;S.value=z??!X?[j]:[]}}function N(j){if(n.multiple,S.value.length){const z=S.value[0],Z=E.findIndex(se=>se.id===z);let X=(Z+j)%E.length,Q=E[X];for(;Q.disabled&&X!==Z;)X=(X+j)%E.length,Q=E[X];if(Q.disabled)return;S.value=[E[X].id]}else{const z=E.find(Z=>!Z.disabled);z&&(S.value=[z.id])}}const U={register:A,unregister:I,selected:S,select:O,disabled:toRef(n,"disabled"),prev:()=>N(E.length-1),next:()=>N(1),isSelected:j=>S.value.includes(j),selectedClass:computed(()=>n.selectedClass),items:computed(()=>E),getItemIndex:j=>getItemIndex(E,j)};return provide(r,U),U}function getItemIndex(n,r){const _=getIds(n,[r]);return _.length?n.findIndex(E=>E.id===_[0]):-1}function getIds(n,r){const _=[];return r.forEach(E=>{const S=n.find(A=>deepEqual$2(E,A.value)),C=n[E];S?.value!=null?_.push(S.id):C!=null&&_.push(C.id)}),_}function getValues(n,r){const _=[];return r.forEach(E=>{const S=n.findIndex(C=>C.id===E);if(~S){const C=n[S];_.push(C.value!=null?C.value:S)}}),_}const VBtnToggleSymbol=Symbol.for("vuetify:v-btn-toggle"),makeVBtnToggleProps=propsFactory({...makeVBtnGroupProps(),...makeGroupProps()},"VBtnToggle");genericComponent()({name:"VBtnToggle",props:makeVBtnToggleProps(),emits:{"update:modelValue":n=>!0},setup(n,r){let{slots:_}=r;const{isSelected:E,next:S,prev:C,select:A,selected:I}=useGroup(n,VBtnToggleSymbol);return useRender(()=>{const B=VBtnGroup.filterProps(n);return createVNode(VBtnGroup,mergeProps({class:["v-btn-toggle",n.class]},B,{style:n.style}),{default:()=>[_.default?.({isSelected:E,next:S,prev:C,select:A,selected:I})]})}),{next:S,prev:C,select:A}}});const makeVDefaultsProviderProps=propsFactory({defaults:Object,disabled:Boolean,reset:[Number,String],root:[Boolean,String],scoped:Boolean},"VDefaultsProvider"),VDefaultsProvider=genericComponent(!1)({name:"VDefaultsProvider",props:makeVDefaultsProviderProps(),setup(n,r){let{slots:_}=r;const{defaults:E,disabled:S,reset:C,root:A,scoped:I}=toRefs(n);return provideDefaults(E,{reset:C,root:A,scoped:I,disabled:S}),()=>_.default?.()}}),predefinedSizes=["x-small","small","default","large","x-large"],makeSizeProps=propsFactory({size:{type:[String,Number],default:"default"}},"size");function useSize(n){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:getCurrentInstanceName();return destructComputed(()=>{let _,E;return includes(predefinedSizes,n.size)?_=`${r}--size-${n.size}`:n.size&&(E={width:convertToUnit(n.size),height:convertToUnit(n.size)}),{sizeClasses:_,sizeStyles:E}})}const makeVIconProps=propsFactory({color:String,start:Boolean,end:Boolean,icon:IconValue,...makeComponentProps(),...makeSizeProps(),...makeTagProps({tag:"i"}),...makeThemeProps()},"VIcon"),VIcon=genericComponent()({name:"VIcon",props:makeVIconProps(),setup(n,r){let{attrs:_,slots:E}=r;const S=ref$2(),{themeClasses:C}=provideTheme(n),{iconData:A}=useIcon(computed(()=>S.value||n.icon)),{sizeClasses:I}=useSize(n),{textColorClasses:B,textColorStyles:O}=useTextColor(toRef(n,"color"));return useRender(()=>{const N=E.default?.();return N&&(S.value=flattenFragments(N).filter(U=>U.type===Text&&U.children&&typeof U.children=="string")[0]?.children),createVNode(A.value.component,{tag:n.tag,icon:A.value.icon,class:["v-icon","notranslate",C.value,I.value,B.value,{"v-icon--clickable":!!_.onClick,"v-icon--start":n.start,"v-icon--end":n.end},n.class],style:[I.value?void 0:{fontSize:convertToUnit(n.size),height:convertToUnit(n.size),width:convertToUnit(n.size)},O.value,n.style],role:_.onClick?"button":void 0,"aria-hidden":!_.onClick},{default:()=>[N]})}),{}}});function useIntersectionObserver(n,r){const _=ref$2(),E=shallowRef(!1);if(SUPPORTS_INTERSECTION){const S=new IntersectionObserver(C=>{n?.(C,S),E.value=!!C.find(A=>A.isIntersecting)},r);onBeforeUnmount(()=>{S.disconnect()}),watch(_,(C,A)=>{A&&(S.unobserve(A),E.value=!1),C&&S.observe(C)},{flush:"post"})}return{intersectionRef:_,isIntersecting:E}}const makeVProgressCircularProps=propsFactory({bgColor:String,color:String,indeterminate:[Boolean,String],modelValue:{type:[Number,String],default:0},rotate:{type:[Number,String],default:0},width:{type:[Number,String],default:4},...makeComponentProps(),...makeSizeProps(),...makeTagProps({tag:"div"}),...makeThemeProps()},"VProgressCircular"),VProgressCircular=genericComponent()({name:"VProgressCircular",props:makeVProgressCircularProps(),setup(n,r){let{slots:_}=r;const E=20,S=2*Math.PI*E,C=ref$2(),{themeClasses:A}=provideTheme(n),{sizeClasses:I,sizeStyles:B}=useSize(n),{textColorClasses:O,textColorStyles:N}=useTextColor(toRef(n,"color")),{textColorClasses:U,textColorStyles:j}=useTextColor(toRef(n,"bgColor")),{intersectionRef:z,isIntersecting:Z}=useIntersectionObserver(),{resizeRef:X,contentRect:Q}=useResizeObserver(),se=computed(()=>Math.max(0,Math.min(100,parseFloat(n.modelValue)))),oe=computed(()=>Number(n.width)),ue=computed(()=>B.value?Number(n.size):Q.value?Q.value.width:Math.max(oe.value,32)),we=computed(()=>E/(1-oe.value/ue.value)*2),Te=computed(()=>oe.value/ue.value*we.value),xe=computed(()=>convertToUnit((100-se.value)/100*S));return watchEffect(()=>{z.value=C.value,X.value=C.value}),useRender(()=>createVNode(n.tag,{ref:C,class:["v-progress-circular",{"v-progress-circular--indeterminate":!!n.indeterminate,"v-progress-circular--visible":Z.value,"v-progress-circular--disable-shrink":n.indeterminate==="disable-shrink"},A.value,I.value,O.value,n.class],style:[B.value,N.value,n.style],role:"progressbar","aria-valuemin":"0","aria-valuemax":"100","aria-valuenow":n.indeterminate?void 0:se.value},{default:()=>[createVNode("svg",{style:{transform:`rotate(calc(-90deg + ${Number(n.rotate)}deg))`},xmlns:"http://www.w3.org/2000/svg",viewBox:`0 0 ${we.value} ${we.value}`},[createVNode("circle",{class:["v-progress-circular__underlay",U.value],style:j.value,fill:"transparent",cx:"50%",cy:"50%",r:E,"stroke-width":Te.value,"stroke-dasharray":S,"stroke-dashoffset":0},null),createVNode("circle",{class:"v-progress-circular__overlay",fill:"transparent",cx:"50%",cy:"50%",r:E,"stroke-width":Te.value,"stroke-dasharray":S,"stroke-dashoffset":xe.value},null)]),_.default&&createVNode("div",{class:"v-progress-circular__content"},[_.default({value:se.value})])]})),{}}}),makeDimensionProps=propsFactory({height:[Number,String],maxHeight:[Number,String],maxWidth:[Number,String],minHeight:[Number,String],minWidth:[Number,String],width:[Number,String]},"dimension");function useDimension(n){return{dimensionStyles:computed(()=>({height:convertToUnit(n.height),maxHeight:convertToUnit(n.maxHeight),maxWidth:convertToUnit(n.maxWidth),minHeight:convertToUnit(n.minHeight),minWidth:convertToUnit(n.minWidth),width:convertToUnit(n.width)}))}}const oppositeMap={center:"center",top:"bottom",bottom:"top",left:"right",right:"left"},makeLocationProps=propsFactory({location:String},"location");function useLocation(n){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,_=arguments.length>2?arguments[2]:void 0;const{isRtl:E}=useRtl();return{locationStyles:computed(()=>{if(!n.location)return{};const{side:C,align:A}=parseAnchor(n.location.split(" ").length>1?n.location:`${n.location} center`,E.value);function I(O){return _?_(O):0}const B={};return C!=="center"&&(r?B[oppositeMap[C]]=`calc(100% - ${I(C)}px)`:B[C]=0),A!=="center"?r?B[oppositeMap[A]]=`calc(100% - ${I(A)}px)`:B[A]=0:(C==="center"?B.top=B.left="50%":B[{top:"left",bottom:"left",left:"top",right:"top"}[C]]="50%",B.transform={top:"translateX(-50%)",bottom:"translateX(-50%)",left:"translateY(-50%)",right:"translateY(-50%)",center:"translate(-50%, -50%)"}[C]),B})}}const makeVProgressLinearProps=propsFactory({absolute:Boolean,active:{type:Boolean,default:!0},bgColor:String,bgOpacity:[Number,String],bufferValue:{type:[Number,String],default:0},clickable:Boolean,color:String,height:{type:[Number,String],default:4},indeterminate:Boolean,max:{type:[Number,String],default:100},modelValue:{type:[Number,String],default:0},reverse:Boolean,stream:Boolean,striped:Boolean,roundedBar:Boolean,...makeComponentProps(),...makeLocationProps({location:"top"}),...makeRoundedProps(),...makeTagProps(),...makeThemeProps()},"VProgressLinear"),VProgressLinear=genericComponent()({name:"VProgressLinear",props:makeVProgressLinearProps(),emits:{"update:modelValue":n=>!0},setup(n,r){let{slots:_}=r;const E=useProxiedModel(n,"modelValue"),{isRtl:S,rtlClasses:C}=useRtl(),{themeClasses:A}=provideTheme(n),{locationStyles:I}=useLocation(n),{textColorClasses:B,textColorStyles:O}=useTextColor(n,"color"),{backgroundColorClasses:N,backgroundColorStyles:U}=useBackgroundColor(computed(()=>n.bgColor||n.color)),{backgroundColorClasses:j,backgroundColorStyles:z}=useBackgroundColor(n,"color"),{roundedClasses:Z}=useRounded(n),{intersectionRef:X,isIntersecting:Q}=useIntersectionObserver(),se=computed(()=>parseInt(n.max,10)),oe=computed(()=>parseInt(n.height,10)),ue=computed(()=>parseFloat(n.bufferValue)/se.value*100),we=computed(()=>parseFloat(E.value)/se.value*100),Te=computed(()=>S.value!==n.reverse),xe=computed(()=>n.indeterminate?"fade-transition":"slide-x-transition"),Re=computed(()=>n.bgOpacity==null?n.bgOpacity:parseFloat(n.bgOpacity));function Ne(Fe){if(!X.value)return;const{left:ht,right:nt,width:Ee}=X.value.getBoundingClientRect(),Ce=Te.value?Ee-Fe.clientX+(nt-Ee):Fe.clientX-ht;E.value=Math.round(Ce/Ee*se.value)}return useRender(()=>createVNode(n.tag,{ref:X,class:["v-progress-linear",{"v-progress-linear--absolute":n.absolute,"v-progress-linear--active":n.active&&Q.value,"v-progress-linear--reverse":Te.value,"v-progress-linear--rounded":n.rounded,"v-progress-linear--rounded-bar":n.roundedBar,"v-progress-linear--striped":n.striped},Z.value,A.value,C.value,n.class],style:[{bottom:n.location==="bottom"?0:void 0,top:n.location==="top"?0:void 0,height:n.active?convertToUnit(oe.value):0,"--v-progress-linear-height":convertToUnit(oe.value),...I.value},n.style],role:"progressbar","aria-hidden":n.active?"false":"true","aria-valuemin":"0","aria-valuemax":n.max,"aria-valuenow":n.indeterminate?void 0:we.value,onClick:n.clickable&&Ne},{default:()=>[n.stream&&createVNode("div",{key:"stream",class:["v-progress-linear__stream",B.value],style:{...O.value,[Te.value?"left":"right"]:convertToUnit(-oe.value),borderTop:`${convertToUnit(oe.value/2)} dotted`,opacity:Re.value,top:`calc(50% - ${convertToUnit(oe.value/4)})`,width:convertToUnit(100-ue.value,"%"),"--v-progress-linear-stream-to":convertToUnit(oe.value*(Te.value?1:-1))}},null),createVNode("div",{class:["v-progress-linear__background",N.value],style:[U.value,{opacity:Re.value,width:convertToUnit(n.stream?ue.value:100,"%")}]},null),createVNode(Transition$1,{name:xe.value},{default:()=>[n.indeterminate?createVNode("div",{class:"v-progress-linear__indeterminate"},[["long","short"].map(Fe=>createVNode("div",{key:Fe,class:["v-progress-linear__indeterminate",Fe,j.value],style:z.value},null))]):createVNode("div",{class:["v-progress-linear__determinate",j.value],style:[z.value,{width:convertToUnit(we.value,"%")}]},null)]}),_.default&&createVNode("div",{class:"v-progress-linear__content"},[_.default({value:we.value,buffer:ue.value})])]})),{}}}),makeLoaderProps=propsFactory({loading:[Boolean,String]},"loader");function useLoader(n){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:getCurrentInstanceName();return{loaderClasses:computed(()=>({[`${r}--loading`]:n.loading}))}}function LoaderSlot(n,r){let{slots:_}=r;return createVNode("div",{class:`${n.name}__loader`},[_.default?.({color:n.color,isActive:n.active})||createVNode(VProgressLinear,{absolute:n.absolute,active:n.active,color:n.color,height:"2",indeterminate:!0},null)])}const positionValues=["static","relative","fixed","absolute","sticky"],makePositionProps=propsFactory({position:{type:String,validator:n=>positionValues.includes(n)}},"position");function usePosition(n){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:getCurrentInstanceName();return{positionClasses:computed(()=>n.position?`${r}--${n.position}`:void 0)}}function useRoute(){const n=getCurrentInstance("useRoute");return computed(()=>n?.proxy?.$route)}function useRouter(){return getCurrentInstance("useRouter")?.proxy?.$router}function useLink(n,r){const _=resolveDynamicComponent("RouterLink"),E=computed(()=>!!(n.href||n.to)),S=computed(()=>E?.value||hasEvent(r,"click")||hasEvent(n,"click"));if(typeof _=="string")return{isLink:E,isClickable:S,href:toRef(n,"href")};const C=n.to?_.useLink(n):void 0,A=useRoute();return{isLink:E,isClickable:S,route:C?.route,navigate:C?.navigate,isActive:C&&computed(()=>n.exact?A.value?C.isExactActive?.value&&deepEqual$2(C.route.value.query,A.value.query):C.isExactActive?.value:C.isActive?.value),href:computed(()=>n.to?C?.route.value.href:n.href)}}const makeRouterProps=propsFactory({href:String,replace:Boolean,to:[String,Object],exact:Boolean},"router");let inTransition=!1;function useBackButton(n,r){let _=!1,E,S;IN_BROWSER&&(nextTick$3(()=>{window.addEventListener("popstate",C),E=n?.beforeEach((A,I,B)=>{inTransition?_?r(B):B():setTimeout(()=>_?r(B):B()),inTransition=!0}),S=n?.afterEach(()=>{inTransition=!1})}),onScopeDispose(()=>{window.removeEventListener("popstate",C),E?.(),S?.()}));function C(A){A.state?.replaced||(_=!0,setTimeout(()=>_=!1))}}function useSelectLink(n,r){watch(()=>n.isActive?.value,_=>{n.isLink.value&&_&&r&&nextTick$3(()=>{r(!0)})},{immediate:!0})}const stopSymbol=Symbol("rippleStop"),DELAY_RIPPLE=80;function transform(n,r){n.style.transform=r,n.style.webkitTransform=r}function isTouchEvent(n){return n.constructor.name==="TouchEvent"}function isKeyboardEvent(n){return n.constructor.name==="KeyboardEvent"}const calculate=function(n,r){let _=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},E=0,S=0;if(!isKeyboardEvent(n)){const U=r.getBoundingClientRect(),j=isTouchEvent(n)?n.touches[n.touches.length-1]:n;E=j.clientX-U.left,S=j.clientY-U.top}let C=0,A=.3;r._ripple?.circle?(A=.15,C=r.clientWidth/2,C=_.center?C:C+Math.sqrt((E-C)**2+(S-C)**2)/4):C=Math.sqrt(r.clientWidth**2+r.clientHeight**2)/2;const I=`${(r.clientWidth-C*2)/2}px`,B=`${(r.clientHeight-C*2)/2}px`,O=_.center?I:`${E-C}px`,N=_.center?B:`${S-C}px`;return{radius:C,scale:A,x:O,y:N,centerX:I,centerY:B}},ripples={show(n,r){let _=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(!r?._ripple?.enabled)return;const E=document.createElement("span"),S=document.createElement("span");E.appendChild(S),E.className="v-ripple__container",_.class&&(E.className+=` ${_.class}`);const{radius:C,scale:A,x:I,y:B,centerX:O,centerY:N}=calculate(n,r,_),U=`${C*2}px`;S.className="v-ripple__animation",S.style.width=U,S.style.height=U,r.appendChild(E);const j=window.getComputedStyle(r);j&&j.position==="static"&&(r.style.position="relative",r.dataset.previousPosition="static"),S.classList.add("v-ripple__animation--enter"),S.classList.add("v-ripple__animation--visible"),transform(S,`translate(${I}, ${B}) scale3d(${A},${A},${A})`),S.dataset.activated=String(performance.now()),setTimeout(()=>{S.classList.remove("v-ripple__animation--enter"),S.classList.add("v-ripple__animation--in"),transform(S,`translate(${O}, ${N}) scale3d(1,1,1)`)},0)},hide(n){if(!n?._ripple?.enabled)return;const r=n.getElementsByClassName("v-ripple__animation");if(r.length===0)return;const _=r[r.length-1];if(_.dataset.isHiding)return;_.dataset.isHiding="true";const E=performance.now()-Number(_.dataset.activated),S=Math.max(250-E,0);setTimeout(()=>{_.classList.remove("v-ripple__animation--in"),_.classList.add("v-ripple__animation--out"),setTimeout(()=>{n.getElementsByClassName("v-ripple__animation").length===1&&n.dataset.previousPosition&&(n.style.position=n.dataset.previousPosition,delete n.dataset.previousPosition),_.parentNode?.parentNode===n&&n.removeChild(_.parentNode)},300)},S)}};function isRippleEnabled(n){return typeof n>"u"||!!n}function rippleShow(n){const r={},_=n.currentTarget;if(!(!_?._ripple||_._ripple.touched||n[stopSymbol])){if(n[stopSymbol]=!0,isTouchEvent(n))_._ripple.touched=!0,_._ripple.isTouch=!0;else if(_._ripple.isTouch)return;if(r.center=_._ripple.centered||isKeyboardEvent(n),_._ripple.class&&(r.class=_._ripple.class),isTouchEvent(n)){if(_._ripple.showTimerCommit)return;_._ripple.showTimerCommit=()=>{ripples.show(n,_,r)},_._ripple.showTimer=window.setTimeout(()=>{_?._ripple?.showTimerCommit&&(_._ripple.showTimerCommit(),_._ripple.showTimerCommit=null)},DELAY_RIPPLE)}else ripples.show(n,_,r)}}function rippleStop(n){n[stopSymbol]=!0}function rippleHide(n){const r=n.currentTarget;if(r?._ripple){if(window.clearTimeout(r._ripple.showTimer),n.type==="touchend"&&r._ripple.showTimerCommit){r._ripple.showTimerCommit(),r._ripple.showTimerCommit=null,r._ripple.showTimer=window.setTimeout(()=>{rippleHide(n)});return}window.setTimeout(()=>{r._ripple&&(r._ripple.touched=!1)}),ripples.hide(r)}}function rippleCancelShow(n){const r=n.currentTarget;r?._ripple&&(r._ripple.showTimerCommit&&(r._ripple.showTimerCommit=null),window.clearTimeout(r._ripple.showTimer))}let keyboardRipple=!1;function keyboardRippleShow(n){!keyboardRipple&&(n.keyCode===keyCodes.enter||n.keyCode===keyCodes.space)&&(keyboardRipple=!0,rippleShow(n))}function keyboardRippleHide(n){keyboardRipple=!1,rippleHide(n)}function focusRippleHide(n){keyboardRipple&&(keyboardRipple=!1,rippleHide(n))}function updateRipple(n,r,_){const{value:E,modifiers:S}=r,C=isRippleEnabled(E);if(C||ripples.hide(n),n._ripple=n._ripple??{},n._ripple.enabled=C,n._ripple.centered=S.center,n._ripple.circle=S.circle,isObject$1(E)&&E.class&&(n._ripple.class=E.class),C&&!_){if(S.stop){n.addEventListener("touchstart",rippleStop,{passive:!0}),n.addEventListener("mousedown",rippleStop);return}n.addEventListener("touchstart",rippleShow,{passive:!0}),n.addEventListener("touchend",rippleHide,{passive:!0}),n.addEventListener("touchmove",rippleCancelShow,{passive:!0}),n.addEventListener("touchcancel",rippleHide),n.addEventListener("mousedown",rippleShow),n.addEventListener("mouseup",rippleHide),n.addEventListener("mouseleave",rippleHide),n.addEventListener("keydown",keyboardRippleShow),n.addEventListener("keyup",keyboardRippleHide),n.addEventListener("blur",focusRippleHide),n.addEventListener("dragstart",rippleHide,{passive:!0})}else!C&&_&&removeListeners(n)}function removeListeners(n){n.removeEventListener("mousedown",rippleShow),n.removeEventListener("touchstart",rippleShow),n.removeEventListener("touchend",rippleHide),n.removeEventListener("touchmove",rippleCancelShow),n.removeEventListener("touchcancel",rippleHide),n.removeEventListener("mouseup",rippleHide),n.removeEventListener("mouseleave",rippleHide),n.removeEventListener("keydown",keyboardRippleShow),n.removeEventListener("keyup",keyboardRippleHide),n.removeEventListener("dragstart",rippleHide),n.removeEventListener("blur",focusRippleHide)}function mounted$2(n,r){updateRipple(n,r,!1)}function unmounted$2(n){delete n._ripple,removeListeners(n)}function updated(n,r){if(r.value===r.oldValue)return;const _=isRippleEnabled(r.oldValue);updateRipple(n,r,_)}const Ripple={mounted:mounted$2,unmounted:unmounted$2,updated},makeVBtnProps=propsFactory({active:{type:Boolean,default:void 0},symbol:{type:null,default:VBtnToggleSymbol},flat:Boolean,icon:[Boolean,String,Function,Object],prependIcon:IconValue,appendIcon:IconValue,block:Boolean,slim:Boolean,stacked:Boolean,ripple:{type:[Boolean,Object],default:!0},text:String,...makeBorderProps(),...makeComponentProps(),...makeDensityProps(),...makeDimensionProps(),...makeElevationProps(),...makeGroupItemProps(),...makeLoaderProps(),...makeLocationProps(),...makePositionProps(),...makeRoundedProps(),...makeRouterProps(),...makeSizeProps(),...makeTagProps({tag:"button"}),...makeThemeProps(),...makeVariantProps({variant:"elevated"})},"VBtn"),VBtn=genericComponent()({name:"VBtn",directives:{Ripple},props:makeVBtnProps(),emits:{"group:selected":n=>!0},setup(n,r){let{attrs:_,slots:E}=r;const{themeClasses:S}=provideTheme(n),{borderClasses:C}=useBorder(n),{colorClasses:A,colorStyles:I,variantClasses:B}=useVariant(n),{densityClasses:O}=useDensity(n),{dimensionStyles:N}=useDimension(n),{elevationClasses:U}=useElevation(n),{loaderClasses:j}=useLoader(n),{locationStyles:z}=useLocation(n),{positionClasses:Z}=usePosition(n),{roundedClasses:X}=useRounded(n),{sizeClasses:Q,sizeStyles:se}=useSize(n),oe=useGroupItem(n,n.symbol,!1),ue=useLink(n,_),we=computed(()=>n.active!==void 0?n.active:ue.isLink.value?ue.isActive?.value:oe?.isSelected.value),Te=computed(()=>oe?.disabled.value||n.disabled),xe=computed(()=>n.variant==="elevated"&&!(n.disabled||n.flat||n.border)),Re=computed(()=>{if(!(n.value===void 0||typeof n.value=="symbol"))return Object(n.value)===n.value?JSON.stringify(n.value,null,0):n.value});function Ne(Fe){Te.value||ue.isLink.value&&(Fe.metaKey||Fe.ctrlKey||Fe.shiftKey||Fe.button!==0||_.target==="_blank")||(ue.navigate?.(Fe),oe?.toggle())}return useSelectLink(ue,oe?.select),useRender(()=>{const Fe=ue.isLink.value?"a":n.tag,ht=!!(n.prependIcon||E.prepend),nt=!!(n.appendIcon||E.append),Ee=!!(n.icon&&n.icon!==!0),Ce=oe?.isSelected.value&&(!ue.isLink.value||ue.isActive?.value)||!oe||ue.isActive?.value;return withDirectives(createVNode(Fe,{type:Fe==="a"?void 0:"button",class:["v-btn",oe?.selectedClass.value,{"v-btn--active":we.value,"v-btn--block":n.block,"v-btn--disabled":Te.value,"v-btn--elevated":xe.value,"v-btn--flat":n.flat,"v-btn--icon":!!n.icon,"v-btn--loading":n.loading,"v-btn--slim":n.slim,"v-btn--stacked":n.stacked},S.value,C.value,Ce?A.value:void 0,O.value,U.value,j.value,Z.value,X.value,Q.value,B.value,n.class],style:[Ce?I.value:void 0,N.value,z.value,se.value,n.style],disabled:Te.value||void 0,href:ue.href.value,onClick:Ne,value:Re.value},{default:()=>[genOverlays(!0,"v-btn"),!n.icon&&ht&&createVNode("span",{key:"prepend",class:"v-btn__prepend"},[E.prepend?createVNode(VDefaultsProvider,{key:"prepend-defaults",disabled:!n.prependIcon,defaults:{VIcon:{icon:n.prependIcon}}},E.prepend):createVNode(VIcon,{key:"prepend-icon",icon:n.prependIcon},null)]),createVNode("span",{class:"v-btn__content","data-no-activator":""},[!E.default&&Ee?createVNode(VIcon,{key:"content-icon",icon:n.icon},null):createVNode(VDefaultsProvider,{key:"content-defaults",disabled:!Ee,defaults:{VIcon:{icon:n.icon}}},{default:()=>[E.default?.()??n.text]})]),!n.icon&&nt&&createVNode("span",{key:"append",class:"v-btn__append"},[E.append?createVNode(VDefaultsProvider,{key:"append-defaults",disabled:!n.appendIcon,defaults:{VIcon:{icon:n.appendIcon}}},E.append):createVNode(VIcon,{key:"append-icon",icon:n.appendIcon},null)]),!!n.loading&&createVNode("span",{key:"loader",class:"v-btn__loader"},[E.loader?.()??createVNode(VProgressCircular,{color:typeof n.loading=="boolean"?void 0:n.loading,indeterminate:!0,size:"23",width:"2"},null)])]}),[[resolveDirective("ripple"),!Te.value&&n.ripple,null]])}),{group:oe}}}),breakpointProps=breakpoints.reduce((n,r)=>(n[r]={type:[Boolean,String,Number],default:!1},n),{}),offsetProps=breakpoints.reduce((n,r)=>{const _="offset"+capitalize(r);return n[_]={type:[String,Number],default:null},n},{}),orderProps=breakpoints.reduce((n,r)=>{const _="order"+capitalize(r);return n[_]={type:[String,Number],default:null},n},{}),propMap$1={col:Object.keys(breakpointProps),offset:Object.keys(offsetProps),order:Object.keys(orderProps)};function breakpointClass$1(n,r,_){let E=n;if(!(_==null||_===!1)){if(r){const S=r.replace(n,"");E+=`-${S}`}return n==="col"&&(E="v-"+E),n==="col"&&(_===""||_===!0)||(E+=`-${_}`),E.toLowerCase()}}const ALIGN_SELF_VALUES=["auto","start","end","center","baseline","stretch"],makeVColProps=propsFactory({cols:{type:[Boolean,String,Number],default:!1},...breakpointProps,offset:{type:[String,Number],default:null},...offsetProps,order:{type:[String,Number],default:null},...orderProps,alignSelf:{type:String,default:null,validator:n=>ALIGN_SELF_VALUES.includes(n)},...makeComponentProps(),...makeTagProps()},"VCol"),VCol=genericComponent()({name:"VCol",props:makeVColProps(),setup(n,r){let{slots:_}=r;const E=computed(()=>{const S=[];let C;for(C in propMap$1)propMap$1[C].forEach(I=>{const B=n[I],O=breakpointClass$1(C,I,B);O&&S.push(O)});const A=S.some(I=>I.startsWith("v-col-"));return S.push({"v-col":!A||!n.cols,[`v-col-${n.cols}`]:n.cols,[`offset-${n.offset}`]:n.offset,[`order-${n.order}`]:n.order,[`align-self-${n.alignSelf}`]:n.alignSelf}),S});return()=>h$2(n.tag,{class:[E.value,n.class],style:n.style},_.default?.())}}),ALIGNMENT=["start","end","center"],SPACE=["space-between","space-around","space-evenly"];function makeRowProps(n,r){return breakpoints.reduce((_,E)=>{const S=n+capitalize(E);return _[S]=r(),_},{})}const ALIGN_VALUES=[...ALIGNMENT,"baseline","stretch"],alignValidator=n=>ALIGN_VALUES.includes(n),alignProps=makeRowProps("align",()=>({type:String,default:null,validator:alignValidator})),JUSTIFY_VALUES=[...ALIGNMENT,...SPACE],justifyValidator=n=>JUSTIFY_VALUES.includes(n),justifyProps=makeRowProps("justify",()=>({type:String,default:null,validator:justifyValidator})),ALIGN_CONTENT_VALUES=[...ALIGNMENT,...SPACE,"stretch"],alignContentValidator=n=>ALIGN_CONTENT_VALUES.includes(n),alignContentProps=makeRowProps("alignContent",()=>({type:String,default:null,validator:alignContentValidator})),propMap={align:Object.keys(alignProps),justify:Object.keys(justifyProps),alignContent:Object.keys(alignContentProps)},classMap={align:"align",justify:"justify",alignContent:"align-content"};function breakpointClass(n,r,_){let E=classMap[n];if(_!=null){if(r){const S=r.replace(n,"");E+=`-${S}`}return E+=`-${_}`,E.toLowerCase()}}const makeVRowProps=propsFactory({dense:Boolean,noGutters:Boolean,align:{type:String,default:null,validator:alignValidator},...alignProps,justify:{type:String,default:null,validator:justifyValidator},...justifyProps,alignContent:{type:String,default:null,validator:alignContentValidator},...alignContentProps,...makeComponentProps(),...makeTagProps()},"VRow"),VRow=genericComponent()({name:"VRow",props:makeVRowProps(),setup(n,r){let{slots:_}=r;const E=computed(()=>{const S=[];let C;for(C in propMap)propMap[C].forEach(A=>{const I=n[A],B=breakpointClass(C,A,I);B&&S.push(B)});return S.push({"v-row--no-gutters":n.noGutters,"v-row--dense":n.dense,[`align-${n.align}`]:n.align,[`justify-${n.justify}`]:n.justify,[`align-content-${n.alignContent}`]:n.alignContent}),S});return()=>h$2(n.tag,{class:["v-row",E.value,n.class],style:n.style},_.default?.())}}),VSpacer=createSimpleFunctional("v-spacer","div","VSpacer"),handleGesture=n=>{const{touchstartX:r,touchendX:_,touchstartY:E,touchendY:S}=n,C=.5,A=16;n.offsetX=_-r,n.offsetY=S-E,Math.abs(n.offsetY)<C*Math.abs(n.offsetX)&&(n.left&&_<r-A&&n.left(n),n.right&&_>r+A&&n.right(n)),Math.abs(n.offsetX)<C*Math.abs(n.offsetY)&&(n.up&&S<E-A&&n.up(n),n.down&&S>E+A&&n.down(n))};function touchstart(n,r){const _=n.changedTouches[0];r.touchstartX=_.clientX,r.touchstartY=_.clientY,r.start?.({originalEvent:n,...r})}function touchend(n,r){const _=n.changedTouches[0];r.touchendX=_.clientX,r.touchendY=_.clientY,r.end?.({originalEvent:n,...r}),handleGesture(r)}function touchmove(n,r){const _=n.changedTouches[0];r.touchmoveX=_.clientX,r.touchmoveY=_.clientY,r.move?.({originalEvent:n,...r})}function createHandlers(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const r={touchstartX:0,touchstartY:0,touchendX:0,touchendY:0,touchmoveX:0,touchmoveY:0,offsetX:0,offsetY:0,left:n.left,right:n.right,up:n.up,down:n.down,start:n.start,move:n.move,end:n.end};return{touchstart:_=>touchstart(_,r),touchend:_=>touchend(_,r),touchmove:_=>touchmove(_,r)}}function mounted$1(n,r){const _=r.value,E=_?.parent?n.parentElement:n,S=_?.options??{passive:!0},C=r.instance?.$.uid;if(!E||!C)return;const A=createHandlers(r.value);E._touchHandlers=E._touchHandlers??Object.create(null),E._touchHandlers[C]=A,keys$3(A).forEach(I=>{E.addEventListener(I,A[I],S)})}function unmounted$1(n,r){const _=r.value?.parent?n.parentElement:n,E=r.instance?.$.uid;if(!_?._touchHandlers||!E)return;const S=_._touchHandlers[E];keys$3(S).forEach(C=>{_.removeEventListener(C,S[C])}),delete _._touchHandlers[E]}const Touch={mounted:mounted$1,unmounted:unmounted$1},VWindowSymbol=Symbol.for("vuetify:v-window"),VWindowGroupSymbol=Symbol.for("vuetify:v-window-group"),makeVWindowProps=propsFactory({continuous:Boolean,nextIcon:{type:[Boolean,String,Function,Object],default:"$next"},prevIcon:{type:[Boolean,String,Function,Object],default:"$prev"},reverse:Boolean,showArrows:{type:[Boolean,String],validator:n=>typeof n=="boolean"||n==="hover"},touch:{type:[Object,Boolean],default:void 0},direction:{type:String,default:"horizontal"},modelValue:null,disabled:Boolean,selectedClass:{type:String,default:"v-window-item--active"},mandatory:{type:[Boolean,String],default:"force"},...makeComponentProps(),...makeTagProps(),...makeThemeProps()},"VWindow"),VWindow=genericComponent()({name:"VWindow",directives:{Touch},props:makeVWindowProps(),emits:{"update:modelValue":n=>!0},setup(n,r){let{slots:_}=r;const{themeClasses:E}=provideTheme(n),{isRtl:S}=useRtl(),{t:C}=useLocale(),A=useGroup(n,VWindowGroupSymbol),I=ref$2(),B=computed(()=>S.value?!n.reverse:n.reverse),O=shallowRef(!1),N=computed(()=>{const we=n.direction==="vertical"?"y":"x",xe=(B.value?!O.value:O.value)?"-reverse":"";return`v-window-${we}${xe}-transition`}),U=shallowRef(0),j=ref$2(void 0),z=computed(()=>A.items.value.findIndex(we=>A.selected.value.includes(we.id)));watch(z,(we,Te)=>{const xe=A.items.value.length,Re=xe-1;xe<=2?O.value=we<Te:we===Re&&Te===0?O.value=!0:we===0&&Te===Re?O.value=!1:O.value=we<Te}),provide(VWindowSymbol,{transition:N,isReversed:O,transitionCount:U,transitionHeight:j,rootRef:I});const Z=computed(()=>n.continuous||z.value!==0),X=computed(()=>n.continuous||z.value!==A.items.value.length-1);function Q(){Z.value&&A.prev()}function se(){X.value&&A.next()}const oe=computed(()=>{const we=[],Te={icon:S.value?n.nextIcon:n.prevIcon,class:`v-window__${B.value?"right":"left"}`,onClick:A.prev,"aria-label":C("$vuetify.carousel.prev")};we.push(Z.value?_.prev?_.prev({props:Te}):createVNode(VBtn,Te,null):createVNode("div",null,null));const xe={icon:S.value?n.prevIcon:n.nextIcon,class:`v-window__${B.value?"left":"right"}`,onClick:A.next,"aria-label":C("$vuetify.carousel.next")};return we.push(X.value?_.next?_.next({props:xe}):createVNode(VBtn,xe,null):createVNode("div",null,null)),we}),ue=computed(()=>n.touch===!1?n.touch:{...{left:()=>{B.value?Q():se()},right:()=>{B.value?se():Q()},start:Te=>{let{originalEvent:xe}=Te;xe.stopPropagation()}},...n.touch===!0?{}:n.touch});return useRender(()=>withDirectives(createVNode(n.tag,{ref:I,class:["v-window",{"v-window--show-arrows-on-hover":n.showArrows==="hover"},E.value,n.class],style:n.style},{default:()=>[createVNode("div",{class:"v-window__container",style:{height:j.value}},[_.default?.({group:A}),n.showArrows!==!1&&createVNode("div",{class:"v-window__controls"},[oe.value])]),_.additional?.({group:A})]}),[[resolveDirective("touch"),ue.value]])),{group:A}}}),makeLazyProps=propsFactory({eager:Boolean},"lazy");function useLazy(n,r){const _=shallowRef(!1),E=computed(()=>_.value||n.eager||r.value);watch(r,()=>_.value=!0);function S(){n.eager||(_.value=!1)}return{isBooted:_,hasContent:E,onAfterLeave:S}}function useSsrBoot(){const n=shallowRef(!1);return onMounted(()=>{window.requestAnimationFrame(()=>{n.value=!0})}),{ssrBootStyles:computed(()=>n.value?void 0:{transition:"none !important"}),isBooted:readonly$3(n)}}const makeTransitionProps$1=propsFactory({transition:{type:[Boolean,String,Object],default:"fade-transition",validator:n=>n!==!0}},"transition"),MaybeTransition=(n,r)=>{let{slots:_}=r;const{transition:E,disabled:S,group:C,...A}=n,{component:I=C?TransitionGroup:Transition$1,...B}=typeof E=="object"?E:{};return h$2(I,mergeProps(typeof E=="string"?{name:S?"":E}:B,typeof E=="string"?{}:{disabled:S,group:C},A),_)},makeVWindowItemProps=propsFactory({reverseTransition:{type:[Boolean,String],default:void 0},transition:{type:[Boolean,String],default:void 0},...makeComponentProps(),...makeGroupItemProps(),...makeLazyProps()},"VWindowItem"),VWindowItem=genericComponent()({name:"VWindowItem",directives:{Touch},props:makeVWindowItemProps(),emits:{"group:selected":n=>!0},setup(n,r){let{slots:_}=r;const E=inject$1(VWindowSymbol),S=useGroupItem(n,VWindowGroupSymbol),{isBooted:C}=useSsrBoot();if(!E||!S)throw new Error("[Vuetify] VWindowItem must be used inside VWindow");const A=shallowRef(!1),I=computed(()=>C.value&&(E.isReversed.value?n.reverseTransition!==!1:n.transition!==!1));function B(){!A.value||!E||(A.value=!1,E.transitionCount.value>0&&(E.transitionCount.value-=1,E.transitionCount.value===0&&(E.transitionHeight.value=void 0)))}function O(){A.value||!E||(A.value=!0,E.transitionCount.value===0&&(E.transitionHeight.value=convertToUnit(E.rootRef.value?.clientHeight)),E.transitionCount.value+=1)}function N(){B()}function U(Z){A.value&&nextTick$3(()=>{!I.value||!A.value||!E||(E.transitionHeight.value=convertToUnit(Z.clientHeight))})}const j=computed(()=>{const Z=E.isReversed.value?n.reverseTransition:n.transition;return I.value?{name:typeof Z!="string"?E.transition.value:Z,onBeforeEnter:O,onAfterEnter:B,onEnterCancelled:N,onBeforeLeave:O,onAfterLeave:B,onLeaveCancelled:N,onEnter:U}:!1}),{hasContent:z}=useLazy(n,S.isSelected);return useRender(()=>createVNode(MaybeTransition,{transition:j.value,disabled:!C.value},{default:()=>[withDirectives(createVNode("div",{class:["v-window-item",S.selectedClass.value,n.class],style:n.style},[z.value&&_.default?.()]),[[vShow,S.isSelected.value]])]})),{groupItem:S}}}),_sfc_main$f=defineComponent$1({__name:"tapeCours",props:{nEtapes:{},etape:{}},emits:["retour","avancer"],setup(n,{emit:r}){const _=r;return(E,S)=>(openBlock(),createBlock(VWindowItem,{key:E.etape,style:{height:"100%"}},{default:withCtx(()=>[createVNode(VRow,{style:{height:"100%"}},{default:withCtx(()=>[E.etape>0?(openBlock(),createBlock(VCol,{key:0,cols:12,class:"mt-6 text-center"},{default:withCtx(()=>[createVNode(VBtn,{onClick:S[0]||(S[0]=()=>_("retour")),icon:"mdi-chevron-up"})]),_:1})):createCommentVNode("",!0),renderSlot(E.$slots,"default"),E.etape<E.nEtapes-1?(openBlock(),createBlock(VCol,{key:1,cols:12,class:"mt-auto text-center"},{default:withCtx(()=>[createVNode(VBtn,{onClick:S[1]||(S[1]=()=>_("avancer")),class:"pa-2",icon:"mdi-chevron-down"})]),_:1})):createCommentVNode("",!0)]),_:3})]),_:3}))}}),makeTransitionProps=propsFactory({disabled:Boolean,group:Boolean,hideOnLeave:Boolean,leaveAbsolute:Boolean,mode:String,origin:String},"transition");function createCssTransition(n,r,_){return genericComponent()({name:n,props:makeTransitionProps({mode:_,origin:r}),setup(E,S){let{slots:C}=S;const A={onBeforeEnter(I){E.origin&&(I.style.transformOrigin=E.origin)},onLeave(I){if(E.leaveAbsolute){const{offsetTop:B,offsetLeft:O,offsetWidth:N,offsetHeight:U}=I;I._transitionInitialStyles={position:I.style.position,top:I.style.top,left:I.style.left,width:I.style.width,height:I.style.height},I.style.position="absolute",I.style.top=`${B}px`,I.style.left=`${O}px`,I.style.width=`${N}px`,I.style.height=`${U}px`}E.hideOnLeave&&I.style.setProperty("display","none","important")},onAfterLeave(I){if(E.leaveAbsolute&&I?._transitionInitialStyles){const{position:B,top:O,left:N,width:U,height:j}=I._transitionInitialStyles;delete I._transitionInitialStyles,I.style.position=B||"",I.style.top=O||"",I.style.left=N||"",I.style.width=U||"",I.style.height=j||""}}};return()=>{const I=E.group?TransitionGroup:Transition$1;return h$2(I,{name:E.disabled?"":n,css:!E.disabled,...E.group?void 0:{mode:E.mode},...E.disabled?{}:A},C.default)}}})}function createJavascriptTransition(n,r){let _=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"in-out";return genericComponent()({name:n,props:{mode:{type:String,default:_},disabled:Boolean},setup(E,S){let{slots:C}=S;return()=>h$2(Transition$1,{name:E.disabled?"":n,css:!E.disabled,...E.disabled?{}:r},C.default)}})}function ExpandTransitionGenerator(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";const _=(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1)?"width":"height",E=camelize(`offset-${_}`);return{onBeforeEnter(A){A._parent=A.parentNode,A._initialStyle={transition:A.style.transition,overflow:A.style.overflow,[_]:A.style[_]}},onEnter(A){const I=A._initialStyle;A.style.setProperty("transition","none","important"),A.style.overflow="hidden";const B=`${A[E]}px`;A.style[_]="0",A.offsetHeight,A.style.transition=I.transition,n&&A._parent&&A._parent.classList.add(n),requestAnimationFrame(()=>{A.style[_]=B})},onAfterEnter:C,onEnterCancelled:C,onLeave(A){A._initialStyle={transition:"",overflow:A.style.overflow,[_]:A.style[_]},A.style.overflow="hidden",A.style[_]=`${A[E]}px`,A.offsetHeight,requestAnimationFrame(()=>A.style[_]="0")},onAfterLeave:S,onLeaveCancelled:S};function S(A){n&&A._parent&&A._parent.classList.remove(n),C(A)}function C(A){const I=A._initialStyle[_];A.style.overflow=A._initialStyle.overflow,I!=null&&(A.style[_]=I),delete A._initialStyle}}const makeVDialogTransitionProps=propsFactory({target:[Object,Array]},"v-dialog-transition"),VDialogTransition=genericComponent()({name:"VDialogTransition",props:makeVDialogTransitionProps(),setup(n,r){let{slots:_}=r;const E={onBeforeEnter(S){S.style.pointerEvents="none",S.style.visibility="hidden"},async onEnter(S,C){await new Promise(j=>requestAnimationFrame(j)),await new Promise(j=>requestAnimationFrame(j)),S.style.visibility="";const{x:A,y:I,sx:B,sy:O,speed:N}=getDimensions(n.target,S),U=animate(S,[{transform:`translate(${A}px, ${I}px) scale(${B}, ${O})`,opacity:0},{}],{duration:225*N,easing:deceleratedEasing});getChildren(S)?.forEach(j=>{animate(j,[{opacity:0},{opacity:0,offset:.33},{}],{duration:225*2*N,easing:standardEasing})}),U.finished.then(()=>C())},onAfterEnter(S){S.style.removeProperty("pointer-events")},onBeforeLeave(S){S.style.pointerEvents="none"},async onLeave(S,C){await new Promise(j=>requestAnimationFrame(j));const{x:A,y:I,sx:B,sy:O,speed:N}=getDimensions(n.target,S);animate(S,[{},{transform:`translate(${A}px, ${I}px) scale(${B}, ${O})`,opacity:0}],{duration:125*N,easing:acceleratedEasing}).finished.then(()=>C()),getChildren(S)?.forEach(j=>{animate(j,[{},{opacity:0,offset:.2},{opacity:0}],{duration:125*2*N,easing:standardEasing})})},onAfterLeave(S){S.style.removeProperty("pointer-events")}};return()=>n.target?createVNode(Transition$1,mergeProps({name:"dialog-transition"},E,{css:!1}),_):createVNode(Transition$1,{name:"dialog-transition"},_)}});function getChildren(n){const r=n.querySelector(":scope > .v-card, :scope > .v-sheet, :scope > .v-list")?.children;return r&&[...r]}function getDimensions(n,r){const _=getTargetBox(n),E=nullifyTransforms(r),[S,C]=getComputedStyle(r).transformOrigin.split(" ").map(se=>parseFloat(se)),[A,I]=getComputedStyle(r).getPropertyValue("--v-overlay-anchor-origin").split(" ");let B=_.left+_.width/2;A==="left"||I==="left"?B-=_.width/2:(A==="right"||I==="right")&&(B+=_.width/2);let O=_.top+_.height/2;A==="top"||I==="top"?O-=_.height/2:(A==="bottom"||I==="bottom")&&(O+=_.height/2);const N=_.width/E.width,U=_.height/E.height,j=Math.max(1,N,U),z=N/j||0,Z=U/j||0,X=E.width*E.height/(window.innerWidth*window.innerHeight),Q=X>.12?Math.min(1.5,(X-.12)*10+1):1;return{x:B-(S+E.left),y:O-(C+E.top),sx:z,sy:Z,speed:Q}}createCssTransition("fab-transition","center center","out-in");createCssTransition("dialog-bottom-transition");createCssTransition("dialog-top-transition");createCssTransition("fade-transition");const VScaleTransition=createCssTransition("scale-transition");createCssTransition("scroll-x-transition");createCssTransition("scroll-x-reverse-transition");createCssTransition("scroll-y-transition");createCssTransition("scroll-y-reverse-transition");createCssTransition("slide-x-transition");createCssTransition("slide-x-reverse-transition");const VSlideYTransition=createCssTransition("slide-y-transition");createCssTransition("slide-y-reverse-transition");const VExpandTransition=createJavascriptTransition("expand-transition",ExpandTransitionGenerator()),VExpandXTransition=createJavascriptTransition("expand-x-transition",ExpandTransitionGenerator("",!0)),ListKey=Symbol.for("vuetify:list");function createList(){const n=inject$1(ListKey,{hasPrepend:shallowRef(!1),updateHasPrepend:()=>null}),r={hasPrepend:shallowRef(!1),updateHasPrepend:_=>{_&&(r.hasPrepend.value=_)}};return provide(ListKey,r),n}function useList(){return inject$1(ListKey,null)}const independentActiveStrategy=n=>{const r={activate:_=>{let{id:E,value:S,activated:C}=_;return E=toRaw(E),n&&!S&&C.size===1&&C.has(E)||(S?C.add(E):C.delete(E)),C},in:(_,E,S)=>{let C=new Set;for(const A of _||[])C=r.activate({id:A,value:!0,activated:new Set(C),children:E,parents:S});return C},out:_=>Array.from(_)};return r},independentSingleActiveStrategy=n=>{const r=independentActiveStrategy(n);return{activate:E=>{let{activated:S,id:C,...A}=E;C=toRaw(C);const I=S.has(C)?new Set([C]):new Set;return r.activate({...A,id:C,activated:I})},in:(E,S,C)=>{let A=new Set;return E?.length&&(A=r.in(E.slice(0,1),S,C)),A},out:(E,S,C)=>r.out(E,S,C)}},leafActiveStrategy=n=>{const r=independentActiveStrategy(n);return{activate:E=>{let{id:S,activated:C,children:A,...I}=E;return S=toRaw(S),A.has(S)?C:r.activate({id:S,activated:C,children:A,...I})},in:r.in,out:r.out}},leafSingleActiveStrategy=n=>{const r=independentSingleActiveStrategy(n);return{activate:E=>{let{id:S,activated:C,children:A,...I}=E;return S=toRaw(S),A.has(S)?C:r.activate({id:S,activated:C,children:A,...I})},in:r.in,out:r.out}},singleOpenStrategy={open:n=>{let{id:r,value:_,opened:E,parents:S}=n;if(_){const C=new Set;C.add(r);let A=S.get(r);for(;A!=null;)C.add(A),A=S.get(A);return C}else return E.delete(r),E},select:()=>null},multipleOpenStrategy={open:n=>{let{id:r,value:_,opened:E,parents:S}=n;if(_){let C=S.get(r);for(E.add(r);C!=null&&C!==r;)E.add(C),C=S.get(C);return E}else E.delete(r);return E},select:()=>null},listOpenStrategy={open:multipleOpenStrategy.open,select:n=>{let{id:r,value:_,opened:E,parents:S}=n;if(!_)return E;const C=[];let A=S.get(r);for(;A!=null;)C.push(A),A=S.get(A);return new Set(C)}},independentSelectStrategy=n=>{const r={select:_=>{let{id:E,value:S,selected:C}=_;if(E=toRaw(E),n&&!S){const A=Array.from(C.entries()).reduce((I,B)=>{let[O,N]=B;return N==="on"&&I.push(O),I},[]);if(A.length===1&&A[0]===E)return C}return C.set(E,S?"on":"off"),C},in:(_,E,S)=>{let C=new Map;for(const A of _||[])C=r.select({id:A,value:!0,selected:new Map(C),children:E,parents:S});return C},out:_=>{const E=[];for(const[S,C]of _.entries())C==="on"&&E.push(S);return E}};return r},independentSingleSelectStrategy=n=>{const r=independentSelectStrategy(n);return{select:E=>{let{selected:S,id:C,...A}=E;C=toRaw(C);const I=S.has(C)?new Map([[C,S.get(C)]]):new Map;return r.select({...A,id:C,selected:I})},in:(E,S,C)=>{let A=new Map;return E?.length&&(A=r.in(E.slice(0,1),S,C)),A},out:(E,S,C)=>r.out(E,S,C)}},leafSelectStrategy=n=>{const r=independentSelectStrategy(n);return{select:E=>{let{id:S,selected:C,children:A,...I}=E;return S=toRaw(S),A.has(S)?C:r.select({id:S,selected:C,children:A,...I})},in:r.in,out:r.out}},leafSingleSelectStrategy=n=>{const r=independentSingleSelectStrategy(n);return{select:E=>{let{id:S,selected:C,children:A,...I}=E;return S=toRaw(S),A.has(S)?C:r.select({id:S,selected:C,children:A,...I})},in:r.in,out:r.out}},classicSelectStrategy=n=>{const r={select:_=>{let{id:E,value:S,selected:C,children:A,parents:I}=_;E=toRaw(E);const B=new Map(C),O=[E];for(;O.length;){const U=O.shift();C.set(U,S?"on":"off"),A.has(U)&&O.push(...A.get(U))}let N=I.get(E);for(;N;){const U=A.get(N),j=U.every(Z=>C.get(Z)==="on"),z=U.every(Z=>!C.has(Z)||C.get(Z)==="off");C.set(N,j?"on":z?"off":"indeterminate"),N=I.get(N)}return n&&!S&&Array.from(C.entries()).reduce((j,z)=>{let[Z,X]=z;return X==="on"&&j.push(Z),j},[]).length===0?B:C},in:(_,E,S)=>{let C=new Map;for(const A of _||[])C=r.select({id:A,value:!0,selected:new Map(C),children:E,parents:S});return C},out:(_,E)=>{const S=[];for(const[C,A]of _.entries())A==="on"&&!E.has(C)&&S.push(C);return S}};return r},VNestedSymbol=Symbol.for("vuetify:nested"),emptyNested={id:shallowRef(),root:{register:()=>null,unregister:()=>null,parents:ref$2(new Map),children:ref$2(new Map),open:()=>null,openOnSelect:()=>null,activate:()=>null,select:()=>null,activatable:ref$2(!1),selectable:ref$2(!1),opened:ref$2(new Set),activated:ref$2(new Set),selected:ref$2(new Map),selectedValues:ref$2([])}},makeNestedProps=propsFactory({activatable:Boolean,selectable:Boolean,activeStrategy:[String,Function],selectStrategy:[String,Function],openStrategy:[String,Object],opened:Array,activated:Array,selected:Array,mandatory:Boolean},"nested"),useNested=n=>{let r=!1;const _=ref$2(new Map),E=ref$2(new Map),S=useProxiedModel(n,"opened",n.opened,z=>new Set(z),z=>[...z.values()]),C=computed(()=>{if(typeof n.activeStrategy=="object")return n.activeStrategy;switch(n.activeStrategy){case"leaf":return leafActiveStrategy(n.mandatory);case"single-leaf":return leafSingleActiveStrategy(n.mandatory);case"independent":return independentActiveStrategy(n.mandatory);case"single-independent":default:return independentSingleActiveStrategy(n.mandatory)}}),A=computed(()=>{if(typeof n.selectStrategy=="object")return n.selectStrategy;switch(n.selectStrategy){case"single-leaf":return leafSingleSelectStrategy(n.mandatory);case"leaf":return leafSelectStrategy(n.mandatory);case"independent":return independentSelectStrategy(n.mandatory);case"single-independent":return independentSingleSelectStrategy(n.mandatory);case"classic":default:return classicSelectStrategy(n.mandatory)}}),I=computed(()=>{if(typeof n.openStrategy=="object")return n.openStrategy;switch(n.openStrategy){case"list":return listOpenStrategy;case"single":return singleOpenStrategy;case"multiple":default:return multipleOpenStrategy}}),B=useProxiedModel(n,"activated",n.activated,z=>C.value.in(z,_.value,E.value),z=>C.value.out(z,_.value,E.value)),O=useProxiedModel(n,"selected",n.selected,z=>A.value.in(z,_.value,E.value),z=>A.value.out(z,_.value,E.value));onBeforeUnmount(()=>{r=!0});function N(z){const Z=[];let X=z;for(;X!=null;)Z.unshift(X),X=E.value.get(X);return Z}const U=getCurrentInstance("nested"),j={id:shallowRef(),root:{opened:S,activatable:toRef(n,"activatable"),selectable:toRef(n,"selectable"),activated:B,selected:O,selectedValues:computed(()=>{const z=[];for(const[Z,X]of O.value.entries())X==="on"&&z.push(Z);return z}),register:(z,Z,X)=>{Z&&z!==Z&&E.value.set(z,Z),X&&_.value.set(z,[]),Z!=null&&_.value.set(Z,[..._.value.get(Z)||[],z])},unregister:z=>{if(r)return;_.value.delete(z);const Z=E.value.get(z);if(Z){const X=_.value.get(Z)??[];_.value.set(Z,X.filter(Q=>Q!==z))}E.value.delete(z),S.value.delete(z)},open:(z,Z,X)=>{U.emit("click:open",{id:z,value:Z,path:N(z),event:X});const Q=I.value.open({id:z,value:Z,opened:new Set(S.value),children:_.value,parents:E.value,event:X});Q&&(S.value=Q)},openOnSelect:(z,Z,X)=>{const Q=I.value.select({id:z,value:Z,selected:new Map(O.value),opened:new Set(S.value),children:_.value,parents:E.value,event:X});Q&&(S.value=Q)},select:(z,Z,X)=>{U.emit("click:select",{id:z,value:Z,path:N(z),event:X});const Q=A.value.select({id:z,value:Z,selected:new Map(O.value),children:_.value,parents:E.value,event:X});Q&&(O.value=Q),j.root.openOnSelect(z,Z,X)},activate:(z,Z,X)=>{if(!n.activatable)return j.root.select(z,!0,X);U.emit("click:activate",{id:z,value:Z,path:N(z),event:X});const Q=C.value.activate({id:z,value:Z,activated:new Set(B.value),children:_.value,parents:E.value,event:X});Q&&(B.value=Q)},children:_,parents:E}};return provide(VNestedSymbol,j),j.root},useNestedItem=(n,r)=>{const _=inject$1(VNestedSymbol,emptyNested),E=Symbol(getUid()),S=computed(()=>n.value!==void 0?n.value:E),C={..._,id:S,open:(A,I)=>_.root.open(S.value,A,I),openOnSelect:(A,I)=>_.root.openOnSelect(S.value,A,I),isOpen:computed(()=>_.root.opened.value.has(S.value)),parent:computed(()=>_.root.parents.value.get(S.value)),activate:(A,I)=>_.root.activate(S.value,A,I),isActivated:computed(()=>_.root.activated.value.has(toRaw(S.value))),select:(A,I)=>_.root.select(S.value,A,I),isSelected:computed(()=>_.root.selected.value.get(toRaw(S.value))==="on"),isIndeterminate:computed(()=>_.root.selected.value.get(S.value)==="indeterminate"),isLeaf:computed(()=>!_.root.children.value.get(S.value)),isGroupActivator:_.isGroupActivator};return!_.isGroupActivator&&_.root.register(S.value,_.id.value,r),onBeforeUnmount(()=>{!_.isGroupActivator&&_.root.unregister(S.value)}),r&&provide(VNestedSymbol,C),C},useNestedGroupActivator=()=>{const n=inject$1(VNestedSymbol,emptyNested);provide(VNestedSymbol,{...n,isGroupActivator:!0})},VListGroupActivator=defineComponent({name:"VListGroupActivator",setup(n,r){let{slots:_}=r;return useNestedGroupActivator(),()=>_.default?.()}}),makeVListGroupProps=propsFactory({activeColor:String,baseColor:String,color:String,collapseIcon:{type:IconValue,default:"$collapse"},expandIcon:{type:IconValue,default:"$expand"},prependIcon:IconValue,appendIcon:IconValue,fluid:Boolean,subgroup:Boolean,title:String,value:null,...makeComponentProps(),...makeTagProps()},"VListGroup"),VListGroup=genericComponent()({name:"VListGroup",props:makeVListGroupProps(),setup(n,r){let{slots:_}=r;const{isOpen:E,open:S,id:C}=useNestedItem(toRef(n,"value"),!0),A=computed(()=>`v-list-group--id-${String(C.value)}`),I=useList(),{isBooted:B}=useSsrBoot();function O(z){S(!E.value,z)}const N=computed(()=>({onClick:O,class:"v-list-group__header",id:A.value})),U=computed(()=>E.value?n.collapseIcon:n.expandIcon),j=computed(()=>({VListItem:{active:E.value,activeColor:n.activeColor,baseColor:n.baseColor,color:n.color,prependIcon:n.prependIcon||n.subgroup&&U.value,appendIcon:n.appendIcon||!n.subgroup&&U.value,title:n.title,value:n.value}}));return useRender(()=>createVNode(n.tag,{class:["v-list-group",{"v-list-group--prepend":I?.hasPrepend.value,"v-list-group--fluid":n.fluid,"v-list-group--subgroup":n.subgroup,"v-list-group--open":E.value},n.class],style:n.style},{default:()=>[_.activator&&createVNode(VDefaultsProvider,{defaults:j.value},{default:()=>[createVNode(VListGroupActivator,null,{default:()=>[_.activator({props:N.value,isOpen:E.value})]})]}),createVNode(MaybeTransition,{transition:{component:VExpandTransition},disabled:!B.value},{default:()=>[withDirectives(createVNode("div",{class:"v-list-group__items",role:"group","aria-labelledby":A.value},[_.default?.()]),[[vShow,E.value]])]})]})),{isOpen:E}}}),VListItemSubtitle=createSimpleFunctional("v-list-item-subtitle"),VListItemTitle=createSimpleFunctional("v-list-item-title");function useAspectStyles(n){return{aspectStyles:computed(()=>{const r=Number(n.aspectRatio);return r?{paddingBottom:String(1/r*100)+"%"}:void 0})}}const makeVResponsiveProps=propsFactory({aspectRatio:[String,Number],contentClass:String,inline:Boolean,...makeComponentProps(),...makeDimensionProps()},"VResponsive"),VResponsive=genericComponent()({name:"VResponsive",props:makeVResponsiveProps(),setup(n,r){let{slots:_}=r;const{aspectStyles:E}=useAspectStyles(n),{dimensionStyles:S}=useDimension(n);return useRender(()=>createVNode("div",{class:["v-responsive",{"v-responsive--inline":n.inline},n.class],style:[S.value,n.style]},[createVNode("div",{class:"v-responsive__sizer",style:E.value},null),_.additional?.(),_.default&&createVNode("div",{class:["v-responsive__content",n.contentClass]},[_.default()])])),{}}});function mounted(n,r){if(!SUPPORTS_INTERSECTION)return;const _=r.modifiers||{},E=r.value,{handler:S,options:C}=typeof E=="object"?E:{handler:E,options:{}},A=new IntersectionObserver(function(){let I=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],B=arguments.length>1?arguments[1]:void 0;const O=n._observe?.[r.instance.$.uid];if(!O)return;const N=I.some(U=>U.isIntersecting);S&&(!_.quiet||O.init)&&(!_.once||N||O.init)&&S(N,I,B),N&&_.once?unmounted(n,r):O.init=!0},C);n._observe=Object(n._observe),n._observe[r.instance.$.uid]={init:!1,observer:A},A.observe(n)}function unmounted(n,r){const _=n._observe?.[r.instance.$.uid];_&&(_.observer.unobserve(n),delete n._observe[r.instance.$.uid])}const Intersect={mounted,unmounted},Intersect$1=Intersect,makeVImgProps=propsFactory({alt:String,cover:Boolean,color:String,draggable:{type:[Boolean,String],default:void 0},eager:Boolean,gradient:String,lazySrc:String,options:{type:Object,default:()=>({root:void 0,rootMargin:void 0,threshold:void 0})},sizes:String,src:{type:[String,Object],default:""},crossorigin:String,referrerpolicy:String,srcset:String,position:String,...makeVResponsiveProps(),...makeComponentProps(),...makeRoundedProps(),...makeTransitionProps$1()},"VImg"),VImg=genericComponent()({name:"VImg",directives:{intersect:Intersect$1},props:makeVImgProps(),emits:{loadstart:n=>!0,load:n=>!0,error:n=>!0},setup(n,r){let{emit:_,slots:E}=r;const{backgroundColorClasses:S,backgroundColorStyles:C}=useBackgroundColor(toRef(n,"color")),{roundedClasses:A}=useRounded(n),I=getCurrentInstance("VImg"),B=shallowRef(""),O=ref$2(),N=shallowRef(n.eager?"loading":"idle"),U=shallowRef(),j=shallowRef(),z=computed(()=>n.src&&typeof n.src=="object"?{src:n.src.src,srcset:n.srcset||n.src.srcset,lazySrc:n.lazySrc||n.src.lazySrc,aspect:Number(n.aspectRatio||n.src.aspect||0)}:{src:n.src,srcset:n.srcset,lazySrc:n.lazySrc,aspect:Number(n.aspectRatio||0)}),Z=computed(()=>z.value.aspect||U.value/j.value||0);watch(()=>n.src,()=>{X(N.value!=="idle")}),watch(Z,(Ee,Ce)=>{!Ee&&Ce&&O.value&&we(O.value)}),onBeforeMount(()=>X());function X(Ee){if(!(n.eager&&Ee)&&!(SUPPORTS_INTERSECTION&&!Ee&&!n.eager)){if(N.value="loading",z.value.lazySrc){const Ce=new Image;Ce.src=z.value.lazySrc,we(Ce,null)}z.value.src&&nextTick$3(()=>{_("loadstart",O.value?.currentSrc||z.value.src),setTimeout(()=>{if(!I.isUnmounted)if(O.value?.complete){if(O.value.naturalWidth||se(),N.value==="error")return;Z.value||we(O.value,null),N.value==="loading"&&Q()}else Z.value||we(O.value),oe()})})}}function Q(){I.isUnmounted||(oe(),we(O.value),N.value="loaded",_("load",O.value?.currentSrc||z.value.src))}function se(){I.isUnmounted||(N.value="error",_("error",O.value?.currentSrc||z.value.src))}function oe(){const Ee=O.value;Ee&&(B.value=Ee.currentSrc||Ee.src)}let ue=-1;onBeforeUnmount(()=>{clearTimeout(ue)});function we(Ee){let Ce=arguments.length>1&&arguments[1]!==void 0?arguments[1]:100;const _e=()=>{if(clearTimeout(ue),I.isUnmounted)return;const{naturalHeight:Ie,naturalWidth:He}=Ee;Ie||He?(U.value=He,j.value=Ie):!Ee.complete&&N.value==="loading"&&Ce!=null?ue=window.setTimeout(_e,Ce):(Ee.currentSrc.endsWith(".svg")||Ee.currentSrc.startsWith("data:image/svg+xml"))&&(U.value=1,j.value=1)};_e()}const Te=computed(()=>({"v-img__img--cover":n.cover,"v-img__img--contain":!n.cover})),xe=()=>{if(!z.value.src||N.value==="idle")return null;const Ee=createVNode("img",{class:["v-img__img",Te.value],style:{objectPosition:n.position},src:z.value.src,srcset:z.value.srcset,alt:n.alt,crossorigin:n.crossorigin,referrerpolicy:n.referrerpolicy,draggable:n.draggable,sizes:n.sizes,ref:O,onLoad:Q,onError:se},null),Ce=E.sources?.();return createVNode(MaybeTransition,{transition:n.transition,appear:!0},{default:()=>[withDirectives(Ce?createVNode("picture",{class:"v-img__picture"},[Ce,Ee]):Ee,[[vShow,N.value==="loaded"]])]})},Re=()=>createVNode(MaybeTransition,{transition:n.transition},{default:()=>[z.value.lazySrc&&N.value!=="loaded"&&createVNode("img",{class:["v-img__img","v-img__img--preload",Te.value],style:{objectPosition:n.position},src:z.value.lazySrc,alt:n.alt,crossorigin:n.crossorigin,referrerpolicy:n.referrerpolicy,draggable:n.draggable},null)]}),Ne=()=>E.placeholder?createVNode(MaybeTransition,{transition:n.transition,appear:!0},{default:()=>[(N.value==="loading"||N.value==="error"&&!E.error)&&createVNode("div",{class:"v-img__placeholder"},[E.placeholder()])]}):null,Fe=()=>E.error?createVNode(MaybeTransition,{transition:n.transition,appear:!0},{default:()=>[N.value==="error"&&createVNode("div",{class:"v-img__error"},[E.error()])]}):null,ht=()=>n.gradient?createVNode("div",{class:"v-img__gradient",style:{backgroundImage:`linear-gradient(${n.gradient})`}},null):null,nt=shallowRef(!1);{const Ee=watch(Z,Ce=>{Ce&&(requestAnimationFrame(()=>{requestAnimationFrame(()=>{nt.value=!0})}),Ee())})}return useRender(()=>{const Ee=VResponsive.filterProps(n);return withDirectives(createVNode(VResponsive,mergeProps({class:["v-img",{"v-img--booting":!nt.value},S.value,A.value,n.class],style:[{width:convertToUnit(n.width==="auto"?U.value:n.width)},C.value,n.style]},Ee,{aspectRatio:Z.value,"aria-label":n.alt,role:n.alt?"img":void 0}),{additional:()=>createVNode(Fragment,null,[createVNode(xe,null,null),createVNode(Re,null,null),createVNode(ht,null,null),createVNode(Ne,null,null),createVNode(Fe,null,null)]),default:E.default}),[[resolveDirective("intersect"),{handler:X,options:n.options},null,{once:!0}]])}),{currentSrc:B,image:O,state:N,naturalWidth:U,naturalHeight:j}}}),makeVAvatarProps=propsFactory({start:Boolean,end:Boolean,icon:IconValue,image:String,text:String,...makeComponentProps(),...makeDensityProps(),...makeRoundedProps(),...makeSizeProps(),...makeTagProps(),...makeThemeProps(),...makeVariantProps({variant:"flat"})},"VAvatar"),VAvatar=genericComponent()({name:"VAvatar",props:makeVAvatarProps(),setup(n,r){let{slots:_}=r;const{themeClasses:E}=provideTheme(n),{colorClasses:S,colorStyles:C,variantClasses:A}=useVariant(n),{densityClasses:I}=useDensity(n),{roundedClasses:B}=useRounded(n),{sizeClasses:O,sizeStyles:N}=useSize(n);return useRender(()=>createVNode(n.tag,{class:["v-avatar",{"v-avatar--start":n.start,"v-avatar--end":n.end},E.value,S.value,I.value,B.value,O.value,A.value,n.class],style:[C.value,N.value,n.style]},{default:()=>[_.default?createVNode(VDefaultsProvider,{key:"content-defaults",defaults:{VImg:{cover:!0,image:n.image},VIcon:{icon:n.icon}}},{default:()=>[_.default()]}):n.image?createVNode(VImg,{key:"image",src:n.image,alt:"",cover:!0},null):n.icon?createVNode(VIcon,{key:"icon",icon:n.icon},null):n.text,genOverlays(!1,"v-avatar")]})),{}}}),makeVListItemProps=propsFactory({active:{type:Boolean,default:void 0},activeClass:String,activeColor:String,appendAvatar:String,appendIcon:IconValue,baseColor:String,disabled:Boolean,lines:String,link:{type:Boolean,default:void 0},nav:Boolean,prependAvatar:String,prependIcon:IconValue,ripple:{type:[Boolean,Object],default:!0},slim:Boolean,subtitle:[String,Number],title:[String,Number],value:null,onClick:EventProp(),onClickOnce:EventProp(),...makeBorderProps(),...makeComponentProps(),...makeDensityProps(),...makeDimensionProps(),...makeElevationProps(),...makeRoundedProps(),...makeRouterProps(),...makeTagProps(),...makeThemeProps(),...makeVariantProps({variant:"text"})},"VListItem"),VListItem=genericComponent()({name:"VListItem",directives:{Ripple},props:makeVListItemProps(),emits:{click:n=>!0},setup(n,r){let{attrs:_,slots:E,emit:S}=r;const C=useLink(n,_),A=computed(()=>n.value===void 0?C.href.value:n.value),{activate:I,isActivated:B,select:O,isSelected:N,isIndeterminate:U,isGroupActivator:j,root:z,parent:Z,openOnSelect:X}=useNestedItem(A,!1),Q=useList(),se=computed(()=>n.active!==!1&&(n.active||C.isActive?.value||(z.activatable.value?B.value:N.value))),oe=computed(()=>n.link!==!1&&C.isLink.value),ue=computed(()=>!n.disabled&&n.link!==!1&&(n.link||C.isClickable.value||!!Q&&(z.selectable.value||z.activatable.value||n.value!=null))),we=computed(()=>n.rounded||n.nav),Te=computed(()=>n.color??n.activeColor),xe=computed(()=>({color:se.value?Te.value??n.baseColor:n.baseColor,variant:n.variant}));watch(()=>C.isActive?.value,Ve=>{Ve&&Z.value!=null&&z.open(Z.value,!0),Ve&&X(Ve)},{immediate:!0});const{themeClasses:Re}=provideTheme(n),{borderClasses:Ne}=useBorder(n),{colorClasses:Fe,colorStyles:ht,variantClasses:nt}=useVariant(xe),{densityClasses:Ee}=useDensity(n),{dimensionStyles:Ce}=useDimension(n),{elevationClasses:_e}=useElevation(n),{roundedClasses:Ie}=useRounded(we),He=computed(()=>n.lines?`v-list-item--${n.lines}-line`:void 0),Be=computed(()=>({isActive:se.value,select:O,isSelected:N.value,isIndeterminate:U.value}));function Ge(Ve){S("click",Ve),!(j||!ue.value)&&(C.navigate?.(Ve),z.activatable?I(!B.value,Ve):(z.selectable||n.value!=null)&&O(!N.value,Ve))}function je(Ve){(Ve.key==="Enter"||Ve.key===" ")&&(Ve.preventDefault(),Ge(Ve))}return useRender(()=>{const Ve=oe.value?"a":n.tag,Pe=E.title||n.title!=null,Me=E.subtitle||n.subtitle!=null,tt=!!(n.appendAvatar||n.appendIcon),Ke=!!(tt||E.append),mt=!!(n.prependAvatar||n.prependIcon),ct=!!(mt||E.prepend);return Q?.updateHasPrepend(ct),n.activeColor&&deprecate$1("active-color",["color","base-color"]),withDirectives(createVNode(Ve,{class:["v-list-item",{"v-list-item--active":se.value,"v-list-item--disabled":n.disabled,"v-list-item--link":ue.value,"v-list-item--nav":n.nav,"v-list-item--prepend":!ct&&Q?.hasPrepend.value,"v-list-item--slim":n.slim,[`${n.activeClass}`]:n.activeClass&&se.value},Re.value,Ne.value,Fe.value,Ee.value,_e.value,He.value,Ie.value,nt.value,n.class],style:[ht.value,Ce.value,n.style],href:C.href.value,tabindex:ue.value?Q?-2:0:void 0,onClick:Ge,onKeydown:ue.value&&!oe.value&&je},{default:()=>[genOverlays(ue.value||se.value,"v-list-item"),ct&&createVNode("div",{key:"prepend",class:"v-list-item__prepend"},[E.prepend?createVNode(VDefaultsProvider,{key:"prepend-defaults",disabled:!mt,defaults:{VAvatar:{density:n.density,image:n.prependAvatar},VIcon:{density:n.density,icon:n.prependIcon},VListItemAction:{start:!0}}},{default:()=>[E.prepend?.(Be.value)]}):createVNode(Fragment,null,[n.prependAvatar&&createVNode(VAvatar,{key:"prepend-avatar",density:n.density,image:n.prependAvatar},null),n.prependIcon&&createVNode(VIcon,{key:"prepend-icon",density:n.density,icon:n.prependIcon},null)]),createVNode("div",{class:"v-list-item__spacer"},null)]),createVNode("div",{class:"v-list-item__content","data-no-activator":""},[Pe&&createVNode(VListItemTitle,{key:"title"},{default:()=>[E.title?.({title:n.title})??n.title]}),Me&&createVNode(VListItemSubtitle,{key:"subtitle"},{default:()=>[E.subtitle?.({subtitle:n.subtitle})??n.subtitle]}),E.default?.(Be.value)]),Ke&&createVNode("div",{key:"append",class:"v-list-item__append"},[E.append?createVNode(VDefaultsProvider,{key:"append-defaults",disabled:!tt,defaults:{VAvatar:{density:n.density,image:n.appendAvatar},VIcon:{density:n.density,icon:n.appendIcon},VListItemAction:{end:!0}}},{default:()=>[E.append?.(Be.value)]}):createVNode(Fragment,null,[n.appendIcon&&createVNode(VIcon,{key:"append-icon",density:n.density,icon:n.appendIcon},null),n.appendAvatar&&createVNode(VAvatar,{key:"append-avatar",density:n.density,image:n.appendAvatar},null)]),createVNode("div",{class:"v-list-item__spacer"},null)])]}),[[resolveDirective("ripple"),ue.value&&n.ripple]])}),{isGroupActivator:j,isSelected:N,list:Q,select:O}}}),makeVListSubheaderProps=propsFactory({color:String,inset:Boolean,sticky:Boolean,title:String,...makeComponentProps(),...makeTagProps()},"VListSubheader"),VListSubheader=genericComponent()({name:"VListSubheader",props:makeVListSubheaderProps(),setup(n,r){let{slots:_}=r;const{textColorClasses:E,textColorStyles:S}=useTextColor(toRef(n,"color"));return useRender(()=>{const C=!!(_.default||n.title);return createVNode(n.tag,{class:["v-list-subheader",{"v-list-subheader--inset":n.inset,"v-list-subheader--sticky":n.sticky},E.value,n.class],style:[{textColorStyles:S},n.style]},{default:()=>[C&&createVNode("div",{class:"v-list-subheader__text"},[_.default?.()??n.title])]})}),{}}}),makeVDividerProps=propsFactory({color:String,inset:Boolean,length:[Number,String],thickness:[Number,String],vertical:Boolean,...makeComponentProps(),...makeThemeProps()},"VDivider"),VDivider=genericComponent()({name:"VDivider",props:makeVDividerProps(),setup(n,r){let{attrs:_}=r;const{themeClasses:E}=provideTheme(n),{textColorClasses:S,textColorStyles:C}=useTextColor(toRef(n,"color")),A=computed(()=>{const I={};return n.length&&(I[n.vertical?"maxHeight":"maxWidth"]=convertToUnit(n.length)),n.thickness&&(I[n.vertical?"borderRightWidth":"borderTopWidth"]=convertToUnit(n.thickness)),I});return useRender(()=>createVNode("hr",{class:[{"v-divider":!0,"v-divider--inset":n.inset,"v-divider--vertical":n.vertical},E.value,S.value,n.class],style:[A.value,C.value,n.style],"aria-orientation":!_.role||_.role==="separator"?n.vertical?"vertical":"horizontal":void 0,role:`${_.role||"separator"}`},null)),{}}}),makeVListChildrenProps=propsFactory({items:Array,returnObject:Boolean},"VListChildren"),VListChildren=genericComponent()({name:"VListChildren",props:makeVListChildrenProps(),setup(n,r){let{slots:_}=r;return createList(),()=>_.default?.()??n.items?.map(E=>{let{children:S,props:C,type:A,raw:I}=E;if(A==="divider")return _.divider?.({props:C})??createVNode(VDivider,C,null);if(A==="subheader")return _.subheader?.({props:C})??createVNode(VListSubheader,C,null);const B={subtitle:_.subtitle?N=>_.subtitle?.({...N,item:I}):void 0,prepend:_.prepend?N=>_.prepend?.({...N,item:I}):void 0,append:_.append?N=>_.append?.({...N,item:I}):void 0,title:_.title?N=>_.title?.({...N,item:I}):void 0},O=VListGroup.filterProps(C);return S?createVNode(VListGroup,mergeProps({value:C?.value},O),{activator:N=>{let{props:U}=N;const j={...C,...U,value:n.returnObject?I:C.value};return _.header?_.header({props:j}):createVNode(VListItem,j,B)},default:()=>createVNode(VListChildren,{items:S},_)}):_.item?_.item({props:C}):createVNode(VListItem,mergeProps(C,{value:n.returnObject?I:C.value}),B)})}}),makeItemsProps=propsFactory({items:{type:Array,default:()=>[]},itemTitle:{type:[String,Array,Function],default:"title"},itemValue:{type:[String,Array,Function],default:"value"},itemChildren:{type:[Boolean,String,Array,Function],default:"children"},itemProps:{type:[Boolean,String,Array,Function],default:"props"},returnObject:Boolean,valueComparator:{type:Function,default:deepEqual$2}},"list-items");function isPrimitive(n){return typeof n=="string"||typeof n=="number"||typeof n=="boolean"}function transformItem(n,r){const _=getPropertyFromItem(r,n.itemType,"item"),E=isPrimitive(r)?r:getPropertyFromItem(r,n.itemTitle),S=getPropertyFromItem(r,n.itemValue,void 0),C=getPropertyFromItem(r,n.itemChildren),A=n.itemProps===!0?omit(r,["children"]):getPropertyFromItem(r,n.itemProps),I={title:E,value:S,...A};return{type:_,title:I.title,value:I.value,props:I,children:_==="item"&&C?transformItems(n,C):void 0,raw:r}}function transformItems(n,r){const _=[];for(const E of r)_.push(transformItem(n,E));return _}function useListItems(n){return{items:computed(()=>transformItems(n,n.items))}}const makeVListProps=propsFactory({baseColor:String,activeColor:String,activeClass:String,bgColor:String,disabled:Boolean,expandIcon:String,collapseIcon:String,lines:{type:[Boolean,String],default:"one"},slim:Boolean,nav:Boolean,...makeNestedProps({selectStrategy:"single-leaf",openStrategy:"list"}),...makeBorderProps(),...makeComponentProps(),...makeDensityProps(),...makeDimensionProps(),...makeElevationProps(),itemType:{type:String,default:"type"},...makeItemsProps(),...makeRoundedProps(),...makeTagProps(),...makeThemeProps(),...makeVariantProps({variant:"text"})},"VList"),VList=genericComponent()({name:"VList",props:makeVListProps(),emits:{"update:selected":n=>!0,"update:activated":n=>!0,"update:opened":n=>!0,"click:open":n=>!0,"click:activate":n=>!0,"click:select":n=>!0},setup(n,r){let{slots:_}=r;const{items:E}=useListItems(n),{themeClasses:S}=provideTheme(n),{backgroundColorClasses:C,backgroundColorStyles:A}=useBackgroundColor(toRef(n,"bgColor")),{borderClasses:I}=useBorder(n),{densityClasses:B}=useDensity(n),{dimensionStyles:O}=useDimension(n),{elevationClasses:N}=useElevation(n),{roundedClasses:U}=useRounded(n),{children:j,open:z,parents:Z,select:X}=useNested(n),Q=computed(()=>n.lines?`v-list--${n.lines}-line`:void 0),se=toRef(n,"activeColor"),oe=toRef(n,"baseColor"),ue=toRef(n,"color");createList(),provideDefaults({VListGroup:{activeColor:se,baseColor:oe,color:ue,expandIcon:toRef(n,"expandIcon"),collapseIcon:toRef(n,"collapseIcon")},VListItem:{activeClass:toRef(n,"activeClass"),activeColor:se,baseColor:oe,color:ue,density:toRef(n,"density"),disabled:toRef(n,"disabled"),lines:toRef(n,"lines"),nav:toRef(n,"nav"),slim:toRef(n,"slim"),variant:toRef(n,"variant")}});const we=shallowRef(!1),Te=ref$2();function xe(Ee){we.value=!0}function Re(Ee){we.value=!1}function Ne(Ee){!we.value&&!(Ee.relatedTarget&&Te.value?.contains(Ee.relatedTarget))&&nt()}function Fe(Ee){if(Te.value){if(Ee.key==="ArrowDown")nt("next");else if(Ee.key==="ArrowUp")nt("prev");else if(Ee.key==="Home")nt("first");else if(Ee.key==="End")nt("last");else return;Ee.preventDefault()}}function ht(Ee){we.value=!0}function nt(Ee){if(Te.value)return focusChild(Te.value,Ee)}return useRender(()=>createVNode(n.tag,{ref:Te,class:["v-list",{"v-list--disabled":n.disabled,"v-list--nav":n.nav,"v-list--slim":n.slim},S.value,C.value,I.value,B.value,N.value,Q.value,U.value,n.class],style:[A.value,O.value,n.style],tabindex:n.disabled||we.value?-1:0,role:"listbox","aria-activedescendant":void 0,onFocusin:xe,onFocusout:Re,onFocus:Ne,onKeydown:Fe,onMousedown:ht},{default:()=>[createVNode(VListChildren,{items:E.value,returnObject:n.returnObject},_)]})),{open:z,select:X,focus:nt,children:j,parents:Z}}}),_sfc_main$e=defineComponent$1({__name:"ItemLangueProgrs",props:{code:{},selectionnee:{type:Boolean}},setup(n){const r=n,{__:_,__:E}=_(),{_:S}=_({}),{_:C}=E({:r.code,:""}),A=computed(()=>(C.value?.||0)/(C.value?.||0)),I=S(r.code);return(B,O)=>(openBlock(),createBlock(VListItem,null,{prepend:withCtx(()=>[B.selectionnee?(openBlock(),createBlock(VIcon,{key:0,color:"primary"},{default:withCtx(()=>[createTextVNode(" mdi-check-bold ")]),_:1})):createCommentVNode("",!0)]),title:withCtx(()=>[createTextVNode(toDisplayString(unref(I)||B.code),1)]),append:withCtx(()=>[A.value===1?(openBlock(),createBlock(VIcon,{key:0,color:"primary"},{default:withCtx(()=>[createTextVNode(" mdi-check-circle ")]),_:1})):(openBlock(),createBlock(VProgressCircular,{key:1,"model-value":A.value*100,size:"20",color:"primary"},null,8,["model-value"]))]),_:1}))}});function elementToViewport(n,r){return{x:n.x+r.x,y:n.y+r.y}}function getOffset(n,r){return{x:n.x-r.x,y:n.y-r.y}}function anchorToPoint(n,r){if(n.side==="top"||n.side==="bottom"){const{side:_,align:E}=n,S=E==="left"?0:E==="center"?r.width/2:E==="right"?r.width:E,C=_==="top"?0:_==="bottom"?r.height:_;return elementToViewport({x:S,y:C},r)}else if(n.side==="left"||n.side==="right"){const{side:_,align:E}=n,S=_==="left"?0:_==="right"?r.width:_,C=E==="top"?0:E==="center"?r.height/2:E==="bottom"?r.height:E;return elementToViewport({x:S,y:C},r)}return elementToViewport({x:r.width/2,y:r.height/2},r)}const locationStrategies={static:staticLocationStrategy,connected:connectedLocationStrategy},makeLocationStrategyProps=propsFactory({locationStrategy:{type:[String,Function],default:"static",validator:n=>typeof n=="function"||n in locationStrategies},location:{type:String,default:"bottom"},origin:{type:String,default:"auto"},offset:[Number,String,Array]},"VOverlay-location-strategies");function useLocationStrategies(n,r){const _=ref$2({}),E=ref$2();IN_BROWSER&&useToggleScope(()=>!!(r.isActive.value&&n.locationStrategy),C=>{watch(()=>n.locationStrategy,C),onScopeDispose(()=>{window.removeEventListener("resize",S),E.value=void 0}),window.addEventListener("resize",S,{passive:!0}),typeof n.locationStrategy=="function"?E.value=n.locationStrategy(r,n,_)?.updateLocation:E.value=locationStrategies[n.locationStrategy](r,n,_)?.updateLocation});function S(C){E.value?.(C)}return{contentStyles:_,updateLocation:E}}function staticLocationStrategy(){}function getIntrinsicSize(n,r){r?n.style.removeProperty("left"):n.style.removeProperty("right");const _=nullifyTransforms(n);return r?_.x+=parseFloat(n.style.right||0):_.x-=parseFloat(n.style.left||0),_.y-=parseFloat(n.style.top||0),_}function connectedLocationStrategy(n,r,_){(Array.isArray(n.target.value)||isFixedPosition(n.target.value))&&Object.assign(_.value,{position:"fixed",top:0,[n.isRtl.value?"right":"left"]:0});const{preferredAnchor:S,preferredOrigin:C}=destructComputed(()=>{const Z=parseAnchor(r.location,n.isRtl.value),X=r.origin==="overlap"?Z:r.origin==="auto"?flipSide(Z):parseAnchor(r.origin,n.isRtl.value);return Z.side===X.side&&Z.align===flipAlign(X).align?{preferredAnchor:flipCorner(Z),preferredOrigin:flipCorner(X)}:{preferredAnchor:Z,preferredOrigin:X}}),[A,I,B,O]=["minWidth","minHeight","maxWidth","maxHeight"].map(Z=>computed(()=>{const X=parseFloat(r[Z]);return isNaN(X)?1/0:X})),N=computed(()=>{if(Array.isArray(r.offset))return r.offset;if(typeof r.offset=="string"){const Z=r.offset.split(" ").map(parseFloat);return Z.length<2&&Z.push(0),Z}return typeof r.offset=="number"?[r.offset,0]:[0,0]});let U=!1;const j=new ResizeObserver(()=>{U&&z()});watch([n.target,n.contentEl],(Z,X)=>{let[Q,se]=Z,[oe,ue]=X;oe&&!Array.isArray(oe)&&j.unobserve(oe),Q&&!Array.isArray(Q)&&j.observe(Q),ue&&j.unobserve(ue),se&&j.observe(se)},{immediate:!0}),onScopeDispose(()=>{j.disconnect()});function z(){if(U=!1,requestAnimationFrame(()=>U=!0),!n.target.value||!n.contentEl.value)return;const Z=getTargetBox(n.target.value),X=getIntrinsicSize(n.contentEl.value,n.isRtl.value),Q=getScrollParents(n.contentEl.value),se=12;Q.length||(Q.push(document.documentElement),n.contentEl.value.style.top&&n.contentEl.value.style.left||(X.x-=parseFloat(document.documentElement.style.getPropertyValue("--v-body-scroll-x")||0),X.y-=parseFloat(document.documentElement.style.getPropertyValue("--v-body-scroll-y")||0)));const oe=Q.reduce((nt,Ee)=>{const Ce=Ee.getBoundingClientRect(),_e=new Box({x:Ee===document.documentElement?0:Ce.x,y:Ee===document.documentElement?0:Ce.y,width:Ee.clientWidth,height:Ee.clientHeight});return nt?new Box({x:Math.max(nt.left,_e.left),y:Math.max(nt.top,_e.top),width:Math.min(nt.right,_e.right)-Math.max(nt.left,_e.left),height:Math.min(nt.bottom,_e.bottom)-Math.max(nt.top,_e.top)}):_e},void 0);oe.x+=se,oe.y+=se,oe.width-=se*2,oe.height-=se*2;let ue={anchor:S.value,origin:C.value};function we(nt){const Ee=new Box(X),Ce=anchorToPoint(nt.anchor,Z),_e=anchorToPoint(nt.origin,Ee);let{x:Ie,y:He}=getOffset(Ce,_e);switch(nt.anchor.side){case"top":He-=N.value[0];break;case"bottom":He+=N.value[0];break;case"left":Ie-=N.value[0];break;case"right":Ie+=N.value[0];break}switch(nt.anchor.align){case"top":He-=N.value[1];break;case"bottom":He+=N.value[1];break;case"left":Ie-=N.value[1];break;case"right":Ie+=N.value[1];break}return Ee.x+=Ie,Ee.y+=He,Ee.width=Math.min(Ee.width,B.value),Ee.height=Math.min(Ee.height,O.value),{overflows:getOverflow(Ee,oe),x:Ie,y:He}}let Te=0,xe=0;const Re={x:0,y:0},Ne={x:!1,y:!1};let Fe=-1;for(;!(Fe++>10);){const{x:nt,y:Ee,overflows:Ce}=we(ue);Te+=nt,xe+=Ee,X.x+=nt,X.y+=Ee;{const _e=getAxis(ue.anchor),Ie=Ce.x.before||Ce.x.after,He=Ce.y.before||Ce.y.after;let Be=!1;if(["x","y"].forEach(Ge=>{if(Ge==="x"&&Ie&&!Ne.x||Ge==="y"&&He&&!Ne.y){const je={anchor:{...ue.anchor},origin:{...ue.origin}},Ve=Ge==="x"?_e==="y"?flipAlign:flipSide:_e==="y"?flipSide:flipAlign;je.anchor=Ve(je.anchor),je.origin=Ve(je.origin);const{overflows:Pe}=we(je);(Pe[Ge].before<=Ce[Ge].before&&Pe[Ge].after<=Ce[Ge].after||Pe[Ge].before+Pe[Ge].after<(Ce[Ge].before+Ce[Ge].after)/2)&&(ue=je,Be=Ne[Ge]=!0)}}),Be)continue}Ce.x.before&&(Te+=Ce.x.before,X.x+=Ce.x.before),Ce.x.after&&(Te-=Ce.x.after,X.x-=Ce.x.after),Ce.y.before&&(xe+=Ce.y.before,X.y+=Ce.y.before),Ce.y.after&&(xe-=Ce.y.after,X.y-=Ce.y.after);{const _e=getOverflow(X,oe);Re.x=oe.width-_e.x.before-_e.x.after,Re.y=oe.height-_e.y.before-_e.y.after,Te+=_e.x.before,X.x+=_e.x.before,xe+=_e.y.before,X.y+=_e.y.before}break}const ht=getAxis(ue.anchor);return Object.assign(_.value,{"--v-overlay-anchor-origin":`${ue.anchor.side} ${ue.anchor.align}`,transformOrigin:`${ue.origin.side} ${ue.origin.align}`,top:convertToUnit(pixelRound(xe)),left:n.isRtl.value?void 0:convertToUnit(pixelRound(Te)),right:n.isRtl.value?convertToUnit(pixelRound(-Te)):void 0,minWidth:convertToUnit(ht==="y"?Math.min(A.value,Z.width):A.value),maxWidth:convertToUnit(pixelCeil(clamp(Re.x,A.value===1/0?0:A.value,B.value))),maxHeight:convertToUnit(pixelCeil(clamp(Re.y,I.value===1/0?0:I.value,O.value)))}),{available:Re,contentBox:X}}return watch(()=>[S.value,C.value,r.offset,r.minWidth,r.minHeight,r.maxWidth,r.maxHeight],()=>z()),nextTick$3(()=>{const Z=z();if(!Z)return;const{available:X,contentBox:Q}=Z;Q.height>X.y&&requestAnimationFrame(()=>{z(),requestAnimationFrame(()=>{z()})})}),{updateLocation:z}}function pixelRound(n){return Math.round(n*devicePixelRatio)/devicePixelRatio}function pixelCeil(n){return Math.ceil(n*devicePixelRatio)/devicePixelRatio}let clean$2=!0;const frames=[];function requestNewFrame(n){!clean$2||frames.length?(frames.push(n),run()):(clean$2=!1,n(),run())}let raf=-1;function run(){cancelAnimationFrame(raf),raf=requestAnimationFrame(()=>{const n=frames.shift();n&&n(),frames.length?run():clean$2=!0})}const scrollStrategies={none:null,close:closeScrollStrategy,block:blockScrollStrategy,reposition:repositionScrollStrategy},makeScrollStrategyProps=propsFactory({scrollStrategy:{type:[String,Function],default:"block",validator:n=>typeof n=="function"||n in scrollStrategies}},"VOverlay-scroll-strategies");function useScrollStrategies(n,r){if(!IN_BROWSER)return;let _;watchEffect(async()=>{_?.stop(),r.isActive.value&&n.scrollStrategy&&(_=effectScope(),await nextTick$3(),_.active&&_.run(()=>{typeof n.scrollStrategy=="function"?n.scrollStrategy(r,n,_):scrollStrategies[n.scrollStrategy]?.(r,n,_)}))}),onScopeDispose(()=>{_?.stop()})}function closeScrollStrategy(n){function r(_){n.isActive.value=!1}bindScroll(n.targetEl.value??n.contentEl.value,r)}function blockScrollStrategy(n,r){const _=n.root.value?.offsetParent,E=[...new Set([...getScrollParents(n.targetEl.value,r.contained?_:void 0),...getScrollParents(n.contentEl.value,r.contained?_:void 0)])].filter(A=>!A.classList.contains("v-overlay-scroll-blocked")),S=window.innerWidth-document.documentElement.offsetWidth,C=(A=>hasScrollbar(A)&&A)(_||document.documentElement);C&&n.root.value.classList.add("v-overlay--scroll-blocked"),E.forEach((A,I)=>{A.style.setProperty("--v-body-scroll-x",convertToUnit(-A.scrollLeft)),A.style.setProperty("--v-body-scroll-y",convertToUnit(-A.scrollTop)),A!==document.documentElement&&A.style.setProperty("--v-scrollbar-offset",convertToUnit(S)),A.classList.add("v-overlay-scroll-blocked")}),onScopeDispose(()=>{E.forEach((A,I)=>{const B=parseFloat(A.style.getPropertyValue("--v-body-scroll-x")),O=parseFloat(A.style.getPropertyValue("--v-body-scroll-y")),N=A.style.scrollBehavior;A.style.scrollBehavior="auto",A.style.removeProperty("--v-body-scroll-x"),A.style.removeProperty("--v-body-scroll-y"),A.style.removeProperty("--v-scrollbar-offset"),A.classList.remove("v-overlay-scroll-blocked"),A.scrollLeft=-B,A.scrollTop=-O,A.style.scrollBehavior=N}),C&&n.root.value.classList.remove("v-overlay--scroll-blocked")})}function repositionScrollStrategy(n,r,_){let E=!1,S=-1,C=-1;function A(I){requestNewFrame(()=>{const B=performance.now();n.updateLocation.value?.(I),E=(performance.now()-B)/(1e3/60)>2})}C=(typeof requestIdleCallback>"u"?I=>I():requestIdleCallback)(()=>{_.run(()=>{bindScroll(n.targetEl.value??n.contentEl.value,I=>{E?(cancelAnimationFrame(S),S=requestAnimationFrame(()=>{S=requestAnimationFrame(()=>{A(I)})})):A(I)})})}),onScopeDispose(()=>{typeof cancelIdleCallback<"u"&&cancelIdleCallback(C),cancelAnimationFrame(S)})}function bindScroll(n,r){const _=[document,...getScrollParents(n)];_.forEach(E=>{E.addEventListener("scroll",r,{passive:!0})}),onScopeDispose(()=>{_.forEach(E=>{E.removeEventListener("scroll",r)})})}const VMenuSymbol=Symbol.for("vuetify:v-menu"),makeDelayProps=propsFactory({closeDelay:[Number,String],openDelay:[Number,String]},"delay");function useDelay(n,r){let _=()=>{};function E(A){_?.();const I=Number(A?n.openDelay:n.closeDelay);return new Promise(B=>{_=defer(I,()=>{r?.(A),B(A)})})}function S(){return E(!0)}function C(){return E(!1)}return{clearDelay:_,runOpenDelay:S,runCloseDelay:C}}const makeActivatorProps=propsFactory({target:[String,Object],activator:[String,Object],activatorProps:{type:Object,default:()=>({})},openOnClick:{type:Boolean,default:void 0},openOnHover:Boolean,openOnFocus:{type:Boolean,default:void 0},closeOnContentClick:Boolean,...makeDelayProps()},"VOverlay-activator");function useActivator(n,r){let{isActive:_,isTop:E}=r;const S=getCurrentInstance("useActivator"),C=ref$2();let A=!1,I=!1,B=!0;const O=computed(()=>n.openOnFocus||n.openOnFocus==null&&n.openOnHover),N=computed(()=>n.openOnClick||n.openOnClick==null&&!n.openOnHover&&!O.value),{runOpenDelay:U,runCloseDelay:j}=useDelay(n,Re=>{Re===(n.openOnHover&&A||O.value&&I)&&!(n.openOnHover&&_.value&&!E.value)&&(_.value!==Re&&(B=!0),_.value=Re)}),z=ref$2(),Z={onClick:Re=>{Re.stopPropagation(),C.value=Re.currentTarget||Re.target,_.value||(z.value=[Re.clientX,Re.clientY]),_.value=!_.value},onMouseenter:Re=>{Re.sourceCapabilities?.firesTouchEvents||(A=!0,C.value=Re.currentTarget||Re.target,U())},onMouseleave:Re=>{A=!1,j()},onFocus:Re=>{matchesSelector(Re.target,":focus-visible")!==!1&&(I=!0,Re.stopPropagation(),C.value=Re.currentTarget||Re.target,U())},onBlur:Re=>{I=!1,Re.stopPropagation(),j()}},X=computed(()=>{const Re={};return N.value&&(Re.onClick=Z.onClick),n.openOnHover&&(Re.onMouseenter=Z.onMouseenter,Re.onMouseleave=Z.onMouseleave),O.value&&(Re.onFocus=Z.onFocus,Re.onBlur=Z.onBlur),Re}),Q=computed(()=>{const Re={};if(n.openOnHover&&(Re.onMouseenter=()=>{A=!0,U()},Re.onMouseleave=()=>{A=!1,j()}),O.value&&(Re.onFocusin=()=>{I=!0,U()},Re.onFocusout=()=>{I=!1,j()}),n.closeOnContentClick){const Ne=inject$1(VMenuSymbol,null);Re.onClick=()=>{_.value=!1,Ne?.closeParents()}}return Re}),se=computed(()=>{const Re={};return n.openOnHover&&(Re.onMouseenter=()=>{B&&(A=!0,B=!1,U())},Re.onMouseleave=()=>{A=!1,j()}),Re});watch(E,Re=>{Re&&(n.openOnHover&&!A&&(!O.value||!I)||O.value&&!I&&(!n.openOnHover||!A))&&(_.value=!1)}),watch(_,Re=>{Re||setTimeout(()=>{z.value=void 0})},{flush:"post"});const oe=ref$2();watchEffect(()=>{oe.value&&nextTick$3(()=>{C.value=refElement(oe.value)})});const ue=ref$2(),we=computed(()=>n.target==="cursor"&&z.value?z.value:ue.value?refElement(ue.value):getTarget(n.target,S)||C.value),Te=computed(()=>Array.isArray(we.value)?void 0:we.value);let xe;return watch(()=>!!n.activator,Re=>{Re&&IN_BROWSER?(xe=effectScope(),xe.run(()=>{_useActivator(n,S,{activatorEl:C,activatorEvents:X})})):xe&&xe.stop()},{flush:"post",immediate:!0}),onScopeDispose(()=>{xe?.stop()}),{activatorEl:C,activatorRef:oe,target:we,targetEl:Te,targetRef:ue,activatorEvents:X,contentEvents:Q,scrimEvents:se}}function _useActivator(n,r,_){let{activatorEl:E,activatorEvents:S}=_;watch(()=>n.activator,(B,O)=>{if(O&&B!==O){const N=I(O);N&&A(N)}B&&nextTick$3(()=>C())},{immediate:!0}),watch(()=>n.activatorProps,()=>{C()}),onScopeDispose(()=>{A()});function C(){let B=arguments.length>0&&arguments[0]!==void 0?arguments[0]:I(),O=arguments.length>1&&arguments[1]!==void 0?arguments[1]:n.activatorProps;B&&bindProps(B,mergeProps(S.value,O))}function A(){let B=arguments.length>0&&arguments[0]!==void 0?arguments[0]:I(),O=arguments.length>1&&arguments[1]!==void 0?arguments[1]:n.activatorProps;B&&unbindProps(B,mergeProps(S.value,O))}function I(){let B=arguments.length>0&&arguments[0]!==void 0?arguments[0]:n.activator;const O=getTarget(B,r);return E.value=O?.nodeType===Node.ELEMENT_NODE?O:void 0,E.value}}function getTarget(n,r){if(!n)return;let _;if(n==="parent"){let E=r?.proxy?.$el?.parentNode;for(;E?.hasAttribute("data-no-activator");)E=E.parentNode;_=E}else typeof n=="string"?_=document.querySelector(n):"$el"in n?_=n.$el:_=n;return _}function useHydration(){if(!IN_BROWSER)return shallowRef(!1);const{ssr:n}=useDisplay();if(n){const r=shallowRef(!1);return onMounted(()=>{r.value=!0}),r}else return shallowRef(!0)}function useScopeId(){const r=getCurrentInstance("useScopeId").vnode.scopeId;return{scopeId:r?{[r]:""}:void 0}}const StackSymbol=Symbol.for("vuetify:stack"),globalStack=reactive([]);function useStack(n,r,_){const E=getCurrentInstance("useStack"),S=!_,C=inject$1(StackSymbol,void 0),A=reactive({activeChildren:new Set});provide(StackSymbol,A);const I=shallowRef(+r.value);useToggleScope(n,()=>{const N=globalStack.at(-1)?.[1];I.value=N?N+10:+r.value,S&&globalStack.push([E.uid,I.value]),C?.activeChildren.add(E.uid),onScopeDispose(()=>{if(S){const U=toRaw(globalStack).findIndex(j=>j[0]===E.uid);globalStack.splice(U,1)}C?.activeChildren.delete(E.uid)})});const B=shallowRef(!0);S&&watchEffect(()=>{const N=globalStack.at(-1)?.[0]===E.uid;setTimeout(()=>B.value=N)});const O=computed(()=>!A.activeChildren.size);return{globalTop:readonly$3(B),localTop:O,stackStyles:computed(()=>({zIndex:I.value}))}}function useTeleport(n){return{teleportTarget:computed(()=>{const _=n.value;if(_===!0||!IN_BROWSER)return;const E=_===!1?document.body:typeof _=="string"?document.querySelector(_):_;if(E==null)return;let S=E.querySelector(":scope > .v-overlay-container");return S||(S=document.createElement("div"),S.className="v-overlay-container",E.appendChild(S)),S})}}function defaultConditional(){return!0}function checkEvent(n,r,_){if(!n||checkIsActive(n,_)===!1)return!1;const E=attachedRoot(r);if(typeof ShadowRoot<"u"&&E instanceof ShadowRoot&&E.host===n.target)return!1;const S=(typeof _.value=="object"&&_.value.include||(()=>[]))();return S.push(r),!S.some(C=>C?.contains(n.target))}function checkIsActive(n,r){return(typeof r.value=="object"&&r.value.closeConditional||defaultConditional)(n)}function directive(n,r,_){const E=typeof _.value=="function"?_.value:_.value.handler;r._clickOutside.lastMousedownWasOutside&&checkEvent(n,r,_)&&setTimeout(()=>{checkIsActive(n,_)&&E&&E(n)},0)}function handleShadow(n,r){const _=attachedRoot(n);r(document),typeof ShadowRoot<"u"&&_ instanceof ShadowRoot&&r(_)}const ClickOutside={mounted(n,r){const _=S=>directive(S,n,r),E=S=>{n._clickOutside.lastMousedownWasOutside=checkEvent(S,n,r)};handleShadow(n,S=>{S.addEventListener("click",_,!0),S.addEventListener("mousedown",E,!0)}),n._clickOutside||(n._clickOutside={lastMousedownWasOutside:!1}),n._clickOutside[r.instance.$.uid]={onClick:_,onMousedown:E}},unmounted(n,r){n._clickOutside&&(handleShadow(n,_=>{if(!_||!n._clickOutside?.[r.instance.$.uid])return;const{onClick:E,onMousedown:S}=n._clickOutside[r.instance.$.uid];_.removeEventListener("click",E,!0),_.removeEventListener("mousedown",S,!0)}),delete n._clickOutside[r.instance.$.uid])}};function Scrim(n){const{modelValue:r,color:_,...E}=n;return createVNode(Transition$1,{name:"fade-transition",appear:!0},{default:()=>[n.modelValue&&createVNode("div",mergeProps({class:["v-overlay__scrim",n.color.backgroundColorClasses.value],style:n.color.backgroundColorStyles.value},E),null)]})}const makeVOverlayProps=propsFactory({absolute:Boolean,attach:[Boolean,String,Object],closeOnBack:{type:Boolean,default:!0},contained:Boolean,contentClass:null,contentProps:null,disabled:Boolean,opacity:[Number,String],noClickAnimation:Boolean,modelValue:Boolean,persistent:Boolean,scrim:{type:[Boolean,String],default:!0},zIndex:{type:[Number,String],default:2e3},...makeActivatorProps(),...makeComponentProps(),...makeDimensionProps(),...makeLazyProps(),...makeLocationStrategyProps(),...makeScrollStrategyProps(),...makeThemeProps(),...makeTransitionProps$1()},"VOverlay"),VOverlay=genericComponent()({name:"VOverlay",directives:{ClickOutside},inheritAttrs:!1,props:{_disableGlobalStack:Boolean,...makeVOverlayProps()},emits:{"click:outside":n=>!0,"update:modelValue":n=>!0,afterLeave:()=>!0},setup(n,r){let{slots:_,attrs:E,emit:S}=r;const C=useProxiedModel(n,"modelValue"),A=computed({get:()=>C.value,set:tt=>{tt&&n.disabled||(C.value=tt)}}),{teleportTarget:I}=useTeleport(computed(()=>n.attach||n.contained)),{themeClasses:B}=provideTheme(n),{rtlClasses:O,isRtl:N}=useRtl(),{hasContent:U,onAfterLeave:j}=useLazy(n,A),z=useBackgroundColor(computed(()=>typeof n.scrim=="string"?n.scrim:null)),{globalTop:Z,localTop:X,stackStyles:Q}=useStack(A,toRef(n,"zIndex"),n._disableGlobalStack),{activatorEl:se,activatorRef:oe,target:ue,targetEl:we,targetRef:Te,activatorEvents:xe,contentEvents:Re,scrimEvents:Ne}=useActivator(n,{isActive:A,isTop:X}),{dimensionStyles:Fe}=useDimension(n),ht=useHydration(),{scopeId:nt}=useScopeId();watch(()=>n.disabled,tt=>{tt&&(A.value=!1)});const Ee=ref$2(),Ce=ref$2(),{contentStyles:_e,updateLocation:Ie}=useLocationStrategies(n,{isRtl:N,contentEl:Ce,target:ue,isActive:A});useScrollStrategies(n,{root:Ee,contentEl:Ce,targetEl:we,isActive:A,updateLocation:Ie});function He(tt){S("click:outside",tt),n.persistent?Pe():A.value=!1}function Be(){return A.value&&Z.value}IN_BROWSER&&watch(A,tt=>{tt?window.addEventListener("keydown",Ge):window.removeEventListener("keydown",Ge)},{immediate:!0}),onBeforeUnmount(()=>{IN_BROWSER&&window.removeEventListener("keydown",Ge)});function Ge(tt){tt.key==="Escape"&&Z.value&&(n.persistent?Pe():(A.value=!1,Ce.value?.contains(document.activeElement)&&se.value?.focus()))}const je=useRouter();useToggleScope(()=>n.closeOnBack,()=>{useBackButton(je,tt=>{Z.value&&A.value?(tt(!1),n.persistent?Pe():A.value=!1):tt()})});const Ve=ref$2();watch(()=>A.value&&(n.absolute||n.contained)&&I.value==null,tt=>{if(tt){const Ke=getScrollParent(Ee.value);Ke&&Ke!==document.scrollingElement&&(Ve.value=Ke.scrollTop)}});function Pe(){n.noClickAnimation||Ce.value&&animate(Ce.value,[{transformOrigin:"center"},{transform:"scale(1.03)"},{transformOrigin:"center"}],{duration:150,easing:standardEasing})}function Me(){j(),S("afterLeave")}return useRender(()=>createVNode(Fragment,null,[_.activator?.({isActive:A.value,props:mergeProps({ref:oe,targetRef:Te},xe.value,n.activatorProps)}),ht.value&&U.value&&createVNode(Teleport,{disabled:!I.value,to:I.value},{default:()=>[createVNode("div",mergeProps({class:["v-overlay",{"v-overlay--absolute":n.absolute||n.contained,"v-overlay--active":A.value,"v-overlay--contained":n.contained},B.value,O.value,n.class],style:[Q.value,{"--v-overlay-opacity":n.opacity,top:convertToUnit(Ve.value)},n.style],ref:Ee},nt,E),[createVNode(Scrim,mergeProps({color:z,modelValue:A.value&&!!n.scrim},Ne.value),null),createVNode(MaybeTransition,{appear:!0,persisted:!0,transition:n.transition,target:ue.value,onAfterLeave:Me},{default:()=>[withDirectives(createVNode("div",mergeProps({ref:Ce,class:["v-overlay__content",n.contentClass],style:[Fe.value,_e.value]},Re.value,n.contentProps),[_.default?.({isActive:A})]),[[vShow,A.value],[resolveDirective("click-outside"),{handler:He,closeConditional:Be,include:()=>[se.value]}]])]})])]})])),{activatorEl:se,target:ue,animateClick:Pe,contentEl:Ce,globalTop:Z,localTop:X,updateLocation:Ie}}}),Refs=Symbol("Forwarded refs");function getDescriptor(n,r){let _=n;for(;_;){const E=Reflect.getOwnPropertyDescriptor(_,r);if(E)return E;_=Object.getPrototypeOf(_)}}function forwardRefs(n){for(var r=arguments.length,_=new Array(r>1?r-1:0),E=1;E<r;E++)_[E-1]=arguments[E];return n[Refs]=_,new Proxy(n,{get(S,C){if(Reflect.has(S,C))return Reflect.get(S,C);if(!(typeof C=="symbol"||C.startsWith("$")||C.startsWith("__"))){for(const A of _)if(A.value&&Reflect.has(A.value,C)){const I=Reflect.get(A.value,C);return typeof I=="function"?I.bind(A.value):I}}},has(S,C){if(Reflect.has(S,C))return!0;if(typeof C=="symbol"||C.startsWith("$")||C.startsWith("__"))return!1;for(const A of _)if(A.value&&Reflect.has(A.value,C))return!0;return!1},set(S,C,A){if(Reflect.has(S,C))return Reflect.set(S,C,A);if(typeof C=="symbol"||C.startsWith("$")||C.startsWith("__"))return!1;for(const I of _)if(I.value&&Reflect.has(I.value,C))return Reflect.set(I.value,C,A);return!1},getOwnPropertyDescriptor(S,C){const A=Reflect.getOwnPropertyDescriptor(S,C);if(A)return A;if(!(typeof C=="symbol"||C.startsWith("$")||C.startsWith("__"))){for(const I of _){if(!I.value)continue;const B=getDescriptor(I.value,C)??("_"in I.value?getDescriptor(I.value._?.setupState,C):void 0);if(B)return B}for(const I of _){const B=I.value&&I.value[Refs];if(!B)continue;const O=B.slice();for(;O.length;){const N=O.shift(),U=getDescriptor(N.value,C);if(U)return U;const j=N.value&&N.value[Refs];j&&O.push(...j)}}}}})}const makeVMenuProps=propsFactory({id:String,...omit(makeVOverlayProps({closeDelay:250,closeOnContentClick:!0,locationStrategy:"connected",openDelay:300,scrim:!1,scrollStrategy:"reposition",transition:{component:VDialogTransition}}),["absolute"])},"VMenu"),VMenu=genericComponent()({name:"VMenu",props:makeVMenuProps(),emits:{"update:modelValue":n=>!0},setup(n,r){let{slots:_}=r;const E=useProxiedModel(n,"modelValue"),{scopeId:S}=useScopeId(),C=getUid(),A=computed(()=>n.id||`v-menu-${C}`),I=ref$2(),B=inject$1(VMenuSymbol,null),O=shallowRef(0);provide(VMenuSymbol,{register(){++O.value},unregister(){--O.value},closeParents(X){setTimeout(()=>{!O.value&&(X==null||X&&!isClickInsideElement(X,I.value.contentEl))&&(E.value=!1,B?.closeParents())},40)}});async function N(X){const Q=X.relatedTarget,se=X.target;await nextTick$3(),E.value&&Q!==se&&I.value?.contentEl&&I.value?.globalTop&&![document,I.value.contentEl].includes(se)&&!I.value.contentEl.contains(se)&&focusableChildren(I.value.contentEl)[0]?.focus()}watch(E,X=>{X?(B?.register(),document.addEventListener("focusin",N,{once:!0})):(B?.unregister(),document.removeEventListener("focusin",N))});function U(X){B?.closeParents(X)}function j(X){n.disabled||X.key==="Tab"&&(getNextElement(focusableChildren(I.value?.contentEl,!1),X.shiftKey?"prev":"next",se=>se.tabIndex>=0)||(E.value=!1,I.value?.activatorEl?.focus()))}function z(X){if(n.disabled)return;const Q=I.value?.contentEl;Q&&E.value?X.key==="ArrowDown"?(X.preventDefault(),focusChild(Q,"next")):X.key==="ArrowUp"&&(X.preventDefault(),focusChild(Q,"prev")):["ArrowDown","ArrowUp"].includes(X.key)&&(E.value=!0,X.preventDefault(),setTimeout(()=>setTimeout(()=>z(X))))}const Z=computed(()=>mergeProps({"aria-haspopup":"menu","aria-expanded":String(E.value),"aria-owns":A.value,onKeydown:z},n.activatorProps));return useRender(()=>{const X=VOverlay.filterProps(n);return createVNode(VOverlay,mergeProps({ref:I,id:A.value,class:["v-menu",n.class],style:n.style},X,{modelValue:E.value,"onUpdate:modelValue":Q=>E.value=Q,absolute:!0,activatorProps:Z.value,"onClick:outside":U,onKeydown:j},S),{activator:_.activator,default:function(){for(var Q=arguments.length,se=new Array(Q),oe=0;oe<Q;oe++)se[oe]=arguments[oe];return createVNode(VDefaultsProvider,{root:"VMenu"},{default:()=>[_.default?.(...se)]})}})}),forwardRefs({id:A,openChildren:O},I)}}),makeVCounterProps=propsFactory({active:Boolean,max:[Number,String],value:{type:[Number,String],default:0},...makeComponentProps(),...makeTransitionProps$1({transition:{component:VSlideYTransition}})},"VCounter"),VCounter=genericComponent()({name:"VCounter",functional:!0,props:makeVCounterProps(),setup(n,r){let{slots:_}=r;const E=computed(()=>n.max?`${n.value} / ${n.max}`:String(n.value));return useRender(()=>createVNode(MaybeTransition,{transition:n.transition},{default:()=>[withDirectives(createVNode("div",{class:["v-counter",n.class],style:n.style},[_.default?_.default({counter:E.value,max:n.max,value:n.value}):E.value]),[[vShow,n.active]])]})),{}}}),makeVLabelProps=propsFactory({text:String,onClick:EventProp(),...makeComponentProps(),...makeThemeProps()},"VLabel"),VLabel=genericComponent()({name:"VLabel",props:makeVLabelProps(),setup(n,r){let{slots:_}=r;return useRender(()=>createVNode("label",{class:["v-label",{"v-label--clickable":!!n.onClick},n.class],style:n.style,onClick:n.onClick},[n.text,_.default?.()])),{}}}),makeVFieldLabelProps=propsFactory({floating:Boolean,...makeComponentProps()},"VFieldLabel"),VFieldLabel=genericComponent()({name:"VFieldLabel",props:makeVFieldLabelProps(),setup(n,r){let{slots:_}=r;return useRender(()=>createVNode(VLabel,{class:["v-field-label",{"v-field-label--floating":n.floating},n.class],style:n.style,"aria-hidden":n.floating||void 0},_)),{}}});function useInputIcon(n){const{t:r}=useLocale();function _(E){let{name:S}=E;const C={prepend:"prependAction",prependInner:"prependAction",append:"appendAction",appendInner:"appendAction",clear:"clear"}[S],A=n[`onClick:${S}`],I=A&&C?r(`$vuetify.input.${C}`,n.label??""):void 0;return createVNode(VIcon,{icon:n[`${S}Icon`],"aria-label":I,onClick:A},null)}return{InputIcon:_}}const makeFocusProps=propsFactory({focused:Boolean,"onUpdate:focused":EventProp()},"focus");function useFocus(n){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:getCurrentInstanceName();const _=useProxiedModel(n,"focused"),E=computed(()=>({[`${r}--focused`]:_.value}));function S(){_.value=!0}function C(){_.value=!1}return{focusClasses:E,isFocused:_,focus:S,blur:C}}const allowedVariants=["underlined","outlined","filled","solo","solo-inverted","solo-filled","plain"],makeVFieldProps=propsFactory({appendInnerIcon:IconValue,bgColor:String,clearable:Boolean,clearIcon:{type:IconValue,default:"$clear"},active:Boolean,centerAffix:{type:Boolean,default:void 0},color:String,baseColor:String,dirty:Boolean,disabled:{type:Boolean,default:null},error:Boolean,flat:Boolean,label:String,persistentClear:Boolean,prependInnerIcon:IconValue,reverse:Boolean,singleLine:Boolean,variant:{type:String,default:"filled",validator:n=>allowedVariants.includes(n)},"onClick:clear":EventProp(),"onClick:appendInner":EventProp(),"onClick:prependInner":EventProp(),...makeComponentProps(),...makeLoaderProps(),...makeRoundedProps(),...makeThemeProps()},"VField"),VField=genericComponent()({name:"VField",inheritAttrs:!1,props:{id:String,...makeFocusProps(),...makeVFieldProps()},emits:{"update:focused":n=>!0,"update:modelValue":n=>!0},setup(n,r){let{attrs:_,emit:E,slots:S}=r;const{themeClasses:C}=provideTheme(n),{loaderClasses:A}=useLoader(n),{focusClasses:I,isFocused:B,focus:O,blur:N}=useFocus(n),{InputIcon:U}=useInputIcon(n),{roundedClasses:j}=useRounded(n),{rtlClasses:z}=useRtl(),Z=computed(()=>n.dirty||n.active),X=computed(()=>!n.singleLine&&!!(n.label||S.label)),Q=getUid(),se=computed(()=>n.id||`input-${Q}`),oe=computed(()=>`${se.value}-messages`),ue=ref$2(),we=ref$2(),Te=ref$2(),xe=computed(()=>["plain","underlined"].includes(n.variant)),{backgroundColorClasses:Re,backgroundColorStyles:Ne}=useBackgroundColor(toRef(n,"bgColor")),{textColorClasses:Fe,textColorStyles:ht}=useTextColor(computed(()=>n.error||n.disabled?void 0:Z.value&&B.value?n.color:n.baseColor));watch(Z,Ce=>{if(X.value){const _e=ue.value.$el,Ie=we.value.$el;requestAnimationFrame(()=>{const He=nullifyTransforms(_e),Be=Ie.getBoundingClientRect(),Ge=Be.x-He.x,je=Be.y-He.y-(He.height/2-Be.height/2),Ve=Be.width/.75,Pe=Math.abs(Ve-He.width)>1?{maxWidth:convertToUnit(Ve)}:void 0,Me=getComputedStyle(_e),tt=getComputedStyle(Ie),Ke=parseFloat(Me.transitionDuration)*1e3||150,mt=parseFloat(tt.getPropertyValue("--v-field-label-scale")),ct=tt.getPropertyValue("color");_e.style.visibility="visible",Ie.style.visibility="hidden",animate(_e,{transform:`translate(${Ge}px, ${je}px) scale(${mt})`,color:ct,...Pe},{duration:Ke,easing:standardEasing,direction:Ce?"normal":"reverse"}).finished.then(()=>{_e.style.removeProperty("visibility"),Ie.style.removeProperty("visibility")})})}},{flush:"post"});const nt=computed(()=>({isActive:Z,isFocused:B,controlRef:Te,blur:N,focus:O}));function Ee(Ce){Ce.target!==document.activeElement&&Ce.preventDefault()}return useRender(()=>{const Ce=n.variant==="outlined",_e=S["prepend-inner"]||n.prependInnerIcon,Ie=!!(n.clearable||S.clear),He=!!(S["append-inner"]||n.appendInnerIcon||Ie),Be=()=>S.label?S.label({...nt.value,label:n.label,props:{for:se.value}}):n.label;return createVNode("div",mergeProps({class:["v-field",{"v-field--active":Z.value,"v-field--appended":He,"v-field--center-affix":n.centerAffix??!xe.value,"v-field--disabled":n.disabled,"v-field--dirty":n.dirty,"v-field--error":n.error,"v-field--flat":n.flat,"v-field--has-background":!!n.bgColor,"v-field--persistent-clear":n.persistentClear,"v-field--prepended":_e,"v-field--reverse":n.reverse,"v-field--single-line":n.singleLine,"v-field--no-label":!Be(),[`v-field--variant-${n.variant}`]:!0},C.value,Re.value,I.value,A.value,j.value,z.value,n.class],style:[Ne.value,n.style],onClick:Ee},_),[createVNode("div",{class:"v-field__overlay"},null),createVNode(LoaderSlot,{name:"v-field",active:!!n.loading,color:n.error?"error":typeof n.loading=="string"?n.loading:n.color},{default:S.loader}),_e&&createVNode("div",{key:"prepend",class:"v-field__prepend-inner"},[n.prependInnerIcon&&createVNode(U,{key:"prepend-icon",name:"prependInner"},null),S["prepend-inner"]?.(nt.value)]),createVNode("div",{class:"v-field__field","data-no-activator":""},[["filled","solo","solo-inverted","solo-filled"].includes(n.variant)&&X.value&&createVNode(VFieldLabel,{key:"floating-label",ref:we,class:[Fe.value],floating:!0,for:se.value,style:ht.value},{default:()=>[Be()]}),createVNode(VFieldLabel,{ref:ue,for:se.value},{default:()=>[Be()]}),S.default?.({...nt.value,props:{id:se.value,class:"v-field__input","aria-describedby":oe.value},focus:O,blur:N})]),Ie&&createVNode(VExpandXTransition,{key:"clear"},{default:()=>[withDirectives(createVNode("div",{class:"v-field__clearable",onMousedown:Ge=>{Ge.preventDefault(),Ge.stopPropagation()}},[S.clear?S.clear():createVNode(U,{name:"clear"},null)]),[[vShow,n.dirty]])]}),He&&createVNode("div",{key:"append",class:"v-field__append-inner"},[S["append-inner"]?.(nt.value),n.appendInnerIcon&&createVNode(U,{key:"append-icon",name:"appendInner"},null)]),createVNode("div",{class:["v-field__outline",Fe.value],style:ht.value},[Ce&&createVNode(Fragment,null,[createVNode("div",{class:"v-field__outline__start"},null),X.value&&createVNode("div",{class:"v-field__outline__notch"},[createVNode(VFieldLabel,{ref:we,floating:!0,for:se.value},{default:()=>[Be()]})]),createVNode("div",{class:"v-field__outline__end"},null)]),xe.value&&X.value&&createVNode(VFieldLabel,{ref:we,floating:!0,for:se.value},{default:()=>[Be()]})])])}),{controlRef:Te}}});function filterFieldProps(n){const r=Object.keys(VField.props).filter(_=>!isOn(_)&&_!=="class"&&_!=="style");return pick(n,r)}const makeVMessagesProps=propsFactory({active:Boolean,color:String,messages:{type:[Array,String],default:()=>[]},...makeComponentProps(),...makeTransitionProps$1({transition:{component:VSlideYTransition,leaveAbsolute:!0,group:!0}})},"VMessages"),VMessages=genericComponent()({name:"VMessages",props:makeVMessagesProps(),setup(n,r){let{slots:_}=r;const E=computed(()=>wrapInArray(n.messages)),{textColorClasses:S,textColorStyles:C}=useTextColor(computed(()=>n.color));return useRender(()=>createVNode(MaybeTransition,{transition:n.transition,tag:"div",class:["v-messages",S.value,n.class],style:[C.value,n.style],role:"alert","aria-live":"polite"},{default:()=>[n.active&&E.value.map((A,I)=>createVNode("div",{class:"v-messages__message",key:`${I}-${E.value}`},[_.message?_.message({message:A}):A]))]})),{}}}),FormKey=Symbol.for("vuetify:form");function useForm(){return inject$1(FormKey,null)}const makeValidationProps=propsFactory({disabled:{type:Boolean,default:null},error:Boolean,errorMessages:{type:[Array,String],default:()=>[]},maxErrors:{type:[Number,String],default:1},name:String,label:String,readonly:{type:Boolean,default:null},rules:{type:Array,default:()=>[]},modelValue:null,validateOn:String,validationValue:null,...makeFocusProps()},"validation");function useValidation(n){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:getCurrentInstanceName(),_=arguments.length>2&&arguments[2]!==void 0?arguments[2]:getUid();const E=useProxiedModel(n,"modelValue"),S=computed(()=>n.validationValue===void 0?E.value:n.validationValue),C=useForm(),A=ref$2([]),I=shallowRef(!0),B=computed(()=>!!(wrapInArray(E.value===""?null:E.value).length||wrapInArray(S.value===""?null:S.value).length)),O=computed(()=>!!(n.disabled??C?.isDisabled.value)),N=computed(()=>!!(n.readonly??C?.isReadonly.value)),U=computed(()=>n.errorMessages?.length?wrapInArray(n.errorMessages).concat(A.value).slice(0,Math.max(0,+n.maxErrors)):A.value),j=computed(()=>{let we=(n.validateOn??C?.validateOn.value)||"input";we==="lazy"&&(we="input lazy");const Te=new Set(we?.split(" ")??[]);return{blur:Te.has("blur")||Te.has("input"),input:Te.has("input"),submit:Te.has("submit"),lazy:Te.has("lazy")}}),z=computed(()=>n.error||n.errorMessages?.length?!1:n.rules.length?I.value?A.value.length||j.value.lazy?null:!0:!A.value.length:!0),Z=shallowRef(!1),X=computed(()=>({[`${r}--error`]:z.value===!1,[`${r}--dirty`]:B.value,[`${r}--disabled`]:O.value,[`${r}--readonly`]:N.value})),Q=computed(()=>n.name??unref(_));onBeforeMount(()=>{C?.register({id:Q.value,validate:ue,reset:se,resetValidation:oe})}),onBeforeUnmount(()=>{C?.unregister(Q.value)}),onMounted(async()=>{j.value.lazy||await ue(!0),C?.update(Q.value,z.value,U.value)}),useToggleScope(()=>j.value.input,()=>{watch(S,()=>{if(S.value!=null)ue();else if(n.focused){const we=watch(()=>n.focused,Te=>{Te||ue(),we()})}})}),useToggleScope(()=>j.value.blur,()=>{watch(()=>n.focused,we=>{we||ue()})}),watch([z,U],()=>{C?.update(Q.value,z.value,U.value)});function se(){E.value=null,nextTick$3(oe)}function oe(){I.value=!0,j.value.lazy?A.value=[]:ue(!0)}async function ue(){let we=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const Te=[];Z.value=!0;for(const xe of n.rules){if(Te.length>=+(n.maxErrors??1))break;const Ne=await(typeof xe=="function"?xe:()=>xe)(S.value);if(Ne!==!0){if(Ne!==!1&&typeof Ne!="string"){console.warn(`${Ne} is not a valid value. Rule functions must return boolean true or a string.`);continue}Te.push(Ne||"")}}return A.value=Te,Z.value=!1,I.value=we,A.value}return{errorMessages:U,isDirty:B,isDisabled:O,isReadonly:N,isPristine:I,isValid:z,isValidating:Z,reset:se,resetValidation:oe,validate:ue,validationClasses:X}}const makeVInputProps=propsFactory({id:String,appendIcon:IconValue,centerAffix:{type:Boolean,default:!0},prependIcon:IconValue,hideDetails:[Boolean,String],hideSpinButtons:Boolean,hint:String,persistentHint:Boolean,messages:{type:[Array,String],default:()=>[]},direction:{type:String,default:"horizontal",validator:n=>["horizontal","vertical"].includes(n)},"onClick:prepend":EventProp(),"onClick:append":EventProp(),...makeComponentProps(),...makeDensityProps(),...makeValidationProps()},"VInput"),VInput=genericComponent()({name:"VInput",props:{...makeVInputProps()},emits:{"update:modelValue":n=>!0},setup(n,r){let{attrs:_,slots:E,emit:S}=r;const{densityClasses:C}=useDensity(n),{rtlClasses:A}=useRtl(),{InputIcon:I}=useInputIcon(n),B=getUid(),O=computed(()=>n.id||`input-${B}`),N=computed(()=>`${O.value}-messages`),{errorMessages:U,isDirty:j,isDisabled:z,isReadonly:Z,isPristine:X,isValid:Q,isValidating:se,reset:oe,resetValidation:ue,validate:we,validationClasses:Te}=useValidation(n,"v-input",O),xe=computed(()=>({id:O,messagesId:N,isDirty:j,isDisabled:z,isReadonly:Z,isPristine:X,isValid:Q,isValidating:se,reset:oe,resetValidation:ue,validate:we})),Re=computed(()=>n.errorMessages?.length||!X.value&&U.value.length?U.value:n.hint&&(n.persistentHint||n.focused)?n.hint:n.messages);return useRender(()=>{const Ne=!!(E.prepend||n.prependIcon),Fe=!!(E.append||n.appendIcon),ht=Re.value.length>0,nt=!n.hideDetails||n.hideDetails==="auto"&&(ht||!!E.details);return createVNode("div",{class:["v-input",`v-input--${n.direction}`,{"v-input--center-affix":n.centerAffix,"v-input--hide-spin-buttons":n.hideSpinButtons},C.value,A.value,Te.value,n.class],style:n.style},[Ne&&createVNode("div",{key:"prepend",class:"v-input__prepend"},[E.prepend?.(xe.value),n.prependIcon&&createVNode(I,{key:"prepend-icon",name:"prepend"},null)]),E.default&&createVNode("div",{class:"v-input__control"},[E.default?.(xe.value)]),Fe&&createVNode("div",{key:"append",class:"v-input__append"},[n.appendIcon&&createVNode(I,{key:"append-icon",name:"append"},null),E.append?.(xe.value)]),nt&&createVNode("div",{class:"v-input__details"},[createVNode(VMessages,{id:N.value,active:ht,messages:Re.value},{message:E.message}),E.details?.(xe.value)])])}),{reset:oe,resetValidation:ue,validate:we,isValid:Q,errorMessages:U}}}),activeTypes=["color","file","time","date","datetime-local","week","month"],makeVTextFieldProps=propsFactory({autofocus:Boolean,counter:[Boolean,Number,String],counterValue:[Number,Function],prefix:String,placeholder:String,persistentPlaceholder:Boolean,persistentCounter:Boolean,suffix:String,role:String,type:{type:String,default:"text"},modelModifiers:Object,...makeVInputProps(),...makeVFieldProps()},"VTextField"),VTextField=genericComponent()({name:"VTextField",directives:{Intersect:Intersect$1},inheritAttrs:!1,props:makeVTextFieldProps(),emits:{"click:control":n=>!0,"mousedown:control":n=>!0,"update:focused":n=>!0,"update:modelValue":n=>!0},setup(n,r){let{attrs:_,emit:E,slots:S}=r;const C=useProxiedModel(n,"modelValue"),{isFocused:A,focus:I,blur:B}=useFocus(n),O=computed(()=>typeof n.counterValue=="function"?n.counterValue(C.value):typeof n.counterValue=="number"?n.counterValue:(C.value??"").toString().length),N=computed(()=>{if(_.maxlength)return _.maxlength;if(!(!n.counter||typeof n.counter!="number"&&typeof n.counter!="string"))return n.counter}),U=computed(()=>["plain","underlined"].includes(n.variant));function j(xe,Re){!n.autofocus||!xe||Re[0].target?.focus?.()}const z=ref$2(),Z=ref$2(),X=ref$2(),Q=computed(()=>activeTypes.includes(n.type)||n.persistentPlaceholder||A.value||n.active);function se(){X.value!==document.activeElement&&X.value?.focus(),A.value||I()}function oe(xe){E("mousedown:control",xe),xe.target!==X.value&&(se(),xe.preventDefault())}function ue(xe){se(),E("click:control",xe)}function we(xe){xe.stopPropagation(),se(),nextTick$3(()=>{C.value=null,callEvent(n["onClick:clear"],xe)})}function Te(xe){const Re=xe.target;if(C.value=Re.value,n.modelModifiers?.trim&&["text","search","password","tel","url"].includes(n.type)){const Ne=[Re.selectionStart,Re.selectionEnd];nextTick$3(()=>{Re.selectionStart=Ne[0],Re.selectionEnd=Ne[1]})}}return useRender(()=>{const xe=!!(S.counter||n.counter!==!1&&n.counter!=null),Re=!!(xe||S.details),[Ne,Fe]=filterInputAttrs(_),{modelValue:ht,...nt}=VInput.filterProps(n),Ee=filterFieldProps(n);return createVNode(VInput,mergeProps({ref:z,modelValue:C.value,"onUpdate:modelValue":Ce=>C.value=Ce,class:["v-text-field",{"v-text-field--prefixed":n.prefix,"v-text-field--suffixed":n.suffix,"v-input--plain-underlined":U.value},n.class],style:n.style},Ne,nt,{centerAffix:!U.value,focused:A.value}),{...S,default:Ce=>{let{id:_e,isDisabled:Ie,isDirty:He,isReadonly:Be,isValid:Ge}=Ce;return createVNode(VField,mergeProps({ref:Z,onMousedown:oe,onClick:ue,"onClick:clear":we,"onClick:prependInner":n["onClick:prependInner"],"onClick:appendInner":n["onClick:appendInner"],role:n.role},Ee,{id:_e.value,active:Q.value||He.value,dirty:He.value||n.dirty,disabled:Ie.value,focused:A.value,error:Ge.value===!1}),{...S,default:je=>{let{props:{class:Ve,...Pe}}=je;const Me=withDirectives(createVNode("input",mergeProps({ref:X,value:C.value,onInput:Te,autofocus:n.autofocus,readonly:Be.value,disabled:Ie.value,name:n.name,placeholder:n.placeholder,size:1,type:n.type,onFocus:se,onBlur:B},Pe,Fe),null),[[resolveDirective("intersect"),{handler:j},null,{once:!0}]]);return createVNode(Fragment,null,[n.prefix&&createVNode("span",{class:"v-text-field__prefix"},[createVNode("span",{class:"v-text-field__prefix__text"},[n.prefix])]),S.default?createVNode("div",{class:Ve,"data-no-activator":""},[S.default(),Me]):cloneVNode(Me,{class:Ve}),n.suffix&&createVNode("span",{class:"v-text-field__suffix"},[createVNode("span",{class:"v-text-field__suffix__text"},[n.suffix])])])}})},details:Re?Ce=>createVNode(Fragment,null,[S.details?.(Ce),xe&&createVNode(Fragment,null,[createVNode("span",null,null),createVNode(VCounter,{active:n.persistentCounter||A.value,value:O.value,max:N.value},S.counter)])]):void 0})}),forwardRefs({},z,Z,X)}}),_sfc_main$d=defineComponent$1({__name:"MenuLangues",setup(n){const{__:r}=_(),{_:_}=r(),{isRtl:E}=useRtl(),{:S,_:C}=_(),A=ref$2(),I=computed(()=>_.value.filter(B=>!A.value||B..includes(A.value)||B..includes(A.value)).map(B=>B.));return(B,O)=>(openBlock(),createBlock(VMenu,{activator:"parent",offset:"10px","min-width":"225",location:unref(E)?"bottom right":"bottom left"},{default:withCtx(()=>[createVNode(VList,null,{default:withCtx(()=>[createVNode(VTextField,{modelValue:A.value,"onUpdate:modelValue":O[0]||(O[0]=N=>A.value=N),density:"compact","prepend-inner-icon":"mdi-magnify",autofocus:"","hide-details":"",onClick:O[1]||(O[1]=withModifiers(()=>{},["stop"]))},null,8,["modelValue"]),createVNode(VList,{class:"overflow-y-auto","max-height":"400px","min-width":"200px"},{default:withCtx(()=>[(openBlock(!0),createElementBlock(Fragment,null,renderList(I.value,N=>(openBlock(),createBlock(_sfc_main$e,{key:N,code:N,selectionnee:N===unref(S),onClick:()=>unref(C)(N)},null,8,["code","selectionnee","onClick"]))),128))]),_:1})]),_:1})]),_:1},8,["location"]))}}),_sfc_main$c=defineComponent$1({__name:"SectionAccueil",props:{nEtapes:{},etape:{}},emits:["retour","avancer"],setup(n,{emit:r}){const _=r,{mdAndUp:E}=useDisplay(),{_:S}=_(),{$:C}=S({});return(A,I)=>(openBlock(),createBlock(_sfc_main$f,{"n-etapes":A.nEtapes,etape:A.etape,onRetour:I[0]||(I[0]=()=>_("retour")),onAvancer:I[1]||(I[1]=()=>_("avancer"))},{default:withCtx(()=>[createVNode(VCol,{cols:unref(E)?4:12,class:"pa-6 my-auto"},{default:withCtx(()=>[createVNode(VImg,{height:"300",src:_imports_0})]),_:1},8,["cols"]),createVNode(VCol,{cols:unref(E)?8:12,class:normalizeClass({"my-auto":!0,"text-center":!unref(E)})},{default:withCtx(()=>[createVNode(VImg,{class:normalizeClass({"mx-4":!unref(E)}),src:_imports_1,height:"150",width:unref(E)?600:void 0},null,8,["class","width"]),createBaseVNode("div",{class:normalizeClass({"text-h4":unref(E),"text-h5":!unref(E),"font-weight-light":!0,"mb-n1":!0,"mx-4":!unref(E)})},toDisplayString(unref(C)("accueil.titre")),3),createVNode(VBtn,{"prepend-icon":"mdi-earth",class:"my-6"},{default:withCtx(()=>[createTextVNode(toDisplayString(unref(C)("accueil.changerLangue"))+" ",1),createVNode(_sfc_main$d)]),_:1})]),_:1},8,["cols","class"])]),_:1},8,["n-etapes","etape"]))}});function bind(n,r){return function(){return n.apply(r,arguments)}}const{toString:toString$8}=Object.prototype,{getPrototypeOf}=Object,kindOf=(n=>r=>{const _=toString$8.call(r);return n[_]||(n[_]=_.slice(8,-1).toLowerCase())})(Object.create(null)),kindOfTest=n=>(n=n.toLowerCase(),r=>kindOf(r)===n),typeOfTest=n=>r=>typeof r===n,{isArray}=Array,isUndefined=typeOfTest("undefined");function isBuffer$2(n){return n!==null&&!isUndefined(n)&&n.constructor!==null&&!isUndefined(n.constructor)&&isFunction(n.constructor.isBuffer)&&n.constructor.isBuffer(n)}const isArrayBuffer$1=kindOfTest("ArrayBuffer");function isArrayBufferView(n){let r;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?r=ArrayBuffer.isView(n):r=n&&n.buffer&&isArrayBuffer$1(n.buffer),r}const isString=typeOfTest("string"),isFunction=typeOfTest("function"),isNumber=typeOfTest("number"),isObject=n=>n!==null&&typeof n=="object",isBoolean=n=>n===!0||n===!1,isPlainObject$1=n=>{if(kindOf(n)!=="object")return!1;const r=getPrototypeOf(n);return(r===null||r===Object.prototype||Object.getPrototypeOf(r)===null)&&!(Symbol.toStringTag in n)&&!(Symbol.iterator in n)},isDate=kindOfTest("Date"),isFile=kindOfTest("File"),isBlob=kindOfTest("Blob"),isFileList=kindOfTest("FileList"),isStream=n=>isObject(n)&&isFunction(n.pipe),isFormData=n=>{let r;return n&&(typeof FormData=="function"&&n instanceof FormData||isFunction(n.append)&&((r=kindOf(n))==="formdata"||r==="object"&&isFunction(n.toString)&&n.toString()==="[object FormData]"))},isURLSearchParams=kindOfTest("URLSearchParams"),trim$1=n=>n.trim?n.trim():n.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function forEach$2(n,r,{allOwnKeys:_=!1}={}){if(n===null||typeof n>"u")return;let E,S;if(typeof n!="object"&&(n=[n]),isArray(n))for(E=0,S=n.length;E<S;E++)r.call(null,n[E],E,n);else{const C=_?Object.getOwnPropertyNames(n):Object.keys(n),A=C.length;let I;for(E=0;E<A;E++)I=C[E],r.call(null,n[I],I,n)}}function findKey(n,r){r=r.toLowerCase();const _=Object.keys(n);let E=_.length,S;for(;E-- >0;)if(S=_[E],r===S.toLowerCase())return S;return null}const _global=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global$1,isContextDefined=n=>!isUndefined(n)&&n!==_global;function merge$2(){const{caseless:n}=isContextDefined(this)&&this||{},r={},_=(E,S)=>{const C=n&&findKey(r,S)||S;isPlainObject$1(r[C])&&isPlainObject$1(E)?r[C]=merge$2(r[C],E):isPlainObject$1(E)?r[C]=merge$2({},E):isArray(E)?r[C]=E.slice():r[C]=E};for(let E=0,S=arguments.length;E<S;E++)arguments[E]&&forEach$2(arguments[E],_);return r}const extend$1=(n,r,_,{allOwnKeys:E}={})=>(forEach$2(r,(S,C)=>{_&&isFunction(S)?n[C]=bind(S,_):n[C]=S},{allOwnKeys:E}),n),stripBOM=n=>(n.charCodeAt(0)===65279&&(n=n.slice(1)),n),inherits$1=(n,r,_,E)=>{n.prototype=Object.create(r.prototype,E),n.prototype.constructor=n,Object.defineProperty(n,"super",{value:r.prototype}),_&&Object.assign(n.prototype,_)},toFlatObject=(n,r,_,E)=>{let S,C,A;const I={};if(r=r||{},n==null)return r;do{for(S=Object.getOwnPropertyNames(n),C=S.length;C-- >0;)A=S[C],(!E||E(A,n,r))&&!I[A]&&(r[A]=n[A],I[A]=!0);n=_!==!1&&getPrototypeOf(n)}while(n&&(!_||_(n,r))&&n!==Object.prototype);return r},endsWith=(n,r,_)=>{n=String(n),(_===void 0||_>n.length)&&(_=n.length),_-=r.length;const E=n.indexOf(r,_);return E!==-1&&E===_},toArray=n=>{if(!n)return null;if(isArray(n))return n;let r=n.length;if(!isNumber(r))return null;const _=new Array(r);for(;r-- >0;)_[r]=n[r];return _},isTypedArray$1=(n=>r=>n&&r instanceof n)(typeof Uint8Array<"u"&&getPrototypeOf(Uint8Array)),forEachEntry=(n,r)=>{const E=(n&&n[Symbol.iterator]).call(n);let S;for(;(S=E.next())&&!S.done;){const C=S.value;r.call(n,C[0],C[1])}},matchAll=(n,r)=>{let _;const E=[];for(;(_=n.exec(r))!==null;)E.push(_);return E},isHTMLForm=kindOfTest("HTMLFormElement"),toCamelCase=n=>n.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(_,E,S){return E.toUpperCase()+S}),hasOwnProperty$2=(({hasOwnProperty:n})=>(r,_)=>n.call(r,_))(Object.prototype),isRegExp=kindOfTest("RegExp"),reduceDescriptors=(n,r)=>{const _=Object.getOwnPropertyDescriptors(n),E={};forEach$2(_,(S,C)=>{let A;(A=r(S,C,n))!==!1&&(E[C]=A||S)}),Object.defineProperties(n,E)},freezeMethods=n=>{reduceDescriptors(n,(r,_)=>{if(isFunction(n)&&["arguments","caller","callee"].indexOf(_)!==-1)return!1;const E=n[_];if(isFunction(E)){if(r.enumerable=!1,"writable"in r){r.writable=!1;return}r.set||(r.set=()=>{throw Error("Can not rewrite read-only method '"+_+"'")})}})},toObjectSet=(n,r)=>{const _={},E=S=>{S.forEach(C=>{_[C]=!0})};return isArray(n)?E(n):E(String(n).split(r)),_},noop$4=()=>{},toFiniteNumber=(n,r)=>(n=+n,Number.isFinite(n)?n:r),ALPHA$1="abcdefghijklmnopqrstuvwxyz",DIGIT="0123456789",ALPHABET={DIGIT,ALPHA:ALPHA$1,ALPHA_DIGIT:ALPHA$1+ALPHA$1.toUpperCase()+DIGIT},generateString=(n=16,r=ALPHABET.ALPHA_DIGIT)=>{let _="";const{length:E}=r;for(;n--;)_+=r[Math.random()*E|0];return _};function isSpecCompliantForm(n){return!!(n&&isFunction(n.append)&&n[Symbol.toStringTag]==="FormData"&&n[Symbol.iterator])}const toJSONObject=n=>{const r=new Array(10),_=(E,S)=>{if(isObject(E)){if(r.indexOf(E)>=0)return;if(!("toJSON"in E)){r[S]=E;const C=isArray(E)?[]:{};return forEach$2(E,(A,I)=>{const B=_(A,S+1);!isUndefined(B)&&(C[I]=B)}),r[S]=void 0,C}}return E};return _(n,0)},isAsyncFn=kindOfTest("AsyncFunction"),isThenable=n=>n&&(isObject(n)||isFunction(n))&&isFunction(n.then)&&isFunction(n.catch),utils$6={isArray,isArrayBuffer:isArrayBuffer$1,isBuffer:isBuffer$2,isFormData,isArrayBufferView,isString,isNumber,isBoolean,isObject,isPlainObject:isPlainObject$1,isUndefined,isDate,isFile,isBlob,isRegExp,isFunction,isStream,isURLSearchParams,isTypedArray:isTypedArray$1,isFileList,forEach:forEach$2,merge:merge$2,extend:extend$1,trim:trim$1,stripBOM,inherits:inherits$1,toFlatObject,kindOf,kindOfTest,endsWith,toArray,forEachEntry,matchAll,isHTMLForm,hasOwnProperty:hasOwnProperty$2,hasOwnProp:hasOwnProperty$2,reduceDescriptors,freezeMethods,toObjectSet,toCamelCase,noop:noop$4,toFiniteNumber,findKey,global:_global,isContextDefined,ALPHABET,generateString,isSpecCompliantForm,toJSONObject,isAsyncFn,isThenable};function AxiosError(n,r,_,E,S){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=n,this.name="AxiosError",r&&(this.code=r),_&&(this.config=_),E&&(this.request=E),S&&(this.response=S)}utils$6.inherits(AxiosError,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:utils$6.toJSONObject(this.config),code:this.code,status:this.response&&this.response.status?this.response.status:null}}});const prototype$1=AxiosError.prototype,descriptors={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(n=>{descriptors[n]={value:n}});Object.defineProperties(AxiosError,descriptors);Object.defineProperty(prototype$1,"isAxiosError",{value:!0});AxiosError.from=(n,r,_,E,S,C)=>{const A=Object.create(prototype$1);return utils$6.toFlatObject(n,A,function(B){return B!==Error.prototype},I=>I!=="isAxiosError"),AxiosError.call(A,n.message,r,_,E,S),A.cause=n,A.name=n.name,C&&Object.assign(A,C),A};const httpAdapter=null;function isVisitable(n){return utils$6.isPlainObject(n)||utils$6.isArray(n)}function removeBrackets(n){return utils$6.endsWith(n,"[]")?n.slice(0,-2):n}function renderKey(n,r,_){return n?n.concat(r).map(function(S,C){return S=removeBrackets(S),!_&&C?"["+S+"]":S}).join(_?".":""):r}function isFlatArray(n){return utils$6.isArray(n)&&!n.some(isVisitable)}const predicates=utils$6.toFlatObject(utils$6,{},null,function(r){return/^is[A-Z]/.test(r)});function toFormData(n,r,_){if(!utils$6.isObject(n))throw new TypeError("target must be an object");r=r||new FormData,_=utils$6.toFlatObject(_,{metaTokens:!0,dots:!1,indexes:!1},!1,function(X,Q){return!utils$6.isUndefined(Q[X])});const E=_.metaTokens,S=_.visitor||N,C=_.dots,A=_.indexes,B=(_.Blob||typeof Blob<"u"&&Blob)&&utils$6.isSpecCompliantForm(r);if(!utils$6.isFunction(S))throw new TypeError("visitor must be a function");function O(Z){if(Z===null)return"";if(utils$6.isDate(Z))return Z.toISOString();if(!B&&utils$6.isBlob(Z))throw new AxiosError("Blob is not supported. Use a Buffer instead.");return utils$6.isArrayBuffer(Z)||utils$6.isTypedArray(Z)?B&&typeof Blob=="function"?new Blob([Z]):Buffer$4.from(Z):Z}function N(Z,X,Q){let se=Z;if(Z&&!Q&&typeof Z=="object"){if(utils$6.endsWith(X,"{}"))X=E?X:X.slice(0,-2),Z=JSON.stringify(Z);else if(utils$6.isArray(Z)&&isFlatArray(Z)||(utils$6.isFileList(Z)||utils$6.endsWith(X,"[]"))&&(se=utils$6.toArray(Z)))return X=removeBrackets(X),se.forEach(function(ue,we){!(utils$6.isUndefined(ue)||ue===null)&&r.append(A===!0?renderKey([X],we,C):A===null?X:X+"[]",O(ue))}),!1}return isVisitable(Z)?!0:(r.append(renderKey(Q,X,C),O(Z)),!1)}const U=[],j=Object.assign(predicates,{defaultVisitor:N,convertValue:O,isVisitable});function z(Z,X){if(!utils$6.isUndefined(Z)){if(U.indexOf(Z)!==-1)throw Error("Circular reference detected in "+X.join("."));U.push(Z),utils$6.forEach(Z,function(se,oe){(!(utils$6.isUndefined(se)||se===null)&&S.call(r,se,utils$6.isString(oe)?oe.trim():oe,X,j))===!0&&z(se,X?X.concat(oe):[oe])}),U.pop()}}if(!utils$6.isObject(n))throw new TypeError("data must be an object");return z(n),r}function encode$o(n){const r={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(n).replace(/[!'()~]|%20|%00/g,function(E){return r[E]})}function AxiosURLSearchParams(n,r){this._pairs=[],n&&toFormData(n,this,r)}const prototype=AxiosURLSearchParams.prototype;prototype.append=function(r,_){this._pairs.push([r,_])};prototype.toString=function(r){const _=r?function(E){return r.call(this,E,encode$o)}:encode$o;return this._pairs.map(function(S){return _(S[0])+"="+_(S[1])},"").join("&")};function encode$n(n){return encodeURIComponent(n).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function buildURL(n,r,_){if(!r)return n;const E=_&&_.encode||encode$n,S=_&&_.serialize;let C;if(S?C=S(r,_):C=utils$6.isURLSearchParams(r)?r.toString():new AxiosURLSearchParams(r,_).toString(E),C){const A=n.indexOf("#");A!==-1&&(n=n.slice(0,A)),n+=(n.indexOf("?")===-1?"?":"&")+C}return n}class InterceptorManager{constructor(){this.handlers=[]}use(r,_,E){return this.handlers.push({fulfilled:r,rejected:_,synchronous:E?E.synchronous:!1,runWhen:E?E.runWhen:null}),this.handlers.length-1}eject(r){this.handlers[r]&&(this.handlers[r]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(r){utils$6.forEach(this.handlers,function(E){E!==null&&r(E)})}}const transitionalDefaults={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},URLSearchParams$1=typeof URLSearchParams<"u"?URLSearchParams:AxiosURLSearchParams,FormData$1=typeof FormData<"u"?FormData:null,Blob$1=typeof Blob<"u"?Blob:null,platform$2={isBrowser:!0,classes:{URLSearchParams:URLSearchParams$1,FormData:FormData$1,Blob:Blob$1},protocols:["http","https","file","blob","url","data"]},hasBrowserEnv=typeof window<"u"&&typeof document<"u",hasStandardBrowserEnv=(n=>hasBrowserEnv&&["ReactNative","NativeScript","NS"].indexOf(n)<0)(typeof navigator<"u"&&navigator.product),hasStandardBrowserWebWorkerEnv=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",utils$5=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv,hasStandardBrowserEnv,hasStandardBrowserWebWorkerEnv},Symbol.toStringTag,{value:"Module"})),platform$1={...utils$5,...platform$2};function toURLEncodedForm(n,r){return toFormData(n,new platform$1.classes.URLSearchParams,Object.assign({visitor:function(_,E,S,C){return platform$1.isNode&&utils$6.isBuffer(_)?(this.append(E,_.toString("base64")),!1):C.defaultVisitor.apply(this,arguments)}},r))}function parsePropPath(n){return utils$6.matchAll(/\w+|\[(\w*)]/g,n).map(r=>r[0]==="[]"?"":r[1]||r[0])}function arrayToObject(n){const r={},_=Object.keys(n);let E;const S=_.length;let C;for(E=0;E<S;E++)C=_[E],r[C]=n[C];return r}function formDataToJSON(n){function r(_,E,S,C){let A=_[C++];if(A==="__proto__")return!0;const I=Number.isFinite(+A),B=C>=_.length;return A=!A&&utils$6.isArray(S)?S.length:A,B?(utils$6.hasOwnProp(S,A)?S[A]=[S[A],E]:S[A]=E,!I):((!S[A]||!utils$6.isObject(S[A]))&&(S[A]=[]),r(_,E,S[A],C)&&utils$6.isArray(S[A])&&(S[A]=arrayToObject(S[A])),!I)}if(utils$6.isFormData(n)&&utils$6.isFunction(n.entries)){const _={};return utils$6.forEachEntry(n,(E,S)=>{r(parsePropPath(E),S,_,0)}),_}return null}function stringifySafely(n,r,_){if(utils$6.isString(n))try{return(r||JSON.parse)(n),utils$6.trim(n)}catch(E){if(E.name!=="SyntaxError")throw E}return(_||JSON.stringify)(n)}const defaults$2={transitional:transitionalDefaults,adapter:["xhr","http"],transformRequest:[function(r,_){const E=_.getContentType()||"",S=E.indexOf("application/json")>-1,C=utils$6.isObject(r);if(C&&utils$6.isHTMLForm(r)&&(r=new FormData(r)),utils$6.isFormData(r))return S?JSON.stringify(formDataToJSON(r)):r;if(utils$6.isArrayBuffer(r)||utils$6.isBuffer(r)||utils$6.isStream(r)||utils$6.isFile(r)||utils$6.isBlob(r))return r;if(utils$6.isArrayBufferView(r))return r.buffer;if(utils$6.isURLSearchParams(r))return _.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),r.toString();let I;if(C){if(E.indexOf("application/x-www-form-urlencoded")>-1)return toURLEncodedForm(r,this.formSerializer).toString();if((I=utils$6.isFileList(r))||E.indexOf("multipart/form-data")>-1){const B=this.env&&this.env.FormData;return toFormData(I?{"files[]":r}:r,B&&new B,this.formSerializer)}}return C||S?(_.setContentType("application/json",!1),stringifySafely(r)):r}],transformResponse:[function(r){const _=this.transitional||defaults$2.transitional,E=_&&_.forcedJSONParsing,S=this.responseType==="json";if(r&&utils$6.isString(r)&&(E&&!this.responseType||S)){const A=!(_&&_.silentJSONParsing)&&S;try{return JSON.parse(r)}catch(I){if(A)throw I.name==="SyntaxError"?AxiosError.from(I,AxiosError.ERR_BAD_RESPONSE,this,null,this.response):I}}return r}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:platform$1.classes.FormData,Blob:platform$1.classes.Blob},validateStatus:function(r){return r>=200&&r<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};utils$6.forEach(["delete","get","head","post","put","patch"],n=>{defaults$2.headers[n]={}});const defaults$3=defaults$2,ignoreDuplicateOf=utils$6.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),parseHeaders=n=>{const r={};let _,E,S;return n&&n.split(`
`).forEach(function(A){S=A.indexOf(":"),_=A.substring(0,S).trim().toLowerCase(),E=A.substring(S+1).trim(),!(!_||r[_]&&ignoreDuplicateOf[_])&&(_==="set-cookie"?r[_]?r[_].push(E):r[_]=[E]:r[_]=r[_]?r[_]+", "+E:E)}),r},$internals=Symbol("internals");function normalizeHeader(n){return n&&String(n).trim().toLowerCase()}function normalizeValue$2(n){return n===!1||n==null?n:utils$6.isArray(n)?n.map(normalizeValue$2):String(n)}function parseTokens(n){const r=Object.create(null),_=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let E;for(;E=_.exec(n);)r[E[1]]=E[2];return r}const isValidHeaderName=n=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(n.trim());function matchHeaderValue(n,r,_,E,S){if(utils$6.isFunction(E))return E.call(this,r,_);if(S&&(r=_),!!utils$6.isString(r)){if(utils$6.isString(E))return r.indexOf(E)!==-1;if(utils$6.isRegExp(E))return E.test(r)}}function formatHeader(n){return n.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(r,_,E)=>_.toUpperCase()+E)}function buildAccessors(n,r){const _=utils$6.toCamelCase(" "+r);["get","set","has"].forEach(E=>{Object.defineProperty(n,E+_,{value:function(S,C,A){return this[E].call(this,r,S,C,A)},configurable:!0})})}class AxiosHeaders{constructor(r){r&&this.set(r)}set(r,_,E){const S=this;function C(I,B,O){const N=normalizeHeader(B);if(!N)throw new Error("header name must be a non-empty string");const U=utils$6.findKey(S,N);(!U||S[U]===void 0||O===!0||O===void 0&&S[U]!==!1)&&(S[U||B]=normalizeValue$2(I))}const A=(I,B)=>utils$6.forEach(I,(O,N)=>C(O,N,B));return utils$6.isPlainObject(r)||r instanceof this.constructor?A(r,_):utils$6.isString(r)&&(r=r.trim())&&!isValidHeaderName(r)?A(parseHeaders(r),_):r!=null&&C(_,r,E),this}get(r,_){if(r=normalizeHeader(r),r){const E=utils$6.findKey(this,r);if(E){const S=this[E];if(!_)return S;if(_===!0)return parseTokens(S);if(utils$6.isFunction(_))return _.call(this,S,E);if(utils$6.isRegExp(_))return _.exec(S);throw new TypeError("parser must be boolean|regexp|function")}}}has(r,_){if(r=normalizeHeader(r),r){const E=utils$6.findKey(this,r);return!!(E&&this[E]!==void 0&&(!_||matchHeaderValue(this,this[E],E,_)))}return!1}delete(r,_){const E=this;let S=!1;function C(A){if(A=normalizeHeader(A),A){const I=utils$6.findKey(E,A);I&&(!_||matchHeaderValue(E,E[I],I,_))&&(delete E[I],S=!0)}}return utils$6.isArray(r)?r.forEach(C):C(r),S}clear(r){const _=Object.keys(this);let E=_.length,S=!1;for(;E--;){const C=_[E];(!r||matchHeaderValue(this,this[C],C,r,!0))&&(delete this[C],S=!0)}return S}normalize(r){const _=this,E={};return utils$6.forEach(this,(S,C)=>{const A=utils$6.findKey(E,C);if(A){_[A]=normalizeValue$2(S),delete _[C];return}const I=r?formatHeader(C):String(C).trim();I!==C&&delete _[C],_[I]=normalizeValue$2(S),E[I]=!0}),this}concat(...r){return this.constructor.concat(this,...r)}toJSON(r){const _=Object.create(null);return utils$6.forEach(this,(E,S)=>{E!=null&&E!==!1&&(_[S]=r&&utils$6.isArray(E)?E.join(", "):E)}),_}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([r,_])=>r+": "+_).join(`
`)}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(r){return r instanceof this?r:new this(r)}static concat(r,..._){const E=new this(r);return _.forEach(S=>E.set(S)),E}static accessor(r){const E=(this[$internals]=this[$internals]={accessors:{}}).accessors,S=this.prototype;function C(A){const I=normalizeHeader(A);E[I]||(buildAccessors(S,A),E[I]=!0)}return utils$6.isArray(r)?r.forEach(C):C(r),this}}AxiosHeaders.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);utils$6.reduceDescriptors(AxiosHeaders.prototype,({value:n},r)=>{let _=r[0].toUpperCase()+r.slice(1);return{get:()=>n,set(E){this[_]=E}}});utils$6.freezeMethods(AxiosHeaders);const AxiosHeaders$1=AxiosHeaders;function transformData(n,r){const _=this||defaults$3,E=r||_,S=AxiosHeaders$1.from(E.headers);let C=E.data;return utils$6.forEach(n,function(I){C=I.call(_,C,S.normalize(),r?r.status:void 0)}),S.normalize(),C}function isCancel(n){return!!(n&&n.__CANCEL__)}function CanceledError(n,r,_){AxiosError.call(this,n??"canceled",AxiosError.ERR_CANCELED,r,_),this.name="CanceledError"}utils$6.inherits(CanceledError,AxiosError,{__CANCEL__:!0});function settle(n,r,_){const E=_.config.validateStatus;!_.status||!E||E(_.status)?n(_):r(new AxiosError("Request failed with status code "+_.status,[AxiosError.ERR_BAD_REQUEST,AxiosError.ERR_BAD_RESPONSE][Math.floor(_.status/100)-4],_.config,_.request,_))}const cookies=platform$1.hasStandardBrowserEnv?{write(n,r,_,E,S,C){const A=[n+"="+encodeURIComponent(r)];utils$6.isNumber(_)&&A.push("expires="+new Date(_).toGMTString()),utils$6.isString(E)&&A.push("path="+E),utils$6.isString(S)&&A.push("domain="+S),C===!0&&A.push("secure"),document.cookie=A.join("; ")},read(n){const r=document.cookie.match(new RegExp("(^|;\\s*)("+n+")=([^;]*)"));return r?decodeURIComponent(r[3]):null},remove(n){this.write(n,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function isAbsoluteURL(n){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(n)}function combineURLs(n,r){return r?n.replace(/\/?\/$/,"")+"/"+r.replace(/^\/+/,""):n}function buildFullPath(n,r){return n&&!isAbsoluteURL(r)?combineURLs(n,r):r}const isURLSameOrigin=platform$1.hasStandardBrowserEnv?function(){const r=/(msie|trident)/i.test(navigator.userAgent),_=document.createElement("a");let E;function S(C){let A=C;return r&&(_.setAttribute("href",A),A=_.href),_.setAttribute("href",A),{href:_.href,protocol:_.protocol?_.protocol.replace(/:$/,""):"",host:_.host,search:_.search?_.search.replace(/^\?/,""):"",hash:_.hash?_.hash.replace(/^#/,""):"",hostname:_.hostname,port:_.port,pathname:_.pathname.charAt(0)==="/"?_.pathname:"/"+_.pathname}}return E=S(window.location.href),function(A){const I=utils$6.isString(A)?S(A):A;return I.protocol===E.protocol&&I.host===E.host}}():function(){return function(){return!0}}();function parseProtocol(n){const r=/^([-+\w]{1,25})(:?\/\/|:)/.exec(n);return r&&r[1]||""}function speedometer(n,r){n=n||10;const _=new Array(n),E=new Array(n);let S=0,C=0,A;return r=r!==void 0?r:1e3,function(B){const O=Date.now(),N=E[C];A||(A=O),_[S]=B,E[S]=O;let U=C,j=0;for(;U!==S;)j+=_[U++],U=U%n;if(S=(S+1)%n,S===C&&(C=(C+1)%n),O-A<r)return;const z=N&&O-N;return z?Math.round(j*1e3/z):void 0}}function progressEventReducer(n,r){let _=0;const E=speedometer(50,250);return S=>{const C=S.loaded,A=S.lengthComputable?S.total:void 0,I=C-_,B=E(I),O=C<=A;_=C;const N={loaded:C,total:A,progress:A?C/A:void 0,bytes:I,rate:B||void 0,estimated:B&&A&&O?(A-C)/B:void 0,event:S};N[r?"download":"upload"]=!0,n(N)}}const isXHRAdapterSupported=typeof XMLHttpRequest<"u",xhrAdapter=isXHRAdapterSupported&&function(n){return new Promise(function(_,E){let S=n.data;const C=AxiosHeaders$1.from(n.headers).normalize();let{responseType:A,withXSRFToken:I}=n,B;function O(){n.cancelToken&&n.cancelToken.unsubscribe(B),n.signal&&n.signal.removeEventListener("abort",B)}let N;if(utils$6.isFormData(S)){if(platform$1.hasStandardBrowserEnv||platform$1.hasStandardBrowserWebWorkerEnv)C.setContentType(!1);else if((N=C.getContentType())!==!1){const[X,...Q]=N?N.split(";").map(se=>se.trim()).filter(Boolean):[];C.setContentType([X||"multipart/form-data",...Q].join("; "))}}let U=new XMLHttpRequest;if(n.auth){const X=n.auth.username||"",Q=n.auth.password?unescape(encodeURIComponent(n.auth.password)):"";C.set("Authorization","Basic "+btoa(X+":"+Q))}const j=buildFullPath(n.baseURL,n.url);U.open(n.method.toUpperCase(),buildURL(j,n.params,n.paramsSerializer),!0),U.timeout=n.timeout;function z(){if(!U)return;const X=AxiosHeaders$1.from("getAllResponseHeaders"in U&&U.getAllResponseHeaders()),se={data:!A||A==="text"||A==="json"?U.responseText:U.response,status:U.status,statusText:U.statusText,headers:X,config:n,request:U};settle(function(ue){_(ue),O()},function(ue){E(ue),O()},se),U=null}if("onloadend"in U?U.onloadend=z:U.onreadystatechange=function(){!U||U.readyState!==4||U.status===0&&!(U.responseURL&&U.responseURL.indexOf("file:")===0)||setTimeout(z)},U.onabort=function(){U&&(E(new AxiosError("Request aborted",AxiosError.ECONNABORTED,n,U)),U=null)},U.onerror=function(){E(new AxiosError("Network Error",AxiosError.ERR_NETWORK,n,U)),U=null},U.ontimeout=function(){let Q=n.timeout?"timeout of "+n.timeout+"ms exceeded":"timeout exceeded";const se=n.transitional||transitionalDefaults;n.timeoutErrorMessage&&(Q=n.timeoutErrorMessage),E(new AxiosError(Q,se.clarifyTimeoutError?AxiosError.ETIMEDOUT:AxiosError.ECONNABORTED,n,U)),U=null},platform$1.hasStandardBrowserEnv&&(I&&utils$6.isFunction(I)&&(I=I(n)),I||I!==!1&&isURLSameOrigin(j))){const X=n.xsrfHeaderName&&n.xsrfCookieName&&cookies.read(n.xsrfCookieName);X&&C.set(n.xsrfHeaderName,X)}S===void 0&&C.setContentType(null),"setRequestHeader"in U&&utils$6.forEach(C.toJSON(),function(Q,se){U.setRequestHeader(se,Q)}),utils$6.isUndefined(n.withCredentials)||(U.withCredentials=!!n.withCredentials),A&&A!=="json"&&(U.responseType=n.responseType),typeof n.onDownloadProgress=="function"&&U.addEventListener("progress",progressEventReducer(n.onDownloadProgress,!0)),typeof n.onUploadProgress=="function"&&U.upload&&U.upload.addEventListener("progress",progressEventReducer(n.onUploadProgress)),(n.cancelToken||n.signal)&&(B=X=>{U&&(E(!X||X.type?new CanceledError(null,n,U):X),U.abort(),U=null)},n.cancelToken&&n.cancelToken.subscribe(B),n.signal&&(n.signal.aborted?B():n.signal.addEventListener("abort",B)));const Z=parseProtocol(j);if(Z&&platform$1.protocols.indexOf(Z)===-1){E(new AxiosError("Unsupported protocol "+Z+":",AxiosError.ERR_BAD_REQUEST,n));return}U.send(S||null)})},knownAdapters={http:httpAdapter,xhr:xhrAdapter};utils$6.forEach(knownAdapters,(n,r)=>{if(n){try{Object.defineProperty(n,"name",{value:r})}catch{}Object.defineProperty(n,"adapterName",{value:r})}});const renderReason=n=>`- ${n}`,isResolvedHandle=n=>utils$6.isFunction(n)||n===null||n===!1,adapters={getAdapter:n=>{n=utils$6.isArray(n)?n:[n];const{length:r}=n;let _,E;const S={};for(let C=0;C<r;C++){_=n[C];let A;if(E=_,!isResolvedHandle(_)&&(E=knownAdapters[(A=String(_)).toLowerCase()],E===void 0))throw new AxiosError(`Unknown adapter '${A}'`);if(E)break;S[A||"#"+C]=E}if(!E){const C=Object.entries(S).map(([I,B])=>`adapter ${I} `+(B===!1?"is not supported by the environment":"is not available in the build"));let A=r?C.length>1?`since :
`+C.map(renderReason).join(`
`):" "+renderReason(C[0]):"as no adapter specified";throw new AxiosError("There is no suitable adapter to dispatch the request "+A,"ERR_NOT_SUPPORT")}return E},adapters:knownAdapters};function throwIfCancellationRequested(n){if(n.cancelToken&&n.cancelToken.throwIfRequested(),n.signal&&n.signal.aborted)throw new CanceledError(null,n)}function dispatchRequest(n){return throwIfCancellationRequested(n),n.headers=AxiosHeaders$1.from(n.headers),n.data=transformData.call(n,n.transformRequest),["post","put","patch"].indexOf(n.method)!==-1&&n.headers.setContentType("application/x-www-form-urlencoded",!1),adapters.getAdapter(n.adapter||defaults$3.adapter)(n).then(function(E){return throwIfCancellationRequested(n),E.data=transformData.call(n,n.transformResponse,E),E.headers=AxiosHeaders$1.from(E.headers),E},function(E){return isCancel(E)||(throwIfCancellationRequested(n),E&&E.response&&(E.response.data=transformData.call(n,n.transformResponse,E.response),E.response.headers=AxiosHeaders$1.from(E.response.headers))),Promise.reject(E)})}const headersToObject=n=>n instanceof AxiosHeaders$1?{...n}:n;function mergeConfig(n,r){r=r||{};const _={};function E(O,N,U){return utils$6.isPlainObject(O)&&utils$6.isPlainObject(N)?utils$6.merge.call({caseless:U},O,N):utils$6.isPlainObject(N)?utils$6.merge({},N):utils$6.isArray(N)?N.slice():N}function S(O,N,U){if(utils$6.isUndefined(N)){if(!utils$6.isUndefined(O))return E(void 0,O,U)}else return E(O,N,U)}function C(O,N){if(!utils$6.isUndefined(N))return E(void 0,N)}function A(O,N){if(utils$6.isUndefined(N)){if(!utils$6.isUndefined(O))return E(void 0,O)}else return E(void 0,N)}function I(O,N,U){if(U in r)return E(O,N);if(U in n)return E(void 0,O)}const B={url:C,method:C,data:C,baseURL:A,transformRequest:A,transformResponse:A,paramsSerializer:A,timeout:A,timeoutMessage:A,withCredentials:A,withXSRFToken:A,adapter:A,responseType:A,xsrfCookieName:A,xsrfHeaderName:A,onUploadProgress:A,onDownloadProgress:A,decompress:A,maxContentLength:A,maxBodyLength:A,beforeRedirect:A,transport:A,httpAgent:A,httpsAgent:A,cancelToken:A,socketPath:A,responseEncoding:A,validateStatus:I,headers:(O,N)=>S(headersToObject(O),headersToObject(N),!0)};return utils$6.forEach(Object.keys(Object.assign({},n,r)),function(N){const U=B[N]||S,j=U(n[N],r[N],N);utils$6.isUndefined(j)&&U!==I||(_[N]=j)}),_}const VERSION="1.6.8",validators$2={};["object","boolean","number","function","string","symbol"].forEach((n,r)=>{validators$2[n]=function(E){return typeof E===n||"a"+(r<1?"n ":" ")+n}});const deprecatedWarnings={};validators$2.transitional=function(r,_,E){function S(C,A){return"[Axios v"+VERSION+"] Transitional option '"+C+"'"+A+(E?". "+E:"")}return(C,A,I)=>{if(r===!1)throw new AxiosError(S(A," has been removed"+(_?" in "+_:"")),AxiosError.ERR_DEPRECATED);return _&&!deprecatedWarnings[A]&&(deprecatedWarnings[A]=!0,console.warn(S(A," has been deprecated since v"+_+" and will be removed in the near future"))),r?r(C,A,I):!0}};function assertOptions(n,r,_){if(typeof n!="object")throw new AxiosError("options must be an object",AxiosError.ERR_BAD_OPTION_VALUE);const E=Object.keys(n);let S=E.length;for(;S-- >0;){const C=E[S],A=r[C];if(A){const I=n[C],B=I===void 0||A(I,C,n);if(B!==!0)throw new AxiosError("option "+C+" must be "+B,AxiosError.ERR_BAD_OPTION_VALUE);continue}if(_!==!0)throw new AxiosError("Unknown option "+C,AxiosError.ERR_BAD_OPTION)}}const validator={assertOptions,validators:validators$2},validators$1=validator.validators;class Axios{constructor(r){this.defaults=r,this.interceptors={request:new InterceptorManager,response:new InterceptorManager}}async request(r,_){try{return await this._request(r,_)}catch(E){if(E instanceof Error){let S;Error.captureStackTrace?Error.captureStackTrace(S={}):S=new Error;const C=S.stack?S.stack.replace(/^.+\n/,""):"";E.stack?C&&!String(E.stack).endsWith(C.replace(/^.+\n.+\n/,""))&&(E.stack+=`
`+C):E.stack=C}throw E}}_request(r,_){typeof r=="string"?(_=_||{},_.url=r):_=r||{},_=mergeConfig(this.defaults,_);const{transitional:E,paramsSerializer:S,headers:C}=_;E!==void 0&&validator.assertOptions(E,{silentJSONParsing:validators$1.transitional(validators$1.boolean),forcedJSONParsing:validators$1.transitional(validators$1.boolean),clarifyTimeoutError:validators$1.transitional(validators$1.boolean)},!1),S!=null&&(utils$6.isFunction(S)?_.paramsSerializer={serialize:S}:validator.assertOptions(S,{encode:validators$1.function,serialize:validators$1.function},!0)),_.method=(_.method||this.defaults.method||"get").toLowerCase();let A=C&&utils$6.merge(C.common,C[_.method]);C&&utils$6.forEach(["delete","get","head","post","put","patch","common"],Z=>{delete C[Z]}),_.headers=AxiosHeaders$1.concat(A,C);const I=[];let B=!0;this.interceptors.request.forEach(function(X){typeof X.runWhen=="function"&&X.runWhen(_)===!1||(B=B&&X.synchronous,I.unshift(X.fulfilled,X.rejected))});const O=[];this.interceptors.response.forEach(function(X){O.push(X.fulfilled,X.rejected)});let N,U=0,j;if(!B){const Z=[dispatchRequest.bind(this),void 0];for(Z.unshift.apply(Z,I),Z.push.apply(Z,O),j=Z.length,N=Promise.resolve(_);U<j;)N=N.then(Z[U++],Z[U++]);return N}j=I.length;let z=_;for(U=0;U<j;){const Z=I[U++],X=I[U++];try{z=Z(z)}catch(Q){X.call(this,Q);break}}try{N=dispatchRequest.call(this,z)}catch(Z){return Promise.reject(Z)}for(U=0,j=O.length;U<j;)N=N.then(O[U++],O[U++]);return N}getUri(r){r=mergeConfig(this.defaults,r);const _=buildFullPath(r.baseURL,r.url);return buildURL(_,r.params,r.paramsSerializer)}}utils$6.forEach(["delete","get","head","options"],function(r){Axios.prototype[r]=function(_,E){return this.request(mergeConfig(E||{},{method:r,url:_,data:(E||{}).data}))}});utils$6.forEach(["post","put","patch"],function(r){function _(E){return function(C,A,I){return this.request(mergeConfig(I||{},{method:r,headers:E?{"Content-Type":"multipart/form-data"}:{},url:C,data:A}))}}Axios.prototype[r]=_(),Axios.prototype[r+"Form"]=_(!0)});const Axios$1=Axios;class CancelToken{constructor(r){if(typeof r!="function")throw new TypeError("executor must be a function.");let _;this.promise=new Promise(function(C){_=C});const E=this;this.promise.then(S=>{if(!E._listeners)return;let C=E._listeners.length;for(;C-- >0;)E._listeners[C](S);E._listeners=null}),this.promise.then=S=>{let C;const A=new Promise(I=>{E.subscribe(I),C=I}).then(S);return A.cancel=function(){E.unsubscribe(C)},A},r(function(C,A,I){E.reason||(E.reason=new CanceledError(C,A,I),_(E.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(r){if(this.reason){r(this.reason);return}this._listeners?this._listeners.push(r):this._listeners=[r]}unsubscribe(r){if(!this._listeners)return;const _=this._listeners.indexOf(r);_!==-1&&this._listeners.splice(_,1)}static source(){let r;return{token:new CancelToken(function(S){r=S}),cancel:r}}}const CancelToken$1=CancelToken;function spread(n){return function(_){return n.apply(null,_)}}function isAxiosError(n){return utils$6.isObject(n)&&n.isAxiosError===!0}const HttpStatusCode={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(HttpStatusCode).forEach(([n,r])=>{HttpStatusCode[r]=n});const HttpStatusCode$1=HttpStatusCode;function createInstance(n){const r=new Axios$1(n),_=bind(Axios$1.prototype.request,r);return utils$6.extend(_,Axios$1.prototype,r,{allOwnKeys:!0}),utils$6.extend(_,r,null,{allOwnKeys:!0}),_.create=function(S){return createInstance(mergeConfig(n,S))},_}const axios=createInstance(defaults$3);axios.Axios=Axios$1;axios.CanceledError=CanceledError;axios.CancelToken=CancelToken$1;axios.isCancel=isCancel;axios.VERSION=VERSION;axios.toFormData=toFormData;axios.AxiosError=AxiosError;axios.Cancel=axios.CanceledError;axios.all=function(r){return Promise.all(r)};axios.spread=spread;axios.isAxiosError=isAxiosError;axios.mergeConfig=mergeConfig;axios.AxiosHeaders=AxiosHeaders$1;axios.formToJSON=n=>formDataToJSON(utils$6.isHTMLForm(n)?new FormData(n):n);axios.getAdapter=adapters.getAdapter;axios.HttpStatusCode=HttpStatusCode$1;axios.default=axios;var platform={exports:{}};/*!
 * Platform.js v1.3.6
 * Copyright 2014-2020 Benjamin Tan
 * Copyright 2011-2013 John-David Dalton
 * Available under MIT license
 */platform.exports;(function(n,r){(function(){var _={function:!0,object:!0},E=_[typeof window]&&window||this,S=r,C=n&&!n.nodeType&&n,A=S&&C&&typeof commonjsGlobal=="object"&&commonjsGlobal;A&&(A.global===A||A.window===A||A.self===A)&&(E=A);var I=Math.pow(2,53)-1,B=/\bOpera/,O=Object.prototype,N=O.hasOwnProperty,U=O.toString;function j(Ne){return Ne=String(Ne),Ne.charAt(0).toUpperCase()+Ne.slice(1)}function z(Ne,Fe,ht){var nt={"10.0":"10","6.4":"10 Technical Preview","6.3":"8.1","6.2":"8","6.1":"Server 2008 R2 / 7","6.0":"Server 2008 / Vista","5.2":"Server 2003 / XP 64-bit","5.1":"XP","5.01":"2000 SP1","5.0":"2000","4.0":"NT","4.90":"ME"};return Fe&&ht&&/^Win/i.test(Ne)&&!/^Windows Phone /i.test(Ne)&&(nt=nt[/[\d.]+$/.exec(Ne)])&&(Ne="Windows "+nt),Ne=String(Ne),Fe&&ht&&(Ne=Ne.replace(RegExp(Fe,"i"),ht)),Ne=X(Ne.replace(/ ce$/i," CE").replace(/\bhpw/i,"web").replace(/\bMacintosh\b/,"Mac OS").replace(/_PowerPC\b/i," OS").replace(/\b(OS X) [^ \d]+/i,"$1").replace(/\bMac (OS X)\b/,"$1").replace(/\/(\d)/," $1").replace(/_/g,".").replace(/(?: BePC|[ .]*fc[ \d.]+)$/i,"").replace(/\bx86\.64\b/gi,"x86_64").replace(/\b(Windows Phone) OS\b/,"$1").replace(/\b(Chrome OS \w+) [\d.]+\b/,"$1").split(" on ")[0]),Ne}function Z(Ne,Fe){var ht=-1,nt=Ne?Ne.length:0;if(typeof nt=="number"&&nt>-1&&nt<=I)for(;++ht<nt;)Fe(Ne[ht],ht,Ne);else Q(Ne,Fe)}function X(Ne){return Ne=Te(Ne),/^(?:webOS|i(?:OS|P))/.test(Ne)?Ne:j(Ne)}function Q(Ne,Fe){for(var ht in Ne)N.call(Ne,ht)&&Fe(Ne[ht],ht,Ne)}function se(Ne){return Ne==null?j(Ne):U.call(Ne).slice(8,-1)}function oe(Ne,Fe){var ht=Ne!=null?typeof Ne[Fe]:"number";return!/^(?:boolean|number|string|undefined)$/.test(ht)&&(ht=="object"?!!Ne[Fe]:!0)}function ue(Ne){return String(Ne).replace(/([ -])(?!$)/g,"$1?")}function we(Ne,Fe){var ht=null;return Z(Ne,function(nt,Ee){ht=Fe(ht,nt,Ee,Ne)}),ht}function Te(Ne){return String(Ne).replace(/^ +| +$/g,"")}function xe(Ne){var Fe=E,ht=Ne&&typeof Ne=="object"&&se(Ne)!="String";ht&&(Fe=Ne,Ne=null);var nt=Fe.navigator||{},Ee=nt.userAgent||"";Ne||(Ne=Ee);var Ce=ht?!!nt.likeChrome:/\bChrome\b/.test(Ne)&&!/internal|\n/i.test(U.toString()),_e="Object",Ie=ht?_e:"ScriptBridgingProxyObject",He=ht?_e:"Environment",Be=ht&&Fe.java?"JavaPackage":se(Fe.java),Ge=ht?_e:"RuntimeObject",je=/\bJava/.test(Be)&&Fe.java,Ve=je&&se(Fe.environment)==He,Pe=je?"a":"",Me=je?"b":"",tt=Fe.document||{},Ke=Fe.operamini||Fe.opera,mt=B.test(mt=ht&&Ke?Ke["[[Class]]"]:se(Ke))?mt:Ke=null,ct,Qe=Ne,dt=[],vt=null,At=Ne==Ee,bt=At&&Ke&&typeof Ke.version=="function"&&Ke.version(),ft,Et=$t([{label:"EdgeHTML",pattern:"Edge"},"Trident",{label:"WebKit",pattern:"AppleWebKit"},"iCab","Presto","NetFront","Tasman","KHTML","Gecko"]),Ye=Ft(["Adobe AIR","Arora","Avant Browser","Breach","Camino","Electron","Epiphany","Fennec","Flock","Galeon","GreenBrowser","iCab","Iceweasel","K-Meleon","Konqueror","Lunascape","Maxthon",{label:"Microsoft Edge",pattern:"(?:Edge|Edg|EdgA|EdgiOS)"},"Midori","Nook Browser","PaleMoon","PhantomJS","Raven","Rekonq","RockMelt",{label:"Samsung Internet",pattern:"SamsungBrowser"},"SeaMonkey",{label:"Silk",pattern:"(?:Cloud9|Silk-Accelerated)"},"Sleipnir","SlimBrowser",{label:"SRWare Iron",pattern:"Iron"},"Sunrise","Swiftfox","Vivaldi","Waterfox","WebPositive",{label:"Yandex Browser",pattern:"YaBrowser"},{label:"UC Browser",pattern:"UCBrowser"},"Opera Mini",{label:"Opera Mini",pattern:"OPiOS"},"Opera",{label:"Opera",pattern:"OPR"},"Chromium","Chrome",{label:"Chrome",pattern:"(?:HeadlessChrome)"},{label:"Chrome Mobile",pattern:"(?:CriOS|CrMo)"},{label:"Firefox",pattern:"(?:Firefox|Minefield)"},{label:"Firefox for iOS",pattern:"FxiOS"},{label:"IE",pattern:"IEMobile"},{label:"IE",pattern:"MSIE"},"Safari"]),Ct=Mt([{label:"BlackBerry",pattern:"BB10"},"BlackBerry",{label:"Galaxy S",pattern:"GT-I9000"},{label:"Galaxy S2",pattern:"GT-I9100"},{label:"Galaxy S3",pattern:"GT-I9300"},{label:"Galaxy S4",pattern:"GT-I9500"},{label:"Galaxy S5",pattern:"SM-G900"},{label:"Galaxy S6",pattern:"SM-G920"},{label:"Galaxy S6 Edge",pattern:"SM-G925"},{label:"Galaxy S7",pattern:"SM-G930"},{label:"Galaxy S7 Edge",pattern:"SM-G935"},"Google TV","Lumia","iPad","iPod","iPhone","Kindle",{label:"Kindle Fire",pattern:"(?:Cloud9|Silk-Accelerated)"},"Nexus","Nook","PlayBook","PlayStation Vita","PlayStation","TouchPad","Transformer",{label:"Wii U",pattern:"WiiU"},"Wii","Xbox One",{label:"Xbox 360",pattern:"Xbox"},"Xoom"]),Pt=kt({Apple:{iPad:1,iPhone:1,iPod:1},Alcatel:{},Archos:{},Amazon:{Kindle:1,"Kindle Fire":1},Asus:{Transformer:1},"Barnes & Noble":{Nook:1},BlackBerry:{PlayBook:1},Google:{"Google TV":1,Nexus:1},HP:{TouchPad:1},HTC:{},Huawei:{},Lenovo:{},LG:{},Microsoft:{Xbox:1,"Xbox One":1},Motorola:{Xoom:1},Nintendo:{"Wii U":1,Wii:1},Nokia:{Lumia:1},Oppo:{},Samsung:{"Galaxy S":1,"Galaxy S2":1,"Galaxy S3":1,"Galaxy S4":1},Sony:{PlayStation:1,"PlayStation Vita":1},Xiaomi:{Mi:1,Redmi:1}}),St=qt(["Windows Phone","KaiOS","Android","CentOS",{label:"Chrome OS",pattern:"CrOS"},"Debian",{label:"DragonFly BSD",pattern:"DragonFly"},"Fedora","FreeBSD","Gentoo","Haiku","Kubuntu","Linux Mint","OpenBSD","Red Hat","SuSE","Ubuntu","Xubuntu","Cygwin","Symbian OS","hpwOS","webOS ","webOS","Tablet OS","Tizen","Linux","Mac OS X","Macintosh","Mac","Windows 98;","Windows "]);function $t(ur){return we(ur,function(xt,pt){return xt||RegExp("\\b"+(pt.pattern||ue(pt))+"\\b","i").exec(Ne)&&(pt.label||pt)})}function kt(ur){return we(ur,function(xt,pt,yt){return xt||(pt[Ct]||pt[/^[a-z]+(?: +[a-z]+\b)*/i.exec(Ct)]||RegExp("\\b"+ue(yt)+"(?:\\b|\\w*\\d)","i").exec(Ne))&&yt})}function Ft(ur){return we(ur,function(xt,pt){return xt||RegExp("\\b"+(pt.pattern||ue(pt))+"\\b","i").exec(Ne)&&(pt.label||pt)})}function qt(ur){return we(ur,function(xt,pt){var yt=pt.pattern||ue(pt);return!xt&&(xt=RegExp("\\b"+yt+"(?:/[\\d.]+|[ \\w.]*)","i").exec(Ne))&&(xt=z(xt,yt,pt.label||pt)),xt})}function Mt(ur){return we(ur,function(xt,pt){var yt=pt.pattern||ue(pt);return!xt&&(xt=RegExp("\\b"+yt+" *\\d+[.\\w_]*","i").exec(Ne)||RegExp("\\b"+yt+" *\\w+-[\\w]*","i").exec(Ne)||RegExp("\\b"+yt+"(?:; *(?:[a-z]+[_-])?[a-z]+\\d+|[^ ();-]*)","i").exec(Ne))&&((xt=String(pt.label&&!RegExp(yt,"i").test(pt.label)?pt.label:xt).split("/"))[1]&&!/[\d.]+/.test(xt[0])&&(xt[0]+=" "+xt[1]),pt=pt.label||pt,xt=X(xt[0].replace(RegExp(yt,"i"),pt).replace(RegExp("; *(?:"+pt+"[_-])?","i")," ").replace(RegExp("("+pt+")[-_.]?(\\w)","i"),"$1 $2"))),xt})}function Wt(ur){return we(ur,function(xt,pt){return xt||(RegExp(pt+"(?:-[\\d.]+/|(?: for [\\w-]+)?[ /-])([\\d.]+[^ ();/_-]*)","i").exec(Ne)||0)[1]||null})}function Zt(){return this.description||""}if(Et&&(Et=[Et]),/\bAndroid\b/.test(St)&&!Ct&&(ct=/\bAndroid[^;]*;(.*?)(?:Build|\) AppleWebKit)\b/i.exec(Ne))&&(Ct=Te(ct[1]).replace(/^[a-z]{2}-[a-z]{2};\s*/i,"")||null),Pt&&!Ct?Ct=Mt([Pt]):Pt&&Ct&&(Ct=Ct.replace(RegExp("^("+ue(Pt)+")[-_.\\s]","i"),Pt+" ").replace(RegExp("^("+ue(Pt)+")[-_.]?(\\w)","i"),Pt+" $2")),(ct=/\bGoogle TV\b/.exec(Ct))&&(Ct=ct[0]),/\bSimulator\b/i.test(Ne)&&(Ct=(Ct?Ct+" ":"")+"Simulator"),Ye=="Opera Mini"&&/\bOPiOS\b/.test(Ne)&&dt.push("running in Turbo/Uncompressed mode"),Ye=="IE"&&/\blike iPhone OS\b/.test(Ne)?(ct=xe(Ne.replace(/like iPhone OS/,"")),Pt=ct.manufacturer,Ct=ct.product):/^iP/.test(Ct)?(Ye||(Ye="Safari"),St="iOS"+((ct=/ OS ([\d_]+)/i.exec(Ne))?" "+ct[1].replace(/_/g,"."):"")):Ye=="Konqueror"&&/^Linux\b/i.test(St)?St="Kubuntu":Pt&&Pt!="Google"&&(/Chrome/.test(Ye)&&!/\bMobile Safari\b/i.test(Ne)||/\bVita\b/.test(Ct))||/\bAndroid\b/.test(St)&&/^Chrome/.test(Ye)&&/\bVersion\//i.test(Ne)?(Ye="Android Browser",St=/\bAndroid\b/.test(St)?St:"Android"):Ye=="Silk"?(/\bMobi/i.test(Ne)||(St="Android",dt.unshift("desktop mode")),/Accelerated *= *true/i.test(Ne)&&dt.unshift("accelerated")):Ye=="UC Browser"&&/\bUCWEB\b/.test(Ne)?dt.push("speed mode"):Ye=="PaleMoon"&&(ct=/\bFirefox\/([\d.]+)\b/.exec(Ne))?dt.push("identifying as Firefox "+ct[1]):Ye=="Firefox"&&(ct=/\b(Mobile|Tablet|TV)\b/i.exec(Ne))?(St||(St="Firefox OS"),Ct||(Ct=ct[1])):!Ye||(ct=!/\bMinefield\b/i.test(Ne)&&/\b(?:Firefox|Safari)\b/.exec(Ye))?(Ye&&!Ct&&/[\/,]|^[^(]+?\)/.test(Ne.slice(Ne.indexOf(ct+"/")+8))&&(Ye=null),(ct=Ct||Pt||St)&&(Ct||Pt||/\b(?:Android|Symbian OS|Tablet OS|webOS)\b/.test(St))&&(Ye=/[a-z]+(?: Hat)?/i.exec(/\bAndroid\b/.test(St)?St:ct)+" Browser")):Ye=="Electron"&&(ct=(/\bChrome\/([\d.]+)\b/.exec(Ne)||0)[1])&&dt.push("Chromium "+ct),bt||(bt=Wt(["(?:Cloud9|CriOS|CrMo|Edge|Edg|EdgA|EdgiOS|FxiOS|HeadlessChrome|IEMobile|Iron|Opera ?Mini|OPiOS|OPR|Raven|SamsungBrowser|Silk(?!/[\\d.]+$)|UCBrowser|YaBrowser)","Version",ue(Ye),"(?:Firefox|Minefield|NetFront)"])),(ct=Et=="iCab"&&parseFloat(bt)>3&&"WebKit"||/\bOpera\b/.test(Ye)&&(/\bOPR\b/.test(Ne)?"Blink":"Presto")||/\b(?:Midori|Nook|Safari)\b/i.test(Ne)&&!/^(?:Trident|EdgeHTML)$/.test(Et)&&"WebKit"||!Et&&/\bMSIE\b/i.test(Ne)&&(St=="Mac OS"?"Tasman":"Trident")||Et=="WebKit"&&/\bPlayStation\b(?! Vita\b)/i.test(Ye)&&"NetFront")&&(Et=[ct]),Ye=="IE"&&(ct=(/; *(?:XBLWP|ZuneWP)(\d+)/i.exec(Ne)||0)[1])?(Ye+=" Mobile",St="Windows Phone "+(/\+$/.test(ct)?ct:ct+".x"),dt.unshift("desktop mode")):/\bWPDesktop\b/i.test(Ne)?(Ye="IE Mobile",St="Windows Phone 8.x",dt.unshift("desktop mode"),bt||(bt=(/\brv:([\d.]+)/.exec(Ne)||0)[1])):Ye!="IE"&&Et=="Trident"&&(ct=/\brv:([\d.]+)/.exec(Ne))&&(Ye&&dt.push("identifying as "+Ye+(bt?" "+bt:"")),Ye="IE",bt=ct[1]),At){if(oe(Fe,"global"))if(je&&(ct=je.lang.System,Qe=ct.getProperty("os.arch"),St=St||ct.getProperty("os.name")+" "+ct.getProperty("os.version")),Ve){try{bt=Fe.require("ringo/engine").version.join("."),Ye="RingoJS"}catch{(ct=Fe.system)&&ct.global.system==Fe.system&&(Ye="Narwhal",St||(St=ct[0].os||null))}Ye||(Ye="Rhino")}else typeof Fe.process=="object"&&!Fe.process.browser&&(ct=Fe.process)&&(typeof ct.versions=="object"&&(typeof ct.versions.electron=="string"?(dt.push("Node "+ct.versions.node),Ye="Electron",bt=ct.versions.electron):typeof ct.versions.nw=="string"&&(dt.push("Chromium "+bt,"Node "+ct.versions.node),Ye="NW.js",bt=ct.versions.nw)),Ye||(Ye="Node.js",Qe=ct.arch,St=ct.platform,bt=/[\d.]+/.exec(ct.version),bt=bt?bt[0]:null));else se(ct=Fe.runtime)==Ie?(Ye="Adobe AIR",St=ct.flash.system.Capabilities.os):se(ct=Fe.phantom)==Ge?(Ye="PhantomJS",bt=(ct=ct.version||null)&&ct.major+"."+ct.minor+"."+ct.patch):typeof tt.documentMode=="number"&&(ct=/\bTrident\/(\d+)/i.exec(Ne))?(bt=[bt,tt.documentMode],(ct=+ct[1]+4)!=bt[1]&&(dt.push("IE "+bt[1]+" mode"),Et&&(Et[1]=""),bt[1]=ct),bt=Ye=="IE"?String(bt[1].toFixed(1)):bt[0]):typeof tt.documentMode=="number"&&/^(?:Chrome|Firefox)\b/.test(Ye)&&(dt.push("masking as "+Ye+" "+bt),Ye="IE",bt="11.0",Et=["Trident"],St="Windows");St=St&&X(St)}if(bt&&(ct=/(?:[ab]|dp|pre|[ab]\d+pre)(?:\d+\+?)?$/i.exec(bt)||/(?:alpha|beta)(?: ?\d)?/i.exec(Ne+";"+(At&&nt.appMinorVersion))||/\bMinefield\b/i.test(Ne)&&"a")&&(vt=/b/i.test(ct)?"beta":"alpha",bt=bt.replace(RegExp(ct+"\\+?$"),"")+(vt=="beta"?Me:Pe)+(/\d+\+?/.exec(ct)||"")),Ye=="Fennec"||Ye=="Firefox"&&/\b(?:Android|Firefox OS|KaiOS)\b/.test(St))Ye="Firefox Mobile";else if(Ye=="Maxthon"&&bt)bt=bt.replace(/\.[\d.]+/,".x");else if(/\bXbox\b/i.test(Ct))Ct=="Xbox 360"&&(St=null),Ct=="Xbox 360"&&/\bIEMobile\b/.test(Ne)&&dt.unshift("mobile mode");else if((/^(?:Chrome|IE|Opera)$/.test(Ye)||Ye&&!Ct&&!/Browser|Mobi/.test(Ye))&&(St=="Windows CE"||/Mobi/i.test(Ne)))Ye+=" Mobile";else if(Ye=="IE"&&At)try{Fe.external===null&&dt.unshift("platform preview")}catch{dt.unshift("embedded")}else(/\bBlackBerry\b/.test(Ct)||/\bBB10\b/.test(Ne))&&(ct=(RegExp(Ct.replace(/ +/g," *")+"/([.\\d]+)","i").exec(Ne)||0)[1]||bt)?(ct=[ct,/BB10/.test(Ne)],St=(ct[1]?(Ct=null,Pt="BlackBerry"):"Device Software")+" "+ct[0],bt=null):this!=Q&&Ct!="Wii"&&(At&&Ke||/Opera/.test(Ye)&&/\b(?:MSIE|Firefox)\b/i.test(Ne)||Ye=="Firefox"&&/\bOS X (?:\d+\.){2,}/.test(St)||Ye=="IE"&&(St&&!/^Win/.test(St)&&bt>5.5||/\bWindows XP\b/.test(St)&&bt>8||bt==8&&!/\bTrident\b/.test(Ne)))&&!B.test(ct=xe.call(Q,Ne.replace(B,"")+";"))&&ct.name&&(ct="ing as "+ct.name+((ct=ct.version)?" "+ct:""),B.test(Ye)?(/\bIE\b/.test(ct)&&St=="Mac OS"&&(St=null),ct="identify"+ct):(ct="mask"+ct,mt?Ye=X(mt.replace(/([a-z])([A-Z])/g,"$1 $2")):Ye="Opera",/\bIE\b/.test(ct)&&(St=null),At||(bt=null)),Et=["Presto"],dt.push(ct));(ct=(/\bAppleWebKit\/([\d.]+\+?)/i.exec(Ne)||0)[1])&&(ct=[parseFloat(ct.replace(/\.(\d)$/,".0$1")),ct],Ye=="Safari"&&ct[1].slice(-1)=="+"?(Ye="WebKit Nightly",vt="alpha",bt=ct[1].slice(0,-1)):(bt==ct[1]||bt==(ct[2]=(/\bSafari\/([\d.]+\+?)/i.exec(Ne)||0)[1]))&&(bt=null),ct[1]=(/\b(?:Headless)?Chrome\/([\d.]+)/i.exec(Ne)||0)[1],ct[0]==537.36&&ct[2]==537.36&&parseFloat(ct[1])>=28&&Et=="WebKit"&&(Et=["Blink"]),!At||!Ce&&!ct[1]?(Et&&(Et[1]="like Safari"),ct=(ct=ct[0],ct<400?1:ct<500?2:ct<526?3:ct<533?4:ct<534?"4+":ct<535?5:ct<537?6:ct<538?7:ct<601?8:ct<602?9:ct<604?10:ct<606?11:ct<608?12:"12")):(Et&&(Et[1]="like Chrome"),ct=ct[1]||(ct=ct[0],ct<530?1:ct<532?2:ct<532.05?3:ct<533?4:ct<534.03?5:ct<534.07?6:ct<534.1?7:ct<534.13?8:ct<534.16?9:ct<534.24?10:ct<534.3?11:ct<535.01?12:ct<535.02?"13+":ct<535.07?15:ct<535.11?16:ct<535.19?17:ct<536.05?18:ct<536.1?19:ct<537.01?20:ct<537.11?"21+":ct<537.13?23:ct<537.18?24:ct<537.24?25:ct<537.36?26:Et!="Blink"?"27":"28")),Et&&(Et[1]+=" "+(ct+=typeof ct=="number"?".x":/[.+]/.test(ct)?"":"+")),Ye=="Safari"&&(!bt||parseInt(bt)>45)?bt=ct:Ye=="Chrome"&&/\bHeadlessChrome/i.test(Ne)&&dt.unshift("headless")),Ye=="Opera"&&(ct=/\bzbov|zvav$/.exec(St))?(Ye+=" ",dt.unshift("desktop mode"),ct=="zvav"?(Ye+="Mini",bt=null):Ye+="Mobile",St=St.replace(RegExp(" *"+ct+"$"),"")):Ye=="Safari"&&/\bChrome\b/.exec(Et&&Et[1])?(dt.unshift("desktop mode"),Ye="Chrome Mobile",bt=null,/\bOS X\b/.test(St)?(Pt="Apple",St="iOS 4.3+"):St=null):/\bSRWare Iron\b/.test(Ye)&&!bt&&(bt=Wt("Chrome")),bt&&bt.indexOf(ct=/[\d.]+$/.exec(St))==0&&Ne.indexOf("/"+ct+"-")>-1&&(St=Te(St.replace(ct,""))),St&&St.indexOf(Ye)!=-1&&!RegExp(Ye+" OS").test(St)&&(St=St.replace(RegExp(" *"+ue(Ye)+" *"),"")),Et&&!/\b(?:Avant|Nook)\b/.test(Ye)&&(/Browser|Lunascape|Maxthon/.test(Ye)||Ye!="Safari"&&/^iOS/.test(St)&&/\bSafari\b/.test(Et[1])||/^(?:Adobe|Arora|Breach|Midori|Opera|Phantom|Rekonq|Rock|Samsung Internet|Sleipnir|SRWare Iron|Vivaldi|Web)/.test(Ye)&&Et[1])&&(ct=Et[Et.length-1])&&dt.push(ct),dt.length&&(dt=["("+dt.join("; ")+")"]),Pt&&Ct&&Ct.indexOf(Pt)<0&&dt.push("on "+Pt),Ct&&dt.push((/^on /.test(dt[dt.length-1])?"":"on ")+Ct),St&&(ct=/ ([\d.+]+)$/.exec(St),ft=ct&&St.charAt(St.length-ct[0].length-1)=="/",St={architecture:32,family:ct&&!ft?St.replace(ct[0],""):St,version:ct?ct[1]:null,toString:function(){var ur=this.version;return this.family+(ur&&!ft?" "+ur:"")+(this.architecture==64?" 64-bit":"")}}),(ct=/\b(?:AMD|IA|Win|WOW|x86_|x)64\b/i.exec(Qe))&&!/\bi686\b/i.test(Qe)?(St&&(St.architecture=64,St.family=St.family.replace(RegExp(" *"+ct),"")),Ye&&(/\bWOW64\b/i.test(Ne)||At&&/\w(?:86|32)$/.test(nt.cpuClass||nt.platform)&&!/\bWin64; x64\b/i.test(Ne))&&dt.unshift("32-bit")):St&&/^OS X/.test(St.family)&&Ye=="Chrome"&&parseFloat(bt)>=39&&(St.architecture=64),Ne||(Ne=null);var Yt={};return Yt.description=Ne,Yt.layout=Et&&Et[0],Yt.manufacturer=Pt,Yt.name=Ye,Yt.prerelease=vt,Yt.product=Ct,Yt.ua=Ne,Yt.version=Ye&&bt,Yt.os=St||{architecture:null,family:null,version:null,toString:function(){return"null"}},Yt.parse=xe,Yt.toString=Zt,Yt.version&&dt.unshift(bt),Yt.name&&dt.unshift(Ye),St&&Ye&&!(St==String(St).split(" ")[0]&&(St==Ye.split(" ")[0]||Ct))&&dt.push(Ct?"("+St+")":"on "+St),dt.length&&(Yt.description=dt.join(" ")),Yt}var Re=xe();S&&C?Q(Re,function(Ne,Fe){S[Fe]=Ne}):E.platform=Re}).call(commonjsGlobal)})(platform,platform.exports);var platformExports=platform.exports;const plateforme=getDefaultExportFromCjs(platformExports);var re$4={exports:{}};const SEMVER_SPEC_VERSION="2.0.0",MAX_LENGTH$1=256,MAX_SAFE_INTEGER$1=Number.MAX_SAFE_INTEGER||9007199254740991,MAX_SAFE_COMPONENT_LENGTH=16,MAX_SAFE_BUILD_LENGTH=MAX_LENGTH$1-6,RELEASE_TYPES=["major","premajor","minor","preminor","patch","prepatch","prerelease"];var constants$5={MAX_LENGTH:MAX_LENGTH$1,MAX_SAFE_COMPONENT_LENGTH,MAX_SAFE_BUILD_LENGTH,MAX_SAFE_INTEGER:MAX_SAFE_INTEGER$1,RELEASE_TYPES,SEMVER_SPEC_VERSION,FLAG_INCLUDE_PRERELEASE:1,FLAG_LOOSE:2},define_process_env_default$1={};const debug$2=typeof browser$1$1=="object"&&define_process_env_default$1&&define_process_env_default$1.NODE_DEBUG&&/\bsemver\b/i.test(define_process_env_default$1.NODE_DEBUG)?(...n)=>console.error("SEMVER",...n):()=>{};var debug_1=debug$2;(function(n,r){const{MAX_SAFE_COMPONENT_LENGTH:_,MAX_SAFE_BUILD_LENGTH:E,MAX_LENGTH:S}=constants$5,C=debug_1;r=n.exports={};const A=r.re=[],I=r.safeRe=[],B=r.src=[],O=r.t={};let N=0;const U="[a-zA-Z0-9-]",j=[["\\s",1],["\\d",S],[U,E]],z=X=>{for(const[Q,se]of j)X=X.split(`${Q}*`).join(`${Q}{0,${se}}`).split(`${Q}+`).join(`${Q}{1,${se}}`);return X},Z=(X,Q,se)=>{const oe=z(Q),ue=N++;C(X,ue,Q),O[X]=ue,B[ue]=Q,A[ue]=new RegExp(Q,se?"g":void 0),I[ue]=new RegExp(oe,se?"g":void 0)};Z("NUMERICIDENTIFIER","0|[1-9]\\d*"),Z("NUMERICIDENTIFIERLOOSE","\\d+"),Z("NONNUMERICIDENTIFIER",`\\d*[a-zA-Z-]${U}*`),Z("MAINVERSION",`(${B[O.NUMERICIDENTIFIER]})\\.(${B[O.NUMERICIDENTIFIER]})\\.(${B[O.NUMERICIDENTIFIER]})`),Z("MAINVERSIONLOOSE",`(${B[O.NUMERICIDENTIFIERLOOSE]})\\.(${B[O.NUMERICIDENTIFIERLOOSE]})\\.(${B[O.NUMERICIDENTIFIERLOOSE]})`),Z("PRERELEASEIDENTIFIER",`(?:${B[O.NUMERICIDENTIFIER]}|${B[O.NONNUMERICIDENTIFIER]})`),Z("PRERELEASEIDENTIFIERLOOSE",`(?:${B[O.NUMERICIDENTIFIERLOOSE]}|${B[O.NONNUMERICIDENTIFIER]})`),Z("PRERELEASE",`(?:-(${B[O.PRERELEASEIDENTIFIER]}(?:\\.${B[O.PRERELEASEIDENTIFIER]})*))`),Z("PRERELEASELOOSE",`(?:-?(${B[O.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${B[O.PRERELEASEIDENTIFIERLOOSE]})*))`),Z("BUILDIDENTIFIER",`${U}+`),Z("BUILD",`(?:\\+(${B[O.BUILDIDENTIFIER]}(?:\\.${B[O.BUILDIDENTIFIER]})*))`),Z("FULLPLAIN",`v?${B[O.MAINVERSION]}${B[O.PRERELEASE]}?${B[O.BUILD]}?`),Z("FULL",`^${B[O.FULLPLAIN]}$`),Z("LOOSEPLAIN",`[v=\\s]*${B[O.MAINVERSIONLOOSE]}${B[O.PRERELEASELOOSE]}?${B[O.BUILD]}?`),Z("LOOSE",`^${B[O.LOOSEPLAIN]}$`),Z("GTLT","((?:<|>)?=?)"),Z("XRANGEIDENTIFIERLOOSE",`${B[O.NUMERICIDENTIFIERLOOSE]}|x|X|\\*`),Z("XRANGEIDENTIFIER",`${B[O.NUMERICIDENTIFIER]}|x|X|\\*`),Z("XRANGEPLAIN",`[v=\\s]*(${B[O.XRANGEIDENTIFIER]})(?:\\.(${B[O.XRANGEIDENTIFIER]})(?:\\.(${B[O.XRANGEIDENTIFIER]})(?:${B[O.PRERELEASE]})?${B[O.BUILD]}?)?)?`),Z("XRANGEPLAINLOOSE",`[v=\\s]*(${B[O.XRANGEIDENTIFIERLOOSE]})(?:\\.(${B[O.XRANGEIDENTIFIERLOOSE]})(?:\\.(${B[O.XRANGEIDENTIFIERLOOSE]})(?:${B[O.PRERELEASELOOSE]})?${B[O.BUILD]}?)?)?`),Z("XRANGE",`^${B[O.GTLT]}\\s*${B[O.XRANGEPLAIN]}$`),Z("XRANGELOOSE",`^${B[O.GTLT]}\\s*${B[O.XRANGEPLAINLOOSE]}$`),Z("COERCEPLAIN",`(^|[^\\d])(\\d{1,${_}})(?:\\.(\\d{1,${_}}))?(?:\\.(\\d{1,${_}}))?`),Z("COERCE",`${B[O.COERCEPLAIN]}(?:$|[^\\d])`),Z("COERCEFULL",B[O.COERCEPLAIN]+`(?:${B[O.PRERELEASE]})?(?:${B[O.BUILD]})?(?:$|[^\\d])`),Z("COERCERTL",B[O.COERCE],!0),Z("COERCERTLFULL",B[O.COERCEFULL],!0),Z("LONETILDE","(?:~>?)"),Z("TILDETRIM",`(\\s*)${B[O.LONETILDE]}\\s+`,!0),r.tildeTrimReplace="$1~",Z("TILDE",`^${B[O.LONETILDE]}${B[O.XRANGEPLAIN]}$`),Z("TILDELOOSE",`^${B[O.LONETILDE]}${B[O.XRANGEPLAINLOOSE]}$`),Z("LONECARET","(?:\\^)"),Z("CARETTRIM",`(\\s*)${B[O.LONECARET]}\\s+`,!0),r.caretTrimReplace="$1^",Z("CARET",`^${B[O.LONECARET]}${B[O.XRANGEPLAIN]}$`),Z("CARETLOOSE",`^${B[O.LONECARET]}${B[O.XRANGEPLAINLOOSE]}$`),Z("COMPARATORLOOSE",`^${B[O.GTLT]}\\s*(${B[O.LOOSEPLAIN]})$|^$`),Z("COMPARATOR",`^${B[O.GTLT]}\\s*(${B[O.FULLPLAIN]})$|^$`),Z("COMPARATORTRIM",`(\\s*)${B[O.GTLT]}\\s*(${B[O.LOOSEPLAIN]}|${B[O.XRANGEPLAIN]})`,!0),r.comparatorTrimReplace="$1$2$3",Z("HYPHENRANGE",`^\\s*(${B[O.XRANGEPLAIN]})\\s+-\\s+(${B[O.XRANGEPLAIN]})\\s*$`),Z("HYPHENRANGELOOSE",`^\\s*(${B[O.XRANGEPLAINLOOSE]})\\s+-\\s+(${B[O.XRANGEPLAINLOOSE]})\\s*$`),Z("STAR","(<|>)?=?\\s*\\*"),Z("GTE0","^\\s*>=\\s*0\\.0\\.0\\s*$"),Z("GTE0PRE","^\\s*>=\\s*0\\.0\\.0-0\\s*$")})(re$4,re$4.exports);var reExports=re$4.exports;const looseOption=Object.freeze({loose:!0}),emptyOpts=Object.freeze({}),parseOptions$1=n=>n?typeof n!="object"?looseOption:n:emptyOpts;var parseOptions_1=parseOptions$1;const numeric=/^[0-9]+$/,compareIdentifiers$1=(n,r)=>{const _=numeric.test(n),E=numeric.test(r);return _&&E&&(n=+n,r=+r),n===r?0:_&&!E?-1:E&&!_?1:n<r?-1:1},rcompareIdentifiers=(n,r)=>compareIdentifiers$1(r,n);var identifiers$1={compareIdentifiers:compareIdentifiers$1,rcompareIdentifiers};const debug$1=debug_1,{MAX_LENGTH,MAX_SAFE_INTEGER}=constants$5,{safeRe:re$3,t:t$1}=reExports,parseOptions=parseOptions_1,{compareIdentifiers}=identifiers$1;let SemVer$d=class di{constructor(r,_){if(_=parseOptions(_),r instanceof di){if(r.loose===!!_.loose&&r.includePrerelease===!!_.includePrerelease)return r;r=r.version}else if(typeof r!="string")throw new TypeError(`Invalid version. Must be a string. Got type "${typeof r}".`);if(r.length>MAX_LENGTH)throw new TypeError(`version is longer than ${MAX_LENGTH} characters`);debug$1("SemVer",r,_),this.options=_,this.loose=!!_.loose,this.includePrerelease=!!_.includePrerelease;const E=r.trim().match(_.loose?re$3[t$1.LOOSE]:re$3[t$1.FULL]);if(!E)throw new TypeError(`Invalid Version: ${r}`);if(this.raw=r,this.major=+E[1],this.minor=+E[2],this.patch=+E[3],this.major>MAX_SAFE_INTEGER||this.major<0)throw new TypeError("Invalid major version");if(this.minor>MAX_SAFE_INTEGER||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>MAX_SAFE_INTEGER||this.patch<0)throw new TypeError("Invalid patch version");E[4]?this.prerelease=E[4].split(".").map(S=>{if(/^[0-9]+$/.test(S)){const C=+S;if(C>=0&&C<MAX_SAFE_INTEGER)return C}return S}):this.prerelease=[],this.build=E[5]?E[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+=`-${this.prerelease.join(".")}`),this.version}toString(){return this.version}compare(r){if(debug$1("SemVer.compare",this.version,this.options,r),!(r instanceof di)){if(typeof r=="string"&&r===this.version)return 0;r=new di(r,this.options)}return r.version===this.version?0:this.compareMain(r)||this.comparePre(r)}compareMain(r){return r instanceof di||(r=new di(r,this.options)),compareIdentifiers(this.major,r.major)||compareIdentifiers(this.minor,r.minor)||compareIdentifiers(this.patch,r.patch)}comparePre(r){if(r instanceof di||(r=new di(r,this.options)),this.prerelease.length&&!r.prerelease.length)return-1;if(!this.prerelease.length&&r.prerelease.length)return 1;if(!this.prerelease.length&&!r.prerelease.length)return 0;let _=0;do{const E=this.prerelease[_],S=r.prerelease[_];if(debug$1("prerelease compare",_,E,S),E===void 0&&S===void 0)return 0;if(S===void 0)return 1;if(E===void 0)return-1;if(E===S)continue;return compareIdentifiers(E,S)}while(++_)}compareBuild(r){r instanceof di||(r=new di(r,this.options));let _=0;do{const E=this.build[_],S=r.build[_];if(debug$1("prerelease compare",_,E,S),E===void 0&&S===void 0)return 0;if(S===void 0)return 1;if(E===void 0)return-1;if(E===S)continue;return compareIdentifiers(E,S)}while(++_)}inc(r,_,E){switch(r){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",_,E);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",_,E);break;case"prepatch":this.prerelease.length=0,this.inc("patch",_,E),this.inc("pre",_,E);break;case"prerelease":this.prerelease.length===0&&this.inc("patch",_,E),this.inc("pre",_,E);break;case"major":(this.minor!==0||this.patch!==0||this.prerelease.length===0)&&this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":(this.patch!==0||this.prerelease.length===0)&&this.minor++,this.patch=0,this.prerelease=[];break;case"patch":this.prerelease.length===0&&this.patch++,this.prerelease=[];break;case"pre":{const S=Number(E)?1:0;if(!_&&E===!1)throw new Error("invalid increment argument: identifier is empty");if(this.prerelease.length===0)this.prerelease=[S];else{let C=this.prerelease.length;for(;--C>=0;)typeof this.prerelease[C]=="number"&&(this.prerelease[C]++,C=-2);if(C===-1){if(_===this.prerelease.join(".")&&E===!1)throw new Error("invalid increment argument: identifier already exists");this.prerelease.push(S)}}if(_){let C=[_,S];E===!1&&(C=[_]),compareIdentifiers(this.prerelease[0],_)===0?isNaN(this.prerelease[1])&&(this.prerelease=C):this.prerelease=C}break}default:throw new Error(`invalid increment argument: ${r}`)}return this.raw=this.format(),this.build.length&&(this.raw+=`+${this.build.join(".")}`),this}};var semver$2=SemVer$d;const SemVer$c=semver$2,parse$7=(n,r,_=!1)=>{if(n instanceof SemVer$c)return n;try{return new SemVer$c(n,r)}catch(E){if(!_)return null;throw E}};var parse_1=parse$7;const parse$6=parse_1,valid$2=(n,r)=>{const _=parse$6(n,r);return _?_.version:null};var valid_1=valid$2;const parse$5=parse_1,clean$1=(n,r)=>{const _=parse$5(n.trim().replace(/^[=v]+/,""),r);return _?_.version:null};var clean_1=clean$1;const SemVer$b=semver$2,inc$1=(n,r,_,E,S)=>{typeof _=="string"&&(S=E,E=_,_=void 0);try{return new SemVer$b(n instanceof SemVer$b?n.version:n,_).inc(r,E,S).version}catch{return null}};var inc_1=inc$1;const parse$4=parse_1,diff$1=(n,r)=>{const _=parse$4(n,null,!0),E=parse$4(r,null,!0),S=_.compare(E);if(S===0)return null;const C=S>0,A=C?_:E,I=C?E:_,B=!!A.prerelease.length;if(!!I.prerelease.length&&!B)return!I.patch&&!I.minor?"major":A.patch?"patch":A.minor?"minor":"major";const N=B?"pre":"";return _.major!==E.major?N+"major":_.minor!==E.minor?N+"minor":_.patch!==E.patch?N+"patch":"prerelease"};var diff_1=diff$1;const SemVer$a=semver$2,major$1=(n,r)=>new SemVer$a(n,r).major;var major_1=major$1;const SemVer$9=semver$2,minor$1=(n,r)=>new SemVer$9(n,r).minor;var minor_1=minor$1;const SemVer$8=semver$2,patch$1=(n,r)=>new SemVer$8(n,r).patch;var patch_1=patch$1;const parse$3=parse_1,prerelease$1=(n,r)=>{const _=parse$3(n,r);return _&&_.prerelease.length?_.prerelease:null};var prerelease_1=prerelease$1;const SemVer$7=semver$2,compare$d=(n,r,_)=>new SemVer$7(n,_).compare(new SemVer$7(r,_));var compare_1=compare$d;const compare$c=compare_1,rcompare$1=(n,r,_)=>compare$c(r,n,_);var rcompare_1=rcompare$1;const compare$b=compare_1,compareLoose$1=(n,r)=>compare$b(n,r,!0);var compareLoose_1=compareLoose$1;const SemVer$6=semver$2,compareBuild$3=(n,r,_)=>{const E=new SemVer$6(n,_),S=new SemVer$6(r,_);return E.compare(S)||E.compareBuild(S)};var compareBuild_1=compareBuild$3;const compareBuild$2=compareBuild_1,sort$2=(n,r)=>n.sort((_,E)=>compareBuild$2(_,E,r));var sort_1=sort$2;const compareBuild$1=compareBuild_1,rsort$1=(n,r)=>n.sort((_,E)=>compareBuild$1(E,_,r));var rsort_1=rsort$1;const compare$a=compare_1,gt$4=(n,r,_)=>compare$a(n,r,_)>0;var gt_1=gt$4;const compare$9=compare_1,lt$4=(n,r,_)=>compare$9(n,r,_)<0;var lt_1=lt$4;const compare$8=compare_1,eq$2=(n,r,_)=>compare$8(n,r,_)===0;var eq_1=eq$2;const compare$7=compare_1,neq$2=(n,r,_)=>compare$7(n,r,_)!==0;var neq_1=neq$2;const compare$6=compare_1,gte$3=(n,r,_)=>compare$6(n,r,_)>=0;var gte_1=gte$3;const compare$5=compare_1,lte$3=(n,r,_)=>compare$5(n,r,_)<=0;var lte_1=lte$3;const eq$1=eq_1,neq$1=neq_1,gt$3=gt_1,gte$2=gte_1,lt$3=lt_1,lte$2=lte_1,cmp$1=(n,r,_,E)=>{switch(r){case"===":return typeof n=="object"&&(n=n.version),typeof _=="object"&&(_=_.version),n===_;case"!==":return typeof n=="object"&&(n=n.version),typeof _=="object"&&(_=_.version),n!==_;case"":case"=":case"==":return eq$1(n,_,E);case"!=":return neq$1(n,_,E);case">":return gt$3(n,_,E);case">=":return gte$2(n,_,E);case"<":return lt$3(n,_,E);case"<=":return lte$2(n,_,E);default:throw new TypeError(`Invalid operator: ${r}`)}};var cmp_1=cmp$1;const SemVer$5=semver$2,parse$2=parse_1,{safeRe:re$2,t}=reExports,coerce$3=(n,r)=>{if(n instanceof SemVer$5)return n;if(typeof n=="number"&&(n=String(n)),typeof n!="string")return null;r=r||{};let _=null;if(!r.rtl)_=n.match(r.includePrerelease?re$2[t.COERCEFULL]:re$2[t.COERCE]);else{const B=r.includePrerelease?re$2[t.COERCERTLFULL]:re$2[t.COERCERTL];let O;for(;(O=B.exec(n))&&(!_||_.index+_[0].length!==n.length);)(!_||O.index+O[0].length!==_.index+_[0].length)&&(_=O),B.lastIndex=O.index+O[1].length+O[2].length;B.lastIndex=-1}if(_===null)return null;const E=_[2],S=_[3]||"0",C=_[4]||"0",A=r.includePrerelease&&_[5]?`-${_[5]}`:"",I=r.includePrerelease&&_[6]?`+${_[6]}`:"";return parse$2(`${E}.${S}.${C}${A}${I}`,r)};var coerce_1=coerce$3,iterator$1,hasRequiredIterator;function requireIterator(){return hasRequiredIterator||(hasRequiredIterator=1,iterator$1=function(n){n.prototype[Symbol.iterator]=function*(){for(let r=this.head;r;r=r.next)yield r.value}}),iterator$1}var yallist=Yallist$1;Yallist$1.Node=Node$1;Yallist$1.create=Yallist$1;function Yallist$1(n){var r=this;if(r instanceof Yallist$1||(r=new Yallist$1),r.tail=null,r.head=null,r.length=0,n&&typeof n.forEach=="function")n.forEach(function(S){r.push(S)});else if(arguments.length>0)for(var _=0,E=arguments.length;_<E;_++)r.push(arguments[_]);return r}Yallist$1.prototype.removeNode=function(n){if(n.list!==this)throw new Error("removing node which does not belong to this list");var r=n.next,_=n.prev;return r&&(r.prev=_),_&&(_.next=r),n===this.head&&(this.head=r),n===this.tail&&(this.tail=_),n.list.length--,n.next=null,n.prev=null,n.list=null,r};Yallist$1.prototype.unshiftNode=function(n){if(n!==this.head){n.list&&n.list.removeNode(n);var r=this.head;n.list=this,n.next=r,r&&(r.prev=n),this.head=n,this.tail||(this.tail=n),this.length++}};Yallist$1.prototype.pushNode=function(n){if(n!==this.tail){n.list&&n.list.removeNode(n);var r=this.tail;n.list=this,n.prev=r,r&&(r.next=n),this.tail=n,this.head||(this.head=n),this.length++}};Yallist$1.prototype.push=function(){for(var n=0,r=arguments.length;n<r;n++)push(this,arguments[n]);return this.length};Yallist$1.prototype.unshift=function(){for(var n=0,r=arguments.length;n<r;n++)unshift(this,arguments[n]);return this.length};Yallist$1.prototype.pop=function(){if(this.tail){var n=this.tail.value;return this.tail=this.tail.prev,this.tail?this.tail.next=null:this.head=null,this.length--,n}};Yallist$1.prototype.shift=function(){if(this.head){var n=this.head.value;return this.head=this.head.next,this.head?this.head.prev=null:this.tail=null,this.length--,n}};Yallist$1.prototype.forEach=function(n,r){r=r||this;for(var _=this.head,E=0;_!==null;E++)n.call(r,_.value,E,this),_=_.next};Yallist$1.prototype.forEachReverse=function(n,r){r=r||this;for(var _=this.tail,E=this.length-1;_!==null;E--)n.call(r,_.value,E,this),_=_.prev};Yallist$1.prototype.get=function(n){for(var r=0,_=this.head;_!==null&&r<n;r++)_=_.next;if(r===n&&_!==null)return _.value};Yallist$1.prototype.getReverse=function(n){for(var r=0,_=this.tail;_!==null&&r<n;r++)_=_.prev;if(r===n&&_!==null)return _.value};Yallist$1.prototype.map=function(n,r){r=r||this;for(var _=new Yallist$1,E=this.head;E!==null;)_.push(n.call(r,E.value,this)),E=E.next;return _};Yallist$1.prototype.mapReverse=function(n,r){r=r||this;for(var _=new Yallist$1,E=this.tail;E!==null;)_.push(n.call(r,E.value,this)),E=E.prev;return _};Yallist$1.prototype.reduce=function(n,r){var _,E=this.head;if(arguments.length>1)_=r;else if(this.head)E=this.head.next,_=this.head.value;else throw new TypeError("Reduce of empty list with no initial value");for(var S=0;E!==null;S++)_=n(_,E.value,S),E=E.next;return _};Yallist$1.prototype.reduceReverse=function(n,r){var _,E=this.tail;if(arguments.length>1)_=r;else if(this.tail)E=this.tail.prev,_=this.tail.value;else throw new TypeError("Reduce of empty list with no initial value");for(var S=this.length-1;E!==null;S--)_=n(_,E.value,S),E=E.prev;return _};Yallist$1.prototype.toArray=function(){for(var n=new Array(this.length),r=0,_=this.head;_!==null;r++)n[r]=_.value,_=_.next;return n};Yallist$1.prototype.toArrayReverse=function(){for(var n=new Array(this.length),r=0,_=this.tail;_!==null;r++)n[r]=_.value,_=_.prev;return n};Yallist$1.prototype.slice=function(n,r){r=r||this.length,r<0&&(r+=this.length),n=n||0,n<0&&(n+=this.length);var _=new Yallist$1;if(r<n||r<0)return _;n<0&&(n=0),r>this.length&&(r=this.length);for(var E=0,S=this.head;S!==null&&E<n;E++)S=S.next;for(;S!==null&&E<r;E++,S=S.next)_.push(S.value);return _};Yallist$1.prototype.sliceReverse=function(n,r){r=r||this.length,r<0&&(r+=this.length),n=n||0,n<0&&(n+=this.length);var _=new Yallist$1;if(r<n||r<0)return _;n<0&&(n=0),r>this.length&&(r=this.length);for(var E=this.length,S=this.tail;S!==null&&E>r;E--)S=S.prev;for(;S!==null&&E>n;E--,S=S.prev)_.push(S.value);return _};Yallist$1.prototype.splice=function(n,r,..._){n>this.length&&(n=this.length-1),n<0&&(n=this.length+n);for(var E=0,S=this.head;S!==null&&E<n;E++)S=S.next;for(var C=[],E=0;S&&E<r;E++)C.push(S.value),S=this.removeNode(S);S===null&&(S=this.tail),S!==this.head&&S!==this.tail&&(S=S.prev);for(var E=0;E<_.length;E++)S=insert(this,S,_[E]);return C};Yallist$1.prototype.reverse=function(){for(var n=this.head,r=this.tail,_=n;_!==null;_=_.prev){var E=_.prev;_.prev=_.next,_.next=E}return this.head=r,this.tail=n,this};function insert(n,r,_){var E=r===n.head?new Node$1(_,null,r,n):new Node$1(_,r,r.next,n);return E.next===null&&(n.tail=E),E.prev===null&&(n.head=E),n.length++,E}function push(n,r){n.tail=new Node$1(r,n.tail,null,n),n.head||(n.head=n.tail),n.length++}function unshift(n,r){n.head=new Node$1(r,null,n.head,n),n.tail||(n.tail=n.head),n.length++}function Node$1(n,r,_,E){if(!(this instanceof Node$1))return new Node$1(n,r,_,E);this.list=E,this.value=n,r?(r.next=this,this.prev=r):this.prev=null,_?(_.prev=this,this.next=_):this.next=null}try{requireIterator()(Yallist$1)}catch{}const Yallist=yallist,MAX=Symbol("max"),LENGTH=Symbol("length"),LENGTH_CALCULATOR=Symbol("lengthCalculator"),ALLOW_STALE=Symbol("allowStale"),MAX_AGE=Symbol("maxAge"),DISPOSE=Symbol("dispose"),NO_DISPOSE_ON_SET=Symbol("noDisposeOnSet"),LRU_LIST=Symbol("lruList"),CACHE=Symbol("cache"),UPDATE_AGE_ON_GET=Symbol("updateAgeOnGet"),naiveLength=()=>1;class LRUCache{constructor(r){if(typeof r=="number"&&(r={max:r}),r||(r={}),r.max&&(typeof r.max!="number"||r.max<0))throw new TypeError("max must be a non-negative number");this[MAX]=r.max||1/0;const _=r.length||naiveLength;if(this[LENGTH_CALCULATOR]=typeof _!="function"?naiveLength:_,this[ALLOW_STALE]=r.stale||!1,r.maxAge&&typeof r.maxAge!="number")throw new TypeError("maxAge must be a number");this[MAX_AGE]=r.maxAge||0,this[DISPOSE]=r.dispose,this[NO_DISPOSE_ON_SET]=r.noDisposeOnSet||!1,this[UPDATE_AGE_ON_GET]=r.updateAgeOnGet||!1,this.reset()}set max(r){if(typeof r!="number"||r<0)throw new TypeError("max must be a non-negative number");this[MAX]=r||1/0,trim(this)}get max(){return this[MAX]}set allowStale(r){this[ALLOW_STALE]=!!r}get allowStale(){return this[ALLOW_STALE]}set maxAge(r){if(typeof r!="number")throw new TypeError("maxAge must be a non-negative number");this[MAX_AGE]=r,trim(this)}get maxAge(){return this[MAX_AGE]}set lengthCalculator(r){typeof r!="function"&&(r=naiveLength),r!==this[LENGTH_CALCULATOR]&&(this[LENGTH_CALCULATOR]=r,this[LENGTH]=0,this[LRU_LIST].forEach(_=>{_.length=this[LENGTH_CALCULATOR](_.value,_.key),this[LENGTH]+=_.length})),trim(this)}get lengthCalculator(){return this[LENGTH_CALCULATOR]}get length(){return this[LENGTH]}get itemCount(){return this[LRU_LIST].length}rforEach(r,_){_=_||this;for(let E=this[LRU_LIST].tail;E!==null;){const S=E.prev;forEachStep(this,r,E,_),E=S}}forEach(r,_){_=_||this;for(let E=this[LRU_LIST].head;E!==null;){const S=E.next;forEachStep(this,r,E,_),E=S}}keys(){return this[LRU_LIST].toArray().map(r=>r.key)}values(){return this[LRU_LIST].toArray().map(r=>r.value)}reset(){this[DISPOSE]&&this[LRU_LIST]&&this[LRU_LIST].length&&this[LRU_LIST].forEach(r=>this[DISPOSE](r.key,r.value)),this[CACHE]=new Map,this[LRU_LIST]=new Yallist,this[LENGTH]=0}dump(){return this[LRU_LIST].map(r=>isStale(this,r)?!1:{k:r.key,v:r.value,e:r.now+(r.maxAge||0)}).toArray().filter(r=>r)}dumpLru(){return this[LRU_LIST]}set(r,_,E){if(E=E||this[MAX_AGE],E&&typeof E!="number")throw new TypeError("maxAge must be a number");const S=E?Date.now():0,C=this[LENGTH_CALCULATOR](_,r);if(this[CACHE].has(r)){if(C>this[MAX])return del(this,this[CACHE].get(r)),!1;const B=this[CACHE].get(r).value;return this[DISPOSE]&&(this[NO_DISPOSE_ON_SET]||this[DISPOSE](r,B.value)),B.now=S,B.maxAge=E,B.value=_,this[LENGTH]+=C-B.length,B.length=C,this.get(r),trim(this),!0}const A=new Entry$1(r,_,C,S,E);return A.length>this[MAX]?(this[DISPOSE]&&this[DISPOSE](r,_),!1):(this[LENGTH]+=A.length,this[LRU_LIST].unshift(A),this[CACHE].set(r,this[LRU_LIST].head),trim(this),!0)}has(r){if(!this[CACHE].has(r))return!1;const _=this[CACHE].get(r).value;return!isStale(this,_)}get(r){return get$4(this,r,!0)}peek(r){return get$4(this,r,!1)}pop(){const r=this[LRU_LIST].tail;return r?(del(this,r),r.value):null}del(r){del(this,this[CACHE].get(r))}load(r){this.reset();const _=Date.now();for(let E=r.length-1;E>=0;E--){const S=r[E],C=S.e||0;if(C===0)this.set(S.k,S.v);else{const A=C-_;A>0&&this.set(S.k,S.v,A)}}}prune(){this[CACHE].forEach((r,_)=>get$4(this,_,!1))}}const get$4=(n,r,_)=>{const E=n[CACHE].get(r);if(E){const S=E.value;if(isStale(n,S)){if(del(n,E),!n[ALLOW_STALE])return}else _&&(n[UPDATE_AGE_ON_GET]&&(E.value.now=Date.now()),n[LRU_LIST].unshiftNode(E));return S.value}},isStale=(n,r)=>{if(!r||!r.maxAge&&!n[MAX_AGE])return!1;const _=Date.now()-r.now;return r.maxAge?_>r.maxAge:n[MAX_AGE]&&_>n[MAX_AGE]},trim=n=>{if(n[LENGTH]>n[MAX])for(let r=n[LRU_LIST].tail;n[LENGTH]>n[MAX]&&r!==null;){const _=r.prev;del(n,r),r=_}},del=(n,r)=>{if(r){const _=r.value;n[DISPOSE]&&n[DISPOSE](_.key,_.value),n[LENGTH]-=_.length,n[CACHE].delete(_.key),n[LRU_LIST].removeNode(r)}};let Entry$1=class{constructor(r,_,E,S,C){this.key=r,this.value=_,this.length=E,this.now=S,this.maxAge=C||0}};const forEachStep=(n,r,_,E)=>{let S=_.value;isStale(n,S)&&(del(n,_),n[ALLOW_STALE]||(S=void 0)),S&&r.call(E,S.value,S.key,n)};var lruCache=LRUCache,range,hasRequiredRange;function requireRange(){if(hasRequiredRange)return range;hasRequiredRange=1;class n{constructor(_e,Ie){if(Ie=E(Ie),_e instanceof n)return _e.loose===!!Ie.loose&&_e.includePrerelease===!!Ie.includePrerelease?_e:new n(_e.raw,Ie);if(_e instanceof S)return this.raw=_e.value,this.set=[[_e]],this.format(),this;if(this.options=Ie,this.loose=!!Ie.loose,this.includePrerelease=!!Ie.includePrerelease,this.raw=_e.trim().split(/\s+/).join(" "),this.set=this.raw.split("||").map(He=>this.parseRange(He.trim())).filter(He=>He.length),!this.set.length)throw new TypeError(`Invalid SemVer Range: ${this.raw}`);if(this.set.length>1){const He=this.set[0];if(this.set=this.set.filter(Be=>!Z(Be[0])),this.set.length===0)this.set=[He];else if(this.set.length>1){for(const Be of this.set)if(Be.length===1&&X(Be[0])){this.set=[Be];break}}}this.format()}format(){return this.range=this.set.map(_e=>_e.join(" ").trim()).join("||").trim(),this.range}toString(){return this.range}parseRange(_e){const He=((this.options.includePrerelease&&j)|(this.options.loose&&z))+":"+_e,Be=_.get(He);if(Be)return Be;const Ge=this.options.loose,je=Ge?I[B.HYPHENRANGELOOSE]:I[B.HYPHENRANGE];_e=_e.replace(je,nt(this.options.includePrerelease)),C("hyphen replace",_e),_e=_e.replace(I[B.COMPARATORTRIM],O),C("comparator trim",_e),_e=_e.replace(I[B.TILDETRIM],N),C("tilde trim",_e),_e=_e.replace(I[B.CARETTRIM],U),C("caret trim",_e);let Ve=_e.split(" ").map(Ke=>se(Ke,this.options)).join(" ").split(/\s+/).map(Ke=>ht(Ke,this.options));Ge&&(Ve=Ve.filter(Ke=>(C("loose invalid filter",Ke,this.options),!!Ke.match(I[B.COMPARATORLOOSE])))),C("range list",Ve);const Pe=new Map,Me=Ve.map(Ke=>new S(Ke,this.options));for(const Ke of Me){if(Z(Ke))return[Ke];Pe.set(Ke.value,Ke)}Pe.size>1&&Pe.has("")&&Pe.delete("");const tt=[...Pe.values()];return _.set(He,tt),tt}intersects(_e,Ie){if(!(_e instanceof n))throw new TypeError("a Range is required");return this.set.some(He=>Q(He,Ie)&&_e.set.some(Be=>Q(Be,Ie)&&He.every(Ge=>Be.every(je=>Ge.intersects(je,Ie)))))}test(_e){if(!_e)return!1;if(typeof _e=="string")try{_e=new A(_e,this.options)}catch{return!1}for(let Ie=0;Ie<this.set.length;Ie++)if(Ee(this.set[Ie],_e,this.options))return!0;return!1}}range=n;const r=lruCache,_=new r({max:1e3}),E=parseOptions_1,S=requireComparator(),C=debug_1,A=semver$2,{safeRe:I,t:B,comparatorTrimReplace:O,tildeTrimReplace:N,caretTrimReplace:U}=reExports,{FLAG_INCLUDE_PRERELEASE:j,FLAG_LOOSE:z}=constants$5,Z=Ce=>Ce.value==="<0.0.0-0",X=Ce=>Ce.value==="",Q=(Ce,_e)=>{let Ie=!0;const He=Ce.slice();let Be=He.pop();for(;Ie&&He.length;)Ie=He.every(Ge=>Be.intersects(Ge,_e)),Be=He.pop();return Ie},se=(Ce,_e)=>(C("comp",Ce,_e),Ce=Te(Ce,_e),C("caret",Ce),Ce=ue(Ce,_e),C("tildes",Ce),Ce=Re(Ce,_e),C("xrange",Ce),Ce=Fe(Ce,_e),C("stars",Ce),Ce),oe=Ce=>!Ce||Ce.toLowerCase()==="x"||Ce==="*",ue=(Ce,_e)=>Ce.trim().split(/\s+/).map(Ie=>we(Ie,_e)).join(" "),we=(Ce,_e)=>{const Ie=_e.loose?I[B.TILDELOOSE]:I[B.TILDE];return Ce.replace(Ie,(He,Be,Ge,je,Ve)=>{C("tilde",Ce,He,Be,Ge,je,Ve);let Pe;return oe(Be)?Pe="":oe(Ge)?Pe=`>=${Be}.0.0 <${+Be+1}.0.0-0`:oe(je)?Pe=`>=${Be}.${Ge}.0 <${Be}.${+Ge+1}.0-0`:Ve?(C("replaceTilde pr",Ve),Pe=`>=${Be}.${Ge}.${je}-${Ve} <${Be}.${+Ge+1}.0-0`):Pe=`>=${Be}.${Ge}.${je} <${Be}.${+Ge+1}.0-0`,C("tilde return",Pe),Pe})},Te=(Ce,_e)=>Ce.trim().split(/\s+/).map(Ie=>xe(Ie,_e)).join(" "),xe=(Ce,_e)=>{C("caret",Ce,_e);const Ie=_e.loose?I[B.CARETLOOSE]:I[B.CARET],He=_e.includePrerelease?"-0":"";return Ce.replace(Ie,(Be,Ge,je,Ve,Pe)=>{C("caret",Ce,Be,Ge,je,Ve,Pe);let Me;return oe(Ge)?Me="":oe(je)?Me=`>=${Ge}.0.0${He} <${+Ge+1}.0.0-0`:oe(Ve)?Ge==="0"?Me=`>=${Ge}.${je}.0${He} <${Ge}.${+je+1}.0-0`:Me=`>=${Ge}.${je}.0${He} <${+Ge+1}.0.0-0`:Pe?(C("replaceCaret pr",Pe),Ge==="0"?je==="0"?Me=`>=${Ge}.${je}.${Ve}-${Pe} <${Ge}.${je}.${+Ve+1}-0`:Me=`>=${Ge}.${je}.${Ve}-${Pe} <${Ge}.${+je+1}.0-0`:Me=`>=${Ge}.${je}.${Ve}-${Pe} <${+Ge+1}.0.0-0`):(C("no pr"),Ge==="0"?je==="0"?Me=`>=${Ge}.${je}.${Ve}${He} <${Ge}.${je}.${+Ve+1}-0`:Me=`>=${Ge}.${je}.${Ve}${He} <${Ge}.${+je+1}.0-0`:Me=`>=${Ge}.${je}.${Ve} <${+Ge+1}.0.0-0`),C("caret return",Me),Me})},Re=(Ce,_e)=>(C("replaceXRanges",Ce,_e),Ce.split(/\s+/).map(Ie=>Ne(Ie,_e)).join(" ")),Ne=(Ce,_e)=>{Ce=Ce.trim();const Ie=_e.loose?I[B.XRANGELOOSE]:I[B.XRANGE];return Ce.replace(Ie,(He,Be,Ge,je,Ve,Pe)=>{C("xRange",Ce,He,Be,Ge,je,Ve,Pe);const Me=oe(Ge),tt=Me||oe(je),Ke=tt||oe(Ve),mt=Ke;return Be==="="&&mt&&(Be=""),Pe=_e.includePrerelease?"-0":"",Me?Be===">"||Be==="<"?He="<0.0.0-0":He="*":Be&&mt?(tt&&(je=0),Ve=0,Be===">"?(Be=">=",tt?(Ge=+Ge+1,je=0,Ve=0):(je=+je+1,Ve=0)):Be==="<="&&(Be="<",tt?Ge=+Ge+1:je=+je+1),Be==="<"&&(Pe="-0"),He=`${Be+Ge}.${je}.${Ve}${Pe}`):tt?He=`>=${Ge}.0.0${Pe} <${+Ge+1}.0.0-0`:Ke&&(He=`>=${Ge}.${je}.0${Pe} <${Ge}.${+je+1}.0-0`),C("xRange return",He),He})},Fe=(Ce,_e)=>(C("replaceStars",Ce,_e),Ce.trim().replace(I[B.STAR],"")),ht=(Ce,_e)=>(C("replaceGTE0",Ce,_e),Ce.trim().replace(I[_e.includePrerelease?B.GTE0PRE:B.GTE0],"")),nt=Ce=>(_e,Ie,He,Be,Ge,je,Ve,Pe,Me,tt,Ke,mt,ct)=>(oe(He)?Ie="":oe(Be)?Ie=`>=${He}.0.0${Ce?"-0":""}`:oe(Ge)?Ie=`>=${He}.${Be}.0${Ce?"-0":""}`:je?Ie=`>=${Ie}`:Ie=`>=${Ie}${Ce?"-0":""}`,oe(Me)?Pe="":oe(tt)?Pe=`<${+Me+1}.0.0-0`:oe(Ke)?Pe=`<${Me}.${+tt+1}.0-0`:mt?Pe=`<=${Me}.${tt}.${Ke}-${mt}`:Ce?Pe=`<${Me}.${tt}.${+Ke+1}-0`:Pe=`<=${Pe}`,`${Ie} ${Pe}`.trim()),Ee=(Ce,_e,Ie)=>{for(let He=0;He<Ce.length;He++)if(!Ce[He].test(_e))return!1;if(_e.prerelease.length&&!Ie.includePrerelease){for(let He=0;He<Ce.length;He++)if(C(Ce[He].semver),Ce[He].semver!==S.ANY&&Ce[He].semver.prerelease.length>0){const Be=Ce[He].semver;if(Be.major===_e.major&&Be.minor===_e.minor&&Be.patch===_e.patch)return!0}return!1}return!0};return range}var comparator,hasRequiredComparator;function requireComparator(){if(hasRequiredComparator)return comparator;hasRequiredComparator=1;const n=Symbol("SemVer ANY");class r{static get ANY(){return n}constructor(N,U){if(U=_(U),N instanceof r){if(N.loose===!!U.loose)return N;N=N.value}N=N.trim().split(/\s+/).join(" "),A("comparator",N,U),this.options=U,this.loose=!!U.loose,this.parse(N),this.semver===n?this.value="":this.value=this.operator+this.semver.version,A("comp",this)}parse(N){const U=this.options.loose?E[S.COMPARATORLOOSE]:E[S.COMPARATOR],j=N.match(U);if(!j)throw new TypeError(`Invalid comparator: ${N}`);this.operator=j[1]!==void 0?j[1]:"",this.operator==="="&&(this.operator=""),j[2]?this.semver=new I(j[2],this.options.loose):this.semver=n}toString(){return this.value}test(N){if(A("Comparator.test",N,this.options.loose),this.semver===n||N===n)return!0;if(typeof N=="string")try{N=new I(N,this.options)}catch{return!1}return C(N,this.operator,this.semver,this.options)}intersects(N,U){if(!(N instanceof r))throw new TypeError("a Comparator is required");return this.operator===""?this.value===""?!0:new B(N.value,U).test(this.value):N.operator===""?N.value===""?!0:new B(this.value,U).test(N.semver):(U=_(U),U.includePrerelease&&(this.value==="<0.0.0-0"||N.value==="<0.0.0-0")||!U.includePrerelease&&(this.value.startsWith("<0.0.0")||N.value.startsWith("<0.0.0"))?!1:!!(this.operator.startsWith(">")&&N.operator.startsWith(">")||this.operator.startsWith("<")&&N.operator.startsWith("<")||this.semver.version===N.semver.version&&this.operator.includes("=")&&N.operator.includes("=")||C(this.semver,"<",N.semver,U)&&this.operator.startsWith(">")&&N.operator.startsWith("<")||C(this.semver,">",N.semver,U)&&this.operator.startsWith("<")&&N.operator.startsWith(">")))}}comparator=r;const _=parseOptions_1,{safeRe:E,t:S}=reExports,C=cmp_1,A=debug_1,I=semver$2,B=requireRange();return comparator}const Range$9=requireRange(),satisfies$4=(n,r,_)=>{try{r=new Range$9(r,_)}catch{return!1}return r.test(n)};var satisfies_1=satisfies$4;const Range$8=requireRange(),toComparators$1=(n,r)=>new Range$8(n,r).set.map(_=>_.map(E=>E.value).join(" ").trim().split(" "));var toComparators_1=toComparators$1;const SemVer$4=semver$2,Range$7=requireRange(),maxSatisfying$1=(n,r,_)=>{let E=null,S=null,C=null;try{C=new Range$7(r,_)}catch{return null}return n.forEach(A=>{C.test(A)&&(!E||S.compare(A)===-1)&&(E=A,S=new SemVer$4(E,_))}),E};var maxSatisfying_1=maxSatisfying$1;const SemVer$3=semver$2,Range$6=requireRange(),minSatisfying$1=(n,r,_)=>{let E=null,S=null,C=null;try{C=new Range$6(r,_)}catch{return null}return n.forEach(A=>{C.test(A)&&(!E||S.compare(A)===1)&&(E=A,S=new SemVer$3(E,_))}),E};var minSatisfying_1=minSatisfying$1;const SemVer$2=semver$2,Range$5=requireRange(),gt$2=gt_1,minVersion$1=(n,r)=>{n=new Range$5(n,r);let _=new SemVer$2("0.0.0");if(n.test(_)||(_=new SemVer$2("0.0.0-0"),n.test(_)))return _;_=null;for(let E=0;E<n.set.length;++E){const S=n.set[E];let C=null;S.forEach(A=>{const I=new SemVer$2(A.semver.version);switch(A.operator){case">":I.prerelease.length===0?I.patch++:I.prerelease.push(0),I.raw=I.format();case"":case">=":(!C||gt$2(I,C))&&(C=I);break;case"<":case"<=":break;default:throw new Error(`Unexpected operation: ${A.operator}`)}}),C&&(!_||gt$2(_,C))&&(_=C)}return _&&n.test(_)?_:null};var minVersion_1=minVersion$1;const Range$4=requireRange(),validRange$1=(n,r)=>{try{return new Range$4(n,r).range||"*"}catch{return null}};var valid$1=validRange$1;const SemVer$1=semver$2,Comparator$2=requireComparator(),{ANY:ANY$1}=Comparator$2,Range$3=requireRange(),satisfies$3=satisfies_1,gt$1=gt_1,lt$2=lt_1,lte$1=lte_1,gte$1=gte_1,outside$3=(n,r,_,E)=>{n=new SemVer$1(n,E),r=new Range$3(r,E);let S,C,A,I,B;switch(_){case">":S=gt$1,C=lte$1,A=lt$2,I=">",B=">=";break;case"<":S=lt$2,C=gte$1,A=gt$1,I="<",B="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(satisfies$3(n,r,E))return!1;for(let O=0;O<r.set.length;++O){const N=r.set[O];let U=null,j=null;if(N.forEach(z=>{z.semver===ANY$1&&(z=new Comparator$2(">=0.0.0")),U=U||z,j=j||z,S(z.semver,U.semver,E)?U=z:A(z.semver,j.semver,E)&&(j=z)}),U.operator===I||U.operator===B||(!j.operator||j.operator===I)&&C(n,j.semver))return!1;if(j.operator===B&&A(n,j.semver))return!1}return!0};var outside_1=outside$3;const outside$2=outside_1,gtr$1=(n,r,_)=>outside$2(n,r,">",_);var gtr_1=gtr$1;const outside$1=outside_1,ltr$1=(n,r,_)=>outside$1(n,r,"<",_);var ltr_1=ltr$1;const Range$2=requireRange(),intersects$1=(n,r,_)=>(n=new Range$2(n,_),r=new Range$2(r,_),n.intersects(r,_));var intersects_1=intersects$1;const satisfies$2=satisfies_1,compare$4=compare_1;var simplify=(n,r,_)=>{const E=[];let S=null,C=null;const A=n.sort((N,U)=>compare$4(N,U,_));for(const N of A)satisfies$2(N,r,_)?(C=N,S||(S=N)):(C&&E.push([S,C]),C=null,S=null);S&&E.push([S,null]);const I=[];for(const[N,U]of E)N===U?I.push(N):!U&&N===A[0]?I.push("*"):U?N===A[0]?I.push(`<=${U}`):I.push(`${N} - ${U}`):I.push(`>=${N}`);const B=I.join(" || "),O=typeof r.raw=="string"?r.raw:String(r);return B.length<O.length?B:r};const Range$1=requireRange(),Comparator$1=requireComparator(),{ANY}=Comparator$1,satisfies$1=satisfies_1,compare$3=compare_1,subset$1=(n,r,_={})=>{if(n===r)return!0;n=new Range$1(n,_),r=new Range$1(r,_);let E=!1;e:for(const S of n.set){for(const C of r.set){const A=simpleSubset(S,C,_);if(E=E||A!==null,A)continue e}if(E)return!1}return!0},minimumVersionWithPreRelease=[new Comparator$1(">=0.0.0-0")],minimumVersion=[new Comparator$1(">=0.0.0")],simpleSubset=(n,r,_)=>{if(n===r)return!0;if(n.length===1&&n[0].semver===ANY){if(r.length===1&&r[0].semver===ANY)return!0;_.includePrerelease?n=minimumVersionWithPreRelease:n=minimumVersion}if(r.length===1&&r[0].semver===ANY){if(_.includePrerelease)return!0;r=minimumVersion}const E=new Set;let S,C;for(const z of n)z.operator===">"||z.operator===">="?S=higherGT(S,z,_):z.operator==="<"||z.operator==="<="?C=lowerLT(C,z,_):E.add(z.semver);if(E.size>1)return null;let A;if(S&&C){if(A=compare$3(S.semver,C.semver,_),A>0)return null;if(A===0&&(S.operator!==">="||C.operator!=="<="))return null}for(const z of E){if(S&&!satisfies$1(z,String(S),_)||C&&!satisfies$1(z,String(C),_))return null;for(const Z of r)if(!satisfies$1(z,String(Z),_))return!1;return!0}let I,B,O,N,U=C&&!_.includePrerelease&&C.semver.prerelease.length?C.semver:!1,j=S&&!_.includePrerelease&&S.semver.prerelease.length?S.semver:!1;U&&U.prerelease.length===1&&C.operator==="<"&&U.prerelease[0]===0&&(U=!1);for(const z of r){if(N=N||z.operator===">"||z.operator===">=",O=O||z.operator==="<"||z.operator==="<=",S){if(j&&z.semver.prerelease&&z.semver.prerelease.length&&z.semver.major===j.major&&z.semver.minor===j.minor&&z.semver.patch===j.patch&&(j=!1),z.operator===">"||z.operator===">="){if(I=higherGT(S,z,_),I===z&&I!==S)return!1}else if(S.operator===">="&&!satisfies$1(S.semver,String(z),_))return!1}if(C){if(U&&z.semver.prerelease&&z.semver.prerelease.length&&z.semver.major===U.major&&z.semver.minor===U.minor&&z.semver.patch===U.patch&&(U=!1),z.operator==="<"||z.operator==="<="){if(B=lowerLT(C,z,_),B===z&&B!==C)return!1}else if(C.operator==="<="&&!satisfies$1(C.semver,String(z),_))return!1}if(!z.operator&&(C||S)&&A!==0)return!1}return!(S&&O&&!C&&A!==0||C&&N&&!S&&A!==0||j||U)},higherGT=(n,r,_)=>{if(!n)return r;const E=compare$3(n.semver,r.semver,_);return E>0?n:E<0||r.operator===">"&&n.operator===">="?r:n},lowerLT=(n,r,_)=>{if(!n)return r;const E=compare$3(n.semver,r.semver,_);return E<0?n:E>0||r.operator==="<"&&n.operator==="<="?r:n};var subset_1=subset$1;const internalRe=reExports,constants$4=constants$5,SemVer=semver$2,identifiers=identifiers$1,parse$1=parse_1,valid=valid_1,clean=clean_1,inc=inc_1,diff=diff_1,major=major_1,minor=minor_1,patch=patch_1,prerelease=prerelease_1,compare$2=compare_1,rcompare=rcompare_1,compareLoose=compareLoose_1,compareBuild=compareBuild_1,sort$1=sort_1,rsort=rsort_1,gt=gt_1,lt$1=lt_1,eq=eq_1,neq=neq_1,gte=gte_1,lte=lte_1,cmp=cmp_1,coerce$2=coerce_1,Comparator=requireComparator(),Range=requireRange(),satisfies=satisfies_1,toComparators=toComparators_1,maxSatisfying=maxSatisfying_1,minSatisfying=minSatisfying_1,minVersion=minVersion_1,validRange=valid$1,outside=outside_1,gtr=gtr_1,ltr=ltr_1,intersects=intersects_1,simplifyRange=simplify,subset=subset_1;var semver={parse:parse$1,valid,clean,inc,diff,major,minor,patch,prerelease,compare:compare$2,rcompare,compareLoose,compareBuild,sort:sort$1,rsort,gt,lt:lt$1,eq,neq,gte,lte,cmp,coerce:coerce$2,Comparator,Range,satisfies,toComparators,maxSatisfying,minSatisfying,minVersion,validRange,outside,gtr,ltr,intersects,simplifyRange,subset,SemVer,re:internalRe.re,src:internalRe.src,tokens:internalRe.t,SEMVER_SPEC_VERSION:constants$4.SEMVER_SPEC_VERSION,RELEASE_TYPES:constants$4.RELEASE_TYPES,compareIdentifiers:identifiers.compareIdentifiers,rcompareIdentifiers:identifiers.rcompareIdentifiers};const semver$1=getDefaultExportFromCjs(semver),extentionCompatible=n=>plateforme.os?.family?.includes("Ubuntu")?n==="deb":plateforme.os?.family?.includes("OS X")?n==="dmg":plateforme.os?.family?.includes("Windows")?n==="exe":!1,obtLienTlchargement=async()=>{const n=(await axios.get(IPA_TLCHARGEMENTS)).data;let r,_;for(const E of n){const S=E.name;if(!r||semver$1.gt(S,r))for(const C of E.assets){const A=C.name.split(".").pop();A&&extentionCompatible(A)&&(r=S,_=C.browser_download_url)}}return _},correspExtentions={linux:["deb","AppImage"],mac:["dmg"],windows:["exe"],source:["zip","gz"]};Object.values(correspExtentions).flat();const IPA_TLCHARGEMENTS="https://api.github.com/repos/reseau-constellation/iug/releases",ouvrirLien=n=>{window.open(n,"_blank")},VCardActions=genericComponent()({name:"VCardActions",props:makeComponentProps(),setup(n,r){let{slots:_}=r;return provideDefaults({VBtn:{slim:!0,variant:"text"}}),useRender(()=>createVNode("div",{class:["v-card-actions",n.class],style:n.style},[_.default?.()])),{}}}),VCardSubtitle=createSimpleFunctional("v-card-subtitle"),VCardTitle=createSimpleFunctional("v-card-title"),makeCardItemProps=propsFactory({appendAvatar:String,appendIcon:IconValue,prependAvatar:String,prependIcon:IconValue,subtitle:[String,Number],title:[String,Number],...makeComponentProps(),...makeDensityProps()},"VCardItem"),VCardItem=genericComponent()({name:"VCardItem",props:makeCardItemProps(),setup(n,r){let{slots:_}=r;return useRender(()=>{const E=!!(n.prependAvatar||n.prependIcon),S=!!(E||_.prepend),C=!!(n.appendAvatar||n.appendIcon),A=!!(C||_.append),I=!!(n.title!=null||_.title),B=!!(n.subtitle!=null||_.subtitle);return createVNode("div",{class:["v-card-item",n.class],style:n.style},[S&&createVNode("div",{key:"prepend",class:"v-card-item__prepend"},[_.prepend?createVNode(VDefaultsProvider,{key:"prepend-defaults",disabled:!E,defaults:{VAvatar:{density:n.density,image:n.prependAvatar},VIcon:{density:n.density,icon:n.prependIcon}}},_.prepend):createVNode(Fragment,null,[n.prependAvatar&&createVNode(VAvatar,{key:"prepend-avatar",density:n.density,image:n.prependAvatar},null),n.prependIcon&&createVNode(VIcon,{key:"prepend-icon",density:n.density,icon:n.prependIcon},null)])]),createVNode("div",{class:"v-card-item__content"},[I&&createVNode(VCardTitle,{key:"title"},{default:()=>[_.title?.()??n.title]}),B&&createVNode(VCardSubtitle,{key:"subtitle"},{default:()=>[_.subtitle?.()??n.subtitle]}),_.default?.()]),A&&createVNode("div",{key:"append",class:"v-card-item__append"},[_.append?createVNode(VDefaultsProvider,{key:"append-defaults",disabled:!C,defaults:{VAvatar:{density:n.density,image:n.appendAvatar},VIcon:{density:n.density,icon:n.appendIcon}}},_.append):createVNode(Fragment,null,[n.appendIcon&&createVNode(VIcon,{key:"append-icon",density:n.density,icon:n.appendIcon},null),n.appendAvatar&&createVNode(VAvatar,{key:"append-avatar",density:n.density,image:n.appendAvatar},null)])])])}),{}}}),VCardText=createSimpleFunctional("v-card-text"),makeVCardProps=propsFactory({appendAvatar:String,appendIcon:IconValue,disabled:Boolean,flat:Boolean,hover:Boolean,image:String,link:{type:Boolean,default:void 0},prependAvatar:String,prependIcon:IconValue,ripple:{type:[Boolean,Object],default:!0},subtitle:[String,Number],text:[String,Number],title:[String,Number],...makeBorderProps(),...makeComponentProps(),...makeDensityProps(),...makeDimensionProps(),...makeElevationProps(),...makeLoaderProps(),...makeLocationProps(),...makePositionProps(),...makeRoundedProps(),...makeRouterProps(),...makeTagProps(),...makeThemeProps(),...makeVariantProps({variant:"elevated"})},"VCard"),VCard=genericComponent()({name:"VCard",directives:{Ripple},props:makeVCardProps(),setup(n,r){let{attrs:_,slots:E}=r;const{themeClasses:S}=provideTheme(n),{borderClasses:C}=useBorder(n),{colorClasses:A,colorStyles:I,variantClasses:B}=useVariant(n),{densityClasses:O}=useDensity(n),{dimensionStyles:N}=useDimension(n),{elevationClasses:U}=useElevation(n),{loaderClasses:j}=useLoader(n),{locationStyles:z}=useLocation(n),{positionClasses:Z}=usePosition(n),{roundedClasses:X}=useRounded(n),Q=useLink(n,_),se=computed(()=>n.link!==!1&&Q.isLink.value),oe=computed(()=>!n.disabled&&n.link!==!1&&(n.link||Q.isClickable.value));return useRender(()=>{const ue=se.value?"a":n.tag,we=!!(E.title||n.title!=null),Te=!!(E.subtitle||n.subtitle!=null),xe=we||Te,Re=!!(E.append||n.appendAvatar||n.appendIcon),Ne=!!(E.prepend||n.prependAvatar||n.prependIcon),Fe=!!(E.image||n.image),ht=xe||Ne||Re,nt=!!(E.text||n.text!=null);return withDirectives(createVNode(ue,{class:["v-card",{"v-card--disabled":n.disabled,"v-card--flat":n.flat,"v-card--hover":n.hover&&!(n.disabled||n.flat),"v-card--link":oe.value},S.value,C.value,A.value,O.value,U.value,j.value,Z.value,X.value,B.value,n.class],style:[I.value,N.value,z.value,n.style],href:Q.href.value,onClick:oe.value&&Q.navigate,tabindex:n.disabled?-1:void 0},{default:()=>[Fe&&createVNode("div",{key:"image",class:"v-card__image"},[E.image?createVNode(VDefaultsProvider,{key:"image-defaults",disabled:!n.image,defaults:{VImg:{cover:!0,src:n.image}}},E.image):createVNode(VImg,{key:"image-img",cover:!0,src:n.image},null)]),createVNode(LoaderSlot,{name:"v-card",active:!!n.loading,color:typeof n.loading=="boolean"?void 0:n.loading},{default:E.loader}),ht&&createVNode(VCardItem,{key:"item",prependAvatar:n.prependAvatar,prependIcon:n.prependIcon,title:n.title,subtitle:n.subtitle,appendAvatar:n.appendAvatar,appendIcon:n.appendIcon},{default:E.item,prepend:E.prepend,title:E.title,subtitle:E.subtitle,append:E.append}),nt&&createVNode(VCardText,{key:"text"},{default:()=>[E.text?.()??n.text]}),E.default?.(),E.actions&&createVNode(VCardActions,null,{default:E.actions}),genOverlays(oe.value,"v-card")]}),[[resolveDirective("ripple"),oe.value&&n.ripple]])}),{}}}),_sfc_main$b=defineComponent$1({__name:"CarteLien",props:{lien:{},titre:{},icne:{},emphase:{type:Boolean}},setup(n){return(r,_)=>(openBlock(),createBlock(VCard,{class:"ma-2 pa-2",variant:"outlined",color:r.emphase?"primary":"secondary",onClick:_[0]||(_[0]=()=>unref(ouvrirLien)(r.lien))},{default:withCtx(()=>[createVNode(VCardItem,null,{default:withCtx(()=>[createVNode(VCardTitle,null,{default:withCtx(()=>[createTextVNode(toDisplayString(r.titre),1)]),_:1})]),_:1}),createVNode(VCardText,{class:"text-center"},{default:withCtx(()=>[createVNode(VIcon,{icon:r.icne,size:"50"},null,8,["icon"])]),_:1})]),_:1},8,["color"]))}});var define_process_env_default={};const COURRIEL_CONTACT="julien.malard@mail.mcgill.ca",URL_CODE_SOURCE="https://github.com/reseau-constellation",URL_DONNES_EXEMPLE="https://drive.google.com/drive/folders/1L-nZ2rhkJUtyL0L-mpSxzOT9Y5BdCruj?usp=sharing",URL_DONNES_LIEN="https://docs.google.com/spreadsheets/d/15_Kmiu2MRqCf23ZspeD-Ex9x3cUYlisJM9cc9ynayow/",ID_NUE_DONNES=define_process_env_default.VITE_ID_NUE_DONNES||"/orbitdb/zdpuAvWUWrZouLuJ5PVdEhNJ85tAPPuJcmw3hiDQMRsMkqgoy",CLEF_TABLEAU="11df704f-0b99-41f9-92fb-e8394ab83f88",ID_VAR_ID="/orbitdb/zdpuAwz2z5zKLHzKrdWY5bytWudXc6B2XCdH8x2uKj7HBxoYq",ID_VAR_HORO="/orbitdb/zdpuArcD64xg1vnrGutGyMSESiGQomXFxAxy4kPTUP1L6bDzV",ID_VAR_LAT="/orbitdb/zdpuAycMzQDbpJt6xvMjWGAHyn2Wya6RS6hQcKdK9QNZispex",ID_VAR_LONG="/orbitdb/zdpuAzaZ3u9oPYqF9gukynpSvM2fMxSCD4wLx4qrxcq9R8A8k",ID_VAR_PRECIP="/orbitdb/zdpuB2fu7mWLyhMxxBatYBPsBCiQcMW6xqsggb9HMKHZcnMtt",ID_COL_ID="idObservation",ID_COL_HORO="heureObservation",ID_COL_LAT="latitude",ID_COL_LONG="longitude",ID_COL_PRECIP="prcipitation",SCHMA_DONNES={licence:"ODbl-1_0",nues:[ID_NUE_DONNES],tableaux:[{clef:CLEF_TABLEAU,cols:[{idVariable:ID_VAR_ID,idColonne:ID_COL_ID},{idVariable:ID_VAR_HORO,idColonne:ID_COL_HORO},{idVariable:ID_VAR_LAT,idColonne:ID_COL_LAT},{idVariable:ID_VAR_LONG,idColonne:ID_COL_LONG},{idVariable:ID_VAR_PRECIP,idColonne:ID_COL_PRECIP}]}]},_hoisted_1$5={class:"d-flex justify-center flex-wrap mb-6"},_sfc_main$a=defineComponent$1({__name:"SectionObtConstellation",props:{nEtapes:{},etape:{}},emits:["retour","avancer"],setup(n,{emit:r}){const _=r,{_:E}=_(),{$:S}=E(),{:C}=_(),{mdAndUp:A}=useDisplay(),I=ref$2();onMounted(async()=>{I.value=await obtLienTlchargement()});const B=computed(()=>`https://appli.rseau-constellation.ca/?lg=${C.value}`),O=computed(()=>`https://docu.rseau-constellation.ca/${C.value}`);return(N,U)=>(openBlock(),createBlock(_sfc_main$f,{"n-etapes":N.nEtapes,etape:N.etape,onRetour:U[0]||(U[0]=()=>_("retour")),onAvancer:U[1]||(U[1]=()=>_("avancer"))},{default:withCtx(()=>[createVNode(VCol,{class:normalizeClass([unref(A)?"text-h2":"text-h3","text-center"]),cols:12},{default:withCtx(()=>[createTextVNode(toDisplayString(unref(S)("obtConstellation.titre")),1)]),_:1},8,["class"]),createVNode(VCol,{cols:12},{default:withCtx(()=>[createBaseVNode("div",_hoisted_1$5,[I.value?(openBlock(),createBlock(_sfc_main$b,{key:0,titre:unref(S)("obtConstellation.options.tlcharger"),icne:"mdi-download-outline",lien:I.value,emphase:""},null,8,["titre","lien"])):createCommentVNode("",!0),createVNode(_sfc_main$b,{titre:unref(S)("obtConstellation.options.navig"),icne:"mdi-open-in-new",lien:B.value,emphase:!I.value},null,8,["titre","lien","emphase"]),createVNode(_sfc_main$b,{titre:unref(S)("obtConstellation.options.docu"),icne:"mdi-book-outline",lien:O.value},null,8,["titre","lien"]),createVNode(_sfc_main$b,{titre:unref(S)("obtConstellation.options.codeSource"),icne:"mdi-xml",lien:unref(URL_CODE_SOURCE)},null,8,["titre","lien"])])]),_:1})]),_:1},8,["n-etapes","etape"]))}}),_hoisted_1$4={class:"d-flex justify-center flex-wrap mb-6"},lienSourceDonnes="https://climate.meteo.gc.ca",_sfc_main$9=defineComponent$1({__name:"SectionTlchargerDonnes",props:{nEtapes:{},etape:{}},emits:["retour","avancer"],setup(n,{emit:r}){const _=r,{mdAndUp:E}=useDisplay(),{_:S}=_(),{$:C}=S({});return(A,I)=>(openBlock(),createBlock(_sfc_main$f,{"n-etapes":A.nEtapes,etape:A.etape,onRetour:I[1]||(I[1]=()=>_("retour")),onAvancer:I[2]||(I[2]=()=>_("avancer"))},{default:withCtx(()=>[createVNode(VCol,{class:normalizeClass([unref(E)?"text-h2":"text-h3","text-center"]),cols:12},{default:withCtx(()=>[createTextVNode(toDisplayString(unref(C)("donnes.titre")),1)]),_:1},8,["class"]),createVNode(VCol,{cols:12},{default:withCtx(()=>[createBaseVNode("div",_hoisted_1$4,[createVNode(_sfc_main$b,{titre:unref(C)("donnes.tlcharger"),lien:unref(URL_DONNES_EXEMPLE),icne:"mdi-download-outline",emphase:""},null,8,["titre","lien"]),createVNode(_sfc_main$b,{titre:unref(C)("donnes.lienDynamique"),lien:unref(URL_DONNES_LIEN),icne:"mdi-link"},null,8,["titre","lien"])])]),_:1}),createVNode(VCol,{cols:12,class:"text-center"},{default:withCtx(()=>[createBaseVNode("span",{class:"text-disabled",onClick:I[0]||(I[0]=()=>unref(ouvrirLien)("https://climate.meteo.gc.ca"))},[createTextVNode(toDisplayString(unref(C)("donnes.crdits"))+" "+toDisplayString(lienSourceDonnes)+" ",1),createVNode(VIcon,{icon:"mdi-open-in-new",size:"small"})])]),_:1})]),_:1},8,["n-etapes","etape"]))}}),ce=(n,r)=>{for(const _ of Object.keys(r))n.on(_,r[_])},ye=n=>{for(const r of Object.keys(n)){const _=n[r];_&&k(_.cancel)&&_.cancel()}},Je=n=>!n||typeof n.charAt!="function"?n:n.charAt(0).toUpperCase()+n.slice(1),k=n=>typeof n=="function",L=(n,r,_)=>{for(const E in _){const S="set"+Je(E);n[S]?watch(()=>_[E],(C,A)=>{n[S](C,A)}):r[S]&&watch(()=>_[E],C=>{r[S](C)})}},f=(n,r,_={})=>{const E={..._};for(const S in n){const C=r[S],A=n[S];C&&(C&&C.custom===!0||A!==void 0&&(E[S]=A))}return E},T=n=>{const r={},_={};for(const E in n)if(E.startsWith("on")&&!E.startsWith("onUpdate")&&E!=="onReady"){const S=E.slice(2).toLocaleLowerCase();r[S]=n[E]}else _[E]=n[E];return{listeners:r,attrs:_}},qe=async n=>{const r=await Promise.all([__vitePreload(()=>import("./marker-icon-2x-D4k_ikNW.js"),__vite__mapDeps([])),__vitePreload(()=>import("./marker-icon-C2eJqgqv.js"),__vite__mapDeps([])),__vitePreload(()=>import("./marker-shadow-DU6CIJ0p.js"),__vite__mapDeps([]))]);delete n.Default.prototype._getIconUrl,n.Default.mergeOptions({iconRetinaUrl:r[0].default,iconUrl:r[1].default,shadowUrl:r[2].default})},Y=n=>{const r=ref$2((...E)=>console.warn(`Method ${n} has been invoked without being replaced`)),_=(...E)=>r.value(...E);return _.wrapped=r,provide(n,_),_},V$1=(n,r)=>n.wrapped.value=r,b=typeof self=="object"&&self.self===self&&self||typeof global$1=="object"&&global$1.global===global$1&&global$1||globalThis,m=n=>{const r=inject$1(n);if(r===void 0)throw new Error(`Attempt to inject ${n.description} before it was provided.`);return r},h=Symbol("useGlobalLeaflet"),M=Symbol("addLayer"),ee=Symbol("removeLayer"),H=Symbol("registerControl"),me=Symbol("registerLayerControl"),ve=Symbol("canSetParentHtml"),be=Symbol("setParentHtml"),fe=Symbol("setIcon"),ge=Symbol("bindPopup"),Le=Symbol("bindTooltip"),he=Symbol("unbindPopup"),Oe=Symbol("unbindTooltip"),W={options:{type:Object,default:()=>({}),custom:!0}},J=n=>({options:n.options,methods:{}}),D={...W,pane:{type:String},attribution:{type:String},name:{type:String,custom:!0},layerType:{type:String,custom:!0},visible:{type:Boolean,custom:!0,default:!0}},q=(n,r,_)=>{const E=m(M),S=m(ee),{options:C,methods:A}=J(n),I=f(n,D,C),B=()=>E({leafletObject:r.value}),O=()=>S({leafletObject:r.value}),N={...A,setAttribution(U){O(),r.value.options.attribution=U,n.visible&&B()},setName(){O(),n.visible&&B()},setLayerType(){O(),n.visible&&B()},setVisible(U){r.value&&(U?B():O())},bindPopup(U){if(!r.value||!k(r.value.bindPopup)){console.warn("Attempt to bind popup before bindPopup method available on layer.");return}r.value.bindPopup(U)},bindTooltip(U){if(!r.value||!k(r.value.bindTooltip)){console.warn("Attempt to bind tooltip before bindTooltip method available on layer.");return}r.value.bindTooltip(U)},unbindTooltip(){r.value&&(k(r.value.closeTooltip)&&r.value.closeTooltip(),k(r.value.unbindTooltip)&&r.value.unbindTooltip())},unbindPopup(){r.value&&(k(r.value.closePopup)&&r.value.closePopup(),k(r.value.unbindPopup)&&r.value.unbindPopup())},updateVisibleProp(U){_.emit("update:visible",U)}};return provide(ge,N.bindPopup),provide(Le,N.bindTooltip),provide(he,N.unbindPopup),provide(Oe,N.unbindTooltip),onUnmounted(()=>{N.unbindPopup(),N.unbindTooltip(),O()}),{options:I,methods:N}},G=(n,r)=>{if(n&&r.default)return h$2("div",{style:{display:"none"}},r.default())},Se={...D,interactive:{type:Boolean,default:void 0},bubblingMouseEvents:{type:Boolean,default:void 0}},ne={...Se,stroke:{type:Boolean,default:void 0},color:{type:String},weight:{type:Number},opacity:{type:Number},lineCap:{type:String},lineJoin:{type:String},dashArray:{type:String},dashOffset:{type:String},fill:{type:Boolean,default:void 0},fillColor:{type:String},fillOpacity:{type:Number},fillRule:{type:String},className:{type:String}},re$1={...ne,radius:{type:Number},latLng:{type:[Object,Array],required:!0,custom:!0}};({...re$1});const F={...W,position:{type:String}},K$1=(n,r)=>{const{options:_,methods:E}=J(n),S=f(n,F,_),C={...E,setPosition(A){r.value&&r.value.setPosition(A)}};return onUnmounted(()=>{r.value&&r.value.remove()}),{options:S,methods:C}},Xe=n=>n.default?h$2("div",{ref:"root"},n.default()):null;({...F});({...F});({...F});({...F});({...F});const te={...D};({...te});({...te});const ae={...D,opacity:{type:Number},zIndex:{type:Number},tileSize:{type:[Number,Array,Object]},noWrap:{type:Boolean,default:void 0},minZoom:{type:Number},maxZoom:{type:Number},className:{type:String}},Ae=(n,r,_)=>{const{options:E,methods:S}=q(n,r,_),C=f(n,ae,E),A={...S,setTileComponent(){var I;(I=r.value)==null||I.redraw()}};return onUnmounted(()=>{r.value.off()}),{options:C,methods:A}},ot=(n,r,_,E)=>n.extend({initialize(S){this.tileComponents={},this.on("tileunload",this._unloadTile),_.setOptions(this,S)},createTile(S){const C=this._tileCoordsToKey(S);this.tileComponents[C]=r.create("div");const A=h$2({setup:E,props:["coords"]},{coords:S});return render(A,this.tileComponents[C]),this.tileComponents[C]},_unloadTile(S){const C=this._tileCoordsToKey(S.coords);this.tileComponents[C]&&(this.tileComponents[C].innerHTML="",this.tileComponents[C]=void 0)}});({...ae});const de={iconUrl:{type:String},iconRetinaUrl:{type:String},iconSize:{type:[Object,Array]},iconAnchor:{type:[Object,Array]},popupAnchor:{type:[Object,Array]},tooltipAnchor:{type:[Object,Array]},shadowUrl:{type:String},shadowRetinaUrl:{type:String},shadowSize:{type:[Object,Array]},shadowAnchor:{type:[Object,Array]},bgPos:{type:[Object,Array]},className:{type:String}};({...de,...W});({...D});function rt(n,r,_){var E,S,C;r===void 0&&(r=50),_===void 0&&(_={});var A=(E=_.isImmediate)!=null&&E,I=(S=_.callback)!=null&&S,B=_.maxWait,O=Date.now(),N=[];function U(){if(B!==void 0){var z=Date.now()-O;if(z+r>=B)return B-z}return r}var j=function(){var z=[].slice.call(arguments),Z=this;return new Promise(function(X,Q){var se=A&&C===void 0;if(C!==void 0&&clearTimeout(C),C=setTimeout(function(){if(C=void 0,O=Date.now(),!A){var ue=n.apply(Z,z);I&&I(ue),N.forEach(function(we){return(0,we.resolve)(ue)}),N=[]}},U()),se){var oe=n.apply(Z,z);return I&&I(oe),X(oe)}N.push({resolve:X,reject:Q})})};return j.cancel=function(z){C!==void 0&&clearTimeout(C),N.forEach(function(Z){return(0,Z.reject)(z)}),N=[]},j}const We={...W,center:{type:[Object,Array]},bounds:{type:[Array,Object]},maxBounds:{type:[Array,Object]},zoom:{type:Number},minZoom:{type:Number},maxZoom:{type:Number},paddingBottomRight:{type:[Object,Array]},paddingTopLeft:{type:Object},padding:{type:Object},worldCopyJump:{type:Boolean,default:void 0},crs:{type:[String,Object]},maxBoundsViscosity:{type:Number},inertia:{type:Boolean,default:void 0},inertiaDeceleration:{type:Number},inertiaMaxSpeed:{type:Number},easeLinearity:{type:Number},zoomAnimation:{type:Boolean,default:void 0},zoomAnimationThreshold:{type:Number},fadeAnimation:{type:Boolean,default:void 0},markerZoomAnimation:{type:Boolean,default:void 0},noBlockingAnimations:{type:Boolean,default:void 0},useGlobalLeaflet:{type:Boolean,default:!0,custom:!0}},io=defineComponent$1({inheritAttrs:!1,emits:["ready","update:zoom","update:center","update:bounds"],props:We,setup(n,r){const _=ref$2(),E=reactive({ready:!1,layersToAdd:[],layersInControl:[]}),{options:S}=J(n),C=f(n,We,S),{listeners:A,attrs:I}=T(r.attrs),B=Y(M),O=Y(ee),N=Y(H),U=Y(me);provide(h,n.useGlobalLeaflet);const j=computed(()=>{const se={};return n.noBlockingAnimations&&(se.animate=!1),se}),z=computed(()=>{const se=j.value;return n.padding&&(se.padding=n.padding),n.paddingTopLeft&&(se.paddingTopLeft=n.paddingTopLeft),n.paddingBottomRight&&(se.paddingBottomRight=n.paddingBottomRight),se}),Z={moveend:rt(se=>{E.leafletRef&&(r.emit("update:zoom",E.leafletRef.getZoom()),r.emit("update:center",E.leafletRef.getCenter()),r.emit("update:bounds",E.leafletRef.getBounds()))}),overlayadd(se){const oe=E.layersInControl.find(ue=>ue.name===se.name);oe&&oe.updateVisibleProp(!0)},overlayremove(se){const oe=E.layersInControl.find(ue=>ue.name===se.name);oe&&oe.updateVisibleProp(!1)}};onMounted(async()=>{n.useGlobalLeaflet&&(b.L=b.L||await __vitePreload(()=>import("./leaflet-src-yxRbgpNL.js").then(Fe=>Fe.l),__vite__mapDeps([])));const{map:se,CRS:oe,Icon:ue,latLngBounds:we,latLng:Te,stamp:xe}=n.useGlobalLeaflet?b.L:await __vitePreload(()=>import("./leaflet-src.esm-HdBnhJze.js"),__vite__mapDeps([]));try{C.beforeMapMount&&await C.beforeMapMount()}catch(Fe){console.error(`The following error occurred running the provided beforeMapMount hook ${Fe.message}`)}await qe(ue);const Re=typeof C.crs=="string"?oe[C.crs]:C.crs;C.crs=Re||oe.EPSG3857;const Ne={addLayer(Fe){Fe.layerType!==void 0&&(E.layerControl===void 0?E.layersToAdd.push(Fe):E.layersInControl.find(ht=>xe(ht.leafletObject)===xe(Fe.leafletObject))||(E.layerControl.addLayer(Fe),E.layersInControl.push(Fe))),Fe.visible!==!1&&E.leafletRef.addLayer(Fe.leafletObject)},removeLayer(Fe){Fe.layerType!==void 0&&(E.layerControl===void 0?E.layersToAdd=E.layersToAdd.filter(ht=>ht.name!==Fe.name):(E.layerControl.removeLayer(Fe.leafletObject),E.layersInControl=E.layersInControl.filter(ht=>xe(ht.leafletObject)!==xe(Fe.leafletObject)))),E.leafletRef.removeLayer(Fe.leafletObject)},registerLayerControl(Fe){E.layerControl=Fe,E.layersToAdd.forEach(ht=>{E.layerControl.addLayer(ht)}),E.layersToAdd=[],N(Fe)},registerControl(Fe){E.leafletRef.addControl(Fe.leafletObject)},setZoom(Fe){const ht=E.leafletRef.getZoom();Fe!==ht&&E.leafletRef.setZoom(Fe,j.value)},setCrs(Fe){const ht=E.leafletRef.getBounds();E.leafletRef.options.crs=Fe,E.leafletRef.fitBounds(ht,{animate:!1,padding:[0,0]})},fitBounds(Fe){E.leafletRef.fitBounds(Fe,z.value)},setBounds(Fe){if(!Fe)return;const ht=we(Fe);ht.isValid()&&!(E.lastSetBounds||E.leafletRef.getBounds()).equals(ht,0)&&(E.lastSetBounds=ht,E.leafletRef.fitBounds(ht))},setCenter(Fe){if(Fe==null)return;const ht=Te(Fe),nt=E.lastSetCenter||E.leafletRef.getCenter();(nt.lat!==ht.lat||nt.lng!==ht.lng)&&(E.lastSetCenter=ht,E.leafletRef.panTo(ht,j.value))}};V$1(B,Ne.addLayer),V$1(O,Ne.removeLayer),V$1(N,Ne.registerControl),V$1(U,Ne.registerLayerControl),E.leafletRef=markRaw(se(_.value,C)),L(Ne,E.leafletRef,n),ce(E.leafletRef,Z),ce(E.leafletRef,A),E.ready=!0,nextTick$3(()=>r.emit("ready",E.leafletRef))}),onBeforeUnmount(()=>{ye(Z),E.leafletRef&&(E.leafletRef.off(),E.leafletRef.remove())});const X=computed(()=>E.leafletRef),Q=computed(()=>E.ready);return{root:_,ready:Q,leafletObject:X,attrs:I}},render({attrs:n}){return n.style||(n.style={}),n.style.width||(n.style.width="100%"),n.style.height||(n.style.height="100%"),h$2("div",{...n,ref:"root"},this.ready&&this.$slots.default?this.$slots.default():{})}}),Gt=["Symbol(Comment)","Symbol(Text)"],zt=["LTooltip","LPopup"],ze={...D,draggable:{type:Boolean,default:void 0},icon:{type:[Object]},zIndexOffset:{type:Number},latLng:{type:[Object,Array],custom:!0,required:!0}},st=(n,r,_)=>{const{options:E,methods:S}=q(n,r,_),C=f(n,ze,E),A={...S,setDraggable(I){r.value.dragging&&(I?r.value.dragging.enable():r.value.dragging.disable())},latLngSync(I){_.emit("update:latLng",I.latlng),_.emit("update:lat-lng",I.latlng)},setLatLng(I){if(I!=null&&r.value){const B=r.value.getLatLng();(!B||!B.equals(I))&&r.value.setLatLng(I)}}};return{options:C,methods:A}},at=(n,r)=>{const _=r.slots.default&&r.slots.default();return _&&_.length&&_.some(Nt)};function Nt(n){return!(Gt.includes(n.type.toString())||zt.includes(n.type.name))}const uo=defineComponent$1({name:"LMarker",props:ze,setup(n,r){const _=ref$2(),E=ref$2(!1),S=inject$1(h),C=m(M);provide(ve,()=>{var O;return!!((O=_.value)!=null&&O.getElement())}),provide(be,O=>{var N,U;const j=k((N=_.value)==null?void 0:N.getElement)&&((U=_.value)==null?void 0:U.getElement());j&&(j.innerHTML=O)}),provide(fe,O=>{var N;return((N=_.value)==null?void 0:N.setIcon)&&_.value.setIcon(O)});const{options:A,methods:I}=st(n,_,r),B={moveHandler:rt(I.latLngSync)};return onMounted(async()=>{const{marker:O,divIcon:N}=S?b.L:await __vitePreload(()=>import("./leaflet-src.esm-HdBnhJze.js"),__vite__mapDeps([]));at(A,r)&&(A.icon=N({className:""})),_.value=markRaw(O(n.latLng,A));const{listeners:U}=T(r.attrs);_.value.on(U),_.value.on("move",B.moveHandler),L(I,_.value,n),C({...n,...I,leafletObject:_.value}),E.value=!0,nextTick$3(()=>r.emit("ready",_.value))}),onBeforeUnmount(()=>ye(B)),{ready:E,leafletObject:_}},render(){return G(this.ready,this.$slots)}}),le={...ne,smoothFactor:{type:Number},noClip:{type:Boolean,default:void 0},latLngs:{type:Array,required:!0,custom:!0}},x$1={...le},ke={...W,content:{type:String,default:null}},Ue=(n,r)=>{const{options:_,methods:E}=J(n),S={...E,setContent(C){r.value&&C!==null&&C!==void 0&&r.value.setContent(C)}};return{options:_,methods:S}},De=n=>n.default?h$2("div",{ref:"root"},n.default()):null,lt={...ke,latLng:{type:[Object,Array],default:()=>[]}},it=(n,r)=>{const{options:_,methods:E}=Ue(n,r);return{options:_,methods:E}},yo=defineComponent$1({name:"LPopup",props:lt,setup(n,r){const _=ref$2(),E=ref$2(null),S=inject$1(h),C=m(ge),A=m(he),{options:I,methods:B}=it(n,_);return onMounted(async()=>{const{popup:O}=S?b.L:await __vitePreload(()=>import("./leaflet-src.esm-HdBnhJze.js"),__vite__mapDeps([]));_.value=markRaw(O(I)),n.latLng!==void 0&&_.value.setLatLng(n.latLng),L(B,_.value,n);const{listeners:N}=T(r.attrs);_.value.on(N),_.value.setContent(n.content||E.value||""),C(_.value),nextTick$3(()=>r.emit("ready",_.value))}),onBeforeUnmount(()=>{A()}),{root:E,leafletObject:_}},render(){return De(this.$slots)}});({...x$1,latLngs:{...x$1.latLngs}});const ie={...ae,tms:{type:Boolean,default:void 0},subdomains:{type:[String,Array],validator:n=>typeof n=="string"?!0:Array.isArray(n)?n.every(r=>typeof r=="string"):!1},detectRetina:{type:Boolean,default:void 0},url:{type:String,required:!0,custom:!0}},Ze=(n,r,_)=>{const{options:E,methods:S}=Ae(n,r,_),C=f(n,ie,E),A={...S};return{options:C,methods:A}},vo=defineComponent$1({props:ie,setup(n,r){const _=ref$2(),E=inject$1(h),S=m(M),{options:C,methods:A}=Ze(n,_,r);return onMounted(async()=>{const{tileLayer:I}=E?b.L:await __vitePreload(()=>import("./leaflet-src.esm-HdBnhJze.js"),__vite__mapDeps([]));_.value=markRaw(I(n.url,C));const{listeners:B}=T(r.attrs);_.value.on(B),L(A,_.value,n),S({...n,...A,leafletObject:_.value}),nextTick$3(()=>r.emit("ready",_.value))}),{leafletObject:_}},render(){return null}});({...ke});({...ie});function ascending$1(n,r){return n==null||r==null?NaN:n<r?-1:n>r?1:n>=r?0:NaN}function descending(n,r){return n==null||r==null?NaN:r<n?-1:r>n?1:r>=n?0:NaN}function bisector(n){let r,_,E;n.length!==2?(r=ascending$1,_=(I,B)=>ascending$1(n(I),B),E=(I,B)=>n(I)-B):(r=n===ascending$1||n===descending?n:zero$2,_=n,E=n);function S(I,B,O=0,N=I.length){if(O<N){if(r(B,B)!==0)return N;do{const U=O+N>>>1;_(I[U],B)<0?O=U+1:N=U}while(O<N)}return O}function C(I,B,O=0,N=I.length){if(O<N){if(r(B,B)!==0)return N;do{const U=O+N>>>1;_(I[U],B)<=0?O=U+1:N=U}while(O<N)}return O}function A(I,B,O=0,N=I.length){const U=S(I,B,O,N-1);return U>O&&E(I[U-1],B)>-E(I[U],B)?U-1:U}return{left:S,center:A,right:C}}function zero$2(){return 0}function number$6(n){return n===null?NaN:+n}const ascendingBisect=bisector(ascending$1),bisectRight=ascendingBisect.right;bisector(number$6).center;function extent(n,r){let _,E;if(r===void 0)for(const S of n)S!=null&&(_===void 0?S>=S&&(_=E=S):(_>S&&(_=S),E<S&&(E=S)));else{let S=-1;for(let C of n)(C=r(C,++S,n))!=null&&(_===void 0?C>=C&&(_=E=C):(_>C&&(_=C),E<C&&(E=C)))}return[_,E]}const e10=Math.sqrt(50),e5=Math.sqrt(10),e2=Math.sqrt(2);function tickSpec(n,r,_){const E=(r-n)/Math.max(0,_),S=Math.floor(Math.log10(E)),C=E/Math.pow(10,S),A=C>=e10?10:C>=e5?5:C>=e2?2:1;let I,B,O;return S<0?(O=Math.pow(10,-S)/A,I=Math.round(n*O),B=Math.round(r*O),I/O<n&&++I,B/O>r&&--B,O=-O):(O=Math.pow(10,S)*A,I=Math.round(n/O),B=Math.round(r/O),I*O<n&&++I,B*O>r&&--B),B<I&&.5<=_&&_<2?tickSpec(n,r,_*2):[I,B,O]}function ticks(n,r,_){if(r=+r,n=+n,_=+_,!(_>0))return[];if(n===r)return[n];const E=r<n,[S,C,A]=E?tickSpec(r,n,_):tickSpec(n,r,_);if(!(C>=S))return[];const I=C-S+1,B=new Array(I);if(E)if(A<0)for(let O=0;O<I;++O)B[O]=(C-O)/-A;else for(let O=0;O<I;++O)B[O]=(C-O)*A;else if(A<0)for(let O=0;O<I;++O)B[O]=(S+O)/-A;else for(let O=0;O<I;++O)B[O]=(S+O)*A;return B}function tickIncrement(n,r,_){return r=+r,n=+n,_=+_,tickSpec(n,r,_)[2]}function tickStep(n,r,_){r=+r,n=+n,_=+_;const E=r<n,S=E?tickIncrement(r,n,_):tickIncrement(n,r,_);return(E?-1:1)*(S<0?1/-S:S)}function max(n,r){let _;if(r===void 0)for(const E of n)E!=null&&(_<E||_===void 0&&E>=E)&&(_=E);else{let E=-1;for(let S of n)(S=r(S,++E,n))!=null&&(_<S||_===void 0&&S>=S)&&(_=S)}return _}function identity$c(n){return n}var top$1=1,right=2,bottom=3,left=4,epsilon$1=1e-6;function translateX(n){return"translate("+n+",0)"}function translateY(n){return"translate(0,"+n+")"}function number$5(n){return r=>+n(r)}function center(n,r){return r=Math.max(0,n.bandwidth()-r*2)/2,n.round()&&(r=Math.round(r)),_=>+n(_)+r}function entering(){return!this.__axis}function axis(n,r){var _=[],E=null,S=null,C=6,A=6,I=3,B=typeof window<"u"&&window.devicePixelRatio>1?0:.5,O=n===top$1||n===left?-1:1,N=n===left||n===right?"x":"y",U=n===top$1||n===bottom?translateX:translateY;function j(z){var Z=E??(r.ticks?r.ticks.apply(r,_):r.domain()),X=S??(r.tickFormat?r.tickFormat.apply(r,_):identity$c),Q=Math.max(C,0)+I,se=r.range(),oe=+se[0]+B,ue=+se[se.length-1]+B,we=(r.bandwidth?center:number$5)(r.copy(),B),Te=z.selection?z.selection():z,xe=Te.selectAll(".domain").data([null]),Re=Te.selectAll(".tick").data(Z,r).order(),Ne=Re.exit(),Fe=Re.enter().append("g").attr("class","tick"),ht=Re.select("line"),nt=Re.select("text");xe=xe.merge(xe.enter().insert("path",".tick").attr("class","domain").attr("stroke","currentColor")),Re=Re.merge(Fe),ht=ht.merge(Fe.append("line").attr("stroke","currentColor").attr(N+"2",O*C)),nt=nt.merge(Fe.append("text").attr("fill","currentColor").attr(N,O*Q).attr("dy",n===top$1?"0em":n===bottom?"0.71em":"0.32em")),z!==Te&&(xe=xe.transition(z),Re=Re.transition(z),ht=ht.transition(z),nt=nt.transition(z),Ne=Ne.transition(z).attr("opacity",epsilon$1).attr("transform",function(Ee){return isFinite(Ee=we(Ee))?U(Ee+B):this.getAttribute("transform")}),Fe.attr("opacity",epsilon$1).attr("transform",function(Ee){var Ce=this.parentNode.__axis;return U((Ce&&isFinite(Ce=Ce(Ee))?Ce:we(Ee))+B)})),Ne.remove(),xe.attr("d",n===left||n===right?A?"M"+O*A+","+oe+"H"+B+"V"+ue+"H"+O*A:"M"+B+","+oe+"V"+ue:A?"M"+oe+","+O*A+"V"+B+"H"+ue+"V"+O*A:"M"+oe+","+B+"H"+ue),Re.attr("opacity",1).attr("transform",function(Ee){return U(we(Ee)+B)}),ht.attr(N+"2",O*C),nt.attr(N,O*Q).text(X),Te.filter(entering).attr("fill","none").attr("font-size",10).attr("font-family","sans-serif").attr("text-anchor",n===right?"start":n===left?"end":"middle"),Te.each(function(){this.__axis=we})}return j.scale=function(z){return arguments.length?(r=z,j):r},j.ticks=function(){return _=Array.from(arguments),j},j.tickArguments=function(z){return arguments.length?(_=z==null?[]:Array.from(z),j):_.slice()},j.tickValues=function(z){return arguments.length?(E=z==null?null:Array.from(z),j):E&&E.slice()},j.tickFormat=function(z){return arguments.length?(S=z,j):S},j.tickSize=function(z){return arguments.length?(C=A=+z,j):C},j.tickSizeInner=function(z){return arguments.length?(C=+z,j):C},j.tickSizeOuter=function(z){return arguments.length?(A=+z,j):A},j.tickPadding=function(z){return arguments.length?(I=+z,j):I},j.offset=function(z){return arguments.length?(B=+z,j):B},j}function axisBottom(n){return axis(bottom,n)}function axisLeft(n){return axis(left,n)}var noop$3={value:()=>{}};function dispatch(){for(var n=0,r=arguments.length,_={},E;n<r;++n){if(!(E=arguments[n]+"")||E in _||/[\s.]/.test(E))throw new Error("illegal type: "+E);_[E]=[]}return new Dispatch(_)}function Dispatch(n){this._=n}function parseTypenames$1(n,r){return n.trim().split(/^|\s+/).map(function(_){var E="",S=_.indexOf(".");if(S>=0&&(E=_.slice(S+1),_=_.slice(0,S)),_&&!r.hasOwnProperty(_))throw new Error("unknown type: "+_);return{type:_,name:E}})}Dispatch.prototype=dispatch.prototype={constructor:Dispatch,on:function(n,r){var _=this._,E=parseTypenames$1(n+"",_),S,C=-1,A=E.length;if(arguments.length<2){for(;++C<A;)if((S=(n=E[C]).type)&&(S=get$3(_[S],n.name)))return S;return}if(r!=null&&typeof r!="function")throw new Error("invalid callback: "+r);for(;++C<A;)if(S=(n=E[C]).type)_[S]=set$1(_[S],n.name,r);else if(r==null)for(S in _)_[S]=set$1(_[S],n.name,null);return this},copy:function(){var n={},r=this._;for(var _ in r)n[_]=r[_].slice();return new Dispatch(n)},call:function(n,r){if((S=arguments.length-2)>0)for(var _=new Array(S),E=0,S,C;E<S;++E)_[E]=arguments[E+2];if(!this._.hasOwnProperty(n))throw new Error("unknown type: "+n);for(C=this._[n],E=0,S=C.length;E<S;++E)C[E].value.apply(r,_)},apply:function(n,r,_){if(!this._.hasOwnProperty(n))throw new Error("unknown type: "+n);for(var E=this._[n],S=0,C=E.length;S<C;++S)E[S].value.apply(r,_)}};function get$3(n,r){for(var _=0,E=n.length,S;_<E;++_)if((S=n[_]).name===r)return S.value}function set$1(n,r,_){for(var E=0,S=n.length;E<S;++E)if(n[E].name===r){n[E]=noop$3,n=n.slice(0,E).concat(n.slice(E+1));break}return _!=null&&n.push({name:r,value:_}),n}var xhtml="http://www.w3.org/1999/xhtml";const namespaces={svg:"http://www.w3.org/2000/svg",xhtml,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function namespace(n){var r=n+="",_=r.indexOf(":");return _>=0&&(r=n.slice(0,_))!=="xmlns"&&(n=n.slice(_+1)),namespaces.hasOwnProperty(r)?{space:namespaces[r],local:n}:n}function creatorInherit(n){return function(){var r=this.ownerDocument,_=this.namespaceURI;return _===xhtml&&r.documentElement.namespaceURI===xhtml?r.createElement(n):r.createElementNS(_,n)}}function creatorFixed(n){return function(){return this.ownerDocument.createElementNS(n.space,n.local)}}function creator(n){var r=namespace(n);return(r.local?creatorFixed:creatorInherit)(r)}function none(){}function selector(n){return n==null?none:function(){return this.querySelector(n)}}function selection_select(n){typeof n!="function"&&(n=selector(n));for(var r=this._groups,_=r.length,E=new Array(_),S=0;S<_;++S)for(var C=r[S],A=C.length,I=E[S]=new Array(A),B,O,N=0;N<A;++N)(B=C[N])&&(O=n.call(B,B.__data__,N,C))&&("__data__"in B&&(O.__data__=B.__data__),I[N]=O);return new Selection$1(E,this._parents)}function array$1(n){return n==null?[]:Array.isArray(n)?n:Array.from(n)}function empty$1(){return[]}function selectorAll(n){return n==null?empty$1:function(){return this.querySelectorAll(n)}}function arrayAll(n){return function(){return array$1(n.apply(this,arguments))}}function selection_selectAll(n){typeof n=="function"?n=arrayAll(n):n=selectorAll(n);for(var r=this._groups,_=r.length,E=[],S=[],C=0;C<_;++C)for(var A=r[C],I=A.length,B,O=0;O<I;++O)(B=A[O])&&(E.push(n.call(B,B.__data__,O,A)),S.push(B));return new Selection$1(E,S)}function matcher(n){return function(){return this.matches(n)}}function childMatcher(n){return function(r){return r.matches(n)}}var find=Array.prototype.find;function childFind(n){return function(){return find.call(this.children,n)}}function childFirst(){return this.firstElementChild}function selection_selectChild(n){return this.select(n==null?childFirst:childFind(typeof n=="function"?n:childMatcher(n)))}var filter$1=Array.prototype.filter;function children(){return Array.from(this.children)}function childrenFilter(n){return function(){return filter$1.call(this.children,n)}}function selection_selectChildren(n){return this.selectAll(n==null?children:childrenFilter(typeof n=="function"?n:childMatcher(n)))}function selection_filter(n){typeof n!="function"&&(n=matcher(n));for(var r=this._groups,_=r.length,E=new Array(_),S=0;S<_;++S)for(var C=r[S],A=C.length,I=E[S]=[],B,O=0;O<A;++O)(B=C[O])&&n.call(B,B.__data__,O,C)&&I.push(B);return new Selection$1(E,this._parents)}function sparse(n){return new Array(n.length)}function selection_enter(){return new Selection$1(this._enter||this._groups.map(sparse),this._parents)}function EnterNode(n,r){this.ownerDocument=n.ownerDocument,this.namespaceURI=n.namespaceURI,this._next=null,this._parent=n,this.__data__=r}EnterNode.prototype={constructor:EnterNode,appendChild:function(n){return this._parent.insertBefore(n,this._next)},insertBefore:function(n,r){return this._parent.insertBefore(n,r)},querySelector:function(n){return this._parent.querySelector(n)},querySelectorAll:function(n){return this._parent.querySelectorAll(n)}};function constant$2(n){return function(){return n}}function bindIndex(n,r,_,E,S,C){for(var A=0,I,B=r.length,O=C.length;A<O;++A)(I=r[A])?(I.__data__=C[A],E[A]=I):_[A]=new EnterNode(n,C[A]);for(;A<B;++A)(I=r[A])&&(S[A]=I)}function bindKey(n,r,_,E,S,C,A){var I,B,O=new Map,N=r.length,U=C.length,j=new Array(N),z;for(I=0;I<N;++I)(B=r[I])&&(j[I]=z=A.call(B,B.__data__,I,r)+"",O.has(z)?S[I]=B:O.set(z,B));for(I=0;I<U;++I)z=A.call(n,C[I],I,C)+"",(B=O.get(z))?(E[I]=B,B.__data__=C[I],O.delete(z)):_[I]=new EnterNode(n,C[I]);for(I=0;I<N;++I)(B=r[I])&&O.get(j[I])===B&&(S[I]=B)}function datum(n){return n.__data__}function selection_data(n,r){if(!arguments.length)return Array.from(this,datum);var _=r?bindKey:bindIndex,E=this._parents,S=this._groups;typeof n!="function"&&(n=constant$2(n));for(var C=S.length,A=new Array(C),I=new Array(C),B=new Array(C),O=0;O<C;++O){var N=E[O],U=S[O],j=U.length,z=arraylike(n.call(N,N&&N.__data__,O,E)),Z=z.length,X=I[O]=new Array(Z),Q=A[O]=new Array(Z),se=B[O]=new Array(j);_(N,U,X,Q,se,z,r);for(var oe=0,ue=0,we,Te;oe<Z;++oe)if(we=X[oe]){for(oe>=ue&&(ue=oe+1);!(Te=Q[ue])&&++ue<Z;);we._next=Te||null}}return A=new Selection$1(A,E),A._enter=I,A._exit=B,A}function arraylike(n){return typeof n=="object"&&"length"in n?n:Array.from(n)}function selection_exit(){return new Selection$1(this._exit||this._groups.map(sparse),this._parents)}function selection_join(n,r,_){var E=this.enter(),S=this,C=this.exit();return typeof n=="function"?(E=n(E),E&&(E=E.selection())):E=E.append(n+""),r!=null&&(S=r(S),S&&(S=S.selection())),_==null?C.remove():_(C),E&&S?E.merge(S).order():S}function selection_merge(n){for(var r=n.selection?n.selection():n,_=this._groups,E=r._groups,S=_.length,C=E.length,A=Math.min(S,C),I=new Array(S),B=0;B<A;++B)for(var O=_[B],N=E[B],U=O.length,j=I[B]=new Array(U),z,Z=0;Z<U;++Z)(z=O[Z]||N[Z])&&(j[Z]=z);for(;B<S;++B)I[B]=_[B];return new Selection$1(I,this._parents)}function selection_order(){for(var n=this._groups,r=-1,_=n.length;++r<_;)for(var E=n[r],S=E.length-1,C=E[S],A;--S>=0;)(A=E[S])&&(C&&A.compareDocumentPosition(C)^4&&C.parentNode.insertBefore(A,C),C=A);return this}function selection_sort(n){n||(n=ascending);function r(U,j){return U&&j?n(U.__data__,j.__data__):!U-!j}for(var _=this._groups,E=_.length,S=new Array(E),C=0;C<E;++C){for(var A=_[C],I=A.length,B=S[C]=new Array(I),O,N=0;N<I;++N)(O=A[N])&&(B[N]=O);B.sort(r)}return new Selection$1(S,this._parents).order()}function ascending(n,r){return n<r?-1:n>r?1:n>=r?0:NaN}function selection_call(){var n=arguments[0];return arguments[0]=this,n.apply(null,arguments),this}function selection_nodes(){return Array.from(this)}function selection_node(){for(var n=this._groups,r=0,_=n.length;r<_;++r)for(var E=n[r],S=0,C=E.length;S<C;++S){var A=E[S];if(A)return A}return null}function selection_size(){let n=0;for(const r of this)++n;return n}function selection_empty(){return!this.node()}function selection_each(n){for(var r=this._groups,_=0,E=r.length;_<E;++_)for(var S=r[_],C=0,A=S.length,I;C<A;++C)(I=S[C])&&n.call(I,I.__data__,C,S);return this}function attrRemove$1(n){return function(){this.removeAttribute(n)}}function attrRemoveNS$1(n){return function(){this.removeAttributeNS(n.space,n.local)}}function attrConstant$1(n,r){return function(){this.setAttribute(n,r)}}function attrConstantNS$1(n,r){return function(){this.setAttributeNS(n.space,n.local,r)}}function attrFunction$1(n,r){return function(){var _=r.apply(this,arguments);_==null?this.removeAttribute(n):this.setAttribute(n,_)}}function attrFunctionNS$1(n,r){return function(){var _=r.apply(this,arguments);_==null?this.removeAttributeNS(n.space,n.local):this.setAttributeNS(n.space,n.local,_)}}function selection_attr(n,r){var _=namespace(n);if(arguments.length<2){var E=this.node();return _.local?E.getAttributeNS(_.space,_.local):E.getAttribute(_)}return this.each((r==null?_.local?attrRemoveNS$1:attrRemove$1:typeof r=="function"?_.local?attrFunctionNS$1:attrFunction$1:_.local?attrConstantNS$1:attrConstant$1)(_,r))}function defaultView(n){return n.ownerDocument&&n.ownerDocument.defaultView||n.document&&n||n.defaultView}function styleRemove$1(n){return function(){this.style.removeProperty(n)}}function styleConstant$1(n,r,_){return function(){this.style.setProperty(n,r,_)}}function styleFunction$1(n,r,_){return function(){var E=r.apply(this,arguments);E==null?this.style.removeProperty(n):this.style.setProperty(n,E,_)}}function selection_style(n,r,_){return arguments.length>1?this.each((r==null?styleRemove$1:typeof r=="function"?styleFunction$1:styleConstant$1)(n,r,_??"")):styleValue(this.node(),n)}function styleValue(n,r){return n.style.getPropertyValue(r)||defaultView(n).getComputedStyle(n,null).getPropertyValue(r)}function propertyRemove(n){return function(){delete this[n]}}function propertyConstant(n,r){return function(){this[n]=r}}function propertyFunction(n,r){return function(){var _=r.apply(this,arguments);_==null?delete this[n]:this[n]=_}}function selection_property(n,r){return arguments.length>1?this.each((r==null?propertyRemove:typeof r=="function"?propertyFunction:propertyConstant)(n,r)):this.node()[n]}function classArray(n){return n.trim().split(/^|\s+/)}function classList(n){return n.classList||new ClassList(n)}function ClassList(n){this._node=n,this._names=classArray(n.getAttribute("class")||"")}ClassList.prototype={add:function(n){var r=this._names.indexOf(n);r<0&&(this._names.push(n),this._node.setAttribute("class",this._names.join(" ")))},remove:function(n){var r=this._names.indexOf(n);r>=0&&(this._names.splice(r,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(n){return this._names.indexOf(n)>=0}};function classedAdd(n,r){for(var _=classList(n),E=-1,S=r.length;++E<S;)_.add(r[E])}function classedRemove(n,r){for(var _=classList(n),E=-1,S=r.length;++E<S;)_.remove(r[E])}function classedTrue(n){return function(){classedAdd(this,n)}}function classedFalse(n){return function(){classedRemove(this,n)}}function classedFunction(n,r){return function(){(r.apply(this,arguments)?classedAdd:classedRemove)(this,n)}}function selection_classed(n,r){var _=classArray(n+"");if(arguments.length<2){for(var E=classList(this.node()),S=-1,C=_.length;++S<C;)if(!E.contains(_[S]))return!1;return!0}return this.each((typeof r=="function"?classedFunction:r?classedTrue:classedFalse)(_,r))}function textRemove(){this.textContent=""}function textConstant$1(n){return function(){this.textContent=n}}function textFunction$1(n){return function(){var r=n.apply(this,arguments);this.textContent=r??""}}function selection_text(n){return arguments.length?this.each(n==null?textRemove:(typeof n=="function"?textFunction$1:textConstant$1)(n)):this.node().textContent}function htmlRemove(){this.innerHTML=""}function htmlConstant(n){return function(){this.innerHTML=n}}function htmlFunction(n){return function(){var r=n.apply(this,arguments);this.innerHTML=r??""}}function selection_html(n){return arguments.length?this.each(n==null?htmlRemove:(typeof n=="function"?htmlFunction:htmlConstant)(n)):this.node().innerHTML}function raise(){this.nextSibling&&this.parentNode.appendChild(this)}function selection_raise(){return this.each(raise)}function lower(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function selection_lower(){return this.each(lower)}function selection_append(n){var r=typeof n=="function"?n:creator(n);return this.select(function(){return this.appendChild(r.apply(this,arguments))})}function constantNull(){return null}function selection_insert(n,r){var _=typeof n=="function"?n:creator(n),E=r==null?constantNull:typeof r=="function"?r:selector(r);return this.select(function(){return this.insertBefore(_.apply(this,arguments),E.apply(this,arguments)||null)})}function remove(){var n=this.parentNode;n&&n.removeChild(this)}function selection_remove(){return this.each(remove)}function selection_cloneShallow(){var n=this.cloneNode(!1),r=this.parentNode;return r?r.insertBefore(n,this.nextSibling):n}function selection_cloneDeep(){var n=this.cloneNode(!0),r=this.parentNode;return r?r.insertBefore(n,this.nextSibling):n}function selection_clone(n){return this.select(n?selection_cloneDeep:selection_cloneShallow)}function selection_datum(n){return arguments.length?this.property("__data__",n):this.node().__data__}function contextListener(n){return function(r){n.call(this,r,this.__data__)}}function parseTypenames(n){return n.trim().split(/^|\s+/).map(function(r){var _="",E=r.indexOf(".");return E>=0&&(_=r.slice(E+1),r=r.slice(0,E)),{type:r,name:_}})}function onRemove(n){return function(){var r=this.__on;if(r){for(var _=0,E=-1,S=r.length,C;_<S;++_)C=r[_],(!n.type||C.type===n.type)&&C.name===n.name?this.removeEventListener(C.type,C.listener,C.options):r[++E]=C;++E?r.length=E:delete this.__on}}}function onAdd(n,r,_){return function(){var E=this.__on,S,C=contextListener(r);if(E){for(var A=0,I=E.length;A<I;++A)if((S=E[A]).type===n.type&&S.name===n.name){this.removeEventListener(S.type,S.listener,S.options),this.addEventListener(S.type,S.listener=C,S.options=_),S.value=r;return}}this.addEventListener(n.type,C,_),S={type:n.type,name:n.name,value:r,listener:C,options:_},E?E.push(S):this.__on=[S]}}function selection_on(n,r,_){var E=parseTypenames(n+""),S,C=E.length,A;if(arguments.length<2){var I=this.node().__on;if(I){for(var B=0,O=I.length,N;B<O;++B)for(S=0,N=I[B];S<C;++S)if((A=E[S]).type===N.type&&A.name===N.name)return N.value}return}for(I=r?onAdd:onRemove,S=0;S<C;++S)this.each(I(E[S],r,_));return this}function dispatchEvent(n,r,_){var E=defaultView(n),S=E.CustomEvent;typeof S=="function"?S=new S(r,_):(S=E.document.createEvent("Event"),_?(S.initEvent(r,_.bubbles,_.cancelable),S.detail=_.detail):S.initEvent(r,!1,!1)),n.dispatchEvent(S)}function dispatchConstant(n,r){return function(){return dispatchEvent(this,n,r)}}function dispatchFunction(n,r){return function(){return dispatchEvent(this,n,r.apply(this,arguments))}}function selection_dispatch(n,r){return this.each((typeof r=="function"?dispatchFunction:dispatchConstant)(n,r))}function*selection_iterator(){for(var n=this._groups,r=0,_=n.length;r<_;++r)for(var E=n[r],S=0,C=E.length,A;S<C;++S)(A=E[S])&&(yield A)}var root=[null];function Selection$1(n,r){this._groups=n,this._parents=r}function selection(){return new Selection$1([[document.documentElement]],root)}function selection_selection(){return this}Selection$1.prototype=selection.prototype={constructor:Selection$1,select:selection_select,selectAll:selection_selectAll,selectChild:selection_selectChild,selectChildren:selection_selectChildren,filter:selection_filter,data:selection_data,enter:selection_enter,exit:selection_exit,join:selection_join,merge:selection_merge,selection:selection_selection,order:selection_order,sort:selection_sort,call:selection_call,nodes:selection_nodes,node:selection_node,size:selection_size,empty:selection_empty,each:selection_each,attr:selection_attr,style:selection_style,property:selection_property,classed:selection_classed,text:selection_text,html:selection_html,raise:selection_raise,lower:selection_lower,append:selection_append,insert:selection_insert,remove:selection_remove,clone:selection_clone,datum:selection_datum,on:selection_on,dispatch:selection_dispatch,[Symbol.iterator]:selection_iterator};function select$1(n){return typeof n=="string"?new Selection$1([[document.querySelector(n)]],[document.documentElement]):new Selection$1([[n]],root)}function define(n,r,_){n.prototype=r.prototype=_,_.constructor=n}function extend(n,r){var _=Object.create(n.prototype);for(var E in r)_[E]=r[E];return _}function Color(){}var darker=.7,brighter=1/darker,reI="\\s*([+-]?\\d+)\\s*",reN="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",reP="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",reHex=/^#([0-9a-f]{3,8})$/,reRgbInteger=new RegExp(`^rgb\\(${reI},${reI},${reI}\\)$`),reRgbPercent=new RegExp(`^rgb\\(${reP},${reP},${reP}\\)$`),reRgbaInteger=new RegExp(`^rgba\\(${reI},${reI},${reI},${reN}\\)$`),reRgbaPercent=new RegExp(`^rgba\\(${reP},${reP},${reP},${reN}\\)$`),reHslPercent=new RegExp(`^hsl\\(${reN},${reP},${reP}\\)$`),reHslaPercent=new RegExp(`^hsla\\(${reN},${reP},${reP},${reN}\\)$`),named={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};define(Color,color,{copy(n){return Object.assign(new this.constructor,this,n)},displayable(){return this.rgb().displayable()},hex:color_formatHex,formatHex:color_formatHex,formatHex8:color_formatHex8,formatHsl:color_formatHsl,formatRgb:color_formatRgb,toString:color_formatRgb});function color_formatHex(){return this.rgb().formatHex()}function color_formatHex8(){return this.rgb().formatHex8()}function color_formatHsl(){return hslConvert(this).formatHsl()}function color_formatRgb(){return this.rgb().formatRgb()}function color(n){var r,_;return n=(n+"").trim().toLowerCase(),(r=reHex.exec(n))?(_=r[1].length,r=parseInt(r[1],16),_===6?rgbn(r):_===3?new Rgb(r>>8&15|r>>4&240,r>>4&15|r&240,(r&15)<<4|r&15,1):_===8?rgba(r>>24&255,r>>16&255,r>>8&255,(r&255)/255):_===4?rgba(r>>12&15|r>>8&240,r>>8&15|r>>4&240,r>>4&15|r&240,((r&15)<<4|r&15)/255):null):(r=reRgbInteger.exec(n))?new Rgb(r[1],r[2],r[3],1):(r=reRgbPercent.exec(n))?new Rgb(r[1]*255/100,r[2]*255/100,r[3]*255/100,1):(r=reRgbaInteger.exec(n))?rgba(r[1],r[2],r[3],r[4]):(r=reRgbaPercent.exec(n))?rgba(r[1]*255/100,r[2]*255/100,r[3]*255/100,r[4]):(r=reHslPercent.exec(n))?hsla(r[1],r[2]/100,r[3]/100,1):(r=reHslaPercent.exec(n))?hsla(r[1],r[2]/100,r[3]/100,r[4]):named.hasOwnProperty(n)?rgbn(named[n]):n==="transparent"?new Rgb(NaN,NaN,NaN,0):null}function rgbn(n){return new Rgb(n>>16&255,n>>8&255,n&255,1)}function rgba(n,r,_,E){return E<=0&&(n=r=_=NaN),new Rgb(n,r,_,E)}function rgbConvert(n){return n instanceof Color||(n=color(n)),n?(n=n.rgb(),new Rgb(n.r,n.g,n.b,n.opacity)):new Rgb}function rgb(n,r,_,E){return arguments.length===1?rgbConvert(n):new Rgb(n,r,_,E??1)}function Rgb(n,r,_,E){this.r=+n,this.g=+r,this.b=+_,this.opacity=+E}define(Rgb,rgb,extend(Color,{brighter(n){return n=n==null?brighter:Math.pow(brighter,n),new Rgb(this.r*n,this.g*n,this.b*n,this.opacity)},darker(n){return n=n==null?darker:Math.pow(darker,n),new Rgb(this.r*n,this.g*n,this.b*n,this.opacity)},rgb(){return this},clamp(){return new Rgb(clampi(this.r),clampi(this.g),clampi(this.b),clampa(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:rgb_formatHex,formatHex:rgb_formatHex,formatHex8:rgb_formatHex8,formatRgb:rgb_formatRgb,toString:rgb_formatRgb}));function rgb_formatHex(){return`#${hex(this.r)}${hex(this.g)}${hex(this.b)}`}function rgb_formatHex8(){return`#${hex(this.r)}${hex(this.g)}${hex(this.b)}${hex((isNaN(this.opacity)?1:this.opacity)*255)}`}function rgb_formatRgb(){const n=clampa(this.opacity);return`${n===1?"rgb(":"rgba("}${clampi(this.r)}, ${clampi(this.g)}, ${clampi(this.b)}${n===1?")":`, ${n})`}`}function clampa(n){return isNaN(n)?1:Math.max(0,Math.min(1,n))}function clampi(n){return Math.max(0,Math.min(255,Math.round(n)||0))}function hex(n){return n=clampi(n),(n<16?"0":"")+n.toString(16)}function hsla(n,r,_,E){return E<=0?n=r=_=NaN:_<=0||_>=1?n=r=NaN:r<=0&&(n=NaN),new Hsl(n,r,_,E)}function hslConvert(n){if(n instanceof Hsl)return new Hsl(n.h,n.s,n.l,n.opacity);if(n instanceof Color||(n=color(n)),!n)return new Hsl;if(n instanceof Hsl)return n;n=n.rgb();var r=n.r/255,_=n.g/255,E=n.b/255,S=Math.min(r,_,E),C=Math.max(r,_,E),A=NaN,I=C-S,B=(C+S)/2;return I?(r===C?A=(_-E)/I+(_<E)*6:_===C?A=(E-r)/I+2:A=(r-_)/I+4,I/=B<.5?C+S:2-C-S,A*=60):I=B>0&&B<1?0:A,new Hsl(A,I,B,n.opacity)}function hsl(n,r,_,E){return arguments.length===1?hslConvert(n):new Hsl(n,r,_,E??1)}function Hsl(n,r,_,E){this.h=+n,this.s=+r,this.l=+_,this.opacity=+E}define(Hsl,hsl,extend(Color,{brighter(n){return n=n==null?brighter:Math.pow(brighter,n),new Hsl(this.h,this.s,this.l*n,this.opacity)},darker(n){return n=n==null?darker:Math.pow(darker,n),new Hsl(this.h,this.s,this.l*n,this.opacity)},rgb(){var n=this.h%360+(this.h<0)*360,r=isNaN(n)||isNaN(this.s)?0:this.s,_=this.l,E=_+(_<.5?_:1-_)*r,S=2*_-E;return new Rgb(hsl2rgb(n>=240?n-240:n+120,S,E),hsl2rgb(n,S,E),hsl2rgb(n<120?n+240:n-120,S,E),this.opacity)},clamp(){return new Hsl(clamph(this.h),clampt(this.s),clampt(this.l),clampa(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const n=clampa(this.opacity);return`${n===1?"hsl(":"hsla("}${clamph(this.h)}, ${clampt(this.s)*100}%, ${clampt(this.l)*100}%${n===1?")":`, ${n})`}`}}));function clamph(n){return n=(n||0)%360,n<0?n+360:n}function clampt(n){return Math.max(0,Math.min(1,n||0))}function hsl2rgb(n,r,_){return(n<60?r+(_-r)*n/60:n<180?_:n<240?r+(_-r)*(240-n)/60:r)*255}const constant$1=n=>()=>n;function linear$1(n,r){return function(_){return n+_*r}}function exponential(n,r,_){return n=Math.pow(n,_),r=Math.pow(r,_)-n,_=1/_,function(E){return Math.pow(n+E*r,_)}}function gamma(n){return(n=+n)==1?nogamma:function(r,_){return _-r?exponential(r,_,n):constant$1(isNaN(r)?_:r)}}function nogamma(n,r){var _=r-n;return _?linear$1(n,_):constant$1(isNaN(n)?r:n)}const interpolateRgb=function n(r){var _=gamma(r);function E(S,C){var A=_((S=rgb(S)).r,(C=rgb(C)).r),I=_(S.g,C.g),B=_(S.b,C.b),O=nogamma(S.opacity,C.opacity);return function(N){return S.r=A(N),S.g=I(N),S.b=B(N),S.opacity=O(N),S+""}}return E.gamma=n,E}(1);function numberArray(n,r){r||(r=[]);var _=n?Math.min(r.length,n.length):0,E=r.slice(),S;return function(C){for(S=0;S<_;++S)E[S]=n[S]*(1-C)+r[S]*C;return E}}function isNumberArray(n){return ArrayBuffer.isView(n)&&!(n instanceof DataView)}function genericArray(n,r){var _=r?r.length:0,E=n?Math.min(_,n.length):0,S=new Array(E),C=new Array(_),A;for(A=0;A<E;++A)S[A]=interpolate$1(n[A],r[A]);for(;A<_;++A)C[A]=r[A];return function(I){for(A=0;A<E;++A)C[A]=S[A](I);return C}}function date$1(n,r){var _=new Date;return n=+n,r=+r,function(E){return _.setTime(n*(1-E)+r*E),_}}function interpolateNumber(n,r){return n=+n,r=+r,function(_){return n*(1-_)+r*_}}function object(n,r){var _={},E={},S;(n===null||typeof n!="object")&&(n={}),(r===null||typeof r!="object")&&(r={});for(S in r)S in n?_[S]=interpolate$1(n[S],r[S]):E[S]=r[S];return function(C){for(S in _)E[S]=_[S](C);return E}}var reA=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,reB=new RegExp(reA.source,"g");function zero$1(n){return function(){return n}}function one(n){return function(r){return n(r)+""}}function interpolateString(n,r){var _=reA.lastIndex=reB.lastIndex=0,E,S,C,A=-1,I=[],B=[];for(n=n+"",r=r+"";(E=reA.exec(n))&&(S=reB.exec(r));)(C=S.index)>_&&(C=r.slice(_,C),I[A]?I[A]+=C:I[++A]=C),(E=E[0])===(S=S[0])?I[A]?I[A]+=S:I[++A]=S:(I[++A]=null,B.push({i:A,x:interpolateNumber(E,S)})),_=reB.lastIndex;return _<r.length&&(C=r.slice(_),I[A]?I[A]+=C:I[++A]=C),I.length<2?B[0]?one(B[0].x):zero$1(r):(r=B.length,function(O){for(var N=0,U;N<r;++N)I[(U=B[N]).i]=U.x(O);return I.join("")})}function interpolate$1(n,r){var _=typeof r,E;return r==null||_==="boolean"?constant$1(r):(_==="number"?interpolateNumber:_==="string"?(E=color(r))?(r=E,interpolateRgb):interpolateString:r instanceof color?interpolateRgb:r instanceof Date?date$1:isNumberArray(r)?numberArray:Array.isArray(r)?genericArray:typeof r.valueOf!="function"&&typeof r.toString!="function"||isNaN(r)?object:interpolateNumber)(n,r)}function interpolateRound(n,r){return n=+n,r=+r,function(_){return Math.round(n*(1-_)+r*_)}}var degrees=180/Math.PI,identity$b={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function decompose(n,r,_,E,S,C){var A,I,B;return(A=Math.sqrt(n*n+r*r))&&(n/=A,r/=A),(B=n*_+r*E)&&(_-=n*B,E-=r*B),(I=Math.sqrt(_*_+E*E))&&(_/=I,E/=I,B/=I),n*E<r*_&&(n=-n,r=-r,B=-B,A=-A),{translateX:S,translateY:C,rotate:Math.atan2(r,n)*degrees,skewX:Math.atan(B)*degrees,scaleX:A,scaleY:I}}var svgNode;function parseCss(n){const r=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(n+"");return r.isIdentity?identity$b:decompose(r.a,r.b,r.c,r.d,r.e,r.f)}function parseSvg(n){return n==null||(svgNode||(svgNode=document.createElementNS("http://www.w3.org/2000/svg","g")),svgNode.setAttribute("transform",n),!(n=svgNode.transform.baseVal.consolidate()))?identity$b:(n=n.matrix,decompose(n.a,n.b,n.c,n.d,n.e,n.f))}function interpolateTransform(n,r,_,E){function S(O){return O.length?O.pop()+" ":""}function C(O,N,U,j,z,Z){if(O!==U||N!==j){var X=z.push("translate(",null,r,null,_);Z.push({i:X-4,x:interpolateNumber(O,U)},{i:X-2,x:interpolateNumber(N,j)})}else(U||j)&&z.push("translate("+U+r+j+_)}function A(O,N,U,j){O!==N?(O-N>180?N+=360:N-O>180&&(O+=360),j.push({i:U.push(S(U)+"rotate(",null,E)-2,x:interpolateNumber(O,N)})):N&&U.push(S(U)+"rotate("+N+E)}function I(O,N,U,j){O!==N?j.push({i:U.push(S(U)+"skewX(",null,E)-2,x:interpolateNumber(O,N)}):N&&U.push(S(U)+"skewX("+N+E)}function B(O,N,U,j,z,Z){if(O!==U||N!==j){var X=z.push(S(z)+"scale(",null,",",null,")");Z.push({i:X-4,x:interpolateNumber(O,U)},{i:X-2,x:interpolateNumber(N,j)})}else(U!==1||j!==1)&&z.push(S(z)+"scale("+U+","+j+")")}return function(O,N){var U=[],j=[];return O=n(O),N=n(N),C(O.translateX,O.translateY,N.translateX,N.translateY,U,j),A(O.rotate,N.rotate,U,j),I(O.skewX,N.skewX,U,j),B(O.scaleX,O.scaleY,N.scaleX,N.scaleY,U,j),O=N=null,function(z){for(var Z=-1,X=j.length,Q;++Z<X;)U[(Q=j[Z]).i]=Q.x(z);return U.join("")}}}var interpolateTransformCss=interpolateTransform(parseCss,"px, ","px)","deg)"),interpolateTransformSvg=interpolateTransform(parseSvg,", ",")",")"),frame=0,timeout$1=0,interval=0,pokeDelay=1e3,taskHead,taskTail,clockLast=0,clockNow=0,clockSkew=0,clock=typeof performance=="object"&&performance.now?performance:Date,setFrame=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(n){setTimeout(n,17)};function now(){return clockNow||(setFrame(clearNow),clockNow=clock.now()+clockSkew)}function clearNow(){clockNow=0}function Timer(){this._call=this._time=this._next=null}Timer.prototype=timer.prototype={constructor:Timer,restart:function(n,r,_){if(typeof n!="function")throw new TypeError("callback is not a function");_=(_==null?now():+_)+(r==null?0:+r),!this._next&&taskTail!==this&&(taskTail?taskTail._next=this:taskHead=this,taskTail=this),this._call=n,this._time=_,sleep()},stop:function(){this._call&&(this._call=null,this._time=1/0,sleep())}};function timer(n,r,_){var E=new Timer;return E.restart(n,r,_),E}function timerFlush(){now(),++frame;for(var n=taskHead,r;n;)(r=clockNow-n._time)>=0&&n._call.call(void 0,r),n=n._next;--frame}function wake(){clockNow=(clockLast=clock.now())+clockSkew,frame=timeout$1=0;try{timerFlush()}finally{frame=0,nap(),clockNow=0}}function poke(){var n=clock.now(),r=n-clockLast;r>pokeDelay&&(clockSkew-=r,clockLast=n)}function nap(){for(var n,r=taskHead,_,E=1/0;r;)r._call?(E>r._time&&(E=r._time),n=r,r=r._next):(_=r._next,r._next=null,r=n?n._next=_:taskHead=_);taskTail=n,sleep(E)}function sleep(n){if(!frame){timeout$1&&(timeout$1=clearTimeout(timeout$1));var r=n-clockNow;r>24?(n<1/0&&(timeout$1=setTimeout(wake,n-clock.now()-clockSkew)),interval&&(interval=clearInterval(interval))):(interval||(clockLast=clock.now(),interval=setInterval(poke,pokeDelay)),frame=1,setFrame(wake))}}function timeout(n,r,_){var E=new Timer;return r=r==null?0:+r,E.restart(S=>{E.stop(),n(S+r)},r,_),E}var emptyOn=dispatch("start","end","cancel","interrupt"),emptyTween=[],CREATED=0,SCHEDULED=1,STARTING=2,STARTED=3,RUNNING=4,ENDING=5,ENDED=6;function schedule(n,r,_,E,S,C){var A=n.__transition;if(!A)n.__transition={};else if(_ in A)return;create$6(n,_,{name:r,index:E,group:S,on:emptyOn,tween:emptyTween,time:C.time,delay:C.delay,duration:C.duration,ease:C.ease,timer:null,state:CREATED})}function init$1(n,r){var _=get$2(n,r);if(_.state>CREATED)throw new Error("too late; already scheduled");return _}function set(n,r){var _=get$2(n,r);if(_.state>STARTED)throw new Error("too late; already running");return _}function get$2(n,r){var _=n.__transition;if(!_||!(_=_[r]))throw new Error("transition not found");return _}function create$6(n,r,_){var E=n.__transition,S;E[r]=_,_.timer=timer(C,0,_.time);function C(O){_.state=SCHEDULED,_.timer.restart(A,_.delay,_.time),_.delay<=O&&A(O-_.delay)}function A(O){var N,U,j,z;if(_.state!==SCHEDULED)return B();for(N in E)if(z=E[N],z.name===_.name){if(z.state===STARTED)return timeout(A);z.state===RUNNING?(z.state=ENDED,z.timer.stop(),z.on.call("interrupt",n,n.__data__,z.index,z.group),delete E[N]):+N<r&&(z.state=ENDED,z.timer.stop(),z.on.call("cancel",n,n.__data__,z.index,z.group),delete E[N])}if(timeout(function(){_.state===STARTED&&(_.state=RUNNING,_.timer.restart(I,_.delay,_.time),I(O))}),_.state=STARTING,_.on.call("start",n,n.__data__,_.index,_.group),_.state===STARTING){for(_.state=STARTED,S=new Array(j=_.tween.length),N=0,U=-1;N<j;++N)(z=_.tween[N].value.call(n,n.__data__,_.index,_.group))&&(S[++U]=z);S.length=U+1}}function I(O){for(var N=O<_.duration?_.ease.call(null,O/_.duration):(_.timer.restart(B),_.state=ENDING,1),U=-1,j=S.length;++U<j;)S[U].call(n,N);_.state===ENDING&&(_.on.call("end",n,n.__data__,_.index,_.group),B())}function B(){_.state=ENDED,_.timer.stop(),delete E[r];for(var O in E)return;delete n.__transition}}function interrupt(n,r){var _=n.__transition,E,S,C=!0,A;if(_){r=r==null?null:r+"";for(A in _){if((E=_[A]).name!==r){C=!1;continue}S=E.state>STARTING&&E.state<ENDING,E.state=ENDED,E.timer.stop(),E.on.call(S?"interrupt":"cancel",n,n.__data__,E.index,E.group),delete _[A]}C&&delete n.__transition}}function selection_interrupt(n){return this.each(function(){interrupt(this,n)})}function tweenRemove(n,r){var _,E;return function(){var S=set(this,n),C=S.tween;if(C!==_){E=_=C;for(var A=0,I=E.length;A<I;++A)if(E[A].name===r){E=E.slice(),E.splice(A,1);break}}S.tween=E}}function tweenFunction(n,r,_){var E,S;if(typeof _!="function")throw new Error;return function(){var C=set(this,n),A=C.tween;if(A!==E){S=(E=A).slice();for(var I={name:r,value:_},B=0,O=S.length;B<O;++B)if(S[B].name===r){S[B]=I;break}B===O&&S.push(I)}C.tween=S}}function transition_tween(n,r){var _=this._id;if(n+="",arguments.length<2){for(var E=get$2(this.node(),_).tween,S=0,C=E.length,A;S<C;++S)if((A=E[S]).name===n)return A.value;return null}return this.each((r==null?tweenRemove:tweenFunction)(_,n,r))}function tweenValue(n,r,_){var E=n._id;return n.each(function(){var S=set(this,E);(S.value||(S.value={}))[r]=_.apply(this,arguments)}),function(S){return get$2(S,E).value[r]}}function interpolate(n,r){var _;return(typeof r=="number"?interpolateNumber:r instanceof color?interpolateRgb:(_=color(r))?(r=_,interpolateRgb):interpolateString)(n,r)}function attrRemove(n){return function(){this.removeAttribute(n)}}function attrRemoveNS(n){return function(){this.removeAttributeNS(n.space,n.local)}}function attrConstant(n,r,_){var E,S=_+"",C;return function(){var A=this.getAttribute(n);return A===S?null:A===E?C:C=r(E=A,_)}}function attrConstantNS(n,r,_){var E,S=_+"",C;return function(){var A=this.getAttributeNS(n.space,n.local);return A===S?null:A===E?C:C=r(E=A,_)}}function attrFunction(n,r,_){var E,S,C;return function(){var A,I=_(this),B;return I==null?void this.removeAttribute(n):(A=this.getAttribute(n),B=I+"",A===B?null:A===E&&B===S?C:(S=B,C=r(E=A,I)))}}function attrFunctionNS(n,r,_){var E,S,C;return function(){var A,I=_(this),B;return I==null?void this.removeAttributeNS(n.space,n.local):(A=this.getAttributeNS(n.space,n.local),B=I+"",A===B?null:A===E&&B===S?C:(S=B,C=r(E=A,I)))}}function transition_attr(n,r){var _=namespace(n),E=_==="transform"?interpolateTransformSvg:interpolate;return this.attrTween(n,typeof r=="function"?(_.local?attrFunctionNS:attrFunction)(_,E,tweenValue(this,"attr."+n,r)):r==null?(_.local?attrRemoveNS:attrRemove)(_):(_.local?attrConstantNS:attrConstant)(_,E,r))}function attrInterpolate(n,r){return function(_){this.setAttribute(n,r.call(this,_))}}function attrInterpolateNS(n,r){return function(_){this.setAttributeNS(n.space,n.local,r.call(this,_))}}function attrTweenNS(n,r){var _,E;function S(){var C=r.apply(this,arguments);return C!==E&&(_=(E=C)&&attrInterpolateNS(n,C)),_}return S._value=r,S}function attrTween(n,r){var _,E;function S(){var C=r.apply(this,arguments);return C!==E&&(_=(E=C)&&attrInterpolate(n,C)),_}return S._value=r,S}function transition_attrTween(n,r){var _="attr."+n;if(arguments.length<2)return(_=this.tween(_))&&_._value;if(r==null)return this.tween(_,null);if(typeof r!="function")throw new Error;var E=namespace(n);return this.tween(_,(E.local?attrTweenNS:attrTween)(E,r))}function delayFunction(n,r){return function(){init$1(this,n).delay=+r.apply(this,arguments)}}function delayConstant(n,r){return r=+r,function(){init$1(this,n).delay=r}}function transition_delay(n){var r=this._id;return arguments.length?this.each((typeof n=="function"?delayFunction:delayConstant)(r,n)):get$2(this.node(),r).delay}function durationFunction(n,r){return function(){set(this,n).duration=+r.apply(this,arguments)}}function durationConstant(n,r){return r=+r,function(){set(this,n).duration=r}}function transition_duration(n){var r=this._id;return arguments.length?this.each((typeof n=="function"?durationFunction:durationConstant)(r,n)):get$2(this.node(),r).duration}function easeConstant(n,r){if(typeof r!="function")throw new Error;return function(){set(this,n).ease=r}}function transition_ease(n){var r=this._id;return arguments.length?this.each(easeConstant(r,n)):get$2(this.node(),r).ease}function easeVarying(n,r){return function(){var _=r.apply(this,arguments);if(typeof _!="function")throw new Error;set(this,n).ease=_}}function transition_easeVarying(n){if(typeof n!="function")throw new Error;return this.each(easeVarying(this._id,n))}function transition_filter(n){typeof n!="function"&&(n=matcher(n));for(var r=this._groups,_=r.length,E=new Array(_),S=0;S<_;++S)for(var C=r[S],A=C.length,I=E[S]=[],B,O=0;O<A;++O)(B=C[O])&&n.call(B,B.__data__,O,C)&&I.push(B);return new Transition(E,this._parents,this._name,this._id)}function transition_merge(n){if(n._id!==this._id)throw new Error;for(var r=this._groups,_=n._groups,E=r.length,S=_.length,C=Math.min(E,S),A=new Array(E),I=0;I<C;++I)for(var B=r[I],O=_[I],N=B.length,U=A[I]=new Array(N),j,z=0;z<N;++z)(j=B[z]||O[z])&&(U[z]=j);for(;I<E;++I)A[I]=r[I];return new Transition(A,this._parents,this._name,this._id)}function start$1(n){return(n+"").trim().split(/^|\s+/).every(function(r){var _=r.indexOf(".");return _>=0&&(r=r.slice(0,_)),!r||r==="start"})}function onFunction(n,r,_){var E,S,C=start$1(r)?init$1:set;return function(){var A=C(this,n),I=A.on;I!==E&&(S=(E=I).copy()).on(r,_),A.on=S}}function transition_on(n,r){var _=this._id;return arguments.length<2?get$2(this.node(),_).on.on(n):this.each(onFunction(_,n,r))}function removeFunction(n){return function(){var r=this.parentNode;for(var _ in this.__transition)if(+_!==n)return;r&&r.removeChild(this)}}function transition_remove(){return this.on("end.remove",removeFunction(this._id))}function transition_select(n){var r=this._name,_=this._id;typeof n!="function"&&(n=selector(n));for(var E=this._groups,S=E.length,C=new Array(S),A=0;A<S;++A)for(var I=E[A],B=I.length,O=C[A]=new Array(B),N,U,j=0;j<B;++j)(N=I[j])&&(U=n.call(N,N.__data__,j,I))&&("__data__"in N&&(U.__data__=N.__data__),O[j]=U,schedule(O[j],r,_,j,O,get$2(N,_)));return new Transition(C,this._parents,r,_)}function transition_selectAll(n){var r=this._name,_=this._id;typeof n!="function"&&(n=selectorAll(n));for(var E=this._groups,S=E.length,C=[],A=[],I=0;I<S;++I)for(var B=E[I],O=B.length,N,U=0;U<O;++U)if(N=B[U]){for(var j=n.call(N,N.__data__,U,B),z,Z=get$2(N,_),X=0,Q=j.length;X<Q;++X)(z=j[X])&&schedule(z,r,_,X,j,Z);C.push(j),A.push(N)}return new Transition(C,A,r,_)}var Selection=selection.prototype.constructor;function transition_selection(){return new Selection(this._groups,this._parents)}function styleNull(n,r){var _,E,S;return function(){var C=styleValue(this,n),A=(this.style.removeProperty(n),styleValue(this,n));return C===A?null:C===_&&A===E?S:S=r(_=C,E=A)}}function styleRemove(n){return function(){this.style.removeProperty(n)}}function styleConstant(n,r,_){var E,S=_+"",C;return function(){var A=styleValue(this,n);return A===S?null:A===E?C:C=r(E=A,_)}}function styleFunction(n,r,_){var E,S,C;return function(){var A=styleValue(this,n),I=_(this),B=I+"";return I==null&&(B=I=(this.style.removeProperty(n),styleValue(this,n))),A===B?null:A===E&&B===S?C:(S=B,C=r(E=A,I))}}function styleMaybeRemove(n,r){var _,E,S,C="style."+r,A="end."+C,I;return function(){var B=set(this,n),O=B.on,N=B.value[C]==null?I||(I=styleRemove(r)):void 0;(O!==_||S!==N)&&(E=(_=O).copy()).on(A,S=N),B.on=E}}function transition_style(n,r,_){var E=(n+="")=="transform"?interpolateTransformCss:interpolate;return r==null?this.styleTween(n,styleNull(n,E)).on("end.style."+n,styleRemove(n)):typeof r=="function"?this.styleTween(n,styleFunction(n,E,tweenValue(this,"style."+n,r))).each(styleMaybeRemove(this._id,n)):this.styleTween(n,styleConstant(n,E,r),_).on("end.style."+n,null)}function styleInterpolate(n,r,_){return function(E){this.style.setProperty(n,r.call(this,E),_)}}function styleTween(n,r,_){var E,S;function C(){var A=r.apply(this,arguments);return A!==S&&(E=(S=A)&&styleInterpolate(n,A,_)),E}return C._value=r,C}function transition_styleTween(n,r,_){var E="style."+(n+="");if(arguments.length<2)return(E=this.tween(E))&&E._value;if(r==null)return this.tween(E,null);if(typeof r!="function")throw new Error;return this.tween(E,styleTween(n,r,_??""))}function textConstant(n){return function(){this.textContent=n}}function textFunction(n){return function(){var r=n(this);this.textContent=r??""}}function transition_text(n){return this.tween("text",typeof n=="function"?textFunction(tweenValue(this,"text",n)):textConstant(n==null?"":n+""))}function textInterpolate(n){return function(r){this.textContent=n.call(this,r)}}function textTween(n){var r,_;function E(){var S=n.apply(this,arguments);return S!==_&&(r=(_=S)&&textInterpolate(S)),r}return E._value=n,E}function transition_textTween(n){var r="text";if(arguments.length<1)return(r=this.tween(r))&&r._value;if(n==null)return this.tween(r,null);if(typeof n!="function")throw new Error;return this.tween(r,textTween(n))}function transition_transition(){for(var n=this._name,r=this._id,_=newId(),E=this._groups,S=E.length,C=0;C<S;++C)for(var A=E[C],I=A.length,B,O=0;O<I;++O)if(B=A[O]){var N=get$2(B,r);schedule(B,n,_,O,A,{time:N.time+N.delay+N.duration,delay:0,duration:N.duration,ease:N.ease})}return new Transition(E,this._parents,n,_)}function transition_end(){var n,r,_=this,E=_._id,S=_.size();return new Promise(function(C,A){var I={value:A},B={value:function(){--S===0&&C()}};_.each(function(){var O=set(this,E),N=O.on;N!==n&&(r=(n=N).copy(),r._.cancel.push(I),r._.interrupt.push(I),r._.end.push(B)),O.on=r}),S===0&&C()})}var id$1=0;function Transition(n,r,_,E){this._groups=n,this._parents=r,this._name=_,this._id=E}function newId(){return++id$1}var selection_prototype=selection.prototype;Transition.prototype={constructor:Transition,select:transition_select,selectAll:transition_selectAll,selectChild:selection_prototype.selectChild,selectChildren:selection_prototype.selectChildren,filter:transition_filter,merge:transition_merge,selection:transition_selection,transition:transition_transition,call:selection_prototype.call,nodes:selection_prototype.nodes,node:selection_prototype.node,size:selection_prototype.size,empty:selection_prototype.empty,each:selection_prototype.each,on:transition_on,attr:transition_attr,attrTween:transition_attrTween,style:transition_style,styleTween:transition_styleTween,text:transition_text,textTween:transition_textTween,remove:transition_remove,tween:transition_tween,delay:transition_delay,duration:transition_duration,ease:transition_ease,easeVarying:transition_easeVarying,end:transition_end,[Symbol.iterator]:selection_prototype[Symbol.iterator]};function cubicInOut(n){return((n*=2)<=1?n*n*n:(n-=2)*n*n+2)/2}var defaultTiming={time:null,delay:0,duration:250,ease:cubicInOut};function inherit(n,r){for(var _;!(_=n.__transition)||!(_=_[r]);)if(!(n=n.parentNode))throw new Error(`transition ${r} not found`);return _}function selection_transition(n){var r,_;n instanceof Transition?(r=n._id,n=n._name):(r=newId(),(_=defaultTiming).time=now(),n=n==null?null:n+"");for(var E=this._groups,S=E.length,C=0;C<S;++C)for(var A=E[C],I=A.length,B,O=0;O<I;++O)(B=A[O])&&schedule(B,n,r,O,A,_||inherit(B,r));return new Transition(E,this._parents,n,r)}selection.prototype.interrupt=selection_interrupt;selection.prototype.transition=selection_transition;const pi=Math.PI,tau=2*pi,epsilon=1e-6,tauEpsilon=tau-epsilon;function append(n){this._+=n[0];for(let r=1,_=n.length;r<_;++r)this._+=arguments[r]+n[r]}function appendRound(n){let r=Math.floor(n);if(!(r>=0))throw new Error(`invalid digits: ${n}`);if(r>15)return append;const _=10**r;return function(E){this._+=E[0];for(let S=1,C=E.length;S<C;++S)this._+=Math.round(arguments[S]*_)/_+E[S]}}class Path{constructor(r){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=r==null?append:appendRound(r)}moveTo(r,_){this._append`M${this._x0=this._x1=+r},${this._y0=this._y1=+_}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(r,_){this._append`L${this._x1=+r},${this._y1=+_}`}quadraticCurveTo(r,_,E,S){this._append`Q${+r},${+_},${this._x1=+E},${this._y1=+S}`}bezierCurveTo(r,_,E,S,C,A){this._append`C${+r},${+_},${+E},${+S},${this._x1=+C},${this._y1=+A}`}arcTo(r,_,E,S,C){if(r=+r,_=+_,E=+E,S=+S,C=+C,C<0)throw new Error(`negative radius: ${C}`);let A=this._x1,I=this._y1,B=E-r,O=S-_,N=A-r,U=I-_,j=N*N+U*U;if(this._x1===null)this._append`M${this._x1=r},${this._y1=_}`;else if(j>epsilon)if(!(Math.abs(U*B-O*N)>epsilon)||!C)this._append`L${this._x1=r},${this._y1=_}`;else{let z=E-A,Z=S-I,X=B*B+O*O,Q=z*z+Z*Z,se=Math.sqrt(X),oe=Math.sqrt(j),ue=C*Math.tan((pi-Math.acos((X+j-Q)/(2*se*oe)))/2),we=ue/oe,Te=ue/se;Math.abs(we-1)>epsilon&&this._append`L${r+we*N},${_+we*U}`,this._append`A${C},${C},0,0,${+(U*z>N*Z)},${this._x1=r+Te*B},${this._y1=_+Te*O}`}}arc(r,_,E,S,C,A){if(r=+r,_=+_,E=+E,A=!!A,E<0)throw new Error(`negative radius: ${E}`);let I=E*Math.cos(S),B=E*Math.sin(S),O=r+I,N=_+B,U=1^A,j=A?S-C:C-S;this._x1===null?this._append`M${O},${N}`:(Math.abs(this._x1-O)>epsilon||Math.abs(this._y1-N)>epsilon)&&this._append`L${O},${N}`,E&&(j<0&&(j=j%tau+tau),j>tauEpsilon?this._append`A${E},${E},0,1,${U},${r-I},${_-B}A${E},${E},0,1,${U},${this._x1=O},${this._y1=N}`:j>epsilon&&this._append`A${E},${E},0,${+(j>=pi)},${U},${this._x1=r+E*Math.cos(C)},${this._y1=_+E*Math.sin(C)}`)}rect(r,_,E,S){this._append`M${this._x0=this._x1=+r},${this._y0=this._y1=+_}h${E=+E}v${+S}h${-E}Z`}toString(){return this._}}function formatDecimal(n){return Math.abs(n=Math.round(n))>=1e21?n.toLocaleString("en").replace(/,/g,""):n.toString(10)}function formatDecimalParts(n,r){if((_=(n=r?n.toExponential(r-1):n.toExponential()).indexOf("e"))<0)return null;var _,E=n.slice(0,_);return[E.length>1?E[0]+E.slice(2):E,+n.slice(_+1)]}function exponent(n){return n=formatDecimalParts(Math.abs(n)),n?n[1]:NaN}function formatGroup(n,r){return function(_,E){for(var S=_.length,C=[],A=0,I=n[0],B=0;S>0&&I>0&&(B+I+1>E&&(I=Math.max(1,E-B)),C.push(_.substring(S-=I,S+I)),!((B+=I+1)>E));)I=n[A=(A+1)%n.length];return C.reverse().join(r)}}function formatNumerals(n){return function(r){return r.replace(/[0-9]/g,function(_){return n[+_]})}}var re=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function formatSpecifier(n){if(!(r=re.exec(n)))throw new Error("invalid format: "+n);var r;return new FormatSpecifier({fill:r[1],align:r[2],sign:r[3],symbol:r[4],zero:r[5],width:r[6],comma:r[7],precision:r[8]&&r[8].slice(1),trim:r[9],type:r[10]})}formatSpecifier.prototype=FormatSpecifier.prototype;function FormatSpecifier(n){this.fill=n.fill===void 0?" ":n.fill+"",this.align=n.align===void 0?">":n.align+"",this.sign=n.sign===void 0?"-":n.sign+"",this.symbol=n.symbol===void 0?"":n.symbol+"",this.zero=!!n.zero,this.width=n.width===void 0?void 0:+n.width,this.comma=!!n.comma,this.precision=n.precision===void 0?void 0:+n.precision,this.trim=!!n.trim,this.type=n.type===void 0?"":n.type+""}FormatSpecifier.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function formatTrim(n){e:for(var r=n.length,_=1,E=-1,S;_<r;++_)switch(n[_]){case".":E=S=_;break;case"0":E===0&&(E=_),S=_;break;default:if(!+n[_])break e;E>0&&(E=0);break}return E>0?n.slice(0,E)+n.slice(S+1):n}var prefixExponent;function formatPrefixAuto(n,r){var _=formatDecimalParts(n,r);if(!_)return n+"";var E=_[0],S=_[1],C=S-(prefixExponent=Math.max(-8,Math.min(8,Math.floor(S/3)))*3)+1,A=E.length;return C===A?E:C>A?E+new Array(C-A+1).join("0"):C>0?E.slice(0,C)+"."+E.slice(C):"0."+new Array(1-C).join("0")+formatDecimalParts(n,Math.max(0,r+C-1))[0]}function formatRounded(n,r){var _=formatDecimalParts(n,r);if(!_)return n+"";var E=_[0],S=_[1];return S<0?"0."+new Array(-S).join("0")+E:E.length>S+1?E.slice(0,S+1)+"."+E.slice(S+1):E+new Array(S-E.length+2).join("0")}const formatTypes={"%":(n,r)=>(n*100).toFixed(r),b:n=>Math.round(n).toString(2),c:n=>n+"",d:formatDecimal,e:(n,r)=>n.toExponential(r),f:(n,r)=>n.toFixed(r),g:(n,r)=>n.toPrecision(r),o:n=>Math.round(n).toString(8),p:(n,r)=>formatRounded(n*100,r),r:formatRounded,s:formatPrefixAuto,X:n=>Math.round(n).toString(16).toUpperCase(),x:n=>Math.round(n).toString(16)};function identity$a(n){return n}var map$2=Array.prototype.map,prefixes=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function formatLocale$1(n){var r=n.grouping===void 0||n.thousands===void 0?identity$a:formatGroup(map$2.call(n.grouping,Number),n.thousands+""),_=n.currency===void 0?"":n.currency[0]+"",E=n.currency===void 0?"":n.currency[1]+"",S=n.decimal===void 0?".":n.decimal+"",C=n.numerals===void 0?identity$a:formatNumerals(map$2.call(n.numerals,String)),A=n.percent===void 0?"%":n.percent+"",I=n.minus===void 0?"":n.minus+"",B=n.nan===void 0?"NaN":n.nan+"";function O(U){U=formatSpecifier(U);var j=U.fill,z=U.align,Z=U.sign,X=U.symbol,Q=U.zero,se=U.width,oe=U.comma,ue=U.precision,we=U.trim,Te=U.type;Te==="n"?(oe=!0,Te="g"):formatTypes[Te]||(ue===void 0&&(ue=12),we=!0,Te="g"),(Q||j==="0"&&z==="=")&&(Q=!0,j="0",z="=");var xe=X==="$"?_:X==="#"&&/[boxX]/.test(Te)?"0"+Te.toLowerCase():"",Re=X==="$"?E:/[%p]/.test(Te)?A:"",Ne=formatTypes[Te],Fe=/[defgprs%]/.test(Te);ue=ue===void 0?6:/[gprs]/.test(Te)?Math.max(1,Math.min(21,ue)):Math.max(0,Math.min(20,ue));function ht(nt){var Ee=xe,Ce=Re,_e,Ie,He;if(Te==="c")Ce=Ne(nt)+Ce,nt="";else{nt=+nt;var Be=nt<0||1/nt<0;if(nt=isNaN(nt)?B:Ne(Math.abs(nt),ue),we&&(nt=formatTrim(nt)),Be&&+nt==0&&Z!=="+"&&(Be=!1),Ee=(Be?Z==="("?Z:I:Z==="-"||Z==="("?"":Z)+Ee,Ce=(Te==="s"?prefixes[8+prefixExponent/3]:"")+Ce+(Be&&Z==="("?")":""),Fe){for(_e=-1,Ie=nt.length;++_e<Ie;)if(He=nt.charCodeAt(_e),48>He||He>57){Ce=(He===46?S+nt.slice(_e+1):nt.slice(_e))+Ce,nt=nt.slice(0,_e);break}}}oe&&!Q&&(nt=r(nt,1/0));var Ge=Ee.length+nt.length+Ce.length,je=Ge<se?new Array(se-Ge+1).join(j):"";switch(oe&&Q&&(nt=r(je+nt,je.length?se-Ce.length:1/0),je=""),z){case"<":nt=Ee+nt+Ce+je;break;case"=":nt=Ee+je+nt+Ce;break;case"^":nt=je.slice(0,Ge=je.length>>1)+Ee+nt+Ce+je.slice(Ge);break;default:nt=je+Ee+nt+Ce;break}return C(nt)}return ht.toString=function(){return U+""},ht}function N(U,j){var z=O((U=formatSpecifier(U),U.type="f",U)),Z=Math.max(-8,Math.min(8,Math.floor(exponent(j)/3)))*3,X=Math.pow(10,-Z),Q=prefixes[8+Z/3];return function(se){return z(X*se)+Q}}return{format:O,formatPrefix:N}}var locale$1,format$5,formatPrefix;defaultLocale$1({thousands:",",grouping:[3],currency:["$",""]});function defaultLocale$1(n){return locale$1=formatLocale$1(n),format$5=locale$1.format,formatPrefix=locale$1.formatPrefix,locale$1}function precisionFixed(n){return Math.max(0,-exponent(Math.abs(n)))}function precisionPrefix(n,r){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(exponent(r)/3)))*3-exponent(Math.abs(n)))}function precisionRound(n,r){return n=Math.abs(n),r=Math.abs(r)-n,Math.max(0,exponent(r)-exponent(n))+1}function initRange(n,r){switch(arguments.length){case 0:break;case 1:this.range(n);break;default:this.range(r).domain(n);break}return this}function constants$3(n){return function(){return n}}function number$4(n){return+n}var unit=[0,1];function identity$9(n){return n}function normalize(n,r){return(r-=n=+n)?function(_){return(_-n)/r}:constants$3(isNaN(r)?NaN:.5)}function clamper(n,r){var _;return n>r&&(_=n,n=r,r=_),function(E){return Math.max(n,Math.min(r,E))}}function bimap(n,r,_){var E=n[0],S=n[1],C=r[0],A=r[1];return S<E?(E=normalize(S,E),C=_(A,C)):(E=normalize(E,S),C=_(C,A)),function(I){return C(E(I))}}function polymap(n,r,_){var E=Math.min(n.length,r.length)-1,S=new Array(E),C=new Array(E),A=-1;for(n[E]<n[0]&&(n=n.slice().reverse(),r=r.slice().reverse());++A<E;)S[A]=normalize(n[A],n[A+1]),C[A]=_(r[A],r[A+1]);return function(I){var B=bisectRight(n,I,1,E)-1;return C[B](S[B](I))}}function copy(n,r){return r.domain(n.domain()).range(n.range()).interpolate(n.interpolate()).clamp(n.clamp()).unknown(n.unknown())}function transformer(){var n=unit,r=unit,_=interpolate$1,E,S,C,A=identity$9,I,B,O;function N(){var j=Math.min(n.length,r.length);return A!==identity$9&&(A=clamper(n[0],n[j-1])),I=j>2?polymap:bimap,B=O=null,U}function U(j){return j==null||isNaN(j=+j)?C:(B||(B=I(n.map(E),r,_)))(E(A(j)))}return U.invert=function(j){return A(S((O||(O=I(r,n.map(E),interpolateNumber)))(j)))},U.domain=function(j){return arguments.length?(n=Array.from(j,number$4),N()):n.slice()},U.range=function(j){return arguments.length?(r=Array.from(j),N()):r.slice()},U.rangeRound=function(j){return r=Array.from(j),_=interpolateRound,N()},U.clamp=function(j){return arguments.length?(A=j?!0:identity$9,N()):A!==identity$9},U.interpolate=function(j){return arguments.length?(_=j,N()):_},U.unknown=function(j){return arguments.length?(C=j,U):C},function(j,z){return E=j,S=z,N()}}function continuous(){return transformer()(identity$9,identity$9)}function tickFormat(n,r,_,E){var S=tickStep(n,r,_),C;switch(E=formatSpecifier(E??",f"),E.type){case"s":{var A=Math.max(Math.abs(n),Math.abs(r));return E.precision==null&&!isNaN(C=precisionPrefix(S,A))&&(E.precision=C),formatPrefix(E,A)}case"":case"e":case"g":case"p":case"r":{E.precision==null&&!isNaN(C=precisionRound(S,Math.max(Math.abs(n),Math.abs(r))))&&(E.precision=C-(E.type==="e"));break}case"f":case"%":{E.precision==null&&!isNaN(C=precisionFixed(S))&&(E.precision=C-(E.type==="%")*2);break}}return format$5(E)}function linearish(n){var r=n.domain;return n.ticks=function(_){var E=r();return ticks(E[0],E[E.length-1],_??10)},n.tickFormat=function(_,E){var S=r();return tickFormat(S[0],S[S.length-1],_??10,E)},n.nice=function(_){_==null&&(_=10);var E=r(),S=0,C=E.length-1,A=E[S],I=E[C],B,O,N=10;for(I<A&&(O=A,A=I,I=O,O=S,S=C,C=O);N-- >0;){if(O=tickIncrement(A,I,_),O===B)return E[S]=A,E[C]=I,r(E);if(O>0)A=Math.floor(A/O)*O,I=Math.ceil(I/O)*O;else if(O<0)A=Math.ceil(A*O)/O,I=Math.floor(I*O)/O;else break;B=O}return n},n}function linear(){var n=continuous();return n.copy=function(){return copy(n,linear())},initRange.apply(n,arguments),linearish(n)}function nice(n,r){n=n.slice();var _=0,E=n.length-1,S=n[_],C=n[E],A;return C<S&&(A=_,_=E,E=A,A=S,S=C,C=A),n[_]=r.floor(S),n[E]=r.ceil(C),n}const t0=new Date,t1=new Date;function timeInterval(n,r,_,E){function S(C){return n(C=arguments.length===0?new Date:new Date(+C)),C}return S.floor=C=>(n(C=new Date(+C)),C),S.ceil=C=>(n(C=new Date(C-1)),r(C,1),n(C),C),S.round=C=>{const A=S(C),I=S.ceil(C);return C-A<I-C?A:I},S.offset=(C,A)=>(r(C=new Date(+C),A==null?1:Math.floor(A)),C),S.range=(C,A,I)=>{const B=[];if(C=S.ceil(C),I=I==null?1:Math.floor(I),!(C<A)||!(I>0))return B;let O;do B.push(O=new Date(+C)),r(C,I),n(C);while(O<C&&C<A);return B},S.filter=C=>timeInterval(A=>{if(A>=A)for(;n(A),!C(A);)A.setTime(A-1)},(A,I)=>{if(A>=A)if(I<0)for(;++I<=0;)for(;r(A,-1),!C(A););else for(;--I>=0;)for(;r(A,1),!C(A););}),_&&(S.count=(C,A)=>(t0.setTime(+C),t1.setTime(+A),n(t0),n(t1),Math.floor(_(t0,t1))),S.every=C=>(C=Math.floor(C),!isFinite(C)||!(C>0)?null:C>1?S.filter(E?A=>E(A)%C===0:A=>S.count(0,A)%C===0):S)),S}const millisecond=timeInterval(()=>{},(n,r)=>{n.setTime(+n+r)},(n,r)=>r-n);millisecond.every=n=>(n=Math.floor(n),!isFinite(n)||!(n>0)?null:n>1?timeInterval(r=>{r.setTime(Math.floor(r/n)*n)},(r,_)=>{r.setTime(+r+_*n)},(r,_)=>(_-r)/n):millisecond);millisecond.range;const durationSecond=1e3,durationMinute=durationSecond*60,durationHour=durationMinute*60,durationDay=durationHour*24,durationWeek=durationDay*7,durationMonth=durationDay*30,durationYear=durationDay*365,second$2=timeInterval(n=>{n.setTime(n-n.getMilliseconds())},(n,r)=>{n.setTime(+n+r*durationSecond)},(n,r)=>(r-n)/durationSecond,n=>n.getUTCSeconds());second$2.range;const timeMinute=timeInterval(n=>{n.setTime(n-n.getMilliseconds()-n.getSeconds()*durationSecond)},(n,r)=>{n.setTime(+n+r*durationMinute)},(n,r)=>(r-n)/durationMinute,n=>n.getMinutes());timeMinute.range;const utcMinute=timeInterval(n=>{n.setUTCSeconds(0,0)},(n,r)=>{n.setTime(+n+r*durationMinute)},(n,r)=>(r-n)/durationMinute,n=>n.getUTCMinutes());utcMinute.range;const timeHour=timeInterval(n=>{n.setTime(n-n.getMilliseconds()-n.getSeconds()*durationSecond-n.getMinutes()*durationMinute)},(n,r)=>{n.setTime(+n+r*durationHour)},(n,r)=>(r-n)/durationHour,n=>n.getHours());timeHour.range;const utcHour=timeInterval(n=>{n.setUTCMinutes(0,0,0)},(n,r)=>{n.setTime(+n+r*durationHour)},(n,r)=>(r-n)/durationHour,n=>n.getUTCHours());utcHour.range;const timeDay=timeInterval(n=>n.setHours(0,0,0,0),(n,r)=>n.setDate(n.getDate()+r),(n,r)=>(r-n-(r.getTimezoneOffset()-n.getTimezoneOffset())*durationMinute)/durationDay,n=>n.getDate()-1);timeDay.range;const utcDay=timeInterval(n=>{n.setUTCHours(0,0,0,0)},(n,r)=>{n.setUTCDate(n.getUTCDate()+r)},(n,r)=>(r-n)/durationDay,n=>n.getUTCDate()-1);utcDay.range;const unixDay=timeInterval(n=>{n.setUTCHours(0,0,0,0)},(n,r)=>{n.setUTCDate(n.getUTCDate()+r)},(n,r)=>(r-n)/durationDay,n=>Math.floor(n/durationDay));unixDay.range;function timeWeekday(n){return timeInterval(r=>{r.setDate(r.getDate()-(r.getDay()+7-n)%7),r.setHours(0,0,0,0)},(r,_)=>{r.setDate(r.getDate()+_*7)},(r,_)=>(_-r-(_.getTimezoneOffset()-r.getTimezoneOffset())*durationMinute)/durationWeek)}const timeSunday=timeWeekday(0),timeMonday=timeWeekday(1),timeTuesday=timeWeekday(2),timeWednesday=timeWeekday(3),timeThursday=timeWeekday(4),timeFriday=timeWeekday(5),timeSaturday=timeWeekday(6);timeSunday.range;timeMonday.range;timeTuesday.range;timeWednesday.range;timeThursday.range;timeFriday.range;timeSaturday.range;function utcWeekday(n){return timeInterval(r=>{r.setUTCDate(r.getUTCDate()-(r.getUTCDay()+7-n)%7),r.setUTCHours(0,0,0,0)},(r,_)=>{r.setUTCDate(r.getUTCDate()+_*7)},(r,_)=>(_-r)/durationWeek)}const utcSunday=utcWeekday(0),utcMonday=utcWeekday(1),utcTuesday=utcWeekday(2),utcWednesday=utcWeekday(3),utcThursday=utcWeekday(4),utcFriday=utcWeekday(5),utcSaturday=utcWeekday(6);utcSunday.range;utcMonday.range;utcTuesday.range;utcWednesday.range;utcThursday.range;utcFriday.range;utcSaturday.range;const timeMonth=timeInterval(n=>{n.setDate(1),n.setHours(0,0,0,0)},(n,r)=>{n.setMonth(n.getMonth()+r)},(n,r)=>r.getMonth()-n.getMonth()+(r.getFullYear()-n.getFullYear())*12,n=>n.getMonth());timeMonth.range;const utcMonth=timeInterval(n=>{n.setUTCDate(1),n.setUTCHours(0,0,0,0)},(n,r)=>{n.setUTCMonth(n.getUTCMonth()+r)},(n,r)=>r.getUTCMonth()-n.getUTCMonth()+(r.getUTCFullYear()-n.getUTCFullYear())*12,n=>n.getUTCMonth());utcMonth.range;const timeYear=timeInterval(n=>{n.setMonth(0,1),n.setHours(0,0,0,0)},(n,r)=>{n.setFullYear(n.getFullYear()+r)},(n,r)=>r.getFullYear()-n.getFullYear(),n=>n.getFullYear());timeYear.every=n=>!isFinite(n=Math.floor(n))||!(n>0)?null:timeInterval(r=>{r.setFullYear(Math.floor(r.getFullYear()/n)*n),r.setMonth(0,1),r.setHours(0,0,0,0)},(r,_)=>{r.setFullYear(r.getFullYear()+_*n)});timeYear.range;const utcYear=timeInterval(n=>{n.setUTCMonth(0,1),n.setUTCHours(0,0,0,0)},(n,r)=>{n.setUTCFullYear(n.getUTCFullYear()+r)},(n,r)=>r.getUTCFullYear()-n.getUTCFullYear(),n=>n.getUTCFullYear());utcYear.every=n=>!isFinite(n=Math.floor(n))||!(n>0)?null:timeInterval(r=>{r.setUTCFullYear(Math.floor(r.getUTCFullYear()/n)*n),r.setUTCMonth(0,1),r.setUTCHours(0,0,0,0)},(r,_)=>{r.setUTCFullYear(r.getUTCFullYear()+_*n)});utcYear.range;function ticker(n,r,_,E,S,C){const A=[[second$2,1,durationSecond],[second$2,5,5*durationSecond],[second$2,15,15*durationSecond],[second$2,30,30*durationSecond],[C,1,durationMinute],[C,5,5*durationMinute],[C,15,15*durationMinute],[C,30,30*durationMinute],[S,1,durationHour],[S,3,3*durationHour],[S,6,6*durationHour],[S,12,12*durationHour],[E,1,durationDay],[E,2,2*durationDay],[_,1,durationWeek],[r,1,durationMonth],[r,3,3*durationMonth],[n,1,durationYear]];function I(O,N,U){const j=N<O;j&&([O,N]=[N,O]);const z=U&&typeof U.range=="function"?U:B(O,N,U),Z=z?z.range(O,+N+1):[];return j?Z.reverse():Z}function B(O,N,U){const j=Math.abs(N-O)/U,z=bisector(([,,Q])=>Q).right(A,j);if(z===A.length)return n.every(tickStep(O/durationYear,N/durationYear,U));if(z===0)return millisecond.every(Math.max(tickStep(O,N,U),1));const[Z,X]=A[j/A[z-1][2]<A[z][2]/j?z-1:z];return Z.every(X)}return[I,B]}const[timeTicks,timeTickInterval]=ticker(timeYear,timeMonth,timeSunday,timeDay,timeHour,timeMinute);function localDate(n){if(0<=n.y&&n.y<100){var r=new Date(-1,n.m,n.d,n.H,n.M,n.S,n.L);return r.setFullYear(n.y),r}return new Date(n.y,n.m,n.d,n.H,n.M,n.S,n.L)}function utcDate(n){if(0<=n.y&&n.y<100){var r=new Date(Date.UTC(-1,n.m,n.d,n.H,n.M,n.S,n.L));return r.setUTCFullYear(n.y),r}return new Date(Date.UTC(n.y,n.m,n.d,n.H,n.M,n.S,n.L))}function newDate(n,r,_){return{y:n,m:r,d:_,H:0,M:0,S:0,L:0}}function formatLocale(n){var r=n.dateTime,_=n.date,E=n.time,S=n.periods,C=n.days,A=n.shortDays,I=n.months,B=n.shortMonths,O=formatRe(S),N=formatLookup(S),U=formatRe(C),j=formatLookup(C),z=formatRe(A),Z=formatLookup(A),X=formatRe(I),Q=formatLookup(I),se=formatRe(B),oe=formatLookup(B),ue={a:Be,A:Ge,b:je,B:Ve,c:null,d:formatDayOfMonth,e:formatDayOfMonth,f:formatMicroseconds,g:formatYearISO,G:formatFullYearISO,H:formatHour24,I:formatHour12,j:formatDayOfYear,L:formatMilliseconds,m:formatMonthNumber,M:formatMinutes,p:Pe,q:Me,Q:formatUnixTimestamp,s:formatUnixTimestampSeconds,S:formatSeconds,u:formatWeekdayNumberMonday,U:formatWeekNumberSunday,V:formatWeekNumberISO,w:formatWeekdayNumberSunday,W:formatWeekNumberMonday,x:null,X:null,y:formatYear,Y:formatFullYear,Z:formatZone,"%":formatLiteralPercent},we={a:tt,A:Ke,b:mt,B:ct,c:null,d:formatUTCDayOfMonth,e:formatUTCDayOfMonth,f:formatUTCMicroseconds,g:formatUTCYearISO,G:formatUTCFullYearISO,H:formatUTCHour24,I:formatUTCHour12,j:formatUTCDayOfYear,L:formatUTCMilliseconds,m:formatUTCMonthNumber,M:formatUTCMinutes,p:Qe,q:dt,Q:formatUnixTimestamp,s:formatUnixTimestampSeconds,S:formatUTCSeconds,u:formatUTCWeekdayNumberMonday,U:formatUTCWeekNumberSunday,V:formatUTCWeekNumberISO,w:formatUTCWeekdayNumberSunday,W:formatUTCWeekNumberMonday,x:null,X:null,y:formatUTCYear,Y:formatUTCFullYear,Z:formatUTCZone,"%":formatLiteralPercent},Te={a:ht,A:nt,b:Ee,B:Ce,c:_e,d:parseDayOfMonth,e:parseDayOfMonth,f:parseMicroseconds,g:parseYear,G:parseFullYear,H:parseHour24,I:parseHour24,j:parseDayOfYear,L:parseMilliseconds,m:parseMonthNumber,M:parseMinutes,p:Fe,q:parseQuarter,Q:parseUnixTimestamp,s:parseUnixTimestampSeconds,S:parseSeconds,u:parseWeekdayNumberMonday,U:parseWeekNumberSunday,V:parseWeekNumberISO,w:parseWeekdayNumberSunday,W:parseWeekNumberMonday,x:Ie,X:He,y:parseYear,Y:parseFullYear,Z:parseZone,"%":parseLiteralPercent};ue.x=xe(_,ue),ue.X=xe(E,ue),ue.c=xe(r,ue),we.x=xe(_,we),we.X=xe(E,we),we.c=xe(r,we);function xe(vt,At){return function(bt){var ft=[],Et=-1,Ye=0,Ct=vt.length,Pt,St,$t;for(bt instanceof Date||(bt=new Date(+bt));++Et<Ct;)vt.charCodeAt(Et)===37&&(ft.push(vt.slice(Ye,Et)),(St=pads[Pt=vt.charAt(++Et)])!=null?Pt=vt.charAt(++Et):St=Pt==="e"?" ":"0",($t=At[Pt])&&(Pt=$t(bt,St)),ft.push(Pt),Ye=Et+1);return ft.push(vt.slice(Ye,Et)),ft.join("")}}function Re(vt,At){return function(bt){var ft=newDate(1900,void 0,1),Et=Ne(ft,vt,bt+="",0),Ye,Ct;if(Et!=bt.length)return null;if("Q"in ft)return new Date(ft.Q);if("s"in ft)return new Date(ft.s*1e3+("L"in ft?ft.L:0));if(At&&!("Z"in ft)&&(ft.Z=0),"p"in ft&&(ft.H=ft.H%12+ft.p*12),ft.m===void 0&&(ft.m="q"in ft?ft.q:0),"V"in ft){if(ft.V<1||ft.V>53)return null;"w"in ft||(ft.w=1),"Z"in ft?(Ye=utcDate(newDate(ft.y,0,1)),Ct=Ye.getUTCDay(),Ye=Ct>4||Ct===0?utcMonday.ceil(Ye):utcMonday(Ye),Ye=utcDay.offset(Ye,(ft.V-1)*7),ft.y=Ye.getUTCFullYear(),ft.m=Ye.getUTCMonth(),ft.d=Ye.getUTCDate()+(ft.w+6)%7):(Ye=localDate(newDate(ft.y,0,1)),Ct=Ye.getDay(),Ye=Ct>4||Ct===0?timeMonday.ceil(Ye):timeMonday(Ye),Ye=timeDay.offset(Ye,(ft.V-1)*7),ft.y=Ye.getFullYear(),ft.m=Ye.getMonth(),ft.d=Ye.getDate()+(ft.w+6)%7)}else("W"in ft||"U"in ft)&&("w"in ft||(ft.w="u"in ft?ft.u%7:"W"in ft?1:0),Ct="Z"in ft?utcDate(newDate(ft.y,0,1)).getUTCDay():localDate(newDate(ft.y,0,1)).getDay(),ft.m=0,ft.d="W"in ft?(ft.w+6)%7+ft.W*7-(Ct+5)%7:ft.w+ft.U*7-(Ct+6)%7);return"Z"in ft?(ft.H+=ft.Z/100|0,ft.M+=ft.Z%100,utcDate(ft)):localDate(ft)}}function Ne(vt,At,bt,ft){for(var Et=0,Ye=At.length,Ct=bt.length,Pt,St;Et<Ye;){if(ft>=Ct)return-1;if(Pt=At.charCodeAt(Et++),Pt===37){if(Pt=At.charAt(Et++),St=Te[Pt in pads?At.charAt(Et++):Pt],!St||(ft=St(vt,bt,ft))<0)return-1}else if(Pt!=bt.charCodeAt(ft++))return-1}return ft}function Fe(vt,At,bt){var ft=O.exec(At.slice(bt));return ft?(vt.p=N.get(ft[0].toLowerCase()),bt+ft[0].length):-1}function ht(vt,At,bt){var ft=z.exec(At.slice(bt));return ft?(vt.w=Z.get(ft[0].toLowerCase()),bt+ft[0].length):-1}function nt(vt,At,bt){var ft=U.exec(At.slice(bt));return ft?(vt.w=j.get(ft[0].toLowerCase()),bt+ft[0].length):-1}function Ee(vt,At,bt){var ft=se.exec(At.slice(bt));return ft?(vt.m=oe.get(ft[0].toLowerCase()),bt+ft[0].length):-1}function Ce(vt,At,bt){var ft=X.exec(At.slice(bt));return ft?(vt.m=Q.get(ft[0].toLowerCase()),bt+ft[0].length):-1}function _e(vt,At,bt){return Ne(vt,r,At,bt)}function Ie(vt,At,bt){return Ne(vt,_,At,bt)}function He(vt,At,bt){return Ne(vt,E,At,bt)}function Be(vt){return A[vt.getDay()]}function Ge(vt){return C[vt.getDay()]}function je(vt){return B[vt.getMonth()]}function Ve(vt){return I[vt.getMonth()]}function Pe(vt){return S[+(vt.getHours()>=12)]}function Me(vt){return 1+~~(vt.getMonth()/3)}function tt(vt){return A[vt.getUTCDay()]}function Ke(vt){return C[vt.getUTCDay()]}function mt(vt){return B[vt.getUTCMonth()]}function ct(vt){return I[vt.getUTCMonth()]}function Qe(vt){return S[+(vt.getUTCHours()>=12)]}function dt(vt){return 1+~~(vt.getUTCMonth()/3)}return{format:function(vt){var At=xe(vt+="",ue);return At.toString=function(){return vt},At},parse:function(vt){var At=Re(vt+="",!1);return At.toString=function(){return vt},At},utcFormat:function(vt){var At=xe(vt+="",we);return At.toString=function(){return vt},At},utcParse:function(vt){var At=Re(vt+="",!0);return At.toString=function(){return vt},At}}}var pads={"-":"",_:" ",0:"0"},numberRe=/^\s*\d+/,percentRe=/^%/,requoteRe=/[\\^$*+?|[\]().{}]/g;function pad(n,r,_){var E=n<0?"-":"",S=(E?-n:n)+"",C=S.length;return E+(C<_?new Array(_-C+1).join(r)+S:S)}function requote(n){return n.replace(requoteRe,"\\$&")}function formatRe(n){return new RegExp("^(?:"+n.map(requote).join("|")+")","i")}function formatLookup(n){return new Map(n.map((r,_)=>[r.toLowerCase(),_]))}function parseWeekdayNumberSunday(n,r,_){var E=numberRe.exec(r.slice(_,_+1));return E?(n.w=+E[0],_+E[0].length):-1}function parseWeekdayNumberMonday(n,r,_){var E=numberRe.exec(r.slice(_,_+1));return E?(n.u=+E[0],_+E[0].length):-1}function parseWeekNumberSunday(n,r,_){var E=numberRe.exec(r.slice(_,_+2));return E?(n.U=+E[0],_+E[0].length):-1}function parseWeekNumberISO(n,r,_){var E=numberRe.exec(r.slice(_,_+2));return E?(n.V=+E[0],_+E[0].length):-1}function parseWeekNumberMonday(n,r,_){var E=numberRe.exec(r.slice(_,_+2));return E?(n.W=+E[0],_+E[0].length):-1}function parseFullYear(n,r,_){var E=numberRe.exec(r.slice(_,_+4));return E?(n.y=+E[0],_+E[0].length):-1}function parseYear(n,r,_){var E=numberRe.exec(r.slice(_,_+2));return E?(n.y=+E[0]+(+E[0]>68?1900:2e3),_+E[0].length):-1}function parseZone(n,r,_){var E=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(r.slice(_,_+6));return E?(n.Z=E[1]?0:-(E[2]+(E[3]||"00")),_+E[0].length):-1}function parseQuarter(n,r,_){var E=numberRe.exec(r.slice(_,_+1));return E?(n.q=E[0]*3-3,_+E[0].length):-1}function parseMonthNumber(n,r,_){var E=numberRe.exec(r.slice(_,_+2));return E?(n.m=E[0]-1,_+E[0].length):-1}function parseDayOfMonth(n,r,_){var E=numberRe.exec(r.slice(_,_+2));return E?(n.d=+E[0],_+E[0].length):-1}function parseDayOfYear(n,r,_){var E=numberRe.exec(r.slice(_,_+3));return E?(n.m=0,n.d=+E[0],_+E[0].length):-1}function parseHour24(n,r,_){var E=numberRe.exec(r.slice(_,_+2));return E?(n.H=+E[0],_+E[0].length):-1}function parseMinutes(n,r,_){var E=numberRe.exec(r.slice(_,_+2));return E?(n.M=+E[0],_+E[0].length):-1}function parseSeconds(n,r,_){var E=numberRe.exec(r.slice(_,_+2));return E?(n.S=+E[0],_+E[0].length):-1}function parseMilliseconds(n,r,_){var E=numberRe.exec(r.slice(_,_+3));return E?(n.L=+E[0],_+E[0].length):-1}function parseMicroseconds(n,r,_){var E=numberRe.exec(r.slice(_,_+6));return E?(n.L=Math.floor(E[0]/1e3),_+E[0].length):-1}function parseLiteralPercent(n,r,_){var E=percentRe.exec(r.slice(_,_+1));return E?_+E[0].length:-1}function parseUnixTimestamp(n,r,_){var E=numberRe.exec(r.slice(_));return E?(n.Q=+E[0],_+E[0].length):-1}function parseUnixTimestampSeconds(n,r,_){var E=numberRe.exec(r.slice(_));return E?(n.s=+E[0],_+E[0].length):-1}function formatDayOfMonth(n,r){return pad(n.getDate(),r,2)}function formatHour24(n,r){return pad(n.getHours(),r,2)}function formatHour12(n,r){return pad(n.getHours()%12||12,r,2)}function formatDayOfYear(n,r){return pad(1+timeDay.count(timeYear(n),n),r,3)}function formatMilliseconds(n,r){return pad(n.getMilliseconds(),r,3)}function formatMicroseconds(n,r){return formatMilliseconds(n,r)+"000"}function formatMonthNumber(n,r){return pad(n.getMonth()+1,r,2)}function formatMinutes(n,r){return pad(n.getMinutes(),r,2)}function formatSeconds(n,r){return pad(n.getSeconds(),r,2)}function formatWeekdayNumberMonday(n){var r=n.getDay();return r===0?7:r}function formatWeekNumberSunday(n,r){return pad(timeSunday.count(timeYear(n)-1,n),r,2)}function dISO(n){var r=n.getDay();return r>=4||r===0?timeThursday(n):timeThursday.ceil(n)}function formatWeekNumberISO(n,r){return n=dISO(n),pad(timeThursday.count(timeYear(n),n)+(timeYear(n).getDay()===4),r,2)}function formatWeekdayNumberSunday(n){return n.getDay()}function formatWeekNumberMonday(n,r){return pad(timeMonday.count(timeYear(n)-1,n),r,2)}function formatYear(n,r){return pad(n.getFullYear()%100,r,2)}function formatYearISO(n,r){return n=dISO(n),pad(n.getFullYear()%100,r,2)}function formatFullYear(n,r){return pad(n.getFullYear()%1e4,r,4)}function formatFullYearISO(n,r){var _=n.getDay();return n=_>=4||_===0?timeThursday(n):timeThursday.ceil(n),pad(n.getFullYear()%1e4,r,4)}function formatZone(n){var r=n.getTimezoneOffset();return(r>0?"-":(r*=-1,"+"))+pad(r/60|0,"0",2)+pad(r%60,"0",2)}function formatUTCDayOfMonth(n,r){return pad(n.getUTCDate(),r,2)}function formatUTCHour24(n,r){return pad(n.getUTCHours(),r,2)}function formatUTCHour12(n,r){return pad(n.getUTCHours()%12||12,r,2)}function formatUTCDayOfYear(n,r){return pad(1+utcDay.count(utcYear(n),n),r,3)}function formatUTCMilliseconds(n,r){return pad(n.getUTCMilliseconds(),r,3)}function formatUTCMicroseconds(n,r){return formatUTCMilliseconds(n,r)+"000"}function formatUTCMonthNumber(n,r){return pad(n.getUTCMonth()+1,r,2)}function formatUTCMinutes(n,r){return pad(n.getUTCMinutes(),r,2)}function formatUTCSeconds(n,r){return pad(n.getUTCSeconds(),r,2)}function formatUTCWeekdayNumberMonday(n){var r=n.getUTCDay();return r===0?7:r}function formatUTCWeekNumberSunday(n,r){return pad(utcSunday.count(utcYear(n)-1,n),r,2)}function UTCdISO(n){var r=n.getUTCDay();return r>=4||r===0?utcThursday(n):utcThursday.ceil(n)}function formatUTCWeekNumberISO(n,r){return n=UTCdISO(n),pad(utcThursday.count(utcYear(n),n)+(utcYear(n).getUTCDay()===4),r,2)}function formatUTCWeekdayNumberSunday(n){return n.getUTCDay()}function formatUTCWeekNumberMonday(n,r){return pad(utcMonday.count(utcYear(n)-1,n),r,2)}function formatUTCYear(n,r){return pad(n.getUTCFullYear()%100,r,2)}function formatUTCYearISO(n,r){return n=UTCdISO(n),pad(n.getUTCFullYear()%100,r,2)}function formatUTCFullYear(n,r){return pad(n.getUTCFullYear()%1e4,r,4)}function formatUTCFullYearISO(n,r){var _=n.getUTCDay();return n=_>=4||_===0?utcThursday(n):utcThursday.ceil(n),pad(n.getUTCFullYear()%1e4,r,4)}function formatUTCZone(){return"+0000"}function formatLiteralPercent(){return"%"}function formatUnixTimestamp(n){return+n}function formatUnixTimestampSeconds(n){return Math.floor(+n/1e3)}var locale,timeFormat;defaultLocale({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function defaultLocale(n){return locale=formatLocale(n),timeFormat=locale.format,locale.parse,locale.utcFormat,locale.utcParse,locale}function date(n){return new Date(n)}function number$3(n){return n instanceof Date?+n:+new Date(+n)}function calendar(n,r,_,E,S,C,A,I,B,O){var N=continuous(),U=N.invert,j=N.domain,z=O(".%L"),Z=O(":%S"),X=O("%I:%M"),Q=O("%I %p"),se=O("%a %d"),oe=O("%b %d"),ue=O("%B"),we=O("%Y");function Te(xe){return(B(xe)<xe?z:I(xe)<xe?Z:A(xe)<xe?X:C(xe)<xe?Q:E(xe)<xe?S(xe)<xe?se:oe:_(xe)<xe?ue:we)(xe)}return N.invert=function(xe){return new Date(U(xe))},N.domain=function(xe){return arguments.length?j(Array.from(xe,number$3)):j().map(date)},N.ticks=function(xe){var Re=j();return n(Re[0],Re[Re.length-1],xe??10)},N.tickFormat=function(xe,Re){return Re==null?Te:O(Re)},N.nice=function(xe){var Re=j();return(!xe||typeof xe.range!="function")&&(xe=r(Re[0],Re[Re.length-1],xe??10)),xe?j(nice(Re,xe)):N},N.copy=function(){return copy(N,calendar(n,r,_,E,S,C,A,I,B,O))},N}function time(){return initRange.apply(calendar(timeTicks,timeTickInterval,timeYear,timeMonth,timeSunday,timeDay,timeHour,timeMinute,second$2,timeFormat).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function constant(n){return function(){return n}}function withPath(n){let r=3;return n.digits=function(_){if(!arguments.length)return r;if(_==null)r=null;else{const E=Math.floor(_);if(!(E>=0))throw new RangeError(`invalid digits: ${_}`);r=E}return n},()=>new Path(r)}function array(n){return typeof n=="object"&&"length"in n?n:Array.from(n)}function Linear(n){this._context=n}Linear.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(n,r){switch(n=+n,r=+r,this._point){case 0:this._point=1,this._line?this._context.lineTo(n,r):this._context.moveTo(n,r);break;case 1:this._point=2;default:this._context.lineTo(n,r);break}}};function curveLinear(n){return new Linear(n)}function x(n){return n[0]}function y(n){return n[1]}function line(n,r){var _=constant(!0),E=null,S=curveLinear,C=null,A=withPath(I);n=typeof n=="function"?n:n===void 0?x:constant(n),r=typeof r=="function"?r:r===void 0?y:constant(r);function I(B){var O,N=(B=array(B)).length,U,j=!1,z;for(E==null&&(C=S(z=A())),O=0;O<=N;++O)!(O<N&&_(U=B[O],O,B))===j&&((j=!j)?C.lineStart():C.lineEnd()),j&&C.point(+n(U,O,B),+r(U,O,B));if(z)return C=null,z+""||null}return I.x=function(B){return arguments.length?(n=typeof B=="function"?B:constant(+B),I):n},I.y=function(B){return arguments.length?(r=typeof B=="function"?B:constant(+B),I):r},I.defined=function(B){return arguments.length?(_=typeof B=="function"?B:constant(!!B),I):_},I.curve=function(B){return arguments.length?(S=B,E!=null&&(C=S(E)),I):S},I.context=function(B){return arguments.length?(B==null?E=C=null:C=S(E=B),I):E},I}function Transform$1(n,r,_){this.k=n,this.x=r,this.y=_}Transform$1.prototype={constructor:Transform$1,scale:function(n){return n===1?this:new Transform$1(this.k*n,this.x,this.y)},translate:function(n,r){return n===0&r===0?this:new Transform$1(this.k,this.x+this.k*n,this.y+this.k*r)},apply:function(n){return[n[0]*this.k+this.x,n[1]*this.k+this.y]},applyX:function(n){return n*this.k+this.x},applyY:function(n){return n*this.k+this.y},invert:function(n){return[(n[0]-this.x)/this.k,(n[1]-this.y)/this.k]},invertX:function(n){return(n-this.x)/this.k},invertY:function(n){return(n-this.y)/this.k},rescaleX:function(n){return n.copy().domain(n.range().map(this.invertX,this).map(n.invert,n))},rescaleY:function(n){return n.copy().domain(n.range().map(this.invertY,this).map(n.invert,n))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};Transform$1.prototype;const makeVSheetProps=propsFactory({color:String,...makeBorderProps(),...makeComponentProps(),...makeDimensionProps(),...makeElevationProps(),...makeLocationProps(),...makePositionProps(),...makeRoundedProps(),...makeTagProps(),...makeThemeProps()},"VSheet"),VSheet=genericComponent()({name:"VSheet",props:makeVSheetProps(),setup(n,r){let{slots:_}=r;const{themeClasses:E}=provideTheme(n),{backgroundColorClasses:S,backgroundColorStyles:C}=useBackgroundColor(toRef(n,"color")),{borderClasses:A}=useBorder(n),{dimensionStyles:I}=useDimension(n),{elevationClasses:B}=useElevation(n),{locationStyles:O}=useLocation(n),{positionClasses:N}=usePosition(n),{roundedClasses:U}=useRounded(n);return useRender(()=>createVNode(n.tag,{class:["v-sheet",E.value,S.value,A.value,B.value,N.value,U.value,n.class],style:[C.value,I.value,O.value,n.style]},_)),{}}}),_withScopeId=n=>(pushScopeId("data-v-0e21cbcf"),n=n(),popScopeId(),n),_hoisted_1$3={class:"text-center"},_hoisted_2$3=_withScopeId(()=>createBaseVNode("g",{class:"x-axis"},null,-1)),_hoisted_3$1=_withScopeId(()=>createBaseVNode("g",{class:"y-axis"},null,-1)),_hoisted_4$1=[_hoisted_2$3,_hoisted_3$1],_hoisted_5={class:"mx-auto text-h6 text-center text-disabled"},_sfc_main$8=defineComponent$1({__name:"GraphiqueStation",props:{hauteur:{},vals:{}},setup(n){const r=n,{_:_}=_(),{_:E}=_(),{$:S}=E(),C=computed(()=>(r.vals||[]).map(Q=>({date:new Date(Q.date),prcip:Q.prcip}))),A=ref$2(null),I=computed(()=>!!C.value.length),B=(Q,se)=>Q.getDate()===se.getDate()&&Q.getMonth()===se.getMonth()&&Q.getFullYear()===se.getFullYear(),O=function(Q,se){for(var oe=[],ue=new Date(Q);ue<=new Date(se);ue.setDate(ue.getDate()+1))oe.push(new Date(ue));return oe},N=computed(()=>{const Q=[];return O(new Date(Math.min(...C.value.map(oe=>oe.date.getTime()))),new Date(Math.max(...C.value.map(oe=>oe.date.getTime())))).forEach(oe=>{const ue=C.value.filter(we=>B(we.date,oe));if(ue.length)for(const we of ue)Q.push({...we,prcip:we.prcip+(Q.length?Q[Q.length-1].prcip:0)});else Q.push({date:oe,prcip:Q.length?Q[Q.length-1].prcip:0})}),Q}),U={},j=Q=>(U[Q.toString()]||(U[Q.toString()]=_(Q)),U[Q.toString()].value);onMounted(()=>{const Q=select$1(A.value);watchEffect(()=>{const{width:se,height:oe}=X.dimensions;if(!(se&&oe))return;const ue=time().domain(extent(C.value,Re=>Re.date)).range([0,se]),we=linear().domain([0,max(N.value,Re=>Re.prcip)]).range([oe,0]);Q.selectAll(".line").data([N.value]).join("path").attr("class","line").attr("fill","none").attr("stroke","#69b3a2").attr("stroke-width",1.5).attr("d",line().x(Re=>ue(Re.date)).y(Re=>we(Re.prcip))),Q.selectAll(".bar").data(C.value).join("rect").attr("class","bar").attr("x",function(Re){return ue(Re.date)}).attr("y",function(Re){return we(Re.prcip)}).attr("width",2).attr("height",function(Re){return oe-we(Re.prcip)}).attr("fill","steelblue"),Q.selectAll("bar").transition().duration(800).attr("y",function(Re){return we(Re.prcip)}).attr("height",function(Re){return oe-we(Re.prcip)}).delay((Re,Ne)=>Ne*100);const Te=axisBottom(ue);Q.select(".x-axis").style("transform",`translateY(${oe}px)`).call(Te).append("text");const xe=axisLeft(we);xe.tickFormat(Re=>j(Re.valueOf())),Q.select(".y-axis").call(xe)})});const z=()=>{const Q=ref$2(),se=reactive({dimensions:{}}),oe=new ResizeObserver(ue=>{ue.forEach(we=>{se.dimensions=we.contentRect})});return onMounted(()=>{se.dimensions=Q.value.getBoundingClientRect(),oe.observe(Q.value)}),onBeforeUnmount(()=>{oe.unobserve(Q.value)}),{resizeState:se,resizeRef:Q}},{resizeRef:Z,resizeState:X}=z();return(Q,se)=>(openBlock(),createBlock(VSheet,{width:"100%",height:Q.hauteur,class:"text-center mb-2"},{default:withCtx(()=>[createBaseVNode("div",_hoisted_1$3,[withDirectives(createBaseVNode("div",{ref_key:"resizeRef",ref:Z,class:"ma-6"},[(openBlock(),createElementBlock("svg",{ref_key:"svgRef",ref:A,width:"100%"},_hoisted_4$1,512))],512),[[vShow,I.value]]),withDirectives(createVNode(VCard,{class:"d-flex align-center text-center",variant:"flat",height:Q.hauteur},{default:withCtx(()=>[createVNode(VCardText,null,{default:withCtx(()=>[createBaseVNode("div",_hoisted_5,toDisplayString(unref(S)("dmo.graphique.aucuneDonne")),1)]),_:1})]),_:1},8,["height"]),[[vShow,!I.value]])])]),_:1},8,["height"]))}}),_export_sfc=(n,r)=>{const _=n.__vccOpts||n;for(const[E,S]of r)_[E]=S;return _},GraphiqueStation=_export_sfc(_sfc_main$8,[["__scopeId","data-v-0e21cbcf"]]);var arrayMedian=median,nonNumericMsg="all values passed to `median` must be numeric";function median(n){if(Array.isArray(n)||(n=[].slice.call(arguments)),!n.length)throw new Error("no values were passed to `median`");if(n.length==1){if(Number.isFinite(n[0]))return n[0];throw new Error(nonNumericMsg)}var r=n.sort(function(E,S){if(!Number.isFinite(E))throw new Error(nonNumericMsg);return E>=S?1:-1}),_=Math.floor(n.length/2);return n.length/2!=_?r[_]:(r[_]+r[_-1])/2}const img63f33000="/egu24/assets/63f33000-3c5b-4ae1-a471-ff320fdd8379-CkFTv_kn.jpg",imgb61c5c12="/egu24/assets/b61c5c12-80a0-4792-b2dd-863df41e0036-BamqBV64.jpg",imgb3cc1b86="/egu24/assets/b3cc1b86-e461-4799-adf8-5fbc773ef259-CtnpY-uv.jpg",img0fd998f2="/egu24/assets/0fd998f2-1d93-4977-8dfa-8d5e06c5ac66-BPb-konN.jpg",img111bb611="/egu24/assets/111bb611-4d13-4078-8efe-3dd3ec188023-Bte4qWoZ.jpg",img57c27ead="/egu24/assets/57c27ead-0c8d-430d-bab5-937f4e752655-B5PxNzRd.jpg",img354d9aec="/egu24/assets/354d9aec-847d-4aad-8b03-8b873717295f-rfduqy1g.jpg",img54e41355="/egu24/assets/54e41355-abe3-4d60-aaae-da2855fbdee9-D74s8Xq4.jpg",img3ef4a7d4="/egu24/assets/3ef4a7d4-b671-4afc-b2b8-edf18985829e-DGis44zM.jpg",imgfde62246="/egu24/assets/fde62246-d40e-49db-830d-5a42a142d676-CtDB5xZv.jpg",img7b595502="/egu24/assets/7b595502-ea47-451c-a2eb-b8ae000dc38c-CdgnZqW9.jpg",img0b875fbb="/egu24/assets/0b875fbb-aab2-46d4-afb5-f2bf8243ab0a-Ds4MXam_.jpg",imga6e13eca="/egu24/assets/a6e13eca-69cf-4cae-87ba-1a41d3f4aaad-DRjLarHR.jpg",imgd48778ee="/egu24/assets/d48778ee-a7bf-4286-84b3-0a47465fc207-Cieir1Kl.jpg",imgdaa497ed="/egu24/assets/daa497ed-32fe-4a2e-9988-6f90edc1f25f-BoJgNGwb.jpg",img739bdc0b="/egu24/assets/739bdc0b-4ba4-4c80-949e-bf07ceb163ee-ciTBeehG.jpg",imgefbf26dc="/egu24/assets/efbf26dc-2984-4406-b6f9-3aba222a66c5-B9uL0lzi.jpg",img8af31206="/egu24/assets/8af31206-b660-455f-a5db-4bfc5f47f06c-CKSITO_Z.jpg",img968020db="/egu24/assets/968020db-99f6-40ca-a012-0e37a81e40f7-Crp4is6-.jpg",imgc85aa99b="/egu24/assets/c85aa99b-0e7e-4f70-977a-3c7680794163--Ioyqk4t.jpg",img91d677dd="/egu24/assets/91d677dd-e6a6-4ca8-9b4a-89c4ddcb0fa3-B5HRjaqj.jpg",img56dd4540="/egu24/assets/56dd4540-7883-4301-a017-45ac5bac5d92-Br64_Ew0.jpg",imgb6d1e1c1="/egu24/assets/b6d1e1c1-3f34-42a5-bdac-d1e394ebe462-CKUxhHV0.jpg",img962d99b0="/egu24/assets/962d99b0-255f-4ba6-994c-521f62cc2f8e-rOU_fhQe.jpg",imgcb0b9898="/egu24/assets/cb0b9898-f7fc-49bb-8e99-e8111e0e7f98-DsfM0zgs.jpg",img0eaefd63="/egu24/assets/0eaefd63-e4da-43c0-8b15-3c8400f84021-CgZbofWN.jpg",img4d13176e="/egu24/assets/4d13176e-272a-4403-913a-785ee36b387a-C15vlNVK.jpg",img2965b248="/egu24/assets/2965b248-c52d-415b-a1e1-c93c200a195e-BYS-29D3.jpg",img7caaf070="/egu24/assets/7caaf070-680a-47b2-a679-fd315dd39ab9-C8zn8bC8.jpg",img1334158a="/egu24/assets/1334158a-98be-49c2-ae2d-4099b4c4f12b-ChHdRkF7.jpg",img234aba17="/egu24/assets/234aba17-250f-412d-b372-c8877b2e4d93-AfSbGPax.jpg",img62674979="/egu24/assets/62674979-73f7-4e62-acc3-195a1a685b89-DeLLueeC.jpg",img359a050f="/egu24/assets/359a050f-82a0-4159-aeb5-07af06413d39-Do93LNez.jpg",img46687e4b="/egu24/assets/46687e4b-6f65-4236-a42e-e05388a21245-DA2t408g.jpg",imgc8094918="/egu24/assets/c8094918-7c33-4268-bd8e-f9db8ca1186c-DCdGGzKv.jpg",img33164c8d="/egu24/assets/33164c8d-8d53-4704-b7c7-9b3205f52d7e-8aOksHiu.jpg",imge0e52c25="/egu24/assets/e0e52c25-a3ba-451e-b2bf-c2602b9a8558-BLyLDcWi.jpg",img7456682e="/egu24/assets/7456682e-e694-439a-9147-9c51e6c1442d-BV1JBNwY.jpg",img2ec972f1="/egu24/assets/2ec972f1-b00c-4545-9a6f-ef193f019d22-9L5ksuLL.jpg",imge5841584="/egu24/assets/e5841584-b3c2-46ff-ab2c-bf3be04099f7-DW0HNInQ.jpg",imgafbeb567="/egu24/assets/afbeb567-60af-4883-9e08-3d6a3c8e4e23-fIJc9Bog.jpg",img1781e449="/egu24/assets/1781e449-1a2c-4bd0-bcf8-f30b240a64a5-CyAASqp3.jpg",img7278d014="/egu24/assets/7278d014-23b0-46a7-ad3d-ef0593752139-BVk7zWaY.jpg",img53b04bef="/egu24/assets/53b04bef-82e8-491c-8205-d396a1c1b2f7-CMHzjx-q.jpg",imgaa31f1a6="/egu24/assets/aa31f1a6-157f-4835-88e4-b656d4670106-CRpH29qk.jpg",imga58abe66="/egu24/assets/a58abe66-2b57-46d0-a3df-aa6fc2796c49-D5G54F73.jpg",img670c1827="/egu24/assets/670c1827-eb27-4aa9-8ae6-e2a2d06d364d-B5IrO48o.jpg",img53b80ef5="/egu24/assets/53b80ef5-45c9-4865-9490-4081bb527718-BZwHKu09.jpg",img7c47d6ab="/egu24/assets/7c47d6ab-d169-4d5c-826a-b927fd9bdc88-B8n_3WEu.jpg",img33ae48c3="/egu24/assets/33ae48c3-c504-4293-bf59-f149e735a032-DzHCT77v.jpg",img1c6502f8="/egu24/assets/1c6502f8-f6e6-4edc-a10e-11b7e1446fd4-5KyNOJsf.jpg",imgadaadb10="/egu24/assets/adaadb10-0680-40fc-a536-757d53b4783c-Byi43dg5.jpg",img3fb4d462="/egu24/assets/3fb4d462-505b-423f-b233-9fe2fbf2ab7d-BiU1Af2g.jpg",imge81a2f8b="/egu24/assets/e81a2f8b-4b7e-41b3-aeac-da5795221688-CSJnv5wW.jpg",img945a5da9="/egu24/assets/945a5da9-d77b-4883-83d0-aa719fada1a3-CRPbUL7D.jpg",img668dd4b0="/egu24/assets/668dd4b0-2301-4f97-a61c-c1fc072bd467-DzMeFCrT.jpg",img2e0f097d="/egu24/assets/2e0f097d-aacd-4fc4-8877-f702b8038288-CMZyZeDu.jpg",img1bd59cef="/egu24/assets/1bd59cef-8b8c-4597-9fcd-a8f9145452dc-BZZbkjDp.jpg",img0484b83e="/egu24/assets/0484b83e-287d-4795-870f-214a9394e13f-DVoChBtM.jpg",imgfd05667b="/egu24/assets/fd05667b-8d79-427a-b777-8c354ae9d3b5-udZ_OUPv.jpg",img73eb1d12="/egu24/assets/73eb1d12-b4f7-4495-b523-03a30391fa0f-dllqGDky.jpg",img12fc964f="/egu24/assets/12fc964f-f3b5-4ece-b649-638cb8c4e40a-Ddye5ji5.jpg",img77dcba10="/egu24/assets/77dcba10-d9ff-4f1e-9243-a84e4ef6ec1f-B9S-Ggt1.jpg",imgdb692e2b="/egu24/assets/db692e2b-d526-4c66-9121-31fd2c84b2b5-BArZOZ7B.jpg",img5e0f59ac="/egu24/assets/5e0f59ac-0f24-4255-afc3-a8a731adf9bf-DvLMLAv7.jpg",img5e4d704e="/egu24/assets/5e4d704e-f9b0-4f13-9b67-03d20880c93c-1Tvx44Xq.jpg",imgaf7ca033="/egu24/assets/af7ca033-330c-4743-bd33-96a632dc9bcb-DtcATMCZ.jpg",imgcbe13669="/egu24/assets/cbe13669-c709-48ab-9a7b-88c144ffc159-BPiYcZ_3.jpg",img2cd87ee2="/egu24/assets/2cd87ee2-dba0-43d4-8d05-573933dd0dfd-NyuNKWqJ.jpg",img6cd3c7fd="/egu24/assets/6cd3c7fd-2785-429a-a0c0-38933de143ba-BkRJv3RK.jpg",imgbf084015="/egu24/assets/bf084015-1c47-4666-b5cb-8ebf3d5336a6-CdidfGV4.jpg",img95bc7992="/egu24/assets/95bc7992-6a98-4948-9bbe-50255cc6421b-bJFfkFf_.jpg",img264d90d6="/egu24/assets/264d90d6-5386-42a9-a02c-7f74c1f5a158-C9wAAN6n.jpg",img98cab885="/egu24/assets/98cab885-01af-4ed7-b809-43554204ad8e-BdpirE2c.jpg",imgca767251="/egu24/assets/ca767251-3b63-4c11-ba48-06f3c28e641d-xa4EFVAF.jpg",img4dc830d7="/egu24/assets/4dc830d7-ed49-4297-b585-ee040e69987c-DO1922AK.jpg",img8f1a194b="/egu24/assets/8f1a194b-4858-4379-99b8-aee921cb9857-CYIavyP2.jpg",img125dced1="/egu24/assets/125dced1-9367-4f36-9380-cc971a2e6765-npAjQV4B.jpg",img6a64c7fa="/egu24/assets/6a64c7fa-ab8f-4432-8bd5-bb1ffddfd211-C8E6T7c2.jpg",img8b51cf44="/egu24/assets/8b51cf44-9062-4a12-998a-60efd8d4ea63-DiJMF5QD.jpg",imgd9f0d0d0="/egu24/assets/d9f0d0d0-82aa-4bd1-91f5-6db508dab992-D70ZvbOs.jpg",imgacd44583="/egu24/assets/acd44583-6881-4a41-afc0-ebcbebf961f4-C9QoUh_D.jpg",imgd2b938eb="/egu24/assets/918d2d6f-dc5a-4d1b-9dd5-2de96cc56ac6-D536Ezj8.jpg",img918d2d6f="/egu24/assets/918d2d6f-dc5a-4d1b-9dd5-2de96cc56ac6-D536Ezj8.jpg",img1f756bda="/egu24/assets/1f756bda-953a-4051-be5b-a71bc2396d32-RM-ZDtX5.jpg",imgc3ee6e26="/egu24/assets/c3ee6e26-d5a6-428d-94df-6f6434c2ac26-Atuek6xN.jpg",img9948d540="/egu24/assets/9948d540-759c-43af-8564-9cc3eac65542-BuVSgbkf.jpg",imgc6656497="/egu24/assets/c6656497-915d-47e8-a3c1-527dd62e5c66-DlcbY8Xw.jpg",stations=[{id:"PT01072_2887",coords:[27.6461574,85.3402103]},{id:"PT01071_2886",coords:[27.6349734,85.5276167]},{id:"PT00924_2627",coords:[27.6717534,85.3249833]}],donnes=[{id:"63f33000-3c5b-4ae1-a471-ff320fdd8379",station:"PT01072_2887",horo:"2023-05-16T03:27:29.293Z",image:img63f33000},{id:"b61c5c12-80a0-4792-b2dd-863df41e0036",station:"PT01072_2887",horo:"2023-06-28T11:51:23.389Z",image:imgb61c5c12},{id:"b3cc1b86-e461-4799-adf8-5fbc773ef259",station:"PT01072_2887",horo:"2023-05-15T01:38:17.329Z",image:imgb3cc1b86},{id:"0fd998f2-1d93-4977-8dfa-8d5e06c5ac66",station:"PT01072_2887",horo:"2023-05-26T02:03:44.551Z",image:img0fd998f2},{id:"111bb611-4d13-4078-8efe-3dd3ec188023",station:"PT01072_2887",horo:"2023-07-04T08:40:23.464Z",image:img111bb611},{id:"57c27ead-0c8d-430d-bab5-937f4e752655",station:"PT01072_2887",horo:"2023-06-30T01:39:35.89Z",image:img57c27ead},{id:"354d9aec-847d-4aad-8b03-8b873717295f",station:"PT01072_2887",horo:"2023-07-14T07:24:21.685Z",image:img354d9aec},{id:"54e41355-abe3-4d60-aaae-da2855fbdee9",station:"PT01072_2887",horo:"2023-05-27T02:35:10.237Z",image:img54e41355},{id:"3ef4a7d4-b671-4afc-b2b8-edf18985829e",station:"PT01072_2887",horo:"2023-06-24T06:25:13.393Z",image:img3ef4a7d4},{id:"fde62246-d40e-49db-830d-5a42a142d676",station:"PT01072_2887",horo:"2023-07-01T03:07:13.718Z",image:imgfde62246},{id:"7b595502-ea47-451c-a2eb-b8ae000dc38c",station:"PT01072_2887",horo:"2023-07-06T03:48:57.647Z",image:img7b595502},{id:"0b875fbb-aab2-46d4-afb5-f2bf8243ab0a",station:"PT01072_2887",horo:"2023-07-12T02:08:54.191Z",image:img0b875fbb},{id:"a6e13eca-69cf-4cae-87ba-1a41d3f4aaad",station:"PT01072_2887",horo:"2023-07-02T08:07:27.909Z",image:imga6e13eca},{id:"d48778ee-a7bf-4286-84b3-0a47465fc207",station:"PT01072_2887",horo:"2023-07-05T12:51:42.263Z",image:imgd48778ee},{id:"daa497ed-32fe-4a2e-9988-6f90edc1f25f",station:"PT01072_2887",horo:"2023-06-14T02:36:57.735Z",image:imgdaa497ed},{id:"739bdc0b-4ba4-4c80-949e-bf07ceb163ee",station:"PT01072_2887",horo:"2023-06-19T02:02:22.466Z",image:img739bdc0b},{id:"efbf26dc-2984-4406-b6f9-3aba222a66c5",station:"PT01072_2887",horo:"2023-06-13T02:17:46.985Z",image:imgefbf26dc},{id:"8af31206-b660-455f-a5db-4bfc5f47f06c",station:"PT01072_2887",horo:"2023-06-26T03:16:19.77Z",image:img8af31206},{id:"968020db-99f6-40ca-a012-0e37a81e40f7",station:"PT01072_2887",horo:"2023-06-27T08:44:29.492Z",image:img968020db},{id:"c85aa99b-0e7e-4f70-977a-3c7680794163",station:"PT01072_2887",horo:"2023-06-29T01:55:00.796Z",image:imgc85aa99b},{id:"91d677dd-e6a6-4ca8-9b4a-89c4ddcb0fa3",station:"PT01072_2887",horo:"2023-07-03T09:05:04.185Z",image:img91d677dd},{id:"56dd4540-7883-4301-a017-45ac5bac5d92",station:"PT01072_2887",horo:"2023-05-29T12:20:36.323Z",image:img56dd4540},{id:"b6d1e1c1-3f34-42a5-bdac-d1e394ebe462",station:"PT01072_2887",horo:"2023-06-20T01:20:51.542Z",image:imgb6d1e1c1},{id:"962d99b0-255f-4ba6-994c-521f62cc2f8e",station:"PT01072_2887",horo:"2023-07-09T02:40:49.651Z",image:img962d99b0},{id:"cb0b9898-f7fc-49bb-8e99-e8111e0e7f98",station:"PT01072_2887",horo:"2023-07-15T10:24:16.289Z",image:imgcb0b9898},{id:"0eaefd63-e4da-43c0-8b15-3c8400f84021",station:"PT01072_2887",horo:"2023-06-15T14:27:02.02Z",image:img0eaefd63},{id:"4d13176e-272a-4403-913a-785ee36b387a",station:"PT01072_2887",horo:"2023-06-09T02:29:19.744Z",image:img4d13176e},{id:"2965b248-c52d-415b-a1e1-c93c200a195e",station:"PT01071_2886",horo:"2023-06-28T12:38:36.326Z",image:img2965b248},{id:"7caaf070-680a-47b2-a679-fd315dd39ab9",station:"PT01071_2886",horo:"2023-06-19T13:54:33.688Z",image:img7caaf070},{id:"1334158a-98be-49c2-ae2d-4099b4c4f12b",station:"PT01071_2886",horo:"2023-07-03T12:21:10.275Z",image:img1334158a},{id:"234aba17-250f-412d-b372-c8877b2e4d93",station:"PT01071_2886",horo:"2023-07-27T15:26:23.51Z",image:img234aba17},{id:"62674979-73f7-4e62-acc3-195a1a685b89",station:"PT01071_2886",horo:"2023-09-10T10:32:34.087Z",image:img62674979},{id:"359a050f-82a0-4159-aeb5-07af06413d39",station:"PT01071_2886",horo:"2023-07-07T15:41:26.71Z",image:img359a050f},{id:"46687e4b-6f65-4236-a42e-e05388a21245",station:"PT01071_2886",horo:"2023-07-14T12:19:41.437Z",image:img46687e4b},{id:"c8094918-7c33-4268-bd8e-f9db8ca1186c",station:"PT01071_2886",horo:"2023-08-09T11:10:28.908Z",image:imgc8094918},{id:"33164c8d-8d53-4704-b7c7-9b3205f52d7e",station:"PT01071_2886",horo:"2023-08-15T11:03:36.47Z",image:img33164c8d},{id:"e0e52c25-a3ba-451e-b2bf-c2602b9a8558",station:"PT01071_2886",horo:"2023-07-12T12:51:24.658Z",image:imge0e52c25},{id:"7456682e-e694-439a-9147-9c51e6c1442d",station:"PT01071_2886",horo:"2023-08-25T11:57:39.524Z",image:img7456682e},{id:"2ec972f1-b00c-4545-9a6f-ef193f019d22",station:"PT01071_2886",horo:"2023-07-01T12:57:53.984Z",image:img2ec972f1},{id:"e5841584-b3c2-46ff-ab2c-bf3be04099f7",station:"PT01071_2886",horo:"2023-08-26T13:08:20.299Z",image:imge5841584},{id:"afbeb567-60af-4883-9e08-3d6a3c8e4e23",station:"PT01071_2886",horo:"2023-09-08T10:26:42.18Z",image:imgafbeb567},{id:"1781e449-1a2c-4bd0-bcf8-f30b240a64a5",station:"PT01071_2886",horo:"2023-07-23T12:14:36.449Z",image:img1781e449},{id:"7278d014-23b0-46a7-ad3d-ef0593752139",station:"PT01071_2886",horo:"2023-09-12T11:24:21.149Z",image:img7278d014},{id:"53b04bef-82e8-491c-8205-d396a1c1b2f7",station:"PT01071_2886",horo:"2023-07-30T07:21:41.777Z",image:img53b04bef},{id:"aa31f1a6-157f-4835-88e4-b656d4670106",station:"PT01071_2886",horo:"2023-08-23T10:37:56.597Z",image:imgaa31f1a6},{id:"a58abe66-2b57-46d0-a3df-aa6fc2796c49",station:"PT01071_2886",horo:"2023-07-20T10:55:21.896Z",image:imga58abe66},{id:"670c1827-eb27-4aa9-8ae6-e2a2d06d364d",station:"PT01071_2886",horo:"2023-08-02T10:38:08.199Z",image:img670c1827},{id:"53b80ef5-45c9-4865-9490-4081bb527718",station:"PT01071_2886",horo:"2023-06-14T13:21:14.906Z",image:img53b80ef5},{id:"7c47d6ab-d169-4d5c-826a-b927fd9bdc88",station:"PT01071_2886",horo:"2023-06-15T13:39:12.805Z",image:img7c47d6ab},{id:"33ae48c3-c504-4293-bf59-f149e735a032",station:"PT01071_2886",horo:"2023-07-05T12:49:53.05Z",image:img33ae48c3},{id:"1c6502f8-f6e6-4edc-a10e-11b7e1446fd4",station:"PT01071_2886",horo:"2023-07-13T16:05:58.231Z",image:img1c6502f8},{id:"adaadb10-0680-40fc-a536-757d53b4783c",station:"PT01071_2886",horo:"2023-07-17T12:53:52.158Z",image:imgadaadb10},{id:"3fb4d462-505b-423f-b233-9fe2fbf2ab7d",station:"PT01071_2886",horo:"2023-07-24T14:11:41.108Z",image:img3fb4d462},{id:"e81a2f8b-4b7e-41b3-aeac-da5795221688",station:"PT01071_2886",horo:"2023-06-27T14:08:33.12Z",image:imge81a2f8b},{id:"945a5da9-d77b-4883-83d0-aa719fada1a3",station:"PT01071_2886",horo:"2023-07-28T12:34:27.247Z",image:img945a5da9},{id:"668dd4b0-2301-4f97-a61c-c1fc072bd467",station:"PT01071_2886",horo:"2023-09-13T15:01:51.163Z",image:img668dd4b0},{id:"2e0f097d-aacd-4fc4-8877-f702b8038288",station:"PT01071_2886",horo:"2023-09-29T10:16:17.987Z",image:img2e0f097d},{id:"1bd59cef-8b8c-4597-9fcd-a8f9145452dc",station:"PT01071_2886",horo:"2023-06-20T15:45:11.008Z",image:img1bd59cef},{id:"0484b83e-287d-4795-870f-214a9394e13f",station:"PT01071_2886",horo:"2023-07-06T12:45:47.18Z",image:img0484b83e},{id:"fd05667b-8d79-427a-b777-8c354ae9d3b5",station:"PT01071_2886",horo:"2023-06-25T12:48:18.544Z",image:imgfd05667b},{id:"73eb1d12-b4f7-4495-b523-03a30391fa0f",station:"PT01071_2886",horo:"2023-08-07T13:43:21.731Z",image:img73eb1d12},{id:"12fc964f-f3b5-4ece-b649-638cb8c4e40a",station:"PT01071_2886",horo:"2023-07-25T13:07:31.649Z",image:img12fc964f},{id:"77dcba10-d9ff-4f1e-9243-a84e4ef6ec1f",station:"PT01071_2886",horo:"2023-08-01T10:18:52.581Z",image:img77dcba10},{id:"db692e2b-d526-4c66-9121-31fd2c84b2b5",station:"PT01071_2886",horo:"2023-06-24T12:17:19.301Z",image:imgdb692e2b},{id:"5e0f59ac-0f24-4255-afc3-a8a731adf9bf",station:"PT01071_2886",horo:"2023-07-04T12:58:42.573Z",image:img5e0f59ac},{id:"5e4d704e-f9b0-4f13-9b67-03d20880c93c",station:"PT01071_2886",horo:"2023-07-31T10:15:43.933Z",image:img5e4d704e},{id:"af7ca033-330c-4743-bd33-96a632dc9bcb",station:"PT01071_2886",horo:"2023-07-30T10:42:00.44Z",image:imgaf7ca033},{id:"cbe13669-c709-48ab-9a7b-88c144ffc159",station:"PT01071_2886",horo:"2023-08-20T12:28:04.075Z",image:imgcbe13669},{id:"2cd87ee2-dba0-43d4-8d05-573933dd0dfd",station:"PT01071_2886",horo:"2023-08-22T13:04:11.47Z",image:img2cd87ee2},{id:"6cd3c7fd-2785-429a-a0c0-38933de143ba",station:"PT01071_2886",horo:"2023-09-04T10:17:40.182Z",image:img6cd3c7fd},{id:"bf084015-1c47-4666-b5cb-8ebf3d5336a6",station:"PT01071_2886",horo:"2023-08-13T11:03:44.633Z",image:imgbf084015},{id:"95bc7992-6a98-4948-9bbe-50255cc6421b",station:"PT01071_2886",horo:"2023-10-06T10:21:31.823Z",image:img95bc7992},{id:"264d90d6-5386-42a9-a02c-7f74c1f5a158",station:"PT01071_2886",horo:"2023-05-04T10:42:59.801Z",image:img264d90d6},{id:"98cab885-01af-4ed7-b809-43554204ad8e",station:"PT01071_2886",horo:"2023-07-15T13:29:38.714Z",image:img98cab885},{id:"ca767251-3b63-4c11-ba48-06f3c28e641d",station:"PT01071_2886",horo:"2023-08-12T10:27:09.541Z",image:imgca767251},{id:"4dc830d7-ed49-4297-b585-ee040e69987c",station:"PT01071_2886",horo:"2023-08-06T10:30:54.81Z",image:img4dc830d7},{id:"8f1a194b-4858-4379-99b8-aee921cb9857",station:"PT01071_2886",horo:"2023-08-08T10:37:08.398Z",image:img8f1a194b},{id:"125dced1-9367-4f36-9380-cc971a2e6765",station:"PT00924_2627",horo:"2023-06-28T11:46:27.024Z",image:img125dced1},{id:"6a64c7fa-ab8f-4432-8bd5-bb1ffddfd211",station:"PT00924_2627",horo:"2023-08-15T02:45:29.529Z",image:img6a64c7fa},{id:"8b51cf44-9062-4a12-998a-60efd8d4ea63",station:"PT00924_2627",horo:"2023-05-05T03:17:58.429Z",image:img8b51cf44},{id:"d9f0d0d0-82aa-4bd1-91f5-6db508dab992",station:"PT00924_2627",horo:"2023-05-27T06:12:14.237Z",image:imgd9f0d0d0},{id:"acd44583-6881-4a41-afc0-ebcbebf961f4",station:"PT00924_2627",horo:"2023-05-18T05:00:30.683Z",image:imgacd44583},{id:"d2b938eb-d695-4e14-9ee2-dde1cea47e82",station:"PT00924_2627",horo:"2023-06-25T12:18:03.692Z",image:imgd2b938eb},{id:"918d2d6f-dc5a-4d1b-9dd5-2de96cc56ac6",station:"PT00924_2627",horo:"2023-07-02T05:26:45.11Z",image:img918d2d6f},{id:"1f756bda-953a-4051-be5b-a71bc2396d32",station:"PT00924_2627",horo:"2023-06-16T11:53:00.382Z",image:img1f756bda},{id:"c3ee6e26-d5a6-428d-94df-6f6434c2ac26",station:"PT00924_2627",horo:"2023-06-20T06:17:53Z",image:imgc3ee6e26},{id:"9948d540-759c-43af-8564-9cc3eac65542",station:"PT00924_2627",horo:"2023-06-14T08:08:32.894Z",image:img9948d540},{id:"c6656497-915d-47e8-a3c1-527dd62e5c66",station:"PT00924_2627",horo:"2023-05-15T13:10:30.802Z",image:imgc6656497}],constellation$1=()=>{const n=inject$1("constl");if(n)return n;throw new Error("Constellation n'est pas trouvable.")},suivre=(n,r={},_)=>{const E=ref$2(_);let S;const C={...r,f:A=>E.value=A};return onMounted(async()=>{const A=await n(C);A instanceof Function?S=A:S=A?.fOublier}),onUnmounted(async()=>{S&&await S()}),computed(()=>E.value)},utiliserDonnes=()=>{const n=constellation$1(),r=suivre(n.nues.suivreDonnesTableauNue,{idNue:ID_NUE_DONNES,clefTableau:CLEF_TABLEAU}),_=suivre(n.nues.suivreBdsCorrespondantes,{idNue:ID_NUE_DONNES}),E=({idStation:j})=>computed(()=>{if(!r.value)return;const z=S({id:j}),Z=z?.coords[0],X=z?.coords[1],Q=r.value.filter(we=>we.lment.donnes[ID_COL_LAT]===Z&&we.lment.donnes[ID_COL_LONG]===X);return[...new Set(Q.map(we=>we.lment.donnes[ID_COL_HORO]))].map(we=>({date:we,vals:Q.filter(Te=>Te.lment.donnes[ID_COL_HORO]===we).map(Te=>Te.lment.donnes[ID_COL_PRECIP])})).map(we=>({date:we.date,prcip:arrayMedian(we.vals)})).toSorted((we,Te)=>we.date>Te.date?1:-1)}),S=({id:j})=>stations.find(z=>z.id===j),C=async({prcip:j,obs:z})=>{const Z=S({id:z.station});if(!Z)throw new Error(`Station ${z.station} introuvable dans les donnes.`);return await n.bds.ajouterlmentTableauUnique({schmaBd:SCHMA_DONNES,idNueUnique:ID_NUE_DONNES,clefTableau:CLEF_TABLEAU,vals:{[ID_COL_ID]:z.id,[ID_COL_HORO]:z.horo,[ID_COL_LAT]:Z.coords[0],[ID_COL_LONG]:Z.coords[1],[ID_COL_PRECIP]:j}})},A=suivre(n.bds.suivreDonnesDeTableauUnique,{schmaBd:SCHMA_DONNES,idNueUnique:ID_NUE_DONNES,clefTableau:CLEF_TABLEAU});return{toutesPhotos:donnes,numrises:r,utiliserDonnesStation:E,choisirObservationAlatoire:({idStation:j,idPrsente:z}={})=>{const Z=donnes.filter(X=>!A.value?.find(Q=>Q.donnes[ID_COL_ID]===X.id)).filter(X=>!j||X.station===j).filter(X=>X.id!==z);return Z[Math.floor(Math.random()*Z.length)]},contribuer:C,effacer:async j=>await n.bds.effacerlmentDeTableauUnique({schmaBd:SCHMA_DONNES,idNueUnique:ID_NUE_DONNES,clefTableau:CLEF_TABLEAU,idlment:j}),imageDeDonne:j=>donnes.find(z=>z.id===j)?.image,mesContributions:A,exporterDonnes:async()=>{await n.nues.exporterDonnesNue({idNue:ID_NUE_DONNES})},bdsCorresp:_,effacerDonnes:async()=>{const j=A.value;j&&await Promise.all(j.map(z=>n.bds.effacerlmentDeTableauUnique({schmaBd:SCHMA_DONNES,idNueUnique:ID_NUE_DONNES,clefTableau:CLEF_TABLEAU,idlment:z.id})))}}},_sfc_main$7=defineComponent$1({__name:"MarqueurStation",props:{coords:{},idStation:{}},emits:["prendrePhoto"],setup(n,{emit:r}){const _=n,E=r,{_:S}=_(),{utiliserDonnesStation:C,numrises:A,mesContributions:I,bdsCorresp:B}=utiliserDonnes(),O=S(computed(()=>Number.parseFloat(_.coords[0].toFixed(4)))),N=S(computed(()=>Number.parseFloat(_.coords[1].toFixed(4)))),U=C({idStation:_.idStation});return(j,z)=>(openBlock(),createBlock(unref(uo),{"lat-lng":j.coords},{default:withCtx(()=>[createVNode(unref(yo),null,{default:withCtx(()=>[createVNode(VCard,{variant:"flat",width:"250"},{default:withCtx(()=>[createVNode(VCardItem,{class:"px-0"},{default:withCtx(()=>[createVNode(VCardTitle,null,{default:withCtx(()=>[createTextVNode(toDisplayString(j.idStation),1)]),_:1}),createVNode(VCardSubtitle,null,{default:withCtx(()=>[createTextVNode(toDisplayString(`${unref(O)}, ${unref(N)}`),1)]),_:1})]),_:1}),createVNode(VCardText,{class:"px-0 text-center"},{default:withCtx(()=>[createVNode(GraphiqueStation,{hauteur:150,vals:unref(U)},null,8,["vals"]),createVNode(VBtn,{class:"mt-2",variant:"flat",icon:"mdi-camera-outline",size:"small",onClick:z[0]||(z[0]=()=>E("prendrePhoto"))})]),_:1})]),_:1})]),_:1})]),_:1},8,["lat-lng"]))}}),_hoisted_1$2=createBaseVNode("br",null,null,-1),_hoisted_2$2={key:0},_sfc_main$6=defineComponent$1({__name:"EntreDonne",props:{station:{},observation:{},enSoumission:{type:Boolean}},emits:["soumettre","prendrePhoto"],setup(n,{emit:r}){const _=n,E=r,{mdAndUp:S}=useDisplay(),{_:C}=_(),{$:A,:I}=C(),{_:B}=_(),O=B(computed(()=>Number.parseFloat(_.station.coords[0].toFixed(4)||"0"))),N=B(computed(()=>Number.parseFloat(_.station.coords[1].toFixed(4)||"0"))),U=ref$2(""),j=computed(()=>{try{const Q=parseFloat(U.value);if(!isNaN(Q))return!0}catch{return!1}}),z=[Q=>Q===""||j.value?!0:A("dmo.numroInvalid")],Z=()=>{E("soumettre",{prcip:parseFloat(U.value)}),U.value=""},X=()=>{E("prendrePhoto")};return(Q,se)=>(openBlock(),createBlock(VCard,{variant:"flat",class:"pa-2"},{default:withCtx(()=>[createVNode(VCardItem,{class:"px-0 pt-0"},{default:withCtx(()=>[createVNode(VCardTitle,null,{default:withCtx(()=>[createTextVNode(toDisplayString(Q.station.id),1)]),_:1}),createVNode(VCardSubtitle,null,{default:withCtx(()=>[createVNode(VIcon,{icon:"mdi-map-marker-outline",start:""}),createTextVNode(toDisplayString(`${unref(O)}, ${unref(N)}`)+" ",1),_hoisted_1$2,Q.observation?(openBlock(),createElementBlock("span",_hoisted_2$2,[createVNode(VIcon,{icon:"mdi-clock-time-three-outline",start:""}),createTextVNode(" "+toDisplayString(new Date(Q.observation.horo).toLocaleString()),1)])):createCommentVNode("",!0)]),_:1})]),_:1}),createVNode(VCardText,null,{default:withCtx(()=>[unref(S)?createCommentVNode("",!0):(openBlock(),createBlock(VImg,{key:0,class:"pb-6",src:Q.observation?.image},null,8,["src"])),createVNode(VTextField,{modelValue:U.value,"onUpdate:modelValue":se[0]||(se[0]=oe=>U.value=oe),variant:"outlined",label:unref(A)("dmo.indicePrcip"),rules:z,disabled:Q.enSoumission,clearable:""},null,8,["modelValue","label","rules","disabled"]),createVNode(VBtn,{class:"my-2",width:"100%","append-icon":"mdi-check",variant:"outlined",disabled:!U.value,loading:Q.enSoumission,onClick:se[1]||(se[1]=()=>Z())},{default:withCtx(()=>[createTextVNode(toDisplayString(unref(A)("dmo.soumettre")),1)]),_:1},8,["disabled","loading"]),createVNode(VBtn,{class:"my-2",width:"100%","append-icon":"mdi-camera-flip-outline",variant:"outlined",onClick:se[2]||(se[2]=()=>X())},{default:withCtx(()=>[createTextVNode(toDisplayString(unref(A)("dmo.nouvellePhoto")),1)]),_:1})]),_:1})]),_:1}))}}),makeVDialogProps=propsFactory({fullscreen:Boolean,retainFocus:{type:Boolean,default:!0},scrollable:Boolean,...makeVOverlayProps({origin:"center center",scrollStrategy:"block",transition:{component:VDialogTransition},zIndex:2400})},"VDialog"),VDialog=genericComponent()({name:"VDialog",props:makeVDialogProps(),emits:{"update:modelValue":n=>!0},setup(n,r){let{slots:_}=r;const E=useProxiedModel(n,"modelValue"),{scopeId:S}=useScopeId(),C=ref$2();function A(B){const O=B.relatedTarget,N=B.target;if(O!==N&&C.value?.contentEl&&C.value?.globalTop&&![document,C.value.contentEl].includes(N)&&!C.value.contentEl.contains(N)){const U=focusableChildren(C.value.contentEl);if(!U.length)return;const j=U[0],z=U[U.length-1];O===j?z.focus():j.focus()}}IN_BROWSER&&watch(()=>E.value&&n.retainFocus,B=>{B?document.addEventListener("focusin",A):document.removeEventListener("focusin",A)},{immediate:!0}),watch(E,async B=>{await nextTick$3(),B?C.value.contentEl?.focus({preventScroll:!0}):C.value.activatorEl?.focus({preventScroll:!0})});const I=computed(()=>mergeProps({"aria-haspopup":"dialog","aria-expanded":String(E.value)},n.activatorProps));return useRender(()=>{const B=VOverlay.filterProps(n);return createVNode(VOverlay,mergeProps({ref:C,class:["v-dialog",{"v-dialog--fullscreen":n.fullscreen,"v-dialog--scrollable":n.scrollable},n.class],style:n.style},B,{modelValue:E.value,"onUpdate:modelValue":O=>E.value=O,"aria-modal":"true",activatorProps:I.value,role:"dialog"},S),{activator:_.activator,default:function(){for(var O=arguments.length,N=new Array(O),U=0;U<O;U++)N[U]=arguments[U];return createVNode(VDefaultsProvider,{root:"VDialog"},{default:()=>[_.default?.(...N)]})}})}),forwardRefs({},C)}}),_sfc_main$5=defineComponent$1({__name:"CarteConnexions",setup(n){const r=ref$2(!1),_=constellation$1(),E=suivre(_.rseau.suivreConnexionsPostesSFIP);return(S,C)=>(openBlock(),createBlock(VDialog,{modelValue:r.value,"onUpdate:modelValue":C[0]||(C[0]=A=>r.value=A)},{activator:withCtx(({props:A})=>[renderSlot(S.$slots,"activator",normalizeProps(guardReactiveProps({props:A})))]),default:withCtx(()=>[createVNode(VCard,{class:"mx-auto"},{default:withCtx(()=>[createVNode(VCardItem,null,{default:withCtx(()=>[createVNode(VCardTitle,null,{default:withCtx(()=>[createTextVNode(" Connexions ")]),_:1})]),_:1}),createVNode(VCardText,null,{default:withCtx(()=>[createVNode(VList,null,{default:withCtx(()=>[(openBlock(!0),createElementBlock(Fragment,null,renderList(unref(E),A=>(openBlock(),createBlock(VListItem,{title:A.pair,subtitle:A.adresses[0]},null,8,["title","subtitle"]))),256))]),_:1})]),_:1})]),_:1})]),_:3},8,["modelValue"]))}}),VSelectionControlGroupSymbol=Symbol.for("vuetify:selection-control-group"),makeSelectionControlGroupProps=propsFactory({color:String,disabled:{type:Boolean,default:null},defaultsTarget:String,error:Boolean,id:String,inline:Boolean,falseIcon:IconValue,trueIcon:IconValue,ripple:{type:Boolean,default:!0},multiple:{type:Boolean,default:null},name:String,readonly:{type:Boolean,default:null},modelValue:null,type:String,valueComparator:{type:Function,default:deepEqual$2},...makeComponentProps(),...makeDensityProps(),...makeThemeProps()},"SelectionControlGroup"),makeVSelectionControlGroupProps=propsFactory({...makeSelectionControlGroupProps({defaultsTarget:"VSelectionControl"})},"VSelectionControlGroup");genericComponent()({name:"VSelectionControlGroup",props:makeVSelectionControlGroupProps(),emits:{"update:modelValue":n=>!0},setup(n,r){let{slots:_}=r;const E=useProxiedModel(n,"modelValue"),S=getUid(),C=computed(()=>n.id||`v-selection-control-group-${S}`),A=computed(()=>n.name||C.value),I=new Set;return provide(VSelectionControlGroupSymbol,{modelValue:E,forceUpdate:()=>{I.forEach(B=>B())},onForceUpdate:B=>{I.add(B),onScopeDispose(()=>{I.delete(B)})}}),provideDefaults({[n.defaultsTarget]:{color:toRef(n,"color"),disabled:toRef(n,"disabled"),density:toRef(n,"density"),error:toRef(n,"error"),inline:toRef(n,"inline"),modelValue:E,multiple:computed(()=>!!n.multiple||n.multiple==null&&Array.isArray(E.value)),name:A,falseIcon:toRef(n,"falseIcon"),trueIcon:toRef(n,"trueIcon"),readonly:toRef(n,"readonly"),ripple:toRef(n,"ripple"),type:toRef(n,"type"),valueComparator:toRef(n,"valueComparator")}}),useRender(()=>createVNode("div",{class:["v-selection-control-group",{"v-selection-control-group--inline":n.inline},n.class],style:n.style,role:n.type==="radio"?"radiogroup":void 0},[_.default?.()])),{}}});const makeVSelectionControlProps=propsFactory({label:String,baseColor:String,trueValue:null,falseValue:null,value:null,...makeComponentProps(),...makeSelectionControlGroupProps()},"VSelectionControl");function useSelectionControl(n){const r=inject$1(VSelectionControlGroupSymbol,void 0),{densityClasses:_}=useDensity(n),E=useProxiedModel(n,"modelValue"),S=computed(()=>n.trueValue!==void 0?n.trueValue:n.value!==void 0?n.value:!0),C=computed(()=>n.falseValue!==void 0?n.falseValue:!1),A=computed(()=>!!n.multiple||n.multiple==null&&Array.isArray(E.value)),I=computed({get(){const z=r?r.modelValue.value:E.value;return A.value?wrapInArray(z).some(Z=>n.valueComparator(Z,S.value)):n.valueComparator(z,S.value)},set(z){if(n.readonly)return;const Z=z?S.value:C.value;let X=Z;A.value&&(X=z?[...wrapInArray(E.value),Z]:wrapInArray(E.value).filter(Q=>!n.valueComparator(Q,S.value))),r?r.modelValue.value=X:E.value=X}}),{textColorClasses:B,textColorStyles:O}=useTextColor(computed(()=>{if(!(n.error||n.disabled))return I.value?n.color:n.baseColor})),{backgroundColorClasses:N,backgroundColorStyles:U}=useBackgroundColor(computed(()=>I.value&&!n.error&&!n.disabled?n.color:void 0)),j=computed(()=>I.value?n.trueIcon:n.falseIcon);return{group:r,densityClasses:_,trueValue:S,falseValue:C,model:I,textColorClasses:B,textColorStyles:O,backgroundColorClasses:N,backgroundColorStyles:U,icon:j}}const VSelectionControl=genericComponent()({name:"VSelectionControl",directives:{Ripple},inheritAttrs:!1,props:makeVSelectionControlProps(),emits:{"update:modelValue":n=>!0},setup(n,r){let{attrs:_,slots:E}=r;const{group:S,densityClasses:C,icon:A,model:I,textColorClasses:B,textColorStyles:O,backgroundColorClasses:N,backgroundColorStyles:U,trueValue:j}=useSelectionControl(n),z=getUid(),Z=shallowRef(!1),X=shallowRef(!1),Q=ref$2(),se=computed(()=>n.id||`input-${z}`),oe=computed(()=>!n.disabled&&!n.readonly);S?.onForceUpdate(()=>{Q.value&&(Q.value.checked=I.value)});function ue(Re){oe.value&&(Z.value=!0,matchesSelector(Re.target,":focus-visible")!==!1&&(X.value=!0))}function we(){Z.value=!1,X.value=!1}function Te(Re){Re.stopPropagation()}function xe(Re){oe.value&&(n.readonly&&S&&nextTick$3(()=>S.forceUpdate()),I.value=Re.target.checked)}return useRender(()=>{const Re=E.label?E.label({label:n.label,props:{for:se.value}}):n.label,[Ne,Fe]=filterInputAttrs(_),ht=createVNode("input",mergeProps({ref:Q,checked:I.value,disabled:!!n.disabled,id:se.value,onBlur:we,onFocus:ue,onInput:xe,"aria-disabled":!!n.disabled,type:n.type,value:j.value,name:n.name,"aria-checked":n.type==="checkbox"?I.value:void 0},Fe),null);return createVNode("div",mergeProps({class:["v-selection-control",{"v-selection-control--dirty":I.value,"v-selection-control--disabled":n.disabled,"v-selection-control--error":n.error,"v-selection-control--focused":Z.value,"v-selection-control--focus-visible":X.value,"v-selection-control--inline":n.inline},C.value,n.class]},Ne,{style:n.style}),[createVNode("div",{class:["v-selection-control__wrapper",B.value],style:O.value},[E.default?.({backgroundColorClasses:N,backgroundColorStyles:U}),withDirectives(createVNode("div",{class:["v-selection-control__input"]},[E.input?.({model:I,textColorClasses:B,textColorStyles:O,backgroundColorClasses:N,backgroundColorStyles:U,inputNode:ht,icon:A.value,props:{onFocus:ue,onBlur:we,id:se.value}})??createVNode(Fragment,null,[A.value&&createVNode(VIcon,{key:"icon",icon:A.value},null),ht])]),[[resolveDirective("ripple"),n.ripple&&[!n.disabled&&!n.readonly,null,["center","circle"]]]])]),Re&&createVNode(VLabel,{for:se.value,onClick:Te},{default:()=>[Re]})])}),{isFocused:Z,input:Q}}}),makeVSwitchProps=propsFactory({indeterminate:Boolean,inset:Boolean,flat:Boolean,loading:{type:[Boolean,String],default:!1},...makeVInputProps(),...makeVSelectionControlProps()},"VSwitch"),VSwitch=genericComponent()({name:"VSwitch",inheritAttrs:!1,props:makeVSwitchProps(),emits:{"update:focused":n=>!0,"update:modelValue":n=>!0,"update:indeterminate":n=>!0},setup(n,r){let{attrs:_,slots:E}=r;const S=useProxiedModel(n,"indeterminate"),C=useProxiedModel(n,"modelValue"),{loaderClasses:A}=useLoader(n),{isFocused:I,focus:B,blur:O}=useFocus(n),N=ref$2(),U=computed(()=>typeof n.loading=="string"&&n.loading!==""?n.loading:n.color),j=getUid(),z=computed(()=>n.id||`switch-${j}`);function Z(){S.value&&(S.value=!1)}function X(Q){Q.stopPropagation(),Q.preventDefault(),N.value?.input?.click()}return useRender(()=>{const[Q,se]=filterInputAttrs(_),oe=VInput.filterProps(n),ue=VSelectionControl.filterProps(n);return createVNode(VInput,mergeProps({class:["v-switch",{"v-switch--flat":n.flat},{"v-switch--inset":n.inset},{"v-switch--indeterminate":S.value},A.value,n.class]},Q,oe,{modelValue:C.value,"onUpdate:modelValue":we=>C.value=we,id:z.value,focused:I.value,style:n.style}),{...E,default:we=>{let{id:Te,messagesId:xe,isDisabled:Re,isReadonly:Ne,isValid:Fe}=we;const ht={model:C,isValid:Fe};return createVNode(VSelectionControl,mergeProps({ref:N},ue,{modelValue:C.value,"onUpdate:modelValue":[nt=>C.value=nt,Z],id:Te.value,"aria-describedby":xe.value,type:"checkbox","aria-checked":S.value?"mixed":void 0,disabled:Re.value,readonly:Ne.value,onFocus:B,onBlur:O},se),{...E,default:nt=>{let{backgroundColorClasses:Ee,backgroundColorStyles:Ce}=nt;return createVNode("div",{class:["v-switch__track",...Ee.value],style:Ce.value,onClick:X},[E["track-true"]&&createVNode("div",{key:"prepend",class:"v-switch__track-true"},[E["track-true"](ht)]),E["track-false"]&&createVNode("div",{key:"append",class:"v-switch__track-false"},[E["track-false"](ht)])])},input:nt=>{let{inputNode:Ee,icon:Ce,backgroundColorClasses:_e,backgroundColorStyles:Ie}=nt;return createVNode(Fragment,null,[Ee,createVNode("div",{class:["v-switch__thumb",{"v-switch__thumb--filled":Ce||n.loading},n.inset?void 0:_e.value],style:n.inset?void 0:Ie.value},[E.thumb?createVNode(VDefaultsProvider,{defaults:{VIcon:{icon:Ce,size:"x-small"}}},{default:()=>[E.thumb({...ht,icon:Ce})]}):createVNode(VScaleTransition,null,{default:()=>[n.loading?createVNode(LoaderSlot,{name:"v-switch",active:!0,color:Fe.value===!1?void 0:U.value},{default:He=>E.loader?E.loader(He):createVNode(VProgressCircular,{active:He.isActive,color:He.color,indeterminate:!0,size:"16",width:"2"},null)}):Ce&&createVNode(VIcon,{key:String(Ce),icon:Ce,size:"x-small"},null)]})])])}})}})}),{}}}),_hoisted_1$1={class:"text-h3"},_hoisted_2$1={class:"text-h5 d-flex"},_hoisted_3={key:1,class:"mx-auto my-auto text-h5 text-center text-disabled"},_hoisted_4=createBaseVNode("br",null,null,-1),_sfc_main$4=defineComponent$1({__name:"SectionDmo",props:{nEtapes:{},etape:{}},emits:["retour","avancer"],setup(n,{emit:r}){const _=r,{mdAndUp:E}=useDisplay(),{_:S}=_(),{$:C}=S(),{choisirObservationAlatoire:A,exporterDonnes:I,contribuer:B,effacerDonnes:O}=utiliserDonnes(),N=ref$2(!1),U=computed(()=>stations.find(Te=>Te.id===X.value?.station)),j=ref$2(!1),z=async()=>{j.value=!0,await I(),j.value=!1},Z=ref$2(!1),X=ref$2();watchEffect(()=>{Z.value=!!X.value});const Q=ref$2(!1);let se;const oe=async({idStation:Te}={})=>{se=Te;const xe=A({idStation:Te,idPrsente:X.value?.id});X.value=xe,xe||(Q.value=!0)},ue=ref$2(!1),we=async Te=>{if(!X.value)throw new Error("Observation non slectionne");ue.value=!0,await B({prcip:Te,obs:X.value}),E.value?oe({idStation:se}):X.value=void 0,ue.value=!1};return(Te,xe)=>(openBlock(),createBlock(_sfc_main$f,{"n-etapes":Te.nEtapes,etape:Te.etape,onRetour:xe[13]||(xe[13]=()=>_("retour")),onAvancer:xe[14]||(xe[14]=()=>_("avancer"))},{default:withCtx(()=>[createVNode(VCol,{cols:12},{default:withCtx(()=>[createVNode(VCard,{class:"px-6",variant:"flat"},{default:withCtx(()=>[createBaseVNode("div",_hoisted_1$1,toDisplayString(unref(C)("dmo.titre")),1),unref(E)?createCommentVNode("",!0):(openBlock(),createBlock(VMenu,{key:0},{activator:withCtx(({props:Re})=>[createVNode(VBtn,mergeProps(Re,{icon:"mdi-cog",variant:"flat"}),null,16)]),default:withCtx(()=>[createVNode(VList,null,{default:withCtx(()=>[unref(E)?createCommentVNode("",!0):(openBlock(),createBlock(VListItem,{key:0,"prepend-icon":"mdi-download",title:unref(C)("dmo.indiceTlcharger"),onClick:xe[0]||(xe[0]=()=>z())},null,8,["title"])),createVNode(VListItem,{class:"text-error",title:unref(C)("dmo.effacerDonnes"),onClick:xe[1]||(xe[1]=()=>unref(O)())},{prepend:withCtx(()=>[createVNode(VIcon,{icon:"mdi-delete"})]),_:1},8,["title"]),createVNode(_sfc_main$5,null,{activator:withCtx(({props:Re})=>[createVNode(VListItem,mergeProps(Re,{title:unref(C)("Networking"),"prepend-icon":"mdi-lan"}),null,16,["title"])]),_:1})]),_:1})]),_:1}))]),_:1}),createVNode(VDivider,{class:"my-4"})]),_:1}),unref(E)?(openBlock(),createBlock(VCol,{key:0,cols:unref(E)?6:12},{default:withCtx(()=>[createVNode(VCard,{class:"px-6",variant:"flat",height:"65vh",style:{"overflow-y":"scroll"}},{default:withCtx(()=>[createBaseVNode("div",_hoisted_2$1,[createTextVNode(toDisplayString(unref(C)("dmo.sousTitre"))+" ",1),createVNode(VSpacer),unref(E)?(openBlock(),createBlock(VBtn,{key:0,icon:"mdi-download",variant:"flat",loading:j.value,onClick:xe[2]||(xe[2]=()=>z())},null,8,["loading"])):createCommentVNode("",!0),createCommentVNode("",!0),createVNode(VMenu,null,{activator:withCtx(({props:Re})=>[createVNode(VBtn,mergeProps(Re,{icon:"mdi-cog",variant:"flat"}),null,16)]),default:withCtx(()=>[createVNode(VList,null,{default:withCtx(()=>[unref(E)?createCommentVNode("",!0):(openBlock(),createBlock(VListItem,{key:0,"prepend-icon":"mdi-download",title:unref(C)("dmo.indiceTlcharger"),onClick:xe[4]||(xe[4]=()=>z())},null,8,["title"])),createVNode(_sfc_main$5,null,{activator:withCtx(({props:Re})=>[createVNode(VListItem,mergeProps(Re,{title:unref(C)("Networking"),"prepend-icon":"mdi-lan"}),null,16,["title"])]),_:1}),createVNode(VListItem,{class:"text-error",title:unref(C)("dmo.effacerDonnes"),onClick:xe[5]||(xe[5]=()=>unref(O)())},{prepend:withCtx(()=>[createVNode(VIcon,{icon:"mdi-delete"})]),_:1},8,["title"])]),_:1})]),_:1})]),createVNode(VCardText,{class:"px-0"},{default:withCtx(()=>[U.value?(openBlock(),createBlock(VRow,{key:0},{default:withCtx(()=>[createVNode(VCol,{cols:8},{default:withCtx(()=>[createVNode(VImg,{src:X.value?.image},null,8,["src"])]),_:1}),createVNode(VCol,{cols:4},{default:withCtx(()=>[createVNode(_sfc_main$6,{station:U.value,observation:X.value,"en-soumission":ue.value,onSoumettre:xe[6]||(xe[6]=Re=>we(Re.prcip)),onPrendrePhoto:xe[7]||(xe[7]=()=>oe())},null,8,["station","observation","en-soumission"])]),_:1})]),_:1})):(openBlock(),createElementBlock("div",_hoisted_3,[createTextVNode(toDisplayString(unref(C)(Q.value?"dmo.plusDePhotos":"dmo.choisirStation"))+" ",1),_hoisted_4,createVNode(VBtn,{icon:"mdi-camera-outline",variant:"flat",onClick:xe[8]||(xe[8]=()=>oe())})]))]),_:1})]),_:1})]),_:1},8,["cols"])):(openBlock(),createBlock(VDialog,{key:1,modelValue:Z.value,"onUpdate:modelValue":xe[11]||(xe[11]=Re=>Z.value=Re)},{default:withCtx(()=>[createVNode(_sfc_main$6,{station:U.value,observation:X.value,"en-soumission":ue.value,onSoumettre:xe[9]||(xe[9]=Re=>we(Re.prcip)),onPrendrePhoto:xe[10]||(xe[10]=()=>oe())},null,8,["station","observation","en-soumission"])]),_:1},8,["modelValue"])),createVNode(VCol,{cols:unref(E)?6:12},{default:withCtx(()=>[createBaseVNode("div",{class:"mx-auto",style:normalizeStyle({height:unref(E)?"65vh":"60vh",width:unref(E)?"50vw":"100vw"})},[createVNode(unref(io),{ref:"map",zoom:10,center:[27.6461574,85.3402103],useGlobalLeaflet:!1},{default:withCtx(()=>[createVNode(unref(vo),{url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png","layer-type":"base",name:"OpenStreetMap"}),(openBlock(!0),createElementBlock(Fragment,null,renderList(unref(stations),Re=>(openBlock(),createBlock(_sfc_main$7,{key:Re.id,coords:Re.coords,"id-station":Re.id,onPrendrePhoto:()=>oe({idStation:Re.id})},null,8,["coords","id-station","onPrendrePhoto"]))),128))]),_:1},512)],4)]),_:1},8,["cols"]),createVNode(VCol,{cols:12,class:"my-0 py-0"},{default:withCtx(()=>[createBaseVNode("div",{class:"px-6 text-disabled",onClick:xe[12]||(xe[12]=()=>unref(ouvrirLien)("https://data.smartphones4water.org/"))},[createTextVNode(toDisplayString(unref(C)("dmo.source"))+" ",1),createVNode(VIcon,{class:"mx-2",size:"small",icon:"mdi-open-in-new"}),createTextVNode(" "+toDisplayString(unref(C)("dmo.merci"))+" ",1),createVNode(VIcon,{class:"mx-2",icon:"mdi-emoticon-happy-outline",size:"small"})])]),_:1})]),_:1},8,["n-etapes","etape"]))}}),_hoisted_1={class:"d-flex justify-center flex-wrap mb-6"},_hoisted_2=createBaseVNode("br",null,null,-1),lienPython="https://github.com/reseau-constellation/egu24-python",lienR="https://github.com/reseau-constellation/egu24-r",lienJulia="https://github.com/reseau-constellation/egu24-julia",_sfc_main$3=defineComponent$1({__name:"SectionCode",props:{nEtapes:{},etape:{}},emits:["retour","avancer"],setup(n,{emit:r}){const _=r,{mdAndUp:E}=useDisplay(),{_:S}=_(),{$:C}=S({}),A=constellation$1(),I=suivre(A.bds.rechercherBdsParNue,{idNue:ID_NUE_DONNES}),B=computed(()=>I.value?`https://appli.rseau-constellation.ca/#/donnes/bd/${encodeURIComponent(I.value[0])}`:void 0);return(O,N)=>(openBlock(),createBlock(_sfc_main$f,{"n-etapes":O.nEtapes,etape:O.etape,onRetour:N[1]||(N[1]=()=>_("retour")),onAvancer:N[2]||(N[2]=()=>_("avancer"))},{default:withCtx(()=>[createVNode(VCol,{class:normalizeClass([unref(E)?"text-h2":"text-h3","text-center"]),cols:12},{default:withCtx(()=>[createTextVNode(toDisplayString(unref(C)("code.titre")),1)]),_:1},8,["class"]),createVNode(VCol,{cols:12},{default:withCtx(()=>[createBaseVNode("div",_hoisted_1,[B.value?(openBlock(),createBlock(_sfc_main$b,{key:0,titre:unref(C)("code.options.appli"),icne:"mdi-link",lien:B.value,emphase:""},null,8,["titre","lien"])):createCommentVNode("",!0),createCommentVNode("",!0),createCommentVNode("",!0),createCommentVNode("",!0)])]),_:1}),createVNode(VCol,{cols:12,class:"text-center text-h6"},{default:withCtx(()=>[createTextVNode(toDisplayString(unref(C)("code.conclusion"))+" ",1),_hoisted_2,createVNode(VIcon,{icon:"mdi-email-outline",start:"",onClick:N[0]||(N[0]=()=>unref(ouvrirLien)(`mailto://${unref(COURRIEL_CONTACT)}`))}),createTextVNode(" "+toDisplayString(unref(COURRIEL_CONTACT)),1)]),_:1})]),_:1},8,["n-etapes","etape"]))}}),ntapes=5,_sfc_main$2=defineComponent$1({__name:"PagePrincipale",setup(n){const r=ref$2(0),_=ref$2();return onMounted(async()=>{_.value=await obtLienTlchargement()}),(E,S)=>(openBlock(),createBlock(VWindow,{modelValue:r.value,"onUpdate:modelValue":S[10]||(S[10]=C=>r.value=C),direction:"vertical",style:{height:"100%"},disabled:""},{default:withCtx(()=>[createVNode(_sfc_main$c,{"n-etapes":ntapes,etape:0,onRetour:S[0]||(S[0]=C=>r.value--),onAvancer:S[1]||(S[1]=C=>r.value++)},null,8,["n-etapes"]),createVNode(_sfc_main$a,{"n-etapes":ntapes,etape:1,onRetour:S[2]||(S[2]=C=>r.value--),onAvancer:S[3]||(S[3]=C=>r.value++)},null,8,["n-etapes"]),createVNode(_sfc_main$9,{"n-etapes":ntapes,etape:2,onRetour:S[4]||(S[4]=C=>r.value--),onAvancer:S[5]||(S[5]=C=>r.value++)},null,8,["n-etapes"]),createVNode(_sfc_main$4,{"n-etapes":ntapes,etape:3,onRetour:S[6]||(S[6]=C=>r.value--),onAvancer:S[7]||(S[7]=C=>r.value++)},null,8,["n-etapes"]),createVNode(_sfc_main$3,{"n-etapes":ntapes,etape:4,onRetour:S[8]||(S[8]=C=>r.value--),onAvancer:S[9]||(S[9]=C=>r.value++)},null,8,["n-etapes"])]),_:1},8,["modelValue"]))}}),routes=[{path:"/",component:_sfc_main$2}],routeur=createRouter({history:createWebHashHistory(),routes});routeur.afterEach(n=>{const{lg:r}=n.query;if(r&&typeof r=="string"){const{_:_}=_();_(r)}});var eventemitter3={exports:{}};(function(n){var r=Object.prototype.hasOwnProperty,_="~";function E(){}Object.create&&(E.prototype=Object.create(null),new E().__proto__||(_=!1));function S(B,O,N){this.fn=B,this.context=O,this.once=N||!1}function C(B,O,N,U,j){if(typeof N!="function")throw new TypeError("The listener must be a function");var z=new S(N,U||B,j),Z=_?_+O:O;return B._events[Z]?B._events[Z].fn?B._events[Z]=[B._events[Z],z]:B._events[Z].push(z):(B._events[Z]=z,B._eventsCount++),B}function A(B,O){--B._eventsCount===0?B._events=new E:delete B._events[O]}function I(){this._events=new E,this._eventsCount=0}I.prototype.eventNames=function(){var O=[],N,U;if(this._eventsCount===0)return O;for(U in N=this._events)r.call(N,U)&&O.push(_?U.slice(1):U);return Object.getOwnPropertySymbols?O.concat(Object.getOwnPropertySymbols(N)):O},I.prototype.listeners=function(O){var N=_?_+O:O,U=this._events[N];if(!U)return[];if(U.fn)return[U.fn];for(var j=0,z=U.length,Z=new Array(z);j<z;j++)Z[j]=U[j].fn;return Z},I.prototype.listenerCount=function(O){var N=_?_+O:O,U=this._events[N];return U?U.fn?1:U.length:0},I.prototype.emit=function(O,N,U,j,z,Z){var X=_?_+O:O;if(!this._events[X])return!1;var Q=this._events[X],se=arguments.length,oe,ue;if(Q.fn){switch(Q.once&&this.removeListener(O,Q.fn,void 0,!0),se){case 1:return Q.fn.call(Q.context),!0;case 2:return Q.fn.call(Q.context,N),!0;case 3:return Q.fn.call(Q.context,N,U),!0;case 4:return Q.fn.call(Q.context,N,U,j),!0;case 5:return Q.fn.call(Q.context,N,U,j,z),!0;case 6:return Q.fn.call(Q.context,N,U,j,z,Z),!0}for(ue=1,oe=new Array(se-1);ue<se;ue++)oe[ue-1]=arguments[ue];Q.fn.apply(Q.context,oe)}else{var we=Q.length,Te;for(ue=0;ue<we;ue++)switch(Q[ue].once&&this.removeListener(O,Q[ue].fn,void 0,!0),se){case 1:Q[ue].fn.call(Q[ue].context);break;case 2:Q[ue].fn.call(Q[ue].context,N);break;case 3:Q[ue].fn.call(Q[ue].context,N,U);break;case 4:Q[ue].fn.call(Q[ue].context,N,U,j);break;default:if(!oe)for(Te=1,oe=new Array(se-1);Te<se;Te++)oe[Te-1]=arguments[Te];Q[ue].fn.apply(Q[ue].context,oe)}}return!0},I.prototype.on=function(O,N,U){return C(this,O,N,U,!1)},I.prototype.once=function(O,N,U){return C(this,O,N,U,!0)},I.prototype.removeListener=function(O,N,U,j){var z=_?_+O:O;if(!this._events[z])return this;if(!N)return A(this,z),this;var Z=this._events[z];if(Z.fn)Z.fn===N&&(!j||Z.once)&&(!U||Z.context===U)&&A(this,z);else{for(var X=0,Q=[],se=Z.length;X<se;X++)(Z[X].fn!==N||j&&!Z[X].once||U&&Z[X].context!==U)&&Q.push(Z[X]);Q.length?this._events[z]=Q.length===1?Q[0]:Q:A(this,z)}return this},I.prototype.removeAllListeners=function(O){var N;return O?(N=_?_+O:O,this._events[N]&&A(this,N)):(this._events=new E,this._eventsCount=0),this},I.prototype.off=I.prototype.removeListener,I.prototype.addListener=I.prototype.on,I.prefixed=_,I.EventEmitter=I,n.exports=I})(eventemitter3);var eventemitter3Exports=eventemitter3.exports;const EventEmitter$1=getDefaultExportFromCjs(eventemitter3Exports);let TimeoutError$1=class extends Error{constructor(r){super(r),this.name="TimeoutError"}},AbortError$7=class extends Error{constructor(r){super(),this.name="AbortError",this.message=r}};const getDOMException$1=n=>globalThis.DOMException===void 0?new AbortError$7(n):new DOMException(n),getAbortedReason$1=n=>{const r=n.reason===void 0?getDOMException$1("This operation was aborted."):n.reason;return r instanceof Error?r:getDOMException$1(r)};function pTimeout$1(n,r){const{milliseconds:_,fallback:E,message:S,customTimers:C={setTimeout,clearTimeout}}=r;let A;const B=new Promise((O,N)=>{if(typeof _!="number"||Math.sign(_)!==1)throw new TypeError(`Expected \`milliseconds\` to be a positive number, got \`${_}\``);if(r.signal){const{signal:j}=r;j.aborted&&N(getAbortedReason$1(j)),j.addEventListener("abort",()=>{N(getAbortedReason$1(j))})}if(_===Number.POSITIVE_INFINITY){n.then(O,N);return}const U=new TimeoutError$1;A=C.setTimeout.call(void 0,()=>{if(E){try{O(E())}catch(j){N(j)}return}typeof n.cancel=="function"&&n.cancel(),S===!1?O():S instanceof Error?N(S):(U.message=S??`Promise timed out after ${_} milliseconds`,N(U))},_),(async()=>{try{O(await n)}catch(j){N(j)}})()}).finally(()=>{B.clear()});return B.clear=()=>{C.clearTimeout.call(void 0,A),A=void 0},B}function lowerBound$2(n,r,_){let E=0,S=n.length;for(;S>0;){const C=Math.trunc(S/2);let A=E+C;_(n[A],r)<=0?(E=++A,S-=C+1):S=C}return E}let PriorityQueue$1=class{#e=[];enqueue(r,_){_={priority:0,..._};const E={priority:_.priority,run:r};if(this.size&&this.#e[this.size-1].priority>=_.priority){this.#e.push(E);return}const S=lowerBound$2(this.#e,E,(C,A)=>A.priority-C.priority);this.#e.splice(S,0,E)}dequeue(){return this.#e.shift()?.run}filter(r){return this.#e.filter(_=>_.priority===r.priority).map(_=>_.run)}get size(){return this.#e.length}},PQueue$1=class extends EventEmitter$1{#e;#t;#r=0;#a;#c;#p=0;#i;#l;#n;#m;#s=0;#u;#o;#g;timeout;constructor(r){if(super(),r={carryoverConcurrencyCount:!1,intervalCap:Number.POSITIVE_INFINITY,interval:0,concurrency:Number.POSITIVE_INFINITY,autoStart:!0,queueClass:PriorityQueue$1,...r},!(typeof r.intervalCap=="number"&&r.intervalCap>=1))throw new TypeError(`Expected \`intervalCap\` to be a number from 1 and up, got \`${r.intervalCap?.toString()??""}\` (${typeof r.intervalCap})`);if(r.interval===void 0||!(Number.isFinite(r.interval)&&r.interval>=0))throw new TypeError(`Expected \`interval\` to be a finite number >= 0, got \`${r.interval?.toString()??""}\` (${typeof r.interval})`);this.#e=r.carryoverConcurrencyCount,this.#t=r.intervalCap===Number.POSITIVE_INFINITY||r.interval===0,this.#a=r.intervalCap,this.#c=r.interval,this.#n=new r.queueClass,this.#m=r.queueClass,this.concurrency=r.concurrency,this.timeout=r.timeout,this.#g=r.throwOnTimeout===!0,this.#o=r.autoStart===!1}get#b(){return this.#t||this.#r<this.#a}get#_(){return this.#s<this.#u}#w(){this.#s--,this.#f(),this.emit("next")}#E(){this.#v(),this.#y(),this.#l=void 0}get#S(){const r=Date.now();if(this.#i===void 0){const _=this.#p-r;if(_<0)this.#r=this.#e?this.#s:0;else return this.#l===void 0&&(this.#l=setTimeout(()=>{this.#E()},_)),!0}return!1}#f(){if(this.#n.size===0)return this.#i&&clearInterval(this.#i),this.#i=void 0,this.emit("empty"),this.#s===0&&this.emit("idle"),!1;if(!this.#o){const r=!this.#S;if(this.#b&&this.#_){const _=this.#n.dequeue();return _?(this.emit("active"),_(),r&&this.#y(),!0):!1}}return!1}#y(){this.#t||this.#i!==void 0||(this.#i=setInterval(()=>{this.#v()},this.#c),this.#p=Date.now()+this.#c)}#v(){this.#r===0&&this.#s===0&&this.#i&&(clearInterval(this.#i),this.#i=void 0),this.#r=this.#e?this.#s:0,this.#d()}#d(){for(;this.#f(););}get concurrency(){return this.#u}set concurrency(r){if(!(typeof r=="number"&&r>=1))throw new TypeError(`Expected \`concurrency\` to be a number from 1 and up, got \`${r}\` (${typeof r})`);this.#u=r,this.#d()}async#x(r){return new Promise((_,E)=>{r.addEventListener("abort",()=>{E(r.reason)},{once:!0})})}async add(r,_={}){return _={timeout:this.timeout,throwOnTimeout:this.#g,..._},new Promise((E,S)=>{this.#n.enqueue(async()=>{this.#s++,this.#r++;try{_.signal?.throwIfAborted();let C=r({signal:_.signal});_.timeout&&(C=pTimeout$1(Promise.resolve(C),{milliseconds:_.timeout})),_.signal&&(C=Promise.race([C,this.#x(_.signal)]));const A=await C;E(A),this.emit("completed",A)}catch(C){if(C instanceof TimeoutError$1&&!_.throwOnTimeout){E();return}S(C),this.emit("error",C)}finally{this.#w()}},_),this.emit("add"),this.#f()})}async addAll(r,_){return Promise.all(r.map(async E=>this.add(E,_)))}start(){return this.#o?(this.#o=!1,this.#d(),this):this}pause(){this.#o=!0}clear(){this.#n=new this.#m}async onEmpty(){this.#n.size!==0&&await this.#h("empty")}async onSizeLessThan(r){this.#n.size<r||await this.#h("next",()=>this.#n.size<r)}async onIdle(){this.#s===0&&this.#n.size===0||await this.#h("idle")}async#h(r,_){return new Promise(E=>{const S=()=>{_&&!_()||(this.off(r,S),E())};this.on(r,S)})}get size(){return this.#n.size}sizeBy(r){return this.#n.filter(r).length}get pending(){return this.#s}get isPaused(){return this.#o}};function pDefer(){const n={};return n.promise=new Promise((r,_)=>{n.resolve=r,n.reject=_}),n}class FixedFIFO{buffer;mask;top;btm;next;constructor(r){if(!(r>0)||r-1&r)throw new Error("Max size for a FixedFIFO should be a power of two");this.buffer=new Array(r),this.mask=r-1,this.top=0,this.btm=0,this.next=null}push(r){return this.buffer[this.top]!==void 0?!1:(this.buffer[this.top]=r,this.top=this.top+1&this.mask,!0)}shift(){const r=this.buffer[this.btm];if(r!==void 0)return this.buffer[this.btm]=void 0,this.btm=this.btm+1&this.mask,r}isEmpty(){return this.buffer[this.btm]===void 0}}class FIFO{size;hwm;head;tail;constructor(r={}){this.hwm=r.splitLimit??16,this.head=new FixedFIFO(this.hwm),this.tail=this.head,this.size=0}calculateSize(r){return r?.byteLength!=null?r.byteLength:1}push(r){if(r?.value!=null&&(this.size+=this.calculateSize(r.value)),!this.head.push(r)){const _=this.head;this.head=_.next=new FixedFIFO(2*this.head.buffer.length),this.head.push(r)}}shift(){let r=this.tail.shift();if(r===void 0&&this.tail.next!=null){const _=this.tail.next;this.tail.next=null,this.tail=_,r=this.tail.shift()}return r?.value!=null&&(this.size-=this.calculateSize(r.value)),r}isEmpty(){return this.head.isEmpty()}}let AbortError$6=class extends Error{type;code;constructor(r,_){super(r??"The operation was aborted"),this.type="aborted",this.code=_??"ABORT_ERR"}};function pushable$1(n={}){return _pushable(_=>{const E=_.shift();if(E==null)return{done:!0};if(E.error!=null)throw E.error;return{done:E.done===!0,value:E.value}},n)}function _pushable(n,r){r=r??{};let _=r.onEnd,E=new FIFO,S,C,A,I=pDefer();const B=async()=>{try{return E.isEmpty()?A?{done:!0}:await new Promise((Q,se)=>{C=oe=>{C=null,E.push(oe);try{Q(n(E))}catch(ue){se(ue)}return S}}):n(E)}finally{E.isEmpty()&&queueMicrotask(()=>{I.resolve(),I=pDefer()})}},O=Q=>C!=null?C(Q):(E.push(Q),S),N=Q=>(E=new FIFO,C!=null?C({error:Q}):(E.push({error:Q}),S)),U=Q=>{if(A)return S;if(r?.objectMode!==!0&&Q?.byteLength==null)throw new Error("objectMode was not true but tried to push non-Uint8Array value");return O({done:!1,value:Q})},j=Q=>A?S:(A=!0,Q!=null?N(Q):O({done:!0})),z=()=>(E=new FIFO,j(),{done:!0}),Z=Q=>(j(Q),{done:!0});if(S={[Symbol.asyncIterator](){return this},next:B,return:z,throw:Z,push:U,end:j,get readableLength(){return E.size},onEmpty:async Q=>{const se=Q?.signal;if(se?.throwIfAborted(),E.isEmpty())return;let oe,ue;se!=null&&(oe=new Promise((we,Te)=>{ue=()=>{Te(new AbortError$6)},se.addEventListener("abort",ue)}));try{await Promise.race([I.promise,oe])}finally{ue!=null&&se!=null&&se?.removeEventListener("abort",ue)}}},_==null)return S;const X=S;return S={[Symbol.asyncIterator](){return this},next(){return X.next()},throw(Q){return X.throw(Q),_!=null&&(_(Q),_=void 0),{done:!0}},return(){return X.return(),_!=null&&(_(),_=void 0),{done:!0}},push:U,end(Q){return X.end(Q),_!=null&&(_(Q),_=void 0),S},get readableLength(){return X.readableLength},onEmpty:Q=>X.onEmpty(Q)},S}function isAsyncIterable$f(n){return n[Symbol.asyncIterator]!=null}function merge$1(...n){const r=[];for(const _ of n)isAsyncIterable$f(_)||r.push(_);return r.length===n.length?function*(){for(const _ of r)yield*_}():async function*(){const _=pushable$1({objectMode:!0});Promise.resolve().then(async()=>{try{await Promise.all(n.map(async E=>{for await(const S of E)_.push(S)})),_.end()}catch(E){_.end(E)}}),yield*_}()}function pipe(n,...r){if(n==null)throw new Error("Empty pipeline");if(isDuplex(n)){const E=n;n=()=>E.source}else if(isIterable$1(n)||isAsyncIterable$e(n)){const E=n;n=()=>E}const _=[n,...r];if(_.length>1&&isDuplex(_[_.length-1])&&(_[_.length-1]=_[_.length-1].sink),_.length>2)for(let E=1;E<_.length-1;E++)isDuplex(_[E])&&(_[E]=duplexPipelineFn(_[E]));return rawPipe(..._)}const rawPipe=(...n)=>{let r;for(;n.length>0;)r=n.shift()(r);return r},isAsyncIterable$e=n=>n?.[Symbol.asyncIterator]!=null,isIterable$1=n=>n?.[Symbol.iterator]!=null,isDuplex=n=>n==null?!1:n.sink!=null&&n.source!=null,duplexPipelineFn=n=>r=>{const _=n.sink(r);if(_?.then!=null){const E=pushable$1({objectMode:!0});_.then(()=>{E.end()},A=>{E.end(A)});let S;const C=n.source;if(isAsyncIterable$e(C))S=async function*(){yield*C,E.end()};else if(isIterable$1(C))S=function*(){yield*C,E.end()};else throw new Error("Unknown duplex source type - must be Iterable or AsyncIterable");return merge$1(E,S())}return n.source};var timeBrowser=function(){return Date.now()};const getTime=timeBrowser;class Retimer{constructor(r,_,E){const S=this;this._started=getTime(),this._rescheduled=0,this._scheduled=_,this._args=E,this._triggered=!1,this._timerWrapper=()=>{S._rescheduled>0?(S._scheduled=S._rescheduled-(getTime()-S._started),S._schedule(S._scheduled)):(S._triggered=!0,r.apply(null,S._args))},this._timer=setTimeout(this._timerWrapper,_)}reschedule(r){r||(r=this._scheduled);const _=getTime();_+r-(this._started+this._scheduled)<0?(clearTimeout(this._timer),this._schedule(r)):this._triggered?this._schedule(r):(this._started=_,this._rescheduled=r)}_schedule(r){this._triggered=!1,this._started=getTime(),this._rescheduled=0,this._scheduled=r,this._timer=setTimeout(this._timerWrapper,r)}clear(){clearTimeout(this._timer)}}function retimer$1(){if(typeof arguments[0]!="function")throw new Error("callback needed");if(typeof arguments[1]!="number")throw new Error("timeout needed");let n;if(arguments.length>0){n=new Array(arguments.length-2);for(var r=0;r<n.length;r++)n[r]=arguments[r+2]}return new Retimer(arguments[0],arguments[1],n)}var retimer_1=retimer$1;const{AbortController:AbortController$1}=globalThis,retimer=retimer_1;class TimeoutController extends AbortController$1{constructor(r){super(),this._ms=r,this._timer=retimer(()=>this.abort(),r),Object.setPrototypeOf(this,TimeoutController.prototype)}abort(){return this._timer.clear(),super.abort()}clear(){this._timer.clear()}reset(){this._timer.clear(),this._timer=retimer(()=>this.abort(),this._ms)}}var timeoutAbortController={TimeoutController};const posixJoin=(...n)=>n.join("/").replace(/((?<=\/)\/+)|(^\.\/)|((?<=\/)\.\/)/g,"")||".",DefaultTimeout$1=3e4,Sync=async({ipfs:n,log:r,events:_,onSynced:E,start:S,timeout:C})=>{if(!n)throw new Error("An instance of ipfs is required.");if(!r)throw new Error("An instance of log is required.");const A=n.libp2p,I=n.libp2p.services.pubsub,B=r.id,O=posixJoin("/orbitdb/heads/",B),N=new PQueue$1({concurrency:1}),U=new Set;_=_||new eventsExports.EventEmitter,C=C||DefaultTimeout$1;let j=!1;const z=async xe=>{const Re=await r.heads();_.emit("join",xe,Re)},Z=xe=>async function*(){const Re=await r.heads();for await(const{bytes:Ne}of Re)yield Ne}(),X=xe=>async Re=>{for await(const Ne of Re){const Fe=Ne.subarray();Fe&&E&&await E(Fe)}j&&await z(xe)},Q=async({connection:xe,stream:Re})=>{const Ne=String(xe.remotePeer);try{U.add(Ne),await pipe(Re,X(Ne),Z,Re)}catch(Fe){U.delete(Ne),_.emit("error",Fe)}},se=async xe=>{const Re=async()=>{const{peerId:Ne,subscriptions:Fe}=xe.detail,ht=String(Ne),nt=Fe.find(Ee=>Ee.topic===B);if(nt)if(nt.subscribe){if(U.has(ht))return;const Ee=new timeoutAbortController.TimeoutController(C),{signal:Ce}=Ee;try{U.add(ht);const _e=await A.dialProtocol(Ne,O,{signal:Ce});await pipe(Z,_e,X(ht))}catch(_e){console.error(_e),U.delete(ht),_e.code==="ERR_UNSUPPORTED_PROTOCOL"||_.emit("error",_e)}finally{Ee&&Ee.clear()}}else U.delete(ht),_.emit("leave",ht)};N.add(Re)},oe=async xe=>{const{topic:Re,data:Ne}=xe.detail,Fe=async()=>{try{Ne&&E&&await E(Ne)}catch(ht){_.emit("error",ht)}};Re===B&&N.add(Fe)},ue=async xe=>{j&&await I.publish(B,xe.bytes)},we=async()=>{j&&(j=!1,await N.onIdle(),I.removeEventListener("subscription-change",se),I.removeEventListener("message",oe),await A.unhandle(O),await I.unsubscribe(B),U.clear())},Te=async()=>{j||(await A.handle(O,Q),I.addEventListener("subscription-change",se),I.addEventListener("message",oe),await I.subscribe(B),j=!0)};return S!==!1&&await Te(),{add:ue,stop:we,start:Te,events:_,peers:U}};var inherits_browser={exports:{}};typeof Object.create=="function"?inherits_browser.exports=function(r,_){_&&(r.super_=_,r.prototype=Object.create(_.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}))}:inherits_browser.exports=function(r,_){if(_){r.super_=_;var E=function(){};E.prototype=_.prototype,r.prototype=new E,r.prototype.constructor=r}};var inherits_browserExports=inherits_browser.exports,events$1=eventsExports,inherits=inherits_browserExports,lru=LRU;function LRU(n){if(!(this instanceof LRU))return new LRU(n);typeof n=="number"&&(n={max:n}),n||(n={}),events$1.EventEmitter.call(this),this.cache={},this.head=this.tail=null,this.length=0,this.max=n.max||1e3,this.maxAge=n.maxAge||0}inherits(LRU,events$1.EventEmitter);Object.defineProperty(LRU.prototype,"keys",{get:function(){return Object.keys(this.cache)}});LRU.prototype.clear=function(){this.cache={},this.head=this.tail=null,this.length=0};LRU.prototype.remove=function(n){if(typeof n!="string"&&(n=""+n),!!this.cache.hasOwnProperty(n)){var r=this.cache[n];return delete this.cache[n],this._unlink(n,r.prev,r.next),r.value}};LRU.prototype._unlink=function(n,r,_){this.length--,this.length===0?this.head=this.tail=null:this.head===n?(this.head=r,this.cache[this.head].next=null):this.tail===n?(this.tail=_,this.cache[this.tail].prev=null):(this.cache[r].next=_,this.cache[_].prev=r)};LRU.prototype.peek=function(n){if(this.cache.hasOwnProperty(n)){var r=this.cache[n];if(this._checkAge(n,r))return r.value}};LRU.prototype.set=function(n,r){typeof n!="string"&&(n=""+n);var _;if(this.cache.hasOwnProperty(n)){if(_=this.cache[n],_.value=r,this.maxAge&&(_.modified=Date.now()),n===this.head)return r;this._unlink(n,_.prev,_.next)}else _={value:r,modified:0,next:null,prev:null},this.maxAge&&(_.modified=Date.now()),this.cache[n]=_,this.length===this.max&&this.evict();return this.length++,_.next=null,_.prev=this.head,this.head&&(this.cache[this.head].next=n),this.head=n,this.tail||(this.tail=n),r};LRU.prototype._checkAge=function(n,r){return this.maxAge&&Date.now()-r.modified>this.maxAge?(this.remove(n),this.emit("evict",{key:n,value:r.value}),!1):!0};LRU.prototype.get=function(n){if(typeof n!="string"&&(n=""+n),!!this.cache.hasOwnProperty(n)){var r=this.cache[n];if(this._checkAge(n,r))return this.head!==n&&(n===this.tail?(this.tail=r.next,this.cache[this.tail].prev=null):this.cache[r.prev].next=r.next,this.cache[r.next].prev=r.prev,this.cache[this.head].next=n,r.prev=this.head,r.next=null,this.head=n),r.value}};LRU.prototype.evict=function(){if(this.tail){var n=this.tail,r=this.remove(this.tail);this.emit("evict",{key:n,value:r})}};const LRU$1=getDefaultExportFromCjs(lru),compareClocks=(n,r)=>{const _=n.time-r.time;return _===0&&n.id!==r.id?n.id<r.id?-1:1:_},tickClock=n=>Clock(n.id,++n.time),Clock=(n,r)=>(r=r||0,{id:n,time:r}),equals$5=(n,r)=>{if(n===r)return!0;if(n.byteLength!==r.byteLength)return!1;for(let _=0;_<n.byteLength;_++)if(n[_]!==r[_])return!1;return!0},coerce$1=n=>{if(n instanceof Uint8Array&&n.constructor.name==="Uint8Array")return n;if(n instanceof ArrayBuffer)return new Uint8Array(n);if(ArrayBuffer.isView(n))return new Uint8Array(n.buffer,n.byteOffset,n.byteLength);throw new Error("Unknown type, must be binary type")},fromString$6=n=>new TextEncoder().encode(n),toString$7=n=>new TextDecoder().decode(n);function base$6(n,r){if(n.length>=255)throw new TypeError("Alphabet too long");for(var _=new Uint8Array(256),E=0;E<_.length;E++)_[E]=255;for(var S=0;S<n.length;S++){var C=n.charAt(S),A=C.charCodeAt(0);if(_[A]!==255)throw new TypeError(C+" is ambiguous");_[A]=S}var I=n.length,B=n.charAt(0),O=Math.log(I)/Math.log(256),N=Math.log(256)/Math.log(I);function U(Z){if(Z instanceof Uint8Array||(ArrayBuffer.isView(Z)?Z=new Uint8Array(Z.buffer,Z.byteOffset,Z.byteLength):Array.isArray(Z)&&(Z=Uint8Array.from(Z))),!(Z instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(Z.length===0)return"";for(var X=0,Q=0,se=0,oe=Z.length;se!==oe&&Z[se]===0;)se++,X++;for(var ue=(oe-se)*N+1>>>0,we=new Uint8Array(ue);se!==oe;){for(var Te=Z[se],xe=0,Re=ue-1;(Te!==0||xe<Q)&&Re!==-1;Re--,xe++)Te+=256*we[Re]>>>0,we[Re]=Te%I>>>0,Te=Te/I>>>0;if(Te!==0)throw new Error("Non-zero carry");Q=xe,se++}for(var Ne=ue-Q;Ne!==ue&&we[Ne]===0;)Ne++;for(var Fe=B.repeat(X);Ne<ue;++Ne)Fe+=n.charAt(we[Ne]);return Fe}function j(Z){if(typeof Z!="string")throw new TypeError("Expected String");if(Z.length===0)return new Uint8Array;var X=0;if(Z[X]!==" "){for(var Q=0,se=0;Z[X]===B;)Q++,X++;for(var oe=(Z.length-X)*O+1>>>0,ue=new Uint8Array(oe);Z[X];){var we=_[Z.charCodeAt(X)];if(we===255)return;for(var Te=0,xe=oe-1;(we!==0||Te<se)&&xe!==-1;xe--,Te++)we+=I*ue[xe]>>>0,ue[xe]=we%256>>>0,we=we/256>>>0;if(we!==0)throw new Error("Non-zero carry");se=Te,X++}if(Z[X]!==" "){for(var Re=oe-se;Re!==oe&&ue[Re]===0;)Re++;for(var Ne=new Uint8Array(Q+(oe-Re)),Fe=Q;Re!==oe;)Ne[Fe++]=ue[Re++];return Ne}}}function z(Z){var X=j(Z);if(X)return X;throw new Error(`Non-${r} character`)}return{encode:U,decodeUnsafe:j,decode:z}}var src$5=base$6,_brrp__multiformats_scope_baseX$1=src$5;let Encoder$2=class{constructor(r,_,E){this.name=r,this.prefix=_,this.baseEncode=E}encode(r){if(r instanceof Uint8Array)return`${this.prefix}${this.baseEncode(r)}`;throw Error("Unknown type, must be binary type")}},Decoder$3=class{constructor(r,_,E){if(this.name=r,this.prefix=_,_.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=_.codePointAt(0),this.baseDecode=E}decode(r){if(typeof r=="string"){if(r.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(r)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(r.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(r){return or$3(this,r)}},ComposedDecoder$1=class{constructor(r){this.decoders=r}or(r){return or$3(this,r)}decode(r){const _=r[0],E=this.decoders[_];if(E)return E.decode(r);throw RangeError(`Unable to decode multibase string ${JSON.stringify(r)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}};const or$3=(n,r)=>new ComposedDecoder$1({...n.decoders||{[n.prefix]:n},...r.decoders||{[r.prefix]:r}});let Codec$1=class{constructor(r,_,E,S){this.name=r,this.prefix=_,this.baseEncode=E,this.baseDecode=S,this.encoder=new Encoder$2(r,_,E),this.decoder=new Decoder$3(r,_,S)}encode(r){return this.encoder.encode(r)}decode(r){return this.decoder.decode(r)}};const from$4=({name:n,prefix:r,encode:_,decode:E})=>new Codec$1(n,r,_,E),baseX$2=({prefix:n,name:r,alphabet:_})=>{const{encode:E,decode:S}=_brrp__multiformats_scope_baseX$1(_,r);return from$4({prefix:n,name:r,encode:E,decode:C=>coerce$1(S(C))})},decode$q=(n,r,_,E)=>{const S={};for(let N=0;N<r.length;++N)S[r[N]]=N;let C=n.length;for(;n[C-1]==="=";)--C;const A=new Uint8Array(C*_/8|0);let I=0,B=0,O=0;for(let N=0;N<C;++N){const U=S[n[N]];if(U===void 0)throw new SyntaxError(`Non-${E} character`);B=B<<_|U,I+=_,I>=8&&(I-=8,A[O++]=255&B>>I)}if(I>=_||255&B<<8-I)throw new SyntaxError("Unexpected end of data");return A},encode$m=(n,r,_)=>{const E=r[r.length-1]==="=",S=(1<<_)-1;let C="",A=0,I=0;for(let B=0;B<n.length;++B)for(I=I<<8|n[B],A+=8;A>_;)A-=_,C+=r[S&I>>A];if(A&&(C+=r[S&I<<_-A]),E)for(;C.length*_&7;)C+="=";return C},rfc4648$3=({name:n,prefix:r,bitsPerChar:_,alphabet:E})=>from$4({prefix:r,name:n,encode(S){return encode$m(S,E,_)},decode(S){return decode$q(S,E,_,n)}}),base32$2=rfc4648$3({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),base32upper$1=rfc4648$3({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),base32pad$1=rfc4648$3({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),base32padupper$1=rfc4648$3({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),base32hex$1=rfc4648$3({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),base32hexupper$1=rfc4648$3({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),base32hexpad$1=rfc4648$3({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),base32hexpadupper$1=rfc4648$3({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),base32z$1=rfc4648$3({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),base32$3=Object.freeze(Object.defineProperty({__proto__:null,base32:base32$2,base32hex:base32hex$1,base32hexpad:base32hexpad$1,base32hexpadupper:base32hexpadupper$1,base32hexupper:base32hexupper$1,base32pad:base32pad$1,base32padupper:base32padupper$1,base32upper:base32upper$1,base32z:base32z$1},Symbol.toStringTag,{value:"Module"})),base58btc$1=baseX$2({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),base58flickr$1=baseX$2({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),base58$1=Object.freeze(Object.defineProperty({__proto__:null,base58btc:base58btc$1,base58flickr:base58flickr$1},Symbol.toStringTag,{value:"Module"}));var encode_1$3=encode$l,MSB$7=128,REST$7=127,MSBALL$3=~REST$7,INT$3=Math.pow(2,31);function encode$l(n,r,_){r=r||[],_=_||0;for(var E=_;n>=INT$3;)r[_++]=n&255|MSB$7,n/=128;for(;n&MSBALL$3;)r[_++]=n&255|MSB$7,n>>>=7;return r[_]=n|0,encode$l.bytes=_-E+1,r}var decode$p=read$5,MSB$1$2=128,REST$1$2=127;function read$5(n,E){var _=0,E=E||0,S=0,C=E,A,I=n.length;do{if(C>=I)throw read$5.bytes=0,new RangeError("Could not decode varint");A=n[C++],_+=S<28?(A&REST$1$2)<<S:(A&REST$1$2)*Math.pow(2,S),S+=7}while(A>=MSB$1$2);return read$5.bytes=C-E,_}var N1$4=Math.pow(2,7),N2$4=Math.pow(2,14),N3$4=Math.pow(2,21),N4$4=Math.pow(2,28),N5$4=Math.pow(2,35),N6$4=Math.pow(2,42),N7$4=Math.pow(2,49),N8$3=Math.pow(2,56),N9$3=Math.pow(2,63),length$5=function(n){return n<N1$4?1:n<N2$4?2:n<N3$4?3:n<N4$4?4:n<N5$4?5:n<N6$4?6:n<N7$4?7:n<N8$3?8:n<N9$3?9:10},varint$5={encode:encode_1$3,decode:decode$p,encodingLength:length$5},_brrp_varint$1=varint$5;const decode$o=(n,r=0)=>[_brrp_varint$1.decode(n,r),_brrp_varint$1.decode.bytes],encodeTo$1=(n,r,_=0)=>(_brrp_varint$1.encode(n,r,_),r),encodingLength$2=n=>_brrp_varint$1.encodingLength(n),create$5=(n,r)=>{const _=r.byteLength,E=encodingLength$2(n),S=E+encodingLength$2(_),C=new Uint8Array(S+_);return encodeTo$1(n,C,0),encodeTo$1(_,C,E),C.set(r,S),new Digest$1(n,_,r,C)},decode$n=n=>{const r=coerce$1(n),[_,E]=decode$o(r),[S,C]=decode$o(r.subarray(E)),A=r.subarray(E+C);if(A.byteLength!==S)throw new Error("Incorrect length");return new Digest$1(_,S,A,r)},equals$4=(n,r)=>{if(n===r)return!0;{const _=r;return n.code===_.code&&n.size===_.size&&_.bytes instanceof Uint8Array&&equals$5(n.bytes,_.bytes)}};let Digest$1=class{constructor(r,_,E,S){this.code=r,this.size=_,this.digest=E,this.bytes=S}};const format$4=(n,r)=>{const{bytes:_,version:E}=n;switch(E){case 0:return toStringV0$1(_,baseCache$1(n),r||base58btc$1.encoder);default:return toStringV1$1(_,baseCache$1(n),r||base32$2.encoder)}},cache$3=new WeakMap,baseCache$1=n=>{const r=cache$3.get(n);if(r==null){const _=new Map;return cache$3.set(n,_),_}return r};let CID$1=class On{constructor(r,_,E,S){this.code=_,this.version=r,this.multihash=E,this.bytes=S,this["/"]=S}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{const{code:r,multihash:_}=this;if(r!==DAG_PB_CODE$1)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(_.code!==SHA_256_CODE$1)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return On.createV0(_)}default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}toV1(){switch(this.version){case 0:{const{code:r,digest:_}=this.multihash,E=create$5(r,_);return On.createV1(this.code,E)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 1. This is a bug please report`)}}equals(r){return On.equals(this,r)}static equals(r,_){const E=_;return E&&r.code===E.code&&r.version===E.version&&equals$4(r.multihash,E.multihash)}toString(r){return format$4(this,r)}toJSON(){return{"/":format$4(this)}}link(){return this}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return`CID(${this.toString()})`}static asCID(r){if(r==null)return null;const _=r;if(_ instanceof On)return _;if(_["/"]!=null&&_["/"]===_.bytes||_.asCID===_){const{version:E,code:S,multihash:C,bytes:A}=_;return new On(E,S,C,A||encodeCID$1(E,S,C.bytes))}else if(_[cidSymbol$1]===!0){const{version:E,multihash:S,code:C}=_,A=decode$n(S);return On.create(E,C,A)}else return null}static create(r,_,E){if(typeof _!="number")throw new Error("String codecs are no longer supported");if(!(E.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(r){case 0:{if(_!==DAG_PB_CODE$1)throw new Error(`Version 0 CID must use dag-pb (code: ${DAG_PB_CODE$1}) block encoding`);return new On(r,_,E,E.bytes)}case 1:{const S=encodeCID$1(r,_,E.bytes);return new On(r,_,E,S)}default:throw new Error("Invalid version")}}static createV0(r){return On.create(0,DAG_PB_CODE$1,r)}static createV1(r,_){return On.create(1,r,_)}static decode(r){const[_,E]=On.decodeFirst(r);if(E.length)throw new Error("Incorrect length");return _}static decodeFirst(r){const _=On.inspectBytes(r),E=_.size-_.multihashSize,S=coerce$1(r.subarray(E,E+_.multihashSize));if(S.byteLength!==_.multihashSize)throw new Error("Incorrect length");const C=S.subarray(_.multihashSize-_.digestSize),A=new Digest$1(_.multihashCode,_.digestSize,C,S);return[_.version===0?On.createV0(A):On.createV1(_.codec,A),r.subarray(_.size)]}static inspectBytes(r){let _=0;const E=()=>{const[U,j]=decode$o(r.subarray(_));return _+=j,U};let S=E(),C=DAG_PB_CODE$1;if(S===18?(S=0,_=0):C=E(),S!==0&&S!==1)throw new RangeError(`Invalid CID version ${S}`);const A=_,I=E(),B=E(),O=_+B,N=O-A;return{version:S,codec:C,multihashCode:I,digestSize:B,multihashSize:N,size:O}}static parse(r,_){const[E,S]=parseCIDtoBytes$1(r,_),C=On.decode(S);if(C.version===0&&r[0]!=="Q")throw Error("Version 0 CID string must not include multibase prefix");return baseCache$1(C).set(E,r),C}};const parseCIDtoBytes$1=(n,r)=>{switch(n[0]){case"Q":{const _=r||base58btc$1;return[base58btc$1.prefix,_.decode(`${base58btc$1.prefix}${n}`)]}case base58btc$1.prefix:{const _=r||base58btc$1;return[base58btc$1.prefix,_.decode(n)]}case base32$2.prefix:{const _=r||base32$2;return[base32$2.prefix,_.decode(n)]}default:{if(r==null)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[n[0],r.decode(n)]}}},toStringV0$1=(n,r,_)=>{const{prefix:E}=_;if(E!==base58btc$1.prefix)throw Error(`Cannot string encode V0 in ${_.name} encoding`);const S=r.get(E);if(S==null){const C=_.encode(n).slice(1);return r.set(E,C),C}else return S},toStringV1$1=(n,r,_)=>{const{prefix:E}=_,S=r.get(E);if(S==null){const C=_.encode(n);return r.set(E,C),C}else return S},DAG_PB_CODE$1=112,SHA_256_CODE$1=18,encodeCID$1=(n,r,_)=>{const E=encodingLength$2(n),S=E+encodingLength$2(r),C=new Uint8Array(S+_.byteLength);return encodeTo$1(n,C,0),encodeTo$1(r,C,E),C.set(_,S),C},cidSymbol$1=Symbol.for("@ipld/js-cid/CID"),from$3=({name:n,code:r,encode:_})=>new Hasher$1(n,r,_);let Hasher$1=class{constructor(r,_,E){this.name=r,this.code=_,this.encode=E}digest(r){if(r instanceof Uint8Array){const _=this.encode(r);return _ instanceof Uint8Array?create$5(this.code,_):_.then(E=>create$5(this.code,E))}else throw Error("Unknown type, must be binary type")}};function readonly$1({enumerable:n=!0,configurable:r=!1}={}){return{enumerable:n,configurable:r,writable:!1}}function*linksWithin$1(n,r){if(r!=null&&typeof r=="object")if(Array.isArray(r))for(const[_,E]of r.entries()){const S=[...n,_],C=CID$1.asCID(E);C?yield[S.join("/"),C]:typeof E=="object"&&(yield*links$1(E,S))}else{const _=CID$1.asCID(r);_?yield[n.join("/"),_]:yield*links$1(r,n)}}function*links$1(n,r){if(n==null||n instanceof Uint8Array)return;const _=CID$1.asCID(n);_&&(yield[r.join("/"),_]);for(const[E,S]of Object.entries(n)){const C=[...r,E];yield*linksWithin$1(C,S)}}function*treeWithin$1(n,r){if(Array.isArray(r))for(const[_,E]of r.entries()){const S=[...n,_];yield S.join("/"),typeof E=="object"&&!CID$1.asCID(E)&&(yield*tree$1(E,S))}else yield*tree$1(r,n)}function*tree$1(n,r){if(!(n==null||typeof n!="object"))for(const[_,E]of Object.entries(n)){const S=[...r,_];yield S.join("/"),E!=null&&!(E instanceof Uint8Array)&&typeof E=="object"&&!CID$1.asCID(E)&&(yield*treeWithin$1(S,E))}}function get$1(n,r){let _=n;for(const[E,S]of r.entries()){if(_=_[S],_==null)throw new Error(`Object has no property at ${r.slice(0,E+1).map(A=>`[${JSON.stringify(A)}]`).join("")}`);const C=CID$1.asCID(_);if(C)return{value:C,remaining:r.slice(E+1).join("/")}}return{value:_}}let Block$1=class{constructor({cid:r,bytes:_,value:E}){if(!r||!_||typeof E>"u")throw new Error("Missing required argument");this.cid=r,this.bytes=_,this.value=E,this.asBlock=this,Object.defineProperties(this,{cid:readonly$1(),bytes:readonly$1(),value:readonly$1(),asBlock:readonly$1()})}links(){return links$1(this.value,[])}tree(){return tree$1(this.value,[])}get(r="/"){return get$1(this.value,r.split("/").filter(Boolean))}};async function encode$k({value:n,codec:r,hasher:_}){if(typeof n>"u")throw new Error('Missing required argument "value"');if(!r||!_)throw new Error("Missing required argument: codec or hasher");const E=r.encode(n),S=await _.digest(E),C=CID$1.create(1,r.code,S);return new Block$1({value:n,bytes:E,cid:C})}async function decode$m({bytes:n,codec:r,hasher:_}){if(!n)throw new Error('Missing required argument "bytes"');if(!r||!_)throw new Error("Missing required argument: codec or hasher");const E=r.decode(n),S=await _.digest(n),C=CID$1.create(1,r.code,S);return new Block$1({value:E,bytes:n,cid:C})}const typeofs=["string","number","bigint","symbol"],objectTypeNames=["Function","Generator","AsyncGenerator","GeneratorFunction","AsyncGeneratorFunction","AsyncFunction","Observable","Array","Buffer","Object","RegExp","Date","Error","Map","Set","WeakMap","WeakSet","ArrayBuffer","SharedArrayBuffer","DataView","Promise","URL","HTMLElement","Int8Array","Uint8Array","Uint8ClampedArray","Int16Array","Uint16Array","Int32Array","Uint32Array","Float32Array","Float64Array","BigInt64Array","BigUint64Array"];function is(n){if(n===null)return"null";if(n===void 0)return"undefined";if(n===!0||n===!1)return"boolean";const r=typeof n;if(typeofs.includes(r))return r;if(r==="function")return"Function";if(Array.isArray(n))return"Array";if(isBuffer$1(n))return"Buffer";const _=getObjectType(n);return _||"Object"}function isBuffer$1(n){return n&&n.constructor&&n.constructor.isBuffer&&n.constructor.isBuffer.call(null,n)}function getObjectType(n){const r=Object.prototype.toString.call(n).slice(8,-1);if(objectTypeNames.includes(r))return r}class Type{constructor(r,_,E){this.major=r,this.majorEncoded=r<<5,this.name=_,this.terminal=E}toString(){return`Type[${this.major}].${this.name}`}compare(r){return this.major<r.major?-1:this.major>r.major?1:0}}Type.uint=new Type(0,"uint",!0);Type.negint=new Type(1,"negint",!0);Type.bytes=new Type(2,"bytes",!0);Type.string=new Type(3,"string",!0);Type.array=new Type(4,"array",!1);Type.map=new Type(5,"map",!1);Type.tag=new Type(6,"tag",!1);Type.float=new Type(7,"float",!0);Type.false=new Type(7,"false",!0);Type.true=new Type(7,"true",!0);Type.null=new Type(7,"null",!0);Type.undefined=new Type(7,"undefined",!0);Type.break=new Type(7,"break",!0);class Token{constructor(r,_,E){this.type=r,this.value=_,this.encodedLength=E,this.encodedBytes=void 0,this.byteValue=void 0}toString(){return`Token[${this.type}].${this.value}`}}const useBuffer=globalThis.process&&!globalThis.process.browser&&globalThis.Buffer&&typeof globalThis.Buffer.isBuffer=="function",textDecoder$4=new TextDecoder,textEncoder$5=new TextEncoder;function isBuffer(n){return useBuffer&&globalThis.Buffer.isBuffer(n)}function asU8A(n){return n instanceof Uint8Array?isBuffer(n)?new Uint8Array(n.buffer,n.byteOffset,n.byteLength):n:Uint8Array.from(n)}const toString$6=useBuffer?(n,r,_)=>_-r>64?globalThis.Buffer.from(n.subarray(r,_)).toString("utf8"):utf8Slice(n,r,_):(n,r,_)=>_-r>64?textDecoder$4.decode(n.subarray(r,_)):utf8Slice(n,r,_),fromString$5=useBuffer?n=>n.length>64?globalThis.Buffer.from(n):utf8ToBytes$3(n):n=>n.length>64?textEncoder$5.encode(n):utf8ToBytes$3(n),fromArray=n=>Uint8Array.from(n),slice=useBuffer?(n,r,_)=>isBuffer(n)?new Uint8Array(n.subarray(r,_)):n.slice(r,_):(n,r,_)=>n.slice(r,_),concat$5=useBuffer?(n,r)=>(n=n.map(_=>_ instanceof Uint8Array?_:globalThis.Buffer.from(_)),asU8A(globalThis.Buffer.concat(n,r))):(n,r)=>{const _=new Uint8Array(r);let E=0;for(let S of n)E+S.length>_.length&&(S=S.subarray(0,_.length-E)),_.set(S,E),E+=S.length;return _},alloc$2=useBuffer?n=>globalThis.Buffer.allocUnsafe(n):n=>new Uint8Array(n);function compare$1(n,r){if(isBuffer(n)&&isBuffer(r))return n.compare(r);for(let _=0;_<n.length;_++)if(n[_]!==r[_])return n[_]<r[_]?-1:1;return 0}function utf8ToBytes$3(n){const r=[];let _=0;for(let E=0;E<n.length;E++){let S=n.charCodeAt(E);S<128?r[_++]=S:S<2048?(r[_++]=S>>6|192,r[_++]=S&63|128):(S&64512)===55296&&E+1<n.length&&(n.charCodeAt(E+1)&64512)===56320?(S=65536+((S&1023)<<10)+(n.charCodeAt(++E)&1023),r[_++]=S>>18|240,r[_++]=S>>12&63|128,r[_++]=S>>6&63|128,r[_++]=S&63|128):(r[_++]=S>>12|224,r[_++]=S>>6&63|128,r[_++]=S&63|128)}return r}function utf8Slice(n,r,_){const E=[];for(;r<_;){const S=n[r];let C=null,A=S>239?4:S>223?3:S>191?2:1;if(r+A<=_){let I,B,O,N;switch(A){case 1:S<128&&(C=S);break;case 2:I=n[r+1],(I&192)===128&&(N=(S&31)<<6|I&63,N>127&&(C=N));break;case 3:I=n[r+1],B=n[r+2],(I&192)===128&&(B&192)===128&&(N=(S&15)<<12|(I&63)<<6|B&63,N>2047&&(N<55296||N>57343)&&(C=N));break;case 4:I=n[r+1],B=n[r+2],O=n[r+3],(I&192)===128&&(B&192)===128&&(O&192)===128&&(N=(S&15)<<18|(I&63)<<12|(B&63)<<6|O&63,N>65535&&N<1114112&&(C=N))}}C===null?(C=65533,A=1):C>65535&&(C-=65536,E.push(C>>>10&1023|55296),C=56320|C&1023),E.push(C),r+=A}return decodeCodePointsArray(E)}const MAX_ARGUMENTS_LENGTH=4096;function decodeCodePointsArray(n){const r=n.length;if(r<=MAX_ARGUMENTS_LENGTH)return String.fromCharCode.apply(String,n);let _="",E=0;for(;E<r;)_+=String.fromCharCode.apply(String,n.slice(E,E+=MAX_ARGUMENTS_LENGTH));return _}const defaultChunkSize=256;class Bl{constructor(r=defaultChunkSize){this.chunkSize=r,this.cursor=0,this.maxCursor=-1,this.chunks=[],this._initReuseChunk=null}reset(){this.cursor=0,this.maxCursor=-1,this.chunks.length&&(this.chunks=[]),this._initReuseChunk!==null&&(this.chunks.push(this._initReuseChunk),this.maxCursor=this._initReuseChunk.length-1)}push(r){let _=this.chunks[this.chunks.length-1];if(this.cursor+r.length<=this.maxCursor+1){const S=_.length-(this.maxCursor-this.cursor)-1;_.set(r,S)}else{if(_){const S=_.length-(this.maxCursor-this.cursor)-1;S<_.length&&(this.chunks[this.chunks.length-1]=_.subarray(0,S),this.maxCursor=this.cursor-1)}r.length<64&&r.length<this.chunkSize?(_=alloc$2(this.chunkSize),this.chunks.push(_),this.maxCursor+=_.length,this._initReuseChunk===null&&(this._initReuseChunk=_),_.set(r,0)):(this.chunks.push(r),this.maxCursor+=r.length)}this.cursor+=r.length}toBytes(r=!1){let _;if(this.chunks.length===1){const E=this.chunks[0];r&&this.cursor>E.length/2?(_=this.cursor===E.length?E:E.subarray(0,this.cursor),this._initReuseChunk=null,this.chunks=[]):_=slice(E,0,this.cursor)}else _=concat$5(this.chunks,this.cursor);return r&&this.reset(),_}}const decodeErrPrefix="CBOR decode error:",encodeErrPrefix="CBOR encode error:";function assertEnoughData(n,r,_){if(n.length-r<_)throw new Error(`${decodeErrPrefix} not enough data for type`)}const uintBoundaries=[24,256,65536,4294967296,BigInt("18446744073709551616")];function readUint8(n,r,_){assertEnoughData(n,r,1);const E=n[r];if(_.strict===!0&&E<uintBoundaries[0])throw new Error(`${decodeErrPrefix} integer encoded in more bytes than necessary (strict decode)`);return E}function readUint16(n,r,_){assertEnoughData(n,r,2);const E=n[r]<<8|n[r+1];if(_.strict===!0&&E<uintBoundaries[1])throw new Error(`${decodeErrPrefix} integer encoded in more bytes than necessary (strict decode)`);return E}function readUint32(n,r,_){assertEnoughData(n,r,4);const E=n[r]*16777216+(n[r+1]<<16)+(n[r+2]<<8)+n[r+3];if(_.strict===!0&&E<uintBoundaries[2])throw new Error(`${decodeErrPrefix} integer encoded in more bytes than necessary (strict decode)`);return E}function readUint64(n,r,_){assertEnoughData(n,r,8);const E=n[r]*16777216+(n[r+1]<<16)+(n[r+2]<<8)+n[r+3],S=n[r+4]*16777216+(n[r+5]<<16)+(n[r+6]<<8)+n[r+7],C=(BigInt(E)<<BigInt(32))+BigInt(S);if(_.strict===!0&&C<uintBoundaries[3])throw new Error(`${decodeErrPrefix} integer encoded in more bytes than necessary (strict decode)`);if(C<=Number.MAX_SAFE_INTEGER)return Number(C);if(_.allowBigInt===!0)return C;throw new Error(`${decodeErrPrefix} integers outside of the safe integer range are not supported`)}function decodeUint8(n,r,_,E){return new Token(Type.uint,readUint8(n,r+1,E),2)}function decodeUint16(n,r,_,E){return new Token(Type.uint,readUint16(n,r+1,E),3)}function decodeUint32(n,r,_,E){return new Token(Type.uint,readUint32(n,r+1,E),5)}function decodeUint64(n,r,_,E){return new Token(Type.uint,readUint64(n,r+1,E),9)}function encodeUint(n,r){return encodeUintValue(n,0,r.value)}function encodeUintValue(n,r,_){if(_<uintBoundaries[0]){const E=Number(_);n.push([r|E])}else if(_<uintBoundaries[1]){const E=Number(_);n.push([r|24,E])}else if(_<uintBoundaries[2]){const E=Number(_);n.push([r|25,E>>>8,E&255])}else if(_<uintBoundaries[3]){const E=Number(_);n.push([r|26,E>>>24&255,E>>>16&255,E>>>8&255,E&255])}else{const E=BigInt(_);if(E<uintBoundaries[4]){const S=[r|27,0,0,0,0,0,0,0];let C=Number(E&BigInt(4294967295)),A=Number(E>>BigInt(32)&BigInt(4294967295));S[8]=C&255,C=C>>8,S[7]=C&255,C=C>>8,S[6]=C&255,C=C>>8,S[5]=C&255,S[4]=A&255,A=A>>8,S[3]=A&255,A=A>>8,S[2]=A&255,A=A>>8,S[1]=A&255,n.push(S)}else throw new Error(`${decodeErrPrefix} encountered BigInt larger than allowable range`)}}encodeUint.encodedSize=function(r){return encodeUintValue.encodedSize(r.value)};encodeUintValue.encodedSize=function(r){return r<uintBoundaries[0]?1:r<uintBoundaries[1]?2:r<uintBoundaries[2]?3:r<uintBoundaries[3]?5:9};encodeUint.compareTokens=function(r,_){return r.value<_.value?-1:r.value>_.value?1:0};function decodeNegint8(n,r,_,E){return new Token(Type.negint,-1-readUint8(n,r+1,E),2)}function decodeNegint16(n,r,_,E){return new Token(Type.negint,-1-readUint16(n,r+1,E),3)}function decodeNegint32(n,r,_,E){return new Token(Type.negint,-1-readUint32(n,r+1,E),5)}const neg1b=BigInt(-1),pos1b=BigInt(1);function decodeNegint64(n,r,_,E){const S=readUint64(n,r+1,E);if(typeof S!="bigint"){const C=-1-S;if(C>=Number.MIN_SAFE_INTEGER)return new Token(Type.negint,C,9)}if(E.allowBigInt!==!0)throw new Error(`${decodeErrPrefix} integers outside of the safe integer range are not supported`);return new Token(Type.negint,neg1b-BigInt(S),9)}function encodeNegint(n,r){const _=r.value,E=typeof _=="bigint"?_*neg1b-pos1b:_*-1-1;encodeUintValue(n,r.type.majorEncoded,E)}encodeNegint.encodedSize=function(r){const _=r.value,E=typeof _=="bigint"?_*neg1b-pos1b:_*-1-1;return E<uintBoundaries[0]?1:E<uintBoundaries[1]?2:E<uintBoundaries[2]?3:E<uintBoundaries[3]?5:9};encodeNegint.compareTokens=function(r,_){return r.value<_.value?1:r.value>_.value?-1:0};function toToken$3(n,r,_,E){assertEnoughData(n,r,_+E);const S=slice(n,r+_,r+_+E);return new Token(Type.bytes,S,_+E)}function decodeBytesCompact(n,r,_,E){return toToken$3(n,r,1,_)}function decodeBytes8(n,r,_,E){return toToken$3(n,r,2,readUint8(n,r+1,E))}function decodeBytes16(n,r,_,E){return toToken$3(n,r,3,readUint16(n,r+1,E))}function decodeBytes32(n,r,_,E){return toToken$3(n,r,5,readUint32(n,r+1,E))}function decodeBytes64(n,r,_,E){const S=readUint64(n,r+1,E);if(typeof S=="bigint")throw new Error(`${decodeErrPrefix} 64-bit integer bytes lengths not supported`);return toToken$3(n,r,9,S)}function tokenBytes(n){return n.encodedBytes===void 0&&(n.encodedBytes=n.type===Type.string?fromString$5(n.value):n.value),n.encodedBytes}function encodeBytes(n,r){const _=tokenBytes(r);encodeUintValue(n,r.type.majorEncoded,_.length),n.push(_)}encodeBytes.encodedSize=function(r){const _=tokenBytes(r);return encodeUintValue.encodedSize(_.length)+_.length};encodeBytes.compareTokens=function(r,_){return compareBytes(tokenBytes(r),tokenBytes(_))};function compareBytes(n,r){return n.length<r.length?-1:n.length>r.length?1:compare$1(n,r)}function toToken$2(n,r,_,E,S){const C=_+E;assertEnoughData(n,r,C);const A=new Token(Type.string,toString$6(n,r+_,r+C),C);return S.retainStringBytes===!0&&(A.byteValue=slice(n,r+_,r+C)),A}function decodeStringCompact(n,r,_,E){return toToken$2(n,r,1,_,E)}function decodeString8(n,r,_,E){return toToken$2(n,r,2,readUint8(n,r+1,E),E)}function decodeString16(n,r,_,E){return toToken$2(n,r,3,readUint16(n,r+1,E),E)}function decodeString32(n,r,_,E){return toToken$2(n,r,5,readUint32(n,r+1,E),E)}function decodeString64(n,r,_,E){const S=readUint64(n,r+1,E);if(typeof S=="bigint")throw new Error(`${decodeErrPrefix} 64-bit integer string lengths not supported`);return toToken$2(n,r,9,S,E)}const encodeString=encodeBytes;function toToken$1(n,r,_,E){return new Token(Type.array,E,_)}function decodeArrayCompact(n,r,_,E){return toToken$1(n,r,1,_)}function decodeArray8(n,r,_,E){return toToken$1(n,r,2,readUint8(n,r+1,E))}function decodeArray16(n,r,_,E){return toToken$1(n,r,3,readUint16(n,r+1,E))}function decodeArray32(n,r,_,E){return toToken$1(n,r,5,readUint32(n,r+1,E))}function decodeArray64(n,r,_,E){const S=readUint64(n,r+1,E);if(typeof S=="bigint")throw new Error(`${decodeErrPrefix} 64-bit integer array lengths not supported`);return toToken$1(n,r,9,S)}function decodeArrayIndefinite(n,r,_,E){if(E.allowIndefinite===!1)throw new Error(`${decodeErrPrefix} indefinite length items not allowed`);return toToken$1(n,r,1,1/0)}function encodeArray(n,r){encodeUintValue(n,Type.array.majorEncoded,r.value)}encodeArray.compareTokens=encodeUint.compareTokens;encodeArray.encodedSize=function(r){return encodeUintValue.encodedSize(r.value)};function toToken(n,r,_,E){return new Token(Type.map,E,_)}function decodeMapCompact(n,r,_,E){return toToken(n,r,1,_)}function decodeMap8(n,r,_,E){return toToken(n,r,2,readUint8(n,r+1,E))}function decodeMap16(n,r,_,E){return toToken(n,r,3,readUint16(n,r+1,E))}function decodeMap32(n,r,_,E){return toToken(n,r,5,readUint32(n,r+1,E))}function decodeMap64(n,r,_,E){const S=readUint64(n,r+1,E);if(typeof S=="bigint")throw new Error(`${decodeErrPrefix} 64-bit integer map lengths not supported`);return toToken(n,r,9,S)}function decodeMapIndefinite(n,r,_,E){if(E.allowIndefinite===!1)throw new Error(`${decodeErrPrefix} indefinite length items not allowed`);return toToken(n,r,1,1/0)}function encodeMap(n,r){encodeUintValue(n,Type.map.majorEncoded,r.value)}encodeMap.compareTokens=encodeUint.compareTokens;encodeMap.encodedSize=function(r){return encodeUintValue.encodedSize(r.value)};function decodeTagCompact(n,r,_,E){return new Token(Type.tag,_,1)}function decodeTag8(n,r,_,E){return new Token(Type.tag,readUint8(n,r+1,E),2)}function decodeTag16(n,r,_,E){return new Token(Type.tag,readUint16(n,r+1,E),3)}function decodeTag32(n,r,_,E){return new Token(Type.tag,readUint32(n,r+1,E),5)}function decodeTag64(n,r,_,E){return new Token(Type.tag,readUint64(n,r+1,E),9)}function encodeTag(n,r){encodeUintValue(n,Type.tag.majorEncoded,r.value)}encodeTag.compareTokens=encodeUint.compareTokens;encodeTag.encodedSize=function(r){return encodeUintValue.encodedSize(r.value)};const MINOR_FALSE=20,MINOR_TRUE=21,MINOR_NULL=22,MINOR_UNDEFINED=23;function decodeUndefined(n,r,_,E){if(E.allowUndefined===!1)throw new Error(`${decodeErrPrefix} undefined values are not supported`);return E.coerceUndefinedToNull===!0?new Token(Type.null,null,1):new Token(Type.undefined,void 0,1)}function decodeBreak(n,r,_,E){if(E.allowIndefinite===!1)throw new Error(`${decodeErrPrefix} indefinite length items not allowed`);return new Token(Type.break,void 0,1)}function createToken(n,r,_){if(_){if(_.allowNaN===!1&&Number.isNaN(n))throw new Error(`${decodeErrPrefix} NaN values are not supported`);if(_.allowInfinity===!1&&(n===1/0||n===-1/0))throw new Error(`${decodeErrPrefix} Infinity values are not supported`)}return new Token(Type.float,n,r)}function decodeFloat16(n,r,_,E){return createToken(readFloat16(n,r+1),3,E)}function decodeFloat32(n,r,_,E){return createToken(readFloat32(n,r+1),5,E)}function decodeFloat64(n,r,_,E){return createToken(readFloat64(n,r+1),9,E)}function encodeFloat(n,r,_){const E=r.value;if(E===!1)n.push([Type.float.majorEncoded|MINOR_FALSE]);else if(E===!0)n.push([Type.float.majorEncoded|MINOR_TRUE]);else if(E===null)n.push([Type.float.majorEncoded|MINOR_NULL]);else if(E===void 0)n.push([Type.float.majorEncoded|MINOR_UNDEFINED]);else{let S,C=!1;(!_||_.float64!==!0)&&(encodeFloat16(E),S=readFloat16(ui8a,1),E===S||Number.isNaN(E)?(ui8a[0]=249,n.push(ui8a.slice(0,3)),C=!0):(encodeFloat32(E),S=readFloat32(ui8a,1),E===S&&(ui8a[0]=250,n.push(ui8a.slice(0,5)),C=!0))),C||(encodeFloat64(E),S=readFloat64(ui8a,1),ui8a[0]=251,n.push(ui8a.slice(0,9)))}}encodeFloat.encodedSize=function(r,_){const E=r.value;if(E===!1||E===!0||E===null||E===void 0)return 1;if(!_||_.float64!==!0){encodeFloat16(E);let S=readFloat16(ui8a,1);if(E===S||Number.isNaN(E))return 3;if(encodeFloat32(E),S=readFloat32(ui8a,1),E===S)return 5}return 9};const buffer$1=new ArrayBuffer(9),dataView=new DataView(buffer$1,1),ui8a=new Uint8Array(buffer$1,0);function encodeFloat16(n){if(n===1/0)dataView.setUint16(0,31744,!1);else if(n===-1/0)dataView.setUint16(0,64512,!1);else if(Number.isNaN(n))dataView.setUint16(0,32256,!1);else{dataView.setFloat32(0,n);const r=dataView.getUint32(0),_=(r&2139095040)>>23,E=r&8388607;if(_===255)dataView.setUint16(0,31744,!1);else if(_===0)dataView.setUint16(0,(n&2147483648)>>16|E>>13,!1);else{const S=_-127;S<-24?dataView.setUint16(0,0):S<-14?dataView.setUint16(0,(r&2147483648)>>16|1<<24+S,!1):dataView.setUint16(0,(r&2147483648)>>16|S+15<<10|E>>13,!1)}}}function readFloat16(n,r){if(n.length-r<2)throw new Error(`${decodeErrPrefix} not enough data for float16`);const _=(n[r]<<8)+n[r+1];if(_===31744)return 1/0;if(_===64512)return-1/0;if(_===32256)return NaN;const E=_>>10&31,S=_&1023;let C;return E===0?C=S*2**-24:E!==31?C=(S+1024)*2**(E-25):C=S===0?1/0:NaN,_&32768?-C:C}function encodeFloat32(n){dataView.setFloat32(0,n,!1)}function readFloat32(n,r){if(n.length-r<4)throw new Error(`${decodeErrPrefix} not enough data for float32`);const _=(n.byteOffset||0)+r;return new DataView(n.buffer,_,4).getFloat32(0,!1)}function encodeFloat64(n){dataView.setFloat64(0,n,!1)}function readFloat64(n,r){if(n.length-r<8)throw new Error(`${decodeErrPrefix} not enough data for float64`);const _=(n.byteOffset||0)+r;return new DataView(n.buffer,_,8).getFloat64(0,!1)}encodeFloat.compareTokens=encodeUint.compareTokens;function invalidMinor(n,r,_){throw new Error(`${decodeErrPrefix} encountered invalid minor (${_}) for major ${n[r]>>>5}`)}function errorer(n){return()=>{throw new Error(`${decodeErrPrefix} ${n}`)}}const jump=[];for(let n=0;n<=23;n++)jump[n]=invalidMinor;jump[24]=decodeUint8;jump[25]=decodeUint16;jump[26]=decodeUint32;jump[27]=decodeUint64;jump[28]=invalidMinor;jump[29]=invalidMinor;jump[30]=invalidMinor;jump[31]=invalidMinor;for(let n=32;n<=55;n++)jump[n]=invalidMinor;jump[56]=decodeNegint8;jump[57]=decodeNegint16;jump[58]=decodeNegint32;jump[59]=decodeNegint64;jump[60]=invalidMinor;jump[61]=invalidMinor;jump[62]=invalidMinor;jump[63]=invalidMinor;for(let n=64;n<=87;n++)jump[n]=decodeBytesCompact;jump[88]=decodeBytes8;jump[89]=decodeBytes16;jump[90]=decodeBytes32;jump[91]=decodeBytes64;jump[92]=invalidMinor;jump[93]=invalidMinor;jump[94]=invalidMinor;jump[95]=errorer("indefinite length bytes/strings are not supported");for(let n=96;n<=119;n++)jump[n]=decodeStringCompact;jump[120]=decodeString8;jump[121]=decodeString16;jump[122]=decodeString32;jump[123]=decodeString64;jump[124]=invalidMinor;jump[125]=invalidMinor;jump[126]=invalidMinor;jump[127]=errorer("indefinite length bytes/strings are not supported");for(let n=128;n<=151;n++)jump[n]=decodeArrayCompact;jump[152]=decodeArray8;jump[153]=decodeArray16;jump[154]=decodeArray32;jump[155]=decodeArray64;jump[156]=invalidMinor;jump[157]=invalidMinor;jump[158]=invalidMinor;jump[159]=decodeArrayIndefinite;for(let n=160;n<=183;n++)jump[n]=decodeMapCompact;jump[184]=decodeMap8;jump[185]=decodeMap16;jump[186]=decodeMap32;jump[187]=decodeMap64;jump[188]=invalidMinor;jump[189]=invalidMinor;jump[190]=invalidMinor;jump[191]=decodeMapIndefinite;for(let n=192;n<=215;n++)jump[n]=decodeTagCompact;jump[216]=decodeTag8;jump[217]=decodeTag16;jump[218]=decodeTag32;jump[219]=decodeTag64;jump[220]=invalidMinor;jump[221]=invalidMinor;jump[222]=invalidMinor;jump[223]=invalidMinor;for(let n=224;n<=243;n++)jump[n]=errorer("simple values are not supported");jump[244]=invalidMinor;jump[245]=invalidMinor;jump[246]=invalidMinor;jump[247]=decodeUndefined;jump[248]=errorer("simple values are not supported");jump[249]=decodeFloat16;jump[250]=decodeFloat32;jump[251]=decodeFloat64;jump[252]=invalidMinor;jump[253]=invalidMinor;jump[254]=invalidMinor;jump[255]=decodeBreak;const quick=[];for(let n=0;n<24;n++)quick[n]=new Token(Type.uint,n,1);for(let n=-1;n>=-24;n--)quick[31-n]=new Token(Type.negint,n,1);quick[64]=new Token(Type.bytes,new Uint8Array(0),1);quick[96]=new Token(Type.string,"",1);quick[128]=new Token(Type.array,0,1);quick[160]=new Token(Type.map,0,1);quick[244]=new Token(Type.false,!1,1);quick[245]=new Token(Type.true,!0,1);quick[246]=new Token(Type.null,null,1);function quickEncodeToken(n){switch(n.type){case Type.false:return fromArray([244]);case Type.true:return fromArray([245]);case Type.null:return fromArray([246]);case Type.bytes:return n.value.length?void 0:fromArray([64]);case Type.string:return n.value===""?fromArray([96]):void 0;case Type.array:return n.value===0?fromArray([128]):void 0;case Type.map:return n.value===0?fromArray([160]):void 0;case Type.uint:return n.value<24?fromArray([Number(n.value)]):void 0;case Type.negint:if(n.value>=-24)return fromArray([31-Number(n.value)])}}const defaultEncodeOptions={float64:!1,mapSorter,quickEncodeToken};function makeCborEncoders(){const n=[];return n[Type.uint.major]=encodeUint,n[Type.negint.major]=encodeNegint,n[Type.bytes.major]=encodeBytes,n[Type.string.major]=encodeString,n[Type.array.major]=encodeArray,n[Type.map.major]=encodeMap,n[Type.tag.major]=encodeTag,n[Type.float.major]=encodeFloat,n}const cborEncoders=makeCborEncoders(),buf=new Bl;class Ref{constructor(r,_){this.obj=r,this.parent=_}includes(r){let _=this;do if(_.obj===r)return!0;while(_=_.parent);return!1}static createCheck(r,_){if(r&&r.includes(_))throw new Error(`${encodeErrPrefix} object contains circular references`);return new Ref(_,r)}}const simpleTokens={null:new Token(Type.null,null),undefined:new Token(Type.undefined,void 0),true:new Token(Type.true,!0),false:new Token(Type.false,!1),emptyArray:new Token(Type.array,0),emptyMap:new Token(Type.map,0)},typeEncoders={number(n,r,_,E){return!Number.isInteger(n)||!Number.isSafeInteger(n)?new Token(Type.float,n):n>=0?new Token(Type.uint,n):new Token(Type.negint,n)},bigint(n,r,_,E){return n>=BigInt(0)?new Token(Type.uint,n):new Token(Type.negint,n)},Uint8Array(n,r,_,E){return new Token(Type.bytes,n)},string(n,r,_,E){return new Token(Type.string,n)},boolean(n,r,_,E){return n?simpleTokens.true:simpleTokens.false},null(n,r,_,E){return simpleTokens.null},undefined(n,r,_,E){return simpleTokens.undefined},ArrayBuffer(n,r,_,E){return new Token(Type.bytes,new Uint8Array(n))},DataView(n,r,_,E){return new Token(Type.bytes,new Uint8Array(n.buffer,n.byteOffset,n.byteLength))},Array(n,r,_,E){if(!n.length)return _.addBreakTokens===!0?[simpleTokens.emptyArray,new Token(Type.break)]:simpleTokens.emptyArray;E=Ref.createCheck(E,n);const S=[];let C=0;for(const A of n)S[C++]=objectToTokens(A,_,E);return _.addBreakTokens?[new Token(Type.array,n.length),S,new Token(Type.break)]:[new Token(Type.array,n.length),S]},Object(n,r,_,E){const S=r!=="Object",C=S?n.keys():Object.keys(n),A=S?n.size:C.length;if(!A)return _.addBreakTokens===!0?[simpleTokens.emptyMap,new Token(Type.break)]:simpleTokens.emptyMap;E=Ref.createCheck(E,n);const I=[];let B=0;for(const O of C)I[B++]=[objectToTokens(O,_,E),objectToTokens(S?n.get(O):n[O],_,E)];return sortMapEntries(I,_),_.addBreakTokens?[new Token(Type.map,A),I,new Token(Type.break)]:[new Token(Type.map,A),I]}};typeEncoders.Map=typeEncoders.Object;typeEncoders.Buffer=typeEncoders.Uint8Array;for(const n of"Uint8Clamped Uint16 Uint32 Int8 Int16 Int32 BigUint64 BigInt64 Float32 Float64".split(" "))typeEncoders[`${n}Array`]=typeEncoders.DataView;function objectToTokens(n,r={},_){const E=is(n),S=r&&r.typeEncoders&&r.typeEncoders[E]||typeEncoders[E];if(typeof S=="function"){const A=S(n,E,r,_);if(A!=null)return A}const C=typeEncoders[E];if(!C)throw new Error(`${encodeErrPrefix} unsupported type: ${E}`);return C(n,E,r,_)}function sortMapEntries(n,r){r.mapSorter&&n.sort(r.mapSorter)}function mapSorter(n,r){const _=Array.isArray(n[0])?n[0][0]:n[0],E=Array.isArray(r[0])?r[0][0]:r[0];if(_.type!==E.type)return _.type.compare(E.type);const S=_.type.major,C=cborEncoders[S].compareTokens(_,E);return C===0&&console.warn("WARNING: complex key types used, CBOR key sorting guarantees are gone"),C}function tokensToEncoded(n,r,_,E){if(Array.isArray(r))for(const S of r)tokensToEncoded(n,S,_,E);else _[r.type.major](n,r,E)}function encodeCustom(n,r,_){const E=objectToTokens(n,_);if(!Array.isArray(E)&&_.quickEncodeToken){const S=_.quickEncodeToken(E);if(S)return S;const C=r[E.type.major];if(C.encodedSize){const A=C.encodedSize(E,_),I=new Bl(A);if(C(I,E,_),I.chunks.length!==1)throw new Error(`Unexpected error: pre-calculated length for ${E} was wrong`);return asU8A(I.chunks[0])}}return buf.reset(),tokensToEncoded(buf,E,r,_),buf.toBytes(!0)}function encode$j(n,r){return r=Object.assign({},defaultEncodeOptions,r),encodeCustom(n,cborEncoders,r)}const defaultDecodeOptions={strict:!1,allowIndefinite:!0,allowUndefined:!0,allowBigInt:!0};class Tokeniser{constructor(r,_={}){this._pos=0,this.data=r,this.options=_}pos(){return this._pos}done(){return this._pos>=this.data.length}next(){const r=this.data[this._pos];let _=quick[r];if(_===void 0){const E=jump[r];if(!E)throw new Error(`${decodeErrPrefix} no decoder for major type ${r>>>5} (byte 0x${r.toString(16).padStart(2,"0")})`);const S=r&31;_=E(this.data,this._pos,S,this.options)}return this._pos+=_.encodedLength,_}}const DONE=Symbol.for("DONE"),BREAK=Symbol.for("BREAK");function tokenToArray(n,r,_){const E=[];for(let S=0;S<n.value;S++){const C=tokensToObject(r,_);if(C===BREAK){if(n.value===1/0)break;throw new Error(`${decodeErrPrefix} got unexpected break to lengthed array`)}if(C===DONE)throw new Error(`${decodeErrPrefix} found array but not enough entries (got ${S}, expected ${n.value})`);E[S]=C}return E}function tokenToMap(n,r,_){const E=_.useMaps===!0,S=E?void 0:{},C=E?new Map:void 0;for(let A=0;A<n.value;A++){const I=tokensToObject(r,_);if(I===BREAK){if(n.value===1/0)break;throw new Error(`${decodeErrPrefix} got unexpected break to lengthed map`)}if(I===DONE)throw new Error(`${decodeErrPrefix} found map but not enough entries (got ${A} [no key], expected ${n.value})`);if(E!==!0&&typeof I!="string")throw new Error(`${decodeErrPrefix} non-string keys not supported (got ${typeof I})`);if(_.rejectDuplicateMapKeys===!0&&(E&&C.has(I)||!E&&I in S))throw new Error(`${decodeErrPrefix} found repeat map key "${I}"`);const B=tokensToObject(r,_);if(B===DONE)throw new Error(`${decodeErrPrefix} found map but not enough entries (got ${A} [no value], expected ${n.value})`);E?C.set(I,B):S[I]=B}return E?C:S}function tokensToObject(n,r){if(n.done())return DONE;const _=n.next();if(_.type===Type.break)return BREAK;if(_.type.terminal)return _.value;if(_.type===Type.array)return tokenToArray(_,n,r);if(_.type===Type.map)return tokenToMap(_,n,r);if(_.type===Type.tag){if(r.tags&&typeof r.tags[_.value]=="function"){const E=tokensToObject(n,r);return r.tags[_.value](E)}throw new Error(`${decodeErrPrefix} tag not supported (${_.value})`)}throw new Error("unsupported")}function decodeFirst(n,r){if(!(n instanceof Uint8Array))throw new Error(`${decodeErrPrefix} data to decode must be a Uint8Array`);r=Object.assign({},defaultDecodeOptions,r);const _=r.tokenizer||new Tokeniser(n,r),E=tokensToObject(_,r);if(E===DONE)throw new Error(`${decodeErrPrefix} did not find any content to decode`);if(E===BREAK)throw new Error(`${decodeErrPrefix} got unexpected break`);return[E,n.subarray(_.pos())]}function decode$l(n,r){const[_,E]=decodeFirst(n,r);if(E.length>0)throw new Error(`${decodeErrPrefix} too many terminals, data makes no sense`);return _}const empty=new Uint8Array(0);function fromHex(n){const r=n.match(/../g);return r!=null?new Uint8Array(r.map(_=>parseInt(_,16))):empty}function equals$3(n,r){if(n===r)return!0;if(n.byteLength!==r.byteLength)return!1;for(let _=0;_<n.byteLength;_++)if(n[_]!==r[_])return!1;return!0}function coerce(n){if(n instanceof Uint8Array&&n.constructor.name==="Uint8Array")return n;if(n instanceof ArrayBuffer)return new Uint8Array(n);if(ArrayBuffer.isView(n))return new Uint8Array(n.buffer,n.byteOffset,n.byteLength);throw new Error("Unknown type, must be binary type")}function fromString$4(n){return new TextEncoder().encode(n)}function toString$5(n){return new TextDecoder().decode(n)}function base$5(n,r){if(n.length>=255)throw new TypeError("Alphabet too long");for(var _=new Uint8Array(256),E=0;E<_.length;E++)_[E]=255;for(var S=0;S<n.length;S++){var C=n.charAt(S),A=C.charCodeAt(0);if(_[A]!==255)throw new TypeError(C+" is ambiguous");_[A]=S}var I=n.length,B=n.charAt(0),O=Math.log(I)/Math.log(256),N=Math.log(256)/Math.log(I);function U(Z){if(Z instanceof Uint8Array||(ArrayBuffer.isView(Z)?Z=new Uint8Array(Z.buffer,Z.byteOffset,Z.byteLength):Array.isArray(Z)&&(Z=Uint8Array.from(Z))),!(Z instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(Z.length===0)return"";for(var X=0,Q=0,se=0,oe=Z.length;se!==oe&&Z[se]===0;)se++,X++;for(var ue=(oe-se)*N+1>>>0,we=new Uint8Array(ue);se!==oe;){for(var Te=Z[se],xe=0,Re=ue-1;(Te!==0||xe<Q)&&Re!==-1;Re--,xe++)Te+=256*we[Re]>>>0,we[Re]=Te%I>>>0,Te=Te/I>>>0;if(Te!==0)throw new Error("Non-zero carry");Q=xe,se++}for(var Ne=ue-Q;Ne!==ue&&we[Ne]===0;)Ne++;for(var Fe=B.repeat(X);Ne<ue;++Ne)Fe+=n.charAt(we[Ne]);return Fe}function j(Z){if(typeof Z!="string")throw new TypeError("Expected String");if(Z.length===0)return new Uint8Array;var X=0;if(Z[X]!==" "){for(var Q=0,se=0;Z[X]===B;)Q++,X++;for(var oe=(Z.length-X)*O+1>>>0,ue=new Uint8Array(oe);Z[X];){var we=_[Z.charCodeAt(X)];if(we===255)return;for(var Te=0,xe=oe-1;(we!==0||Te<se)&&xe!==-1;xe--,Te++)we+=I*ue[xe]>>>0,ue[xe]=we%256>>>0,we=we/256>>>0;if(we!==0)throw new Error("Non-zero carry");se=Te,X++}if(Z[X]!==" "){for(var Re=oe-se;Re!==oe&&ue[Re]===0;)Re++;for(var Ne=new Uint8Array(Q+(oe-Re)),Fe=Q;Re!==oe;)Ne[Fe++]=ue[Re++];return Ne}}}function z(Z){var X=j(Z);if(X)return X;throw new Error(`Non-${r} character`)}return{encode:U,decodeUnsafe:j,decode:z}}var src$4=base$5,_brrp__multiformats_scope_baseX=src$4;let Encoder$1=class{name;prefix;baseEncode;constructor(r,_,E){this.name=r,this.prefix=_,this.baseEncode=E}encode(r){if(r instanceof Uint8Array)return`${this.prefix}${this.baseEncode(r)}`;throw Error("Unknown type, must be binary type")}},Decoder$2=class{name;prefix;baseDecode;prefixCodePoint;constructor(r,_,E){if(this.name=r,this.prefix=_,_.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=_.codePointAt(0),this.baseDecode=E}decode(r){if(typeof r=="string"){if(r.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(r)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(r.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(r){return or$2(this,r)}};class ComposedDecoder{decoders;constructor(r){this.decoders=r}or(r){return or$2(this,r)}decode(r){const _=r[0],E=this.decoders[_];if(E!=null)return E.decode(r);throw RangeError(`Unable to decode multibase string ${JSON.stringify(r)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}function or$2(n,r){return new ComposedDecoder({...n.decoders??{[n.prefix]:n},...r.decoders??{[r.prefix]:r}})}class Codec{name;prefix;baseEncode;baseDecode;encoder;decoder;constructor(r,_,E,S){this.name=r,this.prefix=_,this.baseEncode=E,this.baseDecode=S,this.encoder=new Encoder$1(r,_,E),this.decoder=new Decoder$2(r,_,S)}encode(r){return this.encoder.encode(r)}decode(r){return this.decoder.decode(r)}}function from$2({name:n,prefix:r,encode:_,decode:E}){return new Codec(n,r,_,E)}function baseX$1({name:n,prefix:r,alphabet:_}){const{encode:E,decode:S}=_brrp__multiformats_scope_baseX(_,n);return from$2({prefix:r,name:n,encode:E,decode:C=>coerce(S(C))})}function decode$k(n,r,_,E){const S={};for(let N=0;N<r.length;++N)S[r[N]]=N;let C=n.length;for(;n[C-1]==="=";)--C;const A=new Uint8Array(C*_/8|0);let I=0,B=0,O=0;for(let N=0;N<C;++N){const U=S[n[N]];if(U===void 0)throw new SyntaxError(`Non-${E} character`);B=B<<_|U,I+=_,I>=8&&(I-=8,A[O++]=255&B>>I)}if(I>=_||255&B<<8-I)throw new SyntaxError("Unexpected end of data");return A}function encode$i(n,r,_){const E=r[r.length-1]==="=",S=(1<<_)-1;let C="",A=0,I=0;for(let B=0;B<n.length;++B)for(I=I<<8|n[B],A+=8;A>_;)A-=_,C+=r[S&I>>A];if(A!==0&&(C+=r[S&I<<_-A]),E)for(;C.length*_&7;)C+="=";return C}function rfc4648$2({name:n,prefix:r,bitsPerChar:_,alphabet:E}){return from$2({prefix:r,name:n,encode(S){return encode$i(S,E,_)},decode(S){return decode$k(S,E,_,n)}})}const base32=rfc4648$2({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),base32upper=rfc4648$2({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),base32pad=rfc4648$2({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),base32padupper=rfc4648$2({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),base32hex=rfc4648$2({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),base32hexupper=rfc4648$2({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),base32hexpad=rfc4648$2({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),base32hexpadupper=rfc4648$2({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),base32z=rfc4648$2({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),base32$1=Object.freeze(Object.defineProperty({__proto__:null,base32,base32hex,base32hexpad,base32hexpadupper,base32hexupper,base32pad,base32padupper,base32upper,base32z},Symbol.toStringTag,{value:"Module"})),base58btc=baseX$1({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),base58flickr=baseX$1({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),base58=Object.freeze(Object.defineProperty({__proto__:null,base58btc,base58flickr},Symbol.toStringTag,{value:"Module"}));var encode_1$2=encode$h,MSB$6=128,REST$6=127,MSBALL$2=~REST$6,INT$2=Math.pow(2,31);function encode$h(n,r,_){r=r||[],_=_||0;for(var E=_;n>=INT$2;)r[_++]=n&255|MSB$6,n/=128;for(;n&MSBALL$2;)r[_++]=n&255|MSB$6,n>>>=7;return r[_]=n|0,encode$h.bytes=_-E+1,r}var decode$j=read$4,MSB$1$1=128,REST$1$1=127;function read$4(n,E){var _=0,E=E||0,S=0,C=E,A,I=n.length;do{if(C>=I)throw read$4.bytes=0,new RangeError("Could not decode varint");A=n[C++],_+=S<28?(A&REST$1$1)<<S:(A&REST$1$1)*Math.pow(2,S),S+=7}while(A>=MSB$1$1);return read$4.bytes=C-E,_}var N1$3=Math.pow(2,7),N2$3=Math.pow(2,14),N3$3=Math.pow(2,21),N4$3=Math.pow(2,28),N5$3=Math.pow(2,35),N6$3=Math.pow(2,42),N7$3=Math.pow(2,49),N8$2=Math.pow(2,56),N9$2=Math.pow(2,63),length$4=function(n){return n<N1$3?1:n<N2$3?2:n<N3$3?3:n<N4$3?4:n<N5$3?5:n<N6$3?6:n<N7$3?7:n<N8$2?8:n<N9$2?9:10},varint$4={encode:encode_1$2,decode:decode$j,encodingLength:length$4},_brrp_varint=varint$4;function decode$i(n,r=0){return[_brrp_varint.decode(n,r),_brrp_varint.decode.bytes]}function encodeTo(n,r,_=0){return _brrp_varint.encode(n,r,_),r}function encodingLength$1(n){return _brrp_varint.encodingLength(n)}function create$4(n,r){const _=r.byteLength,E=encodingLength$1(n),S=E+encodingLength$1(_),C=new Uint8Array(S+_);return encodeTo(n,C,0),encodeTo(_,C,E),C.set(r,S),new Digest(n,_,r,C)}function decode$h(n){const r=coerce(n),[_,E]=decode$i(r),[S,C]=decode$i(r.subarray(E)),A=r.subarray(E+C);if(A.byteLength!==S)throw new Error("Incorrect length");return new Digest(_,S,A,r)}function equals$2(n,r){if(n===r)return!0;{const _=r;return n.code===_.code&&n.size===_.size&&_.bytes instanceof Uint8Array&&equals$3(n.bytes,_.bytes)}}class Digest{code;size;digest;bytes;constructor(r,_,E,S){this.code=r,this.size=_,this.digest=E,this.bytes=S}}function format$3(n,r){const{bytes:_,version:E}=n;switch(E){case 0:return toStringV0(_,baseCache(n),r??base58btc.encoder);default:return toStringV1(_,baseCache(n),r??base32.encoder)}}const cache$2=new WeakMap;function baseCache(n){const r=cache$2.get(n);if(r==null){const _=new Map;return cache$2.set(n,_),_}return r}class CID{code;version;multihash;bytes;"/";constructor(r,_,E,S){this.code=_,this.version=r,this.multihash=E,this.bytes=S,this["/"]=S}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{const{code:r,multihash:_}=this;if(r!==DAG_PB_CODE)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(_.code!==SHA_256_CODE)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return CID.createV0(_)}default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}toV1(){switch(this.version){case 0:{const{code:r,digest:_}=this.multihash,E=create$4(r,_);return CID.createV1(this.code,E)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 1. This is a bug please report`)}}equals(r){return CID.equals(this,r)}static equals(r,_){const E=_;return E!=null&&r.code===E.code&&r.version===E.version&&equals$2(r.multihash,E.multihash)}toString(r){return format$3(this,r)}toJSON(){return{"/":format$3(this)}}link(){return this}[Symbol.toStringTag]="CID";[Symbol.for("nodejs.util.inspect.custom")](){return`CID(${this.toString()})`}static asCID(r){if(r==null)return null;const _=r;if(_ instanceof CID)return _;if(_["/"]!=null&&_["/"]===_.bytes||_.asCID===_){const{version:E,code:S,multihash:C,bytes:A}=_;return new CID(E,S,C,A??encodeCID(E,S,C.bytes))}else if(_[cidSymbol]===!0){const{version:E,multihash:S,code:C}=_,A=decode$h(S);return CID.create(E,C,A)}else return null}static create(r,_,E){if(typeof _!="number")throw new Error("String codecs are no longer supported");if(!(E.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(r){case 0:{if(_!==DAG_PB_CODE)throw new Error(`Version 0 CID must use dag-pb (code: ${DAG_PB_CODE}) block encoding`);return new CID(r,_,E,E.bytes)}case 1:{const S=encodeCID(r,_,E.bytes);return new CID(r,_,E,S)}default:throw new Error("Invalid version")}}static createV0(r){return CID.create(0,DAG_PB_CODE,r)}static createV1(r,_){return CID.create(1,r,_)}static decode(r){const[_,E]=CID.decodeFirst(r);if(E.length!==0)throw new Error("Incorrect length");return _}static decodeFirst(r){const _=CID.inspectBytes(r),E=_.size-_.multihashSize,S=coerce(r.subarray(E,E+_.multihashSize));if(S.byteLength!==_.multihashSize)throw new Error("Incorrect length");const C=S.subarray(_.multihashSize-_.digestSize),A=new Digest(_.multihashCode,_.digestSize,C,S);return[_.version===0?CID.createV0(A):CID.createV1(_.codec,A),r.subarray(_.size)]}static inspectBytes(r){let _=0;const E=()=>{const[U,j]=decode$i(r.subarray(_));return _+=j,U};let S=E(),C=DAG_PB_CODE;if(S===18?(S=0,_=0):C=E(),S!==0&&S!==1)throw new RangeError(`Invalid CID version ${S}`);const A=_,I=E(),B=E(),O=_+B,N=O-A;return{version:S,codec:C,multihashCode:I,digestSize:B,multihashSize:N,size:O}}static parse(r,_){const[E,S]=parseCIDtoBytes(r,_),C=CID.decode(S);if(C.version===0&&r[0]!=="Q")throw Error("Version 0 CID string must not include multibase prefix");return baseCache(C).set(E,r),C}}function parseCIDtoBytes(n,r){switch(n[0]){case"Q":{const _=r??base58btc;return[base58btc.prefix,_.decode(`${base58btc.prefix}${n}`)]}case base58btc.prefix:{const _=r??base58btc;return[base58btc.prefix,_.decode(n)]}case base32.prefix:{const _=r??base32;return[base32.prefix,_.decode(n)]}default:{if(r==null)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[n[0],r.decode(n)]}}}function toStringV0(n,r,_){const{prefix:E}=_;if(E!==base58btc.prefix)throw Error(`Cannot string encode V0 in ${_.name} encoding`);const S=r.get(E);if(S==null){const C=_.encode(n).slice(1);return r.set(E,C),C}else return S}function toStringV1(n,r,_){const{prefix:E}=_,S=r.get(E);if(S==null){const C=_.encode(n);return r.set(E,C),C}else return S}const DAG_PB_CODE=112,SHA_256_CODE=18;function encodeCID(n,r,_){const E=encodingLength$1(n),S=E+encodingLength$1(r),C=new Uint8Array(S+_.byteLength);return encodeTo(n,C,0),encodeTo(r,C,E),C.set(_,S),C}const cidSymbol=Symbol.for("@ipld/js-cid/CID"),CID_CBOR_TAG=42;function toByteView$2(n){return n instanceof ArrayBuffer?new Uint8Array(n,0,n.byteLength):n}function cidEncoder(n){if(n.asCID!==n&&n["/"]!==n.bytes)return null;const r=CID.asCID(n);if(!r)return null;const _=new Uint8Array(r.bytes.byteLength+1);return _.set(r.bytes,1),[new Token(Type.tag,CID_CBOR_TAG),new Token(Type.bytes,_)]}function undefinedEncoder(){throw new Error("`undefined` is not supported by the IPLD Data Model and cannot be encoded")}function numberEncoder(n){if(Number.isNaN(n))throw new Error("`NaN` is not supported by the IPLD Data Model and cannot be encoded");if(n===1/0||n===-1/0)throw new Error("`Infinity` and `-Infinity` is not supported by the IPLD Data Model and cannot be encoded");return null}const _encodeOptions={float64:!0,typeEncoders:{Object:cidEncoder,undefined:undefinedEncoder,number:numberEncoder}},encodeOptions={..._encodeOptions,typeEncoders:{..._encodeOptions.typeEncoders}};function cidDecoder(n){if(n[0]!==0)throw new Error("Invalid CID for CBOR tag 42; expected leading 0x00");return CID.decode(n.subarray(1))}const _decodeOptions={allowIndefinite:!1,coerceUndefinedToNull:!0,allowNaN:!1,allowInfinity:!1,allowBigInt:!0,strict:!0,useMaps:!1,rejectDuplicateMapKeys:!0,tags:[]};_decodeOptions.tags[CID_CBOR_TAG]=cidDecoder;const decodeOptions$1={..._decodeOptions,tags:_decodeOptions.tags.slice()},name$7="dag-cbor",code$8=113,encode$g=n=>encode$j(n,_encodeOptions),decode$g=n=>decode$l(toByteView$2(n),_decodeOptions),dagCbor=Object.freeze(Object.defineProperty({__proto__:null,code:code$8,decode:decode$g,decodeOptions:decodeOptions$1,encode:encode$g,encodeOptions,name:name$7,toByteView:toByteView$2},Symbol.toStringTag,{value:"Module"})),sha$3=n=>async r=>new Uint8Array(await crypto.subtle.digest(n,r)),sha256$7=from$3({name:"sha2-256",code:18,encode:sha$3("SHA-256")}),codec$5=dagCbor,hasher$5=sha256$7,hashStringEncoding$5=base58btc$1,create$3=async(n,r,_,E=null,S=[],C=[])=>{if(n==null)throw new Error("Identity is required, cannot create entry");if(r==null)throw new Error("Entry requires an id");if(_==null)throw new Error("Entry requires a payload");if(S==null||!Array.isArray(S))throw new Error("'next' argument is not an array");E=E||Clock(n.publicKey);const A={id:r,payload:_,next:S,refs:C,clock:E,v:2},{bytes:I}=await encode$k({value:A,codec:codec$5,hasher:hasher$5}),B=await n.sign(n,I);return A.key=n.publicKey,A.identity=n.hash,A.sig=B,encode$f(A)},verify=async(n,r)=>{if(!n)throw new Error("Identities is required, cannot verify entry");if(!isEntry(r))throw new Error("Invalid Log entry");if(!r.key)throw new Error("Entry doesn't have a key");if(!r.sig)throw new Error("Entry doesn't have a signature");const _={id:r.id,payload:r.payload,next:r.next,refs:r.refs,clock:r.clock,v:r.v},{bytes:E}=await encode$k({value:_,codec:codec$5,hasher:hasher$5});return n.verify(r.sig,r.key,E)},isEntry=n=>n&&n.id!==void 0&&n.next!==void 0&&n.payload!==void 0&&n.v!==void 0&&n.clock!==void 0&&n.refs!==void 0,isEqual$1=(n,r)=>n&&r&&n.hash===r.hash,decode$f=async n=>{const{value:r}=await decode$m({bytes:n,codec:codec$5,hasher:hasher$5});return encode$f(r)},encode$f=async n=>{const{cid:r,bytes:_}=await encode$k({value:n,codec:codec$5,hasher:hasher$5}),E=r.toString(hashStringEncoding$5),S=Clock(n.clock.id,n.clock.time);return{...n,clock:S,hash:E,bytes:_}},Entry={create:create$3,verify,decode:decode$f,encode:encode$f,isEntry,isEqual:isEqual$1},MemoryStorage$1=async()=>{let n={};const r=async(B,O)=>{n[B]=O};return{put:r,del:async B=>{delete n[B]},get:async B=>n[B],iterator:async function*(){for await(const[B,O]of Object.entries(n))yield[B,O]},merge:async B=>{if(B)for await(const[O,N]of B.iterator())r(O,N)},clear:async()=>{n={}},close:async()=>{}}},DefaultStorage$1=MemoryStorage$1,Heads=async({storage:n,heads:r})=>{n=n||await DefaultStorage$1();const _=async N=>{N=findHeads(N);for(const U of N)await n.put(U.hash,U.bytes)},E=async N=>{await n.clear(),await _(N)},S=async N=>{const U=await I();if(U.find(z=>Entry.isEqual(z,N)))return;const j=findHeads([...U,N]);return await E(j),j},C=async N=>{const j=(await I()).filter(z=>z.hash!==N);await E(j)},A=async function*(){const N=n.iterator();for await(const[,U]of N)yield await Entry.decode(U)},I=async()=>{const N=[];for await(const U of A())N.push(U);return N},B=async()=>{await n.clear()},O=async()=>{await n.close()};return await _(r||[]),{put:_,set:E,add:S,remove:C,iterator:A,all:I,clear:B,close:O}},findHeads=n=>{n=new Set(n);const r={};for(const E of n)for(const S of E.next)r[S]=E.hash;const _=[];for(const E of n)r[E.hash]||_.push(E);return _};function LastWriteWins$1(n,r){const _=(C,A)=>C,E=(C,A)=>SortByClockId(C,A,_);return((C,A)=>SortByClocks(C,A,E))(n,r)}function SortByClocks(n,r,_){const E=compareClocks(n.clock,r.clock);return E===0?_(n,r):E}function SortByClockId(n,r,_){return n.clock.id===r.clock.id?_(n,r):n.clock.id<r.clock.id?-1:1}function NoZeroes$1(n){const r=`Your log's tiebreaker function, ${n.name}, has returned zero and therefore cannot be`;return(E,S)=>{const C=n(E,S);if(C===0)throw Error(r);return C}}const ConflictResolution={SortByClocks,SortByClockId,LastWriteWins:LastWriteWins$1,NoZeroes:NoZeroes$1},{LastWriteWins,NoZeroes}=ConflictResolution,randomId$1=()=>new Date().getTime().toString(),maxClockTimeReducer=(n,r)=>Math.max(n,r.clock.time),DefaultStorage=MemoryStorage$1,DefaultAccessController$1=async()=>({canAppend:async n=>!0}),Log=async(n,{logId:r,logHeads:_,access:E,entryStorage:S,headsStorage:C,indexStorage:A,sortFn:I}={})=>{if(n==null)throw new Error("Identity is required");if(_!=null&&!Array.isArray(_))throw new Error("'logHeads' argument must be an array");const B=r||randomId$1();E=E||await DefaultAccessController$1();const O=S||await DefaultStorage(),N=A||await DefaultStorage();C=C||await DefaultStorage();const U=await Heads({storage:C,heads:_});I=NoZeroes(I||LastWriteWins);const j=new PQueue$1({concurrency:1}),z=new PQueue$1({concurrency:1}),Z=async()=>{const Ee=Math.max(0,(await X()).reduce(maxClockTimeReducer,0));return Clock(n.publicKey,Ee)},X=async()=>(await U.all()).sort(I).reverse(),Q=async()=>{const Ee=[];for await(const Ce of xe())Ee.unshift(Ce);return Ee},se=async Ee=>{const Ce=await O.get(Ee);if(Ce)return await Entry.decode(Ce)},oe=async Ee=>await N.get(Ee)!=null,ue=async(Ee,Ce={referencesCount:0})=>{const _e=async()=>{const Ie=await X(),He=Ie.map(Ve=>Ve.hash),Be=await nt(Ie,Ce.referencesCount+Ie.length),Ge=await Entry.create(n,B,Ee,tickClock(await Z()),He,Be);if(!await E.canAppend(Ge))throw new Error(`Could not append entry:
Key "${n.hash}" is not allowed to write to the log`);return await U.set([Ge]),await O.put(Ge.hash,Ge.bytes),await N.put(Ge.hash,!0),Ge};return j.add(_e)},we=async Ee=>{if(!Ee)throw new Error("Log instance not defined");if(!ht(Ee))throw new Error("Given argument is not an instance of Log");O.merge&&await O.merge(Ee.storage);const Ce=await Ee.heads();for(const _e of Ce)await Te(_e)},Te=async Ee=>{const Ce=async()=>{if(await oe(Ee.hash))return!1;const Ie=async Pe=>{if(Pe.id!==B)throw new Error(`Entry's id (${Pe.id}) doesn't match the log's id (${B}).`);if(!await E.canAppend(Pe))throw new Error(`Could not append entry:
Key "${Pe.identity}" is not allowed to write to the log`);if(!await Entry.verify(n,Pe))throw new Error(`Could not validate signature for entry "${Pe.hash}"`)};await Ie(Ee);const He=(await X()).map(Pe=>Pe.hash),Be=new Set([Ee.hash]),Ge=new Set([...Ee.next,...Ee.refs]),je=new Set,Ve=async()=>{const Pe=Array.from(Ge.values()).filter(oe).map(se),Me=await Promise.all(Pe);for(const tt of Me){Ge.delete(tt.hash),await Ie(tt),Be.add(tt.hash);for(const Ke of[...tt.next,...tt.refs])!await oe(Ke)&&!Be.has(Ke)?Ge.add(Ke):He.includes(Ke)&&je.add(Ke)}Ge.size>0&&await Ve()};await Ve();for(const Pe of Be.values())await N.put(Pe,!0);for(const Pe of je.values())await U.remove(Pe);return await U.add(Ee),!0};return z.add(Ce)},xe=async function*(Ee,Ce,_e=!0){Ce=Ce||(()=>!1),Ee=Ee||await X();let He=Ee.sort(I);const Be={};let Ge=[];const je={},Ve=Me=>!(Be[Me]||je[Me]);let Pe;for(;He.length>0;)if(He=He.sort(I),Pe=He.pop(),Pe){const{hash:Me,next:tt,refs:Ke}=Pe;if(!Be[Me]){if(yield Pe,await Ce(Pe)===!0)break;Be[Me]=!0,je[Me]=!0,Ge=[...Ge,...tt,..._e?Ke:[]].filter(Ve);const ct=dt=>{if(!Be[dt]&&!je[dt])return je[dt]=!0,se(dt)},Qe=await Promise.all(Ge.map(ct));Ge=Qe.filter(dt=>dt!=null).reduce((dt,vt)=>Array.from(new Set([...dt,...vt.next,..._e?vt.refs:[]])),[]).filter(Ve),He=[...Qe,...He]}}},Re=async function*({amount:Ee=-1,gt:Ce,gte:_e,lt:Ie,lte:He}={}){if(Ee===0)return;if(typeof He=="string"&&(He=[await se(He)]),typeof Ie=="string"){const ct=await se(Ie);Ie=await Promise.all(ct.next.map(dt=>se(dt)))}if(Ie!=null&&!Array.isArray(Ie))throw new Error("lt must be a string or an array of Entries");if(He!=null&&!Array.isArray(He))throw new Error("lte must be a string or an array of Entries");const Be=(Ie||He||await X()).filter(ct=>ct!=null),Ge=Ce||_e?await se(Ce||_e):null,je=Ge||Ee===-1?-1:Ee;let Ve=0;const Pe=async ct=>(Ve++,ct?!!(Ve>=je&&je!==-1||Ge&&Entry.isEqual(ct,Ge)):!1),Me=Ge&&Ee!==-1&&!Ie&&!He,tt=Me?new LRU$1(Ee+2):null;let Ke=0;const mt=xe(Be,Pe);for await(const ct of mt){const Qe=Ie&&Entry.isEqual(ct,Be),dt=Ce&&Entry.isEqual(ct,Ge);Qe||dt||(Me?tt.set(Ke++,ct.hash):yield ct)}if(Me){const ct=tt.keys.length,Qe=ct>Ee?ct-Ee:0,dt=tt.keys.slice(Qe,ct);for(const vt of dt){const At=tt.get(vt);yield await se(At)}}},Ne=async()=>{await N.clear(),await U.clear(),await O.clear()},Fe=async()=>{await N.close(),await U.close(),await O.close()},ht=Ee=>Ee&&Ee.id!==void 0&&Ee.clock!==void 0&&Ee.heads!==void 0&&Ee.values!==void 0&&Ee.access!==void 0&&Ee.identity!==void 0&&Ee.storage!==void 0,nt=async(Ee,Ce=0)=>{let _e=[];const Ie=async He=>_e.length>=Ce&&Ce!==-1;for await(const{hash:He}of xe(Ee,Ie,!1))_e.push(He);return _e=_e.slice(Ee.length+1,Ce),_e};return{id:B,clock:Z,heads:X,values:Q,all:Q,get:se,has:oe,append:ue,join:we,joinEntry:Te,traverse:xe,iterator:Re,clear:Ne,close:Fe,access:E,identity:n,storage:O}},ComposedStorage=async(n,r)=>({put:async(O,N)=>{await n.put(O,N),await r.put(O,N)},get:async O=>{let N=await n.get(O);return N||(N=await r.get(O),N&&await n.put(O,N)),N},del:async O=>{await n.del(O),await r.del(O)},iterator:async function*(){const O=[];for(const N of[n,r])for await(const[U,j]of N.iterator())O[U]||(O[U]=!0,yield[U,j])},merge:async O=>{await n.merge(O),await r.merge(O),await O.merge(n),await O.merge(r)},clear:async()=>{await n.clear(),await r.clear()},close:async()=>{await n.close(),await r.close()}}),DefaultTimeout=3e4,IPFSBlockStorage=async({ipfs:n,pin:r,timeout:_}={})=>{if(!n)throw new Error("An instance of ipfs is required.");return{put:async(N,U)=>{const j=CID$1.parse(N,base58btc$1),{signal:z}=new timeoutAbortController.TimeoutController(_||DefaultTimeout);await n.blockstore.put(j,U,{signal:z}),r&&!await n.pins.isPinned(j)&&await n.pins.add(j)},del:async N=>{},get:async N=>{const U=CID$1.parse(N,base58btc$1),{signal:j}=new timeoutAbortController.TimeoutController(_||DefaultTimeout),z=await n.blockstore.get(U,{signal:j});if(z)return z},iterator:async function*(){},merge:async N=>{},clear:async()=>{},close:async()=>{}}};var browserLevel={},abstractLevel$1={},abstractLevel={},levelSupports={};levelSupports.supports=function(...r){const _=r.reduce((E,S)=>Object.assign(E,S),{});return Object.assign(_,{snapshots:_.snapshots||!1,permanence:_.permanence||!1,seek:_.seek||!1,clear:_.clear||!1,getMany:_.getMany||!1,keyIterator:_.keyIterator||!1,valueIterator:_.valueIterator||!1,iteratorNextv:_.iteratorNextv||!1,iteratorAll:_.iteratorAll||!1,status:_.status||!1,createIfMissing:_.createIfMissing||!1,errorIfExists:_.errorIfExists||!1,deferredOpen:_.deferredOpen||!1,promises:_.promises||!1,streams:_.streams||!1,encodings:Object.assign({},_.encodings),events:Object.assign({},_.events),additionalMethods:Object.assign({},_.additionalMethods)})};var levelTranscoder={},moduleError=class extends Error{constructor(r,_){super(r||""),typeof _=="object"&&_!==null&&(_.code&&(this.code=String(_.code)),_.expected&&(this.expected=!0),_.transient&&(this.transient=!0),_.cause&&(this.cause=_.cause)),Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor)}},encodings$2={};let lazy=null;var textEndec$1=function(){return lazy===null&&(lazy={textEncoder:new TextEncoder,textDecoder:new TextDecoder}),lazy},formats$2={},encoding={};const ModuleError$8=moduleError,formats$1=new Set(["buffer","view","utf8"]);let Encoding$2=class{constructor(r){if(this.encode=r.encode||this.encode,this.decode=r.decode||this.decode,this.name=r.name||this.name,this.format=r.format||this.format,typeof this.encode!="function")throw new TypeError("The 'encode' property must be a function");if(typeof this.decode!="function")throw new TypeError("The 'decode' property must be a function");if(this.encode=this.encode.bind(this),this.decode=this.decode.bind(this),typeof this.name!="string"||this.name==="")throw new TypeError("The 'name' property must be a string");if(typeof this.format!="string"||!formats$1.has(this.format))throw new TypeError("The 'format' property must be one of 'buffer', 'view', 'utf8'");r.createViewTranscoder&&(this.createViewTranscoder=r.createViewTranscoder),r.createBufferTranscoder&&(this.createBufferTranscoder=r.createBufferTranscoder),r.createUTF8Transcoder&&(this.createUTF8Transcoder=r.createUTF8Transcoder)}get commonName(){return this.name.split("+")[0]}createBufferTranscoder(){throw new ModuleError$8(`Encoding '${this.name}' cannot be transcoded to 'buffer'`,{code:"LEVEL_ENCODING_NOT_SUPPORTED"})}createViewTranscoder(){throw new ModuleError$8(`Encoding '${this.name}' cannot be transcoded to 'view'`,{code:"LEVEL_ENCODING_NOT_SUPPORTED"})}createUTF8Transcoder(){throw new ModuleError$8(`Encoding '${this.name}' cannot be transcoded to 'utf8'`,{code:"LEVEL_ENCODING_NOT_SUPPORTED"})}};encoding.Encoding=Encoding$2;const{Buffer:Buffer$3}=buffer$2||{},{Encoding:Encoding$1}=encoding,textEndec=textEndec$1;let BufferFormat$2=class extends Encoding$1{constructor(r){super({...r,format:"buffer"})}createViewTranscoder(){return new ViewFormat$2({encode:this.encode,decode:r=>this.decode(Buffer$3.from(r.buffer,r.byteOffset,r.byteLength)),name:`${this.name}+view`})}createBufferTranscoder(){return this}},ViewFormat$2=class extends Encoding$1{constructor(r){super({...r,format:"view"})}createBufferTranscoder(){return new BufferFormat$2({encode:r=>{const _=this.encode(r);return Buffer$3.from(_.buffer,_.byteOffset,_.byteLength)},decode:this.decode,name:`${this.name}+buffer`})}createViewTranscoder(){return this}},UTF8Format$2=class extends Encoding$1{constructor(r){super({...r,format:"utf8"})}createBufferTranscoder(){return new BufferFormat$2({encode:r=>Buffer$3.from(this.encode(r),"utf8"),decode:r=>this.decode(r.toString("utf8")),name:`${this.name}+buffer`})}createViewTranscoder(){const{textEncoder:r,textDecoder:_}=textEndec();return new ViewFormat$2({encode:E=>r.encode(this.encode(E)),decode:E=>this.decode(_.decode(E)),name:`${this.name}+view`})}createUTF8Transcoder(){return this}};formats$2.BufferFormat=BufferFormat$2;formats$2.ViewFormat=ViewFormat$2;formats$2.UTF8Format=UTF8Format$2;const{Buffer:Buffer$2}=buffer$2||{Buffer:{isBuffer:()=>!1}},{textEncoder:textEncoder$4,textDecoder:textDecoder$3}=textEndec$1(),{BufferFormat:BufferFormat$1,ViewFormat:ViewFormat$1,UTF8Format:UTF8Format$1}=formats$2,identity$8=n=>n;encodings$2.utf8=new UTF8Format$1({encode:function(n){return Buffer$2.isBuffer(n)?n.toString("utf8"):ArrayBuffer.isView(n)?textDecoder$3.decode(n):String(n)},decode:identity$8,name:"utf8",createViewTranscoder(){return new ViewFormat$1({encode:function(n){return ArrayBuffer.isView(n)?n:textEncoder$4.encode(n)},decode:function(n){return textDecoder$3.decode(n)},name:`${this.name}+view`})},createBufferTranscoder(){return new BufferFormat$1({encode:function(n){return Buffer$2.isBuffer(n)?n:ArrayBuffer.isView(n)?Buffer$2.from(n.buffer,n.byteOffset,n.byteLength):Buffer$2.from(String(n),"utf8")},decode:function(n){return n.toString("utf8")},name:`${this.name}+buffer`})}});encodings$2.json=new UTF8Format$1({encode:JSON.stringify,decode:JSON.parse,name:"json"});encodings$2.buffer=new BufferFormat$1({encode:function(n){return Buffer$2.isBuffer(n)?n:ArrayBuffer.isView(n)?Buffer$2.from(n.buffer,n.byteOffset,n.byteLength):Buffer$2.from(String(n),"utf8")},decode:identity$8,name:"buffer",createViewTranscoder(){return new ViewFormat$1({encode:function(n){return ArrayBuffer.isView(n)?n:Buffer$2.from(String(n),"utf8")},decode:function(n){return Buffer$2.from(n.buffer,n.byteOffset,n.byteLength)},name:`${this.name}+view`})}});encodings$2.view=new ViewFormat$1({encode:function(n){return ArrayBuffer.isView(n)?n:textEncoder$4.encode(n)},decode:identity$8,name:"view",createBufferTranscoder(){return new BufferFormat$1({encode:function(n){return Buffer$2.isBuffer(n)?n:ArrayBuffer.isView(n)?Buffer$2.from(n.buffer,n.byteOffset,n.byteLength):Buffer$2.from(String(n),"utf8")},decode:identity$8,name:`${this.name}+buffer`})}});encodings$2.hex=new BufferFormat$1({encode:function(n){return Buffer$2.isBuffer(n)?n:Buffer$2.from(String(n),"hex")},decode:function(n){return n.toString("hex")},name:"hex"});encodings$2.base64=new BufferFormat$1({encode:function(n){return Buffer$2.isBuffer(n)?n:Buffer$2.from(String(n),"base64")},decode:function(n){return n.toString("base64")},name:"base64"});const ModuleError$7=moduleError,encodings$1=encodings$2,{Encoding}=encoding,{BufferFormat,ViewFormat,UTF8Format}=formats$2,kFormats=Symbol("formats"),kEncodings=Symbol("encodings"),validFormats=new Set(["buffer","view","utf8"]);let Transcoder$1=class{constructor(r){if(Array.isArray(r)){if(!r.every(_=>validFormats.has(_)))throw new TypeError("Format must be one of 'buffer', 'view', 'utf8'")}else throw new TypeError("The first argument 'formats' must be an array");this[kEncodings]=new Map,this[kFormats]=new Set(r);for(const _ in encodings$1)try{this.encoding(_)}catch(E){if(E.code!=="LEVEL_ENCODING_NOT_SUPPORTED")throw E}}encodings(){return Array.from(new Set(this[kEncodings].values()))}encoding(r){let _=this[kEncodings].get(r);if(_===void 0){if(typeof r=="string"&&r!==""){if(_=lookup[r],!_)throw new ModuleError$7(`Encoding '${r}' is not found`,{code:"LEVEL_ENCODING_NOT_FOUND"})}else{if(typeof r!="object"||r===null)throw new TypeError("First argument 'encoding' must be a string or object");_=from$1(r)}const{name:E,format:S}=_;if(!this[kFormats].has(S))if(this[kFormats].has("view"))_=_.createViewTranscoder();else if(this[kFormats].has("buffer"))_=_.createBufferTranscoder();else if(this[kFormats].has("utf8"))_=_.createUTF8Transcoder();else throw new ModuleError$7(`Encoding '${E}' cannot be transcoded`,{code:"LEVEL_ENCODING_NOT_SUPPORTED"});for(const C of[r,E,_.name,_.commonName])this[kEncodings].set(C,_)}return _}};levelTranscoder.Transcoder=Transcoder$1;function from$1(n){if(n instanceof Encoding)return n;const r="type"in n&&typeof n.type=="string"?n.type:void 0,_=n.name||r||`anonymous-${anonymousCount++}`;switch(detectFormat(n)){case"view":return new ViewFormat({...n,name:_});case"utf8":return new UTF8Format({...n,name:_});case"buffer":return new BufferFormat({...n,name:_});default:throw new TypeError("Format must be one of 'buffer', 'view', 'utf8'")}}function detectFormat(n){return"format"in n&&n.format!==void 0?n.format:"buffer"in n&&typeof n.buffer=="boolean"?n.buffer?"buffer":"utf8":"code"in n&&Number.isInteger(n.code)?"view":"buffer"}const aliases={binary:encodings$1.buffer,"utf-8":encodings$1.utf8},lookup={...encodings$1,...aliases};let anonymousCount=0;var catering={},nextTickBrowser$1=typeof queueMicrotask=="function"?queueMicrotask:n=>Promise.resolve().then(n),nextTick$1=nextTickBrowser$1;catering.fromCallback=function(n,r){if(n===void 0){var _=new Promise(function(E,S){n=function(C,A){C?S(C):E(A)}});n[r!==void 0?r:"promise"]=_}else if(typeof n!="function")throw new TypeError("Callback must be a function");return n};catering.fromPromise=function(n,r){if(r===void 0)return n;n.then(function(_){nextTick$1(()=>r(null,_))}).catch(function(_){nextTick$1(()=>r(_))})};var abstractIterator={},common$3={};common$3.getCallback=function(n,r){return typeof n=="function"?n:r};common$3.getOptions=function(n,r){return typeof n=="object"&&n!==null?n:r!==void 0?r:{}};const{fromCallback:fromCallback$3}=catering,ModuleError$6=moduleError,{getOptions:getOptions$2,getCallback:getCallback$2}=common$3,kPromise$3=Symbol("promise"),kCallback$1=Symbol("callback"),kWorking=Symbol("working"),kHandleOne$1=Symbol("handleOne"),kHandleMany$1=Symbol("handleMany"),kAutoClose=Symbol("autoClose"),kFinishWork=Symbol("finishWork"),kReturnMany=Symbol("returnMany"),kClosing=Symbol("closing"),kHandleClose=Symbol("handleClose"),kClosed=Symbol("closed"),kCloseCallbacks$1=Symbol("closeCallbacks"),kKeyEncoding$1=Symbol("keyEncoding"),kValueEncoding$1=Symbol("valueEncoding"),kAbortOnClose=Symbol("abortOnClose"),kLegacy=Symbol("legacy"),kKeys=Symbol("keys"),kValues=Symbol("values"),kLimit=Symbol("limit"),kCount=Symbol("count"),emptyOptions$1=Object.freeze({}),noop$2=()=>{};let warnedEnd=!1;class CommonIterator{constructor(r,_,E){if(typeof r!="object"||r===null){const S=r===null?"null":typeof r;throw new TypeError(`The first argument must be an abstract-level database, received ${S}`)}if(typeof _!="object"||_===null)throw new TypeError("The second argument must be an options object");this[kClosed]=!1,this[kCloseCallbacks$1]=[],this[kWorking]=!1,this[kClosing]=!1,this[kAutoClose]=!1,this[kCallback$1]=null,this[kHandleOne$1]=this[kHandleOne$1].bind(this),this[kHandleMany$1]=this[kHandleMany$1].bind(this),this[kHandleClose]=this[kHandleClose].bind(this),this[kKeyEncoding$1]=_[kKeyEncoding$1],this[kValueEncoding$1]=_[kValueEncoding$1],this[kLegacy]=E,this[kLimit]=Number.isInteger(_.limit)&&_.limit>=0?_.limit:1/0,this[kCount]=0,this[kAbortOnClose]=!!_.abortOnClose,this.db=r,this.db.attachResource(this),this.nextTick=r.nextTick}get count(){return this[kCount]}get limit(){return this[kLimit]}next(r){let _;if(r===void 0)_=new Promise((E,S)=>{r=(C,A,I)=>{C?S(C):this[kLegacy]?A===void 0&&I===void 0?E():E([A,I]):E(A)}});else if(typeof r!="function")throw new TypeError("Callback must be a function");return this[kClosing]?this.nextTick(r,new ModuleError$6("Iterator is not open: cannot call next() after close()",{code:"LEVEL_ITERATOR_NOT_OPEN"})):this[kWorking]?this.nextTick(r,new ModuleError$6("Iterator is busy: cannot call next() until previous call has completed",{code:"LEVEL_ITERATOR_BUSY"})):(this[kWorking]=!0,this[kCallback$1]=r,this[kCount]>=this[kLimit]?this.nextTick(this[kHandleOne$1],null):this._next(this[kHandleOne$1])),_}_next(r){this.nextTick(r)}nextv(r,_,E){return E=getCallback$2(_,E),E=fromCallback$3(E,kPromise$3),_=getOptions$2(_,emptyOptions$1),Number.isInteger(r)?(this[kClosing]?this.nextTick(E,new ModuleError$6("Iterator is not open: cannot call nextv() after close()",{code:"LEVEL_ITERATOR_NOT_OPEN"})):this[kWorking]?this.nextTick(E,new ModuleError$6("Iterator is busy: cannot call nextv() until previous call has completed",{code:"LEVEL_ITERATOR_BUSY"})):(r<1&&(r=1),this[kLimit]<1/0&&(r=Math.min(r,this[kLimit]-this[kCount])),this[kWorking]=!0,this[kCallback$1]=E,r<=0?this.nextTick(this[kHandleMany$1],null,[]):this._nextv(r,_,this[kHandleMany$1])),E[kPromise$3]):(this.nextTick(E,new TypeError("The first argument 'size' must be an integer")),E[kPromise$3])}_nextv(r,_,E){const S=[],C=(A,I,B)=>{if(A)return E(A);if(this[kLegacy]?I===void 0&&B===void 0:I===void 0)return E(null,S);S.push(this[kLegacy]?[I,B]:I),S.length===r?E(null,S):this._next(C)};this._next(C)}all(r,_){return _=getCallback$2(r,_),_=fromCallback$3(_,kPromise$3),r=getOptions$2(r,emptyOptions$1),this[kClosing]?this.nextTick(_,new ModuleError$6("Iterator is not open: cannot call all() after close()",{code:"LEVEL_ITERATOR_NOT_OPEN"})):this[kWorking]?this.nextTick(_,new ModuleError$6("Iterator is busy: cannot call all() until previous call has completed",{code:"LEVEL_ITERATOR_BUSY"})):(this[kWorking]=!0,this[kCallback$1]=_,this[kAutoClose]=!0,this[kCount]>=this[kLimit]?this.nextTick(this[kHandleMany$1],null,[]):this._all(r,this[kHandleMany$1])),_[kPromise$3]}_all(r,_){let E=this[kCount];const S=[],C=()=>{const I=this[kLimit]<1/0?Math.min(1e3,this[kLimit]-E):1e3;I<=0?this.nextTick(_,null,S):this._nextv(I,emptyOptions$1,A)},A=(I,B)=>{I?_(I):B.length===0?_(null,S):(S.push.apply(S,B),E+=B.length,C())};C()}[kFinishWork](){const r=this[kCallback$1];return this[kAbortOnClose]&&r===null?noop$2:(this[kWorking]=!1,this[kCallback$1]=null,this[kClosing]&&this._close(this[kHandleClose]),r)}[kReturnMany](r,_,E){this[kAutoClose]?this.close(r.bind(null,_,E)):r(_,E)}seek(r,_){if(_=getOptions$2(_,emptyOptions$1),!this[kClosing]){if(this[kWorking])throw new ModuleError$6("Iterator is busy: cannot call seek() until next() has completed",{code:"LEVEL_ITERATOR_BUSY"});{const E=this.db.keyEncoding(_.keyEncoding||this[kKeyEncoding$1]),S=E.format;_.keyEncoding!==S&&(_={..._,keyEncoding:S});const C=this.db.prefixKey(E.encode(r),S);this._seek(C,_)}}}_seek(r,_){throw new ModuleError$6("Iterator does not support seek()",{code:"LEVEL_NOT_SUPPORTED"})}close(r){return r=fromCallback$3(r,kPromise$3),this[kClosed]?this.nextTick(r):this[kClosing]?this[kCloseCallbacks$1].push(r):(this[kClosing]=!0,this[kCloseCallbacks$1].push(r),this[kWorking]?this[kAbortOnClose]&&this[kFinishWork]()(new ModuleError$6("Aborted on iterator close()",{code:"LEVEL_ITERATOR_NOT_OPEN"})):this._close(this[kHandleClose])),r[kPromise$3]}_close(r){this.nextTick(r)}[kHandleClose](){this[kClosed]=!0,this.db.detachResource(this);const r=this[kCloseCallbacks$1];this[kCloseCallbacks$1]=[];for(const _ of r)_()}async*[Symbol.asyncIterator](){try{let r;for(;(r=await this.next())!==void 0;)yield r}finally{this[kClosed]||await this.close()}}}let AbstractIterator$3=class extends CommonIterator{constructor(r,_){super(r,_,!0),this[kKeys]=_.keys!==!1,this[kValues]=_.values!==!1}[kHandleOne$1](r,_,E){const S=this[kFinishWork]();if(r)return S(r);try{_=this[kKeys]&&_!==void 0?this[kKeyEncoding$1].decode(_):void 0,E=this[kValues]&&E!==void 0?this[kValueEncoding$1].decode(E):void 0}catch(C){return S(new IteratorDecodeError("entry",C))}_===void 0&&E===void 0||this[kCount]++,S(null,_,E)}[kHandleMany$1](r,_){const E=this[kFinishWork]();if(r)return this[kReturnMany](E,r);try{for(const S of _){const C=S[0],A=S[1];S[0]=this[kKeys]&&C!==void 0?this[kKeyEncoding$1].decode(C):void 0,S[1]=this[kValues]&&A!==void 0?this[kValueEncoding$1].decode(A):void 0}}catch(S){return this[kReturnMany](E,new IteratorDecodeError("entries",S))}this[kCount]+=_.length,this[kReturnMany](E,null,_)}end(r){return!warnedEnd&&typeof console<"u"&&(warnedEnd=!0,console.warn(new ModuleError$6("The iterator.end() method was renamed to close() and end() is an alias that will be removed in a future version",{code:"LEVEL_LEGACY"}))),this.close(r)}},AbstractKeyIterator$2=class extends CommonIterator{constructor(r,_){super(r,_,!1)}[kHandleOne$1](r,_){const E=this[kFinishWork]();if(r)return E(r);try{_=_!==void 0?this[kKeyEncoding$1].decode(_):void 0}catch(S){return E(new IteratorDecodeError("key",S))}_!==void 0&&this[kCount]++,E(null,_)}[kHandleMany$1](r,_){const E=this[kFinishWork]();if(r)return this[kReturnMany](E,r);try{for(let S=0;S<_.length;S++){const C=_[S];_[S]=C!==void 0?this[kKeyEncoding$1].decode(C):void 0}}catch(S){return this[kReturnMany](E,new IteratorDecodeError("keys",S))}this[kCount]+=_.length,this[kReturnMany](E,null,_)}},AbstractValueIterator$2=class extends CommonIterator{constructor(r,_){super(r,_,!1)}[kHandleOne$1](r,_){const E=this[kFinishWork]();if(r)return E(r);try{_=_!==void 0?this[kValueEncoding$1].decode(_):void 0}catch(S){return E(new IteratorDecodeError("value",S))}_!==void 0&&this[kCount]++,E(null,_)}[kHandleMany$1](r,_){const E=this[kFinishWork]();if(r)return this[kReturnMany](E,r);try{for(let S=0;S<_.length;S++){const C=_[S];_[S]=C!==void 0?this[kValueEncoding$1].decode(C):void 0}}catch(S){return this[kReturnMany](E,new IteratorDecodeError("values",S))}this[kCount]+=_.length,this[kReturnMany](E,null,_)}};class IteratorDecodeError extends ModuleError$6{constructor(r,_){super(`Iterator could not decode ${r}`,{code:"LEVEL_DECODE_ERROR",cause:_})}}for(const n of["_ended property","_nexting property","_end method"])Object.defineProperty(AbstractIterator$3.prototype,n.split(" ")[0],{get(){throw new ModuleError$6(`The ${n} has been removed`,{code:"LEVEL_LEGACY"})},set(){throw new ModuleError$6(`The ${n} has been removed`,{code:"LEVEL_LEGACY"})}});AbstractIterator$3.keyEncoding=kKeyEncoding$1;AbstractIterator$3.valueEncoding=kValueEncoding$1;abstractIterator.AbstractIterator=AbstractIterator$3;abstractIterator.AbstractKeyIterator=AbstractKeyIterator$2;abstractIterator.AbstractValueIterator=AbstractValueIterator$2;var defaultKvIterator={};const{AbstractKeyIterator:AbstractKeyIterator$1,AbstractValueIterator:AbstractValueIterator$1}=abstractIterator,kIterator=Symbol("iterator"),kCallback=Symbol("callback"),kHandleOne=Symbol("handleOne"),kHandleMany=Symbol("handleMany");let DefaultKeyIterator$1=class extends AbstractKeyIterator$1{constructor(r,_){super(r,_),this[kIterator]=r.iterator({..._,keys:!0,values:!1}),this[kHandleOne]=this[kHandleOne].bind(this),this[kHandleMany]=this[kHandleMany].bind(this)}},DefaultValueIterator$1=class extends AbstractValueIterator$1{constructor(r,_){super(r,_),this[kIterator]=r.iterator({..._,keys:!1,values:!0}),this[kHandleOne]=this[kHandleOne].bind(this),this[kHandleMany]=this[kHandleMany].bind(this)}};for(const n of[DefaultKeyIterator$1,DefaultValueIterator$1]){const r=n===DefaultKeyIterator$1,_=r?E=>E[0]:E=>E[1];n.prototype._next=function(E){this[kCallback]=E,this[kIterator].next(this[kHandleOne])},n.prototype[kHandleOne]=function(E,S,C){const A=this[kCallback];E?A(E):A(null,r?S:C)},n.prototype._nextv=function(E,S,C){this[kCallback]=C,this[kIterator].nextv(E,S,this[kHandleMany])},n.prototype._all=function(E,S){this[kCallback]=S,this[kIterator].all(E,this[kHandleMany])},n.prototype[kHandleMany]=function(E,S){const C=this[kCallback];E?C(E):C(null,S.map(_))},n.prototype._seek=function(E,S){this[kIterator].seek(E,S)},n.prototype._close=function(E){this[kIterator].close(E)}}defaultKvIterator.DefaultKeyIterator=DefaultKeyIterator$1;defaultKvIterator.DefaultValueIterator=DefaultValueIterator$1;var deferredIterator={};const{AbstractIterator:AbstractIterator$2,AbstractKeyIterator,AbstractValueIterator}=abstractIterator,ModuleError$5=moduleError,kNut=Symbol("nut"),kUndefer$1=Symbol("undefer"),kFactory=Symbol("factory");let DeferredIterator$1=class extends AbstractIterator$2{constructor(r,_){super(r,_),this[kNut]=null,this[kFactory]=()=>r.iterator(_),this.db.defer(()=>this[kUndefer$1]())}},DeferredKeyIterator$1=class extends AbstractKeyIterator{constructor(r,_){super(r,_),this[kNut]=null,this[kFactory]=()=>r.keys(_),this.db.defer(()=>this[kUndefer$1]())}},DeferredValueIterator$1=class extends AbstractValueIterator{constructor(r,_){super(r,_),this[kNut]=null,this[kFactory]=()=>r.values(_),this.db.defer(()=>this[kUndefer$1]())}};for(const n of[DeferredIterator$1,DeferredKeyIterator$1,DeferredValueIterator$1])n.prototype[kUndefer$1]=function(){this.db.status==="open"&&(this[kNut]=this[kFactory]())},n.prototype._next=function(r){this[kNut]!==null?this[kNut].next(r):this.db.status==="opening"?this.db.defer(()=>this._next(r)):this.nextTick(r,new ModuleError$5("Iterator is not open: cannot call next() after close()",{code:"LEVEL_ITERATOR_NOT_OPEN"}))},n.prototype._nextv=function(r,_,E){this[kNut]!==null?this[kNut].nextv(r,_,E):this.db.status==="opening"?this.db.defer(()=>this._nextv(r,_,E)):this.nextTick(E,new ModuleError$5("Iterator is not open: cannot call nextv() after close()",{code:"LEVEL_ITERATOR_NOT_OPEN"}))},n.prototype._all=function(r,_){this[kNut]!==null?this[kNut].all(_):this.db.status==="opening"?this.db.defer(()=>this._all(r,_)):this.nextTick(_,new ModuleError$5("Iterator is not open: cannot call all() after close()",{code:"LEVEL_ITERATOR_NOT_OPEN"}))},n.prototype._seek=function(r,_){this[kNut]!==null?this[kNut]._seek(r,_):this.db.status==="opening"&&this.db.defer(()=>this._seek(r,_))},n.prototype._close=function(r){this[kNut]!==null?this[kNut].close(r):this.db.status==="opening"?this.db.defer(()=>this._close(r)):this.nextTick(r)};deferredIterator.DeferredIterator=DeferredIterator$1;deferredIterator.DeferredKeyIterator=DeferredKeyIterator$1;deferredIterator.DeferredValueIterator=DeferredValueIterator$1;var defaultChainedBatch={},abstractChainedBatch={};const{fromCallback:fromCallback$2}=catering,ModuleError$4=moduleError,{getCallback:getCallback$1,getOptions:getOptions$1}=common$3,kPromise$2=Symbol("promise"),kStatus$1=Symbol("status"),kOperations$1=Symbol("operations"),kFinishClose=Symbol("finishClose"),kCloseCallbacks=Symbol("closeCallbacks");let AbstractChainedBatch$1=class{constructor(r){if(typeof r!="object"||r===null){const _=r===null?"null":typeof r;throw new TypeError(`The first argument must be an abstract-level database, received ${_}`)}this[kOperations$1]=[],this[kCloseCallbacks]=[],this[kStatus$1]="open",this[kFinishClose]=this[kFinishClose].bind(this),this.db=r,this.db.attachResource(this),this.nextTick=r.nextTick}get length(){return this[kOperations$1].length}put(r,_,E){if(this[kStatus$1]!=="open")throw new ModuleError$4("Batch is not open: cannot call put() after write() or close()",{code:"LEVEL_BATCH_NOT_OPEN"});const S=this.db._checkKey(r)||this.db._checkValue(_);if(S)throw S;const C=E&&E.sublevel!=null?E.sublevel:this.db,A=E,I=C.keyEncoding(E&&E.keyEncoding),B=C.valueEncoding(E&&E.valueEncoding),O=I.format;E={...E,keyEncoding:O,valueEncoding:B.format},C!==this.db&&(E.sublevel=null);const N=C.prefixKey(I.encode(r),O),U=B.encode(_);return this._put(N,U,E),this[kOperations$1].push({...A,type:"put",key:r,value:_}),this}_put(r,_,E){}del(r,_){if(this[kStatus$1]!=="open")throw new ModuleError$4("Batch is not open: cannot call del() after write() or close()",{code:"LEVEL_BATCH_NOT_OPEN"});const E=this.db._checkKey(r);if(E)throw E;const S=_&&_.sublevel!=null?_.sublevel:this.db,C=_,A=S.keyEncoding(_&&_.keyEncoding),I=A.format;return _={..._,keyEncoding:I},S!==this.db&&(_.sublevel=null),this._del(S.prefixKey(A.encode(r),I),_),this[kOperations$1].push({...C,type:"del",key:r}),this}_del(r,_){}clear(){if(this[kStatus$1]!=="open")throw new ModuleError$4("Batch is not open: cannot call clear() after write() or close()",{code:"LEVEL_BATCH_NOT_OPEN"});return this._clear(),this[kOperations$1]=[],this}_clear(){}write(r,_){return _=getCallback$1(r,_),_=fromCallback$2(_,kPromise$2),r=getOptions$1(r),this[kStatus$1]!=="open"?this.nextTick(_,new ModuleError$4("Batch is not open: cannot call write() after write() or close()",{code:"LEVEL_BATCH_NOT_OPEN"})):this.length===0?this.close(_):(this[kStatus$1]="writing",this._write(r,E=>{this[kStatus$1]="closing",this[kCloseCallbacks].push(()=>_(E)),E||this.db.emit("batch",this[kOperations$1]),this._close(this[kFinishClose])})),_[kPromise$2]}_write(r,_){}close(r){return r=fromCallback$2(r,kPromise$2),this[kStatus$1]==="closing"?this[kCloseCallbacks].push(r):this[kStatus$1]==="closed"?this.nextTick(r):(this[kCloseCallbacks].push(r),this[kStatus$1]!=="writing"&&(this[kStatus$1]="closing",this._close(this[kFinishClose]))),r[kPromise$2]}_close(r){this.nextTick(r)}[kFinishClose](){this[kStatus$1]="closed",this.db.detachResource(this);const r=this[kCloseCallbacks];this[kCloseCallbacks]=[];for(const _ of r)_()}};abstractChainedBatch.AbstractChainedBatch=AbstractChainedBatch$1;const{AbstractChainedBatch}=abstractChainedBatch,ModuleError$3=moduleError,kEncoded=Symbol("encoded");let DefaultChainedBatch$1=class extends AbstractChainedBatch{constructor(r){super(r),this[kEncoded]=[]}_put(r,_,E){this[kEncoded].push({...E,type:"put",key:r,value:_})}_del(r,_){this[kEncoded].push({..._,type:"del",key:r})}_clear(){this[kEncoded]=[]}_write(r,_){this.db.status==="opening"?this.db.defer(()=>this._write(r,_)):this.db.status==="open"?this[kEncoded].length===0?this.nextTick(_):this.db._batch(this[kEncoded],r,_):this.nextTick(_,new ModuleError$3("Batch is not open: cannot call write() after write() or close()",{code:"LEVEL_BATCH_NOT_OPEN"}))}};defaultChainedBatch.DefaultChainedBatch=DefaultChainedBatch$1;const ModuleError$2=moduleError,hasOwnProperty$1=Object.prototype.hasOwnProperty,rangeOptions$1=new Set(["lt","lte","gt","gte"]);var rangeOptions_1=function(n,r){const _={};for(const E in n)if(hasOwnProperty$1.call(n,E)&&!(E==="keyEncoding"||E==="valueEncoding")){if(E==="start"||E==="end")throw new ModuleError$2(`The legacy range option '${E}' has been removed`,{code:"LEVEL_LEGACY"});if(E==="encoding")throw new ModuleError$2("The levelup-style 'encoding' alias has been removed, use 'valueEncoding' instead",{code:"LEVEL_LEGACY"});rangeOptions$1.has(E)?_[E]=r.encode(n[E]):_[E]=n[E]}return _.reverse=!!_.reverse,_.limit=Number.isInteger(_.limit)&&_.limit>=0?_.limit:-1,_};/*! queue-microtask. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */let promise;var queueMicrotask_1=typeof queueMicrotask=="function"?queueMicrotask.bind(typeof window<"u"?window:commonjsGlobal):n=>(promise||(promise=Promise.resolve())).then(n).catch(r=>setTimeout(()=>{throw r},0)),nextTickBrowser,hasRequiredNextTickBrowser;function requireNextTickBrowser(){if(hasRequiredNextTickBrowser)return nextTickBrowser;hasRequiredNextTickBrowser=1;const n=queueMicrotask_1;return nextTickBrowser=function(r,..._){_.length===0?n(r):n(()=>r(..._))},nextTickBrowser}var abstractSublevelIterator={},hasRequiredAbstractSublevelIterator;function requireAbstractSublevelIterator(){if(hasRequiredAbstractSublevelIterator)return abstractSublevelIterator;hasRequiredAbstractSublevelIterator=1;const{AbstractIterator:n,AbstractKeyIterator:r,AbstractValueIterator:_}=abstractIterator,E=Symbol("unfix"),S=Symbol("iterator"),C=Symbol("handleOne"),A=Symbol("handleMany"),I=Symbol("callback");class B extends n{constructor(j,z,Z,X){super(j,z),this[S]=Z,this[E]=X,this[C]=this[C].bind(this),this[A]=this[A].bind(this),this[I]=null}[C](j,z,Z){const X=this[I];if(j)return X(j);z!==void 0&&(z=this[E](z)),X(j,z,Z)}[A](j,z){const Z=this[I];if(j)return Z(j);for(const X of z){const Q=X[0];Q!==void 0&&(X[0]=this[E](Q))}Z(j,z)}}class O extends r{constructor(j,z,Z,X){super(j,z),this[S]=Z,this[E]=X,this[C]=this[C].bind(this),this[A]=this[A].bind(this),this[I]=null}[C](j,z){const Z=this[I];if(j)return Z(j);z!==void 0&&(z=this[E](z)),Z(j,z)}[A](j,z){const Z=this[I];if(j)return Z(j);for(let X=0;X<z.length;X++){const Q=z[X];Q!==void 0&&(z[X]=this[E](Q))}Z(j,z)}}class N extends _{constructor(j,z,Z){super(j,z),this[S]=Z}}for(const U of[B,O])U.prototype._next=function(j){this[I]=j,this[S].next(this[C])},U.prototype._nextv=function(j,z,Z){this[I]=Z,this[S].nextv(j,z,this[A])},U.prototype._all=function(j,z){this[I]=z,this[S].all(j,this[A])};for(const U of[N])U.prototype._next=function(j){this[S].next(j)},U.prototype._nextv=function(j,z,Z){this[S].nextv(j,z,Z)},U.prototype._all=function(j,z){this[S].all(j,z)};for(const U of[B,O,N])U.prototype._seek=function(j,z){this[S].seek(j,z)},U.prototype._close=function(j){this[S].close(j)};return abstractSublevelIterator.AbstractSublevelIterator=B,abstractSublevelIterator.AbstractSublevelKeyIterator=O,abstractSublevelIterator.AbstractSublevelValueIterator=N,abstractSublevelIterator}var abstractSublevel,hasRequiredAbstractSublevel;function requireAbstractSublevel(){if(hasRequiredAbstractSublevel)return abstractSublevel;hasRequiredAbstractSublevel=1;const n=moduleError,{Buffer:r}=buffer$2||{},{AbstractSublevelIterator:_,AbstractSublevelKeyIterator:E,AbstractSublevelValueIterator:S}=requireAbstractSublevelIterator(),C=Symbol("prefix"),A=Symbol("upperBound"),I=Symbol("prefixRange"),B=Symbol("parent"),O=Symbol("unfix"),N=new TextEncoder,U={separator:"!"};abstractSublevel=function({AbstractLevel:se}){class oe extends se{static defaults(we){if(typeof we=="string")throw new n("The subleveldown string shorthand for { separator } has been removed",{code:"LEVEL_LEGACY"});if(we&&we.open)throw new n("The subleveldown open option has been removed",{code:"LEVEL_LEGACY"});return we==null?U:we.separator?we:{...we,separator:"!"}}constructor(we,Te,xe){const{separator:Re,manifest:Ne,...Fe}=oe.defaults(xe);Te=Q(Te,Re);const ht=Re.charCodeAt(0)+1,nt=we[B]||we;if(!N.encode(Te).every(_e=>_e>ht&&_e<127))throw new n(`Prefix must use bytes > ${ht} < 127`,{code:"LEVEL_INVALID_PREFIX"});super(j(nt,Ne),Fe);const Ee=(we.prefix||"")+Re+Te+Re,Ce=Ee.slice(0,-1)+String.fromCharCode(ht);this[B]=nt,this[C]=new Z(Ee),this[A]=new Z(Ce),this[O]=new X,this.nextTick=nt.nextTick}prefixKey(we,Te){if(Te==="utf8")return this[C].utf8+we;if(we.byteLength===0)return this[C][Te];if(Te==="view"){const xe=this[C].view,Re=new Uint8Array(xe.byteLength+we.byteLength);return Re.set(xe,0),Re.set(we,xe.byteLength),Re}else{const xe=this[C].buffer;return r.concat([xe,we],xe.byteLength+we.byteLength)}}[I](we,Te){we.gte!==void 0?we.gte=this.prefixKey(we.gte,Te):we.gt!==void 0?we.gt=this.prefixKey(we.gt,Te):we.gte=this[C][Te],we.lte!==void 0?we.lte=this.prefixKey(we.lte,Te):we.lt!==void 0?we.lt=this.prefixKey(we.lt,Te):we.lte=this[A][Te]}get prefix(){return this[C].utf8}get db(){return this[B]}_open(we,Te){this[B].open({passive:!0},Te)}_put(we,Te,xe,Re){this[B].put(we,Te,xe,Re)}_get(we,Te,xe){this[B].get(we,Te,xe)}_getMany(we,Te,xe){this[B].getMany(we,Te,xe)}_del(we,Te,xe){this[B].del(we,Te,xe)}_batch(we,Te,xe){this[B].batch(we,Te,xe)}_clear(we,Te){this[I](we,we.keyEncoding),this[B].clear(we,Te)}_iterator(we){this[I](we,we.keyEncoding);const Te=this[B].iterator(we),xe=this[O].get(this[C].utf8.length,we.keyEncoding);return new _(this,we,Te,xe)}_keys(we){this[I](we,we.keyEncoding);const Te=this[B].keys(we),xe=this[O].get(this[C].utf8.length,we.keyEncoding);return new E(this,we,Te,xe)}_values(we){this[I](we,we.keyEncoding);const Te=this[B].values(we);return new S(this,we,Te)}}return{AbstractSublevel:oe}};const j=function(se,oe){return{...se.supports,createIfMissing:!1,errorIfExists:!1,events:{},additionalMethods:{},...oe,encodings:{utf8:z(se,"utf8"),buffer:z(se,"buffer"),view:z(se,"view")}}},z=function(se,oe){return se.supports.encodings[oe]?se.keyEncoding(oe).name===oe:!1};class Z{constructor(oe){this.utf8=oe,this.view=N.encode(oe),this.buffer=r?r.from(this.view.buffer,0,this.view.byteLength):{}}}class X{constructor(){this.cache=new Map}get(oe,ue){let we=this.cache.get(ue);return we===void 0&&(ue==="view"?we=function(Te,xe){return xe.subarray(Te)}.bind(null,oe):we=function(Te,xe){return xe.slice(Te)}.bind(null,oe),this.cache.set(ue,we)),we}}const Q=function(se,oe){let ue=0,we=se.length;for(;ue<we&&se[ue]===oe;)ue++;for(;we>ue&&se[we-1]===oe;)we--;return se.slice(ue,we)};return abstractSublevel}const{supports}=levelSupports,{Transcoder}=levelTranscoder,{EventEmitter}=eventsExports,{fromCallback:fromCallback$1}=catering,ModuleError$1=moduleError,{AbstractIterator:AbstractIterator$1}=abstractIterator,{DefaultKeyIterator,DefaultValueIterator}=defaultKvIterator,{DeferredIterator,DeferredKeyIterator,DeferredValueIterator}=deferredIterator,{DefaultChainedBatch}=defaultChainedBatch,{getCallback,getOptions}=common$3,rangeOptions=rangeOptions_1,kPromise$1=Symbol("promise"),kLanded=Symbol("landed"),kResources=Symbol("resources"),kCloseResources=Symbol("closeResources"),kOperations=Symbol("operations"),kUndefer=Symbol("undefer"),kDeferOpen=Symbol("deferOpen"),kOptions$1=Symbol("options"),kStatus=Symbol("status"),kDefaultOptions=Symbol("defaultOptions"),kTranscoder=Symbol("transcoder"),kKeyEncoding=Symbol("keyEncoding"),kValueEncoding=Symbol("valueEncoding"),noop$1=()=>{};let AbstractLevel$1=class extends EventEmitter{constructor(r,_){if(super(),typeof r!="object"||r===null)throw new TypeError("The first argument 'manifest' must be an object");_=getOptions(_);const{keyEncoding:E,valueEncoding:S,passive:C,...A}=_;this[kResources]=new Set,this[kOperations]=[],this[kDeferOpen]=!0,this[kOptions$1]=A,this[kStatus]="opening",this.supports=supports(r,{status:!0,promises:!0,clear:!0,getMany:!0,deferredOpen:!0,snapshots:r.snapshots!==!1,permanence:r.permanence!==!1,keyIterator:!0,valueIterator:!0,iteratorNextv:!0,iteratorAll:!0,encodings:r.encodings||{},events:Object.assign({},r.events,{opening:!0,open:!0,closing:!0,closed:!0,put:!0,del:!0,batch:!0,clear:!0})}),this[kTranscoder]=new Transcoder(formats(this)),this[kKeyEncoding]=this[kTranscoder].encoding(E||"utf8"),this[kValueEncoding]=this[kTranscoder].encoding(S||"utf8");for(const I of this[kTranscoder].encodings())this.supports.encodings[I.commonName]||(this.supports.encodings[I.commonName]=!0);this[kDefaultOptions]={empty:Object.freeze({}),entry:Object.freeze({keyEncoding:this[kKeyEncoding].commonName,valueEncoding:this[kValueEncoding].commonName}),key:Object.freeze({keyEncoding:this[kKeyEncoding].commonName})},this.nextTick(()=>{this[kDeferOpen]&&this.open({passive:!1},noop$1)})}get status(){return this[kStatus]}keyEncoding(r){return this[kTranscoder].encoding(r??this[kKeyEncoding])}valueEncoding(r){return this[kTranscoder].encoding(r??this[kValueEncoding])}open(r,_){_=getCallback(r,_),_=fromCallback$1(_,kPromise$1),r={...this[kOptions$1],...getOptions(r)},r.createIfMissing=r.createIfMissing!==!1,r.errorIfExists=!!r.errorIfExists;const E=S=>{this[kStatus]==="closing"||this[kStatus]==="opening"?this.once(kLanded,S?()=>E(S):E):this[kStatus]!=="open"?_(new ModuleError$1("Database is not open",{code:"LEVEL_DATABASE_NOT_OPEN",cause:S})):_()};return r.passive?this[kStatus]==="opening"?this.once(kLanded,E):this.nextTick(E):this[kStatus]==="closed"||this[kDeferOpen]?(this[kDeferOpen]=!1,this[kStatus]="opening",this.emit("opening"),this._open(r,S=>{if(S){this[kStatus]="closed",this[kCloseResources](()=>{this.emit(kLanded),E(S)}),this[kUndefer]();return}this[kStatus]="open",this[kUndefer](),this.emit(kLanded),this[kStatus]==="open"&&this.emit("open"),this[kStatus]==="open"&&this.emit("ready"),E()})):this[kStatus]==="open"?this.nextTick(E):this.once(kLanded,()=>this.open(r,_)),_[kPromise$1]}_open(r,_){this.nextTick(_)}close(r){r=fromCallback$1(r,kPromise$1);const _=E=>{this[kStatus]==="opening"||this[kStatus]==="closing"?this.once(kLanded,E?_(E):_):this[kStatus]!=="closed"?r(new ModuleError$1("Database is not closed",{code:"LEVEL_DATABASE_NOT_CLOSED",cause:E})):r()};if(this[kStatus]==="open"){this[kStatus]="closing",this.emit("closing");const E=S=>{this[kStatus]="open",this[kUndefer](),this.emit(kLanded),_(S)};this[kCloseResources](()=>{this._close(S=>{if(S)return E(S);this[kStatus]="closed",this[kUndefer](),this.emit(kLanded),this[kStatus]==="closed"&&this.emit("closed"),_()})})}else this[kStatus]==="closed"?this.nextTick(_):this.once(kLanded,()=>this.close(r));return r[kPromise$1]}[kCloseResources](r){if(this[kResources].size===0)return this.nextTick(r);let _=this[kResources].size,E=!0;const S=()=>{--_===0&&(E?this.nextTick(r):r())};for(const C of this[kResources])C.close(S);E=!1,this[kResources].clear()}_close(r){this.nextTick(r)}get(r,_,E){if(E=getCallback(_,E),E=fromCallback$1(E,kPromise$1),_=getOptions(_,this[kDefaultOptions].entry),this[kStatus]==="opening")return this.defer(()=>this.get(r,_,E)),E[kPromise$1];if(maybeError(this,E))return E[kPromise$1];const S=this._checkKey(r);if(S)return this.nextTick(E,S),E[kPromise$1];const C=this.keyEncoding(_.keyEncoding),A=this.valueEncoding(_.valueEncoding),I=C.format,B=A.format;return(_.keyEncoding!==I||_.valueEncoding!==B)&&(_=Object.assign({},_,{keyEncoding:I,valueEncoding:B})),this._get(this.prefixKey(C.encode(r),I),_,(O,N)=>{if(O)return(O.code==="LEVEL_NOT_FOUND"||O.notFound||/NotFound/i.test(O))&&(O.code||(O.code="LEVEL_NOT_FOUND"),O.notFound||(O.notFound=!0),O.status||(O.status=404)),E(O);try{N=A.decode(N)}catch(U){return E(new ModuleError$1("Could not decode value",{code:"LEVEL_DECODE_ERROR",cause:U}))}E(null,N)}),E[kPromise$1]}_get(r,_,E){this.nextTick(E,new Error("NotFound"))}getMany(r,_,E){if(E=getCallback(_,E),E=fromCallback$1(E,kPromise$1),_=getOptions(_,this[kDefaultOptions].entry),this[kStatus]==="opening")return this.defer(()=>this.getMany(r,_,E)),E[kPromise$1];if(maybeError(this,E))return E[kPromise$1];if(!Array.isArray(r))return this.nextTick(E,new TypeError("The first argument 'keys' must be an array")),E[kPromise$1];if(r.length===0)return this.nextTick(E,null,[]),E[kPromise$1];const S=this.keyEncoding(_.keyEncoding),C=this.valueEncoding(_.valueEncoding),A=S.format,I=C.format;(_.keyEncoding!==A||_.valueEncoding!==I)&&(_=Object.assign({},_,{keyEncoding:A,valueEncoding:I}));const B=new Array(r.length);for(let O=0;O<r.length;O++){const N=r[O],U=this._checkKey(N);if(U)return this.nextTick(E,U),E[kPromise$1];B[O]=this.prefixKey(S.encode(N),A)}return this._getMany(B,_,(O,N)=>{if(O)return E(O);try{for(let U=0;U<N.length;U++)N[U]!==void 0&&(N[U]=C.decode(N[U]))}catch(U){return E(new ModuleError$1(`Could not decode one or more of ${N.length} value(s)`,{code:"LEVEL_DECODE_ERROR",cause:U}))}E(null,N)}),E[kPromise$1]}_getMany(r,_,E){this.nextTick(E,null,new Array(r.length).fill(void 0))}put(r,_,E,S){if(S=getCallback(E,S),S=fromCallback$1(S,kPromise$1),E=getOptions(E,this[kDefaultOptions].entry),this[kStatus]==="opening")return this.defer(()=>this.put(r,_,E,S)),S[kPromise$1];if(maybeError(this,S))return S[kPromise$1];const C=this._checkKey(r)||this._checkValue(_);if(C)return this.nextTick(S,C),S[kPromise$1];const A=this.keyEncoding(E.keyEncoding),I=this.valueEncoding(E.valueEncoding),B=A.format,O=I.format;(E.keyEncoding!==B||E.valueEncoding!==O)&&(E=Object.assign({},E,{keyEncoding:B,valueEncoding:O}));const N=this.prefixKey(A.encode(r),B),U=I.encode(_);return this._put(N,U,E,j=>{if(j)return S(j);this.emit("put",r,_),S()}),S[kPromise$1]}_put(r,_,E,S){this.nextTick(S)}del(r,_,E){if(E=getCallback(_,E),E=fromCallback$1(E,kPromise$1),_=getOptions(_,this[kDefaultOptions].key),this[kStatus]==="opening")return this.defer(()=>this.del(r,_,E)),E[kPromise$1];if(maybeError(this,E))return E[kPromise$1];const S=this._checkKey(r);if(S)return this.nextTick(E,S),E[kPromise$1];const C=this.keyEncoding(_.keyEncoding),A=C.format;return _.keyEncoding!==A&&(_=Object.assign({},_,{keyEncoding:A})),this._del(this.prefixKey(C.encode(r),A),_,I=>{if(I)return E(I);this.emit("del",r),E()}),E[kPromise$1]}_del(r,_,E){this.nextTick(E)}batch(r,_,E){if(!arguments.length){if(this[kStatus]==="opening")return new DefaultChainedBatch(this);if(this[kStatus]!=="open")throw new ModuleError$1("Database is not open",{code:"LEVEL_DATABASE_NOT_OPEN"});return this._chainedBatch()}if(typeof r=="function"?E=r:E=getCallback(_,E),E=fromCallback$1(E,kPromise$1),_=getOptions(_,this[kDefaultOptions].empty),this[kStatus]==="opening")return this.defer(()=>this.batch(r,_,E)),E[kPromise$1];if(maybeError(this,E))return E[kPromise$1];if(!Array.isArray(r))return this.nextTick(E,new TypeError("The first argument 'operations' must be an array")),E[kPromise$1];if(r.length===0)return this.nextTick(E),E[kPromise$1];const S=new Array(r.length),{keyEncoding:C,valueEncoding:A,...I}=_;for(let B=0;B<r.length;B++){if(typeof r[B]!="object"||r[B]===null)return this.nextTick(E,new TypeError("A batch operation must be an object")),E[kPromise$1];const O=Object.assign({},r[B]);if(O.type!=="put"&&O.type!=="del")return this.nextTick(E,new TypeError("A batch operation must have a type property that is 'put' or 'del'")),E[kPromise$1];const N=this._checkKey(O.key);if(N)return this.nextTick(E,N),E[kPromise$1];const U=O.sublevel!=null?O.sublevel:this,j=U.keyEncoding(O.keyEncoding||C),z=j.format;if(O.key=U.prefixKey(j.encode(O.key),z),O.keyEncoding=z,O.type==="put"){const Z=this._checkValue(O.value);if(Z)return this.nextTick(E,Z),E[kPromise$1];const X=U.valueEncoding(O.valueEncoding||A);O.value=X.encode(O.value),O.valueEncoding=X.format}U!==this&&(O.sublevel=null),S[B]=O}return this._batch(S,I,B=>{if(B)return E(B);this.emit("batch",r),E()}),E[kPromise$1]}_batch(r,_,E){this.nextTick(E)}sublevel(r,_){return this._sublevel(r,AbstractSublevel.defaults(_))}_sublevel(r,_){return new AbstractSublevel(this,r,_)}prefixKey(r,_){return r}clear(r,_){if(_=getCallback(r,_),_=fromCallback$1(_,kPromise$1),r=getOptions(r,this[kDefaultOptions].empty),this[kStatus]==="opening")return this.defer(()=>this.clear(r,_)),_[kPromise$1];if(maybeError(this,_))return _[kPromise$1];const E=r,S=this.keyEncoding(r.keyEncoding);return r=rangeOptions(r,S),r.keyEncoding=S.format,r.limit===0?this.nextTick(_):this._clear(r,C=>{if(C)return _(C);this.emit("clear",E),_()}),_[kPromise$1]}_clear(r,_){this.nextTick(_)}iterator(r){const _=this.keyEncoding(r&&r.keyEncoding),E=this.valueEncoding(r&&r.valueEncoding);if(r=rangeOptions(r,_),r.keys=r.keys!==!1,r.values=r.values!==!1,r[AbstractIterator$1.keyEncoding]=_,r[AbstractIterator$1.valueEncoding]=E,r.keyEncoding=_.format,r.valueEncoding=E.format,this[kStatus]==="opening")return new DeferredIterator(this,r);if(this[kStatus]!=="open")throw new ModuleError$1("Database is not open",{code:"LEVEL_DATABASE_NOT_OPEN"});return this._iterator(r)}_iterator(r){return new AbstractIterator$1(this,r)}keys(r){const _=this.keyEncoding(r&&r.keyEncoding),E=this.valueEncoding(r&&r.valueEncoding);if(r=rangeOptions(r,_),r[AbstractIterator$1.keyEncoding]=_,r[AbstractIterator$1.valueEncoding]=E,r.keyEncoding=_.format,r.valueEncoding=E.format,this[kStatus]==="opening")return new DeferredKeyIterator(this,r);if(this[kStatus]!=="open")throw new ModuleError$1("Database is not open",{code:"LEVEL_DATABASE_NOT_OPEN"});return this._keys(r)}_keys(r){return new DefaultKeyIterator(this,r)}values(r){const _=this.keyEncoding(r&&r.keyEncoding),E=this.valueEncoding(r&&r.valueEncoding);if(r=rangeOptions(r,_),r[AbstractIterator$1.keyEncoding]=_,r[AbstractIterator$1.valueEncoding]=E,r.keyEncoding=_.format,r.valueEncoding=E.format,this[kStatus]==="opening")return new DeferredValueIterator(this,r);if(this[kStatus]!=="open")throw new ModuleError$1("Database is not open",{code:"LEVEL_DATABASE_NOT_OPEN"});return this._values(r)}_values(r){return new DefaultValueIterator(this,r)}defer(r){if(typeof r!="function")throw new TypeError("The first argument must be a function");this[kOperations].push(r)}[kUndefer](){if(this[kOperations].length===0)return;const r=this[kOperations];this[kOperations]=[];for(const _ of r)_()}attachResource(r){if(typeof r!="object"||r===null||typeof r.close!="function")throw new TypeError("The first argument must be a resource object");this[kResources].add(r)}detachResource(r){this[kResources].delete(r)}_chainedBatch(){return new DefaultChainedBatch(this)}_checkKey(r){if(r==null)return new ModuleError$1("Key cannot be null or undefined",{code:"LEVEL_INVALID_KEY"})}_checkValue(r){if(r==null)return new ModuleError$1("Value cannot be null or undefined",{code:"LEVEL_INVALID_VALUE"})}};AbstractLevel$1.prototype.nextTick=requireNextTickBrowser();const{AbstractSublevel}=requireAbstractSublevel()({AbstractLevel:AbstractLevel$1});abstractLevel.AbstractLevel=AbstractLevel$1;abstractLevel.AbstractSublevel=AbstractSublevel;const maybeError=function(n,r){return n[kStatus]!=="open"?(n.nextTick(r,new ModuleError$1("Database is not open",{code:"LEVEL_DATABASE_NOT_OPEN"})),!0):!1},formats=function(n){return Object.keys(n.supports.encodings).filter(r=>!!n.supports.encodings[r])};abstractLevel$1.AbstractLevel=abstractLevel.AbstractLevel;abstractLevel$1.AbstractSublevel=abstractLevel.AbstractSublevel;abstractLevel$1.AbstractIterator=abstractIterator.AbstractIterator;abstractLevel$1.AbstractKeyIterator=abstractIterator.AbstractKeyIterator;abstractLevel$1.AbstractValueIterator=abstractIterator.AbstractValueIterator;abstractLevel$1.AbstractChainedBatch=abstractChainedBatch.AbstractChainedBatch;/*! run-parallel-limit. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */var runParallelLimit_1=runParallelLimit;const queueMicrotask$1=queueMicrotask_1;function runParallelLimit(n,r,_){if(typeof r!="number")throw new Error("second argument must be a Number");let E,S,C,A,I,B=!0,O;Array.isArray(n)?(E=[],C=S=n.length):(A=Object.keys(n),E={},C=S=A.length);function N(j){function z(){_&&_(j,E),_=null}B?queueMicrotask$1(z):z()}function U(j,z,Z){if(E[j]=Z,z&&(I=!0),--C===0||z)N(z);else if(!I&&O<S){let X;A?(X=A[O],O+=1,n[X](function(Q,se){U(X,Q,se)})):(X=O,O+=1,n[X](function(Q,se){U(X,Q,se)}))}}O=r,C?A?A.some(function(j,z){return n[j](function(Z,X){U(j,Z,X)}),z===r-1}):n.some(function(j,z){return j(function(Z,X){U(z,Z,X)}),z===r-1}):N(null),B=!1}var iterator={},keyRange=function(r){const _=r.gte!==void 0?r.gte:r.gt!==void 0?r.gt:void 0,E=r.lte!==void 0?r.lte:r.lt!==void 0?r.lt:void 0,S=r.gte===void 0,C=r.lte===void 0;return _!==void 0&&E!==void 0?IDBKeyRange.bound(_,E,S,C):_!==void 0?IDBKeyRange.lowerBound(_,S):E!==void 0?IDBKeyRange.upperBound(E,C):null};const textEncoder$3=new TextEncoder;var deserialize$2=function(n){return n instanceof Uint8Array?n:n instanceof ArrayBuffer?new Uint8Array(n):textEncoder$3.encode(n)};const{AbstractIterator}=abstractLevel$1,createKeyRange$1=keyRange,deserialize$1=deserialize$2,kCache=Symbol("cache"),kFinished=Symbol("finished"),kOptions=Symbol("options"),kCurrentOptions=Symbol("currentOptions"),kPosition=Symbol("position"),kLocation$1=Symbol("location"),kFirst=Symbol("first"),emptyOptions={};let Iterator$1=class extends AbstractIterator{constructor(r,_,E){super(r,E),this[kCache]=[],this[kFinished]=this.limit===0,this[kOptions]=E,this[kCurrentOptions]={...E},this[kPosition]=void 0,this[kLocation$1]=_,this[kFirst]=!0}_nextv(r,_,E){if(this[kFirst]=!1,this[kFinished])return this.nextTick(E,null,[]);if(this[kCache].length>0)return r=Math.min(r,this[kCache].length),this.nextTick(E,null,this[kCache].splice(0,r));this[kPosition]!==void 0&&(this[kOptions].reverse?(this[kCurrentOptions].lt=this[kPosition],this[kCurrentOptions].lte=void 0):(this[kCurrentOptions].gt=this[kPosition],this[kCurrentOptions].gte=void 0));let S;try{S=createKeyRange$1(this[kCurrentOptions])}catch{return this[kFinished]=!0,this.nextTick(E,null,[])}const C=this.db.db.transaction([this[kLocation$1]],"readonly"),A=C.objectStore(this[kLocation$1]),I=[];if(this[kOptions].reverse){const B=!this[kOptions].values&&A.openKeyCursor?"openKeyCursor":"openCursor";A[B](S,"prev").onsuccess=O=>{const N=O.target.result;if(N){const{key:U,value:j}=N;this[kPosition]=U,I.push([this[kOptions].keys&&U!==void 0?deserialize$1(U):void 0,this[kOptions].values&&j!==void 0?deserialize$1(j):void 0]),I.length<r?N.continue():maybeCommit(C)}else this[kFinished]=!0}}else{let B,O;const N=()=>{if(B===void 0||O===void 0)return;const U=Math.max(B.length,O.length);U===0||r===1/0?this[kFinished]=!0:this[kPosition]=B[U-1],I.length=U;for(let j=0;j<U;j++){const z=B[j],Z=O[j];I[j]=[this[kOptions].keys&&z!==void 0?deserialize$1(z):void 0,this[kOptions].values&&Z!==void 0?deserialize$1(Z):void 0]}maybeCommit(C)};this[kOptions].keys||r<1/0?A.getAllKeys(S,r<1/0?r:void 0).onsuccess=U=>{B=U.target.result,N()}:(B=[],this.nextTick(N)),this[kOptions].values?A.getAll(S,r<1/0?r:void 0).onsuccess=U=>{O=U.target.result,N()}:(O=[],this.nextTick(N))}C.onabort=()=>{E(C.error||new Error("aborted by user")),E=null},C.oncomplete=()=>{E(null,I),E=null}}_next(r){if(this[kCache].length>0){const[_,E]=this[kCache].shift();this.nextTick(r,null,_,E)}else if(this[kFinished])this.nextTick(r);else{let _=Math.min(100,this.limit-this.count);this[kFirst]&&(this[kFirst]=!1,_=1),this._nextv(_,emptyOptions,(E,S)=>{if(E)return r(E);this[kCache]=S,this._next(r)})}}_all(r,_){this[kFirst]=!1;const E=this[kCache].splice(0,this[kCache].length),S=this.limit-this.count-E.length;if(S<=0)return this.nextTick(_,null,E);this._nextv(S,emptyOptions,(C,A)=>{if(C)return _(C);E.length>0&&(A=E.concat(A)),_(null,A)})}_seek(r,_){this[kFirst]=!0,this[kCache]=[],this[kFinished]=!1,this[kPosition]=void 0,this[kCurrentOptions]={...this[kOptions]};let E;try{E=createKeyRange$1(this[kOptions])}catch{this[kFinished]=!0;return}E!==null&&!E.includes(r)?this[kFinished]=!0:this[kOptions].reverse?this[kCurrentOptions].lte=r:this[kCurrentOptions].gte=r}};iterator.Iterator=Iterator$1;function maybeCommit(n){typeof n.commit=="function"&&n.commit()}var clear$1=function(r,_,E,S,C){if(S.limit===0)return r.nextTick(C);const A=r.db.transaction([_],"readwrite"),I=A.objectStore(_);let B=0;A.oncomplete=function(){C()},A.onabort=function(){C(A.error||new Error("aborted by user"))};const O=I.openKeyCursor?"openKeyCursor":"openCursor",N=S.reverse?"prev":"next";I[O](E,N).onsuccess=function(U){const j=U.target.result;j&&(I.delete(j.key).onsuccess=function(){(S.limit<=0||++B<S.limit)&&j.continue()})}};const{AbstractLevel}=abstractLevel$1,ModuleError=moduleError,parallel$1=runParallelLimit_1,{fromCallback}=catering,{Iterator}=iterator,deserialize=deserialize$2,clear=clear$1,createKeyRange=keyRange,DEFAULT_PREFIX="level-js-",kIDB=Symbol("idb"),kNamePrefix=Symbol("namePrefix"),kLocation=Symbol("location"),kVersion=Symbol("version"),kStore=Symbol("store"),kOnComplete=Symbol("onComplete"),kPromise=Symbol("promise");class BrowserLevel extends AbstractLevel{constructor(r,_,E){if(typeof _=="function"||typeof E=="function")throw new ModuleError("The levelup-style callback argument has been removed",{code:"LEVEL_LEGACY"});const{prefix:S,version:C,...A}=_||{};if(super({encodings:{view:!0},snapshots:!1,createIfMissing:!1,errorIfExists:!1,seek:!0},A),typeof r!="string")throw new Error("constructor requires a location string argument");this[kLocation]=r,this[kNamePrefix]=S??DEFAULT_PREFIX,this[kVersion]=parseInt(C||1,10),this[kIDB]=null}get location(){return this[kLocation]}get namePrefix(){return this[kNamePrefix]}get version(){return this[kVersion]}get db(){return this[kIDB]}get type(){return"browser-level"}_open(r,_){const E=indexedDB.open(this[kNamePrefix]+this[kLocation],this[kVersion]);E.onerror=function(){_(E.error||new Error("unknown error"))},E.onsuccess=()=>{this[kIDB]=E.result,_()},E.onupgradeneeded=S=>{const C=S.target.result;C.objectStoreNames.contains(this[kLocation])||C.createObjectStore(this[kLocation])}}[kStore](r){return this[kIDB].transaction([this[kLocation]],r).objectStore(this[kLocation])}[kOnComplete](r,_){const E=r.transaction;E.onabort=function(){_(E.error||new Error("aborted by user"))},E.oncomplete=function(){_(null,r.result)}}_get(r,_,E){const S=this[kStore]("readonly");let C;try{C=S.get(r)}catch(A){return this.nextTick(E,A)}this[kOnComplete](C,function(A,I){if(A)return E(A);if(I===void 0)return E(new ModuleError("Entry not found",{code:"LEVEL_NOT_FOUND"}));E(null,deserialize(I))})}_getMany(r,_,E){const S=this[kStore]("readonly"),C=r.map(A=>I=>{let B;try{B=S.get(A)}catch(O){return I(O)}B.onsuccess=()=>{const O=B.result;I(null,O===void 0?O:deserialize(O))},B.onerror=O=>{O.stopPropagation(),I(B.error)}});parallel$1(C,16,E)}_del(r,_,E){const S=this[kStore]("readwrite");let C;try{C=S.delete(r)}catch(A){return this.nextTick(E,A)}this[kOnComplete](C,E)}_put(r,_,E,S){const C=this[kStore]("readwrite");let A;try{A=C.put(_,r)}catch(I){return this.nextTick(S,I)}this[kOnComplete](A,S)}_iterator(r){return new Iterator(this,this[kLocation],r)}_batch(r,_,E){const S=this[kStore]("readwrite"),C=S.transaction;let A=0,I;C.onabort=function(){E(I||C.error||new Error("aborted by user"))},C.oncomplete=function(){E()};function B(){const O=r[A++],N=O.key;let U;try{U=O.type==="del"?S.delete(N):S.put(O.value,N)}catch(j){I=j,C.abort();return}A<r.length?U.onsuccess=B:typeof C.commit=="function"&&C.commit()}B()}_clear(r,_){let E,S;try{E=createKeyRange(r)}catch{return this.nextTick(_)}if(r.limit>=0)return clear(this,this[kLocation],E,r,_);try{const C=this[kStore]("readwrite");S=E?C.delete(E):C.clear()}catch(C){return this.nextTick(_,C)}this[kOnComplete](S,_)}_close(r){this[kIDB].close(),this.nextTick(r)}}BrowserLevel.destroy=function(n,r,_){typeof r=="function"&&(_=r,r=DEFAULT_PREFIX),_=fromCallback(_,kPromise);const E=indexedDB.deleteDatabase(r+n);return E.onsuccess=function(){_()},E.onerror=function(S){_(S)},_[kPromise]};browserLevel.BrowserLevel=BrowserLevel;var Level=browserLevel.BrowserLevel;const defaultPath$1="./level",defaultValueEncoding="view",LevelStorage=async({path:n,valueEncoding:r}={})=>{n=n||defaultPath$1,r=r||defaultValueEncoding;const _=new Level(n,{valueEncoding:r,passive:!0});return await _.open(),{put:async(N,U)=>{await _.put(N,U)},del:async N=>{await _.del(N)},get:async N=>{try{const U=await _.get(N);if(U)return U}catch{}},iterator:async function*(){for await(const[N,U]of _.iterator())yield[N,U]},merge:async N=>{},clear:async()=>{await _.clear()},close:async()=>{await _.close()}}},defaultSize=1e6,LRUStorage=async({size:n}={})=>{let r=new LRU$1(n||defaultSize);return{put:async(O,N)=>{r.set(O,N)},del:async O=>{r.remove(O)},get:async O=>r.get(O),iterator:async function*(){for await(const O of r.keys){const N=r.get(O);yield[O,N]}},merge:async O=>{if(O)for await(const[N,U]of O.iterator())r.set(N,U)},clear:async()=>{r=new LRU$1(n||defaultSize)},close:async()=>{}}},defaultReferencesCount=16,defaultCacheSize=1e3,Database=async({ipfs:n,identity:r,address:_,name:E,access:S,directory:C,meta:A,headsStorage:I,entryStorage:B,indexStorage:O,referencesCount:N,syncAutomatically:U,onUpdate:j})=>{C=posixJoin(C||"./orbitdb",`./${_}/`),A=A||{},N=Number(N)>-1?N:defaultReferencesCount,B=B||await ComposedStorage(await LRUStorage({size:defaultCacheSize}),await IPFSBlockStorage({ipfs:n,pin:!0})),I=I||await ComposedStorage(await LRUStorage({size:defaultCacheSize}),await LevelStorage({path:posixJoin(C,"/log/_heads/")})),O=O||await ComposedStorage(await LRUStorage({size:defaultCacheSize}),await LevelStorage({path:posixJoin(C,"/log/_index/")}));const z=await Log(r,{logId:_,access:S,entryStorage:B,headsStorage:I,indexStorage:O}),Z=new eventsExports.EventEmitter,X=new PQueue$1({concurrency:1}),Q=async Te=>{const xe=async()=>{const Ne=await z.append(Te,{referencesCount:N});return await we.add(Ne),j&&await j(z,Ne),Z.emit("update",Ne),Ne.hash},Re=await X.add(xe);return await X.onIdle(),Re},se=async Te=>{const xe=async()=>{const Re=await Entry.decode(Te);Re&&await z.joinEntry(Re)&&(j&&await j(z,Re),Z.emit("update",Re))};await X.add(xe)},oe=async()=>{await we.stop(),await X.onIdle(),await z.close(),S&&S.close&&await S.close(),Z.emit("close")},ue=async()=>{await X.onIdle(),await z.clear(),S&&S.drop&&await S.drop(),Z.emit("drop")},we=await Sync({ipfs:n,log:z,events:Z,onSynced:se,start:U});return{address:_,name:E,identity:r,meta:A,close:oe,drop:ue,addOperation:Q,log:z,sync:we,peers:we.peers,events:Z,access:S}},type$b="documents",DefaultOptions={indexBy:"_id"},Documents=({indexBy:n}=DefaultOptions)=>async({ipfs:r,identity:_,address:E,name:S,access:C,directory:A,meta:I,headsStorage:B,entryStorage:O,indexStorage:N,referencesCount:U,syncAutomatically:j,onUpdate:z})=>{const Z=await Database({ipfs:r,identity:_,address:E,name:S,access:C,directory:A,meta:I,headsStorage:B,entryStorage:O,indexStorage:N,referencesCount:U,syncAutomatically:j}),{addOperation:X,log:Q}=Z,se=async Re=>{const Ne=Re[n];if(!Ne)throw new Error(`The provided document doesn't contain field '${n}'`);return X({op:"PUT",key:Ne,value:Re})},oe=async Re=>{if(!await ue(Re))throw new Error(`No document with key '${Re}' in the database`);return X({op:"DEL",key:Re,value:null})},ue=async Re=>{for await(const Ne of Te())if(Re===Ne.key)return Ne},we=async Re=>{const Ne=[];for await(const Fe of Te())Re(Fe.value)&&Ne.push(Fe.value);return Ne},Te=async function*({amount:Re}={}){const Ne={};let Fe=0;for await(const ht of Q.iterator()){const{op:nt,key:Ee,value:Ce}=ht.payload;if(nt==="PUT"&&!Ne[Ee]?(Ne[Ee]=!0,Fe++,yield{hash:ht.hash,key:Ee,value:Ce}):nt==="DEL"&&!Ne[Ee]&&(Ne[Ee]=!0),Fe>=Re)break}};return{...Z,type:type$b,put:se,del:oe,get:ue,iterator:Te,query:we,indexBy:n,all:async()=>{const Re=[];for await(const Ne of Te())Re.unshift(Ne);return Re}}};Documents.type=type$b;const type$a="events",Events=()=>async({ipfs:n,identity:r,address:_,name:E,access:S,directory:C,meta:A,headsStorage:I,entryStorage:B,indexStorage:O,referencesCount:N,syncAutomatically:U,onUpdate:j})=>{const z=await Database({ipfs:n,identity:r,address:_,name:E,access:S,directory:C,meta:A,headsStorage:I,entryStorage:B,indexStorage:O,referencesCount:N,syncAutomatically:U,onUpdate:j}),{addOperation:Z,log:X}=z,Q=async we=>Z({op:"ADD",key:null,value:we}),se=async we=>(await X.get(we)).payload.value,oe=async function*({gt:we,gte:Te,lt:xe,lte:Re,amount:Ne}={}){const Fe=X.iterator({gt:we,gte:Te,lt:xe,lte:Re,amount:Ne});for await(const ht of Fe){const nt=ht.hash,Ee=ht.payload.value;yield{hash:nt,value:Ee}}};return{...z,type:type$a,add:Q,get:se,iterator:oe,all:async()=>{const we=[];for await(const Te of oe())we.unshift(Te);return we}}};Events.type=type$a;const type$9="keyvalue",KeyValue=()=>async({ipfs:n,identity:r,address:_,name:E,access:S,directory:C,meta:A,headsStorage:I,entryStorage:B,indexStorage:O,referencesCount:N,syncAutomatically:U,onUpdate:j})=>{const z=await Database({ipfs:n,identity:r,address:_,name:E,access:S,directory:C,meta:A,headsStorage:I,entryStorage:B,indexStorage:O,referencesCount:N,syncAutomatically:U,onUpdate:j}),{addOperation:Z,log:X}=z,Q=async(Te,xe)=>Z({op:"PUT",key:Te,value:xe}),se=async Te=>Z({op:"DEL",key:Te,value:null}),oe=async Te=>{for await(const xe of X.traverse()){const{op:Re,key:Ne,value:Fe}=xe.payload;if(Re==="PUT"&&Ne===Te)return Fe;if(Re==="DEL"&&Ne===Te)return}},ue=async function*({amount:Te}={}){const xe={};let Re=0;for await(const Ne of X.traverse()){const{op:Fe,key:ht,value:nt}=Ne.payload;if(Fe==="PUT"&&!xe[ht]){xe[ht]=!0,Re++;const Ee=Ne.hash;yield{key:ht,value:nt,hash:Ee}}else Fe==="DEL"&&!xe[ht]&&(xe[ht]=!0);if(Re>=Te)break}};return{...z,type:type$9,put:Q,set:Q,del:se,get:oe,iterator:ue,all:async()=>{const Te=[];for await(const xe of ue())Te.unshift(xe);return Te}}};KeyValue.type=type$9;const databaseTypes={},useDatabaseType=n=>{if(!n.type)throw new Error("Database type does not contain required field 'type'.");databaseTypes[n.type]=n},getDatabaseType=n=>{if(!n)throw new Error("Type not specified");if(!databaseTypes[n])throw new Error(`Unsupported database type: '${n}'`);return databaseTypes[n]};useDatabaseType(Events);useDatabaseType(Documents);useDatabaseType(KeyValue);const connectionSymbol=Symbol.for("@libp2p/connection"),contentRoutingSymbol=Symbol.for("@libp2p/content-routing"),peerDiscoverySymbol=Symbol.for("@libp2p/peer-discovery"),peerIdSymbol=Symbol.for("@libp2p/peer-id");function isPeerId$1(n){return n!=null&&!!n[peerIdSymbol]}const peerRoutingSymbol=Symbol.for("@libp2p/peer-routing"),KEEP_ALIVE="keep-alive",StrictSign="StrictSign",StrictNoSign="StrictNoSign";var TopicValidatorResult;(function(n){n.Accept="accept",n.Ignore="ignore",n.Reject="reject"})(TopicValidatorResult||(TopicValidatorResult={}));const transportSymbol=Symbol.for("@libp2p/transport");var FaultTolerance;(function(n){n[n.FATAL_ALL=0]="FATAL_ALL",n[n.NO_FATAL=1]="NO_FATAL"})(FaultTolerance||(FaultTolerance={}));let AbortError$5=class $o extends Error{code;type;constructor(r="The operation was aborted"){super(r),this.code=$o.code,this.type=$o.type}static code="ABORT_ERR";static type="aborted"},CodeError$4=class extends Error{code;props;constructor(r,_,E){super(r),this.code=_,this.name=E?.name??"CodeError",this.props=E??{}}};class AggregateCodeError extends AggregateError{code;props;constructor(r,_,E,S){super(r,_),this.code=E,this.name=S?.name??"AggregateCodeError",this.props=S??{}}}const ERR_TIMEOUT="ERR_TIMEOUT",ERR_NOT_FOUND="ERR_NOT_FOUND",ERR_INVALID_MESSAGE="ERR_INVALID_MESSAGE";function setMaxListeners$3(){}const setMaxListeners$2=(n,...r)=>{try{[...r]}catch{}};class TypedEventEmitter extends EventTarget{#e=new Map;constructor(){super(),setMaxListeners$2(1/0,this)}listenerCount(r){const _=this.#e.get(r);return _==null?0:_.length}addEventListener(r,_,E){super.addEventListener(r,_,E);let S=this.#e.get(r);S==null&&(S=[],this.#e.set(r,S)),S.push({callback:_,once:(E!==!0&&E!==!1&&E?.once)??!1})}removeEventListener(r,_,E){super.removeEventListener(r.toString(),_??null,E);let S=this.#e.get(r);S!=null&&(S=S.filter(({callback:C})=>C!==_),this.#e.set(r,S))}dispatchEvent(r){const _=super.dispatchEvent(r);let E=this.#e.get(r.type);return E==null||(E=E.filter(({once:S})=>!S),this.#e.set(r.type,E)),_}safeDispatchEvent(r,_={}){return this.dispatchEvent(new CustomEvent$1(r,_))}}class CustomEventPolyfill extends Event{detail;constructor(r,_){super(r,_),this.detail=_?.detail}}const CustomEvent$1=globalThis.CustomEvent??CustomEventPolyfill;function isStartable(n){return n!=null&&typeof n.start=="function"&&typeof n.stop=="function"}async function start(...n){const r=[];for(const _ of n)isStartable(_)&&r.push(_);await Promise.all(r.map(async _=>{_.beforeStart!=null&&await _.beforeStart()})),await Promise.all(r.map(async _=>{await _.start()})),await Promise.all(r.map(async _=>{_.afterStart!=null&&await _.afterStart()}))}async function stop(...n){const r=[];for(const _ of n)isStartable(_)&&r.push(_);await Promise.all(r.map(async _=>{_.beforeStop!=null&&await _.beforeStop()})),await Promise.all(r.map(async _=>{await _.stop()})),await Promise.all(r.map(async _=>{_.afterStop!=null&&await _.afterStop()}))}var forge$m={options:{usePureJavaScript:!1}};const forge$n=getDefaultExportFromCjs(forge$m);var api$1={},baseN$1=api$1,_reverseAlphabets={};api$1.encode=function(n,r,_){if(typeof r!="string")throw new TypeError('"alphabet" must be a string.');if(_!==void 0&&typeof _!="number")throw new TypeError('"maxline" must be a number.');var E="";if(!(n instanceof Uint8Array))E=_encodeWithByteBuffer(n,r);else{var S=0,C=r.length,A=r.charAt(0),I=[0];for(S=0;S<n.length;++S){for(var B=0,O=n[S];B<I.length;++B)O+=I[B]<<8,I[B]=O%C,O=O/C|0;for(;O>0;)I.push(O%C),O=O/C|0}for(S=0;n[S]===0&&S<n.length-1;++S)E+=A;for(S=I.length-1;S>=0;--S)E+=r[I[S]]}if(_){var N=new RegExp(".{1,"+_+"}","g");E=E.match(N).join(`\r
`)}return E};api$1.decode=function(n,r){if(typeof n!="string")throw new TypeError('"input" must be a string.');if(typeof r!="string")throw new TypeError('"alphabet" must be a string.');var _=_reverseAlphabets[r];if(!_){_=_reverseAlphabets[r]=[];for(var E=0;E<r.length;++E)_[r.charCodeAt(E)]=E}n=n.replace(/\s/g,"");for(var S=r.length,C=r.charAt(0),A=[0],E=0;E<n.length;E++){var I=_[n.charCodeAt(E)];if(I===void 0)return;for(var B=0,O=I;B<A.length;++B)O+=A[B]*S,A[B]=O&255,O>>=8;for(;O>0;)A.push(O&255),O>>=8}for(var N=0;n[N]===C&&N<n.length-1;++N)A.push(0);return typeof Buffer$4<"u"?Buffer$4.from(A.reverse()):new Uint8Array(A.reverse())};function _encodeWithByteBuffer(n,r){var _=0,E=r.length,S=r.charAt(0),C=[0];for(_=0;_<n.length();++_){for(var A=0,I=n.at(_);A<C.length;++A)I+=C[A]<<8,C[A]=I%E,I=I/E|0;for(;I>0;)C.push(I%E),I=I/E|0}var B="";for(_=0;n.at(_)===0&&_<n.length()-1;++_)B+=S;for(_=C.length-1;_>=0;--_)B+=r[C[_]];return B}var forge$l=forge$m,baseN=baseN$1,util$5=forge$l.util=forge$l.util||{};(function(){if(typeof browser$1$1<"u"&&browser$1$1.nextTick&&!browser$1$1.browser){util$5.nextTick=browser$1$1.nextTick,typeof setImmediate=="function"?util$5.setImmediate=setImmediate:util$5.setImmediate=util$5.nextTick;return}if(typeof setImmediate=="function"){util$5.setImmediate=function(){return setImmediate.apply(void 0,arguments)},util$5.nextTick=function(A){return setImmediate(A)};return}if(util$5.setImmediate=function(A){setTimeout(A,0)},typeof window<"u"&&typeof window.postMessage=="function"){let A=function(I){if(I.source===window&&I.data===n){I.stopPropagation();var B=r.slice();r.length=0,B.forEach(function(O){O()})}};var n="forge.setImmediate",r=[];util$5.setImmediate=function(I){r.push(I),r.length===1&&window.postMessage(n,"*")},window.addEventListener("message",A,!0)}if(typeof MutationObserver<"u"){var _=Date.now(),E=!0,S=document.createElement("div"),r=[];new MutationObserver(function(){var I=r.slice();r.length=0,I.forEach(function(B){B()})}).observe(S,{attributes:!0});var C=util$5.setImmediate;util$5.setImmediate=function(I){Date.now()-_>15?(_=Date.now(),C(I)):(r.push(I),r.length===1&&S.setAttribute("a",E=!E))}}util$5.nextTick=util$5.setImmediate})();util$5.isNodejs=typeof browser$1$1<"u"&&browser$1$1.versions&&browser$1$1.versions.node;util$5.globalScope=function(){return util$5.isNodejs?commonjsGlobal:typeof self>"u"?window:self}();util$5.isArray=Array.isArray||function(n){return Object.prototype.toString.call(n)==="[object Array]"};util$5.isArrayBuffer=function(n){return typeof ArrayBuffer<"u"&&n instanceof ArrayBuffer};util$5.isArrayBufferView=function(n){return n&&util$5.isArrayBuffer(n.buffer)&&n.byteLength!==void 0};function _checkBitsParam(n){if(!(n===8||n===16||n===24||n===32))throw new Error("Only 8, 16, 24, or 32 bits supported: "+n)}util$5.ByteBuffer=ByteStringBuffer;function ByteStringBuffer(n){if(this.data="",this.read=0,typeof n=="string")this.data=n;else if(util$5.isArrayBuffer(n)||util$5.isArrayBufferView(n))if(typeof Buffer$4<"u"&&n instanceof Buffer$4)this.data=n.toString("binary");else{var r=new Uint8Array(n);try{this.data=String.fromCharCode.apply(null,r)}catch{for(var _=0;_<r.length;++_)this.putByte(r[_])}}else(n instanceof ByteStringBuffer||typeof n=="object"&&typeof n.data=="string"&&typeof n.read=="number")&&(this.data=n.data,this.read=n.read);this._constructedStringLength=0}util$5.ByteStringBuffer=ByteStringBuffer;var _MAX_CONSTRUCTED_STRING_LENGTH=4096;util$5.ByteStringBuffer.prototype._optimizeConstructedString=function(n){this._constructedStringLength+=n,this._constructedStringLength>_MAX_CONSTRUCTED_STRING_LENGTH&&(this.data.substr(0,1),this._constructedStringLength=0)};util$5.ByteStringBuffer.prototype.length=function(){return this.data.length-this.read};util$5.ByteStringBuffer.prototype.isEmpty=function(){return this.length()<=0};util$5.ByteStringBuffer.prototype.putByte=function(n){return this.putBytes(String.fromCharCode(n))};util$5.ByteStringBuffer.prototype.fillWithByte=function(n,r){n=String.fromCharCode(n);for(var _=this.data;r>0;)r&1&&(_+=n),r>>>=1,r>0&&(n+=n);return this.data=_,this._optimizeConstructedString(r),this};util$5.ByteStringBuffer.prototype.putBytes=function(n){return this.data+=n,this._optimizeConstructedString(n.length),this};util$5.ByteStringBuffer.prototype.putString=function(n){return this.putBytes(util$5.encodeUtf8(n))};util$5.ByteStringBuffer.prototype.putInt16=function(n){return this.putBytes(String.fromCharCode(n>>8&255)+String.fromCharCode(n&255))};util$5.ByteStringBuffer.prototype.putInt24=function(n){return this.putBytes(String.fromCharCode(n>>16&255)+String.fromCharCode(n>>8&255)+String.fromCharCode(n&255))};util$5.ByteStringBuffer.prototype.putInt32=function(n){return this.putBytes(String.fromCharCode(n>>24&255)+String.fromCharCode(n>>16&255)+String.fromCharCode(n>>8&255)+String.fromCharCode(n&255))};util$5.ByteStringBuffer.prototype.putInt16Le=function(n){return this.putBytes(String.fromCharCode(n&255)+String.fromCharCode(n>>8&255))};util$5.ByteStringBuffer.prototype.putInt24Le=function(n){return this.putBytes(String.fromCharCode(n&255)+String.fromCharCode(n>>8&255)+String.fromCharCode(n>>16&255))};util$5.ByteStringBuffer.prototype.putInt32Le=function(n){return this.putBytes(String.fromCharCode(n&255)+String.fromCharCode(n>>8&255)+String.fromCharCode(n>>16&255)+String.fromCharCode(n>>24&255))};util$5.ByteStringBuffer.prototype.putInt=function(n,r){_checkBitsParam(r);var _="";do r-=8,_+=String.fromCharCode(n>>r&255);while(r>0);return this.putBytes(_)};util$5.ByteStringBuffer.prototype.putSignedInt=function(n,r){return n<0&&(n+=2<<r-1),this.putInt(n,r)};util$5.ByteStringBuffer.prototype.putBuffer=function(n){return this.putBytes(n.getBytes())};util$5.ByteStringBuffer.prototype.getByte=function(){return this.data.charCodeAt(this.read++)};util$5.ByteStringBuffer.prototype.getInt16=function(){var n=this.data.charCodeAt(this.read)<<8^this.data.charCodeAt(this.read+1);return this.read+=2,n};util$5.ByteStringBuffer.prototype.getInt24=function(){var n=this.data.charCodeAt(this.read)<<16^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2);return this.read+=3,n};util$5.ByteStringBuffer.prototype.getInt32=function(){var n=this.data.charCodeAt(this.read)<<24^this.data.charCodeAt(this.read+1)<<16^this.data.charCodeAt(this.read+2)<<8^this.data.charCodeAt(this.read+3);return this.read+=4,n};util$5.ByteStringBuffer.prototype.getInt16Le=function(){var n=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8;return this.read+=2,n};util$5.ByteStringBuffer.prototype.getInt24Le=function(){var n=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16;return this.read+=3,n};util$5.ByteStringBuffer.prototype.getInt32Le=function(){var n=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16^this.data.charCodeAt(this.read+3)<<24;return this.read+=4,n};util$5.ByteStringBuffer.prototype.getInt=function(n){_checkBitsParam(n);var r=0;do r=(r<<8)+this.data.charCodeAt(this.read++),n-=8;while(n>0);return r};util$5.ByteStringBuffer.prototype.getSignedInt=function(n){var r=this.getInt(n),_=2<<n-2;return r>=_&&(r-=_<<1),r};util$5.ByteStringBuffer.prototype.getBytes=function(n){var r;return n?(n=Math.min(this.length(),n),r=this.data.slice(this.read,this.read+n),this.read+=n):n===0?r="":(r=this.read===0?this.data:this.data.slice(this.read),this.clear()),r};util$5.ByteStringBuffer.prototype.bytes=function(n){return typeof n>"u"?this.data.slice(this.read):this.data.slice(this.read,this.read+n)};util$5.ByteStringBuffer.prototype.at=function(n){return this.data.charCodeAt(this.read+n)};util$5.ByteStringBuffer.prototype.setAt=function(n,r){return this.data=this.data.substr(0,this.read+n)+String.fromCharCode(r)+this.data.substr(this.read+n+1),this};util$5.ByteStringBuffer.prototype.last=function(){return this.data.charCodeAt(this.data.length-1)};util$5.ByteStringBuffer.prototype.copy=function(){var n=util$5.createBuffer(this.data);return n.read=this.read,n};util$5.ByteStringBuffer.prototype.compact=function(){return this.read>0&&(this.data=this.data.slice(this.read),this.read=0),this};util$5.ByteStringBuffer.prototype.clear=function(){return this.data="",this.read=0,this};util$5.ByteStringBuffer.prototype.truncate=function(n){var r=Math.max(0,this.length()-n);return this.data=this.data.substr(this.read,r),this.read=0,this};util$5.ByteStringBuffer.prototype.toHex=function(){for(var n="",r=this.read;r<this.data.length;++r){var _=this.data.charCodeAt(r);_<16&&(n+="0"),n+=_.toString(16)}return n};util$5.ByteStringBuffer.prototype.toString=function(){return util$5.decodeUtf8(this.bytes())};function DataBuffer(n,r){r=r||{},this.read=r.readOffset||0,this.growSize=r.growSize||1024;var _=util$5.isArrayBuffer(n),E=util$5.isArrayBufferView(n);if(_||E){_?this.data=new DataView(n):this.data=new DataView(n.buffer,n.byteOffset,n.byteLength),this.write="writeOffset"in r?r.writeOffset:this.data.byteLength;return}this.data=new DataView(new ArrayBuffer(0)),this.write=0,n!=null&&this.putBytes(n),"writeOffset"in r&&(this.write=r.writeOffset)}util$5.DataBuffer=DataBuffer;util$5.DataBuffer.prototype.length=function(){return this.write-this.read};util$5.DataBuffer.prototype.isEmpty=function(){return this.length()<=0};util$5.DataBuffer.prototype.accommodate=function(n,r){if(this.length()>=n)return this;r=Math.max(r||this.growSize,n);var _=new Uint8Array(this.data.buffer,this.data.byteOffset,this.data.byteLength),E=new Uint8Array(this.length()+r);return E.set(_),this.data=new DataView(E.buffer),this};util$5.DataBuffer.prototype.putByte=function(n){return this.accommodate(1),this.data.setUint8(this.write++,n),this};util$5.DataBuffer.prototype.fillWithByte=function(n,r){this.accommodate(r);for(var _=0;_<r;++_)this.data.setUint8(n);return this};util$5.DataBuffer.prototype.putBytes=function(n,r){if(util$5.isArrayBufferView(n)){var _=new Uint8Array(n.buffer,n.byteOffset,n.byteLength),E=_.byteLength-_.byteOffset;this.accommodate(E);var S=new Uint8Array(this.data.buffer,this.write);return S.set(_),this.write+=E,this}if(util$5.isArrayBuffer(n)){var _=new Uint8Array(n);this.accommodate(_.byteLength);var S=new Uint8Array(this.data.buffer);return S.set(_,this.write),this.write+=_.byteLength,this}if(n instanceof util$5.DataBuffer||typeof n=="object"&&typeof n.read=="number"&&typeof n.write=="number"&&util$5.isArrayBufferView(n.data)){var _=new Uint8Array(n.data.byteLength,n.read,n.length());this.accommodate(_.byteLength);var S=new Uint8Array(n.data.byteLength,this.write);return S.set(_),this.write+=_.byteLength,this}if(n instanceof util$5.ByteStringBuffer&&(n=n.data,r="binary"),r=r||"binary",typeof n=="string"){var C;if(r==="hex")return this.accommodate(Math.ceil(n.length/2)),C=new Uint8Array(this.data.buffer,this.write),this.write+=util$5.binary.hex.decode(n,C,this.write),this;if(r==="base64")return this.accommodate(Math.ceil(n.length/4)*3),C=new Uint8Array(this.data.buffer,this.write),this.write+=util$5.binary.base64.decode(n,C,this.write),this;if(r==="utf8"&&(n=util$5.encodeUtf8(n),r="binary"),r==="binary"||r==="raw")return this.accommodate(n.length),C=new Uint8Array(this.data.buffer,this.write),this.write+=util$5.binary.raw.decode(C),this;if(r==="utf16")return this.accommodate(n.length*2),C=new Uint16Array(this.data.buffer,this.write),this.write+=util$5.text.utf16.encode(C),this;throw new Error("Invalid encoding: "+r)}throw Error("Invalid parameter: "+n)};util$5.DataBuffer.prototype.putBuffer=function(n){return this.putBytes(n),n.clear(),this};util$5.DataBuffer.prototype.putString=function(n){return this.putBytes(n,"utf16")};util$5.DataBuffer.prototype.putInt16=function(n){return this.accommodate(2),this.data.setInt16(this.write,n),this.write+=2,this};util$5.DataBuffer.prototype.putInt24=function(n){return this.accommodate(3),this.data.setInt16(this.write,n>>8&65535),this.data.setInt8(this.write,n>>16&255),this.write+=3,this};util$5.DataBuffer.prototype.putInt32=function(n){return this.accommodate(4),this.data.setInt32(this.write,n),this.write+=4,this};util$5.DataBuffer.prototype.putInt16Le=function(n){return this.accommodate(2),this.data.setInt16(this.write,n,!0),this.write+=2,this};util$5.DataBuffer.prototype.putInt24Le=function(n){return this.accommodate(3),this.data.setInt8(this.write,n>>16&255),this.data.setInt16(this.write,n>>8&65535,!0),this.write+=3,this};util$5.DataBuffer.prototype.putInt32Le=function(n){return this.accommodate(4),this.data.setInt32(this.write,n,!0),this.write+=4,this};util$5.DataBuffer.prototype.putInt=function(n,r){_checkBitsParam(r),this.accommodate(r/8);do r-=8,this.data.setInt8(this.write++,n>>r&255);while(r>0);return this};util$5.DataBuffer.prototype.putSignedInt=function(n,r){return _checkBitsParam(r),this.accommodate(r/8),n<0&&(n+=2<<r-1),this.putInt(n,r)};util$5.DataBuffer.prototype.getByte=function(){return this.data.getInt8(this.read++)};util$5.DataBuffer.prototype.getInt16=function(){var n=this.data.getInt16(this.read);return this.read+=2,n};util$5.DataBuffer.prototype.getInt24=function(){var n=this.data.getInt16(this.read)<<8^this.data.getInt8(this.read+2);return this.read+=3,n};util$5.DataBuffer.prototype.getInt32=function(){var n=this.data.getInt32(this.read);return this.read+=4,n};util$5.DataBuffer.prototype.getInt16Le=function(){var n=this.data.getInt16(this.read,!0);return this.read+=2,n};util$5.DataBuffer.prototype.getInt24Le=function(){var n=this.data.getInt8(this.read)^this.data.getInt16(this.read+1,!0)<<8;return this.read+=3,n};util$5.DataBuffer.prototype.getInt32Le=function(){var n=this.data.getInt32(this.read,!0);return this.read+=4,n};util$5.DataBuffer.prototype.getInt=function(n){_checkBitsParam(n);var r=0;do r=(r<<8)+this.data.getInt8(this.read++),n-=8;while(n>0);return r};util$5.DataBuffer.prototype.getSignedInt=function(n){var r=this.getInt(n),_=2<<n-2;return r>=_&&(r-=_<<1),r};util$5.DataBuffer.prototype.getBytes=function(n){var r;return n?(n=Math.min(this.length(),n),r=this.data.slice(this.read,this.read+n),this.read+=n):n===0?r="":(r=this.read===0?this.data:this.data.slice(this.read),this.clear()),r};util$5.DataBuffer.prototype.bytes=function(n){return typeof n>"u"?this.data.slice(this.read):this.data.slice(this.read,this.read+n)};util$5.DataBuffer.prototype.at=function(n){return this.data.getUint8(this.read+n)};util$5.DataBuffer.prototype.setAt=function(n,r){return this.data.setUint8(n,r),this};util$5.DataBuffer.prototype.last=function(){return this.data.getUint8(this.write-1)};util$5.DataBuffer.prototype.copy=function(){return new util$5.DataBuffer(this)};util$5.DataBuffer.prototype.compact=function(){if(this.read>0){var n=new Uint8Array(this.data.buffer,this.read),r=new Uint8Array(n.byteLength);r.set(n),this.data=new DataView(r),this.write-=this.read,this.read=0}return this};util$5.DataBuffer.prototype.clear=function(){return this.data=new DataView(new ArrayBuffer(0)),this.read=this.write=0,this};util$5.DataBuffer.prototype.truncate=function(n){return this.write=Math.max(0,this.length()-n),this.read=Math.min(this.read,this.write),this};util$5.DataBuffer.prototype.toHex=function(){for(var n="",r=this.read;r<this.data.byteLength;++r){var _=this.data.getUint8(r);_<16&&(n+="0"),n+=_.toString(16)}return n};util$5.DataBuffer.prototype.toString=function(n){var r=new Uint8Array(this.data,this.read,this.length());if(n=n||"utf8",n==="binary"||n==="raw")return util$5.binary.raw.encode(r);if(n==="hex")return util$5.binary.hex.encode(r);if(n==="base64")return util$5.binary.base64.encode(r);if(n==="utf8")return util$5.text.utf8.decode(r);if(n==="utf16")return util$5.text.utf16.decode(r);throw new Error("Invalid encoding: "+n)};util$5.createBuffer=function(n,r){return r=r||"raw",n!==void 0&&r==="utf8"&&(n=util$5.encodeUtf8(n)),new util$5.ByteBuffer(n)};util$5.fillString=function(n,r){for(var _="";r>0;)r&1&&(_+=n),r>>>=1,r>0&&(n+=n);return _};util$5.xorBytes=function(n,r,_){for(var E="",S="",C="",A=0,I=0;_>0;--_,++A)S=n.charCodeAt(A)^r.charCodeAt(A),I>=10&&(E+=C,C="",I=0),C+=String.fromCharCode(S),++I;return E+=C,E};util$5.hexToBytes=function(n){var r="",_=0;for(n.length&!0&&(_=1,r+=String.fromCharCode(parseInt(n[0],16)));_<n.length;_+=2)r+=String.fromCharCode(parseInt(n.substr(_,2),16));return r};util$5.bytesToHex=function(n){return util$5.createBuffer(n).toHex()};util$5.int32ToBytes=function(n){return String.fromCharCode(n>>24&255)+String.fromCharCode(n>>16&255)+String.fromCharCode(n>>8&255)+String.fromCharCode(n&255)};var _base64="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",_base64Idx=[62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,64,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51],_base58="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz";util$5.encode64=function(n,r){for(var _="",E="",S,C,A,I=0;I<n.length;)S=n.charCodeAt(I++),C=n.charCodeAt(I++),A=n.charCodeAt(I++),_+=_base64.charAt(S>>2),_+=_base64.charAt((S&3)<<4|C>>4),isNaN(C)?_+="==":(_+=_base64.charAt((C&15)<<2|A>>6),_+=isNaN(A)?"=":_base64.charAt(A&63)),r&&_.length>r&&(E+=_.substr(0,r)+`\r
`,_=_.substr(r));return E+=_,E};util$5.decode64=function(n){n=n.replace(/[^A-Za-z0-9\+\/\=]/g,"");for(var r="",_,E,S,C,A=0;A<n.length;)_=_base64Idx[n.charCodeAt(A++)-43],E=_base64Idx[n.charCodeAt(A++)-43],S=_base64Idx[n.charCodeAt(A++)-43],C=_base64Idx[n.charCodeAt(A++)-43],r+=String.fromCharCode(_<<2|E>>4),S!==64&&(r+=String.fromCharCode((E&15)<<4|S>>2),C!==64&&(r+=String.fromCharCode((S&3)<<6|C)));return r};util$5.encodeUtf8=function(n){return unescape(encodeURIComponent(n))};util$5.decodeUtf8=function(n){return decodeURIComponent(escape(n))};util$5.binary={raw:{},hex:{},base64:{},base58:{},baseN:{encode:baseN.encode,decode:baseN.decode}};util$5.binary.raw.encode=function(n){return String.fromCharCode.apply(null,n)};util$5.binary.raw.decode=function(n,r,_){var E=r;E||(E=new Uint8Array(n.length)),_=_||0;for(var S=_,C=0;C<n.length;++C)E[S++]=n.charCodeAt(C);return r?S-_:E};util$5.binary.hex.encode=util$5.bytesToHex;util$5.binary.hex.decode=function(n,r,_){var E=r;E||(E=new Uint8Array(Math.ceil(n.length/2))),_=_||0;var S=0,C=_;for(n.length&1&&(S=1,E[C++]=parseInt(n[0],16));S<n.length;S+=2)E[C++]=parseInt(n.substr(S,2),16);return r?C-_:E};util$5.binary.base64.encode=function(n,r){for(var _="",E="",S,C,A,I=0;I<n.byteLength;)S=n[I++],C=n[I++],A=n[I++],_+=_base64.charAt(S>>2),_+=_base64.charAt((S&3)<<4|C>>4),isNaN(C)?_+="==":(_+=_base64.charAt((C&15)<<2|A>>6),_+=isNaN(A)?"=":_base64.charAt(A&63)),r&&_.length>r&&(E+=_.substr(0,r)+`\r
`,_=_.substr(r));return E+=_,E};util$5.binary.base64.decode=function(n,r,_){var E=r;E||(E=new Uint8Array(Math.ceil(n.length/4)*3)),n=n.replace(/[^A-Za-z0-9\+\/\=]/g,""),_=_||0;for(var S,C,A,I,B=0,O=_;B<n.length;)S=_base64Idx[n.charCodeAt(B++)-43],C=_base64Idx[n.charCodeAt(B++)-43],A=_base64Idx[n.charCodeAt(B++)-43],I=_base64Idx[n.charCodeAt(B++)-43],E[O++]=S<<2|C>>4,A!==64&&(E[O++]=(C&15)<<4|A>>2,I!==64&&(E[O++]=(A&3)<<6|I));return r?O-_:E.subarray(0,O)};util$5.binary.base58.encode=function(n,r){return util$5.binary.baseN.encode(n,_base58,r)};util$5.binary.base58.decode=function(n,r){return util$5.binary.baseN.decode(n,_base58,r)};util$5.text={utf8:{},utf16:{}};util$5.text.utf8.encode=function(n,r,_){n=util$5.encodeUtf8(n);var E=r;E||(E=new Uint8Array(n.length)),_=_||0;for(var S=_,C=0;C<n.length;++C)E[S++]=n.charCodeAt(C);return r?S-_:E};util$5.text.utf8.decode=function(n){return util$5.decodeUtf8(String.fromCharCode.apply(null,n))};util$5.text.utf16.encode=function(n,r,_){var E=r;E||(E=new Uint8Array(n.length*2));var S=new Uint16Array(E.buffer);_=_||0;for(var C=_,A=_,I=0;I<n.length;++I)S[A++]=n.charCodeAt(I),C+=2;return r?C-_:E};util$5.text.utf16.decode=function(n){return String.fromCharCode.apply(null,new Uint16Array(n.buffer))};util$5.deflate=function(n,r,_){if(r=util$5.decode64(n.deflate(util$5.encode64(r)).rval),_){var E=2,S=r.charCodeAt(1);S&32&&(E=6),r=r.substring(E,r.length-4)}return r};util$5.inflate=function(n,r,_){var E=n.inflate(util$5.encode64(r)).rval;return E===null?null:util$5.decode64(E)};var _setStorageObject=function(n,r,_){if(!n)throw new Error("WebStorage not available.");var E;if(_===null?E=n.removeItem(r):(_=util$5.encode64(JSON.stringify(_)),E=n.setItem(r,_)),typeof E<"u"&&E.rval!==!0){var S=new Error(E.error.message);throw S.id=E.error.id,S.name=E.error.name,S}},_getStorageObject=function(n,r){if(!n)throw new Error("WebStorage not available.");var _=n.getItem(r);if(n.init)if(_.rval===null){if(_.error){var E=new Error(_.error.message);throw E.id=_.error.id,E.name=_.error.name,E}_=null}else _=_.rval;return _!==null&&(_=JSON.parse(util$5.decode64(_))),_},_setItem=function(n,r,_,E){var S=_getStorageObject(n,r);S===null&&(S={}),S[_]=E,_setStorageObject(n,r,S)},_getItem=function(n,r,_){var E=_getStorageObject(n,r);return E!==null&&(E=_ in E?E[_]:null),E},_removeItem=function(n,r,_){var E=_getStorageObject(n,r);if(E!==null&&_ in E){delete E[_];var S=!0;for(var C in E){S=!1;break}S&&(E=null),_setStorageObject(n,r,E)}},_clearItems=function(n,r){_setStorageObject(n,r,null)},_callStorageFunction=function(n,r,_){var E=null;typeof _>"u"&&(_=["web","flash"]);var S,C=!1,A=null;for(var I in _){S=_[I];try{if(S==="flash"||S==="both"){if(r[0]===null)throw new Error("Flash local storage not available.");E=n.apply(this,r),C=S==="flash"}(S==="web"||S==="both")&&(r[0]=localStorage,E=n.apply(this,r),C=!0)}catch(B){A=B}if(C)break}if(!C)throw A;return E};util$5.setItem=function(n,r,_,E,S){_callStorageFunction(_setItem,arguments,S)};util$5.getItem=function(n,r,_,E){return _callStorageFunction(_getItem,arguments,E)};util$5.removeItem=function(n,r,_,E){_callStorageFunction(_removeItem,arguments,E)};util$5.clearItems=function(n,r,_){_callStorageFunction(_clearItems,arguments,_)};util$5.isEmpty=function(n){for(var r in n)if(n.hasOwnProperty(r))return!1;return!0};util$5.format=function(n){for(var r=/%./g,_,E,S=0,C=[],A=0;_=r.exec(n);){E=n.substring(A,r.lastIndex-2),E.length>0&&C.push(E),A=r.lastIndex;var I=_[0][1];switch(I){case"s":case"o":S<arguments.length?C.push(arguments[S+++1]):C.push("<?>");break;case"%":C.push("%");break;default:C.push("<%"+I+"?>")}}return C.push(n.substring(A)),C.join("")};util$5.formatNumber=function(n,r,_,E){var S=n,C=isNaN(r=Math.abs(r))?2:r,A=_===void 0?",":_,I=E===void 0?".":E,B=S<0?"-":"",O=parseInt(S=Math.abs(+S||0).toFixed(C),10)+"",N=O.length>3?O.length%3:0;return B+(N?O.substr(0,N)+I:"")+O.substr(N).replace(/(\d{3})(?=\d)/g,"$1"+I)+(C?A+Math.abs(S-O).toFixed(C).slice(2):"")};util$5.formatSize=function(n){return n>=1073741824?n=util$5.formatNumber(n/1073741824,2,".","")+" GiB":n>=1048576?n=util$5.formatNumber(n/1048576,2,".","")+" MiB":n>=1024?n=util$5.formatNumber(n/1024,0)+" KiB":n=util$5.formatNumber(n,0)+" bytes",n};util$5.bytesFromIP=function(n){return n.indexOf(".")!==-1?util$5.bytesFromIPv4(n):n.indexOf(":")!==-1?util$5.bytesFromIPv6(n):null};util$5.bytesFromIPv4=function(n){if(n=n.split("."),n.length!==4)return null;for(var r=util$5.createBuffer(),_=0;_<n.length;++_){var E=parseInt(n[_],10);if(isNaN(E))return null;r.putByte(E)}return r.getBytes()};util$5.bytesFromIPv6=function(n){var r=0;n=n.split(":").filter(function(A){return A.length===0&&++r,!0});for(var _=(8-n.length+r)*2,E=util$5.createBuffer(),S=0;S<8;++S){if(!n[S]||n[S].length===0){E.fillWithByte(0,_),_=0;continue}var C=util$5.hexToBytes(n[S]);C.length<2&&E.putByte(0),E.putBytes(C)}return E.getBytes()};util$5.bytesToIP=function(n){return n.length===4?util$5.bytesToIPv4(n):n.length===16?util$5.bytesToIPv6(n):null};util$5.bytesToIPv4=function(n){if(n.length!==4)return null;for(var r=[],_=0;_<n.length;++_)r.push(n.charCodeAt(_));return r.join(".")};util$5.bytesToIPv6=function(n){if(n.length!==16)return null;for(var r=[],_=[],E=0,S=0;S<n.length;S+=2){for(var C=util$5.bytesToHex(n[S]+n[S+1]);C[0]==="0"&&C!=="0";)C=C.substr(1);if(C==="0"){var A=_[_.length-1],I=r.length;!A||I!==A.end+1?_.push({start:I,end:I}):(A.end=I,A.end-A.start>_[E].end-_[E].start&&(E=_.length-1))}r.push(C)}if(_.length>0){var B=_[E];B.end-B.start>0&&(r.splice(B.start,B.end-B.start+1,""),B.start===0&&r.unshift(""),B.end===7&&r.push(""))}return r.join(":")};util$5.estimateCores=function(n,r){if(typeof n=="function"&&(r=n,n={}),n=n||{},"cores"in util$5&&!n.update)return r(null,util$5.cores);if(typeof navigator<"u"&&"hardwareConcurrency"in navigator&&navigator.hardwareConcurrency>0)return util$5.cores=navigator.hardwareConcurrency,r(null,util$5.cores);if(typeof Worker>"u")return util$5.cores=1,r(null,util$5.cores);if(typeof Blob>"u")return util$5.cores=2,r(null,util$5.cores);var _=URL.createObjectURL(new Blob(["(",function(){self.addEventListener("message",function(A){var I=Date.now(),B=I+4;self.postMessage({st:I,et:B})})}.toString(),")()"],{type:"application/javascript"}));E([],5,16);function E(A,I,B){if(I===0){var O=Math.floor(A.reduce(function(N,U){return N+U},0)/A.length);return util$5.cores=Math.max(1,O),URL.revokeObjectURL(_),r(null,util$5.cores)}S(B,function(N,U){A.push(C(B,U)),E(A,I-1,B)})}function S(A,I){for(var B=[],O=[],N=0;N<A;++N){var U=new Worker(_);U.addEventListener("message",function(j){if(O.push(j.data),O.length===A){for(var z=0;z<A;++z)B[z].terminate();I(null,O)}}),B.push(U)}for(var N=0;N<A;++N)B[N].postMessage(N)}function C(A,I){for(var B=[],O=0;O<A;++O)for(var N=I[O],U=B[O]=[],j=0;j<A;++j)if(O!==j){var z=I[j];(N.st>z.st&&N.st<z.et||z.st>N.st&&z.st<N.et)&&U.push(j)}return B.reduce(function(Z,X){return Math.max(Z,X.length)},0)}};var forge$k=forge$m;forge$k.cipher=forge$k.cipher||{};forge$k.cipher.algorithms=forge$k.cipher.algorithms||{};forge$k.cipher.createCipher=function(n,r){var _=n;if(typeof _=="string"&&(_=forge$k.cipher.getAlgorithm(_),_&&(_=_())),!_)throw new Error("Unsupported algorithm: "+n);return new forge$k.cipher.BlockCipher({algorithm:_,key:r,decrypt:!1})};forge$k.cipher.createDecipher=function(n,r){var _=n;if(typeof _=="string"&&(_=forge$k.cipher.getAlgorithm(_),_&&(_=_())),!_)throw new Error("Unsupported algorithm: "+n);return new forge$k.cipher.BlockCipher({algorithm:_,key:r,decrypt:!0})};forge$k.cipher.registerAlgorithm=function(n,r){n=n.toUpperCase(),forge$k.cipher.algorithms[n]=r};forge$k.cipher.getAlgorithm=function(n){return n=n.toUpperCase(),n in forge$k.cipher.algorithms?forge$k.cipher.algorithms[n]:null};var BlockCipher=forge$k.cipher.BlockCipher=function(n){this.algorithm=n.algorithm,this.mode=this.algorithm.mode,this.blockSize=this.mode.blockSize,this._finish=!1,this._input=null,this.output=null,this._op=n.decrypt?this.mode.decrypt:this.mode.encrypt,this._decrypt=n.decrypt,this.algorithm.initialize(n)};BlockCipher.prototype.start=function(n){n=n||{};var r={};for(var _ in n)r[_]=n[_];r.decrypt=this._decrypt,this._finish=!1,this._input=forge$k.util.createBuffer(),this.output=n.output||forge$k.util.createBuffer(),this.mode.start(r)};BlockCipher.prototype.update=function(n){for(n&&this._input.putBuffer(n);!this._op.call(this.mode,this._input,this.output,this._finish)&&!this._finish;);this._input.compact()};BlockCipher.prototype.finish=function(n){n&&(this.mode.name==="ECB"||this.mode.name==="CBC")&&(this.mode.pad=function(_){return n(this.blockSize,_,!1)},this.mode.unpad=function(_){return n(this.blockSize,_,!0)});var r={};return r.decrypt=this._decrypt,r.overflow=this._input.length()%this.blockSize,!(!this._decrypt&&this.mode.pad&&!this.mode.pad(this._input,r)||(this._finish=!0,this.update(),this._decrypt&&this.mode.unpad&&!this.mode.unpad(this.output,r))||this.mode.afterFinish&&!this.mode.afterFinish(this.output,r))};var forge$j=forge$m;forge$j.cipher=forge$j.cipher||{};var modes$1=forge$j.cipher.modes=forge$j.cipher.modes||{};modes$1.ecb=function(n){n=n||{},this.name="ECB",this.cipher=n.cipher,this.blockSize=n.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)};modes$1.ecb.prototype.start=function(n){};modes$1.ecb.prototype.encrypt=function(n,r,_){if(n.length()<this.blockSize&&!(_&&n.length()>0))return!0;for(var E=0;E<this._ints;++E)this._inBlock[E]=n.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(var E=0;E<this._ints;++E)r.putInt32(this._outBlock[E])};modes$1.ecb.prototype.decrypt=function(n,r,_){if(n.length()<this.blockSize&&!(_&&n.length()>0))return!0;for(var E=0;E<this._ints;++E)this._inBlock[E]=n.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(var E=0;E<this._ints;++E)r.putInt32(this._outBlock[E])};modes$1.ecb.prototype.pad=function(n,r){var _=n.length()===this.blockSize?this.blockSize:this.blockSize-n.length();return n.fillWithByte(_,_),!0};modes$1.ecb.prototype.unpad=function(n,r){if(r.overflow>0)return!1;var _=n.length(),E=n.at(_-1);return E>this.blockSize<<2?!1:(n.truncate(E),!0)};modes$1.cbc=function(n){n=n||{},this.name="CBC",this.cipher=n.cipher,this.blockSize=n.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)};modes$1.cbc.prototype.start=function(n){if(n.iv===null){if(!this._prev)throw new Error("Invalid IV parameter.");this._iv=this._prev.slice(0)}else if("iv"in n)this._iv=transformIV(n.iv,this.blockSize),this._prev=this._iv.slice(0);else throw new Error("Invalid IV parameter.")};modes$1.cbc.prototype.encrypt=function(n,r,_){if(n.length()<this.blockSize&&!(_&&n.length()>0))return!0;for(var E=0;E<this._ints;++E)this._inBlock[E]=this._prev[E]^n.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(var E=0;E<this._ints;++E)r.putInt32(this._outBlock[E]);this._prev=this._outBlock};modes$1.cbc.prototype.decrypt=function(n,r,_){if(n.length()<this.blockSize&&!(_&&n.length()>0))return!0;for(var E=0;E<this._ints;++E)this._inBlock[E]=n.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(var E=0;E<this._ints;++E)r.putInt32(this._prev[E]^this._outBlock[E]);this._prev=this._inBlock.slice(0)};modes$1.cbc.prototype.pad=function(n,r){var _=n.length()===this.blockSize?this.blockSize:this.blockSize-n.length();return n.fillWithByte(_,_),!0};modes$1.cbc.prototype.unpad=function(n,r){if(r.overflow>0)return!1;var _=n.length(),E=n.at(_-1);return E>this.blockSize<<2?!1:(n.truncate(E),!0)};modes$1.cfb=function(n){n=n||{},this.name="CFB",this.cipher=n.cipher,this.blockSize=n.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialBlock=new Array(this._ints),this._partialOutput=forge$j.util.createBuffer(),this._partialBytes=0};modes$1.cfb.prototype.start=function(n){if(!("iv"in n))throw new Error("Invalid IV parameter.");this._iv=transformIV(n.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0};modes$1.cfb.prototype.encrypt=function(n,r,_){var E=n.length();if(E===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&E>=this.blockSize){for(var S=0;S<this._ints;++S)this._inBlock[S]=n.getInt32()^this._outBlock[S],r.putInt32(this._inBlock[S]);return}var C=(this.blockSize-E)%this.blockSize;C>0&&(C=this.blockSize-C),this._partialOutput.clear();for(var S=0;S<this._ints;++S)this._partialBlock[S]=n.getInt32()^this._outBlock[S],this._partialOutput.putInt32(this._partialBlock[S]);if(C>0)n.read-=this.blockSize;else for(var S=0;S<this._ints;++S)this._inBlock[S]=this._partialBlock[S];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),C>0&&!_)return r.putBytes(this._partialOutput.getBytes(C-this._partialBytes)),this._partialBytes=C,!0;r.putBytes(this._partialOutput.getBytes(E-this._partialBytes)),this._partialBytes=0};modes$1.cfb.prototype.decrypt=function(n,r,_){var E=n.length();if(E===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&E>=this.blockSize){for(var S=0;S<this._ints;++S)this._inBlock[S]=n.getInt32(),r.putInt32(this._inBlock[S]^this._outBlock[S]);return}var C=(this.blockSize-E)%this.blockSize;C>0&&(C=this.blockSize-C),this._partialOutput.clear();for(var S=0;S<this._ints;++S)this._partialBlock[S]=n.getInt32(),this._partialOutput.putInt32(this._partialBlock[S]^this._outBlock[S]);if(C>0)n.read-=this.blockSize;else for(var S=0;S<this._ints;++S)this._inBlock[S]=this._partialBlock[S];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),C>0&&!_)return r.putBytes(this._partialOutput.getBytes(C-this._partialBytes)),this._partialBytes=C,!0;r.putBytes(this._partialOutput.getBytes(E-this._partialBytes)),this._partialBytes=0};modes$1.ofb=function(n){n=n||{},this.name="OFB",this.cipher=n.cipher,this.blockSize=n.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=forge$j.util.createBuffer(),this._partialBytes=0};modes$1.ofb.prototype.start=function(n){if(!("iv"in n))throw new Error("Invalid IV parameter.");this._iv=transformIV(n.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0};modes$1.ofb.prototype.encrypt=function(n,r,_){var E=n.length();if(n.length()===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&E>=this.blockSize){for(var S=0;S<this._ints;++S)r.putInt32(n.getInt32()^this._outBlock[S]),this._inBlock[S]=this._outBlock[S];return}var C=(this.blockSize-E)%this.blockSize;C>0&&(C=this.blockSize-C),this._partialOutput.clear();for(var S=0;S<this._ints;++S)this._partialOutput.putInt32(n.getInt32()^this._outBlock[S]);if(C>0)n.read-=this.blockSize;else for(var S=0;S<this._ints;++S)this._inBlock[S]=this._outBlock[S];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),C>0&&!_)return r.putBytes(this._partialOutput.getBytes(C-this._partialBytes)),this._partialBytes=C,!0;r.putBytes(this._partialOutput.getBytes(E-this._partialBytes)),this._partialBytes=0};modes$1.ofb.prototype.decrypt=modes$1.ofb.prototype.encrypt;modes$1.ctr=function(n){n=n||{},this.name="CTR",this.cipher=n.cipher,this.blockSize=n.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=forge$j.util.createBuffer(),this._partialBytes=0};modes$1.ctr.prototype.start=function(n){if(!("iv"in n))throw new Error("Invalid IV parameter.");this._iv=transformIV(n.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0};modes$1.ctr.prototype.encrypt=function(n,r,_){var E=n.length();if(E===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&E>=this.blockSize)for(var S=0;S<this._ints;++S)r.putInt32(n.getInt32()^this._outBlock[S]);else{var C=(this.blockSize-E)%this.blockSize;C>0&&(C=this.blockSize-C),this._partialOutput.clear();for(var S=0;S<this._ints;++S)this._partialOutput.putInt32(n.getInt32()^this._outBlock[S]);if(C>0&&(n.read-=this.blockSize),this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),C>0&&!_)return r.putBytes(this._partialOutput.getBytes(C-this._partialBytes)),this._partialBytes=C,!0;r.putBytes(this._partialOutput.getBytes(E-this._partialBytes)),this._partialBytes=0}inc32(this._inBlock)};modes$1.ctr.prototype.decrypt=modes$1.ctr.prototype.encrypt;modes$1.gcm=function(n){n=n||{},this.name="GCM",this.cipher=n.cipher,this.blockSize=n.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints),this._partialOutput=forge$j.util.createBuffer(),this._partialBytes=0,this._R=3774873600};modes$1.gcm.prototype.start=function(n){if(!("iv"in n))throw new Error("Invalid IV parameter.");var r=forge$j.util.createBuffer(n.iv);this._cipherLength=0;var _;if("additionalData"in n?_=forge$j.util.createBuffer(n.additionalData):_=forge$j.util.createBuffer(),"tagLength"in n?this._tagLength=n.tagLength:this._tagLength=128,this._tag=null,n.decrypt&&(this._tag=forge$j.util.createBuffer(n.tag).getBytes(),this._tag.length!==this._tagLength/8))throw new Error("Authentication tag does not match tag length.");this._hashBlock=new Array(this._ints),this.tag=null,this._hashSubkey=new Array(this._ints),this.cipher.encrypt([0,0,0,0],this._hashSubkey),this.componentBits=4,this._m=this.generateHashTable(this._hashSubkey,this.componentBits);var E=r.length();if(E===12)this._j0=[r.getInt32(),r.getInt32(),r.getInt32(),1];else{for(this._j0=[0,0,0,0];r.length()>0;)this._j0=this.ghash(this._hashSubkey,this._j0,[r.getInt32(),r.getInt32(),r.getInt32(),r.getInt32()]);this._j0=this.ghash(this._hashSubkey,this._j0,[0,0].concat(from64To32(E*8)))}this._inBlock=this._j0.slice(0),inc32(this._inBlock),this._partialBytes=0,_=forge$j.util.createBuffer(_),this._aDataLength=from64To32(_.length()*8);var S=_.length()%this.blockSize;for(S&&_.fillWithByte(0,this.blockSize-S),this._s=[0,0,0,0];_.length()>0;)this._s=this.ghash(this._hashSubkey,this._s,[_.getInt32(),_.getInt32(),_.getInt32(),_.getInt32()])};modes$1.gcm.prototype.encrypt=function(n,r,_){var E=n.length();if(E===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&E>=this.blockSize){for(var S=0;S<this._ints;++S)r.putInt32(this._outBlock[S]^=n.getInt32());this._cipherLength+=this.blockSize}else{var C=(this.blockSize-E)%this.blockSize;C>0&&(C=this.blockSize-C),this._partialOutput.clear();for(var S=0;S<this._ints;++S)this._partialOutput.putInt32(n.getInt32()^this._outBlock[S]);if(C<=0||_){if(_){var A=E%this.blockSize;this._cipherLength+=A,this._partialOutput.truncate(this.blockSize-A)}else this._cipherLength+=this.blockSize;for(var S=0;S<this._ints;++S)this._outBlock[S]=this._partialOutput.getInt32();this._partialOutput.read-=this.blockSize}if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),C>0&&!_)return n.read-=this.blockSize,r.putBytes(this._partialOutput.getBytes(C-this._partialBytes)),this._partialBytes=C,!0;r.putBytes(this._partialOutput.getBytes(E-this._partialBytes)),this._partialBytes=0}this._s=this.ghash(this._hashSubkey,this._s,this._outBlock),inc32(this._inBlock)};modes$1.gcm.prototype.decrypt=function(n,r,_){var E=n.length();if(E<this.blockSize&&!(_&&E>0))return!0;this.cipher.encrypt(this._inBlock,this._outBlock),inc32(this._inBlock),this._hashBlock[0]=n.getInt32(),this._hashBlock[1]=n.getInt32(),this._hashBlock[2]=n.getInt32(),this._hashBlock[3]=n.getInt32(),this._s=this.ghash(this._hashSubkey,this._s,this._hashBlock);for(var S=0;S<this._ints;++S)r.putInt32(this._outBlock[S]^this._hashBlock[S]);E<this.blockSize?this._cipherLength+=E%this.blockSize:this._cipherLength+=this.blockSize};modes$1.gcm.prototype.afterFinish=function(n,r){var _=!0;r.decrypt&&r.overflow&&n.truncate(this.blockSize-r.overflow),this.tag=forge$j.util.createBuffer();var E=this._aDataLength.concat(from64To32(this._cipherLength*8));this._s=this.ghash(this._hashSubkey,this._s,E);var S=[];this.cipher.encrypt(this._j0,S);for(var C=0;C<this._ints;++C)this.tag.putInt32(this._s[C]^S[C]);return this.tag.truncate(this.tag.length()%(this._tagLength/8)),r.decrypt&&this.tag.bytes()!==this._tag&&(_=!1),_};modes$1.gcm.prototype.multiply=function(n,r){for(var _=[0,0,0,0],E=r.slice(0),S=0;S<128;++S){var C=n[S/32|0]&1<<31-S%32;C&&(_[0]^=E[0],_[1]^=E[1],_[2]^=E[2],_[3]^=E[3]),this.pow(E,E)}return _};modes$1.gcm.prototype.pow=function(n,r){for(var _=n[3]&1,E=3;E>0;--E)r[E]=n[E]>>>1|(n[E-1]&1)<<31;r[0]=n[0]>>>1,_&&(r[0]^=this._R)};modes$1.gcm.prototype.tableMultiply=function(n){for(var r=[0,0,0,0],_=0;_<32;++_){var E=_/8|0,S=n[E]>>>(7-_%8)*4&15,C=this._m[_][S];r[0]^=C[0],r[1]^=C[1],r[2]^=C[2],r[3]^=C[3]}return r};modes$1.gcm.prototype.ghash=function(n,r,_){return r[0]^=_[0],r[1]^=_[1],r[2]^=_[2],r[3]^=_[3],this.tableMultiply(r)};modes$1.gcm.prototype.generateHashTable=function(n,r){for(var _=8/r,E=4*_,S=16*_,C=new Array(S),A=0;A<S;++A){var I=[0,0,0,0],B=A/E|0,O=(E-1-A%E)*r;I[B]=1<<r-1<<O,C[A]=this.generateSubHashTable(this.multiply(I,n),r)}return C};modes$1.gcm.prototype.generateSubHashTable=function(n,r){var _=1<<r,E=_>>>1,S=new Array(_);S[E]=n.slice(0);for(var C=E>>>1;C>0;)this.pow(S[2*C],S[C]=[]),C>>=1;for(C=2;C<E;){for(var A=1;A<C;++A){var I=S[C],B=S[A];S[C+A]=[I[0]^B[0],I[1]^B[1],I[2]^B[2],I[3]^B[3]]}C*=2}for(S[0]=[0,0,0,0],C=E+1;C<_;++C){var O=S[C^E];S[C]=[n[0]^O[0],n[1]^O[1],n[2]^O[2],n[3]^O[3]]}return S};function transformIV(n,r){if(typeof n=="string"&&(n=forge$j.util.createBuffer(n)),forge$j.util.isArray(n)&&n.length>4){var _=n;n=forge$j.util.createBuffer();for(var E=0;E<_.length;++E)n.putByte(_[E])}if(n.length()<r)throw new Error("Invalid IV length; got "+n.length()+" bytes and expected "+r+" bytes.");if(!forge$j.util.isArray(n)){for(var S=[],C=r/4,E=0;E<C;++E)S.push(n.getInt32());n=S}return n}function inc32(n){n[n.length-1]=n[n.length-1]+1&4294967295}function from64To32(n){return[n/4294967296|0,n&4294967295]}var forge$i=forge$m;forge$i.aes=forge$i.aes||{};forge$i.aes.startEncrypting=function(n,r,_,E){var S=_createCipher$1({key:n,output:_,decrypt:!1,mode:E});return S.start(r),S};forge$i.aes.createEncryptionCipher=function(n,r){return _createCipher$1({key:n,output:null,decrypt:!1,mode:r})};forge$i.aes.startDecrypting=function(n,r,_,E){var S=_createCipher$1({key:n,output:_,decrypt:!0,mode:E});return S.start(r),S};forge$i.aes.createDecryptionCipher=function(n,r){return _createCipher$1({key:n,output:null,decrypt:!0,mode:r})};forge$i.aes.Algorithm=function(n,r){init||initialize();var _=this;_.name=n,_.mode=new r({blockSize:16,cipher:{encrypt:function(E,S){return _updateBlock$1(_._w,E,S,!1)},decrypt:function(E,S){return _updateBlock$1(_._w,E,S,!0)}}}),_._init=!1};forge$i.aes.Algorithm.prototype.initialize=function(n){if(!this._init){var r=n.key,_;if(typeof r=="string"&&(r.length===16||r.length===24||r.length===32))r=forge$i.util.createBuffer(r);else if(forge$i.util.isArray(r)&&(r.length===16||r.length===24||r.length===32)){_=r,r=forge$i.util.createBuffer();for(var E=0;E<_.length;++E)r.putByte(_[E])}if(!forge$i.util.isArray(r)){_=r,r=[];var S=_.length();if(S===16||S===24||S===32){S=S>>>2;for(var E=0;E<S;++E)r.push(_.getInt32())}}if(!forge$i.util.isArray(r)||!(r.length===4||r.length===6||r.length===8))throw new Error("Invalid key parameter.");var C=this.mode.name,A=["CFB","OFB","CTR","GCM"].indexOf(C)!==-1;this._w=_expandKey(r,n.decrypt&&!A),this._init=!0}};forge$i.aes._expandKey=function(n,r){return init||initialize(),_expandKey(n,r)};forge$i.aes._updateBlock=_updateBlock$1;registerAlgorithm$1("AES-ECB",forge$i.cipher.modes.ecb);registerAlgorithm$1("AES-CBC",forge$i.cipher.modes.cbc);registerAlgorithm$1("AES-CFB",forge$i.cipher.modes.cfb);registerAlgorithm$1("AES-OFB",forge$i.cipher.modes.ofb);registerAlgorithm$1("AES-CTR",forge$i.cipher.modes.ctr);registerAlgorithm$1("AES-GCM",forge$i.cipher.modes.gcm);function registerAlgorithm$1(n,r){var _=function(){return new forge$i.aes.Algorithm(n,r)};forge$i.cipher.registerAlgorithm(n,_)}var init=!1,Nb=4,sbox,isbox,rcon,mix,imix;function initialize(){init=!0,rcon=[0,1,2,4,8,16,32,64,128,27,54];for(var n=new Array(256),r=0;r<128;++r)n[r]=r<<1,n[r+128]=r+128<<1^283;sbox=new Array(256),isbox=new Array(256),mix=new Array(4),imix=new Array(4);for(var r=0;r<4;++r)mix[r]=new Array(256),imix[r]=new Array(256);for(var _=0,E=0,S,C,A,I,B,O,N,r=0;r<256;++r){I=E^E<<1^E<<2^E<<3^E<<4,I=I>>8^I&255^99,sbox[_]=I,isbox[I]=_,B=n[I],S=n[_],C=n[S],A=n[C],O=B<<24^I<<16^I<<8^(I^B),N=(S^C^A)<<24^(_^A)<<16^(_^C^A)<<8^(_^S^A);for(var U=0;U<4;++U)mix[U][_]=O,imix[U][I]=N,O=O<<24|O>>>8,N=N<<24|N>>>8;_===0?_=E=1:(_=S^n[n[n[S^A]]],E^=n[n[E]])}}function _expandKey(n,r){for(var _=n.slice(0),E,S=1,C=_.length,A=C+6+1,I=Nb*A,B=C;B<I;++B)E=_[B-1],B%C===0?(E=sbox[E>>>16&255]<<24^sbox[E>>>8&255]<<16^sbox[E&255]<<8^sbox[E>>>24]^rcon[S]<<24,S++):C>6&&B%C===4&&(E=sbox[E>>>24]<<24^sbox[E>>>16&255]<<16^sbox[E>>>8&255]<<8^sbox[E&255]),_[B]=_[B-C]^E;if(r){var O,N=imix[0],U=imix[1],j=imix[2],z=imix[3],Z=_.slice(0);I=_.length;for(var B=0,X=I-Nb;B<I;B+=Nb,X-=Nb)if(B===0||B===I-Nb)Z[B]=_[X],Z[B+1]=_[X+3],Z[B+2]=_[X+2],Z[B+3]=_[X+1];else for(var Q=0;Q<Nb;++Q)O=_[X+Q],Z[B+(3&-Q)]=N[sbox[O>>>24]]^U[sbox[O>>>16&255]]^j[sbox[O>>>8&255]]^z[sbox[O&255]];_=Z}return _}function _updateBlock$1(n,r,_,E){var S=n.length/4-1,C,A,I,B,O;E?(C=imix[0],A=imix[1],I=imix[2],B=imix[3],O=isbox):(C=mix[0],A=mix[1],I=mix[2],B=mix[3],O=sbox);var N,U,j,z,Z,X,Q;N=r[0]^n[0],U=r[E?3:1]^n[1],j=r[2]^n[2],z=r[E?1:3]^n[3];for(var se=3,oe=1;oe<S;++oe)Z=C[N>>>24]^A[U>>>16&255]^I[j>>>8&255]^B[z&255]^n[++se],X=C[U>>>24]^A[j>>>16&255]^I[z>>>8&255]^B[N&255]^n[++se],Q=C[j>>>24]^A[z>>>16&255]^I[N>>>8&255]^B[U&255]^n[++se],z=C[z>>>24]^A[N>>>16&255]^I[U>>>8&255]^B[j&255]^n[++se],N=Z,U=X,j=Q;_[0]=O[N>>>24]<<24^O[U>>>16&255]<<16^O[j>>>8&255]<<8^O[z&255]^n[++se],_[E?3:1]=O[U>>>24]<<24^O[j>>>16&255]<<16^O[z>>>8&255]<<8^O[N&255]^n[++se],_[2]=O[j>>>24]<<24^O[z>>>16&255]<<16^O[N>>>8&255]<<8^O[U&255]^n[++se],_[E?1:3]=O[z>>>24]<<24^O[N>>>16&255]<<16^O[U>>>8&255]<<8^O[j&255]^n[++se]}function _createCipher$1(n){n=n||{};var r=(n.mode||"CBC").toUpperCase(),_="AES-"+r,E;n.decrypt?E=forge$i.cipher.createDecipher(_,n.key):E=forge$i.cipher.createCipher(_,n.key);var S=E.start;return E.start=function(C,A){var I=null;A instanceof forge$i.util.ByteBuffer&&(I=A,A={}),A=A||{},A.output=I,A.iv=C,S.call(E,A)},E}const base10$4=baseX$1({prefix:"9",name:"base10",alphabet:"0123456789"}),base10$5=Object.freeze(Object.defineProperty({__proto__:null,base10:base10$4},Symbol.toStringTag,{value:"Module"})),base16$4=rfc4648$2({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),base16upper$2=rfc4648$2({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4}),base16$5=Object.freeze(Object.defineProperty({__proto__:null,base16:base16$4,base16upper:base16upper$2},Symbol.toStringTag,{value:"Module"})),base2$4=rfc4648$2({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1}),base2$5=Object.freeze(Object.defineProperty({__proto__:null,base2:base2$4},Symbol.toStringTag,{value:"Module"})),alphabet$2=Array.from(""),alphabetBytesToChars$2=alphabet$2.reduce((n,r,_)=>(n[_]=r,n),[]),alphabetCharsToBytes$2=alphabet$2.reduce((n,r,_)=>(n[r.codePointAt(0)]=_,n),[]);function encode$e(n){return n.reduce((r,_)=>(r+=alphabetBytesToChars$2[_],r),"")}function decode$e(n){const r=[];for(const _ of n){const E=alphabetCharsToBytes$2[_.codePointAt(0)];if(E===void 0)throw new Error(`Non-base256emoji character: ${_}`);r.push(E)}return new Uint8Array(r)}const base256emoji$4=from$2({prefix:"",name:"base256emoji",encode:encode$e,decode:decode$e}),base256emoji$5=Object.freeze(Object.defineProperty({__proto__:null,base256emoji:base256emoji$4},Symbol.toStringTag,{value:"Module"})),base36$4=baseX$1({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),base36upper$2=baseX$1({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"}),base36$5=Object.freeze(Object.defineProperty({__proto__:null,base36:base36$4,base36upper:base36upper$2},Symbol.toStringTag,{value:"Module"})),base64$5=rfc4648$2({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),base64pad$2=rfc4648$2({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),base64url$2=rfc4648$2({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),base64urlpad$2=rfc4648$2({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6}),base64$6=Object.freeze(Object.defineProperty({__proto__:null,base64:base64$5,base64pad:base64pad$2,base64url:base64url$2,base64urlpad:base64urlpad$2},Symbol.toStringTag,{value:"Module"})),base8$4=rfc4648$2({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3}),base8$5=Object.freeze(Object.defineProperty({__proto__:null,base8:base8$4},Symbol.toStringTag,{value:"Module"})),identity$7=from$2({prefix:"\0",name:"identity",encode:n=>toString$5(n),decode:n=>fromString$4(n)}),identityBase$2=Object.freeze(Object.defineProperty({__proto__:null,identity:identity$7},Symbol.toStringTag,{value:"Module"}));new TextEncoder;const textDecoder$2=new TextDecoder,code$7=512;function decode$d(n){return JSON.parse(textDecoder$2.decode(n))}const name$6="raw",code$6=85;function encode$d(n){return coerce(n)}function decode$c(n){return coerce(n)}const raw=Object.freeze(Object.defineProperty({__proto__:null,code:code$6,decode:decode$c,encode:encode$d,name:name$6},Symbol.toStringTag,{value:"Module"})),code$5=0,name$5="identity",encode$c=coerce;function digest$1(n){return create$4(code$5,encode$c(n))}const identity$6={code:code$5,name:name$5,encode:encode$c,digest:digest$1};function from({name:n,code:r,encode:_}){return new Hasher(n,r,_)}class Hasher{name;code;encode;constructor(r,_,E){this.name=r,this.code=_,this.encode=E}digest(r){if(r instanceof Uint8Array){const _=this.encode(r);return _ instanceof Uint8Array?create$4(this.code,_):_.then(E=>create$4(this.code,E))}else throw Error("Unknown type, must be binary type")}}function sha$2(n){return async r=>new Uint8Array(await crypto.subtle.digest(n,r))}const sha256$6=from({name:"sha2-256",code:18,encode:sha$2("SHA-256")}),sha512$4=from({name:"sha2-512",code:19,encode:sha$2("SHA-512")}),bases$2={...identityBase$2,...base2$5,...base8$5,...base10$5,...base16$5,...base32$1,...base36$5,...base58,...base64$6,...base256emoji$5};function alloc$1(n=0){return new Uint8Array(n)}function allocUnsafe$1(n=0){return new Uint8Array(n)}function createCodec$3(n,r,_,E){return{name:n,prefix:r,encoder:{name:n,prefix:r,encode:_},decoder:{decode:E}}}const string$3=createCodec$3("utf8","u",n=>"u"+new TextDecoder("utf8").decode(n),n=>new TextEncoder().encode(n.substring(1))),ascii$2=createCodec$3("ascii","a",n=>{let r="a";for(let _=0;_<n.length;_++)r+=String.fromCharCode(n[_]);return r},n=>{n=n.substring(1);const r=allocUnsafe$1(n.length);for(let _=0;_<n.length;_++)r[_]=n.charCodeAt(_);return r}),BASES$2={utf8:string$3,"utf-8":string$3,hex:bases$2.base16,latin1:ascii$2,ascii:ascii$2,binary:ascii$2,...bases$2};function fromString$3(n,r="utf8"){const _=BASES$2[r];if(_==null)throw new Error(`Unsupported encoding "${r}"`);return _.decoder.decode(`${_.prefix}${n}`)}function toString$4(n,r="utf8"){const _=BASES$2[r];if(_==null)throw new Error(`Unsupported encoding "${r}"`);return _.encoder.encode(n).substring(1)}const webcrypto$2={get(n=globalThis){const r=n.crypto;if(r==null||r.subtle==null)throw Object.assign(new Error("Missing Web Crypto API. The most likely cause of this error is that this page is being accessed from an insecure context (i.e. not HTTPS). For more information and possible resolutions see https://github.com/libp2p/js-libp2p/blob/main/packages/crypto/README.md#web-crypto-api"),{code:"ERR_MISSING_WEB_CRYPTO"});return r}};var forge$h=forge$m;forge$h.pki=forge$h.pki||{};var oids$1=forge$h.pki.oids=forge$h.oids=forge$h.oids||{};function _IN(n,r){oids$1[n]=r,oids$1[r]=n}function _I_(n,r){oids$1[n]=r}_IN("1.2.840.113549.1.1.1","rsaEncryption");_IN("1.2.840.113549.1.1.4","md5WithRSAEncryption");_IN("1.2.840.113549.1.1.5","sha1WithRSAEncryption");_IN("1.2.840.113549.1.1.7","RSAES-OAEP");_IN("1.2.840.113549.1.1.8","mgf1");_IN("1.2.840.113549.1.1.9","pSpecified");_IN("1.2.840.113549.1.1.10","RSASSA-PSS");_IN("1.2.840.113549.1.1.11","sha256WithRSAEncryption");_IN("1.2.840.113549.1.1.12","sha384WithRSAEncryption");_IN("1.2.840.113549.1.1.13","sha512WithRSAEncryption");_IN("1.3.101.112","EdDSA25519");_IN("1.2.840.10040.4.3","dsa-with-sha1");_IN("1.3.14.3.2.7","desCBC");_IN("1.3.14.3.2.26","sha1");_IN("1.3.14.3.2.29","sha1WithRSASignature");_IN("2.16.840.1.101.3.4.2.1","sha256");_IN("2.16.840.1.101.3.4.2.2","sha384");_IN("2.16.840.1.101.3.4.2.3","sha512");_IN("2.16.840.1.101.3.4.2.4","sha224");_IN("2.16.840.1.101.3.4.2.5","sha512-224");_IN("2.16.840.1.101.3.4.2.6","sha512-256");_IN("1.2.840.113549.2.2","md2");_IN("1.2.840.113549.2.5","md5");_IN("1.2.840.113549.1.7.1","data");_IN("1.2.840.113549.1.7.2","signedData");_IN("1.2.840.113549.1.7.3","envelopedData");_IN("1.2.840.113549.1.7.4","signedAndEnvelopedData");_IN("1.2.840.113549.1.7.5","digestedData");_IN("1.2.840.113549.1.7.6","encryptedData");_IN("1.2.840.113549.1.9.1","emailAddress");_IN("1.2.840.113549.1.9.2","unstructuredName");_IN("1.2.840.113549.1.9.3","contentType");_IN("1.2.840.113549.1.9.4","messageDigest");_IN("1.2.840.113549.1.9.5","signingTime");_IN("1.2.840.113549.1.9.6","counterSignature");_IN("1.2.840.113549.1.9.7","challengePassword");_IN("1.2.840.113549.1.9.8","unstructuredAddress");_IN("1.2.840.113549.1.9.14","extensionRequest");_IN("1.2.840.113549.1.9.20","friendlyName");_IN("1.2.840.113549.1.9.21","localKeyId");_IN("1.2.840.113549.1.9.22.1","x509Certificate");_IN("1.2.840.113549.1.12.10.1.1","keyBag");_IN("1.2.840.113549.1.12.10.1.2","pkcs8ShroudedKeyBag");_IN("1.2.840.113549.1.12.10.1.3","certBag");_IN("1.2.840.113549.1.12.10.1.4","crlBag");_IN("1.2.840.113549.1.12.10.1.5","secretBag");_IN("1.2.840.113549.1.12.10.1.6","safeContentsBag");_IN("1.2.840.113549.1.5.13","pkcs5PBES2");_IN("1.2.840.113549.1.5.12","pkcs5PBKDF2");_IN("1.2.840.113549.1.12.1.1","pbeWithSHAAnd128BitRC4");_IN("1.2.840.113549.1.12.1.2","pbeWithSHAAnd40BitRC4");_IN("1.2.840.113549.1.12.1.3","pbeWithSHAAnd3-KeyTripleDES-CBC");_IN("1.2.840.113549.1.12.1.4","pbeWithSHAAnd2-KeyTripleDES-CBC");_IN("1.2.840.113549.1.12.1.5","pbeWithSHAAnd128BitRC2-CBC");_IN("1.2.840.113549.1.12.1.6","pbewithSHAAnd40BitRC2-CBC");_IN("1.2.840.113549.2.7","hmacWithSHA1");_IN("1.2.840.113549.2.8","hmacWithSHA224");_IN("1.2.840.113549.2.9","hmacWithSHA256");_IN("1.2.840.113549.2.10","hmacWithSHA384");_IN("1.2.840.113549.2.11","hmacWithSHA512");_IN("1.2.840.113549.3.7","des-EDE3-CBC");_IN("2.16.840.1.101.3.4.1.2","aes128-CBC");_IN("2.16.840.1.101.3.4.1.22","aes192-CBC");_IN("2.16.840.1.101.3.4.1.42","aes256-CBC");_IN("2.5.4.3","commonName");_IN("2.5.4.4","surname");_IN("2.5.4.5","serialNumber");_IN("2.5.4.6","countryName");_IN("2.5.4.7","localityName");_IN("2.5.4.8","stateOrProvinceName");_IN("2.5.4.9","streetAddress");_IN("2.5.4.10","organizationName");_IN("2.5.4.11","organizationalUnitName");_IN("2.5.4.12","title");_IN("2.5.4.13","description");_IN("2.5.4.15","businessCategory");_IN("2.5.4.17","postalCode");_IN("2.5.4.42","givenName");_IN("1.3.6.1.4.1.311.60.2.1.2","jurisdictionOfIncorporationStateOrProvinceName");_IN("1.3.6.1.4.1.311.60.2.1.3","jurisdictionOfIncorporationCountryName");_IN("2.16.840.1.113730.1.1","nsCertType");_IN("2.16.840.1.113730.1.13","nsComment");_I_("2.5.29.1","authorityKeyIdentifier");_I_("2.5.29.2","keyAttributes");_I_("2.5.29.3","certificatePolicies");_I_("2.5.29.4","keyUsageRestriction");_I_("2.5.29.5","policyMapping");_I_("2.5.29.6","subtreesConstraint");_I_("2.5.29.7","subjectAltName");_I_("2.5.29.8","issuerAltName");_I_("2.5.29.9","subjectDirectoryAttributes");_I_("2.5.29.10","basicConstraints");_I_("2.5.29.11","nameConstraints");_I_("2.5.29.12","policyConstraints");_I_("2.5.29.13","basicConstraints");_IN("2.5.29.14","subjectKeyIdentifier");_IN("2.5.29.15","keyUsage");_I_("2.5.29.16","privateKeyUsagePeriod");_IN("2.5.29.17","subjectAltName");_IN("2.5.29.18","issuerAltName");_IN("2.5.29.19","basicConstraints");_I_("2.5.29.20","cRLNumber");_I_("2.5.29.21","cRLReason");_I_("2.5.29.22","expirationDate");_I_("2.5.29.23","instructionCode");_I_("2.5.29.24","invalidityDate");_I_("2.5.29.25","cRLDistributionPoints");_I_("2.5.29.26","issuingDistributionPoint");_I_("2.5.29.27","deltaCRLIndicator");_I_("2.5.29.28","issuingDistributionPoint");_I_("2.5.29.29","certificateIssuer");_I_("2.5.29.30","nameConstraints");_IN("2.5.29.31","cRLDistributionPoints");_IN("2.5.29.32","certificatePolicies");_I_("2.5.29.33","policyMappings");_I_("2.5.29.34","policyConstraints");_IN("2.5.29.35","authorityKeyIdentifier");_I_("2.5.29.36","policyConstraints");_IN("2.5.29.37","extKeyUsage");_I_("2.5.29.46","freshestCRL");_I_("2.5.29.54","inhibitAnyPolicy");_IN("1.3.6.1.4.1.11129.2.4.2","timestampList");_IN("1.3.6.1.5.5.7.1.1","authorityInfoAccess");_IN("1.3.6.1.5.5.7.3.1","serverAuth");_IN("1.3.6.1.5.5.7.3.2","clientAuth");_IN("1.3.6.1.5.5.7.3.3","codeSigning");_IN("1.3.6.1.5.5.7.3.4","emailProtection");_IN("1.3.6.1.5.5.7.3.8","timeStamping");var forge$g=forge$m,asn1$4=forge$g.asn1=forge$g.asn1||{};asn1$4.Class={UNIVERSAL:0,APPLICATION:64,CONTEXT_SPECIFIC:128,PRIVATE:192};asn1$4.Type={NONE:0,BOOLEAN:1,INTEGER:2,BITSTRING:3,OCTETSTRING:4,NULL:5,OID:6,ODESC:7,EXTERNAL:8,REAL:9,ENUMERATED:10,EMBEDDED:11,UTF8:12,ROID:13,SEQUENCE:16,SET:17,PRINTABLESTRING:19,IA5STRING:22,UTCTIME:23,GENERALIZEDTIME:24,BMPSTRING:30};asn1$4.create=function(n,r,_,E,S){if(forge$g.util.isArray(E)){for(var C=[],A=0;A<E.length;++A)E[A]!==void 0&&C.push(E[A]);E=C}var I={tagClass:n,type:r,constructed:_,composed:_||forge$g.util.isArray(E),value:E};return S&&"bitStringContents"in S&&(I.bitStringContents=S.bitStringContents,I.original=asn1$4.copy(I)),I};asn1$4.copy=function(n,r){var _;if(forge$g.util.isArray(n)){_=[];for(var E=0;E<n.length;++E)_.push(asn1$4.copy(n[E],r));return _}return typeof n=="string"?n:(_={tagClass:n.tagClass,type:n.type,constructed:n.constructed,composed:n.composed,value:asn1$4.copy(n.value,r)},r&&!r.excludeBitStringContents&&(_.bitStringContents=n.bitStringContents),_)};asn1$4.equals=function(n,r,_){if(forge$g.util.isArray(n)){if(!forge$g.util.isArray(r)||n.length!==r.length)return!1;for(var E=0;E<n.length;++E)if(!asn1$4.equals(n[E],r[E]))return!1;return!0}if(typeof n!=typeof r)return!1;if(typeof n=="string")return n===r;var S=n.tagClass===r.tagClass&&n.type===r.type&&n.constructed===r.constructed&&n.composed===r.composed&&asn1$4.equals(n.value,r.value);return _&&_.includeBitStringContents&&(S=S&&n.bitStringContents===r.bitStringContents),S};asn1$4.getBerValueLength=function(n){var r=n.getByte();if(r!==128){var _,E=r&128;return E?_=n.getInt((r&127)<<3):_=r,_}};function _checkBufferLength(n,r,_){if(_>r){var E=new Error("Too few bytes to parse DER.");throw E.available=n.length(),E.remaining=r,E.requested=_,E}}var _getValueLength=function(n,r){var _=n.getByte();if(r--,_!==128){var E,S=_&128;if(!S)E=_;else{var C=_&127;_checkBufferLength(n,r,C),E=n.getInt(C<<3)}if(E<0)throw new Error("Negative length: "+E);return E}};asn1$4.fromDer=function(n,r){r===void 0&&(r={strict:!0,parseAllBytes:!0,decodeBitStrings:!0}),typeof r=="boolean"&&(r={strict:r,parseAllBytes:!0,decodeBitStrings:!0}),"strict"in r||(r.strict=!0),"parseAllBytes"in r||(r.parseAllBytes=!0),"decodeBitStrings"in r||(r.decodeBitStrings=!0),typeof n=="string"&&(n=forge$g.util.createBuffer(n));var _=n.length(),E=_fromDer(n,n.length(),0,r);if(r.parseAllBytes&&n.length()!==0){var S=new Error("Unparsed DER bytes remain after ASN.1 parsing.");throw S.byteCount=_,S.remaining=n.length(),S}return E};function _fromDer(n,r,_,E){var S;_checkBufferLength(n,r,2);var C=n.getByte();r--;var A=C&192,I=C&31;S=n.length();var B=_getValueLength(n,r);if(r-=S-n.length(),B!==void 0&&B>r){if(E.strict){var O=new Error("Too few bytes to read ASN.1 value.");throw O.available=n.length(),O.remaining=r,O.requested=B,O}B=r}var N,U,j=(C&32)===32;if(j)if(N=[],B===void 0)for(;;){if(_checkBufferLength(n,r,2),n.bytes(2)==="\0\0"){n.getBytes(2),r-=2;break}S=n.length(),N.push(_fromDer(n,r,_+1,E)),r-=S-n.length()}else for(;B>0;)S=n.length(),N.push(_fromDer(n,B,_+1,E)),r-=S-n.length(),B-=S-n.length();if(N===void 0&&A===asn1$4.Class.UNIVERSAL&&I===asn1$4.Type.BITSTRING&&(U=n.bytes(B)),N===void 0&&E.decodeBitStrings&&A===asn1$4.Class.UNIVERSAL&&I===asn1$4.Type.BITSTRING&&B>1){var z=n.read,Z=r,X=0;if(I===asn1$4.Type.BITSTRING&&(_checkBufferLength(n,r,1),X=n.getByte(),r--),X===0)try{S=n.length();var Q={strict:!0,decodeBitStrings:!0},se=_fromDer(n,r,_+1,Q),oe=S-n.length();r-=oe,I==asn1$4.Type.BITSTRING&&oe++;var ue=se.tagClass;oe===B&&(ue===asn1$4.Class.UNIVERSAL||ue===asn1$4.Class.CONTEXT_SPECIFIC)&&(N=[se])}catch{}N===void 0&&(n.read=z,r=Z)}if(N===void 0){if(B===void 0){if(E.strict)throw new Error("Non-constructed ASN.1 object of indefinite length.");B=r}if(I===asn1$4.Type.BMPSTRING)for(N="";B>0;B-=2)_checkBufferLength(n,r,2),N+=String.fromCharCode(n.getInt16()),r-=2;else N=n.getBytes(B),r-=B}var we=U===void 0?null:{bitStringContents:U};return asn1$4.create(A,I,j,N,we)}asn1$4.toDer=function(n){var r=forge$g.util.createBuffer(),_=n.tagClass|n.type,E=forge$g.util.createBuffer(),S=!1;if("bitStringContents"in n&&(S=!0,n.original&&(S=asn1$4.equals(n,n.original))),S)E.putBytes(n.bitStringContents);else if(n.composed){n.constructed?_|=32:E.putByte(0);for(var C=0;C<n.value.length;++C)n.value[C]!==void 0&&E.putBuffer(asn1$4.toDer(n.value[C]))}else if(n.type===asn1$4.Type.BMPSTRING)for(var C=0;C<n.value.length;++C)E.putInt16(n.value.charCodeAt(C));else n.type===asn1$4.Type.INTEGER&&n.value.length>1&&(n.value.charCodeAt(0)===0&&!(n.value.charCodeAt(1)&128)||n.value.charCodeAt(0)===255&&(n.value.charCodeAt(1)&128)===128)?E.putBytes(n.value.substr(1)):E.putBytes(n.value);if(r.putByte(_),E.length()<=127)r.putByte(E.length()&127);else{var A=E.length(),I="";do I+=String.fromCharCode(A&255),A=A>>>8;while(A>0);r.putByte(I.length|128);for(var C=I.length-1;C>=0;--C)r.putByte(I.charCodeAt(C))}return r.putBuffer(E),r};asn1$4.oidToDer=function(n){var r=n.split("."),_=forge$g.util.createBuffer();_.putByte(40*parseInt(r[0],10)+parseInt(r[1],10));for(var E,S,C,A,I=2;I<r.length;++I){E=!0,S=[],C=parseInt(r[I],10);do A=C&127,C=C>>>7,E||(A|=128),S.push(A),E=!1;while(C>0);for(var B=S.length-1;B>=0;--B)_.putByte(S[B])}return _};asn1$4.derToOid=function(n){var r;typeof n=="string"&&(n=forge$g.util.createBuffer(n));var _=n.getByte();r=Math.floor(_/40)+"."+_%40;for(var E=0;n.length()>0;)_=n.getByte(),E=E<<7,_&128?E+=_&127:(r+="."+(E+_),E=0);return r};asn1$4.utcTimeToDate=function(n){var r=new Date,_=parseInt(n.substr(0,2),10);_=_>=50?1900+_:2e3+_;var E=parseInt(n.substr(2,2),10)-1,S=parseInt(n.substr(4,2),10),C=parseInt(n.substr(6,2),10),A=parseInt(n.substr(8,2),10),I=0;if(n.length>11){var B=n.charAt(10),O=10;B!=="+"&&B!=="-"&&(I=parseInt(n.substr(10,2),10),O+=2)}if(r.setUTCFullYear(_,E,S),r.setUTCHours(C,A,I,0),O&&(B=n.charAt(O),B==="+"||B==="-")){var N=parseInt(n.substr(O+1,2),10),U=parseInt(n.substr(O+4,2),10),j=N*60+U;j*=6e4,B==="+"?r.setTime(+r-j):r.setTime(+r+j)}return r};asn1$4.generalizedTimeToDate=function(n){var r=new Date,_=parseInt(n.substr(0,4),10),E=parseInt(n.substr(4,2),10)-1,S=parseInt(n.substr(6,2),10),C=parseInt(n.substr(8,2),10),A=parseInt(n.substr(10,2),10),I=parseInt(n.substr(12,2),10),B=0,O=0,N=!1;n.charAt(n.length-1)==="Z"&&(N=!0);var U=n.length-5,j=n.charAt(U);if(j==="+"||j==="-"){var z=parseInt(n.substr(U+1,2),10),Z=parseInt(n.substr(U+4,2),10);O=z*60+Z,O*=6e4,j==="+"&&(O*=-1),N=!0}return n.charAt(14)==="."&&(B=parseFloat(n.substr(14),10)*1e3),N?(r.setUTCFullYear(_,E,S),r.setUTCHours(C,A,I,B),r.setTime(+r+O)):(r.setFullYear(_,E,S),r.setHours(C,A,I,B)),r};asn1$4.dateToUtcTime=function(n){if(typeof n=="string")return n;var r="",_=[];_.push((""+n.getUTCFullYear()).substr(2)),_.push(""+(n.getUTCMonth()+1)),_.push(""+n.getUTCDate()),_.push(""+n.getUTCHours()),_.push(""+n.getUTCMinutes()),_.push(""+n.getUTCSeconds());for(var E=0;E<_.length;++E)_[E].length<2&&(r+="0"),r+=_[E];return r+="Z",r};asn1$4.dateToGeneralizedTime=function(n){if(typeof n=="string")return n;var r="",_=[];_.push(""+n.getUTCFullYear()),_.push(""+(n.getUTCMonth()+1)),_.push(""+n.getUTCDate()),_.push(""+n.getUTCHours()),_.push(""+n.getUTCMinutes()),_.push(""+n.getUTCSeconds());for(var E=0;E<_.length;++E)_[E].length<2&&(r+="0"),r+=_[E];return r+="Z",r};asn1$4.integerToDer=function(n){var r=forge$g.util.createBuffer();if(n>=-128&&n<128)return r.putSignedInt(n,8);if(n>=-32768&&n<32768)return r.putSignedInt(n,16);if(n>=-8388608&&n<8388608)return r.putSignedInt(n,24);if(n>=-2147483648&&n<2147483648)return r.putSignedInt(n,32);var _=new Error("Integer too large; max is 32-bits.");throw _.integer=n,_};asn1$4.derToInteger=function(n){typeof n=="string"&&(n=forge$g.util.createBuffer(n));var r=n.length()*8;if(r>32)throw new Error("Integer too large; max is 32-bits.");return n.getSignedInt(r)};asn1$4.validate=function(n,r,_,E){var S=!1;if((n.tagClass===r.tagClass||typeof r.tagClass>"u")&&(n.type===r.type||typeof r.type>"u"))if(n.constructed===r.constructed||typeof r.constructed>"u"){if(S=!0,r.value&&forge$g.util.isArray(r.value))for(var C=0,A=0;S&&A<r.value.length;++A)S=r.value[A].optional||!1,n.value[C]&&(S=asn1$4.validate(n.value[C],r.value[A],_,E),S?++C:r.value[A].optional&&(S=!0)),!S&&E&&E.push("["+r.name+'] Tag class "'+r.tagClass+'", type "'+r.type+'" expected value length "'+r.value.length+'", got "'+n.value.length+'"');if(S&&_&&(r.capture&&(_[r.capture]=n.value),r.captureAsn1&&(_[r.captureAsn1]=n),r.captureBitStringContents&&"bitStringContents"in n&&(_[r.captureBitStringContents]=n.bitStringContents),r.captureBitStringValue&&"bitStringContents"in n))if(n.bitStringContents.length<2)_[r.captureBitStringValue]="";else{var I=n.bitStringContents.charCodeAt(0);if(I!==0)throw new Error("captureBitStringValue only supported for zero unused bits");_[r.captureBitStringValue]=n.bitStringContents.slice(1)}}else E&&E.push("["+r.name+'] Expected constructed "'+r.constructed+'", got "'+n.constructed+'"');else E&&(n.tagClass!==r.tagClass&&E.push("["+r.name+'] Expected tag class "'+r.tagClass+'", got "'+n.tagClass+'"'),n.type!==r.type&&E.push("["+r.name+'] Expected type "'+r.type+'", got "'+n.type+'"'));return S};var _nonLatinRegex=/[^\\u0000-\\u00ff]/;asn1$4.prettyPrint=function(n,r,_){var E="";r=r||0,_=_||2,r>0&&(E+=`
`);for(var S="",C=0;C<r*_;++C)S+=" ";switch(E+=S+"Tag: ",n.tagClass){case asn1$4.Class.UNIVERSAL:E+="Universal:";break;case asn1$4.Class.APPLICATION:E+="Application:";break;case asn1$4.Class.CONTEXT_SPECIFIC:E+="Context-Specific:";break;case asn1$4.Class.PRIVATE:E+="Private:";break}if(n.tagClass===asn1$4.Class.UNIVERSAL)switch(E+=n.type,n.type){case asn1$4.Type.NONE:E+=" (None)";break;case asn1$4.Type.BOOLEAN:E+=" (Boolean)";break;case asn1$4.Type.INTEGER:E+=" (Integer)";break;case asn1$4.Type.BITSTRING:E+=" (Bit string)";break;case asn1$4.Type.OCTETSTRING:E+=" (Octet string)";break;case asn1$4.Type.NULL:E+=" (Null)";break;case asn1$4.Type.OID:E+=" (Object Identifier)";break;case asn1$4.Type.ODESC:E+=" (Object Descriptor)";break;case asn1$4.Type.EXTERNAL:E+=" (External or Instance of)";break;case asn1$4.Type.REAL:E+=" (Real)";break;case asn1$4.Type.ENUMERATED:E+=" (Enumerated)";break;case asn1$4.Type.EMBEDDED:E+=" (Embedded PDV)";break;case asn1$4.Type.UTF8:E+=" (UTF8)";break;case asn1$4.Type.ROID:E+=" (Relative Object Identifier)";break;case asn1$4.Type.SEQUENCE:E+=" (Sequence)";break;case asn1$4.Type.SET:E+=" (Set)";break;case asn1$4.Type.PRINTABLESTRING:E+=" (Printable String)";break;case asn1$4.Type.IA5String:E+=" (IA5String (ASCII))";break;case asn1$4.Type.UTCTIME:E+=" (UTC time)";break;case asn1$4.Type.GENERALIZEDTIME:E+=" (Generalized time)";break;case asn1$4.Type.BMPSTRING:E+=" (BMP String)";break}else E+=n.type;if(E+=`
`,E+=S+"Constructed: "+n.constructed+`
`,n.composed){for(var A=0,I="",C=0;C<n.value.length;++C)n.value[C]!==void 0&&(A+=1,I+=asn1$4.prettyPrint(n.value[C],r+1,_),C+1<n.value.length&&(I+=","));E+=S+"Sub values: "+A+I}else{if(E+=S+"Value: ",n.type===asn1$4.Type.OID){var B=asn1$4.derToOid(n.value);E+=B,forge$g.pki&&forge$g.pki.oids&&B in forge$g.pki.oids&&(E+=" ("+forge$g.pki.oids[B]+") ")}if(n.type===asn1$4.Type.INTEGER)try{E+=asn1$4.derToInteger(n.value)}catch{E+="0x"+forge$g.util.bytesToHex(n.value)}else if(n.type===asn1$4.Type.BITSTRING){if(n.value.length>1?E+="0x"+forge$g.util.bytesToHex(n.value.slice(1)):E+="(none)",n.value.length>0){var O=n.value.charCodeAt(0);O==1?E+=" (1 unused bit shown)":O>1&&(E+=" ("+O+" unused bits shown)")}}else if(n.type===asn1$4.Type.OCTETSTRING)_nonLatinRegex.test(n.value)||(E+="("+n.value+") "),E+="0x"+forge$g.util.bytesToHex(n.value);else if(n.type===asn1$4.Type.UTF8)try{E+=forge$g.util.decodeUtf8(n.value)}catch(N){if(N.message==="URI malformed")E+="0x"+forge$g.util.bytesToHex(n.value)+" (malformed UTF8)";else throw N}else n.type===asn1$4.Type.PRINTABLESTRING||n.type===asn1$4.Type.IA5String?E+=n.value:_nonLatinRegex.test(n.value)?E+="0x"+forge$g.util.bytesToHex(n.value):n.value.length===0?E+="[null]":E+=n.value}return E};var forge$f=forge$m;forge$f.des=forge$f.des||{};forge$f.des.startEncrypting=function(n,r,_,E){var S=_createCipher({key:n,output:_,decrypt:!1,mode:E||(r===null?"ECB":"CBC")});return S.start(r),S};forge$f.des.createEncryptionCipher=function(n,r){return _createCipher({key:n,output:null,decrypt:!1,mode:r})};forge$f.des.startDecrypting=function(n,r,_,E){var S=_createCipher({key:n,output:_,decrypt:!0,mode:E||(r===null?"ECB":"CBC")});return S.start(r),S};forge$f.des.createDecryptionCipher=function(n,r){return _createCipher({key:n,output:null,decrypt:!0,mode:r})};forge$f.des.Algorithm=function(n,r){var _=this;_.name=n,_.mode=new r({blockSize:8,cipher:{encrypt:function(E,S){return _updateBlock(_._keys,E,S,!1)},decrypt:function(E,S){return _updateBlock(_._keys,E,S,!0)}}}),_._init=!1};forge$f.des.Algorithm.prototype.initialize=function(n){if(!this._init){var r=forge$f.util.createBuffer(n.key);if(this.name.indexOf("3DES")===0&&r.length()!==24)throw new Error("Invalid Triple-DES key size: "+r.length()*8);this._keys=_createKeys(r),this._init=!0}};registerAlgorithm("DES-ECB",forge$f.cipher.modes.ecb);registerAlgorithm("DES-CBC",forge$f.cipher.modes.cbc);registerAlgorithm("DES-CFB",forge$f.cipher.modes.cfb);registerAlgorithm("DES-OFB",forge$f.cipher.modes.ofb);registerAlgorithm("DES-CTR",forge$f.cipher.modes.ctr);registerAlgorithm("3DES-ECB",forge$f.cipher.modes.ecb);registerAlgorithm("3DES-CBC",forge$f.cipher.modes.cbc);registerAlgorithm("3DES-CFB",forge$f.cipher.modes.cfb);registerAlgorithm("3DES-OFB",forge$f.cipher.modes.ofb);registerAlgorithm("3DES-CTR",forge$f.cipher.modes.ctr);function registerAlgorithm(n,r){var _=function(){return new forge$f.des.Algorithm(n,r)};forge$f.cipher.registerAlgorithm(n,_)}var spfunction1=[16843776,0,65536,16843780,16842756,66564,4,65536,1024,16843776,16843780,1024,16778244,16842756,16777216,4,1028,16778240,16778240,66560,66560,16842752,16842752,16778244,65540,16777220,16777220,65540,0,1028,66564,16777216,65536,16843780,4,16842752,16843776,16777216,16777216,1024,16842756,65536,66560,16777220,1024,4,16778244,66564,16843780,65540,16842752,16778244,16777220,1028,66564,16843776,1028,16778240,16778240,0,65540,66560,0,16842756],spfunction2=[-2146402272,-2147450880,32768,1081376,1048576,32,-2146435040,-2147450848,-2147483616,-2146402272,-2146402304,-2147483648,-2147450880,1048576,32,-2146435040,1081344,1048608,-2147450848,0,-2147483648,32768,1081376,-2146435072,1048608,-2147483616,0,1081344,32800,-2146402304,-2146435072,32800,0,1081376,-2146435040,1048576,-2147450848,-2146435072,-2146402304,32768,-2146435072,-2147450880,32,-2146402272,1081376,32,32768,-2147483648,32800,-2146402304,1048576,-2147483616,1048608,-2147450848,-2147483616,1048608,1081344,0,-2147450880,32800,-2147483648,-2146435040,-2146402272,1081344],spfunction3=[520,134349312,0,134348808,134218240,0,131592,134218240,131080,134217736,134217736,131072,134349320,131080,134348800,520,134217728,8,134349312,512,131584,134348800,134348808,131592,134218248,131584,131072,134218248,8,134349320,512,134217728,134349312,134217728,131080,520,131072,134349312,134218240,0,512,131080,134349320,134218240,134217736,512,0,134348808,134218248,131072,134217728,134349320,8,131592,131584,134217736,134348800,134218248,520,134348800,131592,8,134348808,131584],spfunction4=[8396801,8321,8321,128,8396928,8388737,8388609,8193,0,8396800,8396800,8396929,129,0,8388736,8388609,1,8192,8388608,8396801,128,8388608,8193,8320,8388737,1,8320,8388736,8192,8396928,8396929,129,8388736,8388609,8396800,8396929,129,0,0,8396800,8320,8388736,8388737,1,8396801,8321,8321,128,8396929,129,1,8192,8388609,8193,8396928,8388737,8193,8320,8388608,8396801,128,8388608,8192,8396928],spfunction5=[256,34078976,34078720,1107296512,524288,256,1073741824,34078720,1074266368,524288,33554688,1074266368,1107296512,1107820544,524544,1073741824,33554432,1074266112,1074266112,0,1073742080,1107820800,1107820800,33554688,1107820544,1073742080,0,1107296256,34078976,33554432,1107296256,524544,524288,1107296512,256,33554432,1073741824,34078720,1107296512,1074266368,33554688,1073741824,1107820544,34078976,1074266368,256,33554432,1107820544,1107820800,524544,1107296256,1107820800,34078720,0,1074266112,1107296256,524544,33554688,1073742080,524288,0,1074266112,34078976,1073742080],spfunction6=[536870928,541065216,16384,541081616,541065216,16,541081616,4194304,536887296,4210704,4194304,536870928,4194320,536887296,536870912,16400,0,4194320,536887312,16384,4210688,536887312,16,541065232,541065232,0,4210704,541081600,16400,4210688,541081600,536870912,536887296,16,541065232,4210688,541081616,4194304,16400,536870928,4194304,536887296,536870912,16400,536870928,541081616,4210688,541065216,4210704,541081600,0,541065232,16,16384,541065216,4210704,16384,4194320,536887312,0,541081600,536870912,4194320,536887312],spfunction7=[2097152,69206018,67110914,0,2048,67110914,2099202,69208064,69208066,2097152,0,67108866,2,67108864,69206018,2050,67110912,2099202,2097154,67110912,67108866,69206016,69208064,2097154,69206016,2048,2050,69208066,2099200,2,67108864,2099200,67108864,2099200,2097152,67110914,67110914,69206018,69206018,2,2097154,67108864,67110912,2097152,69208064,2050,2099202,69208064,2050,67108866,69208066,69206016,2099200,0,2,69208066,0,2099202,69206016,2048,67108866,67110912,2048,2097154],spfunction8=[268439616,4096,262144,268701760,268435456,268439616,64,268435456,262208,268697600,268701760,266240,268701696,266304,4096,64,268697600,268435520,268439552,4160,266240,262208,268697664,268701696,4160,0,0,268697664,268435520,268439552,266304,262144,266304,262144,268701696,4096,64,268697664,4096,266304,268439552,64,268435520,268697600,268697664,268435456,262144,268439616,0,268701760,262208,268435520,268697600,268439552,268439616,0,268701760,266240,266240,4160,4160,262208,268435456,268701696];function _createKeys(n){for(var r=[0,4,536870912,536870916,65536,65540,536936448,536936452,512,516,536871424,536871428,66048,66052,536936960,536936964],_=[0,1,1048576,1048577,67108864,67108865,68157440,68157441,256,257,1048832,1048833,67109120,67109121,68157696,68157697],E=[0,8,2048,2056,16777216,16777224,16779264,16779272,0,8,2048,2056,16777216,16777224,16779264,16779272],S=[0,2097152,134217728,136314880,8192,2105344,134225920,136323072,131072,2228224,134348800,136445952,139264,2236416,134356992,136454144],C=[0,262144,16,262160,0,262144,16,262160,4096,266240,4112,266256,4096,266240,4112,266256],A=[0,1024,32,1056,0,1024,32,1056,33554432,33555456,33554464,33555488,33554432,33555456,33554464,33555488],I=[0,268435456,524288,268959744,2,268435458,524290,268959746,0,268435456,524288,268959744,2,268435458,524290,268959746],B=[0,65536,2048,67584,536870912,536936448,536872960,536938496,131072,196608,133120,198656,537001984,537067520,537004032,537069568],O=[0,262144,0,262144,2,262146,2,262146,33554432,33816576,33554432,33816576,33554434,33816578,33554434,33816578],N=[0,268435456,8,268435464,0,268435456,8,268435464,1024,268436480,1032,268436488,1024,268436480,1032,268436488],U=[0,32,0,32,1048576,1048608,1048576,1048608,8192,8224,8192,8224,1056768,1056800,1056768,1056800],j=[0,16777216,512,16777728,2097152,18874368,2097664,18874880,67108864,83886080,67109376,83886592,69206016,85983232,69206528,85983744],z=[0,4096,134217728,134221824,524288,528384,134742016,134746112,16,4112,134217744,134221840,524304,528400,134742032,134746128],Z=[0,4,256,260,0,4,256,260,1,5,257,261,1,5,257,261],X=n.length()>8?3:1,Q=[],se=[0,0,1,1,1,1,1,1,0,1,1,1,1,1,1,0],oe=0,ue,we=0;we<X;we++){var Te=n.getInt32(),xe=n.getInt32();ue=(Te>>>4^xe)&252645135,xe^=ue,Te^=ue<<4,ue=(xe>>>-16^Te)&65535,Te^=ue,xe^=ue<<-16,ue=(Te>>>2^xe)&858993459,xe^=ue,Te^=ue<<2,ue=(xe>>>-16^Te)&65535,Te^=ue,xe^=ue<<-16,ue=(Te>>>1^xe)&1431655765,xe^=ue,Te^=ue<<1,ue=(xe>>>8^Te)&16711935,Te^=ue,xe^=ue<<8,ue=(Te>>>1^xe)&1431655765,xe^=ue,Te^=ue<<1,ue=Te<<8|xe>>>20&240,Te=xe<<24|xe<<8&16711680|xe>>>8&65280|xe>>>24&240,xe=ue;for(var Re=0;Re<se.length;++Re){se[Re]?(Te=Te<<2|Te>>>26,xe=xe<<2|xe>>>26):(Te=Te<<1|Te>>>27,xe=xe<<1|xe>>>27),Te&=-15,xe&=-15;var Ne=r[Te>>>28]|_[Te>>>24&15]|E[Te>>>20&15]|S[Te>>>16&15]|C[Te>>>12&15]|A[Te>>>8&15]|I[Te>>>4&15],Fe=B[xe>>>28]|O[xe>>>24&15]|N[xe>>>20&15]|U[xe>>>16&15]|j[xe>>>12&15]|z[xe>>>8&15]|Z[xe>>>4&15];ue=(Fe>>>16^Ne)&65535,Q[oe++]=Ne^ue,Q[oe++]=Fe^ue<<16}}return Q}function _updateBlock(n,r,_,E){var S=n.length===32?3:9,C;S===3?C=E?[30,-2,-2]:[0,32,2]:C=E?[94,62,-2,32,64,2,30,-2,-2]:[0,32,2,62,30,-2,64,96,2];var A,I=r[0],B=r[1];A=(I>>>4^B)&252645135,B^=A,I^=A<<4,A=(I>>>16^B)&65535,B^=A,I^=A<<16,A=(B>>>2^I)&858993459,I^=A,B^=A<<2,A=(B>>>8^I)&16711935,I^=A,B^=A<<8,A=(I>>>1^B)&1431655765,B^=A,I^=A<<1,I=I<<1|I>>>31,B=B<<1|B>>>31;for(var O=0;O<S;O+=3){for(var N=C[O+1],U=C[O+2],j=C[O];j!=N;j+=U){var z=B^n[j],Z=(B>>>4|B<<28)^n[j+1];A=I,I=B,B=A^(spfunction2[z>>>24&63]|spfunction4[z>>>16&63]|spfunction6[z>>>8&63]|spfunction8[z&63]|spfunction1[Z>>>24&63]|spfunction3[Z>>>16&63]|spfunction5[Z>>>8&63]|spfunction7[Z&63])}A=I,I=B,B=A}I=I>>>1|I<<31,B=B>>>1|B<<31,A=(I>>>1^B)&1431655765,B^=A,I^=A<<1,A=(B>>>8^I)&16711935,I^=A,B^=A<<8,A=(B>>>2^I)&858993459,I^=A,B^=A<<2,A=(I>>>16^B)&65535,B^=A,I^=A<<16,A=(I>>>4^B)&252645135,B^=A,I^=A<<4,_[0]=I,_[1]=B}function _createCipher(n){n=n||{};var r=(n.mode||"CBC").toUpperCase(),_="DES-"+r,E;n.decrypt?E=forge$f.cipher.createDecipher(_,n.key):E=forge$f.cipher.createCipher(_,n.key);var S=E.start;return E.start=function(C,A){var I=null;A instanceof forge$f.util.ByteBuffer&&(I=A,A={}),A=A||{},A.output=I,A.iv=C,S.call(E,A)},E}var forge$e=forge$m;forge$e.md=forge$e.md||{};forge$e.md.algorithms=forge$e.md.algorithms||{};var forge$d=forge$m,hmac$2=forge$d.hmac=forge$d.hmac||{};hmac$2.create=function(){var n=null,r=null,_=null,E=null,S={};return S.start=function(C,A){if(C!==null)if(typeof C=="string")if(C=C.toLowerCase(),C in forge$d.md.algorithms)r=forge$d.md.algorithms[C].create();else throw new Error('Unknown hash algorithm "'+C+'"');else r=C;if(A===null)A=n;else{if(typeof A=="string")A=forge$d.util.createBuffer(A);else if(forge$d.util.isArray(A)){var I=A;A=forge$d.util.createBuffer();for(var B=0;B<I.length;++B)A.putByte(I[B])}var O=A.length();O>r.blockLength&&(r.start(),r.update(A.bytes()),A=r.digest()),_=forge$d.util.createBuffer(),E=forge$d.util.createBuffer(),O=A.length();for(var B=0;B<O;++B){var I=A.at(B);_.putByte(54^I),E.putByte(92^I)}if(O<r.blockLength)for(var I=r.blockLength-O,B=0;B<I;++B)_.putByte(54),E.putByte(92);n=A,_=_.bytes(),E=E.bytes()}r.start(),r.update(_)},S.update=function(C){r.update(C)},S.getMac=function(){var C=r.digest().bytes();return r.start(),r.update(E),r.update(C),r.digest()},S.digest=S.getMac,S};var cryptoBrowserify={},browser$f={exports:{}},safeBuffer$1={exports:{}};/*! safe-buffer. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */var hasRequiredSafeBuffer;function requireSafeBuffer(){return hasRequiredSafeBuffer||(hasRequiredSafeBuffer=1,function(n,r){var _=buffer$2,E=_.Buffer;function S(A,I){for(var B in A)I[B]=A[B]}E.from&&E.alloc&&E.allocUnsafe&&E.allocUnsafeSlow?n.exports=_:(S(_,r),r.Buffer=C);function C(A,I,B){return E(A,I,B)}C.prototype=Object.create(E.prototype),S(E,C),C.from=function(A,I,B){if(typeof A=="number")throw new TypeError("Argument must not be a number");return E(A,I,B)},C.alloc=function(A,I,B){if(typeof A!="number")throw new TypeError("Argument must be a number");var O=E(A);return I!==void 0?typeof B=="string"?O.fill(I,B):O.fill(I):O.fill(0),O},C.allocUnsafe=function(A){if(typeof A!="number")throw new TypeError("Argument must be a number");return E(A)},C.allocUnsafeSlow=function(A){if(typeof A!="number")throw new TypeError("Argument must be a number");return _.SlowBuffer(A)}}(safeBuffer$1,safeBuffer$1.exports)),safeBuffer$1.exports}var hasRequiredBrowser$b;function requireBrowser$b(){if(hasRequiredBrowser$b)return browser$f.exports;hasRequiredBrowser$b=1;var n=65536,r=4294967295;function _(){throw new Error(`Secure random number generation is not supported by this browser.
Use Chrome, Firefox or Internet Explorer 11`)}var E=requireSafeBuffer().Buffer,S=commonjsGlobal.crypto||commonjsGlobal.msCrypto;S&&S.getRandomValues?browser$f.exports=C:browser$f.exports=_;function C(A,I){if(A>r)throw new RangeError("requested too many random bytes");var B=E.allocUnsafe(A);if(A>0)if(A>n)for(var O=0;O<A;O+=n)S.getRandomValues(B.slice(O,O+n));else S.getRandomValues(B);return typeof I=="function"?browser$1$1.nextTick(function(){I(null,B)}):B}return browser$f.exports}var readableBrowser$1={exports:{}},streamBrowser$1,hasRequiredStreamBrowser$1;function requireStreamBrowser$1(){return hasRequiredStreamBrowser$1||(hasRequiredStreamBrowser$1=1,streamBrowser$1=eventsExports.EventEmitter),streamBrowser$1}var buffer_list,hasRequiredBuffer_list;function requireBuffer_list(){if(hasRequiredBuffer_list)return buffer_list;hasRequiredBuffer_list=1;function n(Z,X){var Q=Object.keys(Z);if(Object.getOwnPropertySymbols){var se=Object.getOwnPropertySymbols(Z);X&&(se=se.filter(function(oe){return Object.getOwnPropertyDescriptor(Z,oe).enumerable})),Q.push.apply(Q,se)}return Q}function r(Z){for(var X=1;X<arguments.length;X++){var Q=arguments[X]!=null?arguments[X]:{};X%2?n(Object(Q),!0).forEach(function(se){_(Z,se,Q[se])}):Object.getOwnPropertyDescriptors?Object.defineProperties(Z,Object.getOwnPropertyDescriptors(Q)):n(Object(Q)).forEach(function(se){Object.defineProperty(Z,se,Object.getOwnPropertyDescriptor(Q,se))})}return Z}function _(Z,X,Q){return X=A(X),X in Z?Object.defineProperty(Z,X,{value:Q,enumerable:!0,configurable:!0,writable:!0}):Z[X]=Q,Z}function E(Z,X){if(!(Z instanceof X))throw new TypeError("Cannot call a class as a function")}function S(Z,X){for(var Q=0;Q<X.length;Q++){var se=X[Q];se.enumerable=se.enumerable||!1,se.configurable=!0,"value"in se&&(se.writable=!0),Object.defineProperty(Z,A(se.key),se)}}function C(Z,X,Q){return X&&S(Z.prototype,X),Q&&S(Z,Q),Object.defineProperty(Z,"prototype",{writable:!1}),Z}function A(Z){var X=I(Z,"string");return typeof X=="symbol"?X:String(X)}function I(Z,X){if(typeof Z!="object"||Z===null)return Z;var Q=Z[Symbol.toPrimitive];if(Q!==void 0){var se=Q.call(Z,X||"default");if(typeof se!="object")return se;throw new TypeError("@@toPrimitive must return a primitive value.")}return(X==="string"?String:Number)(Z)}var B=buffer$2,O=B.Buffer,N=require$$1$2,U=N.inspect,j=U&&U.custom||"inspect";function z(Z,X,Q){O.prototype.copy.call(Z,X,Q)}return buffer_list=function(){function Z(){E(this,Z),this.head=null,this.tail=null,this.length=0}return C(Z,[{key:"push",value:function(Q){var se={data:Q,next:null};this.length>0?this.tail.next=se:this.head=se,this.tail=se,++this.length}},{key:"unshift",value:function(Q){var se={data:Q,next:this.head};this.length===0&&(this.tail=se),this.head=se,++this.length}},{key:"shift",value:function(){if(this.length!==0){var Q=this.head.data;return this.length===1?this.head=this.tail=null:this.head=this.head.next,--this.length,Q}}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(Q){if(this.length===0)return"";for(var se=this.head,oe=""+se.data;se=se.next;)oe+=Q+se.data;return oe}},{key:"concat",value:function(Q){if(this.length===0)return O.alloc(0);for(var se=O.allocUnsafe(Q>>>0),oe=this.head,ue=0;oe;)z(oe.data,se,ue),ue+=oe.data.length,oe=oe.next;return se}},{key:"consume",value:function(Q,se){var oe;return Q<this.head.data.length?(oe=this.head.data.slice(0,Q),this.head.data=this.head.data.slice(Q)):Q===this.head.data.length?oe=this.shift():oe=se?this._getString(Q):this._getBuffer(Q),oe}},{key:"first",value:function(){return this.head.data}},{key:"_getString",value:function(Q){var se=this.head,oe=1,ue=se.data;for(Q-=ue.length;se=se.next;){var we=se.data,Te=Q>we.length?we.length:Q;if(Te===we.length?ue+=we:ue+=we.slice(0,Q),Q-=Te,Q===0){Te===we.length?(++oe,se.next?this.head=se.next:this.head=this.tail=null):(this.head=se,se.data=we.slice(Te));break}++oe}return this.length-=oe,ue}},{key:"_getBuffer",value:function(Q){var se=O.allocUnsafe(Q),oe=this.head,ue=1;for(oe.data.copy(se),Q-=oe.data.length;oe=oe.next;){var we=oe.data,Te=Q>we.length?we.length:Q;if(we.copy(se,se.length-Q,0,Te),Q-=Te,Q===0){Te===we.length?(++ue,oe.next?this.head=oe.next:this.head=this.tail=null):(this.head=oe,oe.data=we.slice(Te));break}++ue}return this.length-=ue,se}},{key:j,value:function(Q,se){return U(this,r(r({},se),{},{depth:0,customInspect:!1}))}}]),Z}(),buffer_list}var destroy_1$1,hasRequiredDestroy$1;function requireDestroy$1(){if(hasRequiredDestroy$1)return destroy_1$1;hasRequiredDestroy$1=1;function n(A,I){var B=this,O=this._readableState&&this._readableState.destroyed,N=this._writableState&&this._writableState.destroyed;return O||N?(I?I(A):A&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,browser$1$1.nextTick(S,this,A)):browser$1$1.nextTick(S,this,A)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(A||null,function(U){!I&&U?B._writableState?B._writableState.errorEmitted?browser$1$1.nextTick(_,B):(B._writableState.errorEmitted=!0,browser$1$1.nextTick(r,B,U)):browser$1$1.nextTick(r,B,U):I?(browser$1$1.nextTick(_,B),I(U)):browser$1$1.nextTick(_,B)}),this)}function r(A,I){S(A,I),_(A)}function _(A){A._writableState&&!A._writableState.emitClose||A._readableState&&!A._readableState.emitClose||A.emit("close")}function E(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}function S(A,I){A.emit("error",I)}function C(A,I){var B=A._readableState,O=A._writableState;B&&B.autoDestroy||O&&O.autoDestroy?A.destroy(I):A.emit("error",I)}return destroy_1$1={destroy:n,undestroy:E,errorOrDestroy:C},destroy_1$1}var errorsBrowser={},hasRequiredErrorsBrowser;function requireErrorsBrowser(){if(hasRequiredErrorsBrowser)return errorsBrowser;hasRequiredErrorsBrowser=1;function n(I,B){I.prototype=Object.create(B.prototype),I.prototype.constructor=I,I.__proto__=B}var r={};function _(I,B,O){O||(O=Error);function N(j,z,Z){return typeof B=="string"?B:B(j,z,Z)}var U=function(j){n(z,j);function z(Z,X,Q){return j.call(this,N(Z,X,Q))||this}return z}(O);U.prototype.name=O.name,U.prototype.code=I,r[I]=U}function E(I,B){if(Array.isArray(I)){var O=I.length;return I=I.map(function(N){return String(N)}),O>2?"one of ".concat(B," ").concat(I.slice(0,O-1).join(", "),", or ")+I[O-1]:O===2?"one of ".concat(B," ").concat(I[0]," or ").concat(I[1]):"of ".concat(B," ").concat(I[0])}else return"of ".concat(B," ").concat(String(I))}function S(I,B,O){return I.substr(!O||O<0?0:+O,B.length)===B}function C(I,B,O){return(O===void 0||O>I.length)&&(O=I.length),I.substring(O-B.length,O)===B}function A(I,B,O){return typeof O!="number"&&(O=0),O+B.length>I.length?!1:I.indexOf(B,O)!==-1}return _("ERR_INVALID_OPT_VALUE",function(I,B){return'The value "'+B+'" is invalid for option "'+I+'"'},TypeError),_("ERR_INVALID_ARG_TYPE",function(I,B,O){var N;typeof B=="string"&&S(B,"not ")?(N="must not be",B=B.replace(/^not /,"")):N="must be";var U;if(C(I," argument"))U="The ".concat(I," ").concat(N," ").concat(E(B,"type"));else{var j=A(I,".")?"property":"argument";U='The "'.concat(I,'" ').concat(j," ").concat(N," ").concat(E(B,"type"))}return U+=". Received type ".concat(typeof O),U},TypeError),_("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF"),_("ERR_METHOD_NOT_IMPLEMENTED",function(I){return"The "+I+" method is not implemented"}),_("ERR_STREAM_PREMATURE_CLOSE","Premature close"),_("ERR_STREAM_DESTROYED",function(I){return"Cannot call "+I+" after a stream was destroyed"}),_("ERR_MULTIPLE_CALLBACK","Callback called multiple times"),_("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable"),_("ERR_STREAM_WRITE_AFTER_END","write after end"),_("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),_("ERR_UNKNOWN_ENCODING",function(I){return"Unknown encoding: "+I},TypeError),_("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event"),errorsBrowser.codes=r,errorsBrowser}var state,hasRequiredState;function requireState(){if(hasRequiredState)return state;hasRequiredState=1;var n=requireErrorsBrowser().codes.ERR_INVALID_OPT_VALUE;function r(E,S,C){return E.highWaterMark!=null?E.highWaterMark:S?E[C]:null}function _(E,S,C,A){var I=r(S,A,C);if(I!=null){if(!(isFinite(I)&&Math.floor(I)===I)||I<0){var B=A?C:"highWaterMark";throw new n(B,I)}return Math.floor(I)}return E.objectMode?16:16*1024}return state={getHighWaterMark:_},state}var browser$e,hasRequiredBrowser$a;function requireBrowser$a(){if(hasRequiredBrowser$a)return browser$e;hasRequiredBrowser$a=1,browser$e=n;function n(_,E){if(r("noDeprecation"))return _;var S=!1;function C(){if(!S){if(r("throwDeprecation"))throw new Error(E);r("traceDeprecation")?console.trace(E):console.warn(E),S=!0}return _.apply(this,arguments)}return C}function r(_){try{if(!commonjsGlobal.localStorage)return!1}catch{return!1}var E=commonjsGlobal.localStorage[_];return E==null?!1:String(E).toLowerCase()==="true"}return browser$e}var _stream_writable$1,hasRequired_stream_writable$1;function require_stream_writable$1(){if(hasRequired_stream_writable$1)return _stream_writable$1;hasRequired_stream_writable$1=1,_stream_writable$1=Ne;function n(ct){var Qe=this;this.next=null,this.entry=null,this.finish=function(){mt(Qe,ct)}}var r;Ne.WritableState=xe;var _={deprecate:requireBrowser$a()},E=requireStreamBrowser$1(),S=buffer$2.Buffer,C=(typeof commonjsGlobal<"u"?commonjsGlobal:typeof window<"u"?window:typeof self<"u"?self:{}).Uint8Array||function(){};function A(ct){return S.from(ct)}function I(ct){return S.isBuffer(ct)||ct instanceof C}var B=requireDestroy$1(),O=requireState(),N=O.getHighWaterMark,U=requireErrorsBrowser().codes,j=U.ERR_INVALID_ARG_TYPE,z=U.ERR_METHOD_NOT_IMPLEMENTED,Z=U.ERR_MULTIPLE_CALLBACK,X=U.ERR_STREAM_CANNOT_PIPE,Q=U.ERR_STREAM_DESTROYED,se=U.ERR_STREAM_NULL_VALUES,oe=U.ERR_STREAM_WRITE_AFTER_END,ue=U.ERR_UNKNOWN_ENCODING,we=B.errorOrDestroy;inherits_browserExports(Ne,E);function Te(){}function xe(ct,Qe,dt){r=r||require_stream_duplex$1(),ct=ct||{},typeof dt!="boolean"&&(dt=Qe instanceof r),this.objectMode=!!ct.objectMode,dt&&(this.objectMode=this.objectMode||!!ct.writableObjectMode),this.highWaterMark=N(this,ct,"writableHighWaterMark",dt),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var vt=ct.decodeStrings===!1;this.decodeStrings=!vt,this.defaultEncoding=ct.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(At){He(Qe,At)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=ct.emitClose!==!1,this.autoDestroy=!!ct.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new n(this)}xe.prototype.getBuffer=function(){for(var Qe=this.bufferedRequest,dt=[];Qe;)dt.push(Qe),Qe=Qe.next;return dt},function(){try{Object.defineProperty(xe.prototype,"buffer",{get:_.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch{}}();var Re;typeof Symbol=="function"&&Symbol.hasInstance&&typeof Function.prototype[Symbol.hasInstance]=="function"?(Re=Function.prototype[Symbol.hasInstance],Object.defineProperty(Ne,Symbol.hasInstance,{value:function(Qe){return Re.call(this,Qe)?!0:this!==Ne?!1:Qe&&Qe._writableState instanceof xe}})):Re=function(Qe){return Qe instanceof this};function Ne(ct){r=r||require_stream_duplex$1();var Qe=this instanceof r;if(!Qe&&!Re.call(Ne,this))return new Ne(ct);this._writableState=new xe(ct,this,Qe),this.writable=!0,ct&&(typeof ct.write=="function"&&(this._write=ct.write),typeof ct.writev=="function"&&(this._writev=ct.writev),typeof ct.destroy=="function"&&(this._destroy=ct.destroy),typeof ct.final=="function"&&(this._final=ct.final)),E.call(this)}Ne.prototype.pipe=function(){we(this,new X)};function Fe(ct,Qe){var dt=new oe;we(ct,dt),browser$1$1.nextTick(Qe,dt)}function ht(ct,Qe,dt,vt){var At;return dt===null?At=new se:typeof dt!="string"&&!Qe.objectMode&&(At=new j("chunk",["string","Buffer"],dt)),At?(we(ct,At),browser$1$1.nextTick(vt,At),!1):!0}Ne.prototype.write=function(ct,Qe,dt){var vt=this._writableState,At=!1,bt=!vt.objectMode&&I(ct);return bt&&!S.isBuffer(ct)&&(ct=A(ct)),typeof Qe=="function"&&(dt=Qe,Qe=null),bt?Qe="buffer":Qe||(Qe=vt.defaultEncoding),typeof dt!="function"&&(dt=Te),vt.ending?Fe(this,dt):(bt||ht(this,vt,ct,dt))&&(vt.pendingcb++,At=Ee(this,vt,bt,ct,Qe,dt)),At},Ne.prototype.cork=function(){this._writableState.corked++},Ne.prototype.uncork=function(){var ct=this._writableState;ct.corked&&(ct.corked--,!ct.writing&&!ct.corked&&!ct.bufferProcessing&&ct.bufferedRequest&&je(this,ct))},Ne.prototype.setDefaultEncoding=function(Qe){if(typeof Qe=="string"&&(Qe=Qe.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((Qe+"").toLowerCase())>-1))throw new ue(Qe);return this._writableState.defaultEncoding=Qe,this},Object.defineProperty(Ne.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}});function nt(ct,Qe,dt){return!ct.objectMode&&ct.decodeStrings!==!1&&typeof Qe=="string"&&(Qe=S.from(Qe,dt)),Qe}Object.defineProperty(Ne.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}});function Ee(ct,Qe,dt,vt,At,bt){if(!dt){var ft=nt(Qe,vt,At);vt!==ft&&(dt=!0,At="buffer",vt=ft)}var Et=Qe.objectMode?1:vt.length;Qe.length+=Et;var Ye=Qe.length<Qe.highWaterMark;if(Ye||(Qe.needDrain=!0),Qe.writing||Qe.corked){var Ct=Qe.lastBufferedRequest;Qe.lastBufferedRequest={chunk:vt,encoding:At,isBuf:dt,callback:bt,next:null},Ct?Ct.next=Qe.lastBufferedRequest:Qe.bufferedRequest=Qe.lastBufferedRequest,Qe.bufferedRequestCount+=1}else Ce(ct,Qe,!1,Et,vt,At,bt);return Ye}function Ce(ct,Qe,dt,vt,At,bt,ft){Qe.writelen=vt,Qe.writecb=ft,Qe.writing=!0,Qe.sync=!0,Qe.destroyed?Qe.onwrite(new Q("write")):dt?ct._writev(At,Qe.onwrite):ct._write(At,bt,Qe.onwrite),Qe.sync=!1}function _e(ct,Qe,dt,vt,At){--Qe.pendingcb,dt?(browser$1$1.nextTick(At,vt),browser$1$1.nextTick(tt,ct,Qe),ct._writableState.errorEmitted=!0,we(ct,vt)):(At(vt),ct._writableState.errorEmitted=!0,we(ct,vt),tt(ct,Qe))}function Ie(ct){ct.writing=!1,ct.writecb=null,ct.length-=ct.writelen,ct.writelen=0}function He(ct,Qe){var dt=ct._writableState,vt=dt.sync,At=dt.writecb;if(typeof At!="function")throw new Z;if(Ie(dt),Qe)_e(ct,dt,vt,Qe,At);else{var bt=Ve(dt)||ct.destroyed;!bt&&!dt.corked&&!dt.bufferProcessing&&dt.bufferedRequest&&je(ct,dt),vt?browser$1$1.nextTick(Be,ct,dt,bt,At):Be(ct,dt,bt,At)}}function Be(ct,Qe,dt,vt){dt||Ge(ct,Qe),Qe.pendingcb--,vt(),tt(ct,Qe)}function Ge(ct,Qe){Qe.length===0&&Qe.needDrain&&(Qe.needDrain=!1,ct.emit("drain"))}function je(ct,Qe){Qe.bufferProcessing=!0;var dt=Qe.bufferedRequest;if(ct._writev&&dt&&dt.next){var vt=Qe.bufferedRequestCount,At=new Array(vt),bt=Qe.corkedRequestsFree;bt.entry=dt;for(var ft=0,Et=!0;dt;)At[ft]=dt,dt.isBuf||(Et=!1),dt=dt.next,ft+=1;At.allBuffers=Et,Ce(ct,Qe,!0,Qe.length,At,"",bt.finish),Qe.pendingcb++,Qe.lastBufferedRequest=null,bt.next?(Qe.corkedRequestsFree=bt.next,bt.next=null):Qe.corkedRequestsFree=new n(Qe),Qe.bufferedRequestCount=0}else{for(;dt;){var Ye=dt.chunk,Ct=dt.encoding,Pt=dt.callback,St=Qe.objectMode?1:Ye.length;if(Ce(ct,Qe,!1,St,Ye,Ct,Pt),dt=dt.next,Qe.bufferedRequestCount--,Qe.writing)break}dt===null&&(Qe.lastBufferedRequest=null)}Qe.bufferedRequest=dt,Qe.bufferProcessing=!1}Ne.prototype._write=function(ct,Qe,dt){dt(new z("_write()"))},Ne.prototype._writev=null,Ne.prototype.end=function(ct,Qe,dt){var vt=this._writableState;return typeof ct=="function"?(dt=ct,ct=null,Qe=null):typeof Qe=="function"&&(dt=Qe,Qe=null),ct!=null&&this.write(ct,Qe),vt.corked&&(vt.corked=1,this.uncork()),vt.ending||Ke(this,vt,dt),this},Object.defineProperty(Ne.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}});function Ve(ct){return ct.ending&&ct.length===0&&ct.bufferedRequest===null&&!ct.finished&&!ct.writing}function Pe(ct,Qe){ct._final(function(dt){Qe.pendingcb--,dt&&we(ct,dt),Qe.prefinished=!0,ct.emit("prefinish"),tt(ct,Qe)})}function Me(ct,Qe){!Qe.prefinished&&!Qe.finalCalled&&(typeof ct._final=="function"&&!Qe.destroyed?(Qe.pendingcb++,Qe.finalCalled=!0,browser$1$1.nextTick(Pe,ct,Qe)):(Qe.prefinished=!0,ct.emit("prefinish")))}function tt(ct,Qe){var dt=Ve(Qe);if(dt&&(Me(ct,Qe),Qe.pendingcb===0&&(Qe.finished=!0,ct.emit("finish"),Qe.autoDestroy))){var vt=ct._readableState;(!vt||vt.autoDestroy&&vt.endEmitted)&&ct.destroy()}return dt}function Ke(ct,Qe,dt){Qe.ending=!0,tt(ct,Qe),dt&&(Qe.finished?browser$1$1.nextTick(dt):ct.once("finish",dt)),Qe.ended=!0,ct.writable=!1}function mt(ct,Qe,dt){var vt=ct.entry;for(ct.entry=null;vt;){var At=vt.callback;Qe.pendingcb--,At(dt),vt=vt.next}Qe.corkedRequestsFree.next=ct}return Object.defineProperty(Ne.prototype,"destroyed",{enumerable:!1,get:function(){return this._writableState===void 0?!1:this._writableState.destroyed},set:function(Qe){this._writableState&&(this._writableState.destroyed=Qe)}}),Ne.prototype.destroy=B.destroy,Ne.prototype._undestroy=B.undestroy,Ne.prototype._destroy=function(ct,Qe){Qe(ct)},_stream_writable$1}var _stream_duplex$1,hasRequired_stream_duplex$1;function require_stream_duplex$1(){if(hasRequired_stream_duplex$1)return _stream_duplex$1;hasRequired_stream_duplex$1=1;var n=Object.keys||function(O){var N=[];for(var U in O)N.push(U);return N};_stream_duplex$1=A;var r=require_stream_readable$1(),_=require_stream_writable$1();inherits_browserExports(A,r);for(var E=n(_.prototype),S=0;S<E.length;S++){var C=E[S];A.prototype[C]||(A.prototype[C]=_.prototype[C])}function A(O){if(!(this instanceof A))return new A(O);r.call(this,O),_.call(this,O),this.allowHalfOpen=!0,O&&(O.readable===!1&&(this.readable=!1),O.writable===!1&&(this.writable=!1),O.allowHalfOpen===!1&&(this.allowHalfOpen=!1,this.once("end",I)))}Object.defineProperty(A.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(A.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(A.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}});function I(){this._writableState.ended||browser$1$1.nextTick(B,this)}function B(O){O.end()}return Object.defineProperty(A.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState===void 0||this._writableState===void 0?!1:this._readableState.destroyed&&this._writableState.destroyed},set:function(N){this._readableState===void 0||this._writableState===void 0||(this._readableState.destroyed=N,this._writableState.destroyed=N)}}),_stream_duplex$1}var string_decoder$1={},hasRequiredString_decoder;function requireString_decoder(){if(hasRequiredString_decoder)return string_decoder$1;hasRequiredString_decoder=1;var n=requireSafeBuffer().Buffer,r=n.isEncoding||function(se){switch(se=""+se,se&&se.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function _(se){if(!se)return"utf8";for(var oe;;)switch(se){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return se;default:if(oe)return;se=(""+se).toLowerCase(),oe=!0}}function E(se){var oe=_(se);if(typeof oe!="string"&&(n.isEncoding===r||!r(se)))throw new Error("Unknown encoding: "+se);return oe||se}string_decoder$1.StringDecoder=S;function S(se){this.encoding=E(se);var oe;switch(this.encoding){case"utf16le":this.text=U,this.end=j,oe=4;break;case"utf8":this.fillLast=B,oe=4;break;case"base64":this.text=z,this.end=Z,oe=3;break;default:this.write=X,this.end=Q;return}this.lastNeed=0,this.lastTotal=0,this.lastChar=n.allocUnsafe(oe)}S.prototype.write=function(se){if(se.length===0)return"";var oe,ue;if(this.lastNeed){if(oe=this.fillLast(se),oe===void 0)return"";ue=this.lastNeed,this.lastNeed=0}else ue=0;return ue<se.length?oe?oe+this.text(se,ue):this.text(se,ue):oe||""},S.prototype.end=N,S.prototype.text=O,S.prototype.fillLast=function(se){if(this.lastNeed<=se.length)return se.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);se.copy(this.lastChar,this.lastTotal-this.lastNeed,0,se.length),this.lastNeed-=se.length};function C(se){return se<=127?0:se>>5===6?2:se>>4===14?3:se>>3===30?4:se>>6===2?-1:-2}function A(se,oe,ue){var we=oe.length-1;if(we<ue)return 0;var Te=C(oe[we]);return Te>=0?(Te>0&&(se.lastNeed=Te-1),Te):--we<ue||Te===-2?0:(Te=C(oe[we]),Te>=0?(Te>0&&(se.lastNeed=Te-2),Te):--we<ue||Te===-2?0:(Te=C(oe[we]),Te>=0?(Te>0&&(Te===2?Te=0:se.lastNeed=Te-3),Te):0))}function I(se,oe,ue){if((oe[0]&192)!==128)return se.lastNeed=0,"";if(se.lastNeed>1&&oe.length>1){if((oe[1]&192)!==128)return se.lastNeed=1,"";if(se.lastNeed>2&&oe.length>2&&(oe[2]&192)!==128)return se.lastNeed=2,""}}function B(se){var oe=this.lastTotal-this.lastNeed,ue=I(this,se);if(ue!==void 0)return ue;if(this.lastNeed<=se.length)return se.copy(this.lastChar,oe,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);se.copy(this.lastChar,oe,0,se.length),this.lastNeed-=se.length}function O(se,oe){var ue=A(this,se,oe);if(!this.lastNeed)return se.toString("utf8",oe);this.lastTotal=ue;var we=se.length-(ue-this.lastNeed);return se.copy(this.lastChar,0,we),se.toString("utf8",oe,we)}function N(se){var oe=se&&se.length?this.write(se):"";return this.lastNeed?oe+"":oe}function U(se,oe){if((se.length-oe)%2===0){var ue=se.toString("utf16le",oe);if(ue){var we=ue.charCodeAt(ue.length-1);if(we>=55296&&we<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=se[se.length-2],this.lastChar[1]=se[se.length-1],ue.slice(0,-1)}return ue}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=se[se.length-1],se.toString("utf16le",oe,se.length-1)}function j(se){var oe=se&&se.length?this.write(se):"";if(this.lastNeed){var ue=this.lastTotal-this.lastNeed;return oe+this.lastChar.toString("utf16le",0,ue)}return oe}function z(se,oe){var ue=(se.length-oe)%3;return ue===0?se.toString("base64",oe):(this.lastNeed=3-ue,this.lastTotal=3,ue===1?this.lastChar[0]=se[se.length-1]:(this.lastChar[0]=se[se.length-2],this.lastChar[1]=se[se.length-1]),se.toString("base64",oe,se.length-ue))}function Z(se){var oe=se&&se.length?this.write(se):"";return this.lastNeed?oe+this.lastChar.toString("base64",0,3-this.lastNeed):oe}function X(se){return se.toString(this.encoding)}function Q(se){return se&&se.length?this.write(se):""}return string_decoder$1}var endOfStream,hasRequiredEndOfStream;function requireEndOfStream(){if(hasRequiredEndOfStream)return endOfStream;hasRequiredEndOfStream=1;var n=requireErrorsBrowser().codes.ERR_STREAM_PREMATURE_CLOSE;function r(C){var A=!1;return function(){if(!A){A=!0;for(var I=arguments.length,B=new Array(I),O=0;O<I;O++)B[O]=arguments[O];C.apply(this,B)}}}function _(){}function E(C){return C.setHeader&&typeof C.abort=="function"}function S(C,A,I){if(typeof A=="function")return S(C,null,A);A||(A={}),I=r(I||_);var B=A.readable||A.readable!==!1&&C.readable,O=A.writable||A.writable!==!1&&C.writable,N=function(){C.writable||j()},U=C._writableState&&C._writableState.finished,j=function(){O=!1,U=!0,B||I.call(C)},z=C._readableState&&C._readableState.endEmitted,Z=function(){B=!1,z=!0,O||I.call(C)},X=function(ue){I.call(C,ue)},Q=function(){var ue;if(B&&!z)return(!C._readableState||!C._readableState.ended)&&(ue=new n),I.call(C,ue);if(O&&!U)return(!C._writableState||!C._writableState.ended)&&(ue=new n),I.call(C,ue)},se=function(){C.req.on("finish",j)};return E(C)?(C.on("complete",j),C.on("abort",Q),C.req?se():C.on("request",se)):O&&!C._writableState&&(C.on("end",N),C.on("close",N)),C.on("end",Z),C.on("finish",j),A.error!==!1&&C.on("error",X),C.on("close",Q),function(){C.removeListener("complete",j),C.removeListener("abort",Q),C.removeListener("request",se),C.req&&C.req.removeListener("finish",j),C.removeListener("end",N),C.removeListener("close",N),C.removeListener("finish",j),C.removeListener("end",Z),C.removeListener("error",X),C.removeListener("close",Q)}}return endOfStream=S,endOfStream}var async_iterator,hasRequiredAsync_iterator;function requireAsync_iterator(){if(hasRequiredAsync_iterator)return async_iterator;hasRequiredAsync_iterator=1;var n;function r(ue,we,Te){return we=_(we),we in ue?Object.defineProperty(ue,we,{value:Te,enumerable:!0,configurable:!0,writable:!0}):ue[we]=Te,ue}function _(ue){var we=E(ue,"string");return typeof we=="symbol"?we:String(we)}function E(ue,we){if(typeof ue!="object"||ue===null)return ue;var Te=ue[Symbol.toPrimitive];if(Te!==void 0){var xe=Te.call(ue,we||"default");if(typeof xe!="object")return xe;throw new TypeError("@@toPrimitive must return a primitive value.")}return(we==="string"?String:Number)(ue)}var S=requireEndOfStream(),C=Symbol("lastResolve"),A=Symbol("lastReject"),I=Symbol("error"),B=Symbol("ended"),O=Symbol("lastPromise"),N=Symbol("handlePromise"),U=Symbol("stream");function j(ue,we){return{value:ue,done:we}}function z(ue){var we=ue[C];if(we!==null){var Te=ue[U].read();Te!==null&&(ue[O]=null,ue[C]=null,ue[A]=null,we(j(Te,!1)))}}function Z(ue){browser$1$1.nextTick(z,ue)}function X(ue,we){return function(Te,xe){ue.then(function(){if(we[B]){Te(j(void 0,!0));return}we[N](Te,xe)},xe)}}var Q=Object.getPrototypeOf(function(){}),se=Object.setPrototypeOf((n={get stream(){return this[U]},next:function(){var we=this,Te=this[I];if(Te!==null)return Promise.reject(Te);if(this[B])return Promise.resolve(j(void 0,!0));if(this[U].destroyed)return new Promise(function(Fe,ht){browser$1$1.nextTick(function(){we[I]?ht(we[I]):Fe(j(void 0,!0))})});var xe=this[O],Re;if(xe)Re=new Promise(X(xe,this));else{var Ne=this[U].read();if(Ne!==null)return Promise.resolve(j(Ne,!1));Re=new Promise(this[N])}return this[O]=Re,Re}},r(n,Symbol.asyncIterator,function(){return this}),r(n,"return",function(){var we=this;return new Promise(function(Te,xe){we[U].destroy(null,function(Re){if(Re){xe(Re);return}Te(j(void 0,!0))})})}),n),Q),oe=function(we){var Te,xe=Object.create(se,(Te={},r(Te,U,{value:we,writable:!0}),r(Te,C,{value:null,writable:!0}),r(Te,A,{value:null,writable:!0}),r(Te,I,{value:null,writable:!0}),r(Te,B,{value:we._readableState.endEmitted,writable:!0}),r(Te,N,{value:function(Ne,Fe){var ht=xe[U].read();ht?(xe[O]=null,xe[C]=null,xe[A]=null,Ne(j(ht,!1))):(xe[C]=Ne,xe[A]=Fe)},writable:!0}),Te));return xe[O]=null,S(we,function(Re){if(Re&&Re.code!=="ERR_STREAM_PREMATURE_CLOSE"){var Ne=xe[A];Ne!==null&&(xe[O]=null,xe[C]=null,xe[A]=null,Ne(Re)),xe[I]=Re;return}var Fe=xe[C];Fe!==null&&(xe[O]=null,xe[C]=null,xe[A]=null,Fe(j(void 0,!0))),xe[B]=!0}),we.on("readable",Z.bind(null,xe)),xe};return async_iterator=oe,async_iterator}var fromBrowser,hasRequiredFromBrowser;function requireFromBrowser(){return hasRequiredFromBrowser||(hasRequiredFromBrowser=1,fromBrowser=function(){throw new Error("Readable.from is not available in the browser")}),fromBrowser}var _stream_readable$1,hasRequired_stream_readable$1;function require_stream_readable$1(){if(hasRequired_stream_readable$1)return _stream_readable$1;hasRequired_stream_readable$1=1,_stream_readable$1=Fe;var n;Fe.ReadableState=Ne,eventsExports.EventEmitter;var r=function(ft,Et){return ft.listeners(Et).length},_=requireStreamBrowser$1(),E=buffer$2.Buffer,S=(typeof commonjsGlobal<"u"?commonjsGlobal:typeof window<"u"?window:typeof self<"u"?self:{}).Uint8Array||function(){};function C(bt){return E.from(bt)}function A(bt){return E.isBuffer(bt)||bt instanceof S}var I=require$$1$2,B;I&&I.debuglog?B=I.debuglog("stream"):B=function(){};var O=requireBuffer_list(),N=requireDestroy$1(),U=requireState(),j=U.getHighWaterMark,z=requireErrorsBrowser().codes,Z=z.ERR_INVALID_ARG_TYPE,X=z.ERR_STREAM_PUSH_AFTER_EOF,Q=z.ERR_METHOD_NOT_IMPLEMENTED,se=z.ERR_STREAM_UNSHIFT_AFTER_END_EVENT,oe,ue,we;inherits_browserExports(Fe,_);var Te=N.errorOrDestroy,xe=["error","close","destroy","pause","resume"];function Re(bt,ft,Et){if(typeof bt.prependListener=="function")return bt.prependListener(ft,Et);!bt._events||!bt._events[ft]?bt.on(ft,Et):Array.isArray(bt._events[ft])?bt._events[ft].unshift(Et):bt._events[ft]=[Et,bt._events[ft]]}function Ne(bt,ft,Et){n=n||require_stream_duplex$1(),bt=bt||{},typeof Et!="boolean"&&(Et=ft instanceof n),this.objectMode=!!bt.objectMode,Et&&(this.objectMode=this.objectMode||!!bt.readableObjectMode),this.highWaterMark=j(this,bt,"readableHighWaterMark",Et),this.buffer=new O,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=bt.emitClose!==!1,this.autoDestroy=!!bt.autoDestroy,this.destroyed=!1,this.defaultEncoding=bt.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,bt.encoding&&(oe||(oe=requireString_decoder().StringDecoder),this.decoder=new oe(bt.encoding),this.encoding=bt.encoding)}function Fe(bt){if(n=n||require_stream_duplex$1(),!(this instanceof Fe))return new Fe(bt);var ft=this instanceof n;this._readableState=new Ne(bt,this,ft),this.readable=!0,bt&&(typeof bt.read=="function"&&(this._read=bt.read),typeof bt.destroy=="function"&&(this._destroy=bt.destroy)),_.call(this)}Object.defineProperty(Fe.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState===void 0?!1:this._readableState.destroyed},set:function(ft){this._readableState&&(this._readableState.destroyed=ft)}}),Fe.prototype.destroy=N.destroy,Fe.prototype._undestroy=N.undestroy,Fe.prototype._destroy=function(bt,ft){ft(bt)},Fe.prototype.push=function(bt,ft){var Et=this._readableState,Ye;return Et.objectMode?Ye=!0:typeof bt=="string"&&(ft=ft||Et.defaultEncoding,ft!==Et.encoding&&(bt=E.from(bt,ft),ft=""),Ye=!0),ht(this,bt,ft,!1,Ye)},Fe.prototype.unshift=function(bt){return ht(this,bt,null,!0,!1)};function ht(bt,ft,Et,Ye,Ct){B("readableAddChunk",ft);var Pt=bt._readableState;if(ft===null)Pt.reading=!1,He(bt,Pt);else{var St;if(Ct||(St=Ee(Pt,ft)),St)Te(bt,St);else if(Pt.objectMode||ft&&ft.length>0)if(typeof ft!="string"&&!Pt.objectMode&&Object.getPrototypeOf(ft)!==E.prototype&&(ft=C(ft)),Ye)Pt.endEmitted?Te(bt,new se):nt(bt,Pt,ft,!0);else if(Pt.ended)Te(bt,new X);else{if(Pt.destroyed)return!1;Pt.reading=!1,Pt.decoder&&!Et?(ft=Pt.decoder.write(ft),Pt.objectMode||ft.length!==0?nt(bt,Pt,ft,!1):je(bt,Pt)):nt(bt,Pt,ft,!1)}else Ye||(Pt.reading=!1,je(bt,Pt))}return!Pt.ended&&(Pt.length<Pt.highWaterMark||Pt.length===0)}function nt(bt,ft,Et,Ye){ft.flowing&&ft.length===0&&!ft.sync?(ft.awaitDrain=0,bt.emit("data",Et)):(ft.length+=ft.objectMode?1:Et.length,Ye?ft.buffer.unshift(Et):ft.buffer.push(Et),ft.needReadable&&Be(bt)),je(bt,ft)}function Ee(bt,ft){var Et;return!A(ft)&&typeof ft!="string"&&ft!==void 0&&!bt.objectMode&&(Et=new Z("chunk",["string","Buffer","Uint8Array"],ft)),Et}Fe.prototype.isPaused=function(){return this._readableState.flowing===!1},Fe.prototype.setEncoding=function(bt){oe||(oe=requireString_decoder().StringDecoder);var ft=new oe(bt);this._readableState.decoder=ft,this._readableState.encoding=this._readableState.decoder.encoding;for(var Et=this._readableState.buffer.head,Ye="";Et!==null;)Ye+=ft.write(Et.data),Et=Et.next;return this._readableState.buffer.clear(),Ye!==""&&this._readableState.buffer.push(Ye),this._readableState.length=Ye.length,this};var Ce=1073741824;function _e(bt){return bt>=Ce?bt=Ce:(bt--,bt|=bt>>>1,bt|=bt>>>2,bt|=bt>>>4,bt|=bt>>>8,bt|=bt>>>16,bt++),bt}function Ie(bt,ft){return bt<=0||ft.length===0&&ft.ended?0:ft.objectMode?1:bt!==bt?ft.flowing&&ft.length?ft.buffer.head.data.length:ft.length:(bt>ft.highWaterMark&&(ft.highWaterMark=_e(bt)),bt<=ft.length?bt:ft.ended?ft.length:(ft.needReadable=!0,0))}Fe.prototype.read=function(bt){B("read",bt),bt=parseInt(bt,10);var ft=this._readableState,Et=bt;if(bt!==0&&(ft.emittedReadable=!1),bt===0&&ft.needReadable&&((ft.highWaterMark!==0?ft.length>=ft.highWaterMark:ft.length>0)||ft.ended))return B("read: emitReadable",ft.length,ft.ended),ft.length===0&&ft.ended?dt(this):Be(this),null;if(bt=Ie(bt,ft),bt===0&&ft.ended)return ft.length===0&&dt(this),null;var Ye=ft.needReadable;B("need readable",Ye),(ft.length===0||ft.length-bt<ft.highWaterMark)&&(Ye=!0,B("length less than watermark",Ye)),ft.ended||ft.reading?(Ye=!1,B("reading or ended",Ye)):Ye&&(B("do read"),ft.reading=!0,ft.sync=!0,ft.length===0&&(ft.needReadable=!0),this._read(ft.highWaterMark),ft.sync=!1,ft.reading||(bt=Ie(Et,ft)));var Ct;return bt>0?Ct=Qe(bt,ft):Ct=null,Ct===null?(ft.needReadable=ft.length<=ft.highWaterMark,bt=0):(ft.length-=bt,ft.awaitDrain=0),ft.length===0&&(ft.ended||(ft.needReadable=!0),Et!==bt&&ft.ended&&dt(this)),Ct!==null&&this.emit("data",Ct),Ct};function He(bt,ft){if(B("onEofChunk"),!ft.ended){if(ft.decoder){var Et=ft.decoder.end();Et&&Et.length&&(ft.buffer.push(Et),ft.length+=ft.objectMode?1:Et.length)}ft.ended=!0,ft.sync?Be(bt):(ft.needReadable=!1,ft.emittedReadable||(ft.emittedReadable=!0,Ge(bt)))}}function Be(bt){var ft=bt._readableState;B("emitReadable",ft.needReadable,ft.emittedReadable),ft.needReadable=!1,ft.emittedReadable||(B("emitReadable",ft.flowing),ft.emittedReadable=!0,browser$1$1.nextTick(Ge,bt))}function Ge(bt){var ft=bt._readableState;B("emitReadable_",ft.destroyed,ft.length,ft.ended),!ft.destroyed&&(ft.length||ft.ended)&&(bt.emit("readable"),ft.emittedReadable=!1),ft.needReadable=!ft.flowing&&!ft.ended&&ft.length<=ft.highWaterMark,ct(bt)}function je(bt,ft){ft.readingMore||(ft.readingMore=!0,browser$1$1.nextTick(Ve,bt,ft))}function Ve(bt,ft){for(;!ft.reading&&!ft.ended&&(ft.length<ft.highWaterMark||ft.flowing&&ft.length===0);){var Et=ft.length;if(B("maybeReadMore read 0"),bt.read(0),Et===ft.length)break}ft.readingMore=!1}Fe.prototype._read=function(bt){Te(this,new Q("_read()"))},Fe.prototype.pipe=function(bt,ft){var Et=this,Ye=this._readableState;switch(Ye.pipesCount){case 0:Ye.pipes=bt;break;case 1:Ye.pipes=[Ye.pipes,bt];break;default:Ye.pipes.push(bt);break}Ye.pipesCount+=1,B("pipe count=%d opts=%j",Ye.pipesCount,ft);var Ct=(!ft||ft.end!==!1)&&bt!==browser$1$1.stdout&&bt!==browser$1$1.stderr,Pt=Ct?$t:ur;Ye.endEmitted?browser$1$1.nextTick(Pt):Et.once("end",Pt),bt.on("unpipe",St);function St(xt,pt){B("onunpipe"),xt===Et&&pt&&pt.hasUnpiped===!1&&(pt.hasUnpiped=!0,qt())}function $t(){B("onend"),bt.end()}var kt=Pe(Et);bt.on("drain",kt);var Ft=!1;function qt(){B("cleanup"),bt.removeListener("close",Zt),bt.removeListener("finish",Yt),bt.removeListener("drain",kt),bt.removeListener("error",Wt),bt.removeListener("unpipe",St),Et.removeListener("end",$t),Et.removeListener("end",ur),Et.removeListener("data",Mt),Ft=!0,Ye.awaitDrain&&(!bt._writableState||bt._writableState.needDrain)&&kt()}Et.on("data",Mt);function Mt(xt){B("ondata");var pt=bt.write(xt);B("dest.write",pt),pt===!1&&((Ye.pipesCount===1&&Ye.pipes===bt||Ye.pipesCount>1&&At(Ye.pipes,bt)!==-1)&&!Ft&&(B("false write response, pause",Ye.awaitDrain),Ye.awaitDrain++),Et.pause())}function Wt(xt){B("onerror",xt),ur(),bt.removeListener("error",Wt),r(bt,"error")===0&&Te(bt,xt)}Re(bt,"error",Wt);function Zt(){bt.removeListener("finish",Yt),ur()}bt.once("close",Zt);function Yt(){B("onfinish"),bt.removeListener("close",Zt),ur()}bt.once("finish",Yt);function ur(){B("unpipe"),Et.unpipe(bt)}return bt.emit("pipe",Et),Ye.flowing||(B("pipe resume"),Et.resume()),bt};function Pe(bt){return function(){var Et=bt._readableState;B("pipeOnDrain",Et.awaitDrain),Et.awaitDrain&&Et.awaitDrain--,Et.awaitDrain===0&&r(bt,"data")&&(Et.flowing=!0,ct(bt))}}Fe.prototype.unpipe=function(bt){var ft=this._readableState,Et={hasUnpiped:!1};if(ft.pipesCount===0)return this;if(ft.pipesCount===1)return bt&&bt!==ft.pipes?this:(bt||(bt=ft.pipes),ft.pipes=null,ft.pipesCount=0,ft.flowing=!1,bt&&bt.emit("unpipe",this,Et),this);if(!bt){var Ye=ft.pipes,Ct=ft.pipesCount;ft.pipes=null,ft.pipesCount=0,ft.flowing=!1;for(var Pt=0;Pt<Ct;Pt++)Ye[Pt].emit("unpipe",this,{hasUnpiped:!1});return this}var St=At(ft.pipes,bt);return St===-1?this:(ft.pipes.splice(St,1),ft.pipesCount-=1,ft.pipesCount===1&&(ft.pipes=ft.pipes[0]),bt.emit("unpipe",this,Et),this)},Fe.prototype.on=function(bt,ft){var Et=_.prototype.on.call(this,bt,ft),Ye=this._readableState;return bt==="data"?(Ye.readableListening=this.listenerCount("readable")>0,Ye.flowing!==!1&&this.resume()):bt==="readable"&&!Ye.endEmitted&&!Ye.readableListening&&(Ye.readableListening=Ye.needReadable=!0,Ye.flowing=!1,Ye.emittedReadable=!1,B("on readable",Ye.length,Ye.reading),Ye.length?Be(this):Ye.reading||browser$1$1.nextTick(tt,this)),Et},Fe.prototype.addListener=Fe.prototype.on,Fe.prototype.removeListener=function(bt,ft){var Et=_.prototype.removeListener.call(this,bt,ft);return bt==="readable"&&browser$1$1.nextTick(Me,this),Et},Fe.prototype.removeAllListeners=function(bt){var ft=_.prototype.removeAllListeners.apply(this,arguments);return(bt==="readable"||bt===void 0)&&browser$1$1.nextTick(Me,this),ft};function Me(bt){var ft=bt._readableState;ft.readableListening=bt.listenerCount("readable")>0,ft.resumeScheduled&&!ft.paused?ft.flowing=!0:bt.listenerCount("data")>0&&bt.resume()}function tt(bt){B("readable nexttick read 0"),bt.read(0)}Fe.prototype.resume=function(){var bt=this._readableState;return bt.flowing||(B("resume"),bt.flowing=!bt.readableListening,Ke(this,bt)),bt.paused=!1,this};function Ke(bt,ft){ft.resumeScheduled||(ft.resumeScheduled=!0,browser$1$1.nextTick(mt,bt,ft))}function mt(bt,ft){B("resume",ft.reading),ft.reading||bt.read(0),ft.resumeScheduled=!1,bt.emit("resume"),ct(bt),ft.flowing&&!ft.reading&&bt.read(0)}Fe.prototype.pause=function(){return B("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&(B("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this};function ct(bt){var ft=bt._readableState;for(B("flow",ft.flowing);ft.flowing&&bt.read()!==null;);}Fe.prototype.wrap=function(bt){var ft=this,Et=this._readableState,Ye=!1;bt.on("end",function(){if(B("wrapped end"),Et.decoder&&!Et.ended){var St=Et.decoder.end();St&&St.length&&ft.push(St)}ft.push(null)}),bt.on("data",function(St){if(B("wrapped data"),Et.decoder&&(St=Et.decoder.write(St)),!(Et.objectMode&&St==null)&&!(!Et.objectMode&&(!St||!St.length))){var $t=ft.push(St);$t||(Ye=!0,bt.pause())}});for(var Ct in bt)this[Ct]===void 0&&typeof bt[Ct]=="function"&&(this[Ct]=function($t){return function(){return bt[$t].apply(bt,arguments)}}(Ct));for(var Pt=0;Pt<xe.length;Pt++)bt.on(xe[Pt],this.emit.bind(this,xe[Pt]));return this._read=function(St){B("wrapped _read",St),Ye&&(Ye=!1,bt.resume())},this},typeof Symbol=="function"&&(Fe.prototype[Symbol.asyncIterator]=function(){return ue===void 0&&(ue=requireAsync_iterator()),ue(this)}),Object.defineProperty(Fe.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),Object.defineProperty(Fe.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}}),Object.defineProperty(Fe.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(ft){this._readableState&&(this._readableState.flowing=ft)}}),Fe._fromList=Qe,Object.defineProperty(Fe.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}});function Qe(bt,ft){if(ft.length===0)return null;var Et;return ft.objectMode?Et=ft.buffer.shift():!bt||bt>=ft.length?(ft.decoder?Et=ft.buffer.join(""):ft.buffer.length===1?Et=ft.buffer.first():Et=ft.buffer.concat(ft.length),ft.buffer.clear()):Et=ft.buffer.consume(bt,ft.decoder),Et}function dt(bt){var ft=bt._readableState;B("endReadable",ft.endEmitted),ft.endEmitted||(ft.ended=!0,browser$1$1.nextTick(vt,ft,bt))}function vt(bt,ft){if(B("endReadableNT",bt.endEmitted,bt.length),!bt.endEmitted&&bt.length===0&&(bt.endEmitted=!0,ft.readable=!1,ft.emit("end"),bt.autoDestroy)){var Et=ft._writableState;(!Et||Et.autoDestroy&&Et.finished)&&ft.destroy()}}typeof Symbol=="function"&&(Fe.from=function(bt,ft){return we===void 0&&(we=requireFromBrowser()),we(Fe,bt,ft)});function At(bt,ft){for(var Et=0,Ye=bt.length;Et<Ye;Et++)if(bt[Et]===ft)return Et;return-1}return _stream_readable$1}var _stream_transform$1,hasRequired_stream_transform$1;function require_stream_transform$1(){if(hasRequired_stream_transform$1)return _stream_transform$1;hasRequired_stream_transform$1=1,_stream_transform$1=I;var n=requireErrorsBrowser().codes,r=n.ERR_METHOD_NOT_IMPLEMENTED,_=n.ERR_MULTIPLE_CALLBACK,E=n.ERR_TRANSFORM_ALREADY_TRANSFORMING,S=n.ERR_TRANSFORM_WITH_LENGTH_0,C=require_stream_duplex$1();inherits_browserExports(I,C);function A(N,U){var j=this._transformState;j.transforming=!1;var z=j.writecb;if(z===null)return this.emit("error",new _);j.writechunk=null,j.writecb=null,U!=null&&this.push(U),z(N);var Z=this._readableState;Z.reading=!1,(Z.needReadable||Z.length<Z.highWaterMark)&&this._read(Z.highWaterMark)}function I(N){if(!(this instanceof I))return new I(N);C.call(this,N),this._transformState={afterTransform:A.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,N&&(typeof N.transform=="function"&&(this._transform=N.transform),typeof N.flush=="function"&&(this._flush=N.flush)),this.on("prefinish",B)}function B(){var N=this;typeof this._flush=="function"&&!this._readableState.destroyed?this._flush(function(U,j){O(N,U,j)}):O(this,null,null)}I.prototype.push=function(N,U){return this._transformState.needTransform=!1,C.prototype.push.call(this,N,U)},I.prototype._transform=function(N,U,j){j(new r("_transform()"))},I.prototype._write=function(N,U,j){var z=this._transformState;if(z.writecb=j,z.writechunk=N,z.writeencoding=U,!z.transforming){var Z=this._readableState;(z.needTransform||Z.needReadable||Z.length<Z.highWaterMark)&&this._read(Z.highWaterMark)}},I.prototype._read=function(N){var U=this._transformState;U.writechunk!==null&&!U.transforming?(U.transforming=!0,this._transform(U.writechunk,U.writeencoding,U.afterTransform)):U.needTransform=!0},I.prototype._destroy=function(N,U){C.prototype._destroy.call(this,N,function(j){U(j)})};function O(N,U,j){if(U)return N.emit("error",U);if(j!=null&&N.push(j),N._writableState.length)throw new S;if(N._transformState.transforming)throw new E;return N.push(null)}return _stream_transform$1}var _stream_passthrough$1,hasRequired_stream_passthrough$1;function require_stream_passthrough$1(){if(hasRequired_stream_passthrough$1)return _stream_passthrough$1;hasRequired_stream_passthrough$1=1,_stream_passthrough$1=r;var n=require_stream_transform$1();inherits_browserExports(r,n);function r(_){if(!(this instanceof r))return new r(_);n.call(this,_)}return r.prototype._transform=function(_,E,S){S(null,_)},_stream_passthrough$1}var pipeline_1,hasRequiredPipeline;function requirePipeline(){if(hasRequiredPipeline)return pipeline_1;hasRequiredPipeline=1;var n;function r(j){var z=!1;return function(){z||(z=!0,j.apply(void 0,arguments))}}var _=requireErrorsBrowser().codes,E=_.ERR_MISSING_ARGS,S=_.ERR_STREAM_DESTROYED;function C(j){if(j)throw j}function A(j){return j.setHeader&&typeof j.abort=="function"}function I(j,z,Z,X){X=r(X);var Q=!1;j.on("close",function(){Q=!0}),n===void 0&&(n=requireEndOfStream()),n(j,{readable:z,writable:Z},function(oe){if(oe)return X(oe);Q=!0,X()});var se=!1;return function(oe){if(!Q&&!se){if(se=!0,A(j))return j.abort();if(typeof j.destroy=="function")return j.destroy();X(oe||new S("pipe"))}}}function B(j){j()}function O(j,z){return j.pipe(z)}function N(j){return!j.length||typeof j[j.length-1]!="function"?C:j.pop()}function U(){for(var j=arguments.length,z=new Array(j),Z=0;Z<j;Z++)z[Z]=arguments[Z];var X=N(z);if(Array.isArray(z[0])&&(z=z[0]),z.length<2)throw new E("streams");var Q,se=z.map(function(oe,ue){var we=ue<z.length-1,Te=ue>0;return I(oe,we,Te,function(xe){Q||(Q=xe),xe&&se.forEach(B),!we&&(se.forEach(B),X(Q))})});return z.reduce(O)}return pipeline_1=U,pipeline_1}var hasRequiredReadableBrowser$1;function requireReadableBrowser$1(){return hasRequiredReadableBrowser$1||(hasRequiredReadableBrowser$1=1,function(n,r){r=n.exports=require_stream_readable$1(),r.Stream=r,r.Readable=r,r.Writable=require_stream_writable$1(),r.Duplex=require_stream_duplex$1(),r.Transform=require_stream_transform$1(),r.PassThrough=require_stream_passthrough$1(),r.finished=requireEndOfStream(),r.pipeline=requirePipeline()}(readableBrowser$1,readableBrowser$1.exports)),readableBrowser$1.exports}var hashBase,hasRequiredHashBase;function requireHashBase(){if(hasRequiredHashBase)return hashBase;hasRequiredHashBase=1;var n=requireSafeBuffer().Buffer,r=requireReadableBrowser$1().Transform,_=inherits_browserExports;function E(C,A){if(!n.isBuffer(C)&&typeof C!="string")throw new TypeError(A+" must be a string or a buffer")}function S(C){r.call(this),this._block=n.allocUnsafe(C),this._blockSize=C,this._blockOffset=0,this._length=[0,0,0,0],this._finalized=!1}return _(S,r),S.prototype._transform=function(C,A,I){var B=null;try{this.update(C,A)}catch(O){B=O}I(B)},S.prototype._flush=function(C){var A=null;try{this.push(this.digest())}catch(I){A=I}C(A)},S.prototype.update=function(C,A){if(E(C,"Data"),this._finalized)throw new Error("Digest already called");n.isBuffer(C)||(C=n.from(C,A));for(var I=this._block,B=0;this._blockOffset+C.length-B>=this._blockSize;){for(var O=this._blockOffset;O<this._blockSize;)I[O++]=C[B++];this._update(),this._blockOffset=0}for(;B<C.length;)I[this._blockOffset++]=C[B++];for(var N=0,U=C.length*8;U>0;++N)this._length[N]+=U,U=this._length[N]/4294967296|0,U>0&&(this._length[N]-=4294967296*U);return this},S.prototype._update=function(){throw new Error("_update is not implemented")},S.prototype.digest=function(C){if(this._finalized)throw new Error("Digest already called");this._finalized=!0;var A=this._digest();C!==void 0&&(A=A.toString(C)),this._block.fill(0),this._blockOffset=0;for(var I=0;I<4;++I)this._length[I]=0;return A},S.prototype._digest=function(){throw new Error("_digest is not implemented")},hashBase=S,hashBase}var md5_js,hasRequiredMd5_js;function requireMd5_js(){if(hasRequiredMd5_js)return md5_js;hasRequiredMd5_js=1;var n=inherits_browserExports,r=requireHashBase(),_=requireSafeBuffer().Buffer,E=new Array(16);function S(){r.call(this,64),this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878}n(S,r),S.prototype._update=function(){for(var N=E,U=0;U<16;++U)N[U]=this._block.readInt32LE(U*4);var j=this._a,z=this._b,Z=this._c,X=this._d;j=A(j,z,Z,X,N[0],3614090360,7),X=A(X,j,z,Z,N[1],3905402710,12),Z=A(Z,X,j,z,N[2],606105819,17),z=A(z,Z,X,j,N[3],3250441966,22),j=A(j,z,Z,X,N[4],4118548399,7),X=A(X,j,z,Z,N[5],1200080426,12),Z=A(Z,X,j,z,N[6],2821735955,17),z=A(z,Z,X,j,N[7],4249261313,22),j=A(j,z,Z,X,N[8],1770035416,7),X=A(X,j,z,Z,N[9],2336552879,12),Z=A(Z,X,j,z,N[10],4294925233,17),z=A(z,Z,X,j,N[11],2304563134,22),j=A(j,z,Z,X,N[12],1804603682,7),X=A(X,j,z,Z,N[13],4254626195,12),Z=A(Z,X,j,z,N[14],2792965006,17),z=A(z,Z,X,j,N[15],1236535329,22),j=I(j,z,Z,X,N[1],4129170786,5),X=I(X,j,z,Z,N[6],3225465664,9),Z=I(Z,X,j,z,N[11],643717713,14),z=I(z,Z,X,j,N[0],3921069994,20),j=I(j,z,Z,X,N[5],3593408605,5),X=I(X,j,z,Z,N[10],38016083,9),Z=I(Z,X,j,z,N[15],3634488961,14),z=I(z,Z,X,j,N[4],3889429448,20),j=I(j,z,Z,X,N[9],568446438,5),X=I(X,j,z,Z,N[14],3275163606,9),Z=I(Z,X,j,z,N[3],4107603335,14),z=I(z,Z,X,j,N[8],1163531501,20),j=I(j,z,Z,X,N[13],2850285829,5),X=I(X,j,z,Z,N[2],4243563512,9),Z=I(Z,X,j,z,N[7],1735328473,14),z=I(z,Z,X,j,N[12],2368359562,20),j=B(j,z,Z,X,N[5],4294588738,4),X=B(X,j,z,Z,N[8],2272392833,11),Z=B(Z,X,j,z,N[11],1839030562,16),z=B(z,Z,X,j,N[14],4259657740,23),j=B(j,z,Z,X,N[1],2763975236,4),X=B(X,j,z,Z,N[4],1272893353,11),Z=B(Z,X,j,z,N[7],4139469664,16),z=B(z,Z,X,j,N[10],3200236656,23),j=B(j,z,Z,X,N[13],681279174,4),X=B(X,j,z,Z,N[0],3936430074,11),Z=B(Z,X,j,z,N[3],3572445317,16),z=B(z,Z,X,j,N[6],76029189,23),j=B(j,z,Z,X,N[9],3654602809,4),X=B(X,j,z,Z,N[12],3873151461,11),Z=B(Z,X,j,z,N[15],530742520,16),z=B(z,Z,X,j,N[2],3299628645,23),j=O(j,z,Z,X,N[0],4096336452,6),X=O(X,j,z,Z,N[7],1126891415,10),Z=O(Z,X,j,z,N[14],2878612391,15),z=O(z,Z,X,j,N[5],4237533241,21),j=O(j,z,Z,X,N[12],1700485571,6),X=O(X,j,z,Z,N[3],2399980690,10),Z=O(Z,X,j,z,N[10],4293915773,15),z=O(z,Z,X,j,N[1],2240044497,21),j=O(j,z,Z,X,N[8],1873313359,6),X=O(X,j,z,Z,N[15],4264355552,10),Z=O(Z,X,j,z,N[6],2734768916,15),z=O(z,Z,X,j,N[13],1309151649,21),j=O(j,z,Z,X,N[4],4149444226,6),X=O(X,j,z,Z,N[11],3174756917,10),Z=O(Z,X,j,z,N[2],718787259,15),z=O(z,Z,X,j,N[9],3951481745,21),this._a=this._a+j|0,this._b=this._b+z|0,this._c=this._c+Z|0,this._d=this._d+X|0},S.prototype._digest=function(){this._block[this._blockOffset++]=128,this._blockOffset>56&&(this._block.fill(0,this._blockOffset,64),this._update(),this._blockOffset=0),this._block.fill(0,this._blockOffset,56),this._block.writeUInt32LE(this._length[0],56),this._block.writeUInt32LE(this._length[1],60),this._update();var N=_.allocUnsafe(16);return N.writeInt32LE(this._a,0),N.writeInt32LE(this._b,4),N.writeInt32LE(this._c,8),N.writeInt32LE(this._d,12),N};function C(N,U){return N<<U|N>>>32-U}function A(N,U,j,z,Z,X,Q){return C(N+(U&j|~U&z)+Z+X|0,Q)+U|0}function I(N,U,j,z,Z,X,Q){return C(N+(U&z|j&~z)+Z+X|0,Q)+U|0}function B(N,U,j,z,Z,X,Q){return C(N+(U^j^z)+Z+X|0,Q)+U|0}function O(N,U,j,z,Z,X,Q){return C(N+(j^(U|~z))+Z+X|0,Q)+U|0}return md5_js=S,md5_js}var ripemd160,hasRequiredRipemd160;function requireRipemd160(){if(hasRequiredRipemd160)return ripemd160;hasRequiredRipemd160=1;var n=buffer$2.Buffer,r=inherits_browserExports,_=requireHashBase(),E=new Array(16),S=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13],C=[5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11],A=[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6],I=[8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11],B=[0,1518500249,1859775393,2400959708,2840853838],O=[1352829926,1548603684,1836072691,2053994217,0];function N(){_.call(this,64),this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878,this._e=3285377520}r(N,_),N.prototype._update=function(){for(var se=E,oe=0;oe<16;++oe)se[oe]=this._block.readInt32LE(oe*4);for(var ue=this._a|0,we=this._b|0,Te=this._c|0,xe=this._d|0,Re=this._e|0,Ne=this._a|0,Fe=this._b|0,ht=this._c|0,nt=this._d|0,Ee=this._e|0,Ce=0;Ce<80;Ce+=1){var _e,Ie;Ce<16?(_e=j(ue,we,Te,xe,Re,se[S[Ce]],B[0],A[Ce]),Ie=Q(Ne,Fe,ht,nt,Ee,se[C[Ce]],O[0],I[Ce])):Ce<32?(_e=z(ue,we,Te,xe,Re,se[S[Ce]],B[1],A[Ce]),Ie=X(Ne,Fe,ht,nt,Ee,se[C[Ce]],O[1],I[Ce])):Ce<48?(_e=Z(ue,we,Te,xe,Re,se[S[Ce]],B[2],A[Ce]),Ie=Z(Ne,Fe,ht,nt,Ee,se[C[Ce]],O[2],I[Ce])):Ce<64?(_e=X(ue,we,Te,xe,Re,se[S[Ce]],B[3],A[Ce]),Ie=z(Ne,Fe,ht,nt,Ee,se[C[Ce]],O[3],I[Ce])):(_e=Q(ue,we,Te,xe,Re,se[S[Ce]],B[4],A[Ce]),Ie=j(Ne,Fe,ht,nt,Ee,se[C[Ce]],O[4],I[Ce])),ue=Re,Re=xe,xe=U(Te,10),Te=we,we=_e,Ne=Ee,Ee=nt,nt=U(ht,10),ht=Fe,Fe=Ie}var He=this._b+Te+nt|0;this._b=this._c+xe+Ee|0,this._c=this._d+Re+Ne|0,this._d=this._e+ue+Fe|0,this._e=this._a+we+ht|0,this._a=He},N.prototype._digest=function(){this._block[this._blockOffset++]=128,this._blockOffset>56&&(this._block.fill(0,this._blockOffset,64),this._update(),this._blockOffset=0),this._block.fill(0,this._blockOffset,56),this._block.writeUInt32LE(this._length[0],56),this._block.writeUInt32LE(this._length[1],60),this._update();var se=n.alloc?n.alloc(20):new n(20);return se.writeInt32LE(this._a,0),se.writeInt32LE(this._b,4),se.writeInt32LE(this._c,8),se.writeInt32LE(this._d,12),se.writeInt32LE(this._e,16),se};function U(se,oe){return se<<oe|se>>>32-oe}function j(se,oe,ue,we,Te,xe,Re,Ne){return U(se+(oe^ue^we)+xe+Re|0,Ne)+Te|0}function z(se,oe,ue,we,Te,xe,Re,Ne){return U(se+(oe&ue|~oe&we)+xe+Re|0,Ne)+Te|0}function Z(se,oe,ue,we,Te,xe,Re,Ne){return U(se+((oe|~ue)^we)+xe+Re|0,Ne)+Te|0}function X(se,oe,ue,we,Te,xe,Re,Ne){return U(se+(oe&we|ue&~we)+xe+Re|0,Ne)+Te|0}function Q(se,oe,ue,we,Te,xe,Re,Ne){return U(se+(oe^(ue|~we))+xe+Re|0,Ne)+Te|0}return ripemd160=N,ripemd160}var sha_js={exports:{}},hash$3,hasRequiredHash$1;function requireHash$1(){if(hasRequiredHash$1)return hash$3;hasRequiredHash$1=1;var n=requireSafeBuffer().Buffer;function r(_,E){this._block=n.alloc(_),this._finalSize=E,this._blockSize=_,this._len=0}return r.prototype.update=function(_,E){typeof _=="string"&&(E=E||"utf8",_=n.from(_,E));for(var S=this._block,C=this._blockSize,A=_.length,I=this._len,B=0;B<A;){for(var O=I%C,N=Math.min(A-B,C-O),U=0;U<N;U++)S[O+U]=_[B+U];I+=N,B+=N,I%C===0&&this._update(S)}return this._len+=A,this},r.prototype.digest=function(_){var E=this._len%this._blockSize;this._block[E]=128,this._block.fill(0,E+1),E>=this._finalSize&&(this._update(this._block),this._block.fill(0));var S=this._len*8;if(S<=4294967295)this._block.writeUInt32BE(S,this._blockSize-4);else{var C=(S&4294967295)>>>0,A=(S-C)/4294967296;this._block.writeUInt32BE(A,this._blockSize-8),this._block.writeUInt32BE(C,this._blockSize-4)}this._update(this._block);var I=this._hash();return _?I.toString(_):I},r.prototype._update=function(){throw new Error("_update must be implemented by subclass")},hash$3=r,hash$3}var sha$1,hasRequiredSha$1;function requireSha$1(){if(hasRequiredSha$1)return sha$1;hasRequiredSha$1=1;var n=inherits_browserExports,r=requireHash$1(),_=requireSafeBuffer().Buffer,E=[1518500249,1859775393,-1894007588,-899497514],S=new Array(80);function C(){this.init(),this._w=S,r.call(this,64,56)}n(C,r),C.prototype.init=function(){return this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878,this._e=3285377520,this};function A(O){return O<<5|O>>>27}function I(O){return O<<30|O>>>2}function B(O,N,U,j){return O===0?N&U|~N&j:O===2?N&U|N&j|U&j:N^U^j}return C.prototype._update=function(O){for(var N=this._w,U=this._a|0,j=this._b|0,z=this._c|0,Z=this._d|0,X=this._e|0,Q=0;Q<16;++Q)N[Q]=O.readInt32BE(Q*4);for(;Q<80;++Q)N[Q]=N[Q-3]^N[Q-8]^N[Q-14]^N[Q-16];for(var se=0;se<80;++se){var oe=~~(se/20),ue=A(U)+B(oe,j,z,Z)+X+N[se]+E[oe]|0;X=Z,Z=z,z=I(j),j=U,U=ue}this._a=U+this._a|0,this._b=j+this._b|0,this._c=z+this._c|0,this._d=Z+this._d|0,this._e=X+this._e|0},C.prototype._hash=function(){var O=_.allocUnsafe(20);return O.writeInt32BE(this._a|0,0),O.writeInt32BE(this._b|0,4),O.writeInt32BE(this._c|0,8),O.writeInt32BE(this._d|0,12),O.writeInt32BE(this._e|0,16),O},sha$1=C,sha$1}var sha1$2,hasRequiredSha1;function requireSha1(){if(hasRequiredSha1)return sha1$2;hasRequiredSha1=1;var n=inherits_browserExports,r=requireHash$1(),_=requireSafeBuffer().Buffer,E=[1518500249,1859775393,-1894007588,-899497514],S=new Array(80);function C(){this.init(),this._w=S,r.call(this,64,56)}n(C,r),C.prototype.init=function(){return this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878,this._e=3285377520,this};function A(N){return N<<1|N>>>31}function I(N){return N<<5|N>>>27}function B(N){return N<<30|N>>>2}function O(N,U,j,z){return N===0?U&j|~U&z:N===2?U&j|U&z|j&z:U^j^z}return C.prototype._update=function(N){for(var U=this._w,j=this._a|0,z=this._b|0,Z=this._c|0,X=this._d|0,Q=this._e|0,se=0;se<16;++se)U[se]=N.readInt32BE(se*4);for(;se<80;++se)U[se]=A(U[se-3]^U[se-8]^U[se-14]^U[se-16]);for(var oe=0;oe<80;++oe){var ue=~~(oe/20),we=I(j)+O(ue,z,Z,X)+Q+U[oe]+E[ue]|0;Q=X,X=Z,Z=B(z),z=j,j=we}this._a=j+this._a|0,this._b=z+this._b|0,this._c=Z+this._c|0,this._d=X+this._d|0,this._e=Q+this._e|0},C.prototype._hash=function(){var N=_.allocUnsafe(20);return N.writeInt32BE(this._a|0,0),N.writeInt32BE(this._b|0,4),N.writeInt32BE(this._c|0,8),N.writeInt32BE(this._d|0,12),N.writeInt32BE(this._e|0,16),N},sha1$2=C,sha1$2}var sha256$5,hasRequiredSha256;function requireSha256(){if(hasRequiredSha256)return sha256$5;hasRequiredSha256=1;var n=inherits_browserExports,r=requireHash$1(),_=requireSafeBuffer().Buffer,E=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],S=new Array(64);function C(){this.init(),this._w=S,r.call(this,64,56)}n(C,r),C.prototype.init=function(){return this._a=1779033703,this._b=3144134277,this._c=1013904242,this._d=2773480762,this._e=1359893119,this._f=2600822924,this._g=528734635,this._h=1541459225,this};function A(j,z,Z){return Z^j&(z^Z)}function I(j,z,Z){return j&z|Z&(j|z)}function B(j){return(j>>>2|j<<30)^(j>>>13|j<<19)^(j>>>22|j<<10)}function O(j){return(j>>>6|j<<26)^(j>>>11|j<<21)^(j>>>25|j<<7)}function N(j){return(j>>>7|j<<25)^(j>>>18|j<<14)^j>>>3}function U(j){return(j>>>17|j<<15)^(j>>>19|j<<13)^j>>>10}return C.prototype._update=function(j){for(var z=this._w,Z=this._a|0,X=this._b|0,Q=this._c|0,se=this._d|0,oe=this._e|0,ue=this._f|0,we=this._g|0,Te=this._h|0,xe=0;xe<16;++xe)z[xe]=j.readInt32BE(xe*4);for(;xe<64;++xe)z[xe]=U(z[xe-2])+z[xe-7]+N(z[xe-15])+z[xe-16]|0;for(var Re=0;Re<64;++Re){var Ne=Te+O(oe)+A(oe,ue,we)+E[Re]+z[Re]|0,Fe=B(Z)+I(Z,X,Q)|0;Te=we,we=ue,ue=oe,oe=se+Ne|0,se=Q,Q=X,X=Z,Z=Ne+Fe|0}this._a=Z+this._a|0,this._b=X+this._b|0,this._c=Q+this._c|0,this._d=se+this._d|0,this._e=oe+this._e|0,this._f=ue+this._f|0,this._g=we+this._g|0,this._h=Te+this._h|0},C.prototype._hash=function(){var j=_.allocUnsafe(32);return j.writeInt32BE(this._a,0),j.writeInt32BE(this._b,4),j.writeInt32BE(this._c,8),j.writeInt32BE(this._d,12),j.writeInt32BE(this._e,16),j.writeInt32BE(this._f,20),j.writeInt32BE(this._g,24),j.writeInt32BE(this._h,28),j},sha256$5=C,sha256$5}var sha224$1,hasRequiredSha224;function requireSha224(){if(hasRequiredSha224)return sha224$1;hasRequiredSha224=1;var n=inherits_browserExports,r=requireSha256(),_=requireHash$1(),E=requireSafeBuffer().Buffer,S=new Array(64);function C(){this.init(),this._w=S,_.call(this,64,56)}return n(C,r),C.prototype.init=function(){return this._a=3238371032,this._b=914150663,this._c=812702999,this._d=4144912697,this._e=4290775857,this._f=1750603025,this._g=1694076839,this._h=3204075428,this},C.prototype._hash=function(){var A=E.allocUnsafe(28);return A.writeInt32BE(this._a,0),A.writeInt32BE(this._b,4),A.writeInt32BE(this._c,8),A.writeInt32BE(this._d,12),A.writeInt32BE(this._e,16),A.writeInt32BE(this._f,20),A.writeInt32BE(this._g,24),A},sha224$1=C,sha224$1}var sha512$3,hasRequiredSha512;function requireSha512(){if(hasRequiredSha512)return sha512$3;hasRequiredSha512=1;var n=inherits_browserExports,r=requireHash$1(),_=requireSafeBuffer().Buffer,E=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591],S=new Array(160);function C(){this.init(),this._w=S,r.call(this,128,112)}n(C,r),C.prototype.init=function(){return this._ah=1779033703,this._bh=3144134277,this._ch=1013904242,this._dh=2773480762,this._eh=1359893119,this._fh=2600822924,this._gh=528734635,this._hh=1541459225,this._al=4089235720,this._bl=2227873595,this._cl=4271175723,this._dl=1595750129,this._el=2917565137,this._fl=725511199,this._gl=4215389547,this._hl=327033209,this};function A(X,Q,se){return se^X&(Q^se)}function I(X,Q,se){return X&Q|se&(X|Q)}function B(X,Q){return(X>>>28|Q<<4)^(Q>>>2|X<<30)^(Q>>>7|X<<25)}function O(X,Q){return(X>>>14|Q<<18)^(X>>>18|Q<<14)^(Q>>>9|X<<23)}function N(X,Q){return(X>>>1|Q<<31)^(X>>>8|Q<<24)^X>>>7}function U(X,Q){return(X>>>1|Q<<31)^(X>>>8|Q<<24)^(X>>>7|Q<<25)}function j(X,Q){return(X>>>19|Q<<13)^(Q>>>29|X<<3)^X>>>6}function z(X,Q){return(X>>>19|Q<<13)^(Q>>>29|X<<3)^(X>>>6|Q<<26)}function Z(X,Q){return X>>>0<Q>>>0?1:0}return C.prototype._update=function(X){for(var Q=this._w,se=this._ah|0,oe=this._bh|0,ue=this._ch|0,we=this._dh|0,Te=this._eh|0,xe=this._fh|0,Re=this._gh|0,Ne=this._hh|0,Fe=this._al|0,ht=this._bl|0,nt=this._cl|0,Ee=this._dl|0,Ce=this._el|0,_e=this._fl|0,Ie=this._gl|0,He=this._hl|0,Be=0;Be<32;Be+=2)Q[Be]=X.readInt32BE(Be*4),Q[Be+1]=X.readInt32BE(Be*4+4);for(;Be<160;Be+=2){var Ge=Q[Be-30],je=Q[Be-15*2+1],Ve=N(Ge,je),Pe=U(je,Ge);Ge=Q[Be-2*2],je=Q[Be-2*2+1];var Me=j(Ge,je),tt=z(je,Ge),Ke=Q[Be-7*2],mt=Q[Be-7*2+1],ct=Q[Be-16*2],Qe=Q[Be-16*2+1],dt=Pe+mt|0,vt=Ve+Ke+Z(dt,Pe)|0;dt=dt+tt|0,vt=vt+Me+Z(dt,tt)|0,dt=dt+Qe|0,vt=vt+ct+Z(dt,Qe)|0,Q[Be]=vt,Q[Be+1]=dt}for(var At=0;At<160;At+=2){vt=Q[At],dt=Q[At+1];var bt=I(se,oe,ue),ft=I(Fe,ht,nt),Et=B(se,Fe),Ye=B(Fe,se),Ct=O(Te,Ce),Pt=O(Ce,Te),St=E[At],$t=E[At+1],kt=A(Te,xe,Re),Ft=A(Ce,_e,Ie),qt=He+Pt|0,Mt=Ne+Ct+Z(qt,He)|0;qt=qt+Ft|0,Mt=Mt+kt+Z(qt,Ft)|0,qt=qt+$t|0,Mt=Mt+St+Z(qt,$t)|0,qt=qt+dt|0,Mt=Mt+vt+Z(qt,dt)|0;var Wt=Ye+ft|0,Zt=Et+bt+Z(Wt,Ye)|0;Ne=Re,He=Ie,Re=xe,Ie=_e,xe=Te,_e=Ce,Ce=Ee+qt|0,Te=we+Mt+Z(Ce,Ee)|0,we=ue,Ee=nt,ue=oe,nt=ht,oe=se,ht=Fe,Fe=qt+Wt|0,se=Mt+Zt+Z(Fe,qt)|0}this._al=this._al+Fe|0,this._bl=this._bl+ht|0,this._cl=this._cl+nt|0,this._dl=this._dl+Ee|0,this._el=this._el+Ce|0,this._fl=this._fl+_e|0,this._gl=this._gl+Ie|0,this._hl=this._hl+He|0,this._ah=this._ah+se+Z(this._al,Fe)|0,this._bh=this._bh+oe+Z(this._bl,ht)|0,this._ch=this._ch+ue+Z(this._cl,nt)|0,this._dh=this._dh+we+Z(this._dl,Ee)|0,this._eh=this._eh+Te+Z(this._el,Ce)|0,this._fh=this._fh+xe+Z(this._fl,_e)|0,this._gh=this._gh+Re+Z(this._gl,Ie)|0,this._hh=this._hh+Ne+Z(this._hl,He)|0},C.prototype._hash=function(){var X=_.allocUnsafe(64);function Q(se,oe,ue){X.writeInt32BE(se,ue),X.writeInt32BE(oe,ue+4)}return Q(this._ah,this._al,0),Q(this._bh,this._bl,8),Q(this._ch,this._cl,16),Q(this._dh,this._dl,24),Q(this._eh,this._el,32),Q(this._fh,this._fl,40),Q(this._gh,this._gl,48),Q(this._hh,this._hl,56),X},sha512$3=C,sha512$3}var sha384$2,hasRequiredSha384;function requireSha384(){if(hasRequiredSha384)return sha384$2;hasRequiredSha384=1;var n=inherits_browserExports,r=requireSha512(),_=requireHash$1(),E=requireSafeBuffer().Buffer,S=new Array(160);function C(){this.init(),this._w=S,_.call(this,128,112)}return n(C,r),C.prototype.init=function(){return this._ah=3418070365,this._bh=1654270250,this._ch=2438529370,this._dh=355462360,this._eh=1731405415,this._fh=2394180231,this._gh=3675008525,this._hh=1203062813,this._al=3238371032,this._bl=914150663,this._cl=812702999,this._dl=4144912697,this._el=4290775857,this._fl=1750603025,this._gl=1694076839,this._hl=3204075428,this},C.prototype._hash=function(){var A=E.allocUnsafe(48);function I(B,O,N){A.writeInt32BE(B,N),A.writeInt32BE(O,N+4)}return I(this._ah,this._al,0),I(this._bh,this._bl,8),I(this._ch,this._cl,16),I(this._dh,this._dl,24),I(this._eh,this._el,32),I(this._fh,this._fl,40),A},sha384$2=C,sha384$2}var hasRequiredSha_js;function requireSha_js(){if(hasRequiredSha_js)return sha_js.exports;hasRequiredSha_js=1;var n=sha_js.exports=function(_){_=_.toLowerCase();var E=n[_];if(!E)throw new Error(_+" is not supported (we accept pull requests)");return new E};return n.sha=requireSha$1(),n.sha1=requireSha1(),n.sha224=requireSha224(),n.sha256=requireSha256(),n.sha384=requireSha384(),n.sha512=requireSha512(),sha_js.exports}var util$4={},types$2={},toStr$1=Object.prototype.toString,fnToStr=Function.prototype.toString,isFnRegex=/^\s*(?:function)?\*/,hasToStringTag=shams(),getProto=Object.getPrototypeOf,getGeneratorFunc=function(){if(!hasToStringTag)return!1;try{return Function("return function*() {}")()}catch{}},GeneratorFunction,isGeneratorFunction=function(r){if(typeof r!="function")return!1;if(isFnRegex.test(fnToStr.call(r)))return!0;if(!hasToStringTag){var _=toStr$1.call(r);return _==="[object GeneratorFunction]"}if(!getProto)return!1;if(typeof GeneratorFunction>"u"){var E=getGeneratorFunc();GeneratorFunction=E?getProto(E):!1}return getProto(r)===GeneratorFunction},whichTypedArray=whichTypedArray$2,isTypedArray=function(r){return!!whichTypedArray(r)};(function(n){var r=isArguments$2,_=isGeneratorFunction,E=whichTypedArray$2,S=isTypedArray;function C(kt){return kt.call.bind(kt)}var A=typeof BigInt<"u",I=typeof Symbol<"u",B=C(Object.prototype.toString),O=C(Number.prototype.valueOf),N=C(String.prototype.valueOf),U=C(Boolean.prototype.valueOf);if(A)var j=C(BigInt.prototype.valueOf);if(I)var z=C(Symbol.prototype.valueOf);function Z(kt,Ft){if(typeof kt!="object")return!1;try{return Ft(kt),!0}catch{return!1}}n.isArgumentsObject=r,n.isGeneratorFunction=_,n.isTypedArray=S;function X(kt){return typeof Promise<"u"&&kt instanceof Promise||kt!==null&&typeof kt=="object"&&typeof kt.then=="function"&&typeof kt.catch=="function"}n.isPromise=X;function Q(kt){return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?ArrayBuffer.isView(kt):S(kt)||tt(kt)}n.isArrayBufferView=Q;function se(kt){return E(kt)==="Uint8Array"}n.isUint8Array=se;function oe(kt){return E(kt)==="Uint8ClampedArray"}n.isUint8ClampedArray=oe;function ue(kt){return E(kt)==="Uint16Array"}n.isUint16Array=ue;function we(kt){return E(kt)==="Uint32Array"}n.isUint32Array=we;function Te(kt){return E(kt)==="Int8Array"}n.isInt8Array=Te;function xe(kt){return E(kt)==="Int16Array"}n.isInt16Array=xe;function Re(kt){return E(kt)==="Int32Array"}n.isInt32Array=Re;function Ne(kt){return E(kt)==="Float32Array"}n.isFloat32Array=Ne;function Fe(kt){return E(kt)==="Float64Array"}n.isFloat64Array=Fe;function ht(kt){return E(kt)==="BigInt64Array"}n.isBigInt64Array=ht;function nt(kt){return E(kt)==="BigUint64Array"}n.isBigUint64Array=nt;function Ee(kt){return B(kt)==="[object Map]"}Ee.working=typeof Map<"u"&&Ee(new Map);function Ce(kt){return typeof Map>"u"?!1:Ee.working?Ee(kt):kt instanceof Map}n.isMap=Ce;function _e(kt){return B(kt)==="[object Set]"}_e.working=typeof Set<"u"&&_e(new Set);function Ie(kt){return typeof Set>"u"?!1:_e.working?_e(kt):kt instanceof Set}n.isSet=Ie;function He(kt){return B(kt)==="[object WeakMap]"}He.working=typeof WeakMap<"u"&&He(new WeakMap);function Be(kt){return typeof WeakMap>"u"?!1:He.working?He(kt):kt instanceof WeakMap}n.isWeakMap=Be;function Ge(kt){return B(kt)==="[object WeakSet]"}Ge.working=typeof WeakSet<"u"&&Ge(new WeakSet);function je(kt){return Ge(kt)}n.isWeakSet=je;function Ve(kt){return B(kt)==="[object ArrayBuffer]"}Ve.working=typeof ArrayBuffer<"u"&&Ve(new ArrayBuffer);function Pe(kt){return typeof ArrayBuffer>"u"?!1:Ve.working?Ve(kt):kt instanceof ArrayBuffer}n.isArrayBuffer=Pe;function Me(kt){return B(kt)==="[object DataView]"}Me.working=typeof ArrayBuffer<"u"&&typeof DataView<"u"&&Me(new DataView(new ArrayBuffer(1),0,1));function tt(kt){return typeof DataView>"u"?!1:Me.working?Me(kt):kt instanceof DataView}n.isDataView=tt;var Ke=typeof SharedArrayBuffer<"u"?SharedArrayBuffer:void 0;function mt(kt){return B(kt)==="[object SharedArrayBuffer]"}function ct(kt){return typeof Ke>"u"?!1:(typeof mt.working>"u"&&(mt.working=mt(new Ke)),mt.working?mt(kt):kt instanceof Ke)}n.isSharedArrayBuffer=ct;function Qe(kt){return B(kt)==="[object AsyncFunction]"}n.isAsyncFunction=Qe;function dt(kt){return B(kt)==="[object Map Iterator]"}n.isMapIterator=dt;function vt(kt){return B(kt)==="[object Set Iterator]"}n.isSetIterator=vt;function At(kt){return B(kt)==="[object Generator]"}n.isGeneratorObject=At;function bt(kt){return B(kt)==="[object WebAssembly.Module]"}n.isWebAssemblyCompiledModule=bt;function ft(kt){return Z(kt,O)}n.isNumberObject=ft;function Et(kt){return Z(kt,N)}n.isStringObject=Et;function Ye(kt){return Z(kt,U)}n.isBooleanObject=Ye;function Ct(kt){return A&&Z(kt,j)}n.isBigIntObject=Ct;function Pt(kt){return I&&Z(kt,z)}n.isSymbolObject=Pt;function St(kt){return ft(kt)||Et(kt)||Ye(kt)||Ct(kt)||Pt(kt)}n.isBoxedPrimitive=St;function $t(kt){return typeof Uint8Array<"u"&&(Pe(kt)||ct(kt))}n.isAnyArrayBuffer=$t,["isProxy","isExternal","isModuleNamespaceObject"].forEach(function(kt){Object.defineProperty(n,kt,{enumerable:!1,value:function(){throw new Error(kt+" is not supported in userland")}})})})(types$2);var isBufferBrowser=function(r){return r&&typeof r=="object"&&typeof r.copy=="function"&&typeof r.fill=="function"&&typeof r.readUInt8=="function"};(function(n){var r={},_=Object.getOwnPropertyDescriptors||function(Ke){for(var mt=Object.keys(Ke),ct={},Qe=0;Qe<mt.length;Qe++)ct[mt[Qe]]=Object.getOwnPropertyDescriptor(Ke,mt[Qe]);return ct},E=/%[sdj%]/g;n.format=function(tt){if(!xe(tt)){for(var Ke=[],mt=0;mt<arguments.length;mt++)Ke.push(I(arguments[mt]));return Ke.join(" ")}for(var mt=1,ct=arguments,Qe=ct.length,dt=String(tt).replace(E,function(At){if(At==="%%")return"%";if(mt>=Qe)return At;switch(At){case"%s":return String(ct[mt++]);case"%d":return Number(ct[mt++]);case"%j":try{return JSON.stringify(ct[mt++])}catch{return"[Circular]"}default:return At}}),vt=ct[mt];mt<Qe;vt=ct[++mt])ue(vt)||!ht(vt)?dt+=" "+vt:dt+=" "+I(vt);return dt},n.deprecate=function(tt,Ke){if(typeof browser$1$1<"u"&&browser$1$1.noDeprecation===!0)return tt;if(typeof browser$1$1>"u")return function(){return n.deprecate(tt,Ke).apply(this,arguments)};var mt=!1;function ct(){if(!mt){if(browser$1$1.throwDeprecation)throw new Error(Ke);browser$1$1.traceDeprecation?console.trace(Ke):console.error(Ke),mt=!0}return tt.apply(this,arguments)}return ct};var S={},C=/^$/;if(r.NODE_DEBUG){var A=r.NODE_DEBUG;A=A.replace(/[|\\{}()[\]^$+?.]/g,"\\$&").replace(/\*/g,".*").replace(/,/g,"$|^").toUpperCase(),C=new RegExp("^"+A+"$","i")}n.debuglog=function(tt){if(tt=tt.toUpperCase(),!S[tt])if(C.test(tt)){var Ke=browser$1$1.pid;S[tt]=function(){var mt=n.format.apply(n,arguments);console.error("%s %d: %s",tt,Ke,mt)}}else S[tt]=function(){};return S[tt]};function I(tt,Ke){var mt={seen:[],stylize:O};return arguments.length>=3&&(mt.depth=arguments[2]),arguments.length>=4&&(mt.colors=arguments[3]),oe(Ke)?mt.showHidden=Ke:Ke&&n._extend(mt,Ke),Ne(mt.showHidden)&&(mt.showHidden=!1),Ne(mt.depth)&&(mt.depth=2),Ne(mt.colors)&&(mt.colors=!1),Ne(mt.customInspect)&&(mt.customInspect=!0),mt.colors&&(mt.stylize=B),U(mt,tt,mt.depth)}n.inspect=I,I.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},I.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"};function B(tt,Ke){var mt=I.styles[Ke];return mt?"\x1B["+I.colors[mt][0]+"m"+tt+"\x1B["+I.colors[mt][1]+"m":tt}function O(tt,Ke){return tt}function N(tt){var Ke={};return tt.forEach(function(mt,ct){Ke[mt]=!0}),Ke}function U(tt,Ke,mt){if(tt.customInspect&&Ke&&Ce(Ke.inspect)&&Ke.inspect!==n.inspect&&!(Ke.constructor&&Ke.constructor.prototype===Ke)){var ct=Ke.inspect(mt,tt);return xe(ct)||(ct=U(tt,ct,mt)),ct}var Qe=j(tt,Ke);if(Qe)return Qe;var dt=Object.keys(Ke),vt=N(dt);if(tt.showHidden&&(dt=Object.getOwnPropertyNames(Ke)),Ee(Ke)&&(dt.indexOf("message")>=0||dt.indexOf("description")>=0))return z(Ke);if(dt.length===0){if(Ce(Ke)){var At=Ke.name?": "+Ke.name:"";return tt.stylize("[Function"+At+"]","special")}if(Fe(Ke))return tt.stylize(RegExp.prototype.toString.call(Ke),"regexp");if(nt(Ke))return tt.stylize(Date.prototype.toString.call(Ke),"date");if(Ee(Ke))return z(Ke)}var bt="",ft=!1,Et=["{","}"];if(se(Ke)&&(ft=!0,Et=["[","]"]),Ce(Ke)){var Ye=Ke.name?": "+Ke.name:"";bt=" [Function"+Ye+"]"}if(Fe(Ke)&&(bt=" "+RegExp.prototype.toString.call(Ke)),nt(Ke)&&(bt=" "+Date.prototype.toUTCString.call(Ke)),Ee(Ke)&&(bt=" "+z(Ke)),dt.length===0&&(!ft||Ke.length==0))return Et[0]+bt+Et[1];if(mt<0)return Fe(Ke)?tt.stylize(RegExp.prototype.toString.call(Ke),"regexp"):tt.stylize("[Object]","special");tt.seen.push(Ke);var Ct;return ft?Ct=Z(tt,Ke,mt,vt,dt):Ct=dt.map(function(Pt){return X(tt,Ke,mt,vt,Pt,ft)}),tt.seen.pop(),Q(Ct,bt,Et)}function j(tt,Ke){if(Ne(Ke))return tt.stylize("undefined","undefined");if(xe(Ke)){var mt="'"+JSON.stringify(Ke).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return tt.stylize(mt,"string")}if(Te(Ke))return tt.stylize(""+Ke,"number");if(oe(Ke))return tt.stylize(""+Ke,"boolean");if(ue(Ke))return tt.stylize("null","null")}function z(tt){return"["+Error.prototype.toString.call(tt)+"]"}function Z(tt,Ke,mt,ct,Qe){for(var dt=[],vt=0,At=Ke.length;vt<At;++vt)je(Ke,String(vt))?dt.push(X(tt,Ke,mt,ct,String(vt),!0)):dt.push("");return Qe.forEach(function(bt){bt.match(/^\d+$/)||dt.push(X(tt,Ke,mt,ct,bt,!0))}),dt}function X(tt,Ke,mt,ct,Qe,dt){var vt,At,bt;if(bt=Object.getOwnPropertyDescriptor(Ke,Qe)||{value:Ke[Qe]},bt.get?bt.set?At=tt.stylize("[Getter/Setter]","special"):At=tt.stylize("[Getter]","special"):bt.set&&(At=tt.stylize("[Setter]","special")),je(ct,Qe)||(vt="["+Qe+"]"),At||(tt.seen.indexOf(bt.value)<0?(ue(mt)?At=U(tt,bt.value,null):At=U(tt,bt.value,mt-1),At.indexOf(`
`)>-1&&(dt?At=At.split(`
`).map(function(ft){return"  "+ft}).join(`
`).slice(2):At=`
`+At.split(`
`).map(function(ft){return"   "+ft}).join(`
`))):At=tt.stylize("[Circular]","special")),Ne(vt)){if(dt&&Qe.match(/^\d+$/))return At;vt=JSON.stringify(""+Qe),vt.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(vt=vt.slice(1,-1),vt=tt.stylize(vt,"name")):(vt=vt.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),vt=tt.stylize(vt,"string"))}return vt+": "+At}function Q(tt,Ke,mt){var ct=tt.reduce(function(Qe,dt){return dt.indexOf(`
`)>=0,Qe+dt.replace(/\u001b\[\d\d?m/g,"").length+1},0);return ct>60?mt[0]+(Ke===""?"":Ke+`
 `)+" "+tt.join(`,
  `)+" "+mt[1]:mt[0]+Ke+" "+tt.join(", ")+" "+mt[1]}n.types=types$2;function se(tt){return Array.isArray(tt)}n.isArray=se;function oe(tt){return typeof tt=="boolean"}n.isBoolean=oe;function ue(tt){return tt===null}n.isNull=ue;function we(tt){return tt==null}n.isNullOrUndefined=we;function Te(tt){return typeof tt=="number"}n.isNumber=Te;function xe(tt){return typeof tt=="string"}n.isString=xe;function Re(tt){return typeof tt=="symbol"}n.isSymbol=Re;function Ne(tt){return tt===void 0}n.isUndefined=Ne;function Fe(tt){return ht(tt)&&Ie(tt)==="[object RegExp]"}n.isRegExp=Fe,n.types.isRegExp=Fe;function ht(tt){return typeof tt=="object"&&tt!==null}n.isObject=ht;function nt(tt){return ht(tt)&&Ie(tt)==="[object Date]"}n.isDate=nt,n.types.isDate=nt;function Ee(tt){return ht(tt)&&(Ie(tt)==="[object Error]"||tt instanceof Error)}n.isError=Ee,n.types.isNativeError=Ee;function Ce(tt){return typeof tt=="function"}n.isFunction=Ce;function _e(tt){return tt===null||typeof tt=="boolean"||typeof tt=="number"||typeof tt=="string"||typeof tt=="symbol"||typeof tt>"u"}n.isPrimitive=_e,n.isBuffer=isBufferBrowser;function Ie(tt){return Object.prototype.toString.call(tt)}function He(tt){return tt<10?"0"+tt.toString(10):tt.toString(10)}var Be=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function Ge(){var tt=new Date,Ke=[He(tt.getHours()),He(tt.getMinutes()),He(tt.getSeconds())].join(":");return[tt.getDate(),Be[tt.getMonth()],Ke].join(" ")}n.log=function(){console.log("%s - %s",Ge(),n.format.apply(n,arguments))},n.inherits=inherits_browserExports,n._extend=function(tt,Ke){if(!Ke||!ht(Ke))return tt;for(var mt=Object.keys(Ke),ct=mt.length;ct--;)tt[mt[ct]]=Ke[mt[ct]];return tt};function je(tt,Ke){return Object.prototype.hasOwnProperty.call(tt,Ke)}var Ve=typeof Symbol<"u"?Symbol("util.promisify.custom"):void 0;n.promisify=function(Ke){if(typeof Ke!="function")throw new TypeError('The "original" argument must be of type Function');if(Ve&&Ke[Ve]){var mt=Ke[Ve];if(typeof mt!="function")throw new TypeError('The "util.promisify.custom" argument must be of type Function');return Object.defineProperty(mt,Ve,{value:mt,enumerable:!1,writable:!1,configurable:!0}),mt}function mt(){for(var ct,Qe,dt=new Promise(function(bt,ft){ct=bt,Qe=ft}),vt=[],At=0;At<arguments.length;At++)vt.push(arguments[At]);vt.push(function(bt,ft){bt?Qe(bt):ct(ft)});try{Ke.apply(this,vt)}catch(bt){Qe(bt)}return dt}return Object.setPrototypeOf(mt,Object.getPrototypeOf(Ke)),Ve&&Object.defineProperty(mt,Ve,{value:mt,enumerable:!1,writable:!1,configurable:!0}),Object.defineProperties(mt,_(Ke))},n.promisify.custom=Ve;function Pe(tt,Ke){if(!tt){var mt=new Error("Promise was rejected with a falsy value");mt.reason=tt,tt=mt}return Ke(tt)}function Me(tt){if(typeof tt!="function")throw new TypeError('The "original" argument must be of type Function');function Ke(){for(var mt=[],ct=0;ct<arguments.length;ct++)mt.push(arguments[ct]);var Qe=mt.pop();if(typeof Qe!="function")throw new TypeError("The last argument must be of type Function");var dt=this,vt=function(){return Qe.apply(dt,arguments)};tt.apply(this,mt).then(function(At){browser$1$1.nextTick(vt.bind(null,null,At))},function(At){browser$1$1.nextTick(Pe.bind(null,At,vt))})}return Object.setPrototypeOf(Ke,Object.getPrototypeOf(tt)),Object.defineProperties(Ke,_(tt)),Ke}n.callbackify=Me})(util$4);function BufferList$1(){this.head=null,this.tail=null,this.length=0}BufferList$1.prototype.push=function(n){var r={data:n,next:null};this.length>0?this.tail.next=r:this.head=r,this.tail=r,++this.length};BufferList$1.prototype.unshift=function(n){var r={data:n,next:this.head};this.length===0&&(this.tail=r),this.head=r,++this.length};BufferList$1.prototype.shift=function(){if(this.length!==0){var n=this.head.data;return this.length===1?this.head=this.tail=null:this.head=this.head.next,--this.length,n}};BufferList$1.prototype.clear=function(){this.head=this.tail=null,this.length=0};BufferList$1.prototype.join=function(n){if(this.length===0)return"";for(var r=this.head,_=""+r.data;r=r.next;)_+=n+r.data;return _};BufferList$1.prototype.concat=function(n){if(this.length===0)return buffer$2.Buffer.alloc(0);if(this.length===1)return this.head.data;for(var r=buffer$2.Buffer.allocUnsafe(n>>>0),_=this.head,E=0;_;)_.data.copy(r,E),E+=_.data.length,_=_.next;return r};var string_decoder={},safeBuffer={exports:{}};(function(n,r){var _=buffer$2,E=_.Buffer;function S(A,I){for(var B in A)I[B]=A[B]}E.from&&E.alloc&&E.allocUnsafe&&E.allocUnsafeSlow?n.exports=_:(S(_,r),r.Buffer=C);function C(A,I,B){return E(A,I,B)}S(E,C),C.from=function(A,I,B){if(typeof A=="number")throw new TypeError("Argument must not be a number");return E(A,I,B)},C.alloc=function(A,I,B){if(typeof A!="number")throw new TypeError("Argument must be a number");var O=E(A);return I!==void 0?typeof B=="string"?O.fill(I,B):O.fill(I):O.fill(0),O},C.allocUnsafe=function(A){if(typeof A!="number")throw new TypeError("Argument must be a number");return E(A)},C.allocUnsafeSlow=function(A){if(typeof A!="number")throw new TypeError("Argument must be a number");return _.SlowBuffer(A)}})(safeBuffer,safeBuffer.exports);var safeBufferExports=safeBuffer.exports,Buffer$1=safeBufferExports.Buffer,isEncoding=Buffer$1.isEncoding||function(n){switch(n=""+n,n&&n.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function _normalizeEncoding(n){if(!n)return"utf8";for(var r;;)switch(n){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return n;default:if(r)return;n=(""+n).toLowerCase(),r=!0}}function normalizeEncoding(n){var r=_normalizeEncoding(n);if(typeof r!="string"&&(Buffer$1.isEncoding===isEncoding||!isEncoding(n)))throw new Error("Unknown encoding: "+n);return r||n}var StringDecoder_1=string_decoder.StringDecoder=StringDecoder;function StringDecoder(n){this.encoding=normalizeEncoding(n);var r;switch(this.encoding){case"utf16le":this.text=utf16Text,this.end=utf16End,r=4;break;case"utf8":this.fillLast=utf8FillLast,r=4;break;case"base64":this.text=base64Text,this.end=base64End,r=3;break;default:this.write=simpleWrite,this.end=simpleEnd;return}this.lastNeed=0,this.lastTotal=0,this.lastChar=Buffer$1.allocUnsafe(r)}StringDecoder.prototype.write=function(n){if(n.length===0)return"";var r,_;if(this.lastNeed){if(r=this.fillLast(n),r===void 0)return"";_=this.lastNeed,this.lastNeed=0}else _=0;return _<n.length?r?r+this.text(n,_):this.text(n,_):r||""};StringDecoder.prototype.end=utf8End;StringDecoder.prototype.text=utf8Text;StringDecoder.prototype.fillLast=function(n){if(this.lastNeed<=n.length)return n.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);n.copy(this.lastChar,this.lastTotal-this.lastNeed,0,n.length),this.lastNeed-=n.length};function utf8CheckByte(n){return n<=127?0:n>>5===6?2:n>>4===14?3:n>>3===30?4:n>>6===2?-1:-2}function utf8CheckIncomplete(n,r,_){var E=r.length-1;if(E<_)return 0;var S=utf8CheckByte(r[E]);return S>=0?(S>0&&(n.lastNeed=S-1),S):--E<_||S===-2?0:(S=utf8CheckByte(r[E]),S>=0?(S>0&&(n.lastNeed=S-2),S):--E<_||S===-2?0:(S=utf8CheckByte(r[E]),S>=0?(S>0&&(S===2?S=0:n.lastNeed=S-3),S):0))}function utf8CheckExtraBytes(n,r,_){if((r[0]&192)!==128)return n.lastNeed=0,"";if(n.lastNeed>1&&r.length>1){if((r[1]&192)!==128)return n.lastNeed=1,"";if(n.lastNeed>2&&r.length>2&&(r[2]&192)!==128)return n.lastNeed=2,""}}function utf8FillLast(n){var r=this.lastTotal-this.lastNeed,_=utf8CheckExtraBytes(this,n);if(_!==void 0)return _;if(this.lastNeed<=n.length)return n.copy(this.lastChar,r,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);n.copy(this.lastChar,r,0,n.length),this.lastNeed-=n.length}function utf8Text(n,r){var _=utf8CheckIncomplete(this,n,r);if(!this.lastNeed)return n.toString("utf8",r);this.lastTotal=_;var E=n.length-(_-this.lastNeed);return n.copy(this.lastChar,0,E),n.toString("utf8",r,E)}function utf8End(n){var r=n&&n.length?this.write(n):"";return this.lastNeed?r+"":r}function utf16Text(n,r){if((n.length-r)%2===0){var _=n.toString("utf16le",r);if(_){var E=_.charCodeAt(_.length-1);if(E>=55296&&E<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=n[n.length-2],this.lastChar[1]=n[n.length-1],_.slice(0,-1)}return _}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=n[n.length-1],n.toString("utf16le",r,n.length-1)}function utf16End(n){var r=n&&n.length?this.write(n):"";if(this.lastNeed){var _=this.lastTotal-this.lastNeed;return r+this.lastChar.toString("utf16le",0,_)}return r}function base64Text(n,r){var _=(n.length-r)%3;return _===0?n.toString("base64",r):(this.lastNeed=3-_,this.lastTotal=3,_===1?this.lastChar[0]=n[n.length-1]:(this.lastChar[0]=n[n.length-2],this.lastChar[1]=n[n.length-1]),n.toString("base64",r,n.length-_))}function base64End(n){var r=n&&n.length?this.write(n):"";return this.lastNeed?r+this.lastChar.toString("base64",0,3-this.lastNeed):r}function simpleWrite(n){return n.toString(this.encoding)}function simpleEnd(n){return n&&n.length?this.write(n):""}Readable.ReadableState=ReadableState;var debug=util$4.debuglog("stream");util$4.inherits(Readable,EventEmitter$3);function prependListener(n,r,_){if(typeof n.prependListener=="function")return n.prependListener(r,_);!n._events||!n._events[r]?n.on(r,_):Array.isArray(n._events[r])?n._events[r].unshift(_):n._events[r]=[_,n._events[r]]}function listenerCount(n,r){return n.listeners(r).length}function ReadableState(n,r){n=n||{},this.objectMode=!!n.objectMode,r instanceof Duplex&&(this.objectMode=this.objectMode||!!n.readableObjectMode);var _=n.highWaterMark,E=this.objectMode?16:16*1024;this.highWaterMark=_||_===0?_:E,this.highWaterMark=~~this.highWaterMark,this.buffer=new BufferList$1,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.defaultEncoding=n.defaultEncoding||"utf8",this.ranOut=!1,this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,n.encoding&&(this.decoder=new StringDecoder_1(n.encoding),this.encoding=n.encoding)}function Readable(n){if(!(this instanceof Readable))return new Readable(n);this._readableState=new ReadableState(n,this),this.readable=!0,n&&typeof n.read=="function"&&(this._read=n.read),EventEmitter$3.call(this)}Readable.prototype.push=function(n,r){var _=this._readableState;return!_.objectMode&&typeof n=="string"&&(r=r||_.defaultEncoding,r!==_.encoding&&(n=Buffer$4.from(n,r),r="")),readableAddChunk(this,_,n,r,!1)};Readable.prototype.unshift=function(n){var r=this._readableState;return readableAddChunk(this,r,n,"",!0)};Readable.prototype.isPaused=function(){return this._readableState.flowing===!1};function readableAddChunk(n,r,_,E,S){var C=chunkInvalid(r,_);if(C)n.emit("error",C);else if(_===null)r.reading=!1,onEofChunk(n,r);else if(r.objectMode||_&&_.length>0)if(r.ended&&!S){var A=new Error("stream.push() after EOF");n.emit("error",A)}else if(r.endEmitted&&S){var I=new Error("stream.unshift() after end event");n.emit("error",I)}else{var B;r.decoder&&!S&&!E&&(_=r.decoder.write(_),B=!r.objectMode&&_.length===0),S||(r.reading=!1),B||(r.flowing&&r.length===0&&!r.sync?(n.emit("data",_),n.read(0)):(r.length+=r.objectMode?1:_.length,S?r.buffer.unshift(_):r.buffer.push(_),r.needReadable&&emitReadable(n))),maybeReadMore(n,r)}else S||(r.reading=!1);return needMoreData(r)}function needMoreData(n){return!n.ended&&(n.needReadable||n.length<n.highWaterMark||n.length===0)}Readable.prototype.setEncoding=function(n){return this._readableState.decoder=new StringDecoder_1(n),this._readableState.encoding=n,this};var MAX_HWM=8388608;function computeNewHighWaterMark(n){return n>=MAX_HWM?n=MAX_HWM:(n--,n|=n>>>1,n|=n>>>2,n|=n>>>4,n|=n>>>8,n|=n>>>16,n++),n}function howMuchToRead(n,r){return n<=0||r.length===0&&r.ended?0:r.objectMode?1:n!==n?r.flowing&&r.length?r.buffer.head.data.length:r.length:(n>r.highWaterMark&&(r.highWaterMark=computeNewHighWaterMark(n)),n<=r.length?n:r.ended?r.length:(r.needReadable=!0,0))}Readable.prototype.read=function(n){debug("read",n),n=parseInt(n,10);var r=this._readableState,_=n;if(n!==0&&(r.emittedReadable=!1),n===0&&r.needReadable&&(r.length>=r.highWaterMark||r.ended))return debug("read: emitReadable",r.length,r.ended),r.length===0&&r.ended?endReadable(this):emitReadable(this),null;if(n=howMuchToRead(n,r),n===0&&r.ended)return r.length===0&&endReadable(this),null;var E=r.needReadable;debug("need readable",E),(r.length===0||r.length-n<r.highWaterMark)&&(E=!0,debug("length less than watermark",E)),r.ended||r.reading?(E=!1,debug("reading or ended",E)):E&&(debug("do read"),r.reading=!0,r.sync=!0,r.length===0&&(r.needReadable=!0),this._read(r.highWaterMark),r.sync=!1,r.reading||(n=howMuchToRead(_,r)));var S;return n>0?S=fromList(n,r):S=null,S===null?(r.needReadable=!0,n=0):r.length-=n,r.length===0&&(r.ended||(r.needReadable=!0),_!==n&&r.ended&&endReadable(this)),S!==null&&this.emit("data",S),S};function chunkInvalid(n,r){var _=null;return!Buffer$4.isBuffer(r)&&typeof r!="string"&&r!==null&&r!==void 0&&!n.objectMode&&(_=new TypeError("Invalid non-string/buffer chunk")),_}function onEofChunk(n,r){if(!r.ended){if(r.decoder){var _=r.decoder.end();_&&_.length&&(r.buffer.push(_),r.length+=r.objectMode?1:_.length)}r.ended=!0,emitReadable(n)}}function emitReadable(n){var r=n._readableState;r.needReadable=!1,r.emittedReadable||(debug("emitReadable",r.flowing),r.emittedReadable=!0,r.sync?nextTick$4(emitReadable_,n):emitReadable_(n))}function emitReadable_(n){debug("emit readable"),n.emit("readable"),flow(n)}function maybeReadMore(n,r){r.readingMore||(r.readingMore=!0,nextTick$4(maybeReadMore_,n,r))}function maybeReadMore_(n,r){for(var _=r.length;!r.reading&&!r.flowing&&!r.ended&&r.length<r.highWaterMark&&(debug("maybeReadMore read 0"),n.read(0),_!==r.length);)_=r.length;r.readingMore=!1}Readable.prototype._read=function(n){this.emit("error",new Error("not implemented"))};Readable.prototype.pipe=function(n,r){var _=this,E=this._readableState;switch(E.pipesCount){case 0:E.pipes=n;break;case 1:E.pipes=[E.pipes,n];break;default:E.pipes.push(n);break}E.pipesCount+=1,debug("pipe count=%d opts=%j",E.pipesCount,r);var S=!r||r.end!==!1,C=S?I:N;E.endEmitted?nextTick$4(C):_.once("end",C),n.on("unpipe",A);function A(se){debug("onunpipe"),se===_&&N()}function I(){debug("onend"),n.end()}var B=pipeOnDrain(_);n.on("drain",B);var O=!1;function N(){debug("cleanup"),n.removeListener("close",Z),n.removeListener("finish",X),n.removeListener("drain",B),n.removeListener("error",z),n.removeListener("unpipe",A),_.removeListener("end",I),_.removeListener("end",N),_.removeListener("data",j),O=!0,E.awaitDrain&&(!n._writableState||n._writableState.needDrain)&&B()}var U=!1;_.on("data",j);function j(se){debug("ondata"),U=!1;var oe=n.write(se);oe===!1&&!U&&((E.pipesCount===1&&E.pipes===n||E.pipesCount>1&&indexOf(E.pipes,n)!==-1)&&!O&&(debug("false write response, pause",_._readableState.awaitDrain),_._readableState.awaitDrain++,U=!0),_.pause())}function z(se){debug("onerror",se),Q(),n.removeListener("error",z),listenerCount(n,"error")===0&&n.emit("error",se)}prependListener(n,"error",z);function Z(){n.removeListener("finish",X),Q()}n.once("close",Z);function X(){debug("onfinish"),n.removeListener("close",Z),Q()}n.once("finish",X);function Q(){debug("unpipe"),_.unpipe(n)}return n.emit("pipe",_),E.flowing||(debug("pipe resume"),_.resume()),n};function pipeOnDrain(n){return function(){var r=n._readableState;debug("pipeOnDrain",r.awaitDrain),r.awaitDrain&&r.awaitDrain--,r.awaitDrain===0&&n.listeners("data").length&&(r.flowing=!0,flow(n))}}Readable.prototype.unpipe=function(n){var r=this._readableState;if(r.pipesCount===0)return this;if(r.pipesCount===1)return n&&n!==r.pipes?this:(n||(n=r.pipes),r.pipes=null,r.pipesCount=0,r.flowing=!1,n&&n.emit("unpipe",this),this);if(!n){var _=r.pipes,E=r.pipesCount;r.pipes=null,r.pipesCount=0,r.flowing=!1;for(var S=0;S<E;S++)_[S].emit("unpipe",this);return this}var C=indexOf(r.pipes,n);return C===-1?this:(r.pipes.splice(C,1),r.pipesCount-=1,r.pipesCount===1&&(r.pipes=r.pipes[0]),n.emit("unpipe",this),this)};Readable.prototype.on=function(n,r){var _=EventEmitter$3.prototype.on.call(this,n,r);if(n==="data")this._readableState.flowing!==!1&&this.resume();else if(n==="readable"){var E=this._readableState;!E.endEmitted&&!E.readableListening&&(E.readableListening=E.needReadable=!0,E.emittedReadable=!1,E.reading?E.length&&emitReadable(this):nextTick$4(nReadingNextTick,this))}return _};Readable.prototype.addListener=Readable.prototype.on;function nReadingNextTick(n){debug("readable nexttick read 0"),n.read(0)}Readable.prototype.resume=function(){var n=this._readableState;return n.flowing||(debug("resume"),n.flowing=!0,resume(this,n)),this};function resume(n,r){r.resumeScheduled||(r.resumeScheduled=!0,nextTick$4(resume_,n,r))}function resume_(n,r){r.reading||(debug("resume read 0"),n.read(0)),r.resumeScheduled=!1,r.awaitDrain=0,n.emit("resume"),flow(n),r.flowing&&!r.reading&&n.read(0)}Readable.prototype.pause=function(){return debug("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&(debug("pause"),this._readableState.flowing=!1,this.emit("pause")),this};function flow(n){var r=n._readableState;for(debug("flow",r.flowing);r.flowing&&n.read()!==null;);}Readable.prototype.wrap=function(n){var r=this._readableState,_=!1,E=this;n.on("end",function(){if(debug("wrapped end"),r.decoder&&!r.ended){var A=r.decoder.end();A&&A.length&&E.push(A)}E.push(null)}),n.on("data",function(A){if(debug("wrapped data"),r.decoder&&(A=r.decoder.write(A)),!(r.objectMode&&A==null)&&!(!r.objectMode&&(!A||!A.length))){var I=E.push(A);I||(_=!0,n.pause())}});for(var S in n)this[S]===void 0&&typeof n[S]=="function"&&(this[S]=function(A){return function(){return n[A].apply(n,arguments)}}(S));var C=["error","close","destroy","pause","resume"];return forEach$1(C,function(A){n.on(A,E.emit.bind(E,A))}),E._read=function(A){debug("wrapped _read",A),_&&(_=!1,n.resume())},E};Readable._fromList=fromList;function fromList(n,r){if(r.length===0)return null;var _;return r.objectMode?_=r.buffer.shift():!n||n>=r.length?(r.decoder?_=r.buffer.join(""):r.buffer.length===1?_=r.buffer.head.data:_=r.buffer.concat(r.length),r.buffer.clear()):_=fromListPartial(n,r.buffer,r.decoder),_}function fromListPartial(n,r,_){var E;return n<r.head.data.length?(E=r.head.data.slice(0,n),r.head.data=r.head.data.slice(n)):n===r.head.data.length?E=r.shift():E=_?copyFromBufferString(n,r):copyFromBuffer(n,r),E}function copyFromBufferString(n,r){var _=r.head,E=1,S=_.data;for(n-=S.length;_=_.next;){var C=_.data,A=n>C.length?C.length:n;if(A===C.length?S+=C:S+=C.slice(0,n),n-=A,n===0){A===C.length?(++E,_.next?r.head=_.next:r.head=r.tail=null):(r.head=_,_.data=C.slice(A));break}++E}return r.length-=E,S}function copyFromBuffer(n,r){var _=Buffer$4.allocUnsafe(n),E=r.head,S=1;for(E.data.copy(_),n-=E.data.length;E=E.next;){var C=E.data,A=n>C.length?C.length:n;if(C.copy(_,_.length-n,0,A),n-=A,n===0){A===C.length?(++S,E.next?r.head=E.next:r.head=r.tail=null):(r.head=E,E.data=C.slice(A));break}++S}return r.length-=S,_}function endReadable(n){var r=n._readableState;if(r.length>0)throw new Error('"endReadable()" called on non-empty stream');r.endEmitted||(r.ended=!0,nextTick$4(endReadableNT,r,n))}function endReadableNT(n,r){!n.endEmitted&&n.length===0&&(n.endEmitted=!0,r.readable=!1,r.emit("end"))}function forEach$1(n,r){for(var _=0,E=n.length;_<E;_++)r(n[_],_)}function indexOf(n,r){for(var _=0,E=n.length;_<E;_++)if(n[_]===r)return _;return-1}Writable.WritableState=WritableState;util$4.inherits(Writable,eventsExports.EventEmitter);function nop(){}function WriteReq(n,r,_){this.chunk=n,this.encoding=r,this.callback=_,this.next=null}function WritableState(n,r){Object.defineProperty(this,"buffer",{get:util$4.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.")}),n=n||{},this.objectMode=!!n.objectMode,r instanceof Duplex&&(this.objectMode=this.objectMode||!!n.writableObjectMode);var _=n.highWaterMark,E=this.objectMode?16:16*1024;this.highWaterMark=_||_===0?_:E,this.highWaterMark=~~this.highWaterMark,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1;var S=n.decodeStrings===!1;this.decodeStrings=!S,this.defaultEncoding=n.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(C){onwrite(r,C)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.bufferedRequestCount=0,this.corkedRequestsFree=new CorkedRequest(this)}WritableState.prototype.getBuffer=function(){for(var r=this.bufferedRequest,_=[];r;)_.push(r),r=r.next;return _};function Writable(n){if(!(this instanceof Writable)&&!(this instanceof Duplex))return new Writable(n);this._writableState=new WritableState(n,this),this.writable=!0,n&&(typeof n.write=="function"&&(this._write=n.write),typeof n.writev=="function"&&(this._writev=n.writev)),eventsExports.EventEmitter.call(this)}Writable.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe, not readable"))};function writeAfterEnd(n,r){var _=new Error("write after end");n.emit("error",_),nextTick$4(r,_)}function validChunk(n,r,_,E){var S=!0,C=!1;return _===null?C=new TypeError("May not write null values to stream"):!buffer$2.Buffer.isBuffer(_)&&typeof _!="string"&&_!==void 0&&!r.objectMode&&(C=new TypeError("Invalid non-string/buffer chunk")),C&&(n.emit("error",C),nextTick$4(E,C),S=!1),S}Writable.prototype.write=function(n,r,_){var E=this._writableState,S=!1;return typeof r=="function"&&(_=r,r=null),buffer$2.Buffer.isBuffer(n)?r="buffer":r||(r=E.defaultEncoding),typeof _!="function"&&(_=nop),E.ended?writeAfterEnd(this,_):validChunk(this,E,n,_)&&(E.pendingcb++,S=writeOrBuffer(this,E,n,r,_)),S};Writable.prototype.cork=function(){var n=this._writableState;n.corked++};Writable.prototype.uncork=function(){var n=this._writableState;n.corked&&(n.corked--,!n.writing&&!n.corked&&!n.finished&&!n.bufferProcessing&&n.bufferedRequest&&clearBuffer(this,n))};Writable.prototype.setDefaultEncoding=function(r){if(typeof r=="string"&&(r=r.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((r+"").toLowerCase())>-1))throw new TypeError("Unknown encoding: "+r);return this._writableState.defaultEncoding=r,this};function decodeChunk(n,r,_){return!n.objectMode&&n.decodeStrings!==!1&&typeof r=="string"&&(r=buffer$2.Buffer.from(r,_)),r}function writeOrBuffer(n,r,_,E,S){_=decodeChunk(r,_,E),buffer$2.Buffer.isBuffer(_)&&(E="buffer");var C=r.objectMode?1:_.length;r.length+=C;var A=r.length<r.highWaterMark;if(A||(r.needDrain=!0),r.writing||r.corked){var I=r.lastBufferedRequest;r.lastBufferedRequest=new WriteReq(_,E,S),I?I.next=r.lastBufferedRequest:r.bufferedRequest=r.lastBufferedRequest,r.bufferedRequestCount+=1}else doWrite(n,r,!1,C,_,E,S);return A}function doWrite(n,r,_,E,S,C,A){r.writelen=E,r.writecb=A,r.writing=!0,r.sync=!0,_?n._writev(S,r.onwrite):n._write(S,C,r.onwrite),r.sync=!1}function onwriteError(n,r,_,E,S){--r.pendingcb,_?nextTick$4(S,E):S(E),n._writableState.errorEmitted=!0,n.emit("error",E)}function onwriteStateUpdate(n){n.writing=!1,n.writecb=null,n.length-=n.writelen,n.writelen=0}function onwrite(n,r){var _=n._writableState,E=_.sync,S=_.writecb;if(onwriteStateUpdate(_),r)onwriteError(n,_,E,r,S);else{var C=needFinish(_);!C&&!_.corked&&!_.bufferProcessing&&_.bufferedRequest&&clearBuffer(n,_),E?nextTick$4(afterWrite,n,_,C,S):afterWrite(n,_,C,S)}}function afterWrite(n,r,_,E){_||onwriteDrain(n,r),r.pendingcb--,E(),finishMaybe(n,r)}function onwriteDrain(n,r){r.length===0&&r.needDrain&&(r.needDrain=!1,n.emit("drain"))}function clearBuffer(n,r){r.bufferProcessing=!0;var _=r.bufferedRequest;if(n._writev&&_&&_.next){var E=r.bufferedRequestCount,S=new Array(E),C=r.corkedRequestsFree;C.entry=_;for(var A=0;_;)S[A]=_,_=_.next,A+=1;doWrite(n,r,!0,r.length,S,"",C.finish),r.pendingcb++,r.lastBufferedRequest=null,C.next?(r.corkedRequestsFree=C.next,C.next=null):r.corkedRequestsFree=new CorkedRequest(r)}else{for(;_;){var I=_.chunk,B=_.encoding,O=_.callback,N=r.objectMode?1:I.length;if(doWrite(n,r,!1,N,I,B,O),_=_.next,r.writing)break}_===null&&(r.lastBufferedRequest=null)}r.bufferedRequestCount=0,r.bufferedRequest=_,r.bufferProcessing=!1}Writable.prototype._write=function(n,r,_){_(new Error("not implemented"))};Writable.prototype._writev=null;Writable.prototype.end=function(n,r,_){var E=this._writableState;typeof n=="function"?(_=n,n=null,r=null):typeof r=="function"&&(_=r,r=null),n!=null&&this.write(n,r),E.corked&&(E.corked=1,this.uncork()),!E.ending&&!E.finished&&endWritable(this,E,_)};function needFinish(n){return n.ending&&n.length===0&&n.bufferedRequest===null&&!n.finished&&!n.writing}function prefinish(n,r){r.prefinished||(r.prefinished=!0,n.emit("prefinish"))}function finishMaybe(n,r){var _=needFinish(r);return _&&(r.pendingcb===0?(prefinish(n,r),r.finished=!0,n.emit("finish")):prefinish(n,r)),_}function endWritable(n,r,_){r.ending=!0,finishMaybe(n,r),_&&(r.finished?nextTick$4(_):n.once("finish",_)),r.ended=!0,n.writable=!1}function CorkedRequest(n){var r=this;this.next=null,this.entry=null,this.finish=function(_){var E=r.entry;for(r.entry=null;E;){var S=E.callback;n.pendingcb--,S(_),E=E.next}n.corkedRequestsFree?n.corkedRequestsFree.next=r:n.corkedRequestsFree=r}}util$4.inherits(Duplex,Readable);var keys$1=Object.keys(Writable.prototype);for(var v=0;v<keys$1.length;v++){var method=keys$1[v];Duplex.prototype[method]||(Duplex.prototype[method]=Writable.prototype[method])}function Duplex(n){if(!(this instanceof Duplex))return new Duplex(n);Readable.call(this,n),Writable.call(this,n),n&&n.readable===!1&&(this.readable=!1),n&&n.writable===!1&&(this.writable=!1),this.allowHalfOpen=!0,n&&n.allowHalfOpen===!1&&(this.allowHalfOpen=!1),this.once("end",onend)}function onend(){this.allowHalfOpen||this._writableState.ended||nextTick$4(onEndNT,this)}function onEndNT(n){n.end()}util$4.inherits(Transform,Duplex);function TransformState(n){this.afterTransform=function(r,_){return afterTransform(n,r,_)},this.needTransform=!1,this.transforming=!1,this.writecb=null,this.writechunk=null,this.writeencoding=null}function afterTransform(n,r,_){var E=n._transformState;E.transforming=!1;var S=E.writecb;if(!S)return n.emit("error",new Error("no writecb in Transform class"));E.writechunk=null,E.writecb=null,_!=null&&n.push(_),S(r);var C=n._readableState;C.reading=!1,(C.needReadable||C.length<C.highWaterMark)&&n._read(C.highWaterMark)}function Transform(n){if(!(this instanceof Transform))return new Transform(n);Duplex.call(this,n),this._transformState=new TransformState(this);var r=this;this._readableState.needReadable=!0,this._readableState.sync=!1,n&&(typeof n.transform=="function"&&(this._transform=n.transform),typeof n.flush=="function"&&(this._flush=n.flush)),this.once("prefinish",function(){typeof this._flush=="function"?this._flush(function(_){done(r,_)}):done(r)})}Transform.prototype.push=function(n,r){return this._transformState.needTransform=!1,Duplex.prototype.push.call(this,n,r)};Transform.prototype._transform=function(n,r,_){throw new Error("Not implemented")};Transform.prototype._write=function(n,r,_){var E=this._transformState;if(E.writecb=_,E.writechunk=n,E.writeencoding=r,!E.transforming){var S=this._readableState;(E.needTransform||S.needReadable||S.length<S.highWaterMark)&&this._read(S.highWaterMark)}};Transform.prototype._read=function(n){var r=this._transformState;r.writechunk!==null&&r.writecb&&!r.transforming?(r.transforming=!0,this._transform(r.writechunk,r.writeencoding,r.afterTransform)):r.needTransform=!0};function done(n,r){if(r)return n.emit("error",r);var _=n._writableState,E=n._transformState;if(_.length)throw new Error("Calling transform done when ws.length != 0");if(E.transforming)throw new Error("Calling transform done when still transforming");return n.push(null)}util$4.inherits(PassThrough,Transform);function PassThrough(n){if(!(this instanceof PassThrough))return new PassThrough(n);Transform.call(this,n)}PassThrough.prototype._transform=function(n,r,_){_(null,n)};util$4.inherits(Stream,EventEmitter$3);Stream.Readable=Readable;Stream.Writable=Writable;Stream.Duplex=Duplex;Stream.Transform=Transform;Stream.PassThrough=PassThrough;Stream.Stream=Stream;function Stream(){EventEmitter$3.call(this)}Stream.prototype.pipe=function(n,r){var _=this;function E(N){n.writable&&n.write(N)===!1&&_.pause&&_.pause()}_.on("data",E);function S(){_.readable&&_.resume&&_.resume()}n.on("drain",S),!n._isStdio&&(!r||r.end!==!1)&&(_.on("end",A),_.on("close",I));var C=!1;function A(){C||(C=!0,n.end())}function I(){C||(C=!0,typeof n.destroy=="function"&&n.destroy())}function B(N){if(O(),EventEmitter$3.listenerCount(this,"error")===0)throw N}_.on("error",B),n.on("error",B);function O(){_.removeListener("data",E),n.removeListener("drain",S),_.removeListener("end",A),_.removeListener("close",I),_.removeListener("error",B),n.removeListener("error",B),_.removeListener("end",O),_.removeListener("close",O),n.removeListener("close",O)}return _.on("end",O),_.on("close",O),n.on("close",O),n.emit("pipe",_),n};const stream=Object.freeze(Object.defineProperty({__proto__:null,Duplex,PassThrough,Readable,Stream,Transform,Writable,default:Stream},Symbol.toStringTag,{value:"Module"})),require$$0$1=getAugmentedNamespace(stream);var cipherBase,hasRequiredCipherBase;function requireCipherBase(){if(hasRequiredCipherBase)return cipherBase;hasRequiredCipherBase=1;var n=requireSafeBuffer().Buffer,r=require$$0$1.Transform,_=string_decoder.StringDecoder,E=inherits_browserExports;function S(C){r.call(this),this.hashMode=typeof C=="string",this.hashMode?this[C]=this._finalOrDigest:this.final=this._finalOrDigest,this._final&&(this.__final=this._final,this._final=null),this._decoder=null,this._encoding=null}return E(S,r),S.prototype.update=function(C,A,I){typeof C=="string"&&(C=n.from(C,A));var B=this._update(C);return this.hashMode?this:(I&&(B=this._toString(B,I)),B)},S.prototype.setAutoPadding=function(){},S.prototype.getAuthTag=function(){throw new Error("trying to get auth tag in unsupported state")},S.prototype.setAuthTag=function(){throw new Error("trying to set auth tag in unsupported state")},S.prototype.setAAD=function(){throw new Error("trying to set aad in unsupported state")},S.prototype._transform=function(C,A,I){var B;try{this.hashMode?this._update(C):this.push(this._update(C))}catch(O){B=O}finally{I(B)}},S.prototype._flush=function(C){var A;try{this.push(this.__final())}catch(I){A=I}C(A)},S.prototype._finalOrDigest=function(C){var A=this.__final()||n.alloc(0);return C&&(A=this._toString(A,C,!0)),A},S.prototype._toString=function(C,A,I){if(this._decoder||(this._decoder=new _(A),this._encoding=A),this._encoding!==A)throw new Error("can't switch encodings");var B=this._decoder.write(C);return I&&(B+=this._decoder.end()),B},cipherBase=S,cipherBase}var browser$d,hasRequiredBrowser$9;function requireBrowser$9(){if(hasRequiredBrowser$9)return browser$d;hasRequiredBrowser$9=1;var n=inherits_browserExports,r=requireMd5_js(),_=requireRipemd160(),E=requireSha_js(),S=requireCipherBase();function C(A){S.call(this,"digest"),this._hash=A}return n(C,S),C.prototype._update=function(A){this._hash.update(A)},C.prototype._final=function(){return this._hash.digest()},browser$d=function(I){return I=I.toLowerCase(),I==="md5"?new r:I==="rmd160"||I==="ripemd160"?new _:new C(E(I))},browser$d}var legacy,hasRequiredLegacy;function requireLegacy(){if(hasRequiredLegacy)return legacy;hasRequiredLegacy=1;var n=inherits_browserExports,r=requireSafeBuffer().Buffer,_=requireCipherBase(),E=r.alloc(128),S=64;function C(A,I){_.call(this,"digest"),typeof I=="string"&&(I=r.from(I)),this._alg=A,this._key=I,I.length>S?I=A(I):I.length<S&&(I=r.concat([I,E],S));for(var B=this._ipad=r.allocUnsafe(S),O=this._opad=r.allocUnsafe(S),N=0;N<S;N++)B[N]=I[N]^54,O[N]=I[N]^92;this._hash=[B]}return n(C,_),C.prototype._update=function(A){this._hash.push(A)},C.prototype._final=function(){var A=this._alg(r.concat(this._hash));return this._alg(r.concat([this._opad,A]))},legacy=C,legacy}var md5$2,hasRequiredMd5;function requireMd5(){if(hasRequiredMd5)return md5$2;hasRequiredMd5=1;var n=requireMd5_js();return md5$2=function(r){return new n().update(r).digest()},md5$2}var browser$c,hasRequiredBrowser$8;function requireBrowser$8(){if(hasRequiredBrowser$8)return browser$c;hasRequiredBrowser$8=1;var n=inherits_browserExports,r=requireLegacy(),_=requireCipherBase(),E=requireSafeBuffer().Buffer,S=requireMd5(),C=requireRipemd160(),A=requireSha_js(),I=E.alloc(128);function B(O,N){_.call(this,"digest"),typeof N=="string"&&(N=E.from(N));var U=O==="sha512"||O==="sha384"?128:64;if(this._alg=O,this._key=N,N.length>U){var j=O==="rmd160"?new C:A(O);N=j.update(N).digest()}else N.length<U&&(N=E.concat([N,I],U));for(var z=this._ipad=E.allocUnsafe(U),Z=this._opad=E.allocUnsafe(U),X=0;X<U;X++)z[X]=N[X]^54,Z[X]=N[X]^92;this._hash=O==="rmd160"?new C:A(O),this._hash.update(z)}return n(B,_),B.prototype._update=function(O){this._hash.update(O)},B.prototype._final=function(){var O=this._hash.digest(),N=this._alg==="rmd160"?new C:A(this._alg);return N.update(this._opad).update(O).digest()},browser$c=function(N,U){return N=N.toLowerCase(),N==="rmd160"||N==="ripemd160"?new B("rmd160",U):N==="md5"?new r(S,U):new B(N,U)},browser$c}const sha224WithRSAEncryption={sign:"rsa",hash:"sha224",id:"302d300d06096086480165030402040500041c"},sha256WithRSAEncryption={sign:"rsa",hash:"sha256",id:"3031300d060960864801650304020105000420"},sha384WithRSAEncryption={sign:"rsa",hash:"sha384",id:"3041300d060960864801650304020205000430"},sha512WithRSAEncryption={sign:"rsa",hash:"sha512",id:"3051300d060960864801650304020305000440"},sha256$4={sign:"ecdsa",hash:"sha256",id:""},sha224={sign:"ecdsa",hash:"sha224",id:""},sha384$1={sign:"ecdsa",hash:"sha384",id:""},sha512$2={sign:"ecdsa",hash:"sha512",id:""},DSA={sign:"dsa",hash:"sha1",id:""},ripemd160WithRSA={sign:"rsa",hash:"rmd160",id:"3021300906052b2403020105000414"},md5WithRSAEncryption={sign:"rsa",hash:"md5",id:"3020300c06082a864886f70d020505000410"},require$$6={sha224WithRSAEncryption,"RSA-SHA224":{sign:"ecdsa/rsa",hash:"sha224",id:"302d300d06096086480165030402040500041c"},sha256WithRSAEncryption,"RSA-SHA256":{sign:"ecdsa/rsa",hash:"sha256",id:"3031300d060960864801650304020105000420"},sha384WithRSAEncryption,"RSA-SHA384":{sign:"ecdsa/rsa",hash:"sha384",id:"3041300d060960864801650304020205000430"},sha512WithRSAEncryption,"RSA-SHA512":{sign:"ecdsa/rsa",hash:"sha512",id:"3051300d060960864801650304020305000440"},"RSA-SHA1":{sign:"rsa",hash:"sha1",id:"3021300906052b0e03021a05000414"},"ecdsa-with-SHA1":{sign:"ecdsa",hash:"sha1",id:""},sha256:sha256$4,sha224,sha384:sha384$1,sha512:sha512$2,"DSA-SHA":{sign:"dsa",hash:"sha1",id:""},"DSA-SHA1":{sign:"dsa",hash:"sha1",id:""},DSA,"DSA-WITH-SHA224":{sign:"dsa",hash:"sha224",id:""},"DSA-SHA224":{sign:"dsa",hash:"sha224",id:""},"DSA-WITH-SHA256":{sign:"dsa",hash:"sha256",id:""},"DSA-SHA256":{sign:"dsa",hash:"sha256",id:""},"DSA-WITH-SHA384":{sign:"dsa",hash:"sha384",id:""},"DSA-SHA384":{sign:"dsa",hash:"sha384",id:""},"DSA-WITH-SHA512":{sign:"dsa",hash:"sha512",id:""},"DSA-SHA512":{sign:"dsa",hash:"sha512",id:""},"DSA-RIPEMD160":{sign:"dsa",hash:"rmd160",id:""},ripemd160WithRSA,"RSA-RIPEMD160":{sign:"rsa",hash:"rmd160",id:"3021300906052b2403020105000414"},md5WithRSAEncryption,"RSA-MD5":{sign:"rsa",hash:"md5",id:"3020300c06082a864886f70d020505000410"}};var algos,hasRequiredAlgos;function requireAlgos(){return hasRequiredAlgos||(hasRequiredAlgos=1,algos=require$$6),algos}var browser$b={},precondition,hasRequiredPrecondition;function requirePrecondition(){if(hasRequiredPrecondition)return precondition;hasRequiredPrecondition=1;var n=Math.pow(2,30)-1;return precondition=function(r,_){if(typeof r!="number")throw new TypeError("Iterations not a number");if(r<0)throw new TypeError("Bad iterations");if(typeof _!="number")throw new TypeError("Key length not a number");if(_<0||_>n||_!==_)throw new TypeError("Bad key length")},precondition}var defaultEncoding_1,hasRequiredDefaultEncoding;function requireDefaultEncoding(){if(hasRequiredDefaultEncoding)return defaultEncoding_1;hasRequiredDefaultEncoding=1;var n;if(commonjsGlobal.process&&commonjsGlobal.process.browser)n="utf-8";else if(commonjsGlobal.process&&commonjsGlobal.process.version){var r=parseInt(browser$1$1.version.split(".")[0].slice(1),10);n=r>=6?"utf-8":"binary"}else n="utf-8";return defaultEncoding_1=n,defaultEncoding_1}var toBuffer$1,hasRequiredToBuffer;function requireToBuffer(){if(hasRequiredToBuffer)return toBuffer$1;hasRequiredToBuffer=1;var n=requireSafeBuffer().Buffer;return toBuffer$1=function(r,_,E){if(n.isBuffer(r))return r;if(typeof r=="string")return n.from(r,_);if(ArrayBuffer.isView(r))return n.from(r.buffer);throw new TypeError(E+" must be a string, a Buffer, a typed array or a DataView")},toBuffer$1}var syncBrowser,hasRequiredSyncBrowser;function requireSyncBrowser(){if(hasRequiredSyncBrowser)return syncBrowser;hasRequiredSyncBrowser=1;var n=requireMd5(),r=requireRipemd160(),_=requireSha_js(),E=requireSafeBuffer().Buffer,S=requirePrecondition(),C=requireDefaultEncoding(),A=requireToBuffer(),I=E.alloc(128),B={md5:16,sha1:20,sha224:28,sha256:32,sha384:48,sha512:64,rmd160:20,ripemd160:20};function O(j,z,Z){var X=N(j),Q=j==="sha512"||j==="sha384"?128:64;z.length>Q?z=X(z):z.length<Q&&(z=E.concat([z,I],Q));for(var se=E.allocUnsafe(Q+B[j]),oe=E.allocUnsafe(Q+B[j]),ue=0;ue<Q;ue++)se[ue]=z[ue]^54,oe[ue]=z[ue]^92;var we=E.allocUnsafe(Q+Z+4);se.copy(we,0,0,Q),this.ipad1=we,this.ipad2=se,this.opad=oe,this.alg=j,this.blocksize=Q,this.hash=X,this.size=B[j]}O.prototype.run=function(j,z){j.copy(z,this.blocksize);var Z=this.hash(z);return Z.copy(this.opad,this.blocksize),this.hash(this.opad)};function N(j){function z(X){return _(j).update(X).digest()}function Z(X){return new r().update(X).digest()}return j==="rmd160"||j==="ripemd160"?Z:j==="md5"?n:z}function U(j,z,Z,X,Q){S(Z,X),j=A(j,C,"Password"),z=A(z,C,"Salt"),Q=Q||"sha1";var se=new O(Q,j,z.length),oe=E.allocUnsafe(X),ue=E.allocUnsafe(z.length+4);z.copy(ue,0,0,z.length);for(var we=0,Te=B[Q],xe=Math.ceil(X/Te),Re=1;Re<=xe;Re++){ue.writeUInt32BE(Re,z.length);for(var Ne=se.run(ue,se.ipad1),Fe=Ne,ht=1;ht<Z;ht++){Fe=se.run(Fe,se.ipad2);for(var nt=0;nt<Te;nt++)Ne[nt]^=Fe[nt]}Ne.copy(oe,we),we+=Te}return oe}return syncBrowser=U,syncBrowser}var async,hasRequiredAsync;function requireAsync(){if(hasRequiredAsync)return async;hasRequiredAsync=1;var n=requireSafeBuffer().Buffer,r=requirePrecondition(),_=requireDefaultEncoding(),E=requireSyncBrowser(),S=requireToBuffer(),C,A=commonjsGlobal.crypto&&commonjsGlobal.crypto.subtle,I={sha:"SHA-1","sha-1":"SHA-1",sha1:"SHA-1",sha256:"SHA-256","sha-256":"SHA-256",sha384:"SHA-384","sha-384":"SHA-384","sha-512":"SHA-512",sha512:"SHA-512"},B=[];function O(Z){if(commonjsGlobal.process&&!commonjsGlobal.process.browser||!A||!A.importKey||!A.deriveBits)return Promise.resolve(!1);if(B[Z]!==void 0)return B[Z];C=C||n.alloc(8);var X=j(C,C,10,128,Z).then(function(){return!0}).catch(function(){return!1});return B[Z]=X,X}var N;function U(){return N||(commonjsGlobal.process&&commonjsGlobal.process.nextTick?N=commonjsGlobal.process.nextTick:commonjsGlobal.queueMicrotask?N=commonjsGlobal.queueMicrotask:commonjsGlobal.setImmediate?N=commonjsGlobal.setImmediate:N=commonjsGlobal.setTimeout,N)}function j(Z,X,Q,se,oe){return A.importKey("raw",Z,{name:"PBKDF2"},!1,["deriveBits"]).then(function(ue){return A.deriveBits({name:"PBKDF2",salt:X,iterations:Q,hash:{name:oe}},ue,se<<3)}).then(function(ue){return n.from(ue)})}function z(Z,X){Z.then(function(Q){U()(function(){X(null,Q)})},function(Q){U()(function(){X(Q)})})}return async=function(Z,X,Q,se,oe,ue){typeof oe=="function"&&(ue=oe,oe=void 0),oe=oe||"sha1";var we=I[oe.toLowerCase()];if(!we||typeof commonjsGlobal.Promise!="function"){U()(function(){var Te;try{Te=E(Z,X,Q,se,oe)}catch(xe){return ue(xe)}ue(null,Te)});return}if(r(Q,se),Z=S(Z,_,"Password"),X=S(X,_,"Salt"),typeof ue!="function")throw new Error("No callback provided to pbkdf2");z(O(we).then(function(Te){return Te?j(Z,X,Q,se,we):E(Z,X,Q,se,oe)}),ue)},async}var hasRequiredBrowser$7;function requireBrowser$7(){return hasRequiredBrowser$7||(hasRequiredBrowser$7=1,browser$b.pbkdf2=requireAsync(),browser$b.pbkdf2Sync=requireSyncBrowser()),browser$b}var browser$a={},des$1={},utils$4={},hasRequiredUtils$3;function requireUtils$3(){if(hasRequiredUtils$3)return utils$4;hasRequiredUtils$3=1,utils$4.readUInt32BE=function(S,C){var A=S[0+C]<<24|S[1+C]<<16|S[2+C]<<8|S[3+C];return A>>>0},utils$4.writeUInt32BE=function(S,C,A){S[0+A]=C>>>24,S[1+A]=C>>>16&255,S[2+A]=C>>>8&255,S[3+A]=C&255},utils$4.ip=function(S,C,A,I){for(var B=0,O=0,N=6;N>=0;N-=2){for(var U=0;U<=24;U+=8)B<<=1,B|=C>>>U+N&1;for(var U=0;U<=24;U+=8)B<<=1,B|=S>>>U+N&1}for(var N=6;N>=0;N-=2){for(var U=1;U<=25;U+=8)O<<=1,O|=C>>>U+N&1;for(var U=1;U<=25;U+=8)O<<=1,O|=S>>>U+N&1}A[I+0]=B>>>0,A[I+1]=O>>>0},utils$4.rip=function(S,C,A,I){for(var B=0,O=0,N=0;N<4;N++)for(var U=24;U>=0;U-=8)B<<=1,B|=C>>>U+N&1,B<<=1,B|=S>>>U+N&1;for(var N=4;N<8;N++)for(var U=24;U>=0;U-=8)O<<=1,O|=C>>>U+N&1,O<<=1,O|=S>>>U+N&1;A[I+0]=B>>>0,A[I+1]=O>>>0},utils$4.pc1=function(S,C,A,I){for(var B=0,O=0,N=7;N>=5;N--){for(var U=0;U<=24;U+=8)B<<=1,B|=C>>U+N&1;for(var U=0;U<=24;U+=8)B<<=1,B|=S>>U+N&1}for(var U=0;U<=24;U+=8)B<<=1,B|=C>>U+N&1;for(var N=1;N<=3;N++){for(var U=0;U<=24;U+=8)O<<=1,O|=C>>U+N&1;for(var U=0;U<=24;U+=8)O<<=1,O|=S>>U+N&1}for(var U=0;U<=24;U+=8)O<<=1,O|=S>>U+N&1;A[I+0]=B>>>0,A[I+1]=O>>>0},utils$4.r28shl=function(S,C){return S<<C&268435455|S>>>28-C};var n=[14,11,17,4,27,23,25,0,13,22,7,18,5,9,16,24,2,20,12,21,1,8,15,26,15,4,25,19,9,1,26,16,5,11,23,8,12,7,17,0,22,3,10,14,6,20,27,24];utils$4.pc2=function(S,C,A,I){for(var B=0,O=0,N=n.length>>>1,U=0;U<N;U++)B<<=1,B|=S>>>n[U]&1;for(var U=N;U<n.length;U++)O<<=1,O|=C>>>n[U]&1;A[I+0]=B>>>0,A[I+1]=O>>>0},utils$4.expand=function(S,C,A){var I=0,B=0;I=(S&1)<<5|S>>>27;for(var O=23;O>=15;O-=4)I<<=6,I|=S>>>O&63;for(var O=11;O>=3;O-=4)B|=S>>>O&63,B<<=6;B|=(S&31)<<1|S>>>31,C[A+0]=I>>>0,C[A+1]=B>>>0};var r=[14,0,4,15,13,7,1,4,2,14,15,2,11,13,8,1,3,10,10,6,6,12,12,11,5,9,9,5,0,3,7,8,4,15,1,12,14,8,8,2,13,4,6,9,2,1,11,7,15,5,12,11,9,3,7,14,3,10,10,0,5,6,0,13,15,3,1,13,8,4,14,7,6,15,11,2,3,8,4,14,9,12,7,0,2,1,13,10,12,6,0,9,5,11,10,5,0,13,14,8,7,10,11,1,10,3,4,15,13,4,1,2,5,11,8,6,12,7,6,12,9,0,3,5,2,14,15,9,10,13,0,7,9,0,14,9,6,3,3,4,15,6,5,10,1,2,13,8,12,5,7,14,11,12,4,11,2,15,8,1,13,1,6,10,4,13,9,0,8,6,15,9,3,8,0,7,11,4,1,15,2,14,12,3,5,11,10,5,14,2,7,12,7,13,13,8,14,11,3,5,0,6,6,15,9,0,10,3,1,4,2,7,8,2,5,12,11,1,12,10,4,14,15,9,10,3,6,15,9,0,0,6,12,10,11,1,7,13,13,8,15,9,1,4,3,5,14,11,5,12,2,7,8,2,4,14,2,14,12,11,4,2,1,12,7,4,10,7,11,13,6,1,8,5,5,0,3,15,15,10,13,3,0,9,14,8,9,6,4,11,2,8,1,12,11,7,10,1,13,14,7,2,8,13,15,6,9,15,12,0,5,9,6,10,3,4,0,5,14,3,12,10,1,15,10,4,15,2,9,7,2,12,6,9,8,5,0,6,13,1,3,13,4,14,14,0,7,11,5,3,11,8,9,4,14,3,15,2,5,12,2,9,8,5,12,15,3,10,7,11,0,14,4,1,10,7,1,6,13,0,11,8,6,13,4,13,11,0,2,11,14,7,15,4,0,9,8,1,13,10,3,14,12,3,9,5,7,12,5,2,10,15,6,8,1,6,1,6,4,11,11,13,13,8,12,1,3,4,7,10,14,7,10,9,15,5,6,0,8,15,0,14,5,2,9,3,2,12,13,1,2,15,8,13,4,8,6,10,15,3,11,7,1,4,10,12,9,5,3,6,14,11,5,0,0,14,12,9,7,2,7,2,11,1,4,14,1,7,9,4,12,10,14,8,2,13,0,15,6,12,10,9,13,0,15,3,3,5,5,6,8,11];utils$4.substitute=function(S,C){for(var A=0,I=0;I<4;I++){var B=S>>>18-I*6&63,O=r[I*64+B];A<<=4,A|=O}for(var I=0;I<4;I++){var B=C>>>18-I*6&63,O=r[4*64+I*64+B];A<<=4,A|=O}return A>>>0};var _=[16,25,12,11,3,20,4,15,31,17,9,6,27,14,1,22,30,24,8,18,0,5,29,23,13,19,2,26,10,21,28,7];return utils$4.permute=function(S){for(var C=0,A=0;A<_.length;A++)C<<=1,C|=S>>>_[A]&1;return C>>>0},utils$4.padSplit=function(S,C,A){for(var I=S.toString(2);I.length<C;)I="0"+I;for(var B=[],O=0;O<C;O+=A)B.push(I.slice(O,O+A));return B.join(" ")},utils$4}var minimalisticAssert,hasRequiredMinimalisticAssert;function requireMinimalisticAssert(){if(hasRequiredMinimalisticAssert)return minimalisticAssert;hasRequiredMinimalisticAssert=1,minimalisticAssert=n;function n(r,_){if(!r)throw new Error(_||"Assertion failed")}return n.equal=function(_,E,S){if(_!=E)throw new Error(S||"Assertion failed: "+_+" != "+E)},minimalisticAssert}var cipher,hasRequiredCipher;function requireCipher(){if(hasRequiredCipher)return cipher;hasRequiredCipher=1;var n=requireMinimalisticAssert();function r(_){this.options=_,this.type=this.options.type,this.blockSize=8,this._init(),this.buffer=new Array(this.blockSize),this.bufferOff=0,this.padding=_.padding!==!1}return cipher=r,r.prototype._init=function(){},r.prototype.update=function(E){return E.length===0?[]:this.type==="decrypt"?this._updateDecrypt(E):this._updateEncrypt(E)},r.prototype._buffer=function(E,S){for(var C=Math.min(this.buffer.length-this.bufferOff,E.length-S),A=0;A<C;A++)this.buffer[this.bufferOff+A]=E[S+A];return this.bufferOff+=C,C},r.prototype._flushBuffer=function(E,S){return this._update(this.buffer,0,E,S),this.bufferOff=0,this.blockSize},r.prototype._updateEncrypt=function(E){var S=0,C=0,A=(this.bufferOff+E.length)/this.blockSize|0,I=new Array(A*this.blockSize);this.bufferOff!==0&&(S+=this._buffer(E,S),this.bufferOff===this.buffer.length&&(C+=this._flushBuffer(I,C)));for(var B=E.length-(E.length-S)%this.blockSize;S<B;S+=this.blockSize)this._update(E,S,I,C),C+=this.blockSize;for(;S<E.length;S++,this.bufferOff++)this.buffer[this.bufferOff]=E[S];return I},r.prototype._updateDecrypt=function(E){for(var S=0,C=0,A=Math.ceil((this.bufferOff+E.length)/this.blockSize)-1,I=new Array(A*this.blockSize);A>0;A--)S+=this._buffer(E,S),C+=this._flushBuffer(I,C);return S+=this._buffer(E,S),I},r.prototype.final=function(E){var S;E&&(S=this.update(E));var C;return this.type==="encrypt"?C=this._finalEncrypt():C=this._finalDecrypt(),S?S.concat(C):C},r.prototype._pad=function(E,S){if(S===0)return!1;for(;S<E.length;)E[S++]=0;return!0},r.prototype._finalEncrypt=function(){if(!this._pad(this.buffer,this.bufferOff))return[];var E=new Array(this.blockSize);return this._update(this.buffer,0,E,0),E},r.prototype._unpad=function(E){return E},r.prototype._finalDecrypt=function(){n.equal(this.bufferOff,this.blockSize,"Not enough data to decrypt");var E=new Array(this.blockSize);return this._flushBuffer(E,0),this._unpad(E)},cipher}var des,hasRequiredDes$1;function requireDes$1(){if(hasRequiredDes$1)return des;hasRequiredDes$1=1;var n=requireMinimalisticAssert(),r=inherits_browserExports,_=requireUtils$3(),E=requireCipher();function S(){this.tmp=new Array(2),this.keys=null}function C(I){E.call(this,I);var B=new S;this._desState=B,this.deriveKeys(B,I.key)}r(C,E),des=C,C.create=function(B){return new C(B)};var A=[1,1,2,2,2,2,2,2,1,2,2,2,2,2,2,1];return C.prototype.deriveKeys=function(B,O){B.keys=new Array(16*2),n.equal(O.length,this.blockSize,"Invalid key length");var N=_.readUInt32BE(O,0),U=_.readUInt32BE(O,4);_.pc1(N,U,B.tmp,0),N=B.tmp[0],U=B.tmp[1];for(var j=0;j<B.keys.length;j+=2){var z=A[j>>>1];N=_.r28shl(N,z),U=_.r28shl(U,z),_.pc2(N,U,B.keys,j)}},C.prototype._update=function(B,O,N,U){var j=this._desState,z=_.readUInt32BE(B,O),Z=_.readUInt32BE(B,O+4);_.ip(z,Z,j.tmp,0),z=j.tmp[0],Z=j.tmp[1],this.type==="encrypt"?this._encrypt(j,z,Z,j.tmp,0):this._decrypt(j,z,Z,j.tmp,0),z=j.tmp[0],Z=j.tmp[1],_.writeUInt32BE(N,z,U),_.writeUInt32BE(N,Z,U+4)},C.prototype._pad=function(B,O){if(this.padding===!1)return!1;for(var N=B.length-O,U=O;U<B.length;U++)B[U]=N;return!0},C.prototype._unpad=function(B){if(this.padding===!1)return B;for(var O=B[B.length-1],N=B.length-O;N<B.length;N++)n.equal(B[N],O);return B.slice(0,B.length-O)},C.prototype._encrypt=function(B,O,N,U,j){for(var z=O,Z=N,X=0;X<B.keys.length;X+=2){var Q=B.keys[X],se=B.keys[X+1];_.expand(Z,B.tmp,0),Q^=B.tmp[0],se^=B.tmp[1];var oe=_.substitute(Q,se),ue=_.permute(oe),we=Z;Z=(z^ue)>>>0,z=we}_.rip(Z,z,U,j)},C.prototype._decrypt=function(B,O,N,U,j){for(var z=N,Z=O,X=B.keys.length-2;X>=0;X-=2){var Q=B.keys[X],se=B.keys[X+1];_.expand(z,B.tmp,0),Q^=B.tmp[0],se^=B.tmp[1];var oe=_.substitute(Q,se),ue=_.permute(oe),we=z;z=(Z^ue)>>>0,Z=we}_.rip(z,Z,U,j)},des}var cbc$1={},hasRequiredCbc$1;function requireCbc$1(){if(hasRequiredCbc$1)return cbc$1;hasRequiredCbc$1=1;var n=requireMinimalisticAssert(),r=inherits_browserExports,_={};function E(C){n.equal(C.length,8,"Invalid IV length"),this.iv=new Array(8);for(var A=0;A<this.iv.length;A++)this.iv[A]=C[A]}function S(C){function A(N){C.call(this,N),this._cbcInit()}r(A,C);for(var I=Object.keys(_),B=0;B<I.length;B++){var O=I[B];A.prototype[O]=_[O]}return A.create=function(U){return new A(U)},A}return cbc$1.instantiate=S,_._cbcInit=function(){var A=new E(this.options.iv);this._cbcState=A},_._update=function(A,I,B,O){var N=this._cbcState,U=this.constructor.super_.prototype,j=N.iv;if(this.type==="encrypt"){for(var z=0;z<this.blockSize;z++)j[z]^=A[I+z];U._update.call(this,j,0,B,O);for(var z=0;z<this.blockSize;z++)j[z]=B[O+z]}else{U._update.call(this,A,I,B,O);for(var z=0;z<this.blockSize;z++)B[O+z]^=j[z];for(var z=0;z<this.blockSize;z++)j[z]=A[I+z]}},cbc$1}var ede,hasRequiredEde;function requireEde(){if(hasRequiredEde)return ede;hasRequiredEde=1;var n=requireMinimalisticAssert(),r=inherits_browserExports,_=requireCipher(),E=requireDes$1();function S(A,I){n.equal(I.length,24,"Invalid key length");var B=I.slice(0,8),O=I.slice(8,16),N=I.slice(16,24);A==="encrypt"?this.ciphers=[E.create({type:"encrypt",key:B}),E.create({type:"decrypt",key:O}),E.create({type:"encrypt",key:N})]:this.ciphers=[E.create({type:"decrypt",key:N}),E.create({type:"encrypt",key:O}),E.create({type:"decrypt",key:B})]}function C(A){_.call(this,A);var I=new S(this.type,this.options.key);this._edeState=I}return r(C,_),ede=C,C.create=function(I){return new C(I)},C.prototype._update=function(I,B,O,N){var U=this._edeState;U.ciphers[0]._update(I,B,O,N),U.ciphers[1]._update(O,N,O,N),U.ciphers[2]._update(O,N,O,N)},C.prototype._pad=E.prototype._pad,C.prototype._unpad=E.prototype._unpad,ede}var hasRequiredDes;function requireDes(){return hasRequiredDes||(hasRequiredDes=1,des$1.utils=requireUtils$3(),des$1.Cipher=requireCipher(),des$1.DES=requireDes$1(),des$1.CBC=requireCbc$1(),des$1.EDE=requireEde()),des$1}var browserifyDes,hasRequiredBrowserifyDes;function requireBrowserifyDes(){if(hasRequiredBrowserifyDes)return browserifyDes;hasRequiredBrowserifyDes=1;var n=requireCipherBase(),r=requireDes(),_=inherits_browserExports,E=requireSafeBuffer().Buffer,S={"des-ede3-cbc":r.CBC.instantiate(r.EDE),"des-ede3":r.EDE,"des-ede-cbc":r.CBC.instantiate(r.EDE),"des-ede":r.EDE,"des-cbc":r.CBC.instantiate(r.DES),"des-ecb":r.DES};S.des=S["des-cbc"],S.des3=S["des-ede3-cbc"],browserifyDes=C,_(C,n);function C(A){n.call(this);var I=A.mode.toLowerCase(),B=S[I],O;A.decrypt?O="decrypt":O="encrypt";var N=A.key;E.isBuffer(N)||(N=E.from(N)),(I==="des-ede"||I==="des-ede-cbc")&&(N=E.concat([N,N.slice(0,8)]));var U=A.iv;E.isBuffer(U)||(U=E.from(U)),this._des=B.create({key:N,iv:U,type:O})}return C.prototype._update=function(A){return E.from(this._des.update(A))},C.prototype._final=function(){return E.from(this._des.final())},browserifyDes}var browser$9={},encrypter={},ecb={},hasRequiredEcb;function requireEcb(){return hasRequiredEcb||(hasRequiredEcb=1,ecb.encrypt=function(n,r){return n._cipher.encryptBlock(r)},ecb.decrypt=function(n,r){return n._cipher.decryptBlock(r)}),ecb}var cbc={},bufferXor,hasRequiredBufferXor;function requireBufferXor(){return hasRequiredBufferXor||(hasRequiredBufferXor=1,bufferXor=function(r,_){for(var E=Math.min(r.length,_.length),S=new Buffer$4(E),C=0;C<E;++C)S[C]=r[C]^_[C];return S}),bufferXor}var hasRequiredCbc;function requireCbc(){if(hasRequiredCbc)return cbc;hasRequiredCbc=1;var n=requireBufferXor();return cbc.encrypt=function(r,_){var E=n(_,r._prev);return r._prev=r._cipher.encryptBlock(E),r._prev},cbc.decrypt=function(r,_){var E=r._prev;r._prev=_;var S=r._cipher.decryptBlock(_);return n(S,E)},cbc}var cfb={},hasRequiredCfb;function requireCfb(){if(hasRequiredCfb)return cfb;hasRequiredCfb=1;var n=requireSafeBuffer().Buffer,r=requireBufferXor();function _(E,S,C){var A=S.length,I=r(S,E._cache);return E._cache=E._cache.slice(A),E._prev=n.concat([E._prev,C?S:I]),I}return cfb.encrypt=function(E,S,C){for(var A=n.allocUnsafe(0),I;S.length;)if(E._cache.length===0&&(E._cache=E._cipher.encryptBlock(E._prev),E._prev=n.allocUnsafe(0)),E._cache.length<=S.length)I=E._cache.length,A=n.concat([A,_(E,S.slice(0,I),C)]),S=S.slice(I);else{A=n.concat([A,_(E,S,C)]);break}return A},cfb}var cfb8={},hasRequiredCfb8;function requireCfb8(){if(hasRequiredCfb8)return cfb8;hasRequiredCfb8=1;var n=requireSafeBuffer().Buffer;function r(_,E,S){var C=_._cipher.encryptBlock(_._prev),A=C[0]^E;return _._prev=n.concat([_._prev.slice(1),n.from([S?E:A])]),A}return cfb8.encrypt=function(_,E,S){for(var C=E.length,A=n.allocUnsafe(C),I=-1;++I<C;)A[I]=r(_,E[I],S);return A},cfb8}var cfb1={},hasRequiredCfb1;function requireCfb1(){if(hasRequiredCfb1)return cfb1;hasRequiredCfb1=1;var n=requireSafeBuffer().Buffer;function r(E,S,C){for(var A,I=-1,B=8,O=0,N,U;++I<B;)A=E._cipher.encryptBlock(E._prev),N=S&1<<7-I?128:0,U=A[0]^N,O+=(U&128)>>I%8,E._prev=_(E._prev,C?N:U);return O}function _(E,S){var C=E.length,A=-1,I=n.allocUnsafe(E.length);for(E=n.concat([E,n.from([S])]);++A<C;)I[A]=E[A]<<1|E[A+1]>>7;return I}return cfb1.encrypt=function(E,S,C){for(var A=S.length,I=n.allocUnsafe(A),B=-1;++B<A;)I[B]=r(E,S[B],C);return I},cfb1}var ofb={},hasRequiredOfb;function requireOfb(){if(hasRequiredOfb)return ofb;hasRequiredOfb=1;var n=requireBufferXor();function r(_){return _._prev=_._cipher.encryptBlock(_._prev),_._prev}return ofb.encrypt=function(_,E){for(;_._cache.length<E.length;)_._cache=Buffer$4.concat([_._cache,r(_)]);var S=_._cache.slice(0,E.length);return _._cache=_._cache.slice(E.length),n(E,S)},ofb}var ctr={},incr32_1,hasRequiredIncr32;function requireIncr32(){if(hasRequiredIncr32)return incr32_1;hasRequiredIncr32=1;function n(r){for(var _=r.length,E;_--;)if(E=r.readUInt8(_),E===255)r.writeUInt8(0,_);else{E++,r.writeUInt8(E,_);break}}return incr32_1=n,incr32_1}var hasRequiredCtr;function requireCtr(){if(hasRequiredCtr)return ctr;hasRequiredCtr=1;var n=requireBufferXor(),r=requireSafeBuffer().Buffer,_=requireIncr32();function E(C){var A=C._cipher.encryptBlockRaw(C._prev);return _(C._prev),A}var S=16;return ctr.encrypt=function(C,A){var I=Math.ceil(A.length/S),B=C._cache.length;C._cache=r.concat([C._cache,r.allocUnsafe(I*S)]);for(var O=0;O<I;O++){var N=E(C),U=B+O*S;C._cache.writeUInt32BE(N[0],U+0),C._cache.writeUInt32BE(N[1],U+4),C._cache.writeUInt32BE(N[2],U+8),C._cache.writeUInt32BE(N[3],U+12)}var j=C._cache.slice(0,A.length);return C._cache=C._cache.slice(A.length),n(A,j)},ctr}const aes128={cipher:"AES",key:128,iv:16,mode:"CBC",type:"block"},aes192={cipher:"AES",key:192,iv:16,mode:"CBC",type:"block"},aes256={cipher:"AES",key:256,iv:16,mode:"CBC",type:"block"},require$$2={"aes-128-ecb":{cipher:"AES",key:128,iv:0,mode:"ECB",type:"block"},"aes-192-ecb":{cipher:"AES",key:192,iv:0,mode:"ECB",type:"block"},"aes-256-ecb":{cipher:"AES",key:256,iv:0,mode:"ECB",type:"block"},"aes-128-cbc":{cipher:"AES",key:128,iv:16,mode:"CBC",type:"block"},"aes-192-cbc":{cipher:"AES",key:192,iv:16,mode:"CBC",type:"block"},"aes-256-cbc":{cipher:"AES",key:256,iv:16,mode:"CBC",type:"block"},aes128,aes192,aes256,"aes-128-cfb":{cipher:"AES",key:128,iv:16,mode:"CFB",type:"stream"},"aes-192-cfb":{cipher:"AES",key:192,iv:16,mode:"CFB",type:"stream"},"aes-256-cfb":{cipher:"AES",key:256,iv:16,mode:"CFB",type:"stream"},"aes-128-cfb8":{cipher:"AES",key:128,iv:16,mode:"CFB8",type:"stream"},"aes-192-cfb8":{cipher:"AES",key:192,iv:16,mode:"CFB8",type:"stream"},"aes-256-cfb8":{cipher:"AES",key:256,iv:16,mode:"CFB8",type:"stream"},"aes-128-cfb1":{cipher:"AES",key:128,iv:16,mode:"CFB1",type:"stream"},"aes-192-cfb1":{cipher:"AES",key:192,iv:16,mode:"CFB1",type:"stream"},"aes-256-cfb1":{cipher:"AES",key:256,iv:16,mode:"CFB1",type:"stream"},"aes-128-ofb":{cipher:"AES",key:128,iv:16,mode:"OFB",type:"stream"},"aes-192-ofb":{cipher:"AES",key:192,iv:16,mode:"OFB",type:"stream"},"aes-256-ofb":{cipher:"AES",key:256,iv:16,mode:"OFB",type:"stream"},"aes-128-ctr":{cipher:"AES",key:128,iv:16,mode:"CTR",type:"stream"},"aes-192-ctr":{cipher:"AES",key:192,iv:16,mode:"CTR",type:"stream"},"aes-256-ctr":{cipher:"AES",key:256,iv:16,mode:"CTR",type:"stream"},"aes-128-gcm":{cipher:"AES",key:128,iv:12,mode:"GCM",type:"auth"},"aes-192-gcm":{cipher:"AES",key:192,iv:12,mode:"GCM",type:"auth"},"aes-256-gcm":{cipher:"AES",key:256,iv:12,mode:"GCM",type:"auth"}};var modes_1,hasRequiredModes$1;function requireModes$1(){if(hasRequiredModes$1)return modes_1;hasRequiredModes$1=1;var n={ECB:requireEcb(),CBC:requireCbc(),CFB:requireCfb(),CFB8:requireCfb8(),CFB1:requireCfb1(),OFB:requireOfb(),CTR:requireCtr(),GCM:requireCtr()},r=require$$2;for(var _ in r)r[_].module=n[r[_].mode];return modes_1=r,modes_1}var aes={},hasRequiredAes;function requireAes(){if(hasRequiredAes)return aes;hasRequiredAes=1;var n=requireSafeBuffer().Buffer;function r(I){n.isBuffer(I)||(I=n.from(I));for(var B=I.length/4|0,O=new Array(B),N=0;N<B;N++)O[N]=I.readUInt32BE(N*4);return O}function _(I){for(var B=0;B<I.length;I++)I[B]=0}function E(I,B,O,N,U){for(var j=O[0],z=O[1],Z=O[2],X=O[3],Q=I[0]^B[0],se=I[1]^B[1],oe=I[2]^B[2],ue=I[3]^B[3],we,Te,xe,Re,Ne=4,Fe=1;Fe<U;Fe++)we=j[Q>>>24]^z[se>>>16&255]^Z[oe>>>8&255]^X[ue&255]^B[Ne++],Te=j[se>>>24]^z[oe>>>16&255]^Z[ue>>>8&255]^X[Q&255]^B[Ne++],xe=j[oe>>>24]^z[ue>>>16&255]^Z[Q>>>8&255]^X[se&255]^B[Ne++],Re=j[ue>>>24]^z[Q>>>16&255]^Z[se>>>8&255]^X[oe&255]^B[Ne++],Q=we,se=Te,oe=xe,ue=Re;return we=(N[Q>>>24]<<24|N[se>>>16&255]<<16|N[oe>>>8&255]<<8|N[ue&255])^B[Ne++],Te=(N[se>>>24]<<24|N[oe>>>16&255]<<16|N[ue>>>8&255]<<8|N[Q&255])^B[Ne++],xe=(N[oe>>>24]<<24|N[ue>>>16&255]<<16|N[Q>>>8&255]<<8|N[se&255])^B[Ne++],Re=(N[ue>>>24]<<24|N[Q>>>16&255]<<16|N[se>>>8&255]<<8|N[oe&255])^B[Ne++],we=we>>>0,Te=Te>>>0,xe=xe>>>0,Re=Re>>>0,[we,Te,xe,Re]}var S=[0,1,2,4,8,16,32,64,128,27,54],C=function(){for(var I=new Array(256),B=0;B<256;B++)B<128?I[B]=B<<1:I[B]=B<<1^283;for(var O=[],N=[],U=[[],[],[],[]],j=[[],[],[],[]],z=0,Z=0,X=0;X<256;++X){var Q=Z^Z<<1^Z<<2^Z<<3^Z<<4;Q=Q>>>8^Q&255^99,O[z]=Q,N[Q]=z;var se=I[z],oe=I[se],ue=I[oe],we=I[Q]*257^Q*16843008;U[0][z]=we<<24|we>>>8,U[1][z]=we<<16|we>>>16,U[2][z]=we<<8|we>>>24,U[3][z]=we,we=ue*16843009^oe*65537^se*257^z*16843008,j[0][Q]=we<<24|we>>>8,j[1][Q]=we<<16|we>>>16,j[2][Q]=we<<8|we>>>24,j[3][Q]=we,z===0?z=Z=1:(z=se^I[I[I[ue^se]]],Z^=I[I[Z]])}return{SBOX:O,INV_SBOX:N,SUB_MIX:U,INV_SUB_MIX:j}}();function A(I){this._key=r(I),this._reset()}return A.blockSize=4*4,A.keySize=256/8,A.prototype.blockSize=A.blockSize,A.prototype.keySize=A.keySize,A.prototype._reset=function(){for(var I=this._key,B=I.length,O=B+6,N=(O+1)*4,U=[],j=0;j<B;j++)U[j]=I[j];for(j=B;j<N;j++){var z=U[j-1];j%B===0?(z=z<<8|z>>>24,z=C.SBOX[z>>>24]<<24|C.SBOX[z>>>16&255]<<16|C.SBOX[z>>>8&255]<<8|C.SBOX[z&255],z^=S[j/B|0]<<24):B>6&&j%B===4&&(z=C.SBOX[z>>>24]<<24|C.SBOX[z>>>16&255]<<16|C.SBOX[z>>>8&255]<<8|C.SBOX[z&255]),U[j]=U[j-B]^z}for(var Z=[],X=0;X<N;X++){var Q=N-X,se=U[Q-(X%4?0:4)];X<4||Q<=4?Z[X]=se:Z[X]=C.INV_SUB_MIX[0][C.SBOX[se>>>24]]^C.INV_SUB_MIX[1][C.SBOX[se>>>16&255]]^C.INV_SUB_MIX[2][C.SBOX[se>>>8&255]]^C.INV_SUB_MIX[3][C.SBOX[se&255]]}this._nRounds=O,this._keySchedule=U,this._invKeySchedule=Z},A.prototype.encryptBlockRaw=function(I){return I=r(I),E(I,this._keySchedule,C.SUB_MIX,C.SBOX,this._nRounds)},A.prototype.encryptBlock=function(I){var B=this.encryptBlockRaw(I),O=n.allocUnsafe(16);return O.writeUInt32BE(B[0],0),O.writeUInt32BE(B[1],4),O.writeUInt32BE(B[2],8),O.writeUInt32BE(B[3],12),O},A.prototype.decryptBlock=function(I){I=r(I);var B=I[1];I[1]=I[3],I[3]=B;var O=E(I,this._invKeySchedule,C.INV_SUB_MIX,C.INV_SBOX,this._nRounds),N=n.allocUnsafe(16);return N.writeUInt32BE(O[0],0),N.writeUInt32BE(O[3],4),N.writeUInt32BE(O[2],8),N.writeUInt32BE(O[1],12),N},A.prototype.scrub=function(){_(this._keySchedule),_(this._invKeySchedule),_(this._key)},aes.AES=A,aes}var ghash,hasRequiredGhash;function requireGhash(){if(hasRequiredGhash)return ghash;hasRequiredGhash=1;var n=requireSafeBuffer().Buffer,r=n.alloc(16,0);function _(C){return[C.readUInt32BE(0),C.readUInt32BE(4),C.readUInt32BE(8),C.readUInt32BE(12)]}function E(C){var A=n.allocUnsafe(16);return A.writeUInt32BE(C[0]>>>0,0),A.writeUInt32BE(C[1]>>>0,4),A.writeUInt32BE(C[2]>>>0,8),A.writeUInt32BE(C[3]>>>0,12),A}function S(C){this.h=C,this.state=n.alloc(16,0),this.cache=n.allocUnsafe(0)}return S.prototype.ghash=function(C){for(var A=-1;++A<C.length;)this.state[A]^=C[A];this._multiply()},S.prototype._multiply=function(){for(var C=_(this.h),A=[0,0,0,0],I,B,O,N=-1;++N<128;){for(B=(this.state[~~(N/8)]&1<<7-N%8)!==0,B&&(A[0]^=C[0],A[1]^=C[1],A[2]^=C[2],A[3]^=C[3]),O=(C[3]&1)!==0,I=3;I>0;I--)C[I]=C[I]>>>1|(C[I-1]&1)<<31;C[0]=C[0]>>>1,O&&(C[0]=C[0]^225<<24)}this.state=E(A)},S.prototype.update=function(C){this.cache=n.concat([this.cache,C]);for(var A;this.cache.length>=16;)A=this.cache.slice(0,16),this.cache=this.cache.slice(16),this.ghash(A)},S.prototype.final=function(C,A){return this.cache.length&&this.ghash(n.concat([this.cache,r],16)),this.ghash(E([0,C,0,A])),this.state},ghash=S,ghash}var authCipher,hasRequiredAuthCipher;function requireAuthCipher(){if(hasRequiredAuthCipher)return authCipher;hasRequiredAuthCipher=1;var n=requireAes(),r=requireSafeBuffer().Buffer,_=requireCipherBase(),E=inherits_browserExports,S=requireGhash(),C=requireBufferXor(),A=requireIncr32();function I(N,U){var j=0;N.length!==U.length&&j++;for(var z=Math.min(N.length,U.length),Z=0;Z<z;++Z)j+=N[Z]^U[Z];return j}function B(N,U,j){if(U.length===12)return N._finID=r.concat([U,r.from([0,0,0,1])]),r.concat([U,r.from([0,0,0,2])]);var z=new S(j),Z=U.length,X=Z%16;z.update(U),X&&(X=16-X,z.update(r.alloc(X,0))),z.update(r.alloc(8,0));var Q=Z*8,se=r.alloc(8);se.writeUIntBE(Q,0,8),z.update(se),N._finID=z.state;var oe=r.from(N._finID);return A(oe),oe}function O(N,U,j,z){_.call(this);var Z=r.alloc(4,0);this._cipher=new n.AES(U);var X=this._cipher.encryptBlock(Z);this._ghash=new S(X),j=B(this,j,X),this._prev=r.from(j),this._cache=r.allocUnsafe(0),this._secCache=r.allocUnsafe(0),this._decrypt=z,this._alen=0,this._len=0,this._mode=N,this._authTag=null,this._called=!1}return E(O,_),O.prototype._update=function(N){if(!this._called&&this._alen){var U=16-this._alen%16;U<16&&(U=r.alloc(U,0),this._ghash.update(U))}this._called=!0;var j=this._mode.encrypt(this,N);return this._decrypt?this._ghash.update(N):this._ghash.update(j),this._len+=N.length,j},O.prototype._final=function(){if(this._decrypt&&!this._authTag)throw new Error("Unsupported state or unable to authenticate data");var N=C(this._ghash.final(this._alen*8,this._len*8),this._cipher.encryptBlock(this._finID));if(this._decrypt&&I(N,this._authTag))throw new Error("Unsupported state or unable to authenticate data");this._authTag=N,this._cipher.scrub()},O.prototype.getAuthTag=function(){if(this._decrypt||!r.isBuffer(this._authTag))throw new Error("Attempting to get auth tag in unsupported state");return this._authTag},O.prototype.setAuthTag=function(U){if(!this._decrypt)throw new Error("Attempting to set auth tag in unsupported state");this._authTag=U},O.prototype.setAAD=function(U){if(this._called)throw new Error("Attempting to set AAD in unsupported state");this._ghash.update(U),this._alen+=U.length},authCipher=O,authCipher}var streamCipher,hasRequiredStreamCipher;function requireStreamCipher(){if(hasRequiredStreamCipher)return streamCipher;hasRequiredStreamCipher=1;var n=requireAes(),r=requireSafeBuffer().Buffer,_=requireCipherBase(),E=inherits_browserExports;function S(C,A,I,B){_.call(this),this._cipher=new n.AES(A),this._prev=r.from(I),this._cache=r.allocUnsafe(0),this._secCache=r.allocUnsafe(0),this._decrypt=B,this._mode=C}return E(S,_),S.prototype._update=function(C){return this._mode.encrypt(this,C,this._decrypt)},S.prototype._final=function(){this._cipher.scrub()},streamCipher=S,streamCipher}var evp_bytestokey,hasRequiredEvp_bytestokey;function requireEvp_bytestokey(){if(hasRequiredEvp_bytestokey)return evp_bytestokey;hasRequiredEvp_bytestokey=1;var n=requireSafeBuffer().Buffer,r=requireMd5_js();function _(E,S,C,A){if(n.isBuffer(E)||(E=n.from(E,"binary")),S&&(n.isBuffer(S)||(S=n.from(S,"binary")),S.length!==8))throw new RangeError("salt should be Buffer with 8 byte length");for(var I=C/8,B=n.alloc(I),O=n.alloc(A||0),N=n.alloc(0);I>0||A>0;){var U=new r;U.update(N),U.update(E),S&&U.update(S),N=U.digest();var j=0;if(I>0){var z=B.length-I;j=Math.min(I,N.length),N.copy(B,z,0,j),I-=j}if(j<N.length&&A>0){var Z=O.length-A,X=Math.min(A,N.length-j);N.copy(O,Z,j,j+X),A-=X}}return N.fill(0),{key:B,iv:O}}return evp_bytestokey=_,evp_bytestokey}var hasRequiredEncrypter;function requireEncrypter(){if(hasRequiredEncrypter)return encrypter;hasRequiredEncrypter=1;var n=requireModes$1(),r=requireAuthCipher(),_=requireSafeBuffer().Buffer,E=requireStreamCipher(),S=requireCipherBase(),C=requireAes(),A=requireEvp_bytestokey(),I=inherits_browserExports;function B(z,Z,X){S.call(this),this._cache=new N,this._cipher=new C.AES(Z),this._prev=_.from(X),this._mode=z,this._autopadding=!0}I(B,S),B.prototype._update=function(z){this._cache.add(z);for(var Z,X,Q=[];Z=this._cache.get();)X=this._mode.encrypt(this,Z),Q.push(X);return _.concat(Q)};var O=_.alloc(16,16);B.prototype._final=function(){var z=this._cache.flush();if(this._autopadding)return z=this._mode.encrypt(this,z),this._cipher.scrub(),z;if(!z.equals(O))throw this._cipher.scrub(),new Error("data not multiple of block length")},B.prototype.setAutoPadding=function(z){return this._autopadding=!!z,this};function N(){this.cache=_.allocUnsafe(0)}N.prototype.add=function(z){this.cache=_.concat([this.cache,z])},N.prototype.get=function(){if(this.cache.length>15){var z=this.cache.slice(0,16);return this.cache=this.cache.slice(16),z}return null},N.prototype.flush=function(){for(var z=16-this.cache.length,Z=_.allocUnsafe(z),X=-1;++X<z;)Z.writeUInt8(z,X);return _.concat([this.cache,Z])};function U(z,Z,X){var Q=n[z.toLowerCase()];if(!Q)throw new TypeError("invalid suite type");if(typeof Z=="string"&&(Z=_.from(Z)),Z.length!==Q.key/8)throw new TypeError("invalid key length "+Z.length);if(typeof X=="string"&&(X=_.from(X)),Q.mode!=="GCM"&&X.length!==Q.iv)throw new TypeError("invalid iv length "+X.length);return Q.type==="stream"?new E(Q.module,Z,X):Q.type==="auth"?new r(Q.module,Z,X):new B(Q.module,Z,X)}function j(z,Z){var X=n[z.toLowerCase()];if(!X)throw new TypeError("invalid suite type");var Q=A(Z,!1,X.key,X.iv);return U(z,Q.key,Q.iv)}return encrypter.createCipheriv=U,encrypter.createCipher=j,encrypter}var decrypter={},hasRequiredDecrypter;function requireDecrypter(){if(hasRequiredDecrypter)return decrypter;hasRequiredDecrypter=1;var n=requireAuthCipher(),r=requireSafeBuffer().Buffer,_=requireModes$1(),E=requireStreamCipher(),S=requireCipherBase(),C=requireAes(),A=requireEvp_bytestokey(),I=inherits_browserExports;function B(z,Z,X){S.call(this),this._cache=new O,this._last=void 0,this._cipher=new C.AES(Z),this._prev=r.from(X),this._mode=z,this._autopadding=!0}I(B,S),B.prototype._update=function(z){this._cache.add(z);for(var Z,X,Q=[];Z=this._cache.get(this._autopadding);)X=this._mode.decrypt(this,Z),Q.push(X);return r.concat(Q)},B.prototype._final=function(){var z=this._cache.flush();if(this._autopadding)return N(this._mode.decrypt(this,z));if(z)throw new Error("data not multiple of block length")},B.prototype.setAutoPadding=function(z){return this._autopadding=!!z,this};function O(){this.cache=r.allocUnsafe(0)}O.prototype.add=function(z){this.cache=r.concat([this.cache,z])},O.prototype.get=function(z){var Z;if(z){if(this.cache.length>16)return Z=this.cache.slice(0,16),this.cache=this.cache.slice(16),Z}else if(this.cache.length>=16)return Z=this.cache.slice(0,16),this.cache=this.cache.slice(16),Z;return null},O.prototype.flush=function(){if(this.cache.length)return this.cache};function N(z){var Z=z[15];if(Z<1||Z>16)throw new Error("unable to decrypt data");for(var X=-1;++X<Z;)if(z[X+(16-Z)]!==Z)throw new Error("unable to decrypt data");if(Z!==16)return z.slice(0,16-Z)}function U(z,Z,X){var Q=_[z.toLowerCase()];if(!Q)throw new TypeError("invalid suite type");if(typeof X=="string"&&(X=r.from(X)),Q.mode!=="GCM"&&X.length!==Q.iv)throw new TypeError("invalid iv length "+X.length);if(typeof Z=="string"&&(Z=r.from(Z)),Z.length!==Q.key/8)throw new TypeError("invalid key length "+Z.length);return Q.type==="stream"?new E(Q.module,Z,X,!0):Q.type==="auth"?new n(Q.module,Z,X,!0):new B(Q.module,Z,X)}function j(z,Z){var X=_[z.toLowerCase()];if(!X)throw new TypeError("invalid suite type");var Q=A(Z,!1,X.key,X.iv);return U(z,Q.key,Q.iv)}return decrypter.createDecipher=j,decrypter.createDecipheriv=U,decrypter}var hasRequiredBrowser$6;function requireBrowser$6(){if(hasRequiredBrowser$6)return browser$9;hasRequiredBrowser$6=1;var n=requireEncrypter(),r=requireDecrypter(),_=require$$2;function E(){return Object.keys(_)}return browser$9.createCipher=browser$9.Cipher=n.createCipher,browser$9.createCipheriv=browser$9.Cipheriv=n.createCipheriv,browser$9.createDecipher=browser$9.Decipher=r.createDecipher,browser$9.createDecipheriv=browser$9.Decipheriv=r.createDecipheriv,browser$9.listCiphers=browser$9.getCiphers=E,browser$9}var modes={},hasRequiredModes;function requireModes(){return hasRequiredModes||(hasRequiredModes=1,function(n){n["des-ecb"]={key:8,iv:0},n["des-cbc"]=n.des={key:8,iv:8},n["des-ede3-cbc"]=n.des3={key:24,iv:8},n["des-ede3"]={key:24,iv:0},n["des-ede-cbc"]={key:16,iv:8},n["des-ede"]={key:16,iv:0}}(modes)),modes}var hasRequiredBrowser$5;function requireBrowser$5(){if(hasRequiredBrowser$5)return browser$a;hasRequiredBrowser$5=1;var n=requireBrowserifyDes(),r=requireBrowser$6(),_=requireModes$1(),E=requireModes(),S=requireEvp_bytestokey();function C(N,U){N=N.toLowerCase();var j,z;if(_[N])j=_[N].key,z=_[N].iv;else if(E[N])j=E[N].key*8,z=E[N].iv;else throw new TypeError("invalid suite type");var Z=S(U,!1,j,z);return I(N,Z.key,Z.iv)}function A(N,U){N=N.toLowerCase();var j,z;if(_[N])j=_[N].key,z=_[N].iv;else if(E[N])j=E[N].key*8,z=E[N].iv;else throw new TypeError("invalid suite type");var Z=S(U,!1,j,z);return B(N,Z.key,Z.iv)}function I(N,U,j){if(N=N.toLowerCase(),_[N])return r.createCipheriv(N,U,j);if(E[N])return new n({key:U,iv:j,mode:N});throw new TypeError("invalid suite type")}function B(N,U,j){if(N=N.toLowerCase(),_[N])return r.createDecipheriv(N,U,j);if(E[N])return new n({key:U,iv:j,mode:N,decrypt:!0});throw new TypeError("invalid suite type")}function O(){return Object.keys(E).concat(r.getCiphers())}return browser$a.createCipher=browser$a.Cipher=C,browser$a.createCipheriv=browser$a.Cipheriv=I,browser$a.createDecipher=browser$a.Decipher=A,browser$a.createDecipheriv=browser$a.Decipheriv=B,browser$a.listCiphers=browser$a.getCiphers=O,browser$a}var browser$8={},bn$1={exports:{}};bn$1.exports;var hasRequiredBn$1;function requireBn$1(){return hasRequiredBn$1||(hasRequiredBn$1=1,function(n){(function(r,_){function E(nt,Ee){if(!nt)throw new Error(Ee||"Assertion failed")}function S(nt,Ee){nt.super_=Ee;var Ce=function(){};Ce.prototype=Ee.prototype,nt.prototype=new Ce,nt.prototype.constructor=nt}function C(nt,Ee,Ce){if(C.isBN(nt))return nt;this.negative=0,this.words=null,this.length=0,this.red=null,nt!==null&&((Ee==="le"||Ee==="be")&&(Ce=Ee,Ee=10),this._init(nt||0,Ee||10,Ce||"be"))}typeof r=="object"?r.exports=C:_.BN=C,C.BN=C,C.wordSize=26;var A;try{typeof window<"u"&&typeof window.Buffer<"u"?A=window.Buffer:A=require$$1$2.Buffer}catch{}C.isBN=function(Ee){return Ee instanceof C?!0:Ee!==null&&typeof Ee=="object"&&Ee.constructor.wordSize===C.wordSize&&Array.isArray(Ee.words)},C.max=function(Ee,Ce){return Ee.cmp(Ce)>0?Ee:Ce},C.min=function(Ee,Ce){return Ee.cmp(Ce)<0?Ee:Ce},C.prototype._init=function(Ee,Ce,_e){if(typeof Ee=="number")return this._initNumber(Ee,Ce,_e);if(typeof Ee=="object")return this._initArray(Ee,Ce,_e);Ce==="hex"&&(Ce=16),E(Ce===(Ce|0)&&Ce>=2&&Ce<=36),Ee=Ee.toString().replace(/\s+/g,"");var Ie=0;Ee[0]==="-"&&(Ie++,this.negative=1),Ie<Ee.length&&(Ce===16?this._parseHex(Ee,Ie,_e):(this._parseBase(Ee,Ce,Ie),_e==="le"&&this._initArray(this.toArray(),Ce,_e)))},C.prototype._initNumber=function(Ee,Ce,_e){Ee<0&&(this.negative=1,Ee=-Ee),Ee<67108864?(this.words=[Ee&67108863],this.length=1):Ee<4503599627370496?(this.words=[Ee&67108863,Ee/67108864&67108863],this.length=2):(E(Ee<9007199254740992),this.words=[Ee&67108863,Ee/67108864&67108863,1],this.length=3),_e==="le"&&this._initArray(this.toArray(),Ce,_e)},C.prototype._initArray=function(Ee,Ce,_e){if(E(typeof Ee.length=="number"),Ee.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(Ee.length/3),this.words=new Array(this.length);for(var Ie=0;Ie<this.length;Ie++)this.words[Ie]=0;var He,Be,Ge=0;if(_e==="be")for(Ie=Ee.length-1,He=0;Ie>=0;Ie-=3)Be=Ee[Ie]|Ee[Ie-1]<<8|Ee[Ie-2]<<16,this.words[He]|=Be<<Ge&67108863,this.words[He+1]=Be>>>26-Ge&67108863,Ge+=24,Ge>=26&&(Ge-=26,He++);else if(_e==="le")for(Ie=0,He=0;Ie<Ee.length;Ie+=3)Be=Ee[Ie]|Ee[Ie+1]<<8|Ee[Ie+2]<<16,this.words[He]|=Be<<Ge&67108863,this.words[He+1]=Be>>>26-Ge&67108863,Ge+=24,Ge>=26&&(Ge-=26,He++);return this.strip()};function I(nt,Ee){var Ce=nt.charCodeAt(Ee);return Ce>=65&&Ce<=70?Ce-55:Ce>=97&&Ce<=102?Ce-87:Ce-48&15}function B(nt,Ee,Ce){var _e=I(nt,Ce);return Ce-1>=Ee&&(_e|=I(nt,Ce-1)<<4),_e}C.prototype._parseHex=function(Ee,Ce,_e){this.length=Math.ceil((Ee.length-Ce)/6),this.words=new Array(this.length);for(var Ie=0;Ie<this.length;Ie++)this.words[Ie]=0;var He=0,Be=0,Ge;if(_e==="be")for(Ie=Ee.length-1;Ie>=Ce;Ie-=2)Ge=B(Ee,Ce,Ie)<<He,this.words[Be]|=Ge&67108863,He>=18?(He-=18,Be+=1,this.words[Be]|=Ge>>>26):He+=8;else{var je=Ee.length-Ce;for(Ie=je%2===0?Ce+1:Ce;Ie<Ee.length;Ie+=2)Ge=B(Ee,Ce,Ie)<<He,this.words[Be]|=Ge&67108863,He>=18?(He-=18,Be+=1,this.words[Be]|=Ge>>>26):He+=8}this.strip()};function O(nt,Ee,Ce,_e){for(var Ie=0,He=Math.min(nt.length,Ce),Be=Ee;Be<He;Be++){var Ge=nt.charCodeAt(Be)-48;Ie*=_e,Ge>=49?Ie+=Ge-49+10:Ge>=17?Ie+=Ge-17+10:Ie+=Ge}return Ie}C.prototype._parseBase=function(Ee,Ce,_e){this.words=[0],this.length=1;for(var Ie=0,He=1;He<=67108863;He*=Ce)Ie++;Ie--,He=He/Ce|0;for(var Be=Ee.length-_e,Ge=Be%Ie,je=Math.min(Be,Be-Ge)+_e,Ve=0,Pe=_e;Pe<je;Pe+=Ie)Ve=O(Ee,Pe,Pe+Ie,Ce),this.imuln(He),this.words[0]+Ve<67108864?this.words[0]+=Ve:this._iaddn(Ve);if(Ge!==0){var Me=1;for(Ve=O(Ee,Pe,Ee.length,Ce),Pe=0;Pe<Ge;Pe++)Me*=Ce;this.imuln(Me),this.words[0]+Ve<67108864?this.words[0]+=Ve:this._iaddn(Ve)}this.strip()},C.prototype.copy=function(Ee){Ee.words=new Array(this.length);for(var Ce=0;Ce<this.length;Ce++)Ee.words[Ce]=this.words[Ce];Ee.length=this.length,Ee.negative=this.negative,Ee.red=this.red},C.prototype.clone=function(){var Ee=new C(null);return this.copy(Ee),Ee},C.prototype._expand=function(Ee){for(;this.length<Ee;)this.words[this.length++]=0;return this},C.prototype.strip=function(){for(;this.length>1&&this.words[this.length-1]===0;)this.length--;return this._normSign()},C.prototype._normSign=function(){return this.length===1&&this.words[0]===0&&(this.negative=0),this},C.prototype.inspect=function(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"};var N=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],U=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],j=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];C.prototype.toString=function(Ee,Ce){Ee=Ee||10,Ce=Ce|0||1;var _e;if(Ee===16||Ee==="hex"){_e="";for(var Ie=0,He=0,Be=0;Be<this.length;Be++){var Ge=this.words[Be],je=((Ge<<Ie|He)&16777215).toString(16);He=Ge>>>24-Ie&16777215,He!==0||Be!==this.length-1?_e=N[6-je.length]+je+_e:_e=je+_e,Ie+=2,Ie>=26&&(Ie-=26,Be--)}for(He!==0&&(_e=He.toString(16)+_e);_e.length%Ce!==0;)_e="0"+_e;return this.negative!==0&&(_e="-"+_e),_e}if(Ee===(Ee|0)&&Ee>=2&&Ee<=36){var Ve=U[Ee],Pe=j[Ee];_e="";var Me=this.clone();for(Me.negative=0;!Me.isZero();){var tt=Me.modn(Pe).toString(Ee);Me=Me.idivn(Pe),Me.isZero()?_e=tt+_e:_e=N[Ve-tt.length]+tt+_e}for(this.isZero()&&(_e="0"+_e);_e.length%Ce!==0;)_e="0"+_e;return this.negative!==0&&(_e="-"+_e),_e}E(!1,"Base should be between 2 and 36")},C.prototype.toNumber=function(){var Ee=this.words[0];return this.length===2?Ee+=this.words[1]*67108864:this.length===3&&this.words[2]===1?Ee+=4503599627370496+this.words[1]*67108864:this.length>2&&E(!1,"Number can only safely store up to 53 bits"),this.negative!==0?-Ee:Ee},C.prototype.toJSON=function(){return this.toString(16)},C.prototype.toBuffer=function(Ee,Ce){return E(typeof A<"u"),this.toArrayLike(A,Ee,Ce)},C.prototype.toArray=function(Ee,Ce){return this.toArrayLike(Array,Ee,Ce)},C.prototype.toArrayLike=function(Ee,Ce,_e){var Ie=this.byteLength(),He=_e||Math.max(1,Ie);E(Ie<=He,"byte array longer than desired length"),E(He>0,"Requested array length <= 0"),this.strip();var Be=Ce==="le",Ge=new Ee(He),je,Ve,Pe=this.clone();if(Be){for(Ve=0;!Pe.isZero();Ve++)je=Pe.andln(255),Pe.iushrn(8),Ge[Ve]=je;for(;Ve<He;Ve++)Ge[Ve]=0}else{for(Ve=0;Ve<He-Ie;Ve++)Ge[Ve]=0;for(Ve=0;!Pe.isZero();Ve++)je=Pe.andln(255),Pe.iushrn(8),Ge[He-Ve-1]=je}return Ge},Math.clz32?C.prototype._countBits=function(Ee){return 32-Math.clz32(Ee)}:C.prototype._countBits=function(Ee){var Ce=Ee,_e=0;return Ce>=4096&&(_e+=13,Ce>>>=13),Ce>=64&&(_e+=7,Ce>>>=7),Ce>=8&&(_e+=4,Ce>>>=4),Ce>=2&&(_e+=2,Ce>>>=2),_e+Ce},C.prototype._zeroBits=function(Ee){if(Ee===0)return 26;var Ce=Ee,_e=0;return Ce&8191||(_e+=13,Ce>>>=13),Ce&127||(_e+=7,Ce>>>=7),Ce&15||(_e+=4,Ce>>>=4),Ce&3||(_e+=2,Ce>>>=2),Ce&1||_e++,_e},C.prototype.bitLength=function(){var Ee=this.words[this.length-1],Ce=this._countBits(Ee);return(this.length-1)*26+Ce};function z(nt){for(var Ee=new Array(nt.bitLength()),Ce=0;Ce<Ee.length;Ce++){var _e=Ce/26|0,Ie=Ce%26;Ee[Ce]=(nt.words[_e]&1<<Ie)>>>Ie}return Ee}C.prototype.zeroBits=function(){if(this.isZero())return 0;for(var Ee=0,Ce=0;Ce<this.length;Ce++){var _e=this._zeroBits(this.words[Ce]);if(Ee+=_e,_e!==26)break}return Ee},C.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},C.prototype.toTwos=function(Ee){return this.negative!==0?this.abs().inotn(Ee).iaddn(1):this.clone()},C.prototype.fromTwos=function(Ee){return this.testn(Ee-1)?this.notn(Ee).iaddn(1).ineg():this.clone()},C.prototype.isNeg=function(){return this.negative!==0},C.prototype.neg=function(){return this.clone().ineg()},C.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},C.prototype.iuor=function(Ee){for(;this.length<Ee.length;)this.words[this.length++]=0;for(var Ce=0;Ce<Ee.length;Ce++)this.words[Ce]=this.words[Ce]|Ee.words[Ce];return this.strip()},C.prototype.ior=function(Ee){return E((this.negative|Ee.negative)===0),this.iuor(Ee)},C.prototype.or=function(Ee){return this.length>Ee.length?this.clone().ior(Ee):Ee.clone().ior(this)},C.prototype.uor=function(Ee){return this.length>Ee.length?this.clone().iuor(Ee):Ee.clone().iuor(this)},C.prototype.iuand=function(Ee){var Ce;this.length>Ee.length?Ce=Ee:Ce=this;for(var _e=0;_e<Ce.length;_e++)this.words[_e]=this.words[_e]&Ee.words[_e];return this.length=Ce.length,this.strip()},C.prototype.iand=function(Ee){return E((this.negative|Ee.negative)===0),this.iuand(Ee)},C.prototype.and=function(Ee){return this.length>Ee.length?this.clone().iand(Ee):Ee.clone().iand(this)},C.prototype.uand=function(Ee){return this.length>Ee.length?this.clone().iuand(Ee):Ee.clone().iuand(this)},C.prototype.iuxor=function(Ee){var Ce,_e;this.length>Ee.length?(Ce=this,_e=Ee):(Ce=Ee,_e=this);for(var Ie=0;Ie<_e.length;Ie++)this.words[Ie]=Ce.words[Ie]^_e.words[Ie];if(this!==Ce)for(;Ie<Ce.length;Ie++)this.words[Ie]=Ce.words[Ie];return this.length=Ce.length,this.strip()},C.prototype.ixor=function(Ee){return E((this.negative|Ee.negative)===0),this.iuxor(Ee)},C.prototype.xor=function(Ee){return this.length>Ee.length?this.clone().ixor(Ee):Ee.clone().ixor(this)},C.prototype.uxor=function(Ee){return this.length>Ee.length?this.clone().iuxor(Ee):Ee.clone().iuxor(this)},C.prototype.inotn=function(Ee){E(typeof Ee=="number"&&Ee>=0);var Ce=Math.ceil(Ee/26)|0,_e=Ee%26;this._expand(Ce),_e>0&&Ce--;for(var Ie=0;Ie<Ce;Ie++)this.words[Ie]=~this.words[Ie]&67108863;return _e>0&&(this.words[Ie]=~this.words[Ie]&67108863>>26-_e),this.strip()},C.prototype.notn=function(Ee){return this.clone().inotn(Ee)},C.prototype.setn=function(Ee,Ce){E(typeof Ee=="number"&&Ee>=0);var _e=Ee/26|0,Ie=Ee%26;return this._expand(_e+1),Ce?this.words[_e]=this.words[_e]|1<<Ie:this.words[_e]=this.words[_e]&~(1<<Ie),this.strip()},C.prototype.iadd=function(Ee){var Ce;if(this.negative!==0&&Ee.negative===0)return this.negative=0,Ce=this.isub(Ee),this.negative^=1,this._normSign();if(this.negative===0&&Ee.negative!==0)return Ee.negative=0,Ce=this.isub(Ee),Ee.negative=1,Ce._normSign();var _e,Ie;this.length>Ee.length?(_e=this,Ie=Ee):(_e=Ee,Ie=this);for(var He=0,Be=0;Be<Ie.length;Be++)Ce=(_e.words[Be]|0)+(Ie.words[Be]|0)+He,this.words[Be]=Ce&67108863,He=Ce>>>26;for(;He!==0&&Be<_e.length;Be++)Ce=(_e.words[Be]|0)+He,this.words[Be]=Ce&67108863,He=Ce>>>26;if(this.length=_e.length,He!==0)this.words[this.length]=He,this.length++;else if(_e!==this)for(;Be<_e.length;Be++)this.words[Be]=_e.words[Be];return this},C.prototype.add=function(Ee){var Ce;return Ee.negative!==0&&this.negative===0?(Ee.negative=0,Ce=this.sub(Ee),Ee.negative^=1,Ce):Ee.negative===0&&this.negative!==0?(this.negative=0,Ce=Ee.sub(this),this.negative=1,Ce):this.length>Ee.length?this.clone().iadd(Ee):Ee.clone().iadd(this)},C.prototype.isub=function(Ee){if(Ee.negative!==0){Ee.negative=0;var Ce=this.iadd(Ee);return Ee.negative=1,Ce._normSign()}else if(this.negative!==0)return this.negative=0,this.iadd(Ee),this.negative=1,this._normSign();var _e=this.cmp(Ee);if(_e===0)return this.negative=0,this.length=1,this.words[0]=0,this;var Ie,He;_e>0?(Ie=this,He=Ee):(Ie=Ee,He=this);for(var Be=0,Ge=0;Ge<He.length;Ge++)Ce=(Ie.words[Ge]|0)-(He.words[Ge]|0)+Be,Be=Ce>>26,this.words[Ge]=Ce&67108863;for(;Be!==0&&Ge<Ie.length;Ge++)Ce=(Ie.words[Ge]|0)+Be,Be=Ce>>26,this.words[Ge]=Ce&67108863;if(Be===0&&Ge<Ie.length&&Ie!==this)for(;Ge<Ie.length;Ge++)this.words[Ge]=Ie.words[Ge];return this.length=Math.max(this.length,Ge),Ie!==this&&(this.negative=1),this.strip()},C.prototype.sub=function(Ee){return this.clone().isub(Ee)};function Z(nt,Ee,Ce){Ce.negative=Ee.negative^nt.negative;var _e=nt.length+Ee.length|0;Ce.length=_e,_e=_e-1|0;var Ie=nt.words[0]|0,He=Ee.words[0]|0,Be=Ie*He,Ge=Be&67108863,je=Be/67108864|0;Ce.words[0]=Ge;for(var Ve=1;Ve<_e;Ve++){for(var Pe=je>>>26,Me=je&67108863,tt=Math.min(Ve,Ee.length-1),Ke=Math.max(0,Ve-nt.length+1);Ke<=tt;Ke++){var mt=Ve-Ke|0;Ie=nt.words[mt]|0,He=Ee.words[Ke]|0,Be=Ie*He+Me,Pe+=Be/67108864|0,Me=Be&67108863}Ce.words[Ve]=Me|0,je=Pe|0}return je!==0?Ce.words[Ve]=je|0:Ce.length--,Ce.strip()}var X=function(Ee,Ce,_e){var Ie=Ee.words,He=Ce.words,Be=_e.words,Ge=0,je,Ve,Pe,Me=Ie[0]|0,tt=Me&8191,Ke=Me>>>13,mt=Ie[1]|0,ct=mt&8191,Qe=mt>>>13,dt=Ie[2]|0,vt=dt&8191,At=dt>>>13,bt=Ie[3]|0,ft=bt&8191,Et=bt>>>13,Ye=Ie[4]|0,Ct=Ye&8191,Pt=Ye>>>13,St=Ie[5]|0,$t=St&8191,kt=St>>>13,Ft=Ie[6]|0,qt=Ft&8191,Mt=Ft>>>13,Wt=Ie[7]|0,Zt=Wt&8191,Yt=Wt>>>13,ur=Ie[8]|0,xt=ur&8191,pt=ur>>>13,yt=Ie[9]|0,Bt=yt&8191,Ht=yt>>>13,nr=He[0]|0,Qt=nr&8191,xr=nr>>>13,kr=He[1]|0,Sr=kr&8191,$r=kr>>>13,Rr=He[2]|0,Dr=Rr&8191,tn=Rr>>>13,Jr=He[3]|0,Pr=Jr&8191,Wr=Jr>>>13,Qr=He[4]|0,Fr=Qr&8191,an=Qr>>>13,cn=He[5]|0,Lr=cn&8191,ln=cn>>>13,fn=He[6]|0,Or=fn&8191,nn=fn>>>13,rn=He[7]|0,Kt=rn&8191,jt=rn>>>13,wt=He[8]|0,Rt=wt&8191,Tt=wt>>>13,Dt=He[9]|0,Ot=Dt&8191,Vt=Dt>>>13;_e.negative=Ee.negative^Ce.negative,_e.length=19,je=Math.imul(tt,Qt),Ve=Math.imul(tt,xr),Ve=Ve+Math.imul(Ke,Qt)|0,Pe=Math.imul(Ke,xr);var Jt=(Ge+je|0)+((Ve&8191)<<13)|0;Ge=(Pe+(Ve>>>13)|0)+(Jt>>>26)|0,Jt&=67108863,je=Math.imul(ct,Qt),Ve=Math.imul(ct,xr),Ve=Ve+Math.imul(Qe,Qt)|0,Pe=Math.imul(Qe,xr),je=je+Math.imul(tt,Sr)|0,Ve=Ve+Math.imul(tt,$r)|0,Ve=Ve+Math.imul(Ke,Sr)|0,Pe=Pe+Math.imul(Ke,$r)|0;var lr=(Ge+je|0)+((Ve&8191)<<13)|0;Ge=(Pe+(Ve>>>13)|0)+(lr>>>26)|0,lr&=67108863,je=Math.imul(vt,Qt),Ve=Math.imul(vt,xr),Ve=Ve+Math.imul(At,Qt)|0,Pe=Math.imul(At,xr),je=je+Math.imul(ct,Sr)|0,Ve=Ve+Math.imul(ct,$r)|0,Ve=Ve+Math.imul(Qe,Sr)|0,Pe=Pe+Math.imul(Qe,$r)|0,je=je+Math.imul(tt,Dr)|0,Ve=Ve+Math.imul(tt,tn)|0,Ve=Ve+Math.imul(Ke,Dr)|0,Pe=Pe+Math.imul(Ke,tn)|0;var tr=(Ge+je|0)+((Ve&8191)<<13)|0;Ge=(Pe+(Ve>>>13)|0)+(tr>>>26)|0,tr&=67108863,je=Math.imul(ft,Qt),Ve=Math.imul(ft,xr),Ve=Ve+Math.imul(Et,Qt)|0,Pe=Math.imul(Et,xr),je=je+Math.imul(vt,Sr)|0,Ve=Ve+Math.imul(vt,$r)|0,Ve=Ve+Math.imul(At,Sr)|0,Pe=Pe+Math.imul(At,$r)|0,je=je+Math.imul(ct,Dr)|0,Ve=Ve+Math.imul(ct,tn)|0,Ve=Ve+Math.imul(Qe,Dr)|0,Pe=Pe+Math.imul(Qe,tn)|0,je=je+Math.imul(tt,Pr)|0,Ve=Ve+Math.imul(tt,Wr)|0,Ve=Ve+Math.imul(Ke,Pr)|0,Pe=Pe+Math.imul(Ke,Wr)|0;var ir=(Ge+je|0)+((Ve&8191)<<13)|0;Ge=(Pe+(Ve>>>13)|0)+(ir>>>26)|0,ir&=67108863,je=Math.imul(Ct,Qt),Ve=Math.imul(Ct,xr),Ve=Ve+Math.imul(Pt,Qt)|0,Pe=Math.imul(Pt,xr),je=je+Math.imul(ft,Sr)|0,Ve=Ve+Math.imul(ft,$r)|0,Ve=Ve+Math.imul(Et,Sr)|0,Pe=Pe+Math.imul(Et,$r)|0,je=je+Math.imul(vt,Dr)|0,Ve=Ve+Math.imul(vt,tn)|0,Ve=Ve+Math.imul(At,Dr)|0,Pe=Pe+Math.imul(At,tn)|0,je=je+Math.imul(ct,Pr)|0,Ve=Ve+Math.imul(ct,Wr)|0,Ve=Ve+Math.imul(Qe,Pr)|0,Pe=Pe+Math.imul(Qe,Wr)|0,je=je+Math.imul(tt,Fr)|0,Ve=Ve+Math.imul(tt,an)|0,Ve=Ve+Math.imul(Ke,Fr)|0,Pe=Pe+Math.imul(Ke,an)|0;var sr=(Ge+je|0)+((Ve&8191)<<13)|0;Ge=(Pe+(Ve>>>13)|0)+(sr>>>26)|0,sr&=67108863,je=Math.imul($t,Qt),Ve=Math.imul($t,xr),Ve=Ve+Math.imul(kt,Qt)|0,Pe=Math.imul(kt,xr),je=je+Math.imul(Ct,Sr)|0,Ve=Ve+Math.imul(Ct,$r)|0,Ve=Ve+Math.imul(Pt,Sr)|0,Pe=Pe+Math.imul(Pt,$r)|0,je=je+Math.imul(ft,Dr)|0,Ve=Ve+Math.imul(ft,tn)|0,Ve=Ve+Math.imul(Et,Dr)|0,Pe=Pe+Math.imul(Et,tn)|0,je=je+Math.imul(vt,Pr)|0,Ve=Ve+Math.imul(vt,Wr)|0,Ve=Ve+Math.imul(At,Pr)|0,Pe=Pe+Math.imul(At,Wr)|0,je=je+Math.imul(ct,Fr)|0,Ve=Ve+Math.imul(ct,an)|0,Ve=Ve+Math.imul(Qe,Fr)|0,Pe=Pe+Math.imul(Qe,an)|0,je=je+Math.imul(tt,Lr)|0,Ve=Ve+Math.imul(tt,ln)|0,Ve=Ve+Math.imul(Ke,Lr)|0,Pe=Pe+Math.imul(Ke,ln)|0;var dr=(Ge+je|0)+((Ve&8191)<<13)|0;Ge=(Pe+(Ve>>>13)|0)+(dr>>>26)|0,dr&=67108863,je=Math.imul(qt,Qt),Ve=Math.imul(qt,xr),Ve=Ve+Math.imul(Mt,Qt)|0,Pe=Math.imul(Mt,xr),je=je+Math.imul($t,Sr)|0,Ve=Ve+Math.imul($t,$r)|0,Ve=Ve+Math.imul(kt,Sr)|0,Pe=Pe+Math.imul(kt,$r)|0,je=je+Math.imul(Ct,Dr)|0,Ve=Ve+Math.imul(Ct,tn)|0,Ve=Ve+Math.imul(Pt,Dr)|0,Pe=Pe+Math.imul(Pt,tn)|0,je=je+Math.imul(ft,Pr)|0,Ve=Ve+Math.imul(ft,Wr)|0,Ve=Ve+Math.imul(Et,Pr)|0,Pe=Pe+Math.imul(Et,Wr)|0,je=je+Math.imul(vt,Fr)|0,Ve=Ve+Math.imul(vt,an)|0,Ve=Ve+Math.imul(At,Fr)|0,Pe=Pe+Math.imul(At,an)|0,je=je+Math.imul(ct,Lr)|0,Ve=Ve+Math.imul(ct,ln)|0,Ve=Ve+Math.imul(Qe,Lr)|0,Pe=Pe+Math.imul(Qe,ln)|0,je=je+Math.imul(tt,Or)|0,Ve=Ve+Math.imul(tt,nn)|0,Ve=Ve+Math.imul(Ke,Or)|0,Pe=Pe+Math.imul(Ke,nn)|0;var yr=(Ge+je|0)+((Ve&8191)<<13)|0;Ge=(Pe+(Ve>>>13)|0)+(yr>>>26)|0,yr&=67108863,je=Math.imul(Zt,Qt),Ve=Math.imul(Zt,xr),Ve=Ve+Math.imul(Yt,Qt)|0,Pe=Math.imul(Yt,xr),je=je+Math.imul(qt,Sr)|0,Ve=Ve+Math.imul(qt,$r)|0,Ve=Ve+Math.imul(Mt,Sr)|0,Pe=Pe+Math.imul(Mt,$r)|0,je=je+Math.imul($t,Dr)|0,Ve=Ve+Math.imul($t,tn)|0,Ve=Ve+Math.imul(kt,Dr)|0,Pe=Pe+Math.imul(kt,tn)|0,je=je+Math.imul(Ct,Pr)|0,Ve=Ve+Math.imul(Ct,Wr)|0,Ve=Ve+Math.imul(Pt,Pr)|0,Pe=Pe+Math.imul(Pt,Wr)|0,je=je+Math.imul(ft,Fr)|0,Ve=Ve+Math.imul(ft,an)|0,Ve=Ve+Math.imul(Et,Fr)|0,Pe=Pe+Math.imul(Et,an)|0,je=je+Math.imul(vt,Lr)|0,Ve=Ve+Math.imul(vt,ln)|0,Ve=Ve+Math.imul(At,Lr)|0,Pe=Pe+Math.imul(At,ln)|0,je=je+Math.imul(ct,Or)|0,Ve=Ve+Math.imul(ct,nn)|0,Ve=Ve+Math.imul(Qe,Or)|0,Pe=Pe+Math.imul(Qe,nn)|0,je=je+Math.imul(tt,Kt)|0,Ve=Ve+Math.imul(tt,jt)|0,Ve=Ve+Math.imul(Ke,Kt)|0,Pe=Pe+Math.imul(Ke,jt)|0;var Er=(Ge+je|0)+((Ve&8191)<<13)|0;Ge=(Pe+(Ve>>>13)|0)+(Er>>>26)|0,Er&=67108863,je=Math.imul(xt,Qt),Ve=Math.imul(xt,xr),Ve=Ve+Math.imul(pt,Qt)|0,Pe=Math.imul(pt,xr),je=je+Math.imul(Zt,Sr)|0,Ve=Ve+Math.imul(Zt,$r)|0,Ve=Ve+Math.imul(Yt,Sr)|0,Pe=Pe+Math.imul(Yt,$r)|0,je=je+Math.imul(qt,Dr)|0,Ve=Ve+Math.imul(qt,tn)|0,Ve=Ve+Math.imul(Mt,Dr)|0,Pe=Pe+Math.imul(Mt,tn)|0,je=je+Math.imul($t,Pr)|0,Ve=Ve+Math.imul($t,Wr)|0,Ve=Ve+Math.imul(kt,Pr)|0,Pe=Pe+Math.imul(kt,Wr)|0,je=je+Math.imul(Ct,Fr)|0,Ve=Ve+Math.imul(Ct,an)|0,Ve=Ve+Math.imul(Pt,Fr)|0,Pe=Pe+Math.imul(Pt,an)|0,je=je+Math.imul(ft,Lr)|0,Ve=Ve+Math.imul(ft,ln)|0,Ve=Ve+Math.imul(Et,Lr)|0,Pe=Pe+Math.imul(Et,ln)|0,je=je+Math.imul(vt,Or)|0,Ve=Ve+Math.imul(vt,nn)|0,Ve=Ve+Math.imul(At,Or)|0,Pe=Pe+Math.imul(At,nn)|0,je=je+Math.imul(ct,Kt)|0,Ve=Ve+Math.imul(ct,jt)|0,Ve=Ve+Math.imul(Qe,Kt)|0,Pe=Pe+Math.imul(Qe,jt)|0,je=je+Math.imul(tt,Rt)|0,Ve=Ve+Math.imul(tt,Tt)|0,Ve=Ve+Math.imul(Ke,Rt)|0,Pe=Pe+Math.imul(Ke,Tt)|0;var pr=(Ge+je|0)+((Ve&8191)<<13)|0;Ge=(Pe+(Ve>>>13)|0)+(pr>>>26)|0,pr&=67108863,je=Math.imul(Bt,Qt),Ve=Math.imul(Bt,xr),Ve=Ve+Math.imul(Ht,Qt)|0,Pe=Math.imul(Ht,xr),je=je+Math.imul(xt,Sr)|0,Ve=Ve+Math.imul(xt,$r)|0,Ve=Ve+Math.imul(pt,Sr)|0,Pe=Pe+Math.imul(pt,$r)|0,je=je+Math.imul(Zt,Dr)|0,Ve=Ve+Math.imul(Zt,tn)|0,Ve=Ve+Math.imul(Yt,Dr)|0,Pe=Pe+Math.imul(Yt,tn)|0,je=je+Math.imul(qt,Pr)|0,Ve=Ve+Math.imul(qt,Wr)|0,Ve=Ve+Math.imul(Mt,Pr)|0,Pe=Pe+Math.imul(Mt,Wr)|0,je=je+Math.imul($t,Fr)|0,Ve=Ve+Math.imul($t,an)|0,Ve=Ve+Math.imul(kt,Fr)|0,Pe=Pe+Math.imul(kt,an)|0,je=je+Math.imul(Ct,Lr)|0,Ve=Ve+Math.imul(Ct,ln)|0,Ve=Ve+Math.imul(Pt,Lr)|0,Pe=Pe+Math.imul(Pt,ln)|0,je=je+Math.imul(ft,Or)|0,Ve=Ve+Math.imul(ft,nn)|0,Ve=Ve+Math.imul(Et,Or)|0,Pe=Pe+Math.imul(Et,nn)|0,je=je+Math.imul(vt,Kt)|0,Ve=Ve+Math.imul(vt,jt)|0,Ve=Ve+Math.imul(At,Kt)|0,Pe=Pe+Math.imul(At,jt)|0,je=je+Math.imul(ct,Rt)|0,Ve=Ve+Math.imul(ct,Tt)|0,Ve=Ve+Math.imul(Qe,Rt)|0,Pe=Pe+Math.imul(Qe,Tt)|0,je=je+Math.imul(tt,Ot)|0,Ve=Ve+Math.imul(tt,Vt)|0,Ve=Ve+Math.imul(Ke,Ot)|0,Pe=Pe+Math.imul(Ke,Vt)|0;var _r=(Ge+je|0)+((Ve&8191)<<13)|0;Ge=(Pe+(Ve>>>13)|0)+(_r>>>26)|0,_r&=67108863,je=Math.imul(Bt,Sr),Ve=Math.imul(Bt,$r),Ve=Ve+Math.imul(Ht,Sr)|0,Pe=Math.imul(Ht,$r),je=je+Math.imul(xt,Dr)|0,Ve=Ve+Math.imul(xt,tn)|0,Ve=Ve+Math.imul(pt,Dr)|0,Pe=Pe+Math.imul(pt,tn)|0,je=je+Math.imul(Zt,Pr)|0,Ve=Ve+Math.imul(Zt,Wr)|0,Ve=Ve+Math.imul(Yt,Pr)|0,Pe=Pe+Math.imul(Yt,Wr)|0,je=je+Math.imul(qt,Fr)|0,Ve=Ve+Math.imul(qt,an)|0,Ve=Ve+Math.imul(Mt,Fr)|0,Pe=Pe+Math.imul(Mt,an)|0,je=je+Math.imul($t,Lr)|0,Ve=Ve+Math.imul($t,ln)|0,Ve=Ve+Math.imul(kt,Lr)|0,Pe=Pe+Math.imul(kt,ln)|0,je=je+Math.imul(Ct,Or)|0,Ve=Ve+Math.imul(Ct,nn)|0,Ve=Ve+Math.imul(Pt,Or)|0,Pe=Pe+Math.imul(Pt,nn)|0,je=je+Math.imul(ft,Kt)|0,Ve=Ve+Math.imul(ft,jt)|0,Ve=Ve+Math.imul(Et,Kt)|0,Pe=Pe+Math.imul(Et,jt)|0,je=je+Math.imul(vt,Rt)|0,Ve=Ve+Math.imul(vt,Tt)|0,Ve=Ve+Math.imul(At,Rt)|0,Pe=Pe+Math.imul(At,Tt)|0,je=je+Math.imul(ct,Ot)|0,Ve=Ve+Math.imul(ct,Vt)|0,Ve=Ve+Math.imul(Qe,Ot)|0,Pe=Pe+Math.imul(Qe,Vt)|0;var Ar=(Ge+je|0)+((Ve&8191)<<13)|0;Ge=(Pe+(Ve>>>13)|0)+(Ar>>>26)|0,Ar&=67108863,je=Math.imul(Bt,Dr),Ve=Math.imul(Bt,tn),Ve=Ve+Math.imul(Ht,Dr)|0,Pe=Math.imul(Ht,tn),je=je+Math.imul(xt,Pr)|0,Ve=Ve+Math.imul(xt,Wr)|0,Ve=Ve+Math.imul(pt,Pr)|0,Pe=Pe+Math.imul(pt,Wr)|0,je=je+Math.imul(Zt,Fr)|0,Ve=Ve+Math.imul(Zt,an)|0,Ve=Ve+Math.imul(Yt,Fr)|0,Pe=Pe+Math.imul(Yt,an)|0,je=je+Math.imul(qt,Lr)|0,Ve=Ve+Math.imul(qt,ln)|0,Ve=Ve+Math.imul(Mt,Lr)|0,Pe=Pe+Math.imul(Mt,ln)|0,je=je+Math.imul($t,Or)|0,Ve=Ve+Math.imul($t,nn)|0,Ve=Ve+Math.imul(kt,Or)|0,Pe=Pe+Math.imul(kt,nn)|0,je=je+Math.imul(Ct,Kt)|0,Ve=Ve+Math.imul(Ct,jt)|0,Ve=Ve+Math.imul(Pt,Kt)|0,Pe=Pe+Math.imul(Pt,jt)|0,je=je+Math.imul(ft,Rt)|0,Ve=Ve+Math.imul(ft,Tt)|0,Ve=Ve+Math.imul(Et,Rt)|0,Pe=Pe+Math.imul(Et,Tt)|0,je=je+Math.imul(vt,Ot)|0,Ve=Ve+Math.imul(vt,Vt)|0,Ve=Ve+Math.imul(At,Ot)|0,Pe=Pe+Math.imul(At,Vt)|0;var Ur=(Ge+je|0)+((Ve&8191)<<13)|0;Ge=(Pe+(Ve>>>13)|0)+(Ur>>>26)|0,Ur&=67108863,je=Math.imul(Bt,Pr),Ve=Math.imul(Bt,Wr),Ve=Ve+Math.imul(Ht,Pr)|0,Pe=Math.imul(Ht,Wr),je=je+Math.imul(xt,Fr)|0,Ve=Ve+Math.imul(xt,an)|0,Ve=Ve+Math.imul(pt,Fr)|0,Pe=Pe+Math.imul(pt,an)|0,je=je+Math.imul(Zt,Lr)|0,Ve=Ve+Math.imul(Zt,ln)|0,Ve=Ve+Math.imul(Yt,Lr)|0,Pe=Pe+Math.imul(Yt,ln)|0,je=je+Math.imul(qt,Or)|0,Ve=Ve+Math.imul(qt,nn)|0,Ve=Ve+Math.imul(Mt,Or)|0,Pe=Pe+Math.imul(Mt,nn)|0,je=je+Math.imul($t,Kt)|0,Ve=Ve+Math.imul($t,jt)|0,Ve=Ve+Math.imul(kt,Kt)|0,Pe=Pe+Math.imul(kt,jt)|0,je=je+Math.imul(Ct,Rt)|0,Ve=Ve+Math.imul(Ct,Tt)|0,Ve=Ve+Math.imul(Pt,Rt)|0,Pe=Pe+Math.imul(Pt,Tt)|0,je=je+Math.imul(ft,Ot)|0,Ve=Ve+Math.imul(ft,Vt)|0,Ve=Ve+Math.imul(Et,Ot)|0,Pe=Pe+Math.imul(Et,Vt)|0;var Hr=(Ge+je|0)+((Ve&8191)<<13)|0;Ge=(Pe+(Ve>>>13)|0)+(Hr>>>26)|0,Hr&=67108863,je=Math.imul(Bt,Fr),Ve=Math.imul(Bt,an),Ve=Ve+Math.imul(Ht,Fr)|0,Pe=Math.imul(Ht,an),je=je+Math.imul(xt,Lr)|0,Ve=Ve+Math.imul(xt,ln)|0,Ve=Ve+Math.imul(pt,Lr)|0,Pe=Pe+Math.imul(pt,ln)|0,je=je+Math.imul(Zt,Or)|0,Ve=Ve+Math.imul(Zt,nn)|0,Ve=Ve+Math.imul(Yt,Or)|0,Pe=Pe+Math.imul(Yt,nn)|0,je=je+Math.imul(qt,Kt)|0,Ve=Ve+Math.imul(qt,jt)|0,Ve=Ve+Math.imul(Mt,Kt)|0,Pe=Pe+Math.imul(Mt,jt)|0,je=je+Math.imul($t,Rt)|0,Ve=Ve+Math.imul($t,Tt)|0,Ve=Ve+Math.imul(kt,Rt)|0,Pe=Pe+Math.imul(kt,Tt)|0,je=je+Math.imul(Ct,Ot)|0,Ve=Ve+Math.imul(Ct,Vt)|0,Ve=Ve+Math.imul(Pt,Ot)|0,Pe=Pe+Math.imul(Pt,Vt)|0;var Yr=(Ge+je|0)+((Ve&8191)<<13)|0;Ge=(Pe+(Ve>>>13)|0)+(Yr>>>26)|0,Yr&=67108863,je=Math.imul(Bt,Lr),Ve=Math.imul(Bt,ln),Ve=Ve+Math.imul(Ht,Lr)|0,Pe=Math.imul(Ht,ln),je=je+Math.imul(xt,Or)|0,Ve=Ve+Math.imul(xt,nn)|0,Ve=Ve+Math.imul(pt,Or)|0,Pe=Pe+Math.imul(pt,nn)|0,je=je+Math.imul(Zt,Kt)|0,Ve=Ve+Math.imul(Zt,jt)|0,Ve=Ve+Math.imul(Yt,Kt)|0,Pe=Pe+Math.imul(Yt,jt)|0,je=je+Math.imul(qt,Rt)|0,Ve=Ve+Math.imul(qt,Tt)|0,Ve=Ve+Math.imul(Mt,Rt)|0,Pe=Pe+Math.imul(Mt,Tt)|0,je=je+Math.imul($t,Ot)|0,Ve=Ve+Math.imul($t,Vt)|0,Ve=Ve+Math.imul(kt,Ot)|0,Pe=Pe+Math.imul(kt,Vt)|0;var dn=(Ge+je|0)+((Ve&8191)<<13)|0;Ge=(Pe+(Ve>>>13)|0)+(dn>>>26)|0,dn&=67108863,je=Math.imul(Bt,Or),Ve=Math.imul(Bt,nn),Ve=Ve+Math.imul(Ht,Or)|0,Pe=Math.imul(Ht,nn),je=je+Math.imul(xt,Kt)|0,Ve=Ve+Math.imul(xt,jt)|0,Ve=Ve+Math.imul(pt,Kt)|0,Pe=Pe+Math.imul(pt,jt)|0,je=je+Math.imul(Zt,Rt)|0,Ve=Ve+Math.imul(Zt,Tt)|0,Ve=Ve+Math.imul(Yt,Rt)|0,Pe=Pe+Math.imul(Yt,Tt)|0,je=je+Math.imul(qt,Ot)|0,Ve=Ve+Math.imul(qt,Vt)|0,Ve=Ve+Math.imul(Mt,Ot)|0,Pe=Pe+Math.imul(Mt,Vt)|0;var pn=(Ge+je|0)+((Ve&8191)<<13)|0;Ge=(Pe+(Ve>>>13)|0)+(pn>>>26)|0,pn&=67108863,je=Math.imul(Bt,Kt),Ve=Math.imul(Bt,jt),Ve=Ve+Math.imul(Ht,Kt)|0,Pe=Math.imul(Ht,jt),je=je+Math.imul(xt,Rt)|0,Ve=Ve+Math.imul(xt,Tt)|0,Ve=Ve+Math.imul(pt,Rt)|0,Pe=Pe+Math.imul(pt,Tt)|0,je=je+Math.imul(Zt,Ot)|0,Ve=Ve+Math.imul(Zt,Vt)|0,Ve=Ve+Math.imul(Yt,Ot)|0,Pe=Pe+Math.imul(Yt,Vt)|0;var wn=(Ge+je|0)+((Ve&8191)<<13)|0;Ge=(Pe+(Ve>>>13)|0)+(wn>>>26)|0,wn&=67108863,je=Math.imul(Bt,Rt),Ve=Math.imul(Bt,Tt),Ve=Ve+Math.imul(Ht,Rt)|0,Pe=Math.imul(Ht,Tt),je=je+Math.imul(xt,Ot)|0,Ve=Ve+Math.imul(xt,Vt)|0,Ve=Ve+Math.imul(pt,Ot)|0,Pe=Pe+Math.imul(pt,Vt)|0;var mn=(Ge+je|0)+((Ve&8191)<<13)|0;Ge=(Pe+(Ve>>>13)|0)+(mn>>>26)|0,mn&=67108863,je=Math.imul(Bt,Ot),Ve=Math.imul(Bt,Vt),Ve=Ve+Math.imul(Ht,Ot)|0,Pe=Math.imul(Ht,Vt);var Tn=(Ge+je|0)+((Ve&8191)<<13)|0;return Ge=(Pe+(Ve>>>13)|0)+(Tn>>>26)|0,Tn&=67108863,Be[0]=Jt,Be[1]=lr,Be[2]=tr,Be[3]=ir,Be[4]=sr,Be[5]=dr,Be[6]=yr,Be[7]=Er,Be[8]=pr,Be[9]=_r,Be[10]=Ar,Be[11]=Ur,Be[12]=Hr,Be[13]=Yr,Be[14]=dn,Be[15]=pn,Be[16]=wn,Be[17]=mn,Be[18]=Tn,Ge!==0&&(Be[19]=Ge,_e.length++),_e};Math.imul||(X=Z);function Q(nt,Ee,Ce){Ce.negative=Ee.negative^nt.negative,Ce.length=nt.length+Ee.length;for(var _e=0,Ie=0,He=0;He<Ce.length-1;He++){var Be=Ie;Ie=0;for(var Ge=_e&67108863,je=Math.min(He,Ee.length-1),Ve=Math.max(0,He-nt.length+1);Ve<=je;Ve++){var Pe=He-Ve,Me=nt.words[Pe]|0,tt=Ee.words[Ve]|0,Ke=Me*tt,mt=Ke&67108863;Be=Be+(Ke/67108864|0)|0,mt=mt+Ge|0,Ge=mt&67108863,Be=Be+(mt>>>26)|0,Ie+=Be>>>26,Be&=67108863}Ce.words[He]=Ge,_e=Be,Be=Ie}return _e!==0?Ce.words[He]=_e:Ce.length--,Ce.strip()}function se(nt,Ee,Ce){var _e=new oe;return _e.mulp(nt,Ee,Ce)}C.prototype.mulTo=function(Ee,Ce){var _e,Ie=this.length+Ee.length;return this.length===10&&Ee.length===10?_e=X(this,Ee,Ce):Ie<63?_e=Z(this,Ee,Ce):Ie<1024?_e=Q(this,Ee,Ce):_e=se(this,Ee,Ce),_e};function oe(nt,Ee){this.x=nt,this.y=Ee}oe.prototype.makeRBT=function(Ee){for(var Ce=new Array(Ee),_e=C.prototype._countBits(Ee)-1,Ie=0;Ie<Ee;Ie++)Ce[Ie]=this.revBin(Ie,_e,Ee);return Ce},oe.prototype.revBin=function(Ee,Ce,_e){if(Ee===0||Ee===_e-1)return Ee;for(var Ie=0,He=0;He<Ce;He++)Ie|=(Ee&1)<<Ce-He-1,Ee>>=1;return Ie},oe.prototype.permute=function(Ee,Ce,_e,Ie,He,Be){for(var Ge=0;Ge<Be;Ge++)Ie[Ge]=Ce[Ee[Ge]],He[Ge]=_e[Ee[Ge]]},oe.prototype.transform=function(Ee,Ce,_e,Ie,He,Be){this.permute(Be,Ee,Ce,_e,Ie,He);for(var Ge=1;Ge<He;Ge<<=1)for(var je=Ge<<1,Ve=Math.cos(2*Math.PI/je),Pe=Math.sin(2*Math.PI/je),Me=0;Me<He;Me+=je)for(var tt=Ve,Ke=Pe,mt=0;mt<Ge;mt++){var ct=_e[Me+mt],Qe=Ie[Me+mt],dt=_e[Me+mt+Ge],vt=Ie[Me+mt+Ge],At=tt*dt-Ke*vt;vt=tt*vt+Ke*dt,dt=At,_e[Me+mt]=ct+dt,Ie[Me+mt]=Qe+vt,_e[Me+mt+Ge]=ct-dt,Ie[Me+mt+Ge]=Qe-vt,mt!==je&&(At=Ve*tt-Pe*Ke,Ke=Ve*Ke+Pe*tt,tt=At)}},oe.prototype.guessLen13b=function(Ee,Ce){var _e=Math.max(Ce,Ee)|1,Ie=_e&1,He=0;for(_e=_e/2|0;_e;_e=_e>>>1)He++;return 1<<He+1+Ie},oe.prototype.conjugate=function(Ee,Ce,_e){if(!(_e<=1))for(var Ie=0;Ie<_e/2;Ie++){var He=Ee[Ie];Ee[Ie]=Ee[_e-Ie-1],Ee[_e-Ie-1]=He,He=Ce[Ie],Ce[Ie]=-Ce[_e-Ie-1],Ce[_e-Ie-1]=-He}},oe.prototype.normalize13b=function(Ee,Ce){for(var _e=0,Ie=0;Ie<Ce/2;Ie++){var He=Math.round(Ee[2*Ie+1]/Ce)*8192+Math.round(Ee[2*Ie]/Ce)+_e;Ee[Ie]=He&67108863,He<67108864?_e=0:_e=He/67108864|0}return Ee},oe.prototype.convert13b=function(Ee,Ce,_e,Ie){for(var He=0,Be=0;Be<Ce;Be++)He=He+(Ee[Be]|0),_e[2*Be]=He&8191,He=He>>>13,_e[2*Be+1]=He&8191,He=He>>>13;for(Be=2*Ce;Be<Ie;++Be)_e[Be]=0;E(He===0),E((He&-8192)===0)},oe.prototype.stub=function(Ee){for(var Ce=new Array(Ee),_e=0;_e<Ee;_e++)Ce[_e]=0;return Ce},oe.prototype.mulp=function(Ee,Ce,_e){var Ie=2*this.guessLen13b(Ee.length,Ce.length),He=this.makeRBT(Ie),Be=this.stub(Ie),Ge=new Array(Ie),je=new Array(Ie),Ve=new Array(Ie),Pe=new Array(Ie),Me=new Array(Ie),tt=new Array(Ie),Ke=_e.words;Ke.length=Ie,this.convert13b(Ee.words,Ee.length,Ge,Ie),this.convert13b(Ce.words,Ce.length,Pe,Ie),this.transform(Ge,Be,je,Ve,Ie,He),this.transform(Pe,Be,Me,tt,Ie,He);for(var mt=0;mt<Ie;mt++){var ct=je[mt]*Me[mt]-Ve[mt]*tt[mt];Ve[mt]=je[mt]*tt[mt]+Ve[mt]*Me[mt],je[mt]=ct}return this.conjugate(je,Ve,Ie),this.transform(je,Ve,Ke,Be,Ie,He),this.conjugate(Ke,Be,Ie),this.normalize13b(Ke,Ie),_e.negative=Ee.negative^Ce.negative,_e.length=Ee.length+Ce.length,_e.strip()},C.prototype.mul=function(Ee){var Ce=new C(null);return Ce.words=new Array(this.length+Ee.length),this.mulTo(Ee,Ce)},C.prototype.mulf=function(Ee){var Ce=new C(null);return Ce.words=new Array(this.length+Ee.length),se(this,Ee,Ce)},C.prototype.imul=function(Ee){return this.clone().mulTo(Ee,this)},C.prototype.imuln=function(Ee){E(typeof Ee=="number"),E(Ee<67108864);for(var Ce=0,_e=0;_e<this.length;_e++){var Ie=(this.words[_e]|0)*Ee,He=(Ie&67108863)+(Ce&67108863);Ce>>=26,Ce+=Ie/67108864|0,Ce+=He>>>26,this.words[_e]=He&67108863}return Ce!==0&&(this.words[_e]=Ce,this.length++),this},C.prototype.muln=function(Ee){return this.clone().imuln(Ee)},C.prototype.sqr=function(){return this.mul(this)},C.prototype.isqr=function(){return this.imul(this.clone())},C.prototype.pow=function(Ee){var Ce=z(Ee);if(Ce.length===0)return new C(1);for(var _e=this,Ie=0;Ie<Ce.length&&Ce[Ie]===0;Ie++,_e=_e.sqr());if(++Ie<Ce.length)for(var He=_e.sqr();Ie<Ce.length;Ie++,He=He.sqr())Ce[Ie]!==0&&(_e=_e.mul(He));return _e},C.prototype.iushln=function(Ee){E(typeof Ee=="number"&&Ee>=0);var Ce=Ee%26,_e=(Ee-Ce)/26,Ie=67108863>>>26-Ce<<26-Ce,He;if(Ce!==0){var Be=0;for(He=0;He<this.length;He++){var Ge=this.words[He]&Ie,je=(this.words[He]|0)-Ge<<Ce;this.words[He]=je|Be,Be=Ge>>>26-Ce}Be&&(this.words[He]=Be,this.length++)}if(_e!==0){for(He=this.length-1;He>=0;He--)this.words[He+_e]=this.words[He];for(He=0;He<_e;He++)this.words[He]=0;this.length+=_e}return this.strip()},C.prototype.ishln=function(Ee){return E(this.negative===0),this.iushln(Ee)},C.prototype.iushrn=function(Ee,Ce,_e){E(typeof Ee=="number"&&Ee>=0);var Ie;Ce?Ie=(Ce-Ce%26)/26:Ie=0;var He=Ee%26,Be=Math.min((Ee-He)/26,this.length),Ge=67108863^67108863>>>He<<He,je=_e;if(Ie-=Be,Ie=Math.max(0,Ie),je){for(var Ve=0;Ve<Be;Ve++)je.words[Ve]=this.words[Ve];je.length=Be}if(Be!==0)if(this.length>Be)for(this.length-=Be,Ve=0;Ve<this.length;Ve++)this.words[Ve]=this.words[Ve+Be];else this.words[0]=0,this.length=1;var Pe=0;for(Ve=this.length-1;Ve>=0&&(Pe!==0||Ve>=Ie);Ve--){var Me=this.words[Ve]|0;this.words[Ve]=Pe<<26-He|Me>>>He,Pe=Me&Ge}return je&&Pe!==0&&(je.words[je.length++]=Pe),this.length===0&&(this.words[0]=0,this.length=1),this.strip()},C.prototype.ishrn=function(Ee,Ce,_e){return E(this.negative===0),this.iushrn(Ee,Ce,_e)},C.prototype.shln=function(Ee){return this.clone().ishln(Ee)},C.prototype.ushln=function(Ee){return this.clone().iushln(Ee)},C.prototype.shrn=function(Ee){return this.clone().ishrn(Ee)},C.prototype.ushrn=function(Ee){return this.clone().iushrn(Ee)},C.prototype.testn=function(Ee){E(typeof Ee=="number"&&Ee>=0);var Ce=Ee%26,_e=(Ee-Ce)/26,Ie=1<<Ce;if(this.length<=_e)return!1;var He=this.words[_e];return!!(He&Ie)},C.prototype.imaskn=function(Ee){E(typeof Ee=="number"&&Ee>=0);var Ce=Ee%26,_e=(Ee-Ce)/26;if(E(this.negative===0,"imaskn works only with positive numbers"),this.length<=_e)return this;if(Ce!==0&&_e++,this.length=Math.min(_e,this.length),Ce!==0){var Ie=67108863^67108863>>>Ce<<Ce;this.words[this.length-1]&=Ie}return this.strip()},C.prototype.maskn=function(Ee){return this.clone().imaskn(Ee)},C.prototype.iaddn=function(Ee){return E(typeof Ee=="number"),E(Ee<67108864),Ee<0?this.isubn(-Ee):this.negative!==0?this.length===1&&(this.words[0]|0)<Ee?(this.words[0]=Ee-(this.words[0]|0),this.negative=0,this):(this.negative=0,this.isubn(Ee),this.negative=1,this):this._iaddn(Ee)},C.prototype._iaddn=function(Ee){this.words[0]+=Ee;for(var Ce=0;Ce<this.length&&this.words[Ce]>=67108864;Ce++)this.words[Ce]-=67108864,Ce===this.length-1?this.words[Ce+1]=1:this.words[Ce+1]++;return this.length=Math.max(this.length,Ce+1),this},C.prototype.isubn=function(Ee){if(E(typeof Ee=="number"),E(Ee<67108864),Ee<0)return this.iaddn(-Ee);if(this.negative!==0)return this.negative=0,this.iaddn(Ee),this.negative=1,this;if(this.words[0]-=Ee,this.length===1&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var Ce=0;Ce<this.length&&this.words[Ce]<0;Ce++)this.words[Ce]+=67108864,this.words[Ce+1]-=1;return this.strip()},C.prototype.addn=function(Ee){return this.clone().iaddn(Ee)},C.prototype.subn=function(Ee){return this.clone().isubn(Ee)},C.prototype.iabs=function(){return this.negative=0,this},C.prototype.abs=function(){return this.clone().iabs()},C.prototype._ishlnsubmul=function(Ee,Ce,_e){var Ie=Ee.length+_e,He;this._expand(Ie);var Be,Ge=0;for(He=0;He<Ee.length;He++){Be=(this.words[He+_e]|0)+Ge;var je=(Ee.words[He]|0)*Ce;Be-=je&67108863,Ge=(Be>>26)-(je/67108864|0),this.words[He+_e]=Be&67108863}for(;He<this.length-_e;He++)Be=(this.words[He+_e]|0)+Ge,Ge=Be>>26,this.words[He+_e]=Be&67108863;if(Ge===0)return this.strip();for(E(Ge===-1),Ge=0,He=0;He<this.length;He++)Be=-(this.words[He]|0)+Ge,Ge=Be>>26,this.words[He]=Be&67108863;return this.negative=1,this.strip()},C.prototype._wordDiv=function(Ee,Ce){var _e=this.length-Ee.length,Ie=this.clone(),He=Ee,Be=He.words[He.length-1]|0,Ge=this._countBits(Be);_e=26-Ge,_e!==0&&(He=He.ushln(_e),Ie.iushln(_e),Be=He.words[He.length-1]|0);var je=Ie.length-He.length,Ve;if(Ce!=="mod"){Ve=new C(null),Ve.length=je+1,Ve.words=new Array(Ve.length);for(var Pe=0;Pe<Ve.length;Pe++)Ve.words[Pe]=0}var Me=Ie.clone()._ishlnsubmul(He,1,je);Me.negative===0&&(Ie=Me,Ve&&(Ve.words[je]=1));for(var tt=je-1;tt>=0;tt--){var Ke=(Ie.words[He.length+tt]|0)*67108864+(Ie.words[He.length+tt-1]|0);for(Ke=Math.min(Ke/Be|0,67108863),Ie._ishlnsubmul(He,Ke,tt);Ie.negative!==0;)Ke--,Ie.negative=0,Ie._ishlnsubmul(He,1,tt),Ie.isZero()||(Ie.negative^=1);Ve&&(Ve.words[tt]=Ke)}return Ve&&Ve.strip(),Ie.strip(),Ce!=="div"&&_e!==0&&Ie.iushrn(_e),{div:Ve||null,mod:Ie}},C.prototype.divmod=function(Ee,Ce,_e){if(E(!Ee.isZero()),this.isZero())return{div:new C(0),mod:new C(0)};var Ie,He,Be;return this.negative!==0&&Ee.negative===0?(Be=this.neg().divmod(Ee,Ce),Ce!=="mod"&&(Ie=Be.div.neg()),Ce!=="div"&&(He=Be.mod.neg(),_e&&He.negative!==0&&He.iadd(Ee)),{div:Ie,mod:He}):this.negative===0&&Ee.negative!==0?(Be=this.divmod(Ee.neg(),Ce),Ce!=="mod"&&(Ie=Be.div.neg()),{div:Ie,mod:Be.mod}):this.negative&Ee.negative?(Be=this.neg().divmod(Ee.neg(),Ce),Ce!=="div"&&(He=Be.mod.neg(),_e&&He.negative!==0&&He.isub(Ee)),{div:Be.div,mod:He}):Ee.length>this.length||this.cmp(Ee)<0?{div:new C(0),mod:this}:Ee.length===1?Ce==="div"?{div:this.divn(Ee.words[0]),mod:null}:Ce==="mod"?{div:null,mod:new C(this.modn(Ee.words[0]))}:{div:this.divn(Ee.words[0]),mod:new C(this.modn(Ee.words[0]))}:this._wordDiv(Ee,Ce)},C.prototype.div=function(Ee){return this.divmod(Ee,"div",!1).div},C.prototype.mod=function(Ee){return this.divmod(Ee,"mod",!1).mod},C.prototype.umod=function(Ee){return this.divmod(Ee,"mod",!0).mod},C.prototype.divRound=function(Ee){var Ce=this.divmod(Ee);if(Ce.mod.isZero())return Ce.div;var _e=Ce.div.negative!==0?Ce.mod.isub(Ee):Ce.mod,Ie=Ee.ushrn(1),He=Ee.andln(1),Be=_e.cmp(Ie);return Be<0||He===1&&Be===0?Ce.div:Ce.div.negative!==0?Ce.div.isubn(1):Ce.div.iaddn(1)},C.prototype.modn=function(Ee){E(Ee<=67108863);for(var Ce=(1<<26)%Ee,_e=0,Ie=this.length-1;Ie>=0;Ie--)_e=(Ce*_e+(this.words[Ie]|0))%Ee;return _e},C.prototype.idivn=function(Ee){E(Ee<=67108863);for(var Ce=0,_e=this.length-1;_e>=0;_e--){var Ie=(this.words[_e]|0)+Ce*67108864;this.words[_e]=Ie/Ee|0,Ce=Ie%Ee}return this.strip()},C.prototype.divn=function(Ee){return this.clone().idivn(Ee)},C.prototype.egcd=function(Ee){E(Ee.negative===0),E(!Ee.isZero());var Ce=this,_e=Ee.clone();Ce.negative!==0?Ce=Ce.umod(Ee):Ce=Ce.clone();for(var Ie=new C(1),He=new C(0),Be=new C(0),Ge=new C(1),je=0;Ce.isEven()&&_e.isEven();)Ce.iushrn(1),_e.iushrn(1),++je;for(var Ve=_e.clone(),Pe=Ce.clone();!Ce.isZero();){for(var Me=0,tt=1;!(Ce.words[0]&tt)&&Me<26;++Me,tt<<=1);if(Me>0)for(Ce.iushrn(Me);Me-- >0;)(Ie.isOdd()||He.isOdd())&&(Ie.iadd(Ve),He.isub(Pe)),Ie.iushrn(1),He.iushrn(1);for(var Ke=0,mt=1;!(_e.words[0]&mt)&&Ke<26;++Ke,mt<<=1);if(Ke>0)for(_e.iushrn(Ke);Ke-- >0;)(Be.isOdd()||Ge.isOdd())&&(Be.iadd(Ve),Ge.isub(Pe)),Be.iushrn(1),Ge.iushrn(1);Ce.cmp(_e)>=0?(Ce.isub(_e),Ie.isub(Be),He.isub(Ge)):(_e.isub(Ce),Be.isub(Ie),Ge.isub(He))}return{a:Be,b:Ge,gcd:_e.iushln(je)}},C.prototype._invmp=function(Ee){E(Ee.negative===0),E(!Ee.isZero());var Ce=this,_e=Ee.clone();Ce.negative!==0?Ce=Ce.umod(Ee):Ce=Ce.clone();for(var Ie=new C(1),He=new C(0),Be=_e.clone();Ce.cmpn(1)>0&&_e.cmpn(1)>0;){for(var Ge=0,je=1;!(Ce.words[0]&je)&&Ge<26;++Ge,je<<=1);if(Ge>0)for(Ce.iushrn(Ge);Ge-- >0;)Ie.isOdd()&&Ie.iadd(Be),Ie.iushrn(1);for(var Ve=0,Pe=1;!(_e.words[0]&Pe)&&Ve<26;++Ve,Pe<<=1);if(Ve>0)for(_e.iushrn(Ve);Ve-- >0;)He.isOdd()&&He.iadd(Be),He.iushrn(1);Ce.cmp(_e)>=0?(Ce.isub(_e),Ie.isub(He)):(_e.isub(Ce),He.isub(Ie))}var Me;return Ce.cmpn(1)===0?Me=Ie:Me=He,Me.cmpn(0)<0&&Me.iadd(Ee),Me},C.prototype.gcd=function(Ee){if(this.isZero())return Ee.abs();if(Ee.isZero())return this.abs();var Ce=this.clone(),_e=Ee.clone();Ce.negative=0,_e.negative=0;for(var Ie=0;Ce.isEven()&&_e.isEven();Ie++)Ce.iushrn(1),_e.iushrn(1);do{for(;Ce.isEven();)Ce.iushrn(1);for(;_e.isEven();)_e.iushrn(1);var He=Ce.cmp(_e);if(He<0){var Be=Ce;Ce=_e,_e=Be}else if(He===0||_e.cmpn(1)===0)break;Ce.isub(_e)}while(!0);return _e.iushln(Ie)},C.prototype.invm=function(Ee){return this.egcd(Ee).a.umod(Ee)},C.prototype.isEven=function(){return(this.words[0]&1)===0},C.prototype.isOdd=function(){return(this.words[0]&1)===1},C.prototype.andln=function(Ee){return this.words[0]&Ee},C.prototype.bincn=function(Ee){E(typeof Ee=="number");var Ce=Ee%26,_e=(Ee-Ce)/26,Ie=1<<Ce;if(this.length<=_e)return this._expand(_e+1),this.words[_e]|=Ie,this;for(var He=Ie,Be=_e;He!==0&&Be<this.length;Be++){var Ge=this.words[Be]|0;Ge+=He,He=Ge>>>26,Ge&=67108863,this.words[Be]=Ge}return He!==0&&(this.words[Be]=He,this.length++),this},C.prototype.isZero=function(){return this.length===1&&this.words[0]===0},C.prototype.cmpn=function(Ee){var Ce=Ee<0;if(this.negative!==0&&!Ce)return-1;if(this.negative===0&&Ce)return 1;this.strip();var _e;if(this.length>1)_e=1;else{Ce&&(Ee=-Ee),E(Ee<=67108863,"Number is too big");var Ie=this.words[0]|0;_e=Ie===Ee?0:Ie<Ee?-1:1}return this.negative!==0?-_e|0:_e},C.prototype.cmp=function(Ee){if(this.negative!==0&&Ee.negative===0)return-1;if(this.negative===0&&Ee.negative!==0)return 1;var Ce=this.ucmp(Ee);return this.negative!==0?-Ce|0:Ce},C.prototype.ucmp=function(Ee){if(this.length>Ee.length)return 1;if(this.length<Ee.length)return-1;for(var Ce=0,_e=this.length-1;_e>=0;_e--){var Ie=this.words[_e]|0,He=Ee.words[_e]|0;if(Ie!==He){Ie<He?Ce=-1:Ie>He&&(Ce=1);break}}return Ce},C.prototype.gtn=function(Ee){return this.cmpn(Ee)===1},C.prototype.gt=function(Ee){return this.cmp(Ee)===1},C.prototype.gten=function(Ee){return this.cmpn(Ee)>=0},C.prototype.gte=function(Ee){return this.cmp(Ee)>=0},C.prototype.ltn=function(Ee){return this.cmpn(Ee)===-1},C.prototype.lt=function(Ee){return this.cmp(Ee)===-1},C.prototype.lten=function(Ee){return this.cmpn(Ee)<=0},C.prototype.lte=function(Ee){return this.cmp(Ee)<=0},C.prototype.eqn=function(Ee){return this.cmpn(Ee)===0},C.prototype.eq=function(Ee){return this.cmp(Ee)===0},C.red=function(Ee){return new Fe(Ee)},C.prototype.toRed=function(Ee){return E(!this.red,"Already a number in reduction context"),E(this.negative===0,"red works only with positives"),Ee.convertTo(this)._forceRed(Ee)},C.prototype.fromRed=function(){return E(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},C.prototype._forceRed=function(Ee){return this.red=Ee,this},C.prototype.forceRed=function(Ee){return E(!this.red,"Already a number in reduction context"),this._forceRed(Ee)},C.prototype.redAdd=function(Ee){return E(this.red,"redAdd works only with red numbers"),this.red.add(this,Ee)},C.prototype.redIAdd=function(Ee){return E(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,Ee)},C.prototype.redSub=function(Ee){return E(this.red,"redSub works only with red numbers"),this.red.sub(this,Ee)},C.prototype.redISub=function(Ee){return E(this.red,"redISub works only with red numbers"),this.red.isub(this,Ee)},C.prototype.redShl=function(Ee){return E(this.red,"redShl works only with red numbers"),this.red.shl(this,Ee)},C.prototype.redMul=function(Ee){return E(this.red,"redMul works only with red numbers"),this.red._verify2(this,Ee),this.red.mul(this,Ee)},C.prototype.redIMul=function(Ee){return E(this.red,"redMul works only with red numbers"),this.red._verify2(this,Ee),this.red.imul(this,Ee)},C.prototype.redSqr=function(){return E(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},C.prototype.redISqr=function(){return E(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},C.prototype.redSqrt=function(){return E(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},C.prototype.redInvm=function(){return E(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},C.prototype.redNeg=function(){return E(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},C.prototype.redPow=function(Ee){return E(this.red&&!Ee.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,Ee)};var ue={k256:null,p224:null,p192:null,p25519:null};function we(nt,Ee){this.name=nt,this.p=new C(Ee,16),this.n=this.p.bitLength(),this.k=new C(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}we.prototype._tmp=function(){var Ee=new C(null);return Ee.words=new Array(Math.ceil(this.n/13)),Ee},we.prototype.ireduce=function(Ee){var Ce=Ee,_e;do this.split(Ce,this.tmp),Ce=this.imulK(Ce),Ce=Ce.iadd(this.tmp),_e=Ce.bitLength();while(_e>this.n);var Ie=_e<this.n?-1:Ce.ucmp(this.p);return Ie===0?(Ce.words[0]=0,Ce.length=1):Ie>0?Ce.isub(this.p):Ce.strip!==void 0?Ce.strip():Ce._strip(),Ce},we.prototype.split=function(Ee,Ce){Ee.iushrn(this.n,0,Ce)},we.prototype.imulK=function(Ee){return Ee.imul(this.k)};function Te(){we.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}S(Te,we),Te.prototype.split=function(Ee,Ce){for(var _e=4194303,Ie=Math.min(Ee.length,9),He=0;He<Ie;He++)Ce.words[He]=Ee.words[He];if(Ce.length=Ie,Ee.length<=9){Ee.words[0]=0,Ee.length=1;return}var Be=Ee.words[9];for(Ce.words[Ce.length++]=Be&_e,He=10;He<Ee.length;He++){var Ge=Ee.words[He]|0;Ee.words[He-10]=(Ge&_e)<<4|Be>>>22,Be=Ge}Be>>>=22,Ee.words[He-10]=Be,Be===0&&Ee.length>10?Ee.length-=10:Ee.length-=9},Te.prototype.imulK=function(Ee){Ee.words[Ee.length]=0,Ee.words[Ee.length+1]=0,Ee.length+=2;for(var Ce=0,_e=0;_e<Ee.length;_e++){var Ie=Ee.words[_e]|0;Ce+=Ie*977,Ee.words[_e]=Ce&67108863,Ce=Ie*64+(Ce/67108864|0)}return Ee.words[Ee.length-1]===0&&(Ee.length--,Ee.words[Ee.length-1]===0&&Ee.length--),Ee};function xe(){we.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}S(xe,we);function Re(){we.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}S(Re,we);function Ne(){we.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}S(Ne,we),Ne.prototype.imulK=function(Ee){for(var Ce=0,_e=0;_e<Ee.length;_e++){var Ie=(Ee.words[_e]|0)*19+Ce,He=Ie&67108863;Ie>>>=26,Ee.words[_e]=He,Ce=Ie}return Ce!==0&&(Ee.words[Ee.length++]=Ce),Ee},C._prime=function(Ee){if(ue[Ee])return ue[Ee];var Ce;if(Ee==="k256")Ce=new Te;else if(Ee==="p224")Ce=new xe;else if(Ee==="p192")Ce=new Re;else if(Ee==="p25519")Ce=new Ne;else throw new Error("Unknown prime "+Ee);return ue[Ee]=Ce,Ce};function Fe(nt){if(typeof nt=="string"){var Ee=C._prime(nt);this.m=Ee.p,this.prime=Ee}else E(nt.gtn(1),"modulus must be greater than 1"),this.m=nt,this.prime=null}Fe.prototype._verify1=function(Ee){E(Ee.negative===0,"red works only with positives"),E(Ee.red,"red works only with red numbers")},Fe.prototype._verify2=function(Ee,Ce){E((Ee.negative|Ce.negative)===0,"red works only with positives"),E(Ee.red&&Ee.red===Ce.red,"red works only with red numbers")},Fe.prototype.imod=function(Ee){return this.prime?this.prime.ireduce(Ee)._forceRed(this):Ee.umod(this.m)._forceRed(this)},Fe.prototype.neg=function(Ee){return Ee.isZero()?Ee.clone():this.m.sub(Ee)._forceRed(this)},Fe.prototype.add=function(Ee,Ce){this._verify2(Ee,Ce);var _e=Ee.add(Ce);return _e.cmp(this.m)>=0&&_e.isub(this.m),_e._forceRed(this)},Fe.prototype.iadd=function(Ee,Ce){this._verify2(Ee,Ce);var _e=Ee.iadd(Ce);return _e.cmp(this.m)>=0&&_e.isub(this.m),_e},Fe.prototype.sub=function(Ee,Ce){this._verify2(Ee,Ce);var _e=Ee.sub(Ce);return _e.cmpn(0)<0&&_e.iadd(this.m),_e._forceRed(this)},Fe.prototype.isub=function(Ee,Ce){this._verify2(Ee,Ce);var _e=Ee.isub(Ce);return _e.cmpn(0)<0&&_e.iadd(this.m),_e},Fe.prototype.shl=function(Ee,Ce){return this._verify1(Ee),this.imod(Ee.ushln(Ce))},Fe.prototype.imul=function(Ee,Ce){return this._verify2(Ee,Ce),this.imod(Ee.imul(Ce))},Fe.prototype.mul=function(Ee,Ce){return this._verify2(Ee,Ce),this.imod(Ee.mul(Ce))},Fe.prototype.isqr=function(Ee){return this.imul(Ee,Ee.clone())},Fe.prototype.sqr=function(Ee){return this.mul(Ee,Ee)},Fe.prototype.sqrt=function(Ee){if(Ee.isZero())return Ee.clone();var Ce=this.m.andln(3);if(E(Ce%2===1),Ce===3){var _e=this.m.add(new C(1)).iushrn(2);return this.pow(Ee,_e)}for(var Ie=this.m.subn(1),He=0;!Ie.isZero()&&Ie.andln(1)===0;)He++,Ie.iushrn(1);E(!Ie.isZero());var Be=new C(1).toRed(this),Ge=Be.redNeg(),je=this.m.subn(1).iushrn(1),Ve=this.m.bitLength();for(Ve=new C(2*Ve*Ve).toRed(this);this.pow(Ve,je).cmp(Ge)!==0;)Ve.redIAdd(Ge);for(var Pe=this.pow(Ve,Ie),Me=this.pow(Ee,Ie.addn(1).iushrn(1)),tt=this.pow(Ee,Ie),Ke=He;tt.cmp(Be)!==0;){for(var mt=tt,ct=0;mt.cmp(Be)!==0;ct++)mt=mt.redSqr();E(ct<Ke);var Qe=this.pow(Pe,new C(1).iushln(Ke-ct-1));Me=Me.redMul(Qe),Pe=Qe.redSqr(),tt=tt.redMul(Pe),Ke=ct}return Me},Fe.prototype.invm=function(Ee){var Ce=Ee._invmp(this.m);return Ce.negative!==0?(Ce.negative=0,this.imod(Ce).redNeg()):this.imod(Ce)},Fe.prototype.pow=function(Ee,Ce){if(Ce.isZero())return new C(1).toRed(this);if(Ce.cmpn(1)===0)return Ee.clone();var _e=4,Ie=new Array(1<<_e);Ie[0]=new C(1).toRed(this),Ie[1]=Ee;for(var He=2;He<Ie.length;He++)Ie[He]=this.mul(Ie[He-1],Ee);var Be=Ie[0],Ge=0,je=0,Ve=Ce.bitLength()%26;for(Ve===0&&(Ve=26),He=Ce.length-1;He>=0;He--){for(var Pe=Ce.words[He],Me=Ve-1;Me>=0;Me--){var tt=Pe>>Me&1;if(Be!==Ie[0]&&(Be=this.sqr(Be)),tt===0&&Ge===0){je=0;continue}Ge<<=1,Ge|=tt,je++,!(je!==_e&&(He!==0||Me!==0))&&(Be=this.mul(Be,Ie[Ge]),je=0,Ge=0)}Ve=26}return Be},Fe.prototype.convertTo=function(Ee){var Ce=Ee.umod(this.m);return Ce===Ee?Ce.clone():Ce},Fe.prototype.convertFrom=function(Ee){var Ce=Ee.clone();return Ce.red=null,Ce},C.mont=function(Ee){return new ht(Ee)};function ht(nt){Fe.call(this,nt),this.shift=this.m.bitLength(),this.shift%26!==0&&(this.shift+=26-this.shift%26),this.r=new C(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}S(ht,Fe),ht.prototype.convertTo=function(Ee){return this.imod(Ee.ushln(this.shift))},ht.prototype.convertFrom=function(Ee){var Ce=this.imod(Ee.mul(this.rinv));return Ce.red=null,Ce},ht.prototype.imul=function(Ee,Ce){if(Ee.isZero()||Ce.isZero())return Ee.words[0]=0,Ee.length=1,Ee;var _e=Ee.imul(Ce),Ie=_e.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),He=_e.isub(Ie).iushrn(this.shift),Be=He;return He.cmp(this.m)>=0?Be=He.isub(this.m):He.cmpn(0)<0&&(Be=He.iadd(this.m)),Be._forceRed(this)},ht.prototype.mul=function(Ee,Ce){if(Ee.isZero()||Ce.isZero())return new C(0)._forceRed(this);var _e=Ee.mul(Ce),Ie=_e.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),He=_e.isub(Ie).iushrn(this.shift),Be=He;return He.cmp(this.m)>=0?Be=He.isub(this.m):He.cmpn(0)<0&&(Be=He.iadd(this.m)),Be._forceRed(this)},ht.prototype.invm=function(Ee){var Ce=this.imod(Ee._invmp(this.m).mul(this.r2));return Ce._forceRed(this)}})(n,commonjsGlobal)}(bn$1)),bn$1.exports}var brorand={exports:{}},hasRequiredBrorand;function requireBrorand(){if(hasRequiredBrorand)return brorand.exports;hasRequiredBrorand=1;var n;brorand.exports=function(S){return n||(n=new r(null)),n.generate(S)};function r(E){this.rand=E}if(brorand.exports.Rand=r,r.prototype.generate=function(S){return this._rand(S)},r.prototype._rand=function(S){if(this.rand.getBytes)return this.rand.getBytes(S);for(var C=new Uint8Array(S),A=0;A<C.length;A++)C[A]=this.rand.getByte();return C},typeof self=="object")self.crypto&&self.crypto.getRandomValues?r.prototype._rand=function(S){var C=new Uint8Array(S);return self.crypto.getRandomValues(C),C}:self.msCrypto&&self.msCrypto.getRandomValues?r.prototype._rand=function(S){var C=new Uint8Array(S);return self.msCrypto.getRandomValues(C),C}:typeof window=="object"&&(r.prototype._rand=function(){throw new Error("Not implemented yet")});else try{var _=requireCryptoBrowserify();if(typeof _.randomBytes!="function")throw new Error("Not supported");r.prototype._rand=function(S){return _.randomBytes(S)}}catch{}return brorand.exports}var mr,hasRequiredMr;function requireMr(){if(hasRequiredMr)return mr;hasRequiredMr=1;var n=requireBn$1(),r=requireBrorand();function _(E){this.rand=E||new r.Rand}return mr=_,_.create=function(S){return new _(S)},_.prototype._randbelow=function(S){var C=S.bitLength(),A=Math.ceil(C/8);do var I=new n(this.rand.generate(A));while(I.cmp(S)>=0);return I},_.prototype._randrange=function(S,C){var A=C.sub(S);return S.add(this._randbelow(A))},_.prototype.test=function(S,C,A){var I=S.bitLength(),B=n.mont(S),O=new n(1).toRed(B);C||(C=Math.max(1,I/48|0));for(var N=S.subn(1),U=0;!N.testn(U);U++);for(var j=S.shrn(U),z=N.toRed(B),Z=!0;C>0;C--){var X=this._randrange(new n(2),N);A&&A(X);var Q=X.toRed(B).redPow(j);if(!(Q.cmp(O)===0||Q.cmp(z)===0)){for(var se=1;se<U;se++){if(Q=Q.redSqr(),Q.cmp(O)===0)return!1;if(Q.cmp(z)===0)break}if(se===U)return!1}}return Z},_.prototype.getDivisor=function(S,C){var A=S.bitLength(),I=n.mont(S),B=new n(1).toRed(I);C||(C=Math.max(1,A/48|0));for(var O=S.subn(1),N=0;!O.testn(N);N++);for(var U=S.shrn(N),j=O.toRed(I);C>0;C--){var z=this._randrange(new n(2),O),Z=S.gcd(z);if(Z.cmpn(1)!==0)return Z;var X=z.toRed(I).redPow(U);if(!(X.cmp(B)===0||X.cmp(j)===0)){for(var Q=1;Q<N;Q++){if(X=X.redSqr(),X.cmp(B)===0)return X.fromRed().subn(1).gcd(S);if(X.cmp(j)===0)break}if(Q===N)return X=X.redSqr(),X.fromRed().subn(1).gcd(S)}}return!1},mr}var generatePrime,hasRequiredGeneratePrime;function requireGeneratePrime(){if(hasRequiredGeneratePrime)return generatePrime;hasRequiredGeneratePrime=1;var n=requireBrowser$b();generatePrime=Q,Q.simpleSieve=Z,Q.fermatTest=X;var r=requireBn$1(),_=new r(24),E=requireMr(),S=new E,C=new r(1),A=new r(2),I=new r(5);new r(16),new r(8);var B=new r(10),O=new r(3);new r(7);var N=new r(11),U=new r(4);new r(12);var j=null;function z(){if(j!==null)return j;var se=1048576,oe=[];oe[0]=2;for(var ue=1,we=3;we<se;we+=2){for(var Te=Math.ceil(Math.sqrt(we)),xe=0;xe<ue&&oe[xe]<=Te&&we%oe[xe]!==0;xe++);ue!==xe&&oe[xe]<=Te||(oe[ue++]=we)}return j=oe,oe}function Z(se){for(var oe=z(),ue=0;ue<oe.length;ue++)if(se.modn(oe[ue])===0)return se.cmpn(oe[ue])===0;return!0}function X(se){var oe=r.mont(se);return A.toRed(oe).redPow(se.subn(1)).fromRed().cmpn(1)===0}function Q(se,oe){if(se<16)return oe===2||oe===5?new r([140,123]):new r([140,39]);oe=new r(oe);for(var ue,we;;){for(ue=new r(n(Math.ceil(se/8)));ue.bitLength()>se;)ue.ishrn(1);if(ue.isEven()&&ue.iadd(C),ue.testn(1)||ue.iadd(A),oe.cmp(A)){if(!oe.cmp(I))for(;ue.mod(B).cmp(O);)ue.iadd(U)}else for(;ue.mod(_).cmp(N);)ue.iadd(U);if(we=ue.shrn(1),Z(we)&&Z(ue)&&X(we)&&X(ue)&&S.test(we)&&S.test(ue))return ue}}return generatePrime}const modp1={gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a63a3620ffffffffffffffff"},modp2={gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece65381ffffffffffffffff"},modp5={gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca237327ffffffffffffffff"},modp14={gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aacaa68ffffffffffffffff"},modp15={gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aaac42dad33170d04507a33a85521abdf1cba64ecfb850458dbef0a8aea71575d060c7db3970f85a6e1e4c7abf5ae8cdb0933d71e8c94e04a25619dcee3d2261ad2ee6bf12ffa06d98a0864d87602733ec86a64521f2b18177b200cbbe117577a615d6c770988c0bad946e208e24fa074e5ab3143db5bfce0fd108e4b82d120a93ad2caffffffffffffffff"},modp16={gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aaac42dad33170d04507a33a85521abdf1cba64ecfb850458dbef0a8aea71575d060c7db3970f85a6e1e4c7abf5ae8cdb0933d71e8c94e04a25619dcee3d2261ad2ee6bf12ffa06d98a0864d87602733ec86a64521f2b18177b200cbbe117577a615d6c770988c0bad946e208e24fa074e5ab3143db5bfce0fd108e4b82d120a92108011a723c12a787e6d788719a10bdba5b2699c327186af4e23c1a946834b6150bda2583e9ca2ad44ce8dbbbc2db04de8ef92e8efc141fbecaa6287c59474e6bc05d99b2964fa090c3a2233ba186515be7ed1f612970cee2d7afb81bdd762170481cd0069127d5b05aa993b4ea988d8fddc186ffb7dc90a6c08f4df435c934063199ffffffffffffffff"},modp17={gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aaac42dad33170d04507a33a85521abdf1cba64ecfb850458dbef0a8aea71575d060c7db3970f85a6e1e4c7abf5ae8cdb0933d71e8c94e04a25619dcee3d2261ad2ee6bf12ffa06d98a0864d87602733ec86a64521f2b18177b200cbbe117577a615d6c770988c0bad946e208e24fa074e5ab3143db5bfce0fd108e4b82d120a92108011a723c12a787e6d788719a10bdba5b2699c327186af4e23c1a946834b6150bda2583e9ca2ad44ce8dbbbc2db04de8ef92e8efc141fbecaa6287c59474e6bc05d99b2964fa090c3a2233ba186515be7ed1f612970cee2d7afb81bdd762170481cd0069127d5b05aa993b4ea988d8fddc186ffb7dc90a6c08f4df435c93402849236c3fab4d27c7026c1d4dcb2602646dec9751e763dba37bdf8ff9406ad9e530ee5db382f413001aeb06a53ed9027d831179727b0865a8918da3edbebcf9b14ed44ce6cbaced4bb1bdb7f1447e6cc254b332051512bd7af426fb8f401378cd2bf5983ca01c64b92ecf032ea15d1721d03f482d7ce6e74fef6d55e702f46980c82b5a84031900b1c9e59e7c97fbec7e8f323a97a7e36cc88be0f1d45b7ff585ac54bd407b22b4154aacc8f6d7ebf48e1d814cc5ed20f8037e0a79715eef29be32806a1d58bb7c5da76f550aa3d8a1fbff0eb19ccb1a313d55cda56c9ec2ef29632387fe8d76e3c0468043e8f663f4860ee12bf2d5b0b7474d6e694f91e6dcc4024ffffffffffffffff"},modp18={gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aaac42dad33170d04507a33a85521abdf1cba64ecfb850458dbef0a8aea71575d060c7db3970f85a6e1e4c7abf5ae8cdb0933d71e8c94e04a25619dcee3d2261ad2ee6bf12ffa06d98a0864d87602733ec86a64521f2b18177b200cbbe117577a615d6c770988c0bad946e208e24fa074e5ab3143db5bfce0fd108e4b82d120a92108011a723c12a787e6d788719a10bdba5b2699c327186af4e23c1a946834b6150bda2583e9ca2ad44ce8dbbbc2db04de8ef92e8efc141fbecaa6287c59474e6bc05d99b2964fa090c3a2233ba186515be7ed1f612970cee2d7afb81bdd762170481cd0069127d5b05aa993b4ea988d8fddc186ffb7dc90a6c08f4df435c93402849236c3fab4d27c7026c1d4dcb2602646dec9751e763dba37bdf8ff9406ad9e530ee5db382f413001aeb06a53ed9027d831179727b0865a8918da3edbebcf9b14ed44ce6cbaced4bb1bdb7f1447e6cc254b332051512bd7af426fb8f401378cd2bf5983ca01c64b92ecf032ea15d1721d03f482d7ce6e74fef6d55e702f46980c82b5a84031900b1c9e59e7c97fbec7e8f323a97a7e36cc88be0f1d45b7ff585ac54bd407b22b4154aacc8f6d7ebf48e1d814cc5ed20f8037e0a79715eef29be32806a1d58bb7c5da76f550aa3d8a1fbff0eb19ccb1a313d55cda56c9ec2ef29632387fe8d76e3c0468043e8f663f4860ee12bf2d5b0b7474d6e694f91e6dbe115974a3926f12fee5e438777cb6a932df8cd8bec4d073b931ba3bc832b68d9dd300741fa7bf8afc47ed2576f6936ba424663aab639c5ae4f5683423b4742bf1c978238f16cbe39d652de3fdb8befc848ad922222e04a4037c0713eb57a81a23f0c73473fc646cea306b4bcbc8862f8385ddfa9d4b7fa2c087e879683303ed5bdd3a062b3cf5b3a278a66d2a13f83f44f82ddf310ee074ab6a364597e899a0255dc164f31cc50846851df9ab48195ded7ea1b1d510bd7ee74d73faf36bc31ecfa268359046f4eb879f924009438b481c6cd7889a002ed5ee382bc9190da6fc026e479558e4475677e9aa9e3050e2765694dfc81f56e880b96e7160c980dd98edd3dfffffffffffffffff"},require$$1$1={modp1,modp2,modp5,modp14,modp15,modp16,modp17,modp18};var dh,hasRequiredDh;function requireDh(){if(hasRequiredDh)return dh;hasRequiredDh=1;var n=requireBn$1(),r=requireMr(),_=new r,E=new n(24),S=new n(11),C=new n(10),A=new n(3),I=new n(7),B=requireGeneratePrime(),O=requireBrowser$b();dh=Z;function N(Q,se){return se=se||"utf8",Buffer$4.isBuffer(Q)||(Q=new Buffer$4(Q,se)),this._pub=new n(Q),this}function U(Q,se){return se=se||"utf8",Buffer$4.isBuffer(Q)||(Q=new Buffer$4(Q,se)),this._priv=new n(Q),this}var j={};function z(Q,se){var oe=se.toString("hex"),ue=[oe,Q.toString(16)].join("_");if(ue in j)return j[ue];var we=0;if(Q.isEven()||!B.simpleSieve||!B.fermatTest(Q)||!_.test(Q))return we+=1,oe==="02"||oe==="05"?we+=8:we+=4,j[ue]=we,we;_.test(Q.shrn(1))||(we+=2);var Te;switch(oe){case"02":Q.mod(E).cmp(S)&&(we+=8);break;case"05":Te=Q.mod(C),Te.cmp(A)&&Te.cmp(I)&&(we+=8);break;default:we+=4}return j[ue]=we,we}function Z(Q,se,oe){this.setGenerator(se),this.__prime=new n(Q),this._prime=n.mont(this.__prime),this._primeLen=Q.length,this._pub=void 0,this._priv=void 0,this._primeCode=void 0,oe?(this.setPublicKey=N,this.setPrivateKey=U):this._primeCode=8}Object.defineProperty(Z.prototype,"verifyError",{enumerable:!0,get:function(){return typeof this._primeCode!="number"&&(this._primeCode=z(this.__prime,this.__gen)),this._primeCode}}),Z.prototype.generateKeys=function(){return this._priv||(this._priv=new n(O(this._primeLen))),this._pub=this._gen.toRed(this._prime).redPow(this._priv).fromRed(),this.getPublicKey()},Z.prototype.computeSecret=function(Q){Q=new n(Q),Q=Q.toRed(this._prime);var se=Q.redPow(this._priv).fromRed(),oe=new Buffer$4(se.toArray()),ue=this.getPrime();if(oe.length<ue.length){var we=new Buffer$4(ue.length-oe.length);we.fill(0),oe=Buffer$4.concat([we,oe])}return oe},Z.prototype.getPublicKey=function(se){return X(this._pub,se)},Z.prototype.getPrivateKey=function(se){return X(this._priv,se)},Z.prototype.getPrime=function(Q){return X(this.__prime,Q)},Z.prototype.getGenerator=function(Q){return X(this._gen,Q)},Z.prototype.setGenerator=function(Q,se){return se=se||"utf8",Buffer$4.isBuffer(Q)||(Q=new Buffer$4(Q,se)),this.__gen=Q,this._gen=new n(Q),this};function X(Q,se){var oe=new Buffer$4(Q.toArray());return se?oe.toString(se):oe}return dh}var hasRequiredBrowser$4;function requireBrowser$4(){if(hasRequiredBrowser$4)return browser$8;hasRequiredBrowser$4=1;var n=requireGeneratePrime(),r=require$$1$1,_=requireDh();function E(A){var I=new Buffer$4(r[A].prime,"hex"),B=new Buffer$4(r[A].gen,"hex");return new _(I,B)}var S={binary:!0,hex:!0,base64:!0};function C(A,I,B,O){return Buffer$4.isBuffer(I)||S[I]===void 0?C(A,"binary",I,B):(I=I||"binary",O=O||"binary",B=B||new Buffer$4([2]),Buffer$4.isBuffer(B)||(B=new Buffer$4(B,O)),typeof A=="number"?new _(n(A,B),B,!0):(Buffer$4.isBuffer(A)||(A=new Buffer$4(A,I)),new _(A,B,!0)))}return browser$8.DiffieHellmanGroup=browser$8.createDiffieHellmanGroup=browser$8.getDiffieHellman=E,browser$8.createDiffieHellman=browser$8.DiffieHellman=C,browser$8}var readableBrowser={exports:{}},processNextickArgs={exports:{}},hasRequiredProcessNextickArgs;function requireProcessNextickArgs(){if(hasRequiredProcessNextickArgs)return processNextickArgs.exports;hasRequiredProcessNextickArgs=1,typeof browser$1$1>"u"||!browser$1$1.version||browser$1$1.version.indexOf("v0.")===0||browser$1$1.version.indexOf("v1.")===0&&browser$1$1.version.indexOf("v1.8.")!==0?processNextickArgs.exports={nextTick:n}:processNextickArgs.exports=browser$1$1;function n(r,_,E,S){if(typeof r!="function")throw new TypeError('"callback" argument must be a function');var C=arguments.length,A,I;switch(C){case 0:case 1:return browser$1$1.nextTick(r);case 2:return browser$1$1.nextTick(function(){r.call(null,_)});case 3:return browser$1$1.nextTick(function(){r.call(null,_,E)});case 4:return browser$1$1.nextTick(function(){r.call(null,_,E,S)});default:for(A=new Array(C-1),I=0;I<A.length;)A[I++]=arguments[I];return browser$1$1.nextTick(function(){r.apply(null,A)})}}return processNextickArgs.exports}var isarray,hasRequiredIsarray;function requireIsarray(){if(hasRequiredIsarray)return isarray;hasRequiredIsarray=1;var n={}.toString;return isarray=Array.isArray||function(r){return n.call(r)=="[object Array]"},isarray}var streamBrowser,hasRequiredStreamBrowser;function requireStreamBrowser(){return hasRequiredStreamBrowser||(hasRequiredStreamBrowser=1,streamBrowser=eventsExports.EventEmitter),streamBrowser}var util$3={},hasRequiredUtil;function requireUtil(){if(hasRequiredUtil)return util$3;hasRequiredUtil=1;function n(X){return Array.isArray?Array.isArray(X):Z(X)==="[object Array]"}util$3.isArray=n;function r(X){return typeof X=="boolean"}util$3.isBoolean=r;function _(X){return X===null}util$3.isNull=_;function E(X){return X==null}util$3.isNullOrUndefined=E;function S(X){return typeof X=="number"}util$3.isNumber=S;function C(X){return typeof X=="string"}util$3.isString=C;function A(X){return typeof X=="symbol"}util$3.isSymbol=A;function I(X){return X===void 0}util$3.isUndefined=I;function B(X){return Z(X)==="[object RegExp]"}util$3.isRegExp=B;function O(X){return typeof X=="object"&&X!==null}util$3.isObject=O;function N(X){return Z(X)==="[object Date]"}util$3.isDate=N;function U(X){return Z(X)==="[object Error]"||X instanceof Error}util$3.isError=U;function j(X){return typeof X=="function"}util$3.isFunction=j;function z(X){return X===null||typeof X=="boolean"||typeof X=="number"||typeof X=="string"||typeof X=="symbol"||typeof X>"u"}util$3.isPrimitive=z,util$3.isBuffer=buffer$2.Buffer.isBuffer;function Z(X){return Object.prototype.toString.call(X)}return util$3}var BufferList={exports:{}},hasRequiredBufferList;function requireBufferList(){return hasRequiredBufferList||(hasRequiredBufferList=1,function(n){function r(C,A){if(!(C instanceof A))throw new TypeError("Cannot call a class as a function")}var _=safeBufferExports.Buffer,E=require$$1$2;function S(C,A,I){C.copy(A,I)}n.exports=function(){function C(){r(this,C),this.head=null,this.tail=null,this.length=0}return C.prototype.push=function(I){var B={data:I,next:null};this.length>0?this.tail.next=B:this.head=B,this.tail=B,++this.length},C.prototype.unshift=function(I){var B={data:I,next:this.head};this.length===0&&(this.tail=B),this.head=B,++this.length},C.prototype.shift=function(){if(this.length!==0){var I=this.head.data;return this.length===1?this.head=this.tail=null:this.head=this.head.next,--this.length,I}},C.prototype.clear=function(){this.head=this.tail=null,this.length=0},C.prototype.join=function(I){if(this.length===0)return"";for(var B=this.head,O=""+B.data;B=B.next;)O+=I+B.data;return O},C.prototype.concat=function(I){if(this.length===0)return _.alloc(0);for(var B=_.allocUnsafe(I>>>0),O=this.head,N=0;O;)S(O.data,B,N),N+=O.data.length,O=O.next;return B},C}(),E&&E.inspect&&E.inspect.custom&&(n.exports.prototype[E.inspect.custom]=function(){var C=E.inspect({length:this.length});return this.constructor.name+" "+C})}(BufferList)),BufferList.exports}var destroy_1,hasRequiredDestroy;function requireDestroy(){if(hasRequiredDestroy)return destroy_1;hasRequiredDestroy=1;var n=requireProcessNextickArgs();function r(S,C){var A=this,I=this._readableState&&this._readableState.destroyed,B=this._writableState&&this._writableState.destroyed;return I||B?(C?C(S):S&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,n.nextTick(E,this,S)):n.nextTick(E,this,S)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(S||null,function(O){!C&&O?A._writableState?A._writableState.errorEmitted||(A._writableState.errorEmitted=!0,n.nextTick(E,A,O)):n.nextTick(E,A,O):C&&C(O)}),this)}function _(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}function E(S,C){S.emit("error",C)}return destroy_1={destroy:r,undestroy:_},destroy_1}var _stream_writable,hasRequired_stream_writable;function require_stream_writable(){if(hasRequired_stream_writable)return _stream_writable;hasRequired_stream_writable=1;var n=requireProcessNextickArgs();_stream_writable=X;function r(Be){var Ge=this;this.next=null,this.entry=null,this.finish=function(){He(Ge,Be)}}var _=!browser$1$1.browser&&["v0.10","v0.9."].indexOf(browser$1$1.version.slice(0,5))>-1?setImmediate:n.nextTick,E;X.WritableState=z;var S=Object.create(requireUtil());S.inherits=inherits_browserExports;var C={deprecate:requireBrowser$a()},A=requireStreamBrowser(),I=safeBufferExports.Buffer,B=(typeof commonjsGlobal<"u"?commonjsGlobal:typeof window<"u"?window:typeof self<"u"?self:{}).Uint8Array||function(){};function O(Be){return I.from(Be)}function N(Be){return I.isBuffer(Be)||Be instanceof B}var U=requireDestroy();S.inherits(X,A);function j(){}function z(Be,Ge){E=E||require_stream_duplex(),Be=Be||{};var je=Ge instanceof E;this.objectMode=!!Be.objectMode,je&&(this.objectMode=this.objectMode||!!Be.writableObjectMode);var Ve=Be.highWaterMark,Pe=Be.writableHighWaterMark,Me=this.objectMode?16:16*1024;Ve||Ve===0?this.highWaterMark=Ve:je&&(Pe||Pe===0)?this.highWaterMark=Pe:this.highWaterMark=Me,this.highWaterMark=Math.floor(this.highWaterMark),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var tt=Be.decodeStrings===!1;this.decodeStrings=!tt,this.defaultEncoding=Be.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(Ke){Re(Ge,Ke)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.bufferedRequestCount=0,this.corkedRequestsFree=new r(this)}z.prototype.getBuffer=function(){for(var Ge=this.bufferedRequest,je=[];Ge;)je.push(Ge),Ge=Ge.next;return je},function(){try{Object.defineProperty(z.prototype,"buffer",{get:C.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch{}}();var Z;typeof Symbol=="function"&&Symbol.hasInstance&&typeof Function.prototype[Symbol.hasInstance]=="function"?(Z=Function.prototype[Symbol.hasInstance],Object.defineProperty(X,Symbol.hasInstance,{value:function(Be){return Z.call(this,Be)?!0:this!==X?!1:Be&&Be._writableState instanceof z}})):Z=function(Be){return Be instanceof this};function X(Be){if(E=E||require_stream_duplex(),!Z.call(X,this)&&!(this instanceof E))return new X(Be);this._writableState=new z(Be,this),this.writable=!0,Be&&(typeof Be.write=="function"&&(this._write=Be.write),typeof Be.writev=="function"&&(this._writev=Be.writev),typeof Be.destroy=="function"&&(this._destroy=Be.destroy),typeof Be.final=="function"&&(this._final=Be.final)),A.call(this)}X.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe, not readable"))};function Q(Be,Ge){var je=new Error("write after end");Be.emit("error",je),n.nextTick(Ge,je)}function se(Be,Ge,je,Ve){var Pe=!0,Me=!1;return je===null?Me=new TypeError("May not write null values to stream"):typeof je!="string"&&je!==void 0&&!Ge.objectMode&&(Me=new TypeError("Invalid non-string/buffer chunk")),Me&&(Be.emit("error",Me),n.nextTick(Ve,Me),Pe=!1),Pe}X.prototype.write=function(Be,Ge,je){var Ve=this._writableState,Pe=!1,Me=!Ve.objectMode&&N(Be);return Me&&!I.isBuffer(Be)&&(Be=O(Be)),typeof Ge=="function"&&(je=Ge,Ge=null),Me?Ge="buffer":Ge||(Ge=Ve.defaultEncoding),typeof je!="function"&&(je=j),Ve.ended?Q(this,je):(Me||se(this,Ve,Be,je))&&(Ve.pendingcb++,Pe=ue(this,Ve,Me,Be,Ge,je)),Pe},X.prototype.cork=function(){var Be=this._writableState;Be.corked++},X.prototype.uncork=function(){var Be=this._writableState;Be.corked&&(Be.corked--,!Be.writing&&!Be.corked&&!Be.bufferProcessing&&Be.bufferedRequest&&ht(this,Be))},X.prototype.setDefaultEncoding=function(Ge){if(typeof Ge=="string"&&(Ge=Ge.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((Ge+"").toLowerCase())>-1))throw new TypeError("Unknown encoding: "+Ge);return this._writableState.defaultEncoding=Ge,this};function oe(Be,Ge,je){return!Be.objectMode&&Be.decodeStrings!==!1&&typeof Ge=="string"&&(Ge=I.from(Ge,je)),Ge}Object.defineProperty(X.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}});function ue(Be,Ge,je,Ve,Pe,Me){if(!je){var tt=oe(Ge,Ve,Pe);Ve!==tt&&(je=!0,Pe="buffer",Ve=tt)}var Ke=Ge.objectMode?1:Ve.length;Ge.length+=Ke;var mt=Ge.length<Ge.highWaterMark;if(mt||(Ge.needDrain=!0),Ge.writing||Ge.corked){var ct=Ge.lastBufferedRequest;Ge.lastBufferedRequest={chunk:Ve,encoding:Pe,isBuf:je,callback:Me,next:null},ct?ct.next=Ge.lastBufferedRequest:Ge.bufferedRequest=Ge.lastBufferedRequest,Ge.bufferedRequestCount+=1}else we(Be,Ge,!1,Ke,Ve,Pe,Me);return mt}function we(Be,Ge,je,Ve,Pe,Me,tt){Ge.writelen=Ve,Ge.writecb=tt,Ge.writing=!0,Ge.sync=!0,je?Be._writev(Pe,Ge.onwrite):Be._write(Pe,Me,Ge.onwrite),Ge.sync=!1}function Te(Be,Ge,je,Ve,Pe){--Ge.pendingcb,je?(n.nextTick(Pe,Ve),n.nextTick(_e,Be,Ge),Be._writableState.errorEmitted=!0,Be.emit("error",Ve)):(Pe(Ve),Be._writableState.errorEmitted=!0,Be.emit("error",Ve),_e(Be,Ge))}function xe(Be){Be.writing=!1,Be.writecb=null,Be.length-=Be.writelen,Be.writelen=0}function Re(Be,Ge){var je=Be._writableState,Ve=je.sync,Pe=je.writecb;if(xe(je),Ge)Te(Be,je,Ve,Ge,Pe);else{var Me=nt(je);!Me&&!je.corked&&!je.bufferProcessing&&je.bufferedRequest&&ht(Be,je),Ve?_(Ne,Be,je,Me,Pe):Ne(Be,je,Me,Pe)}}function Ne(Be,Ge,je,Ve){je||Fe(Be,Ge),Ge.pendingcb--,Ve(),_e(Be,Ge)}function Fe(Be,Ge){Ge.length===0&&Ge.needDrain&&(Ge.needDrain=!1,Be.emit("drain"))}function ht(Be,Ge){Ge.bufferProcessing=!0;var je=Ge.bufferedRequest;if(Be._writev&&je&&je.next){var Ve=Ge.bufferedRequestCount,Pe=new Array(Ve),Me=Ge.corkedRequestsFree;Me.entry=je;for(var tt=0,Ke=!0;je;)Pe[tt]=je,je.isBuf||(Ke=!1),je=je.next,tt+=1;Pe.allBuffers=Ke,we(Be,Ge,!0,Ge.length,Pe,"",Me.finish),Ge.pendingcb++,Ge.lastBufferedRequest=null,Me.next?(Ge.corkedRequestsFree=Me.next,Me.next=null):Ge.corkedRequestsFree=new r(Ge),Ge.bufferedRequestCount=0}else{for(;je;){var mt=je.chunk,ct=je.encoding,Qe=je.callback,dt=Ge.objectMode?1:mt.length;if(we(Be,Ge,!1,dt,mt,ct,Qe),je=je.next,Ge.bufferedRequestCount--,Ge.writing)break}je===null&&(Ge.lastBufferedRequest=null)}Ge.bufferedRequest=je,Ge.bufferProcessing=!1}X.prototype._write=function(Be,Ge,je){je(new Error("_write() is not implemented"))},X.prototype._writev=null,X.prototype.end=function(Be,Ge,je){var Ve=this._writableState;typeof Be=="function"?(je=Be,Be=null,Ge=null):typeof Ge=="function"&&(je=Ge,Ge=null),Be!=null&&this.write(Be,Ge),Ve.corked&&(Ve.corked=1,this.uncork()),Ve.ending||Ie(this,Ve,je)};function nt(Be){return Be.ending&&Be.length===0&&Be.bufferedRequest===null&&!Be.finished&&!Be.writing}function Ee(Be,Ge){Be._final(function(je){Ge.pendingcb--,je&&Be.emit("error",je),Ge.prefinished=!0,Be.emit("prefinish"),_e(Be,Ge)})}function Ce(Be,Ge){!Ge.prefinished&&!Ge.finalCalled&&(typeof Be._final=="function"?(Ge.pendingcb++,Ge.finalCalled=!0,n.nextTick(Ee,Be,Ge)):(Ge.prefinished=!0,Be.emit("prefinish")))}function _e(Be,Ge){var je=nt(Ge);return je&&(Ce(Be,Ge),Ge.pendingcb===0&&(Ge.finished=!0,Be.emit("finish"))),je}function Ie(Be,Ge,je){Ge.ending=!0,_e(Be,Ge),je&&(Ge.finished?n.nextTick(je):Be.once("finish",je)),Ge.ended=!0,Be.writable=!1}function He(Be,Ge,je){var Ve=Be.entry;for(Be.entry=null;Ve;){var Pe=Ve.callback;Ge.pendingcb--,Pe(je),Ve=Ve.next}Ge.corkedRequestsFree.next=Be}return Object.defineProperty(X.prototype,"destroyed",{get:function(){return this._writableState===void 0?!1:this._writableState.destroyed},set:function(Be){this._writableState&&(this._writableState.destroyed=Be)}}),X.prototype.destroy=U.destroy,X.prototype._undestroy=U.undestroy,X.prototype._destroy=function(Be,Ge){this.end(),Ge(Be)},_stream_writable}var _stream_duplex,hasRequired_stream_duplex;function require_stream_duplex(){if(hasRequired_stream_duplex)return _stream_duplex;hasRequired_stream_duplex=1;var n=requireProcessNextickArgs(),r=Object.keys||function(U){var j=[];for(var z in U)j.push(z);return j};_stream_duplex=B;var _=Object.create(requireUtil());_.inherits=inherits_browserExports;var E=require_stream_readable(),S=require_stream_writable();_.inherits(B,E);for(var C=r(S.prototype),A=0;A<C.length;A++){var I=C[A];B.prototype[I]||(B.prototype[I]=S.prototype[I])}function B(U){if(!(this instanceof B))return new B(U);E.call(this,U),S.call(this,U),U&&U.readable===!1&&(this.readable=!1),U&&U.writable===!1&&(this.writable=!1),this.allowHalfOpen=!0,U&&U.allowHalfOpen===!1&&(this.allowHalfOpen=!1),this.once("end",O)}Object.defineProperty(B.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}});function O(){this.allowHalfOpen||this._writableState.ended||n.nextTick(N,this)}function N(U){U.end()}return Object.defineProperty(B.prototype,"destroyed",{get:function(){return this._readableState===void 0||this._writableState===void 0?!1:this._readableState.destroyed&&this._writableState.destroyed},set:function(U){this._readableState===void 0||this._writableState===void 0||(this._readableState.destroyed=U,this._writableState.destroyed=U)}}),B.prototype._destroy=function(U,j){this.push(null),this.end(),n.nextTick(j,U)},_stream_duplex}var _stream_readable,hasRequired_stream_readable;function require_stream_readable(){if(hasRequired_stream_readable)return _stream_readable;hasRequired_stream_readable=1;var n=requireProcessNextickArgs();_stream_readable=oe;var r=requireIsarray(),_;oe.ReadableState=se,eventsExports.EventEmitter;var E=function(Qe,dt){return Qe.listeners(dt).length},S=requireStreamBrowser(),C=safeBufferExports.Buffer,A=(typeof commonjsGlobal<"u"?commonjsGlobal:typeof window<"u"?window:typeof self<"u"?self:{}).Uint8Array||function(){};function I(Qe){return C.from(Qe)}function B(Qe){return C.isBuffer(Qe)||Qe instanceof A}var O=Object.create(requireUtil());O.inherits=inherits_browserExports;var N=require$$1$2,U=void 0;N&&N.debuglog?U=N.debuglog("stream"):U=function(){};var j=requireBufferList(),z=requireDestroy(),Z;O.inherits(oe,S);var X=["error","close","destroy","pause","resume"];function Q(Qe,dt,vt){if(typeof Qe.prependListener=="function")return Qe.prependListener(dt,vt);!Qe._events||!Qe._events[dt]?Qe.on(dt,vt):r(Qe._events[dt])?Qe._events[dt].unshift(vt):Qe._events[dt]=[vt,Qe._events[dt]]}function se(Qe,dt){_=_||require_stream_duplex(),Qe=Qe||{};var vt=dt instanceof _;this.objectMode=!!Qe.objectMode,vt&&(this.objectMode=this.objectMode||!!Qe.readableObjectMode);var At=Qe.highWaterMark,bt=Qe.readableHighWaterMark,ft=this.objectMode?16:16*1024;At||At===0?this.highWaterMark=At:vt&&(bt||bt===0)?this.highWaterMark=bt:this.highWaterMark=ft,this.highWaterMark=Math.floor(this.highWaterMark),this.buffer=new j,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.destroyed=!1,this.defaultEncoding=Qe.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,Qe.encoding&&(Z||(Z=string_decoder.StringDecoder),this.decoder=new Z(Qe.encoding),this.encoding=Qe.encoding)}function oe(Qe){if(_=_||require_stream_duplex(),!(this instanceof oe))return new oe(Qe);this._readableState=new se(Qe,this),this.readable=!0,Qe&&(typeof Qe.read=="function"&&(this._read=Qe.read),typeof Qe.destroy=="function"&&(this._destroy=Qe.destroy)),S.call(this)}Object.defineProperty(oe.prototype,"destroyed",{get:function(){return this._readableState===void 0?!1:this._readableState.destroyed},set:function(Qe){this._readableState&&(this._readableState.destroyed=Qe)}}),oe.prototype.destroy=z.destroy,oe.prototype._undestroy=z.undestroy,oe.prototype._destroy=function(Qe,dt){this.push(null),dt(Qe)},oe.prototype.push=function(Qe,dt){var vt=this._readableState,At;return vt.objectMode?At=!0:typeof Qe=="string"&&(dt=dt||vt.defaultEncoding,dt!==vt.encoding&&(Qe=C.from(Qe,dt),dt=""),At=!0),ue(this,Qe,dt,!1,At)},oe.prototype.unshift=function(Qe){return ue(this,Qe,null,!0,!1)};function ue(Qe,dt,vt,At,bt){var ft=Qe._readableState;if(dt===null)ft.reading=!1,ht(Qe,ft);else{var Et;bt||(Et=Te(ft,dt)),Et?Qe.emit("error",Et):ft.objectMode||dt&&dt.length>0?(typeof dt!="string"&&!ft.objectMode&&Object.getPrototypeOf(dt)!==C.prototype&&(dt=I(dt)),At?ft.endEmitted?Qe.emit("error",new Error("stream.unshift() after end event")):we(Qe,ft,dt,!0):ft.ended?Qe.emit("error",new Error("stream.push() after EOF")):(ft.reading=!1,ft.decoder&&!vt?(dt=ft.decoder.write(dt),ft.objectMode||dt.length!==0?we(Qe,ft,dt,!1):Ce(Qe,ft)):we(Qe,ft,dt,!1))):At||(ft.reading=!1)}return xe(ft)}function we(Qe,dt,vt,At){dt.flowing&&dt.length===0&&!dt.sync?(Qe.emit("data",vt),Qe.read(0)):(dt.length+=dt.objectMode?1:vt.length,At?dt.buffer.unshift(vt):dt.buffer.push(vt),dt.needReadable&&nt(Qe)),Ce(Qe,dt)}function Te(Qe,dt){var vt;return!B(dt)&&typeof dt!="string"&&dt!==void 0&&!Qe.objectMode&&(vt=new TypeError("Invalid non-string/buffer chunk")),vt}function xe(Qe){return!Qe.ended&&(Qe.needReadable||Qe.length<Qe.highWaterMark||Qe.length===0)}oe.prototype.isPaused=function(){return this._readableState.flowing===!1},oe.prototype.setEncoding=function(Qe){return Z||(Z=string_decoder.StringDecoder),this._readableState.decoder=new Z(Qe),this._readableState.encoding=Qe,this};var Re=8388608;function Ne(Qe){return Qe>=Re?Qe=Re:(Qe--,Qe|=Qe>>>1,Qe|=Qe>>>2,Qe|=Qe>>>4,Qe|=Qe>>>8,Qe|=Qe>>>16,Qe++),Qe}function Fe(Qe,dt){return Qe<=0||dt.length===0&&dt.ended?0:dt.objectMode?1:Qe!==Qe?dt.flowing&&dt.length?dt.buffer.head.data.length:dt.length:(Qe>dt.highWaterMark&&(dt.highWaterMark=Ne(Qe)),Qe<=dt.length?Qe:dt.ended?dt.length:(dt.needReadable=!0,0))}oe.prototype.read=function(Qe){U("read",Qe),Qe=parseInt(Qe,10);var dt=this._readableState,vt=Qe;if(Qe!==0&&(dt.emittedReadable=!1),Qe===0&&dt.needReadable&&(dt.length>=dt.highWaterMark||dt.ended))return U("read: emitReadable",dt.length,dt.ended),dt.length===0&&dt.ended?Ke(this):nt(this),null;if(Qe=Fe(Qe,dt),Qe===0&&dt.ended)return dt.length===0&&Ke(this),null;var At=dt.needReadable;U("need readable",At),(dt.length===0||dt.length-Qe<dt.highWaterMark)&&(At=!0,U("length less than watermark",At)),dt.ended||dt.reading?(At=!1,U("reading or ended",At)):At&&(U("do read"),dt.reading=!0,dt.sync=!0,dt.length===0&&(dt.needReadable=!0),this._read(dt.highWaterMark),dt.sync=!1,dt.reading||(Qe=Fe(vt,dt)));var bt;return Qe>0?bt=Ve(Qe,dt):bt=null,bt===null?(dt.needReadable=!0,Qe=0):dt.length-=Qe,dt.length===0&&(dt.ended||(dt.needReadable=!0),vt!==Qe&&dt.ended&&Ke(this)),bt!==null&&this.emit("data",bt),bt};function ht(Qe,dt){if(!dt.ended){if(dt.decoder){var vt=dt.decoder.end();vt&&vt.length&&(dt.buffer.push(vt),dt.length+=dt.objectMode?1:vt.length)}dt.ended=!0,nt(Qe)}}function nt(Qe){var dt=Qe._readableState;dt.needReadable=!1,dt.emittedReadable||(U("emitReadable",dt.flowing),dt.emittedReadable=!0,dt.sync?n.nextTick(Ee,Qe):Ee(Qe))}function Ee(Qe){U("emit readable"),Qe.emit("readable"),je(Qe)}function Ce(Qe,dt){dt.readingMore||(dt.readingMore=!0,n.nextTick(_e,Qe,dt))}function _e(Qe,dt){for(var vt=dt.length;!dt.reading&&!dt.flowing&&!dt.ended&&dt.length<dt.highWaterMark&&(U("maybeReadMore read 0"),Qe.read(0),vt!==dt.length);)vt=dt.length;dt.readingMore=!1}oe.prototype._read=function(Qe){this.emit("error",new Error("_read() is not implemented"))},oe.prototype.pipe=function(Qe,dt){var vt=this,At=this._readableState;switch(At.pipesCount){case 0:At.pipes=Qe;break;case 1:At.pipes=[At.pipes,Qe];break;default:At.pipes.push(Qe);break}At.pipesCount+=1,U("pipe count=%d opts=%j",At.pipesCount,dt);var bt=(!dt||dt.end!==!1)&&Qe!==browser$1$1.stdout&&Qe!==browser$1$1.stderr,ft=bt?Ye:Wt;At.endEmitted?n.nextTick(ft):vt.once("end",ft),Qe.on("unpipe",Et);function Et(Zt,Yt){U("onunpipe"),Zt===vt&&Yt&&Yt.hasUnpiped===!1&&(Yt.hasUnpiped=!0,St())}function Ye(){U("onend"),Qe.end()}var Ct=Ie(vt);Qe.on("drain",Ct);var Pt=!1;function St(){U("cleanup"),Qe.removeListener("close",qt),Qe.removeListener("finish",Mt),Qe.removeListener("drain",Ct),Qe.removeListener("error",Ft),Qe.removeListener("unpipe",Et),vt.removeListener("end",Ye),vt.removeListener("end",Wt),vt.removeListener("data",kt),Pt=!0,At.awaitDrain&&(!Qe._writableState||Qe._writableState.needDrain)&&Ct()}var $t=!1;vt.on("data",kt);function kt(Zt){U("ondata"),$t=!1;var Yt=Qe.write(Zt);Yt===!1&&!$t&&((At.pipesCount===1&&At.pipes===Qe||At.pipesCount>1&&ct(At.pipes,Qe)!==-1)&&!Pt&&(U("false write response, pause",At.awaitDrain),At.awaitDrain++,$t=!0),vt.pause())}function Ft(Zt){U("onerror",Zt),Wt(),Qe.removeListener("error",Ft),E(Qe,"error")===0&&Qe.emit("error",Zt)}Q(Qe,"error",Ft);function qt(){Qe.removeListener("finish",Mt),Wt()}Qe.once("close",qt);function Mt(){U("onfinish"),Qe.removeListener("close",qt),Wt()}Qe.once("finish",Mt);function Wt(){U("unpipe"),vt.unpipe(Qe)}return Qe.emit("pipe",vt),At.flowing||(U("pipe resume"),vt.resume()),Qe};function Ie(Qe){return function(){var dt=Qe._readableState;U("pipeOnDrain",dt.awaitDrain),dt.awaitDrain&&dt.awaitDrain--,dt.awaitDrain===0&&E(Qe,"data")&&(dt.flowing=!0,je(Qe))}}oe.prototype.unpipe=function(Qe){var dt=this._readableState,vt={hasUnpiped:!1};if(dt.pipesCount===0)return this;if(dt.pipesCount===1)return Qe&&Qe!==dt.pipes?this:(Qe||(Qe=dt.pipes),dt.pipes=null,dt.pipesCount=0,dt.flowing=!1,Qe&&Qe.emit("unpipe",this,vt),this);if(!Qe){var At=dt.pipes,bt=dt.pipesCount;dt.pipes=null,dt.pipesCount=0,dt.flowing=!1;for(var ft=0;ft<bt;ft++)At[ft].emit("unpipe",this,{hasUnpiped:!1});return this}var Et=ct(dt.pipes,Qe);return Et===-1?this:(dt.pipes.splice(Et,1),dt.pipesCount-=1,dt.pipesCount===1&&(dt.pipes=dt.pipes[0]),Qe.emit("unpipe",this,vt),this)},oe.prototype.on=function(Qe,dt){var vt=S.prototype.on.call(this,Qe,dt);if(Qe==="data")this._readableState.flowing!==!1&&this.resume();else if(Qe==="readable"){var At=this._readableState;!At.endEmitted&&!At.readableListening&&(At.readableListening=At.needReadable=!0,At.emittedReadable=!1,At.reading?At.length&&nt(this):n.nextTick(He,this))}return vt},oe.prototype.addListener=oe.prototype.on;function He(Qe){U("readable nexttick read 0"),Qe.read(0)}oe.prototype.resume=function(){var Qe=this._readableState;return Qe.flowing||(U("resume"),Qe.flowing=!0,Be(this,Qe)),this};function Be(Qe,dt){dt.resumeScheduled||(dt.resumeScheduled=!0,n.nextTick(Ge,Qe,dt))}function Ge(Qe,dt){dt.reading||(U("resume read 0"),Qe.read(0)),dt.resumeScheduled=!1,dt.awaitDrain=0,Qe.emit("resume"),je(Qe),dt.flowing&&!dt.reading&&Qe.read(0)}oe.prototype.pause=function(){return U("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&(U("pause"),this._readableState.flowing=!1,this.emit("pause")),this};function je(Qe){var dt=Qe._readableState;for(U("flow",dt.flowing);dt.flowing&&Qe.read()!==null;);}oe.prototype.wrap=function(Qe){var dt=this,vt=this._readableState,At=!1;Qe.on("end",function(){if(U("wrapped end"),vt.decoder&&!vt.ended){var Et=vt.decoder.end();Et&&Et.length&&dt.push(Et)}dt.push(null)}),Qe.on("data",function(Et){if(U("wrapped data"),vt.decoder&&(Et=vt.decoder.write(Et)),!(vt.objectMode&&Et==null)&&!(!vt.objectMode&&(!Et||!Et.length))){var Ye=dt.push(Et);Ye||(At=!0,Qe.pause())}});for(var bt in Qe)this[bt]===void 0&&typeof Qe[bt]=="function"&&(this[bt]=function(Et){return function(){return Qe[Et].apply(Qe,arguments)}}(bt));for(var ft=0;ft<X.length;ft++)Qe.on(X[ft],this.emit.bind(this,X[ft]));return this._read=function(Et){U("wrapped _read",Et),At&&(At=!1,Qe.resume())},this},Object.defineProperty(oe.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),oe._fromList=Ve;function Ve(Qe,dt){if(dt.length===0)return null;var vt;return dt.objectMode?vt=dt.buffer.shift():!Qe||Qe>=dt.length?(dt.decoder?vt=dt.buffer.join(""):dt.buffer.length===1?vt=dt.buffer.head.data:vt=dt.buffer.concat(dt.length),dt.buffer.clear()):vt=Pe(Qe,dt.buffer,dt.decoder),vt}function Pe(Qe,dt,vt){var At;return Qe<dt.head.data.length?(At=dt.head.data.slice(0,Qe),dt.head.data=dt.head.data.slice(Qe)):Qe===dt.head.data.length?At=dt.shift():At=vt?Me(Qe,dt):tt(Qe,dt),At}function Me(Qe,dt){var vt=dt.head,At=1,bt=vt.data;for(Qe-=bt.length;vt=vt.next;){var ft=vt.data,Et=Qe>ft.length?ft.length:Qe;if(Et===ft.length?bt+=ft:bt+=ft.slice(0,Qe),Qe-=Et,Qe===0){Et===ft.length?(++At,vt.next?dt.head=vt.next:dt.head=dt.tail=null):(dt.head=vt,vt.data=ft.slice(Et));break}++At}return dt.length-=At,bt}function tt(Qe,dt){var vt=C.allocUnsafe(Qe),At=dt.head,bt=1;for(At.data.copy(vt),Qe-=At.data.length;At=At.next;){var ft=At.data,Et=Qe>ft.length?ft.length:Qe;if(ft.copy(vt,vt.length-Qe,0,Et),Qe-=Et,Qe===0){Et===ft.length?(++bt,At.next?dt.head=At.next:dt.head=dt.tail=null):(dt.head=At,At.data=ft.slice(Et));break}++bt}return dt.length-=bt,vt}function Ke(Qe){var dt=Qe._readableState;if(dt.length>0)throw new Error('"endReadable()" called on non-empty stream');dt.endEmitted||(dt.ended=!0,n.nextTick(mt,dt,Qe))}function mt(Qe,dt){!Qe.endEmitted&&Qe.length===0&&(Qe.endEmitted=!0,dt.readable=!1,dt.emit("end"))}function ct(Qe,dt){for(var vt=0,At=Qe.length;vt<At;vt++)if(Qe[vt]===dt)return vt;return-1}return _stream_readable}var _stream_transform,hasRequired_stream_transform;function require_stream_transform(){if(hasRequired_stream_transform)return _stream_transform;hasRequired_stream_transform=1,_stream_transform=E;var n=require_stream_duplex(),r=Object.create(requireUtil());r.inherits=inherits_browserExports,r.inherits(E,n);function _(A,I){var B=this._transformState;B.transforming=!1;var O=B.writecb;if(!O)return this.emit("error",new Error("write callback called multiple times"));B.writechunk=null,B.writecb=null,I!=null&&this.push(I),O(A);var N=this._readableState;N.reading=!1,(N.needReadable||N.length<N.highWaterMark)&&this._read(N.highWaterMark)}function E(A){if(!(this instanceof E))return new E(A);n.call(this,A),this._transformState={afterTransform:_.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,A&&(typeof A.transform=="function"&&(this._transform=A.transform),typeof A.flush=="function"&&(this._flush=A.flush)),this.on("prefinish",S)}function S(){var A=this;typeof this._flush=="function"?this._flush(function(I,B){C(A,I,B)}):C(this,null,null)}E.prototype.push=function(A,I){return this._transformState.needTransform=!1,n.prototype.push.call(this,A,I)},E.prototype._transform=function(A,I,B){throw new Error("_transform() is not implemented")},E.prototype._write=function(A,I,B){var O=this._transformState;if(O.writecb=B,O.writechunk=A,O.writeencoding=I,!O.transforming){var N=this._readableState;(O.needTransform||N.needReadable||N.length<N.highWaterMark)&&this._read(N.highWaterMark)}},E.prototype._read=function(A){var I=this._transformState;I.writechunk!==null&&I.writecb&&!I.transforming?(I.transforming=!0,this._transform(I.writechunk,I.writeencoding,I.afterTransform)):I.needTransform=!0},E.prototype._destroy=function(A,I){var B=this;n.prototype._destroy.call(this,A,function(O){I(O),B.emit("close")})};function C(A,I,B){if(I)return A.emit("error",I);if(B!=null&&A.push(B),A._writableState.length)throw new Error("Calling transform done when ws.length != 0");if(A._transformState.transforming)throw new Error("Calling transform done when still transforming");return A.push(null)}return _stream_transform}var _stream_passthrough,hasRequired_stream_passthrough;function require_stream_passthrough(){if(hasRequired_stream_passthrough)return _stream_passthrough;hasRequired_stream_passthrough=1,_stream_passthrough=_;var n=require_stream_transform(),r=Object.create(requireUtil());r.inherits=inherits_browserExports,r.inherits(_,n);function _(E){if(!(this instanceof _))return new _(E);n.call(this,E)}return _.prototype._transform=function(E,S,C){C(null,E)},_stream_passthrough}var hasRequiredReadableBrowser;function requireReadableBrowser(){return hasRequiredReadableBrowser||(hasRequiredReadableBrowser=1,function(n,r){r=n.exports=require_stream_readable(),r.Stream=r,r.Readable=r,r.Writable=require_stream_writable(),r.Duplex=require_stream_duplex(),r.Transform=require_stream_transform(),r.PassThrough=require_stream_passthrough()}(readableBrowser,readableBrowser.exports)),readableBrowser.exports}var sign={exports:{}},bn={exports:{}};bn.exports;var hasRequiredBn;function requireBn(){return hasRequiredBn||(hasRequiredBn=1,function(n){(function(r,_){function E(Ce,_e){if(!Ce)throw new Error(_e||"Assertion failed")}function S(Ce,_e){Ce.super_=_e;var Ie=function(){};Ie.prototype=_e.prototype,Ce.prototype=new Ie,Ce.prototype.constructor=Ce}function C(Ce,_e,Ie){if(C.isBN(Ce))return Ce;this.negative=0,this.words=null,this.length=0,this.red=null,Ce!==null&&((_e==="le"||_e==="be")&&(Ie=_e,_e=10),this._init(Ce||0,_e||10,Ie||"be"))}typeof r=="object"?r.exports=C:_.BN=C,C.BN=C,C.wordSize=26;var A;try{typeof window<"u"&&typeof window.Buffer<"u"?A=window.Buffer:A=require$$1$2.Buffer}catch{}C.isBN=function(_e){return _e instanceof C?!0:_e!==null&&typeof _e=="object"&&_e.constructor.wordSize===C.wordSize&&Array.isArray(_e.words)},C.max=function(_e,Ie){return _e.cmp(Ie)>0?_e:Ie},C.min=function(_e,Ie){return _e.cmp(Ie)<0?_e:Ie},C.prototype._init=function(_e,Ie,He){if(typeof _e=="number")return this._initNumber(_e,Ie,He);if(typeof _e=="object")return this._initArray(_e,Ie,He);Ie==="hex"&&(Ie=16),E(Ie===(Ie|0)&&Ie>=2&&Ie<=36),_e=_e.toString().replace(/\s+/g,"");var Be=0;_e[0]==="-"&&(Be++,this.negative=1),Be<_e.length&&(Ie===16?this._parseHex(_e,Be,He):(this._parseBase(_e,Ie,Be),He==="le"&&this._initArray(this.toArray(),Ie,He)))},C.prototype._initNumber=function(_e,Ie,He){_e<0&&(this.negative=1,_e=-_e),_e<67108864?(this.words=[_e&67108863],this.length=1):_e<4503599627370496?(this.words=[_e&67108863,_e/67108864&67108863],this.length=2):(E(_e<9007199254740992),this.words=[_e&67108863,_e/67108864&67108863,1],this.length=3),He==="le"&&this._initArray(this.toArray(),Ie,He)},C.prototype._initArray=function(_e,Ie,He){if(E(typeof _e.length=="number"),_e.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(_e.length/3),this.words=new Array(this.length);for(var Be=0;Be<this.length;Be++)this.words[Be]=0;var Ge,je,Ve=0;if(He==="be")for(Be=_e.length-1,Ge=0;Be>=0;Be-=3)je=_e[Be]|_e[Be-1]<<8|_e[Be-2]<<16,this.words[Ge]|=je<<Ve&67108863,this.words[Ge+1]=je>>>26-Ve&67108863,Ve+=24,Ve>=26&&(Ve-=26,Ge++);else if(He==="le")for(Be=0,Ge=0;Be<_e.length;Be+=3)je=_e[Be]|_e[Be+1]<<8|_e[Be+2]<<16,this.words[Ge]|=je<<Ve&67108863,this.words[Ge+1]=je>>>26-Ve&67108863,Ve+=24,Ve>=26&&(Ve-=26,Ge++);return this._strip()};function I(Ce,_e){var Ie=Ce.charCodeAt(_e);if(Ie>=48&&Ie<=57)return Ie-48;if(Ie>=65&&Ie<=70)return Ie-55;if(Ie>=97&&Ie<=102)return Ie-87;E(!1,"Invalid character in "+Ce)}function B(Ce,_e,Ie){var He=I(Ce,Ie);return Ie-1>=_e&&(He|=I(Ce,Ie-1)<<4),He}C.prototype._parseHex=function(_e,Ie,He){this.length=Math.ceil((_e.length-Ie)/6),this.words=new Array(this.length);for(var Be=0;Be<this.length;Be++)this.words[Be]=0;var Ge=0,je=0,Ve;if(He==="be")for(Be=_e.length-1;Be>=Ie;Be-=2)Ve=B(_e,Ie,Be)<<Ge,this.words[je]|=Ve&67108863,Ge>=18?(Ge-=18,je+=1,this.words[je]|=Ve>>>26):Ge+=8;else{var Pe=_e.length-Ie;for(Be=Pe%2===0?Ie+1:Ie;Be<_e.length;Be+=2)Ve=B(_e,Ie,Be)<<Ge,this.words[je]|=Ve&67108863,Ge>=18?(Ge-=18,je+=1,this.words[je]|=Ve>>>26):Ge+=8}this._strip()};function O(Ce,_e,Ie,He){for(var Be=0,Ge=0,je=Math.min(Ce.length,Ie),Ve=_e;Ve<je;Ve++){var Pe=Ce.charCodeAt(Ve)-48;Be*=He,Pe>=49?Ge=Pe-49+10:Pe>=17?Ge=Pe-17+10:Ge=Pe,E(Pe>=0&&Ge<He,"Invalid character"),Be+=Ge}return Be}C.prototype._parseBase=function(_e,Ie,He){this.words=[0],this.length=1;for(var Be=0,Ge=1;Ge<=67108863;Ge*=Ie)Be++;Be--,Ge=Ge/Ie|0;for(var je=_e.length-He,Ve=je%Be,Pe=Math.min(je,je-Ve)+He,Me=0,tt=He;tt<Pe;tt+=Be)Me=O(_e,tt,tt+Be,Ie),this.imuln(Ge),this.words[0]+Me<67108864?this.words[0]+=Me:this._iaddn(Me);if(Ve!==0){var Ke=1;for(Me=O(_e,tt,_e.length,Ie),tt=0;tt<Ve;tt++)Ke*=Ie;this.imuln(Ke),this.words[0]+Me<67108864?this.words[0]+=Me:this._iaddn(Me)}this._strip()},C.prototype.copy=function(_e){_e.words=new Array(this.length);for(var Ie=0;Ie<this.length;Ie++)_e.words[Ie]=this.words[Ie];_e.length=this.length,_e.negative=this.negative,_e.red=this.red};function N(Ce,_e){Ce.words=_e.words,Ce.length=_e.length,Ce.negative=_e.negative,Ce.red=_e.red}if(C.prototype._move=function(_e){N(_e,this)},C.prototype.clone=function(){var _e=new C(null);return this.copy(_e),_e},C.prototype._expand=function(_e){for(;this.length<_e;)this.words[this.length++]=0;return this},C.prototype._strip=function(){for(;this.length>1&&this.words[this.length-1]===0;)this.length--;return this._normSign()},C.prototype._normSign=function(){return this.length===1&&this.words[0]===0&&(this.negative=0),this},typeof Symbol<"u"&&typeof Symbol.for=="function")try{C.prototype[Symbol.for("nodejs.util.inspect.custom")]=U}catch{C.prototype.inspect=U}else C.prototype.inspect=U;function U(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"}var j=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],z=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],Z=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];C.prototype.toString=function(_e,Ie){_e=_e||10,Ie=Ie|0||1;var He;if(_e===16||_e==="hex"){He="";for(var Be=0,Ge=0,je=0;je<this.length;je++){var Ve=this.words[je],Pe=((Ve<<Be|Ge)&16777215).toString(16);Ge=Ve>>>24-Be&16777215,Be+=2,Be>=26&&(Be-=26,je--),Ge!==0||je!==this.length-1?He=j[6-Pe.length]+Pe+He:He=Pe+He}for(Ge!==0&&(He=Ge.toString(16)+He);He.length%Ie!==0;)He="0"+He;return this.negative!==0&&(He="-"+He),He}if(_e===(_e|0)&&_e>=2&&_e<=36){var Me=z[_e],tt=Z[_e];He="";var Ke=this.clone();for(Ke.negative=0;!Ke.isZero();){var mt=Ke.modrn(tt).toString(_e);Ke=Ke.idivn(tt),Ke.isZero()?He=mt+He:He=j[Me-mt.length]+mt+He}for(this.isZero()&&(He="0"+He);He.length%Ie!==0;)He="0"+He;return this.negative!==0&&(He="-"+He),He}E(!1,"Base should be between 2 and 36")},C.prototype.toNumber=function(){var _e=this.words[0];return this.length===2?_e+=this.words[1]*67108864:this.length===3&&this.words[2]===1?_e+=4503599627370496+this.words[1]*67108864:this.length>2&&E(!1,"Number can only safely store up to 53 bits"),this.negative!==0?-_e:_e},C.prototype.toJSON=function(){return this.toString(16,2)},A&&(C.prototype.toBuffer=function(_e,Ie){return this.toArrayLike(A,_e,Ie)}),C.prototype.toArray=function(_e,Ie){return this.toArrayLike(Array,_e,Ie)};var X=function(_e,Ie){return _e.allocUnsafe?_e.allocUnsafe(Ie):new _e(Ie)};C.prototype.toArrayLike=function(_e,Ie,He){this._strip();var Be=this.byteLength(),Ge=He||Math.max(1,Be);E(Be<=Ge,"byte array longer than desired length"),E(Ge>0,"Requested array length <= 0");var je=X(_e,Ge),Ve=Ie==="le"?"LE":"BE";return this["_toArrayLike"+Ve](je,Be),je},C.prototype._toArrayLikeLE=function(_e,Ie){for(var He=0,Be=0,Ge=0,je=0;Ge<this.length;Ge++){var Ve=this.words[Ge]<<je|Be;_e[He++]=Ve&255,He<_e.length&&(_e[He++]=Ve>>8&255),He<_e.length&&(_e[He++]=Ve>>16&255),je===6?(He<_e.length&&(_e[He++]=Ve>>24&255),Be=0,je=0):(Be=Ve>>>24,je+=2)}if(He<_e.length)for(_e[He++]=Be;He<_e.length;)_e[He++]=0},C.prototype._toArrayLikeBE=function(_e,Ie){for(var He=_e.length-1,Be=0,Ge=0,je=0;Ge<this.length;Ge++){var Ve=this.words[Ge]<<je|Be;_e[He--]=Ve&255,He>=0&&(_e[He--]=Ve>>8&255),He>=0&&(_e[He--]=Ve>>16&255),je===6?(He>=0&&(_e[He--]=Ve>>24&255),Be=0,je=0):(Be=Ve>>>24,je+=2)}if(He>=0)for(_e[He--]=Be;He>=0;)_e[He--]=0},Math.clz32?C.prototype._countBits=function(_e){return 32-Math.clz32(_e)}:C.prototype._countBits=function(_e){var Ie=_e,He=0;return Ie>=4096&&(He+=13,Ie>>>=13),Ie>=64&&(He+=7,Ie>>>=7),Ie>=8&&(He+=4,Ie>>>=4),Ie>=2&&(He+=2,Ie>>>=2),He+Ie},C.prototype._zeroBits=function(_e){if(_e===0)return 26;var Ie=_e,He=0;return Ie&8191||(He+=13,Ie>>>=13),Ie&127||(He+=7,Ie>>>=7),Ie&15||(He+=4,Ie>>>=4),Ie&3||(He+=2,Ie>>>=2),Ie&1||He++,He},C.prototype.bitLength=function(){var _e=this.words[this.length-1],Ie=this._countBits(_e);return(this.length-1)*26+Ie};function Q(Ce){for(var _e=new Array(Ce.bitLength()),Ie=0;Ie<_e.length;Ie++){var He=Ie/26|0,Be=Ie%26;_e[Ie]=Ce.words[He]>>>Be&1}return _e}C.prototype.zeroBits=function(){if(this.isZero())return 0;for(var _e=0,Ie=0;Ie<this.length;Ie++){var He=this._zeroBits(this.words[Ie]);if(_e+=He,He!==26)break}return _e},C.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},C.prototype.toTwos=function(_e){return this.negative!==0?this.abs().inotn(_e).iaddn(1):this.clone()},C.prototype.fromTwos=function(_e){return this.testn(_e-1)?this.notn(_e).iaddn(1).ineg():this.clone()},C.prototype.isNeg=function(){return this.negative!==0},C.prototype.neg=function(){return this.clone().ineg()},C.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},C.prototype.iuor=function(_e){for(;this.length<_e.length;)this.words[this.length++]=0;for(var Ie=0;Ie<_e.length;Ie++)this.words[Ie]=this.words[Ie]|_e.words[Ie];return this._strip()},C.prototype.ior=function(_e){return E((this.negative|_e.negative)===0),this.iuor(_e)},C.prototype.or=function(_e){return this.length>_e.length?this.clone().ior(_e):_e.clone().ior(this)},C.prototype.uor=function(_e){return this.length>_e.length?this.clone().iuor(_e):_e.clone().iuor(this)},C.prototype.iuand=function(_e){var Ie;this.length>_e.length?Ie=_e:Ie=this;for(var He=0;He<Ie.length;He++)this.words[He]=this.words[He]&_e.words[He];return this.length=Ie.length,this._strip()},C.prototype.iand=function(_e){return E((this.negative|_e.negative)===0),this.iuand(_e)},C.prototype.and=function(_e){return this.length>_e.length?this.clone().iand(_e):_e.clone().iand(this)},C.prototype.uand=function(_e){return this.length>_e.length?this.clone().iuand(_e):_e.clone().iuand(this)},C.prototype.iuxor=function(_e){var Ie,He;this.length>_e.length?(Ie=this,He=_e):(Ie=_e,He=this);for(var Be=0;Be<He.length;Be++)this.words[Be]=Ie.words[Be]^He.words[Be];if(this!==Ie)for(;Be<Ie.length;Be++)this.words[Be]=Ie.words[Be];return this.length=Ie.length,this._strip()},C.prototype.ixor=function(_e){return E((this.negative|_e.negative)===0),this.iuxor(_e)},C.prototype.xor=function(_e){return this.length>_e.length?this.clone().ixor(_e):_e.clone().ixor(this)},C.prototype.uxor=function(_e){return this.length>_e.length?this.clone().iuxor(_e):_e.clone().iuxor(this)},C.prototype.inotn=function(_e){E(typeof _e=="number"&&_e>=0);var Ie=Math.ceil(_e/26)|0,He=_e%26;this._expand(Ie),He>0&&Ie--;for(var Be=0;Be<Ie;Be++)this.words[Be]=~this.words[Be]&67108863;return He>0&&(this.words[Be]=~this.words[Be]&67108863>>26-He),this._strip()},C.prototype.notn=function(_e){return this.clone().inotn(_e)},C.prototype.setn=function(_e,Ie){E(typeof _e=="number"&&_e>=0);var He=_e/26|0,Be=_e%26;return this._expand(He+1),Ie?this.words[He]=this.words[He]|1<<Be:this.words[He]=this.words[He]&~(1<<Be),this._strip()},C.prototype.iadd=function(_e){var Ie;if(this.negative!==0&&_e.negative===0)return this.negative=0,Ie=this.isub(_e),this.negative^=1,this._normSign();if(this.negative===0&&_e.negative!==0)return _e.negative=0,Ie=this.isub(_e),_e.negative=1,Ie._normSign();var He,Be;this.length>_e.length?(He=this,Be=_e):(He=_e,Be=this);for(var Ge=0,je=0;je<Be.length;je++)Ie=(He.words[je]|0)+(Be.words[je]|0)+Ge,this.words[je]=Ie&67108863,Ge=Ie>>>26;for(;Ge!==0&&je<He.length;je++)Ie=(He.words[je]|0)+Ge,this.words[je]=Ie&67108863,Ge=Ie>>>26;if(this.length=He.length,Ge!==0)this.words[this.length]=Ge,this.length++;else if(He!==this)for(;je<He.length;je++)this.words[je]=He.words[je];return this},C.prototype.add=function(_e){var Ie;return _e.negative!==0&&this.negative===0?(_e.negative=0,Ie=this.sub(_e),_e.negative^=1,Ie):_e.negative===0&&this.negative!==0?(this.negative=0,Ie=_e.sub(this),this.negative=1,Ie):this.length>_e.length?this.clone().iadd(_e):_e.clone().iadd(this)},C.prototype.isub=function(_e){if(_e.negative!==0){_e.negative=0;var Ie=this.iadd(_e);return _e.negative=1,Ie._normSign()}else if(this.negative!==0)return this.negative=0,this.iadd(_e),this.negative=1,this._normSign();var He=this.cmp(_e);if(He===0)return this.negative=0,this.length=1,this.words[0]=0,this;var Be,Ge;He>0?(Be=this,Ge=_e):(Be=_e,Ge=this);for(var je=0,Ve=0;Ve<Ge.length;Ve++)Ie=(Be.words[Ve]|0)-(Ge.words[Ve]|0)+je,je=Ie>>26,this.words[Ve]=Ie&67108863;for(;je!==0&&Ve<Be.length;Ve++)Ie=(Be.words[Ve]|0)+je,je=Ie>>26,this.words[Ve]=Ie&67108863;if(je===0&&Ve<Be.length&&Be!==this)for(;Ve<Be.length;Ve++)this.words[Ve]=Be.words[Ve];return this.length=Math.max(this.length,Ve),Be!==this&&(this.negative=1),this._strip()},C.prototype.sub=function(_e){return this.clone().isub(_e)};function se(Ce,_e,Ie){Ie.negative=_e.negative^Ce.negative;var He=Ce.length+_e.length|0;Ie.length=He,He=He-1|0;var Be=Ce.words[0]|0,Ge=_e.words[0]|0,je=Be*Ge,Ve=je&67108863,Pe=je/67108864|0;Ie.words[0]=Ve;for(var Me=1;Me<He;Me++){for(var tt=Pe>>>26,Ke=Pe&67108863,mt=Math.min(Me,_e.length-1),ct=Math.max(0,Me-Ce.length+1);ct<=mt;ct++){var Qe=Me-ct|0;Be=Ce.words[Qe]|0,Ge=_e.words[ct]|0,je=Be*Ge+Ke,tt+=je/67108864|0,Ke=je&67108863}Ie.words[Me]=Ke|0,Pe=tt|0}return Pe!==0?Ie.words[Me]=Pe|0:Ie.length--,Ie._strip()}var oe=function(_e,Ie,He){var Be=_e.words,Ge=Ie.words,je=He.words,Ve=0,Pe,Me,tt,Ke=Be[0]|0,mt=Ke&8191,ct=Ke>>>13,Qe=Be[1]|0,dt=Qe&8191,vt=Qe>>>13,At=Be[2]|0,bt=At&8191,ft=At>>>13,Et=Be[3]|0,Ye=Et&8191,Ct=Et>>>13,Pt=Be[4]|0,St=Pt&8191,$t=Pt>>>13,kt=Be[5]|0,Ft=kt&8191,qt=kt>>>13,Mt=Be[6]|0,Wt=Mt&8191,Zt=Mt>>>13,Yt=Be[7]|0,ur=Yt&8191,xt=Yt>>>13,pt=Be[8]|0,yt=pt&8191,Bt=pt>>>13,Ht=Be[9]|0,nr=Ht&8191,Qt=Ht>>>13,xr=Ge[0]|0,kr=xr&8191,Sr=xr>>>13,$r=Ge[1]|0,Rr=$r&8191,Dr=$r>>>13,tn=Ge[2]|0,Jr=tn&8191,Pr=tn>>>13,Wr=Ge[3]|0,Qr=Wr&8191,Fr=Wr>>>13,an=Ge[4]|0,cn=an&8191,Lr=an>>>13,ln=Ge[5]|0,fn=ln&8191,Or=ln>>>13,nn=Ge[6]|0,rn=nn&8191,Kt=nn>>>13,jt=Ge[7]|0,wt=jt&8191,Rt=jt>>>13,Tt=Ge[8]|0,Dt=Tt&8191,Ot=Tt>>>13,Vt=Ge[9]|0,Jt=Vt&8191,lr=Vt>>>13;He.negative=_e.negative^Ie.negative,He.length=19,Pe=Math.imul(mt,kr),Me=Math.imul(mt,Sr),Me=Me+Math.imul(ct,kr)|0,tt=Math.imul(ct,Sr);var tr=(Ve+Pe|0)+((Me&8191)<<13)|0;Ve=(tt+(Me>>>13)|0)+(tr>>>26)|0,tr&=67108863,Pe=Math.imul(dt,kr),Me=Math.imul(dt,Sr),Me=Me+Math.imul(vt,kr)|0,tt=Math.imul(vt,Sr),Pe=Pe+Math.imul(mt,Rr)|0,Me=Me+Math.imul(mt,Dr)|0,Me=Me+Math.imul(ct,Rr)|0,tt=tt+Math.imul(ct,Dr)|0;var ir=(Ve+Pe|0)+((Me&8191)<<13)|0;Ve=(tt+(Me>>>13)|0)+(ir>>>26)|0,ir&=67108863,Pe=Math.imul(bt,kr),Me=Math.imul(bt,Sr),Me=Me+Math.imul(ft,kr)|0,tt=Math.imul(ft,Sr),Pe=Pe+Math.imul(dt,Rr)|0,Me=Me+Math.imul(dt,Dr)|0,Me=Me+Math.imul(vt,Rr)|0,tt=tt+Math.imul(vt,Dr)|0,Pe=Pe+Math.imul(mt,Jr)|0,Me=Me+Math.imul(mt,Pr)|0,Me=Me+Math.imul(ct,Jr)|0,tt=tt+Math.imul(ct,Pr)|0;var sr=(Ve+Pe|0)+((Me&8191)<<13)|0;Ve=(tt+(Me>>>13)|0)+(sr>>>26)|0,sr&=67108863,Pe=Math.imul(Ye,kr),Me=Math.imul(Ye,Sr),Me=Me+Math.imul(Ct,kr)|0,tt=Math.imul(Ct,Sr),Pe=Pe+Math.imul(bt,Rr)|0,Me=Me+Math.imul(bt,Dr)|0,Me=Me+Math.imul(ft,Rr)|0,tt=tt+Math.imul(ft,Dr)|0,Pe=Pe+Math.imul(dt,Jr)|0,Me=Me+Math.imul(dt,Pr)|0,Me=Me+Math.imul(vt,Jr)|0,tt=tt+Math.imul(vt,Pr)|0,Pe=Pe+Math.imul(mt,Qr)|0,Me=Me+Math.imul(mt,Fr)|0,Me=Me+Math.imul(ct,Qr)|0,tt=tt+Math.imul(ct,Fr)|0;var dr=(Ve+Pe|0)+((Me&8191)<<13)|0;Ve=(tt+(Me>>>13)|0)+(dr>>>26)|0,dr&=67108863,Pe=Math.imul(St,kr),Me=Math.imul(St,Sr),Me=Me+Math.imul($t,kr)|0,tt=Math.imul($t,Sr),Pe=Pe+Math.imul(Ye,Rr)|0,Me=Me+Math.imul(Ye,Dr)|0,Me=Me+Math.imul(Ct,Rr)|0,tt=tt+Math.imul(Ct,Dr)|0,Pe=Pe+Math.imul(bt,Jr)|0,Me=Me+Math.imul(bt,Pr)|0,Me=Me+Math.imul(ft,Jr)|0,tt=tt+Math.imul(ft,Pr)|0,Pe=Pe+Math.imul(dt,Qr)|0,Me=Me+Math.imul(dt,Fr)|0,Me=Me+Math.imul(vt,Qr)|0,tt=tt+Math.imul(vt,Fr)|0,Pe=Pe+Math.imul(mt,cn)|0,Me=Me+Math.imul(mt,Lr)|0,Me=Me+Math.imul(ct,cn)|0,tt=tt+Math.imul(ct,Lr)|0;var yr=(Ve+Pe|0)+((Me&8191)<<13)|0;Ve=(tt+(Me>>>13)|0)+(yr>>>26)|0,yr&=67108863,Pe=Math.imul(Ft,kr),Me=Math.imul(Ft,Sr),Me=Me+Math.imul(qt,kr)|0,tt=Math.imul(qt,Sr),Pe=Pe+Math.imul(St,Rr)|0,Me=Me+Math.imul(St,Dr)|0,Me=Me+Math.imul($t,Rr)|0,tt=tt+Math.imul($t,Dr)|0,Pe=Pe+Math.imul(Ye,Jr)|0,Me=Me+Math.imul(Ye,Pr)|0,Me=Me+Math.imul(Ct,Jr)|0,tt=tt+Math.imul(Ct,Pr)|0,Pe=Pe+Math.imul(bt,Qr)|0,Me=Me+Math.imul(bt,Fr)|0,Me=Me+Math.imul(ft,Qr)|0,tt=tt+Math.imul(ft,Fr)|0,Pe=Pe+Math.imul(dt,cn)|0,Me=Me+Math.imul(dt,Lr)|0,Me=Me+Math.imul(vt,cn)|0,tt=tt+Math.imul(vt,Lr)|0,Pe=Pe+Math.imul(mt,fn)|0,Me=Me+Math.imul(mt,Or)|0,Me=Me+Math.imul(ct,fn)|0,tt=tt+Math.imul(ct,Or)|0;var Er=(Ve+Pe|0)+((Me&8191)<<13)|0;Ve=(tt+(Me>>>13)|0)+(Er>>>26)|0,Er&=67108863,Pe=Math.imul(Wt,kr),Me=Math.imul(Wt,Sr),Me=Me+Math.imul(Zt,kr)|0,tt=Math.imul(Zt,Sr),Pe=Pe+Math.imul(Ft,Rr)|0,Me=Me+Math.imul(Ft,Dr)|0,Me=Me+Math.imul(qt,Rr)|0,tt=tt+Math.imul(qt,Dr)|0,Pe=Pe+Math.imul(St,Jr)|0,Me=Me+Math.imul(St,Pr)|0,Me=Me+Math.imul($t,Jr)|0,tt=tt+Math.imul($t,Pr)|0,Pe=Pe+Math.imul(Ye,Qr)|0,Me=Me+Math.imul(Ye,Fr)|0,Me=Me+Math.imul(Ct,Qr)|0,tt=tt+Math.imul(Ct,Fr)|0,Pe=Pe+Math.imul(bt,cn)|0,Me=Me+Math.imul(bt,Lr)|0,Me=Me+Math.imul(ft,cn)|0,tt=tt+Math.imul(ft,Lr)|0,Pe=Pe+Math.imul(dt,fn)|0,Me=Me+Math.imul(dt,Or)|0,Me=Me+Math.imul(vt,fn)|0,tt=tt+Math.imul(vt,Or)|0,Pe=Pe+Math.imul(mt,rn)|0,Me=Me+Math.imul(mt,Kt)|0,Me=Me+Math.imul(ct,rn)|0,tt=tt+Math.imul(ct,Kt)|0;var pr=(Ve+Pe|0)+((Me&8191)<<13)|0;Ve=(tt+(Me>>>13)|0)+(pr>>>26)|0,pr&=67108863,Pe=Math.imul(ur,kr),Me=Math.imul(ur,Sr),Me=Me+Math.imul(xt,kr)|0,tt=Math.imul(xt,Sr),Pe=Pe+Math.imul(Wt,Rr)|0,Me=Me+Math.imul(Wt,Dr)|0,Me=Me+Math.imul(Zt,Rr)|0,tt=tt+Math.imul(Zt,Dr)|0,Pe=Pe+Math.imul(Ft,Jr)|0,Me=Me+Math.imul(Ft,Pr)|0,Me=Me+Math.imul(qt,Jr)|0,tt=tt+Math.imul(qt,Pr)|0,Pe=Pe+Math.imul(St,Qr)|0,Me=Me+Math.imul(St,Fr)|0,Me=Me+Math.imul($t,Qr)|0,tt=tt+Math.imul($t,Fr)|0,Pe=Pe+Math.imul(Ye,cn)|0,Me=Me+Math.imul(Ye,Lr)|0,Me=Me+Math.imul(Ct,cn)|0,tt=tt+Math.imul(Ct,Lr)|0,Pe=Pe+Math.imul(bt,fn)|0,Me=Me+Math.imul(bt,Or)|0,Me=Me+Math.imul(ft,fn)|0,tt=tt+Math.imul(ft,Or)|0,Pe=Pe+Math.imul(dt,rn)|0,Me=Me+Math.imul(dt,Kt)|0,Me=Me+Math.imul(vt,rn)|0,tt=tt+Math.imul(vt,Kt)|0,Pe=Pe+Math.imul(mt,wt)|0,Me=Me+Math.imul(mt,Rt)|0,Me=Me+Math.imul(ct,wt)|0,tt=tt+Math.imul(ct,Rt)|0;var _r=(Ve+Pe|0)+((Me&8191)<<13)|0;Ve=(tt+(Me>>>13)|0)+(_r>>>26)|0,_r&=67108863,Pe=Math.imul(yt,kr),Me=Math.imul(yt,Sr),Me=Me+Math.imul(Bt,kr)|0,tt=Math.imul(Bt,Sr),Pe=Pe+Math.imul(ur,Rr)|0,Me=Me+Math.imul(ur,Dr)|0,Me=Me+Math.imul(xt,Rr)|0,tt=tt+Math.imul(xt,Dr)|0,Pe=Pe+Math.imul(Wt,Jr)|0,Me=Me+Math.imul(Wt,Pr)|0,Me=Me+Math.imul(Zt,Jr)|0,tt=tt+Math.imul(Zt,Pr)|0,Pe=Pe+Math.imul(Ft,Qr)|0,Me=Me+Math.imul(Ft,Fr)|0,Me=Me+Math.imul(qt,Qr)|0,tt=tt+Math.imul(qt,Fr)|0,Pe=Pe+Math.imul(St,cn)|0,Me=Me+Math.imul(St,Lr)|0,Me=Me+Math.imul($t,cn)|0,tt=tt+Math.imul($t,Lr)|0,Pe=Pe+Math.imul(Ye,fn)|0,Me=Me+Math.imul(Ye,Or)|0,Me=Me+Math.imul(Ct,fn)|0,tt=tt+Math.imul(Ct,Or)|0,Pe=Pe+Math.imul(bt,rn)|0,Me=Me+Math.imul(bt,Kt)|0,Me=Me+Math.imul(ft,rn)|0,tt=tt+Math.imul(ft,Kt)|0,Pe=Pe+Math.imul(dt,wt)|0,Me=Me+Math.imul(dt,Rt)|0,Me=Me+Math.imul(vt,wt)|0,tt=tt+Math.imul(vt,Rt)|0,Pe=Pe+Math.imul(mt,Dt)|0,Me=Me+Math.imul(mt,Ot)|0,Me=Me+Math.imul(ct,Dt)|0,tt=tt+Math.imul(ct,Ot)|0;var Ar=(Ve+Pe|0)+((Me&8191)<<13)|0;Ve=(tt+(Me>>>13)|0)+(Ar>>>26)|0,Ar&=67108863,Pe=Math.imul(nr,kr),Me=Math.imul(nr,Sr),Me=Me+Math.imul(Qt,kr)|0,tt=Math.imul(Qt,Sr),Pe=Pe+Math.imul(yt,Rr)|0,Me=Me+Math.imul(yt,Dr)|0,Me=Me+Math.imul(Bt,Rr)|0,tt=tt+Math.imul(Bt,Dr)|0,Pe=Pe+Math.imul(ur,Jr)|0,Me=Me+Math.imul(ur,Pr)|0,Me=Me+Math.imul(xt,Jr)|0,tt=tt+Math.imul(xt,Pr)|0,Pe=Pe+Math.imul(Wt,Qr)|0,Me=Me+Math.imul(Wt,Fr)|0,Me=Me+Math.imul(Zt,Qr)|0,tt=tt+Math.imul(Zt,Fr)|0,Pe=Pe+Math.imul(Ft,cn)|0,Me=Me+Math.imul(Ft,Lr)|0,Me=Me+Math.imul(qt,cn)|0,tt=tt+Math.imul(qt,Lr)|0,Pe=Pe+Math.imul(St,fn)|0,Me=Me+Math.imul(St,Or)|0,Me=Me+Math.imul($t,fn)|0,tt=tt+Math.imul($t,Or)|0,Pe=Pe+Math.imul(Ye,rn)|0,Me=Me+Math.imul(Ye,Kt)|0,Me=Me+Math.imul(Ct,rn)|0,tt=tt+Math.imul(Ct,Kt)|0,Pe=Pe+Math.imul(bt,wt)|0,Me=Me+Math.imul(bt,Rt)|0,Me=Me+Math.imul(ft,wt)|0,tt=tt+Math.imul(ft,Rt)|0,Pe=Pe+Math.imul(dt,Dt)|0,Me=Me+Math.imul(dt,Ot)|0,Me=Me+Math.imul(vt,Dt)|0,tt=tt+Math.imul(vt,Ot)|0,Pe=Pe+Math.imul(mt,Jt)|0,Me=Me+Math.imul(mt,lr)|0,Me=Me+Math.imul(ct,Jt)|0,tt=tt+Math.imul(ct,lr)|0;var Ur=(Ve+Pe|0)+((Me&8191)<<13)|0;Ve=(tt+(Me>>>13)|0)+(Ur>>>26)|0,Ur&=67108863,Pe=Math.imul(nr,Rr),Me=Math.imul(nr,Dr),Me=Me+Math.imul(Qt,Rr)|0,tt=Math.imul(Qt,Dr),Pe=Pe+Math.imul(yt,Jr)|0,Me=Me+Math.imul(yt,Pr)|0,Me=Me+Math.imul(Bt,Jr)|0,tt=tt+Math.imul(Bt,Pr)|0,Pe=Pe+Math.imul(ur,Qr)|0,Me=Me+Math.imul(ur,Fr)|0,Me=Me+Math.imul(xt,Qr)|0,tt=tt+Math.imul(xt,Fr)|0,Pe=Pe+Math.imul(Wt,cn)|0,Me=Me+Math.imul(Wt,Lr)|0,Me=Me+Math.imul(Zt,cn)|0,tt=tt+Math.imul(Zt,Lr)|0,Pe=Pe+Math.imul(Ft,fn)|0,Me=Me+Math.imul(Ft,Or)|0,Me=Me+Math.imul(qt,fn)|0,tt=tt+Math.imul(qt,Or)|0,Pe=Pe+Math.imul(St,rn)|0,Me=Me+Math.imul(St,Kt)|0,Me=Me+Math.imul($t,rn)|0,tt=tt+Math.imul($t,Kt)|0,Pe=Pe+Math.imul(Ye,wt)|0,Me=Me+Math.imul(Ye,Rt)|0,Me=Me+Math.imul(Ct,wt)|0,tt=tt+Math.imul(Ct,Rt)|0,Pe=Pe+Math.imul(bt,Dt)|0,Me=Me+Math.imul(bt,Ot)|0,Me=Me+Math.imul(ft,Dt)|0,tt=tt+Math.imul(ft,Ot)|0,Pe=Pe+Math.imul(dt,Jt)|0,Me=Me+Math.imul(dt,lr)|0,Me=Me+Math.imul(vt,Jt)|0,tt=tt+Math.imul(vt,lr)|0;var Hr=(Ve+Pe|0)+((Me&8191)<<13)|0;Ve=(tt+(Me>>>13)|0)+(Hr>>>26)|0,Hr&=67108863,Pe=Math.imul(nr,Jr),Me=Math.imul(nr,Pr),Me=Me+Math.imul(Qt,Jr)|0,tt=Math.imul(Qt,Pr),Pe=Pe+Math.imul(yt,Qr)|0,Me=Me+Math.imul(yt,Fr)|0,Me=Me+Math.imul(Bt,Qr)|0,tt=tt+Math.imul(Bt,Fr)|0,Pe=Pe+Math.imul(ur,cn)|0,Me=Me+Math.imul(ur,Lr)|0,Me=Me+Math.imul(xt,cn)|0,tt=tt+Math.imul(xt,Lr)|0,Pe=Pe+Math.imul(Wt,fn)|0,Me=Me+Math.imul(Wt,Or)|0,Me=Me+Math.imul(Zt,fn)|0,tt=tt+Math.imul(Zt,Or)|0,Pe=Pe+Math.imul(Ft,rn)|0,Me=Me+Math.imul(Ft,Kt)|0,Me=Me+Math.imul(qt,rn)|0,tt=tt+Math.imul(qt,Kt)|0,Pe=Pe+Math.imul(St,wt)|0,Me=Me+Math.imul(St,Rt)|0,Me=Me+Math.imul($t,wt)|0,tt=tt+Math.imul($t,Rt)|0,Pe=Pe+Math.imul(Ye,Dt)|0,Me=Me+Math.imul(Ye,Ot)|0,Me=Me+Math.imul(Ct,Dt)|0,tt=tt+Math.imul(Ct,Ot)|0,Pe=Pe+Math.imul(bt,Jt)|0,Me=Me+Math.imul(bt,lr)|0,Me=Me+Math.imul(ft,Jt)|0,tt=tt+Math.imul(ft,lr)|0;var Yr=(Ve+Pe|0)+((Me&8191)<<13)|0;Ve=(tt+(Me>>>13)|0)+(Yr>>>26)|0,Yr&=67108863,Pe=Math.imul(nr,Qr),Me=Math.imul(nr,Fr),Me=Me+Math.imul(Qt,Qr)|0,tt=Math.imul(Qt,Fr),Pe=Pe+Math.imul(yt,cn)|0,Me=Me+Math.imul(yt,Lr)|0,Me=Me+Math.imul(Bt,cn)|0,tt=tt+Math.imul(Bt,Lr)|0,Pe=Pe+Math.imul(ur,fn)|0,Me=Me+Math.imul(ur,Or)|0,Me=Me+Math.imul(xt,fn)|0,tt=tt+Math.imul(xt,Or)|0,Pe=Pe+Math.imul(Wt,rn)|0,Me=Me+Math.imul(Wt,Kt)|0,Me=Me+Math.imul(Zt,rn)|0,tt=tt+Math.imul(Zt,Kt)|0,Pe=Pe+Math.imul(Ft,wt)|0,Me=Me+Math.imul(Ft,Rt)|0,Me=Me+Math.imul(qt,wt)|0,tt=tt+Math.imul(qt,Rt)|0,Pe=Pe+Math.imul(St,Dt)|0,Me=Me+Math.imul(St,Ot)|0,Me=Me+Math.imul($t,Dt)|0,tt=tt+Math.imul($t,Ot)|0,Pe=Pe+Math.imul(Ye,Jt)|0,Me=Me+Math.imul(Ye,lr)|0,Me=Me+Math.imul(Ct,Jt)|0,tt=tt+Math.imul(Ct,lr)|0;var dn=(Ve+Pe|0)+((Me&8191)<<13)|0;Ve=(tt+(Me>>>13)|0)+(dn>>>26)|0,dn&=67108863,Pe=Math.imul(nr,cn),Me=Math.imul(nr,Lr),Me=Me+Math.imul(Qt,cn)|0,tt=Math.imul(Qt,Lr),Pe=Pe+Math.imul(yt,fn)|0,Me=Me+Math.imul(yt,Or)|0,Me=Me+Math.imul(Bt,fn)|0,tt=tt+Math.imul(Bt,Or)|0,Pe=Pe+Math.imul(ur,rn)|0,Me=Me+Math.imul(ur,Kt)|0,Me=Me+Math.imul(xt,rn)|0,tt=tt+Math.imul(xt,Kt)|0,Pe=Pe+Math.imul(Wt,wt)|0,Me=Me+Math.imul(Wt,Rt)|0,Me=Me+Math.imul(Zt,wt)|0,tt=tt+Math.imul(Zt,Rt)|0,Pe=Pe+Math.imul(Ft,Dt)|0,Me=Me+Math.imul(Ft,Ot)|0,Me=Me+Math.imul(qt,Dt)|0,tt=tt+Math.imul(qt,Ot)|0,Pe=Pe+Math.imul(St,Jt)|0,Me=Me+Math.imul(St,lr)|0,Me=Me+Math.imul($t,Jt)|0,tt=tt+Math.imul($t,lr)|0;var pn=(Ve+Pe|0)+((Me&8191)<<13)|0;Ve=(tt+(Me>>>13)|0)+(pn>>>26)|0,pn&=67108863,Pe=Math.imul(nr,fn),Me=Math.imul(nr,Or),Me=Me+Math.imul(Qt,fn)|0,tt=Math.imul(Qt,Or),Pe=Pe+Math.imul(yt,rn)|0,Me=Me+Math.imul(yt,Kt)|0,Me=Me+Math.imul(Bt,rn)|0,tt=tt+Math.imul(Bt,Kt)|0,Pe=Pe+Math.imul(ur,wt)|0,Me=Me+Math.imul(ur,Rt)|0,Me=Me+Math.imul(xt,wt)|0,tt=tt+Math.imul(xt,Rt)|0,Pe=Pe+Math.imul(Wt,Dt)|0,Me=Me+Math.imul(Wt,Ot)|0,Me=Me+Math.imul(Zt,Dt)|0,tt=tt+Math.imul(Zt,Ot)|0,Pe=Pe+Math.imul(Ft,Jt)|0,Me=Me+Math.imul(Ft,lr)|0,Me=Me+Math.imul(qt,Jt)|0,tt=tt+Math.imul(qt,lr)|0;var wn=(Ve+Pe|0)+((Me&8191)<<13)|0;Ve=(tt+(Me>>>13)|0)+(wn>>>26)|0,wn&=67108863,Pe=Math.imul(nr,rn),Me=Math.imul(nr,Kt),Me=Me+Math.imul(Qt,rn)|0,tt=Math.imul(Qt,Kt),Pe=Pe+Math.imul(yt,wt)|0,Me=Me+Math.imul(yt,Rt)|0,Me=Me+Math.imul(Bt,wt)|0,tt=tt+Math.imul(Bt,Rt)|0,Pe=Pe+Math.imul(ur,Dt)|0,Me=Me+Math.imul(ur,Ot)|0,Me=Me+Math.imul(xt,Dt)|0,tt=tt+Math.imul(xt,Ot)|0,Pe=Pe+Math.imul(Wt,Jt)|0,Me=Me+Math.imul(Wt,lr)|0,Me=Me+Math.imul(Zt,Jt)|0,tt=tt+Math.imul(Zt,lr)|0;var mn=(Ve+Pe|0)+((Me&8191)<<13)|0;Ve=(tt+(Me>>>13)|0)+(mn>>>26)|0,mn&=67108863,Pe=Math.imul(nr,wt),Me=Math.imul(nr,Rt),Me=Me+Math.imul(Qt,wt)|0,tt=Math.imul(Qt,Rt),Pe=Pe+Math.imul(yt,Dt)|0,Me=Me+Math.imul(yt,Ot)|0,Me=Me+Math.imul(Bt,Dt)|0,tt=tt+Math.imul(Bt,Ot)|0,Pe=Pe+Math.imul(ur,Jt)|0,Me=Me+Math.imul(ur,lr)|0,Me=Me+Math.imul(xt,Jt)|0,tt=tt+Math.imul(xt,lr)|0;var Tn=(Ve+Pe|0)+((Me&8191)<<13)|0;Ve=(tt+(Me>>>13)|0)+(Tn>>>26)|0,Tn&=67108863,Pe=Math.imul(nr,Dt),Me=Math.imul(nr,Ot),Me=Me+Math.imul(Qt,Dt)|0,tt=Math.imul(Qt,Ot),Pe=Pe+Math.imul(yt,Jt)|0,Me=Me+Math.imul(yt,lr)|0,Me=Me+Math.imul(Bt,Jt)|0,tt=tt+Math.imul(Bt,lr)|0;var Rn=(Ve+Pe|0)+((Me&8191)<<13)|0;Ve=(tt+(Me>>>13)|0)+(Rn>>>26)|0,Rn&=67108863,Pe=Math.imul(nr,Jt),Me=Math.imul(nr,lr),Me=Me+Math.imul(Qt,Jt)|0,tt=Math.imul(Qt,lr);var hi=(Ve+Pe|0)+((Me&8191)<<13)|0;return Ve=(tt+(Me>>>13)|0)+(hi>>>26)|0,hi&=67108863,je[0]=tr,je[1]=ir,je[2]=sr,je[3]=dr,je[4]=yr,je[5]=Er,je[6]=pr,je[7]=_r,je[8]=Ar,je[9]=Ur,je[10]=Hr,je[11]=Yr,je[12]=dn,je[13]=pn,je[14]=wn,je[15]=mn,je[16]=Tn,je[17]=Rn,je[18]=hi,Ve!==0&&(je[19]=Ve,He.length++),He};Math.imul||(oe=se);function ue(Ce,_e,Ie){Ie.negative=_e.negative^Ce.negative,Ie.length=Ce.length+_e.length;for(var He=0,Be=0,Ge=0;Ge<Ie.length-1;Ge++){var je=Be;Be=0;for(var Ve=He&67108863,Pe=Math.min(Ge,_e.length-1),Me=Math.max(0,Ge-Ce.length+1);Me<=Pe;Me++){var tt=Ge-Me,Ke=Ce.words[tt]|0,mt=_e.words[Me]|0,ct=Ke*mt,Qe=ct&67108863;je=je+(ct/67108864|0)|0,Qe=Qe+Ve|0,Ve=Qe&67108863,je=je+(Qe>>>26)|0,Be+=je>>>26,je&=67108863}Ie.words[Ge]=Ve,He=je,je=Be}return He!==0?Ie.words[Ge]=He:Ie.length--,Ie._strip()}function we(Ce,_e,Ie){return ue(Ce,_e,Ie)}C.prototype.mulTo=function(_e,Ie){var He,Be=this.length+_e.length;return this.length===10&&_e.length===10?He=oe(this,_e,Ie):Be<63?He=se(this,_e,Ie):Be<1024?He=ue(this,_e,Ie):He=we(this,_e,Ie),He},C.prototype.mul=function(_e){var Ie=new C(null);return Ie.words=new Array(this.length+_e.length),this.mulTo(_e,Ie)},C.prototype.mulf=function(_e){var Ie=new C(null);return Ie.words=new Array(this.length+_e.length),we(this,_e,Ie)},C.prototype.imul=function(_e){return this.clone().mulTo(_e,this)},C.prototype.imuln=function(_e){var Ie=_e<0;Ie&&(_e=-_e),E(typeof _e=="number"),E(_e<67108864);for(var He=0,Be=0;Be<this.length;Be++){var Ge=(this.words[Be]|0)*_e,je=(Ge&67108863)+(He&67108863);He>>=26,He+=Ge/67108864|0,He+=je>>>26,this.words[Be]=je&67108863}return He!==0&&(this.words[Be]=He,this.length++),Ie?this.ineg():this},C.prototype.muln=function(_e){return this.clone().imuln(_e)},C.prototype.sqr=function(){return this.mul(this)},C.prototype.isqr=function(){return this.imul(this.clone())},C.prototype.pow=function(_e){var Ie=Q(_e);if(Ie.length===0)return new C(1);for(var He=this,Be=0;Be<Ie.length&&Ie[Be]===0;Be++,He=He.sqr());if(++Be<Ie.length)for(var Ge=He.sqr();Be<Ie.length;Be++,Ge=Ge.sqr())Ie[Be]!==0&&(He=He.mul(Ge));return He},C.prototype.iushln=function(_e){E(typeof _e=="number"&&_e>=0);var Ie=_e%26,He=(_e-Ie)/26,Be=67108863>>>26-Ie<<26-Ie,Ge;if(Ie!==0){var je=0;for(Ge=0;Ge<this.length;Ge++){var Ve=this.words[Ge]&Be,Pe=(this.words[Ge]|0)-Ve<<Ie;this.words[Ge]=Pe|je,je=Ve>>>26-Ie}je&&(this.words[Ge]=je,this.length++)}if(He!==0){for(Ge=this.length-1;Ge>=0;Ge--)this.words[Ge+He]=this.words[Ge];for(Ge=0;Ge<He;Ge++)this.words[Ge]=0;this.length+=He}return this._strip()},C.prototype.ishln=function(_e){return E(this.negative===0),this.iushln(_e)},C.prototype.iushrn=function(_e,Ie,He){E(typeof _e=="number"&&_e>=0);var Be;Ie?Be=(Ie-Ie%26)/26:Be=0;var Ge=_e%26,je=Math.min((_e-Ge)/26,this.length),Ve=67108863^67108863>>>Ge<<Ge,Pe=He;if(Be-=je,Be=Math.max(0,Be),Pe){for(var Me=0;Me<je;Me++)Pe.words[Me]=this.words[Me];Pe.length=je}if(je!==0)if(this.length>je)for(this.length-=je,Me=0;Me<this.length;Me++)this.words[Me]=this.words[Me+je];else this.words[0]=0,this.length=1;var tt=0;for(Me=this.length-1;Me>=0&&(tt!==0||Me>=Be);Me--){var Ke=this.words[Me]|0;this.words[Me]=tt<<26-Ge|Ke>>>Ge,tt=Ke&Ve}return Pe&&tt!==0&&(Pe.words[Pe.length++]=tt),this.length===0&&(this.words[0]=0,this.length=1),this._strip()},C.prototype.ishrn=function(_e,Ie,He){return E(this.negative===0),this.iushrn(_e,Ie,He)},C.prototype.shln=function(_e){return this.clone().ishln(_e)},C.prototype.ushln=function(_e){return this.clone().iushln(_e)},C.prototype.shrn=function(_e){return this.clone().ishrn(_e)},C.prototype.ushrn=function(_e){return this.clone().iushrn(_e)},C.prototype.testn=function(_e){E(typeof _e=="number"&&_e>=0);var Ie=_e%26,He=(_e-Ie)/26,Be=1<<Ie;if(this.length<=He)return!1;var Ge=this.words[He];return!!(Ge&Be)},C.prototype.imaskn=function(_e){E(typeof _e=="number"&&_e>=0);var Ie=_e%26,He=(_e-Ie)/26;if(E(this.negative===0,"imaskn works only with positive numbers"),this.length<=He)return this;if(Ie!==0&&He++,this.length=Math.min(He,this.length),Ie!==0){var Be=67108863^67108863>>>Ie<<Ie;this.words[this.length-1]&=Be}return this._strip()},C.prototype.maskn=function(_e){return this.clone().imaskn(_e)},C.prototype.iaddn=function(_e){return E(typeof _e=="number"),E(_e<67108864),_e<0?this.isubn(-_e):this.negative!==0?this.length===1&&(this.words[0]|0)<=_e?(this.words[0]=_e-(this.words[0]|0),this.negative=0,this):(this.negative=0,this.isubn(_e),this.negative=1,this):this._iaddn(_e)},C.prototype._iaddn=function(_e){this.words[0]+=_e;for(var Ie=0;Ie<this.length&&this.words[Ie]>=67108864;Ie++)this.words[Ie]-=67108864,Ie===this.length-1?this.words[Ie+1]=1:this.words[Ie+1]++;return this.length=Math.max(this.length,Ie+1),this},C.prototype.isubn=function(_e){if(E(typeof _e=="number"),E(_e<67108864),_e<0)return this.iaddn(-_e);if(this.negative!==0)return this.negative=0,this.iaddn(_e),this.negative=1,this;if(this.words[0]-=_e,this.length===1&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var Ie=0;Ie<this.length&&this.words[Ie]<0;Ie++)this.words[Ie]+=67108864,this.words[Ie+1]-=1;return this._strip()},C.prototype.addn=function(_e){return this.clone().iaddn(_e)},C.prototype.subn=function(_e){return this.clone().isubn(_e)},C.prototype.iabs=function(){return this.negative=0,this},C.prototype.abs=function(){return this.clone().iabs()},C.prototype._ishlnsubmul=function(_e,Ie,He){var Be=_e.length+He,Ge;this._expand(Be);var je,Ve=0;for(Ge=0;Ge<_e.length;Ge++){je=(this.words[Ge+He]|0)+Ve;var Pe=(_e.words[Ge]|0)*Ie;je-=Pe&67108863,Ve=(je>>26)-(Pe/67108864|0),this.words[Ge+He]=je&67108863}for(;Ge<this.length-He;Ge++)je=(this.words[Ge+He]|0)+Ve,Ve=je>>26,this.words[Ge+He]=je&67108863;if(Ve===0)return this._strip();for(E(Ve===-1),Ve=0,Ge=0;Ge<this.length;Ge++)je=-(this.words[Ge]|0)+Ve,Ve=je>>26,this.words[Ge]=je&67108863;return this.negative=1,this._strip()},C.prototype._wordDiv=function(_e,Ie){var He=this.length-_e.length,Be=this.clone(),Ge=_e,je=Ge.words[Ge.length-1]|0,Ve=this._countBits(je);He=26-Ve,He!==0&&(Ge=Ge.ushln(He),Be.iushln(He),je=Ge.words[Ge.length-1]|0);var Pe=Be.length-Ge.length,Me;if(Ie!=="mod"){Me=new C(null),Me.length=Pe+1,Me.words=new Array(Me.length);for(var tt=0;tt<Me.length;tt++)Me.words[tt]=0}var Ke=Be.clone()._ishlnsubmul(Ge,1,Pe);Ke.negative===0&&(Be=Ke,Me&&(Me.words[Pe]=1));for(var mt=Pe-1;mt>=0;mt--){var ct=(Be.words[Ge.length+mt]|0)*67108864+(Be.words[Ge.length+mt-1]|0);for(ct=Math.min(ct/je|0,67108863),Be._ishlnsubmul(Ge,ct,mt);Be.negative!==0;)ct--,Be.negative=0,Be._ishlnsubmul(Ge,1,mt),Be.isZero()||(Be.negative^=1);Me&&(Me.words[mt]=ct)}return Me&&Me._strip(),Be._strip(),Ie!=="div"&&He!==0&&Be.iushrn(He),{div:Me||null,mod:Be}},C.prototype.divmod=function(_e,Ie,He){if(E(!_e.isZero()),this.isZero())return{div:new C(0),mod:new C(0)};var Be,Ge,je;return this.negative!==0&&_e.negative===0?(je=this.neg().divmod(_e,Ie),Ie!=="mod"&&(Be=je.div.neg()),Ie!=="div"&&(Ge=je.mod.neg(),He&&Ge.negative!==0&&Ge.iadd(_e)),{div:Be,mod:Ge}):this.negative===0&&_e.negative!==0?(je=this.divmod(_e.neg(),Ie),Ie!=="mod"&&(Be=je.div.neg()),{div:Be,mod:je.mod}):this.negative&_e.negative?(je=this.neg().divmod(_e.neg(),Ie),Ie!=="div"&&(Ge=je.mod.neg(),He&&Ge.negative!==0&&Ge.isub(_e)),{div:je.div,mod:Ge}):_e.length>this.length||this.cmp(_e)<0?{div:new C(0),mod:this}:_e.length===1?Ie==="div"?{div:this.divn(_e.words[0]),mod:null}:Ie==="mod"?{div:null,mod:new C(this.modrn(_e.words[0]))}:{div:this.divn(_e.words[0]),mod:new C(this.modrn(_e.words[0]))}:this._wordDiv(_e,Ie)},C.prototype.div=function(_e){return this.divmod(_e,"div",!1).div},C.prototype.mod=function(_e){return this.divmod(_e,"mod",!1).mod},C.prototype.umod=function(_e){return this.divmod(_e,"mod",!0).mod},C.prototype.divRound=function(_e){var Ie=this.divmod(_e);if(Ie.mod.isZero())return Ie.div;var He=Ie.div.negative!==0?Ie.mod.isub(_e):Ie.mod,Be=_e.ushrn(1),Ge=_e.andln(1),je=He.cmp(Be);return je<0||Ge===1&&je===0?Ie.div:Ie.div.negative!==0?Ie.div.isubn(1):Ie.div.iaddn(1)},C.prototype.modrn=function(_e){var Ie=_e<0;Ie&&(_e=-_e),E(_e<=67108863);for(var He=(1<<26)%_e,Be=0,Ge=this.length-1;Ge>=0;Ge--)Be=(He*Be+(this.words[Ge]|0))%_e;return Ie?-Be:Be},C.prototype.modn=function(_e){return this.modrn(_e)},C.prototype.idivn=function(_e){var Ie=_e<0;Ie&&(_e=-_e),E(_e<=67108863);for(var He=0,Be=this.length-1;Be>=0;Be--){var Ge=(this.words[Be]|0)+He*67108864;this.words[Be]=Ge/_e|0,He=Ge%_e}return this._strip(),Ie?this.ineg():this},C.prototype.divn=function(_e){return this.clone().idivn(_e)},C.prototype.egcd=function(_e){E(_e.negative===0),E(!_e.isZero());var Ie=this,He=_e.clone();Ie.negative!==0?Ie=Ie.umod(_e):Ie=Ie.clone();for(var Be=new C(1),Ge=new C(0),je=new C(0),Ve=new C(1),Pe=0;Ie.isEven()&&He.isEven();)Ie.iushrn(1),He.iushrn(1),++Pe;for(var Me=He.clone(),tt=Ie.clone();!Ie.isZero();){for(var Ke=0,mt=1;!(Ie.words[0]&mt)&&Ke<26;++Ke,mt<<=1);if(Ke>0)for(Ie.iushrn(Ke);Ke-- >0;)(Be.isOdd()||Ge.isOdd())&&(Be.iadd(Me),Ge.isub(tt)),Be.iushrn(1),Ge.iushrn(1);for(var ct=0,Qe=1;!(He.words[0]&Qe)&&ct<26;++ct,Qe<<=1);if(ct>0)for(He.iushrn(ct);ct-- >0;)(je.isOdd()||Ve.isOdd())&&(je.iadd(Me),Ve.isub(tt)),je.iushrn(1),Ve.iushrn(1);Ie.cmp(He)>=0?(Ie.isub(He),Be.isub(je),Ge.isub(Ve)):(He.isub(Ie),je.isub(Be),Ve.isub(Ge))}return{a:je,b:Ve,gcd:He.iushln(Pe)}},C.prototype._invmp=function(_e){E(_e.negative===0),E(!_e.isZero());var Ie=this,He=_e.clone();Ie.negative!==0?Ie=Ie.umod(_e):Ie=Ie.clone();for(var Be=new C(1),Ge=new C(0),je=He.clone();Ie.cmpn(1)>0&&He.cmpn(1)>0;){for(var Ve=0,Pe=1;!(Ie.words[0]&Pe)&&Ve<26;++Ve,Pe<<=1);if(Ve>0)for(Ie.iushrn(Ve);Ve-- >0;)Be.isOdd()&&Be.iadd(je),Be.iushrn(1);for(var Me=0,tt=1;!(He.words[0]&tt)&&Me<26;++Me,tt<<=1);if(Me>0)for(He.iushrn(Me);Me-- >0;)Ge.isOdd()&&Ge.iadd(je),Ge.iushrn(1);Ie.cmp(He)>=0?(Ie.isub(He),Be.isub(Ge)):(He.isub(Ie),Ge.isub(Be))}var Ke;return Ie.cmpn(1)===0?Ke=Be:Ke=Ge,Ke.cmpn(0)<0&&Ke.iadd(_e),Ke},C.prototype.gcd=function(_e){if(this.isZero())return _e.abs();if(_e.isZero())return this.abs();var Ie=this.clone(),He=_e.clone();Ie.negative=0,He.negative=0;for(var Be=0;Ie.isEven()&&He.isEven();Be++)Ie.iushrn(1),He.iushrn(1);do{for(;Ie.isEven();)Ie.iushrn(1);for(;He.isEven();)He.iushrn(1);var Ge=Ie.cmp(He);if(Ge<0){var je=Ie;Ie=He,He=je}else if(Ge===0||He.cmpn(1)===0)break;Ie.isub(He)}while(!0);return He.iushln(Be)},C.prototype.invm=function(_e){return this.egcd(_e).a.umod(_e)},C.prototype.isEven=function(){return(this.words[0]&1)===0},C.prototype.isOdd=function(){return(this.words[0]&1)===1},C.prototype.andln=function(_e){return this.words[0]&_e},C.prototype.bincn=function(_e){E(typeof _e=="number");var Ie=_e%26,He=(_e-Ie)/26,Be=1<<Ie;if(this.length<=He)return this._expand(He+1),this.words[He]|=Be,this;for(var Ge=Be,je=He;Ge!==0&&je<this.length;je++){var Ve=this.words[je]|0;Ve+=Ge,Ge=Ve>>>26,Ve&=67108863,this.words[je]=Ve}return Ge!==0&&(this.words[je]=Ge,this.length++),this},C.prototype.isZero=function(){return this.length===1&&this.words[0]===0},C.prototype.cmpn=function(_e){var Ie=_e<0;if(this.negative!==0&&!Ie)return-1;if(this.negative===0&&Ie)return 1;this._strip();var He;if(this.length>1)He=1;else{Ie&&(_e=-_e),E(_e<=67108863,"Number is too big");var Be=this.words[0]|0;He=Be===_e?0:Be<_e?-1:1}return this.negative!==0?-He|0:He},C.prototype.cmp=function(_e){if(this.negative!==0&&_e.negative===0)return-1;if(this.negative===0&&_e.negative!==0)return 1;var Ie=this.ucmp(_e);return this.negative!==0?-Ie|0:Ie},C.prototype.ucmp=function(_e){if(this.length>_e.length)return 1;if(this.length<_e.length)return-1;for(var Ie=0,He=this.length-1;He>=0;He--){var Be=this.words[He]|0,Ge=_e.words[He]|0;if(Be!==Ge){Be<Ge?Ie=-1:Be>Ge&&(Ie=1);break}}return Ie},C.prototype.gtn=function(_e){return this.cmpn(_e)===1},C.prototype.gt=function(_e){return this.cmp(_e)===1},C.prototype.gten=function(_e){return this.cmpn(_e)>=0},C.prototype.gte=function(_e){return this.cmp(_e)>=0},C.prototype.ltn=function(_e){return this.cmpn(_e)===-1},C.prototype.lt=function(_e){return this.cmp(_e)===-1},C.prototype.lten=function(_e){return this.cmpn(_e)<=0},C.prototype.lte=function(_e){return this.cmp(_e)<=0},C.prototype.eqn=function(_e){return this.cmpn(_e)===0},C.prototype.eq=function(_e){return this.cmp(_e)===0},C.red=function(_e){return new nt(_e)},C.prototype.toRed=function(_e){return E(!this.red,"Already a number in reduction context"),E(this.negative===0,"red works only with positives"),_e.convertTo(this)._forceRed(_e)},C.prototype.fromRed=function(){return E(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},C.prototype._forceRed=function(_e){return this.red=_e,this},C.prototype.forceRed=function(_e){return E(!this.red,"Already a number in reduction context"),this._forceRed(_e)},C.prototype.redAdd=function(_e){return E(this.red,"redAdd works only with red numbers"),this.red.add(this,_e)},C.prototype.redIAdd=function(_e){return E(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,_e)},C.prototype.redSub=function(_e){return E(this.red,"redSub works only with red numbers"),this.red.sub(this,_e)},C.prototype.redISub=function(_e){return E(this.red,"redISub works only with red numbers"),this.red.isub(this,_e)},C.prototype.redShl=function(_e){return E(this.red,"redShl works only with red numbers"),this.red.shl(this,_e)},C.prototype.redMul=function(_e){return E(this.red,"redMul works only with red numbers"),this.red._verify2(this,_e),this.red.mul(this,_e)},C.prototype.redIMul=function(_e){return E(this.red,"redMul works only with red numbers"),this.red._verify2(this,_e),this.red.imul(this,_e)},C.prototype.redSqr=function(){return E(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},C.prototype.redISqr=function(){return E(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},C.prototype.redSqrt=function(){return E(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},C.prototype.redInvm=function(){return E(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},C.prototype.redNeg=function(){return E(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},C.prototype.redPow=function(_e){return E(this.red&&!_e.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,_e)};var Te={k256:null,p224:null,p192:null,p25519:null};function xe(Ce,_e){this.name=Ce,this.p=new C(_e,16),this.n=this.p.bitLength(),this.k=new C(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}xe.prototype._tmp=function(){var _e=new C(null);return _e.words=new Array(Math.ceil(this.n/13)),_e},xe.prototype.ireduce=function(_e){var Ie=_e,He;do this.split(Ie,this.tmp),Ie=this.imulK(Ie),Ie=Ie.iadd(this.tmp),He=Ie.bitLength();while(He>this.n);var Be=He<this.n?-1:Ie.ucmp(this.p);return Be===0?(Ie.words[0]=0,Ie.length=1):Be>0?Ie.isub(this.p):Ie.strip!==void 0?Ie.strip():Ie._strip(),Ie},xe.prototype.split=function(_e,Ie){_e.iushrn(this.n,0,Ie)},xe.prototype.imulK=function(_e){return _e.imul(this.k)};function Re(){xe.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}S(Re,xe),Re.prototype.split=function(_e,Ie){for(var He=4194303,Be=Math.min(_e.length,9),Ge=0;Ge<Be;Ge++)Ie.words[Ge]=_e.words[Ge];if(Ie.length=Be,_e.length<=9){_e.words[0]=0,_e.length=1;return}var je=_e.words[9];for(Ie.words[Ie.length++]=je&He,Ge=10;Ge<_e.length;Ge++){var Ve=_e.words[Ge]|0;_e.words[Ge-10]=(Ve&He)<<4|je>>>22,je=Ve}je>>>=22,_e.words[Ge-10]=je,je===0&&_e.length>10?_e.length-=10:_e.length-=9},Re.prototype.imulK=function(_e){_e.words[_e.length]=0,_e.words[_e.length+1]=0,_e.length+=2;for(var Ie=0,He=0;He<_e.length;He++){var Be=_e.words[He]|0;Ie+=Be*977,_e.words[He]=Ie&67108863,Ie=Be*64+(Ie/67108864|0)}return _e.words[_e.length-1]===0&&(_e.length--,_e.words[_e.length-1]===0&&_e.length--),_e};function Ne(){xe.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}S(Ne,xe);function Fe(){xe.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}S(Fe,xe);function ht(){xe.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}S(ht,xe),ht.prototype.imulK=function(_e){for(var Ie=0,He=0;He<_e.length;He++){var Be=(_e.words[He]|0)*19+Ie,Ge=Be&67108863;Be>>>=26,_e.words[He]=Ge,Ie=Be}return Ie!==0&&(_e.words[_e.length++]=Ie),_e},C._prime=function(_e){if(Te[_e])return Te[_e];var Ie;if(_e==="k256")Ie=new Re;else if(_e==="p224")Ie=new Ne;else if(_e==="p192")Ie=new Fe;else if(_e==="p25519")Ie=new ht;else throw new Error("Unknown prime "+_e);return Te[_e]=Ie,Ie};function nt(Ce){if(typeof Ce=="string"){var _e=C._prime(Ce);this.m=_e.p,this.prime=_e}else E(Ce.gtn(1),"modulus must be greater than 1"),this.m=Ce,this.prime=null}nt.prototype._verify1=function(_e){E(_e.negative===0,"red works only with positives"),E(_e.red,"red works only with red numbers")},nt.prototype._verify2=function(_e,Ie){E((_e.negative|Ie.negative)===0,"red works only with positives"),E(_e.red&&_e.red===Ie.red,"red works only with red numbers")},nt.prototype.imod=function(_e){return this.prime?this.prime.ireduce(_e)._forceRed(this):(N(_e,_e.umod(this.m)._forceRed(this)),_e)},nt.prototype.neg=function(_e){return _e.isZero()?_e.clone():this.m.sub(_e)._forceRed(this)},nt.prototype.add=function(_e,Ie){this._verify2(_e,Ie);var He=_e.add(Ie);return He.cmp(this.m)>=0&&He.isub(this.m),He._forceRed(this)},nt.prototype.iadd=function(_e,Ie){this._verify2(_e,Ie);var He=_e.iadd(Ie);return He.cmp(this.m)>=0&&He.isub(this.m),He},nt.prototype.sub=function(_e,Ie){this._verify2(_e,Ie);var He=_e.sub(Ie);return He.cmpn(0)<0&&He.iadd(this.m),He._forceRed(this)},nt.prototype.isub=function(_e,Ie){this._verify2(_e,Ie);var He=_e.isub(Ie);return He.cmpn(0)<0&&He.iadd(this.m),He},nt.prototype.shl=function(_e,Ie){return this._verify1(_e),this.imod(_e.ushln(Ie))},nt.prototype.imul=function(_e,Ie){return this._verify2(_e,Ie),this.imod(_e.imul(Ie))},nt.prototype.mul=function(_e,Ie){return this._verify2(_e,Ie),this.imod(_e.mul(Ie))},nt.prototype.isqr=function(_e){return this.imul(_e,_e.clone())},nt.prototype.sqr=function(_e){return this.mul(_e,_e)},nt.prototype.sqrt=function(_e){if(_e.isZero())return _e.clone();var Ie=this.m.andln(3);if(E(Ie%2===1),Ie===3){var He=this.m.add(new C(1)).iushrn(2);return this.pow(_e,He)}for(var Be=this.m.subn(1),Ge=0;!Be.isZero()&&Be.andln(1)===0;)Ge++,Be.iushrn(1);E(!Be.isZero());var je=new C(1).toRed(this),Ve=je.redNeg(),Pe=this.m.subn(1).iushrn(1),Me=this.m.bitLength();for(Me=new C(2*Me*Me).toRed(this);this.pow(Me,Pe).cmp(Ve)!==0;)Me.redIAdd(Ve);for(var tt=this.pow(Me,Be),Ke=this.pow(_e,Be.addn(1).iushrn(1)),mt=this.pow(_e,Be),ct=Ge;mt.cmp(je)!==0;){for(var Qe=mt,dt=0;Qe.cmp(je)!==0;dt++)Qe=Qe.redSqr();E(dt<ct);var vt=this.pow(tt,new C(1).iushln(ct-dt-1));Ke=Ke.redMul(vt),tt=vt.redSqr(),mt=mt.redMul(tt),ct=dt}return Ke},nt.prototype.invm=function(_e){var Ie=_e._invmp(this.m);return Ie.negative!==0?(Ie.negative=0,this.imod(Ie).redNeg()):this.imod(Ie)},nt.prototype.pow=function(_e,Ie){if(Ie.isZero())return new C(1).toRed(this);if(Ie.cmpn(1)===0)return _e.clone();var He=4,Be=new Array(1<<He);Be[0]=new C(1).toRed(this),Be[1]=_e;for(var Ge=2;Ge<Be.length;Ge++)Be[Ge]=this.mul(Be[Ge-1],_e);var je=Be[0],Ve=0,Pe=0,Me=Ie.bitLength()%26;for(Me===0&&(Me=26),Ge=Ie.length-1;Ge>=0;Ge--){for(var tt=Ie.words[Ge],Ke=Me-1;Ke>=0;Ke--){var mt=tt>>Ke&1;if(je!==Be[0]&&(je=this.sqr(je)),mt===0&&Ve===0){Pe=0;continue}Ve<<=1,Ve|=mt,Pe++,!(Pe!==He&&(Ge!==0||Ke!==0))&&(je=this.mul(je,Be[Ve]),Pe=0,Ve=0)}Me=26}return je},nt.prototype.convertTo=function(_e){var Ie=_e.umod(this.m);return Ie===_e?Ie.clone():Ie},nt.prototype.convertFrom=function(_e){var Ie=_e.clone();return Ie.red=null,Ie},C.mont=function(_e){return new Ee(_e)};function Ee(Ce){nt.call(this,Ce),this.shift=this.m.bitLength(),this.shift%26!==0&&(this.shift+=26-this.shift%26),this.r=new C(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}S(Ee,nt),Ee.prototype.convertTo=function(_e){return this.imod(_e.ushln(this.shift))},Ee.prototype.convertFrom=function(_e){var Ie=this.imod(_e.mul(this.rinv));return Ie.red=null,Ie},Ee.prototype.imul=function(_e,Ie){if(_e.isZero()||Ie.isZero())return _e.words[0]=0,_e.length=1,_e;var He=_e.imul(Ie),Be=He.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),Ge=He.isub(Be).iushrn(this.shift),je=Ge;return Ge.cmp(this.m)>=0?je=Ge.isub(this.m):Ge.cmpn(0)<0&&(je=Ge.iadd(this.m)),je._forceRed(this)},Ee.prototype.mul=function(_e,Ie){if(_e.isZero()||Ie.isZero())return new C(0)._forceRed(this);var He=_e.mul(Ie),Be=He.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),Ge=He.isub(Be).iushrn(this.shift),je=Ge;return Ge.cmp(this.m)>=0?je=Ge.isub(this.m):Ge.cmpn(0)<0&&(je=Ge.iadd(this.m)),je._forceRed(this)},Ee.prototype.invm=function(_e){var Ie=this.imod(_e._invmp(this.m).mul(this.r2));return Ie._forceRed(this)}})(n,commonjsGlobal)}(bn)),bn.exports}var browserifyRsa,hasRequiredBrowserifyRsa;function requireBrowserifyRsa(){if(hasRequiredBrowserifyRsa)return browserifyRsa;hasRequiredBrowserifyRsa=1;var n=requireBn(),r=requireBrowser$b();function _(C){var A=E(C),I=A.toRed(n.mont(C.modulus)).redPow(new n(C.publicExponent)).fromRed();return{blinder:I,unblinder:A.invm(C.modulus)}}function E(C){var A=C.modulus.byteLength(),I;do I=new n(r(A));while(I.cmp(C.modulus)>=0||!I.umod(C.prime1)||!I.umod(C.prime2));return I}function S(C,A){var I=_(A),B=A.modulus.byteLength(),O=new n(C).mul(I.blinder).umod(A.modulus),N=O.toRed(n.mont(A.prime1)),U=O.toRed(n.mont(A.prime2)),j=A.coefficient,z=A.prime1,Z=A.prime2,X=N.redPow(A.exponent1).fromRed(),Q=U.redPow(A.exponent2).fromRed(),se=X.isub(Q).imul(j).umod(z).imul(Z);return Q.iadd(se).imul(I.unblinder).umod(A.modulus).toArrayLike(Buffer$4,"be",B)}return S.getr=E,browserifyRsa=S,browserifyRsa}var elliptic={};const name$4="elliptic",version$2="6.5.5",description$1="EC cryptography",main="lib/elliptic.js",files=["lib"],scripts={lint:"eslint lib test","lint:fix":"npm run lint -- --fix",unit:"istanbul test _mocha --reporter=spec test/index.js",test:"npm run lint && npm run unit",version:"grunt dist && git add dist/"},repository={type:"git",url:"git@github.com:indutny/elliptic"},keywords=["EC","Elliptic","curve","Cryptography"],author="Fedor Indutny <fedor@indutny.com>",license="MIT",bugs={url:"https://github.com/indutny/elliptic/issues"},homepage="https://github.com/indutny/elliptic",devDependencies={brfs:"^2.0.2",coveralls:"^3.1.0",eslint:"^7.6.0",grunt:"^1.2.1","grunt-browserify":"^5.3.0","grunt-cli":"^1.3.2","grunt-contrib-connect":"^3.0.0","grunt-contrib-copy":"^1.0.0","grunt-contrib-uglify":"^5.0.0","grunt-mocha-istanbul":"^5.0.2","grunt-saucelabs":"^9.0.1",istanbul:"^0.4.5",mocha:"^8.0.1"},dependencies$1={"bn.js":"^4.11.9",brorand:"^1.1.0","hash.js":"^1.0.0","hmac-drbg":"^1.0.1",inherits:"^2.0.4","minimalistic-assert":"^1.0.1","minimalistic-crypto-utils":"^1.0.1"},require$$0={name:name$4,version:version$2,description:description$1,main,files,scripts,repository,keywords,author,license,bugs,homepage,devDependencies,dependencies:dependencies$1};var utils$3={},utils$2={},hasRequiredUtils$2;function requireUtils$2(){return hasRequiredUtils$2||(hasRequiredUtils$2=1,function(n){var r=n;function _(C,A){if(Array.isArray(C))return C.slice();if(!C)return[];var I=[];if(typeof C!="string"){for(var B=0;B<C.length;B++)I[B]=C[B]|0;return I}if(A==="hex"){C=C.replace(/[^a-z0-9]+/ig,""),C.length%2!==0&&(C="0"+C);for(var B=0;B<C.length;B+=2)I.push(parseInt(C[B]+C[B+1],16))}else for(var B=0;B<C.length;B++){var O=C.charCodeAt(B),N=O>>8,U=O&255;N?I.push(N,U):I.push(U)}return I}r.toArray=_;function E(C){return C.length===1?"0"+C:C}r.zero2=E;function S(C){for(var A="",I=0;I<C.length;I++)A+=E(C[I].toString(16));return A}r.toHex=S,r.encode=function(A,I){return I==="hex"?S(A):A}}(utils$2)),utils$2}var hasRequiredUtils$1;function requireUtils$1(){return hasRequiredUtils$1||(hasRequiredUtils$1=1,function(n){var r=n,_=requireBn$1(),E=requireMinimalisticAssert(),S=requireUtils$2();r.assert=E,r.toArray=S.toArray,r.zero2=S.zero2,r.toHex=S.toHex,r.encode=S.encode;function C(N,U,j){var z=new Array(Math.max(N.bitLength(),j)+1),Z;for(Z=0;Z<z.length;Z+=1)z[Z]=0;var X=1<<U+1,Q=N.clone();for(Z=0;Z<z.length;Z++){var se,oe=Q.andln(X-1);Q.isOdd()?(oe>(X>>1)-1?se=(X>>1)-oe:se=oe,Q.isubn(se)):se=0,z[Z]=se,Q.iushrn(1)}return z}r.getNAF=C;function A(N,U){var j=[[],[]];N=N.clone(),U=U.clone();for(var z=0,Z=0,X;N.cmpn(-z)>0||U.cmpn(-Z)>0;){var Q=N.andln(3)+z&3,se=U.andln(3)+Z&3;Q===3&&(Q=-1),se===3&&(se=-1);var oe;Q&1?(X=N.andln(7)+z&7,(X===3||X===5)&&se===2?oe=-Q:oe=Q):oe=0,j[0].push(oe);var ue;se&1?(X=U.andln(7)+Z&7,(X===3||X===5)&&Q===2?ue=-se:ue=se):ue=0,j[1].push(ue),2*z===oe+1&&(z=1-z),2*Z===ue+1&&(Z=1-Z),N.iushrn(1),U.iushrn(1)}return j}r.getJSF=A;function I(N,U,j){var z="_"+U;N.prototype[U]=function(){return this[z]!==void 0?this[z]:this[z]=j.call(this)}}r.cachedProperty=I;function B(N){return typeof N=="string"?r.toArray(N,"hex"):N}r.parseBytes=B;function O(N){return new _(N,"hex","le")}r.intFromLE=O}(utils$3)),utils$3}var curve={},base$4,hasRequiredBase$1;function requireBase$1(){if(hasRequiredBase$1)return base$4;hasRequiredBase$1=1;var n=requireBn$1(),r=requireUtils$1(),_=r.getNAF,E=r.getJSF,S=r.assert;function C(I,B){this.type=I,this.p=new n(B.p,16),this.red=B.prime?n.red(B.prime):n.mont(this.p),this.zero=new n(0).toRed(this.red),this.one=new n(1).toRed(this.red),this.two=new n(2).toRed(this.red),this.n=B.n&&new n(B.n,16),this.g=B.g&&this.pointFromJSON(B.g,B.gRed),this._wnafT1=new Array(4),this._wnafT2=new Array(4),this._wnafT3=new Array(4),this._wnafT4=new Array(4),this._bitLength=this.n?this.n.bitLength():0;var O=this.n&&this.p.div(this.n);!O||O.cmpn(100)>0?this.redN=null:(this._maxwellTrick=!0,this.redN=this.n.toRed(this.red))}base$4=C,C.prototype.point=function(){throw new Error("Not implemented")},C.prototype.validate=function(){throw new Error("Not implemented")},C.prototype._fixedNafMul=function(B,O){S(B.precomputed);var N=B._getDoubles(),U=_(O,1,this._bitLength),j=(1<<N.step+1)-(N.step%2===0?2:1);j/=3;var z=[],Z,X;for(Z=0;Z<U.length;Z+=N.step){X=0;for(var Q=Z+N.step-1;Q>=Z;Q--)X=(X<<1)+U[Q];z.push(X)}for(var se=this.jpoint(null,null,null),oe=this.jpoint(null,null,null),ue=j;ue>0;ue--){for(Z=0;Z<z.length;Z++)X=z[Z],X===ue?oe=oe.mixedAdd(N.points[Z]):X===-ue&&(oe=oe.mixedAdd(N.points[Z].neg()));se=se.add(oe)}return se.toP()},C.prototype._wnafMul=function(B,O){var N=4,U=B._getNAFPoints(N);N=U.wnd;for(var j=U.points,z=_(O,N,this._bitLength),Z=this.jpoint(null,null,null),X=z.length-1;X>=0;X--){for(var Q=0;X>=0&&z[X]===0;X--)Q++;if(X>=0&&Q++,Z=Z.dblp(Q),X<0)break;var se=z[X];S(se!==0),B.type==="affine"?se>0?Z=Z.mixedAdd(j[se-1>>1]):Z=Z.mixedAdd(j[-se-1>>1].neg()):se>0?Z=Z.add(j[se-1>>1]):Z=Z.add(j[-se-1>>1].neg())}return B.type==="affine"?Z.toP():Z},C.prototype._wnafMulAdd=function(B,O,N,U,j){var z=this._wnafT1,Z=this._wnafT2,X=this._wnafT3,Q=0,se,oe,ue;for(se=0;se<U;se++){ue=O[se];var we=ue._getNAFPoints(B);z[se]=we.wnd,Z[se]=we.points}for(se=U-1;se>=1;se-=2){var Te=se-1,xe=se;if(z[Te]!==1||z[xe]!==1){X[Te]=_(N[Te],z[Te],this._bitLength),X[xe]=_(N[xe],z[xe],this._bitLength),Q=Math.max(X[Te].length,Q),Q=Math.max(X[xe].length,Q);continue}var Re=[O[Te],null,null,O[xe]];O[Te].y.cmp(O[xe].y)===0?(Re[1]=O[Te].add(O[xe]),Re[2]=O[Te].toJ().mixedAdd(O[xe].neg())):O[Te].y.cmp(O[xe].y.redNeg())===0?(Re[1]=O[Te].toJ().mixedAdd(O[xe]),Re[2]=O[Te].add(O[xe].neg())):(Re[1]=O[Te].toJ().mixedAdd(O[xe]),Re[2]=O[Te].toJ().mixedAdd(O[xe].neg()));var Ne=[-3,-1,-5,-7,0,7,5,1,3],Fe=E(N[Te],N[xe]);for(Q=Math.max(Fe[0].length,Q),X[Te]=new Array(Q),X[xe]=new Array(Q),oe=0;oe<Q;oe++){var ht=Fe[0][oe]|0,nt=Fe[1][oe]|0;X[Te][oe]=Ne[(ht+1)*3+(nt+1)],X[xe][oe]=0,Z[Te]=Re}}var Ee=this.jpoint(null,null,null),Ce=this._wnafT4;for(se=Q;se>=0;se--){for(var _e=0;se>=0;){var Ie=!0;for(oe=0;oe<U;oe++)Ce[oe]=X[oe][se]|0,Ce[oe]!==0&&(Ie=!1);if(!Ie)break;_e++,se--}if(se>=0&&_e++,Ee=Ee.dblp(_e),se<0)break;for(oe=0;oe<U;oe++){var He=Ce[oe];He!==0&&(He>0?ue=Z[oe][He-1>>1]:He<0&&(ue=Z[oe][-He-1>>1].neg()),ue.type==="affine"?Ee=Ee.mixedAdd(ue):Ee=Ee.add(ue))}}for(se=0;se<U;se++)Z[se]=null;return j?Ee:Ee.toP()};function A(I,B){this.curve=I,this.type=B,this.precomputed=null}return C.BasePoint=A,A.prototype.eq=function(){throw new Error("Not implemented")},A.prototype.validate=function(){return this.curve.validate(this)},C.prototype.decodePoint=function(B,O){B=r.toArray(B,O);var N=this.p.byteLength();if((B[0]===4||B[0]===6||B[0]===7)&&B.length-1===2*N){B[0]===6?S(B[B.length-1]%2===0):B[0]===7&&S(B[B.length-1]%2===1);var U=this.point(B.slice(1,1+N),B.slice(1+N,1+2*N));return U}else if((B[0]===2||B[0]===3)&&B.length-1===N)return this.pointFromX(B.slice(1,1+N),B[0]===3);throw new Error("Unknown point format")},A.prototype.encodeCompressed=function(B){return this.encode(B,!0)},A.prototype._encode=function(B){var O=this.curve.p.byteLength(),N=this.getX().toArray("be",O);return B?[this.getY().isEven()?2:3].concat(N):[4].concat(N,this.getY().toArray("be",O))},A.prototype.encode=function(B,O){return r.encode(this._encode(O),B)},A.prototype.precompute=function(B){if(this.precomputed)return this;var O={doubles:null,naf:null,beta:null};return O.naf=this._getNAFPoints(8),O.doubles=this._getDoubles(4,B),O.beta=this._getBeta(),this.precomputed=O,this},A.prototype._hasDoubles=function(B){if(!this.precomputed)return!1;var O=this.precomputed.doubles;return O?O.points.length>=Math.ceil((B.bitLength()+1)/O.step):!1},A.prototype._getDoubles=function(B,O){if(this.precomputed&&this.precomputed.doubles)return this.precomputed.doubles;for(var N=[this],U=this,j=0;j<O;j+=B){for(var z=0;z<B;z++)U=U.dbl();N.push(U)}return{step:B,points:N}},A.prototype._getNAFPoints=function(B){if(this.precomputed&&this.precomputed.naf)return this.precomputed.naf;for(var O=[this],N=(1<<B)-1,U=N===1?null:this.dbl(),j=1;j<N;j++)O[j]=O[j-1].add(U);return{wnd:B,points:O}},A.prototype._getBeta=function(){return null},A.prototype.dblp=function(B){for(var O=this,N=0;N<B;N++)O=O.dbl();return O},base$4}var short,hasRequiredShort;function requireShort(){if(hasRequiredShort)return short;hasRequiredShort=1;var n=requireUtils$1(),r=requireBn$1(),_=inherits_browserExports,E=requireBase$1(),S=n.assert;function C(B){E.call(this,"short",B),this.a=new r(B.a,16).toRed(this.red),this.b=new r(B.b,16).toRed(this.red),this.tinv=this.two.redInvm(),this.zeroA=this.a.fromRed().cmpn(0)===0,this.threeA=this.a.fromRed().sub(this.p).cmpn(-3)===0,this.endo=this._getEndomorphism(B),this._endoWnafT1=new Array(4),this._endoWnafT2=new Array(4)}_(C,E),short=C,C.prototype._getEndomorphism=function(O){if(!(!this.zeroA||!this.g||!this.n||this.p.modn(3)!==1)){var N,U;if(O.beta)N=new r(O.beta,16).toRed(this.red);else{var j=this._getEndoRoots(this.p);N=j[0].cmp(j[1])<0?j[0]:j[1],N=N.toRed(this.red)}if(O.lambda)U=new r(O.lambda,16);else{var z=this._getEndoRoots(this.n);this.g.mul(z[0]).x.cmp(this.g.x.redMul(N))===0?U=z[0]:(U=z[1],S(this.g.mul(U).x.cmp(this.g.x.redMul(N))===0))}var Z;return O.basis?Z=O.basis.map(function(X){return{a:new r(X.a,16),b:new r(X.b,16)}}):Z=this._getEndoBasis(U),{beta:N,lambda:U,basis:Z}}},C.prototype._getEndoRoots=function(O){var N=O===this.p?this.red:r.mont(O),U=new r(2).toRed(N).redInvm(),j=U.redNeg(),z=new r(3).toRed(N).redNeg().redSqrt().redMul(U),Z=j.redAdd(z).fromRed(),X=j.redSub(z).fromRed();return[Z,X]},C.prototype._getEndoBasis=function(O){for(var N=this.n.ushrn(Math.floor(this.n.bitLength()/2)),U=O,j=this.n.clone(),z=new r(1),Z=new r(0),X=new r(0),Q=new r(1),se,oe,ue,we,Te,xe,Re,Ne=0,Fe,ht;U.cmpn(0)!==0;){var nt=j.div(U);Fe=j.sub(nt.mul(U)),ht=X.sub(nt.mul(z));var Ee=Q.sub(nt.mul(Z));if(!ue&&Fe.cmp(N)<0)se=Re.neg(),oe=z,ue=Fe.neg(),we=ht;else if(ue&&++Ne===2)break;Re=Fe,j=U,U=Fe,X=z,z=ht,Q=Z,Z=Ee}Te=Fe.neg(),xe=ht;var Ce=ue.sqr().add(we.sqr()),_e=Te.sqr().add(xe.sqr());return _e.cmp(Ce)>=0&&(Te=se,xe=oe),ue.negative&&(ue=ue.neg(),we=we.neg()),Te.negative&&(Te=Te.neg(),xe=xe.neg()),[{a:ue,b:we},{a:Te,b:xe}]},C.prototype._endoSplit=function(O){var N=this.endo.basis,U=N[0],j=N[1],z=j.b.mul(O).divRound(this.n),Z=U.b.neg().mul(O).divRound(this.n),X=z.mul(U.a),Q=Z.mul(j.a),se=z.mul(U.b),oe=Z.mul(j.b),ue=O.sub(X).sub(Q),we=se.add(oe).neg();return{k1:ue,k2:we}},C.prototype.pointFromX=function(O,N){O=new r(O,16),O.red||(O=O.toRed(this.red));var U=O.redSqr().redMul(O).redIAdd(O.redMul(this.a)).redIAdd(this.b),j=U.redSqrt();if(j.redSqr().redSub(U).cmp(this.zero)!==0)throw new Error("invalid point");var z=j.fromRed().isOdd();return(N&&!z||!N&&z)&&(j=j.redNeg()),this.point(O,j)},C.prototype.validate=function(O){if(O.inf)return!0;var N=O.x,U=O.y,j=this.a.redMul(N),z=N.redSqr().redMul(N).redIAdd(j).redIAdd(this.b);return U.redSqr().redISub(z).cmpn(0)===0},C.prototype._endoWnafMulAdd=function(O,N,U){for(var j=this._endoWnafT1,z=this._endoWnafT2,Z=0;Z<O.length;Z++){var X=this._endoSplit(N[Z]),Q=O[Z],se=Q._getBeta();X.k1.negative&&(X.k1.ineg(),Q=Q.neg(!0)),X.k2.negative&&(X.k2.ineg(),se=se.neg(!0)),j[Z*2]=Q,j[Z*2+1]=se,z[Z*2]=X.k1,z[Z*2+1]=X.k2}for(var oe=this._wnafMulAdd(1,j,z,Z*2,U),ue=0;ue<Z*2;ue++)j[ue]=null,z[ue]=null;return oe};function A(B,O,N,U){E.BasePoint.call(this,B,"affine"),O===null&&N===null?(this.x=null,this.y=null,this.inf=!0):(this.x=new r(O,16),this.y=new r(N,16),U&&(this.x.forceRed(this.curve.red),this.y.forceRed(this.curve.red)),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.inf=!1)}_(A,E.BasePoint),C.prototype.point=function(O,N,U){return new A(this,O,N,U)},C.prototype.pointFromJSON=function(O,N){return A.fromJSON(this,O,N)},A.prototype._getBeta=function(){if(this.curve.endo){var O=this.precomputed;if(O&&O.beta)return O.beta;var N=this.curve.point(this.x.redMul(this.curve.endo.beta),this.y);if(O){var U=this.curve,j=function(z){return U.point(z.x.redMul(U.endo.beta),z.y)};O.beta=N,N.precomputed={beta:null,naf:O.naf&&{wnd:O.naf.wnd,points:O.naf.points.map(j)},doubles:O.doubles&&{step:O.doubles.step,points:O.doubles.points.map(j)}}}return N}},A.prototype.toJSON=function(){return this.precomputed?[this.x,this.y,this.precomputed&&{doubles:this.precomputed.doubles&&{step:this.precomputed.doubles.step,points:this.precomputed.doubles.points.slice(1)},naf:this.precomputed.naf&&{wnd:this.precomputed.naf.wnd,points:this.precomputed.naf.points.slice(1)}}]:[this.x,this.y]},A.fromJSON=function(O,N,U){typeof N=="string"&&(N=JSON.parse(N));var j=O.point(N[0],N[1],U);if(!N[2])return j;function z(X){return O.point(X[0],X[1],U)}var Z=N[2];return j.precomputed={beta:null,doubles:Z.doubles&&{step:Z.doubles.step,points:[j].concat(Z.doubles.points.map(z))},naf:Z.naf&&{wnd:Z.naf.wnd,points:[j].concat(Z.naf.points.map(z))}},j},A.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" y: "+this.y.fromRed().toString(16,2)+">"},A.prototype.isInfinity=function(){return this.inf},A.prototype.add=function(O){if(this.inf)return O;if(O.inf)return this;if(this.eq(O))return this.dbl();if(this.neg().eq(O))return this.curve.point(null,null);if(this.x.cmp(O.x)===0)return this.curve.point(null,null);var N=this.y.redSub(O.y);N.cmpn(0)!==0&&(N=N.redMul(this.x.redSub(O.x).redInvm()));var U=N.redSqr().redISub(this.x).redISub(O.x),j=N.redMul(this.x.redSub(U)).redISub(this.y);return this.curve.point(U,j)},A.prototype.dbl=function(){if(this.inf)return this;var O=this.y.redAdd(this.y);if(O.cmpn(0)===0)return this.curve.point(null,null);var N=this.curve.a,U=this.x.redSqr(),j=O.redInvm(),z=U.redAdd(U).redIAdd(U).redIAdd(N).redMul(j),Z=z.redSqr().redISub(this.x.redAdd(this.x)),X=z.redMul(this.x.redSub(Z)).redISub(this.y);return this.curve.point(Z,X)},A.prototype.getX=function(){return this.x.fromRed()},A.prototype.getY=function(){return this.y.fromRed()},A.prototype.mul=function(O){return O=new r(O,16),this.isInfinity()?this:this._hasDoubles(O)?this.curve._fixedNafMul(this,O):this.curve.endo?this.curve._endoWnafMulAdd([this],[O]):this.curve._wnafMul(this,O)},A.prototype.mulAdd=function(O,N,U){var j=[this,N],z=[O,U];return this.curve.endo?this.curve._endoWnafMulAdd(j,z):this.curve._wnafMulAdd(1,j,z,2)},A.prototype.jmulAdd=function(O,N,U){var j=[this,N],z=[O,U];return this.curve.endo?this.curve._endoWnafMulAdd(j,z,!0):this.curve._wnafMulAdd(1,j,z,2,!0)},A.prototype.eq=function(O){return this===O||this.inf===O.inf&&(this.inf||this.x.cmp(O.x)===0&&this.y.cmp(O.y)===0)},A.prototype.neg=function(O){if(this.inf)return this;var N=this.curve.point(this.x,this.y.redNeg());if(O&&this.precomputed){var U=this.precomputed,j=function(z){return z.neg()};N.precomputed={naf:U.naf&&{wnd:U.naf.wnd,points:U.naf.points.map(j)},doubles:U.doubles&&{step:U.doubles.step,points:U.doubles.points.map(j)}}}return N},A.prototype.toJ=function(){if(this.inf)return this.curve.jpoint(null,null,null);var O=this.curve.jpoint(this.x,this.y,this.curve.one);return O};function I(B,O,N,U){E.BasePoint.call(this,B,"jacobian"),O===null&&N===null&&U===null?(this.x=this.curve.one,this.y=this.curve.one,this.z=new r(0)):(this.x=new r(O,16),this.y=new r(N,16),this.z=new r(U,16)),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)),this.zOne=this.z===this.curve.one}return _(I,E.BasePoint),C.prototype.jpoint=function(O,N,U){return new I(this,O,N,U)},I.prototype.toP=function(){if(this.isInfinity())return this.curve.point(null,null);var O=this.z.redInvm(),N=O.redSqr(),U=this.x.redMul(N),j=this.y.redMul(N).redMul(O);return this.curve.point(U,j)},I.prototype.neg=function(){return this.curve.jpoint(this.x,this.y.redNeg(),this.z)},I.prototype.add=function(O){if(this.isInfinity())return O;if(O.isInfinity())return this;var N=O.z.redSqr(),U=this.z.redSqr(),j=this.x.redMul(N),z=O.x.redMul(U),Z=this.y.redMul(N.redMul(O.z)),X=O.y.redMul(U.redMul(this.z)),Q=j.redSub(z),se=Z.redSub(X);if(Q.cmpn(0)===0)return se.cmpn(0)!==0?this.curve.jpoint(null,null,null):this.dbl();var oe=Q.redSqr(),ue=oe.redMul(Q),we=j.redMul(oe),Te=se.redSqr().redIAdd(ue).redISub(we).redISub(we),xe=se.redMul(we.redISub(Te)).redISub(Z.redMul(ue)),Re=this.z.redMul(O.z).redMul(Q);return this.curve.jpoint(Te,xe,Re)},I.prototype.mixedAdd=function(O){if(this.isInfinity())return O.toJ();if(O.isInfinity())return this;var N=this.z.redSqr(),U=this.x,j=O.x.redMul(N),z=this.y,Z=O.y.redMul(N).redMul(this.z),X=U.redSub(j),Q=z.redSub(Z);if(X.cmpn(0)===0)return Q.cmpn(0)!==0?this.curve.jpoint(null,null,null):this.dbl();var se=X.redSqr(),oe=se.redMul(X),ue=U.redMul(se),we=Q.redSqr().redIAdd(oe).redISub(ue).redISub(ue),Te=Q.redMul(ue.redISub(we)).redISub(z.redMul(oe)),xe=this.z.redMul(X);return this.curve.jpoint(we,Te,xe)},I.prototype.dblp=function(O){if(O===0)return this;if(this.isInfinity())return this;if(!O)return this.dbl();var N;if(this.curve.zeroA||this.curve.threeA){var U=this;for(N=0;N<O;N++)U=U.dbl();return U}var j=this.curve.a,z=this.curve.tinv,Z=this.x,X=this.y,Q=this.z,se=Q.redSqr().redSqr(),oe=X.redAdd(X);for(N=0;N<O;N++){var ue=Z.redSqr(),we=oe.redSqr(),Te=we.redSqr(),xe=ue.redAdd(ue).redIAdd(ue).redIAdd(j.redMul(se)),Re=Z.redMul(we),Ne=xe.redSqr().redISub(Re.redAdd(Re)),Fe=Re.redISub(Ne),ht=xe.redMul(Fe);ht=ht.redIAdd(ht).redISub(Te);var nt=oe.redMul(Q);N+1<O&&(se=se.redMul(Te)),Z=Ne,Q=nt,oe=ht}return this.curve.jpoint(Z,oe.redMul(z),Q)},I.prototype.dbl=function(){return this.isInfinity()?this:this.curve.zeroA?this._zeroDbl():this.curve.threeA?this._threeDbl():this._dbl()},I.prototype._zeroDbl=function(){var O,N,U;if(this.zOne){var j=this.x.redSqr(),z=this.y.redSqr(),Z=z.redSqr(),X=this.x.redAdd(z).redSqr().redISub(j).redISub(Z);X=X.redIAdd(X);var Q=j.redAdd(j).redIAdd(j),se=Q.redSqr().redISub(X).redISub(X),oe=Z.redIAdd(Z);oe=oe.redIAdd(oe),oe=oe.redIAdd(oe),O=se,N=Q.redMul(X.redISub(se)).redISub(oe),U=this.y.redAdd(this.y)}else{var ue=this.x.redSqr(),we=this.y.redSqr(),Te=we.redSqr(),xe=this.x.redAdd(we).redSqr().redISub(ue).redISub(Te);xe=xe.redIAdd(xe);var Re=ue.redAdd(ue).redIAdd(ue),Ne=Re.redSqr(),Fe=Te.redIAdd(Te);Fe=Fe.redIAdd(Fe),Fe=Fe.redIAdd(Fe),O=Ne.redISub(xe).redISub(xe),N=Re.redMul(xe.redISub(O)).redISub(Fe),U=this.y.redMul(this.z),U=U.redIAdd(U)}return this.curve.jpoint(O,N,U)},I.prototype._threeDbl=function(){var O,N,U;if(this.zOne){var j=this.x.redSqr(),z=this.y.redSqr(),Z=z.redSqr(),X=this.x.redAdd(z).redSqr().redISub(j).redISub(Z);X=X.redIAdd(X);var Q=j.redAdd(j).redIAdd(j).redIAdd(this.curve.a),se=Q.redSqr().redISub(X).redISub(X);O=se;var oe=Z.redIAdd(Z);oe=oe.redIAdd(oe),oe=oe.redIAdd(oe),N=Q.redMul(X.redISub(se)).redISub(oe),U=this.y.redAdd(this.y)}else{var ue=this.z.redSqr(),we=this.y.redSqr(),Te=this.x.redMul(we),xe=this.x.redSub(ue).redMul(this.x.redAdd(ue));xe=xe.redAdd(xe).redIAdd(xe);var Re=Te.redIAdd(Te);Re=Re.redIAdd(Re);var Ne=Re.redAdd(Re);O=xe.redSqr().redISub(Ne),U=this.y.redAdd(this.z).redSqr().redISub(we).redISub(ue);var Fe=we.redSqr();Fe=Fe.redIAdd(Fe),Fe=Fe.redIAdd(Fe),Fe=Fe.redIAdd(Fe),N=xe.redMul(Re.redISub(O)).redISub(Fe)}return this.curve.jpoint(O,N,U)},I.prototype._dbl=function(){var O=this.curve.a,N=this.x,U=this.y,j=this.z,z=j.redSqr().redSqr(),Z=N.redSqr(),X=U.redSqr(),Q=Z.redAdd(Z).redIAdd(Z).redIAdd(O.redMul(z)),se=N.redAdd(N);se=se.redIAdd(se);var oe=se.redMul(X),ue=Q.redSqr().redISub(oe.redAdd(oe)),we=oe.redISub(ue),Te=X.redSqr();Te=Te.redIAdd(Te),Te=Te.redIAdd(Te),Te=Te.redIAdd(Te);var xe=Q.redMul(we).redISub(Te),Re=U.redAdd(U).redMul(j);return this.curve.jpoint(ue,xe,Re)},I.prototype.trpl=function(){if(!this.curve.zeroA)return this.dbl().add(this);var O=this.x.redSqr(),N=this.y.redSqr(),U=this.z.redSqr(),j=N.redSqr(),z=O.redAdd(O).redIAdd(O),Z=z.redSqr(),X=this.x.redAdd(N).redSqr().redISub(O).redISub(j);X=X.redIAdd(X),X=X.redAdd(X).redIAdd(X),X=X.redISub(Z);var Q=X.redSqr(),se=j.redIAdd(j);se=se.redIAdd(se),se=se.redIAdd(se),se=se.redIAdd(se);var oe=z.redIAdd(X).redSqr().redISub(Z).redISub(Q).redISub(se),ue=N.redMul(oe);ue=ue.redIAdd(ue),ue=ue.redIAdd(ue);var we=this.x.redMul(Q).redISub(ue);we=we.redIAdd(we),we=we.redIAdd(we);var Te=this.y.redMul(oe.redMul(se.redISub(oe)).redISub(X.redMul(Q)));Te=Te.redIAdd(Te),Te=Te.redIAdd(Te),Te=Te.redIAdd(Te);var xe=this.z.redAdd(X).redSqr().redISub(U).redISub(Q);return this.curve.jpoint(we,Te,xe)},I.prototype.mul=function(O,N){return O=new r(O,N),this.curve._wnafMul(this,O)},I.prototype.eq=function(O){if(O.type==="affine")return this.eq(O.toJ());if(this===O)return!0;var N=this.z.redSqr(),U=O.z.redSqr();if(this.x.redMul(U).redISub(O.x.redMul(N)).cmpn(0)!==0)return!1;var j=N.redMul(this.z),z=U.redMul(O.z);return this.y.redMul(z).redISub(O.y.redMul(j)).cmpn(0)===0},I.prototype.eqXToP=function(O){var N=this.z.redSqr(),U=O.toRed(this.curve.red).redMul(N);if(this.x.cmp(U)===0)return!0;for(var j=O.clone(),z=this.curve.redN.redMul(N);;){if(j.iadd(this.curve.n),j.cmp(this.curve.p)>=0)return!1;if(U.redIAdd(z),this.x.cmp(U)===0)return!0}},I.prototype.inspect=function(){return this.isInfinity()?"<EC JPoint Infinity>":"<EC JPoint x: "+this.x.toString(16,2)+" y: "+this.y.toString(16,2)+" z: "+this.z.toString(16,2)+">"},I.prototype.isInfinity=function(){return this.z.cmpn(0)===0},short}var mont,hasRequiredMont;function requireMont(){if(hasRequiredMont)return mont;hasRequiredMont=1;var n=requireBn$1(),r=inherits_browserExports,_=requireBase$1(),E=requireUtils$1();function S(A){_.call(this,"mont",A),this.a=new n(A.a,16).toRed(this.red),this.b=new n(A.b,16).toRed(this.red),this.i4=new n(4).toRed(this.red).redInvm(),this.two=new n(2).toRed(this.red),this.a24=this.i4.redMul(this.a.redAdd(this.two))}r(S,_),mont=S,S.prototype.validate=function(I){var B=I.normalize().x,O=B.redSqr(),N=O.redMul(B).redAdd(O.redMul(this.a)).redAdd(B),U=N.redSqrt();return U.redSqr().cmp(N)===0};function C(A,I,B){_.BasePoint.call(this,A,"projective"),I===null&&B===null?(this.x=this.curve.one,this.z=this.curve.zero):(this.x=new n(I,16),this.z=new n(B,16),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)))}return r(C,_.BasePoint),S.prototype.decodePoint=function(I,B){return this.point(E.toArray(I,B),1)},S.prototype.point=function(I,B){return new C(this,I,B)},S.prototype.pointFromJSON=function(I){return C.fromJSON(this,I)},C.prototype.precompute=function(){},C.prototype._encode=function(){return this.getX().toArray("be",this.curve.p.byteLength())},C.fromJSON=function(I,B){return new C(I,B[0],B[1]||I.one)},C.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" z: "+this.z.fromRed().toString(16,2)+">"},C.prototype.isInfinity=function(){return this.z.cmpn(0)===0},C.prototype.dbl=function(){var I=this.x.redAdd(this.z),B=I.redSqr(),O=this.x.redSub(this.z),N=O.redSqr(),U=B.redSub(N),j=B.redMul(N),z=U.redMul(N.redAdd(this.curve.a24.redMul(U)));return this.curve.point(j,z)},C.prototype.add=function(){throw new Error("Not supported on Montgomery curve")},C.prototype.diffAdd=function(I,B){var O=this.x.redAdd(this.z),N=this.x.redSub(this.z),U=I.x.redAdd(I.z),j=I.x.redSub(I.z),z=j.redMul(O),Z=U.redMul(N),X=B.z.redMul(z.redAdd(Z).redSqr()),Q=B.x.redMul(z.redISub(Z).redSqr());return this.curve.point(X,Q)},C.prototype.mul=function(I){for(var B=I.clone(),O=this,N=this.curve.point(null,null),U=this,j=[];B.cmpn(0)!==0;B.iushrn(1))j.push(B.andln(1));for(var z=j.length-1;z>=0;z--)j[z]===0?(O=O.diffAdd(N,U),N=N.dbl()):(N=O.diffAdd(N,U),O=O.dbl());return N},C.prototype.mulAdd=function(){throw new Error("Not supported on Montgomery curve")},C.prototype.jumlAdd=function(){throw new Error("Not supported on Montgomery curve")},C.prototype.eq=function(I){return this.getX().cmp(I.getX())===0},C.prototype.normalize=function(){return this.x=this.x.redMul(this.z.redInvm()),this.z=this.curve.one,this},C.prototype.getX=function(){return this.normalize(),this.x.fromRed()},mont}var edwards,hasRequiredEdwards;function requireEdwards(){if(hasRequiredEdwards)return edwards;hasRequiredEdwards=1;var n=requireUtils$1(),r=requireBn$1(),_=inherits_browserExports,E=requireBase$1(),S=n.assert;function C(I){this.twisted=(I.a|0)!==1,this.mOneA=this.twisted&&(I.a|0)===-1,this.extended=this.mOneA,E.call(this,"edwards",I),this.a=new r(I.a,16).umod(this.red.m),this.a=this.a.toRed(this.red),this.c=new r(I.c,16).toRed(this.red),this.c2=this.c.redSqr(),this.d=new r(I.d,16).toRed(this.red),this.dd=this.d.redAdd(this.d),S(!this.twisted||this.c.fromRed().cmpn(1)===0),this.oneC=(I.c|0)===1}_(C,E),edwards=C,C.prototype._mulA=function(B){return this.mOneA?B.redNeg():this.a.redMul(B)},C.prototype._mulC=function(B){return this.oneC?B:this.c.redMul(B)},C.prototype.jpoint=function(B,O,N,U){return this.point(B,O,N,U)},C.prototype.pointFromX=function(B,O){B=new r(B,16),B.red||(B=B.toRed(this.red));var N=B.redSqr(),U=this.c2.redSub(this.a.redMul(N)),j=this.one.redSub(this.c2.redMul(this.d).redMul(N)),z=U.redMul(j.redInvm()),Z=z.redSqrt();if(Z.redSqr().redSub(z).cmp(this.zero)!==0)throw new Error("invalid point");var X=Z.fromRed().isOdd();return(O&&!X||!O&&X)&&(Z=Z.redNeg()),this.point(B,Z)},C.prototype.pointFromY=function(B,O){B=new r(B,16),B.red||(B=B.toRed(this.red));var N=B.redSqr(),U=N.redSub(this.c2),j=N.redMul(this.d).redMul(this.c2).redSub(this.a),z=U.redMul(j.redInvm());if(z.cmp(this.zero)===0){if(O)throw new Error("invalid point");return this.point(this.zero,B)}var Z=z.redSqrt();if(Z.redSqr().redSub(z).cmp(this.zero)!==0)throw new Error("invalid point");return Z.fromRed().isOdd()!==O&&(Z=Z.redNeg()),this.point(Z,B)},C.prototype.validate=function(B){if(B.isInfinity())return!0;B.normalize();var O=B.x.redSqr(),N=B.y.redSqr(),U=O.redMul(this.a).redAdd(N),j=this.c2.redMul(this.one.redAdd(this.d.redMul(O).redMul(N)));return U.cmp(j)===0};function A(I,B,O,N,U){E.BasePoint.call(this,I,"projective"),B===null&&O===null&&N===null?(this.x=this.curve.zero,this.y=this.curve.one,this.z=this.curve.one,this.t=this.curve.zero,this.zOne=!0):(this.x=new r(B,16),this.y=new r(O,16),this.z=N?new r(N,16):this.curve.one,this.t=U&&new r(U,16),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)),this.t&&!this.t.red&&(this.t=this.t.toRed(this.curve.red)),this.zOne=this.z===this.curve.one,this.curve.extended&&!this.t&&(this.t=this.x.redMul(this.y),this.zOne||(this.t=this.t.redMul(this.z.redInvm()))))}return _(A,E.BasePoint),C.prototype.pointFromJSON=function(B){return A.fromJSON(this,B)},C.prototype.point=function(B,O,N,U){return new A(this,B,O,N,U)},A.fromJSON=function(B,O){return new A(B,O[0],O[1],O[2])},A.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" y: "+this.y.fromRed().toString(16,2)+" z: "+this.z.fromRed().toString(16,2)+">"},A.prototype.isInfinity=function(){return this.x.cmpn(0)===0&&(this.y.cmp(this.z)===0||this.zOne&&this.y.cmp(this.curve.c)===0)},A.prototype._extDbl=function(){var B=this.x.redSqr(),O=this.y.redSqr(),N=this.z.redSqr();N=N.redIAdd(N);var U=this.curve._mulA(B),j=this.x.redAdd(this.y).redSqr().redISub(B).redISub(O),z=U.redAdd(O),Z=z.redSub(N),X=U.redSub(O),Q=j.redMul(Z),se=z.redMul(X),oe=j.redMul(X),ue=Z.redMul(z);return this.curve.point(Q,se,ue,oe)},A.prototype._projDbl=function(){var B=this.x.redAdd(this.y).redSqr(),O=this.x.redSqr(),N=this.y.redSqr(),U,j,z,Z,X,Q;if(this.curve.twisted){Z=this.curve._mulA(O);var se=Z.redAdd(N);this.zOne?(U=B.redSub(O).redSub(N).redMul(se.redSub(this.curve.two)),j=se.redMul(Z.redSub(N)),z=se.redSqr().redSub(se).redSub(se)):(X=this.z.redSqr(),Q=se.redSub(X).redISub(X),U=B.redSub(O).redISub(N).redMul(Q),j=se.redMul(Z.redSub(N)),z=se.redMul(Q))}else Z=O.redAdd(N),X=this.curve._mulC(this.z).redSqr(),Q=Z.redSub(X).redSub(X),U=this.curve._mulC(B.redISub(Z)).redMul(Q),j=this.curve._mulC(Z).redMul(O.redISub(N)),z=Z.redMul(Q);return this.curve.point(U,j,z)},A.prototype.dbl=function(){return this.isInfinity()?this:this.curve.extended?this._extDbl():this._projDbl()},A.prototype._extAdd=function(B){var O=this.y.redSub(this.x).redMul(B.y.redSub(B.x)),N=this.y.redAdd(this.x).redMul(B.y.redAdd(B.x)),U=this.t.redMul(this.curve.dd).redMul(B.t),j=this.z.redMul(B.z.redAdd(B.z)),z=N.redSub(O),Z=j.redSub(U),X=j.redAdd(U),Q=N.redAdd(O),se=z.redMul(Z),oe=X.redMul(Q),ue=z.redMul(Q),we=Z.redMul(X);return this.curve.point(se,oe,we,ue)},A.prototype._projAdd=function(B){var O=this.z.redMul(B.z),N=O.redSqr(),U=this.x.redMul(B.x),j=this.y.redMul(B.y),z=this.curve.d.redMul(U).redMul(j),Z=N.redSub(z),X=N.redAdd(z),Q=this.x.redAdd(this.y).redMul(B.x.redAdd(B.y)).redISub(U).redISub(j),se=O.redMul(Z).redMul(Q),oe,ue;return this.curve.twisted?(oe=O.redMul(X).redMul(j.redSub(this.curve._mulA(U))),ue=Z.redMul(X)):(oe=O.redMul(X).redMul(j.redSub(U)),ue=this.curve._mulC(Z).redMul(X)),this.curve.point(se,oe,ue)},A.prototype.add=function(B){return this.isInfinity()?B:B.isInfinity()?this:this.curve.extended?this._extAdd(B):this._projAdd(B)},A.prototype.mul=function(B){return this._hasDoubles(B)?this.curve._fixedNafMul(this,B):this.curve._wnafMul(this,B)},A.prototype.mulAdd=function(B,O,N){return this.curve._wnafMulAdd(1,[this,O],[B,N],2,!1)},A.prototype.jmulAdd=function(B,O,N){return this.curve._wnafMulAdd(1,[this,O],[B,N],2,!0)},A.prototype.normalize=function(){if(this.zOne)return this;var B=this.z.redInvm();return this.x=this.x.redMul(B),this.y=this.y.redMul(B),this.t&&(this.t=this.t.redMul(B)),this.z=this.curve.one,this.zOne=!0,this},A.prototype.neg=function(){return this.curve.point(this.x.redNeg(),this.y,this.z,this.t&&this.t.redNeg())},A.prototype.getX=function(){return this.normalize(),this.x.fromRed()},A.prototype.getY=function(){return this.normalize(),this.y.fromRed()},A.prototype.eq=function(B){return this===B||this.getX().cmp(B.getX())===0&&this.getY().cmp(B.getY())===0},A.prototype.eqXToP=function(B){var O=B.toRed(this.curve.red).redMul(this.z);if(this.x.cmp(O)===0)return!0;for(var N=B.clone(),U=this.curve.redN.redMul(this.z);;){if(N.iadd(this.curve.n),N.cmp(this.curve.p)>=0)return!1;if(O.redIAdd(U),this.x.cmp(O)===0)return!0}},A.prototype.toP=A.prototype.normalize,A.prototype.mixedAdd=A.prototype.add,edwards}var hasRequiredCurve;function requireCurve(){return hasRequiredCurve||(hasRequiredCurve=1,function(n){var r=n;r.base=requireBase$1(),r.short=requireShort(),r.mont=requireMont(),r.edwards=requireEdwards()}(curve)),curve}var curves={},hash$2={},utils$1={},hasRequiredUtils;function requireUtils(){if(hasRequiredUtils)return utils$1;hasRequiredUtils=1;var n=requireMinimalisticAssert(),r=inherits_browserExports;utils$1.inherits=r;function _(Ee,Ce){return(Ee.charCodeAt(Ce)&64512)!==55296||Ce<0||Ce+1>=Ee.length?!1:(Ee.charCodeAt(Ce+1)&64512)===56320}function E(Ee,Ce){if(Array.isArray(Ee))return Ee.slice();if(!Ee)return[];var _e=[];if(typeof Ee=="string")if(Ce){if(Ce==="hex")for(Ee=Ee.replace(/[^a-z0-9]+/ig,""),Ee.length%2!==0&&(Ee="0"+Ee),He=0;He<Ee.length;He+=2)_e.push(parseInt(Ee[He]+Ee[He+1],16))}else for(var Ie=0,He=0;He<Ee.length;He++){var Be=Ee.charCodeAt(He);Be<128?_e[Ie++]=Be:Be<2048?(_e[Ie++]=Be>>6|192,_e[Ie++]=Be&63|128):_(Ee,He)?(Be=65536+((Be&1023)<<10)+(Ee.charCodeAt(++He)&1023),_e[Ie++]=Be>>18|240,_e[Ie++]=Be>>12&63|128,_e[Ie++]=Be>>6&63|128,_e[Ie++]=Be&63|128):(_e[Ie++]=Be>>12|224,_e[Ie++]=Be>>6&63|128,_e[Ie++]=Be&63|128)}else for(He=0;He<Ee.length;He++)_e[He]=Ee[He]|0;return _e}utils$1.toArray=E;function S(Ee){for(var Ce="",_e=0;_e<Ee.length;_e++)Ce+=I(Ee[_e].toString(16));return Ce}utils$1.toHex=S;function C(Ee){var Ce=Ee>>>24|Ee>>>8&65280|Ee<<8&16711680|(Ee&255)<<24;return Ce>>>0}utils$1.htonl=C;function A(Ee,Ce){for(var _e="",Ie=0;Ie<Ee.length;Ie++){var He=Ee[Ie];Ce==="little"&&(He=C(He)),_e+=B(He.toString(16))}return _e}utils$1.toHex32=A;function I(Ee){return Ee.length===1?"0"+Ee:Ee}utils$1.zero2=I;function B(Ee){return Ee.length===7?"0"+Ee:Ee.length===6?"00"+Ee:Ee.length===5?"000"+Ee:Ee.length===4?"0000"+Ee:Ee.length===3?"00000"+Ee:Ee.length===2?"000000"+Ee:Ee.length===1?"0000000"+Ee:Ee}utils$1.zero8=B;function O(Ee,Ce,_e,Ie){var He=_e-Ce;n(He%4===0);for(var Be=new Array(He/4),Ge=0,je=Ce;Ge<Be.length;Ge++,je+=4){var Ve;Ie==="big"?Ve=Ee[je]<<24|Ee[je+1]<<16|Ee[je+2]<<8|Ee[je+3]:Ve=Ee[je+3]<<24|Ee[je+2]<<16|Ee[je+1]<<8|Ee[je],Be[Ge]=Ve>>>0}return Be}utils$1.join32=O;function N(Ee,Ce){for(var _e=new Array(Ee.length*4),Ie=0,He=0;Ie<Ee.length;Ie++,He+=4){var Be=Ee[Ie];Ce==="big"?(_e[He]=Be>>>24,_e[He+1]=Be>>>16&255,_e[He+2]=Be>>>8&255,_e[He+3]=Be&255):(_e[He+3]=Be>>>24,_e[He+2]=Be>>>16&255,_e[He+1]=Be>>>8&255,_e[He]=Be&255)}return _e}utils$1.split32=N;function U(Ee,Ce){return Ee>>>Ce|Ee<<32-Ce}utils$1.rotr32=U;function j(Ee,Ce){return Ee<<Ce|Ee>>>32-Ce}utils$1.rotl32=j;function z(Ee,Ce){return Ee+Ce>>>0}utils$1.sum32=z;function Z(Ee,Ce,_e){return Ee+Ce+_e>>>0}utils$1.sum32_3=Z;function X(Ee,Ce,_e,Ie){return Ee+Ce+_e+Ie>>>0}utils$1.sum32_4=X;function Q(Ee,Ce,_e,Ie,He){return Ee+Ce+_e+Ie+He>>>0}utils$1.sum32_5=Q;function se(Ee,Ce,_e,Ie){var He=Ee[Ce],Be=Ee[Ce+1],Ge=Ie+Be>>>0,je=(Ge<Ie?1:0)+_e+He;Ee[Ce]=je>>>0,Ee[Ce+1]=Ge}utils$1.sum64=se;function oe(Ee,Ce,_e,Ie){var He=Ce+Ie>>>0,Be=(He<Ce?1:0)+Ee+_e;return Be>>>0}utils$1.sum64_hi=oe;function ue(Ee,Ce,_e,Ie){var He=Ce+Ie;return He>>>0}utils$1.sum64_lo=ue;function we(Ee,Ce,_e,Ie,He,Be,Ge,je){var Ve=0,Pe=Ce;Pe=Pe+Ie>>>0,Ve+=Pe<Ce?1:0,Pe=Pe+Be>>>0,Ve+=Pe<Be?1:0,Pe=Pe+je>>>0,Ve+=Pe<je?1:0;var Me=Ee+_e+He+Ge+Ve;return Me>>>0}utils$1.sum64_4_hi=we;function Te(Ee,Ce,_e,Ie,He,Be,Ge,je){var Ve=Ce+Ie+Be+je;return Ve>>>0}utils$1.sum64_4_lo=Te;function xe(Ee,Ce,_e,Ie,He,Be,Ge,je,Ve,Pe){var Me=0,tt=Ce;tt=tt+Ie>>>0,Me+=tt<Ce?1:0,tt=tt+Be>>>0,Me+=tt<Be?1:0,tt=tt+je>>>0,Me+=tt<je?1:0,tt=tt+Pe>>>0,Me+=tt<Pe?1:0;var Ke=Ee+_e+He+Ge+Ve+Me;return Ke>>>0}utils$1.sum64_5_hi=xe;function Re(Ee,Ce,_e,Ie,He,Be,Ge,je,Ve,Pe){var Me=Ce+Ie+Be+je+Pe;return Me>>>0}utils$1.sum64_5_lo=Re;function Ne(Ee,Ce,_e){var Ie=Ce<<32-_e|Ee>>>_e;return Ie>>>0}utils$1.rotr64_hi=Ne;function Fe(Ee,Ce,_e){var Ie=Ee<<32-_e|Ce>>>_e;return Ie>>>0}utils$1.rotr64_lo=Fe;function ht(Ee,Ce,_e){return Ee>>>_e}utils$1.shr64_hi=ht;function nt(Ee,Ce,_e){var Ie=Ee<<32-_e|Ce>>>_e;return Ie>>>0}return utils$1.shr64_lo=nt,utils$1}var common$2={},hasRequiredCommon$1;function requireCommon$1(){if(hasRequiredCommon$1)return common$2;hasRequiredCommon$1=1;var n=requireUtils(),r=requireMinimalisticAssert();function _(){this.pending=null,this.pendingTotal=0,this.blockSize=this.constructor.blockSize,this.outSize=this.constructor.outSize,this.hmacStrength=this.constructor.hmacStrength,this.padLength=this.constructor.padLength/8,this.endian="big",this._delta8=this.blockSize/8,this._delta32=this.blockSize/32}return common$2.BlockHash=_,_.prototype.update=function(S,C){if(S=n.toArray(S,C),this.pending?this.pending=this.pending.concat(S):this.pending=S,this.pendingTotal+=S.length,this.pending.length>=this._delta8){S=this.pending;var A=S.length%this._delta8;this.pending=S.slice(S.length-A,S.length),this.pending.length===0&&(this.pending=null),S=n.join32(S,0,S.length-A,this.endian);for(var I=0;I<S.length;I+=this._delta32)this._update(S,I,I+this._delta32)}return this},_.prototype.digest=function(S){return this.update(this._pad()),r(this.pending===null),this._digest(S)},_.prototype._pad=function(){var S=this.pendingTotal,C=this._delta8,A=C-(S+this.padLength)%C,I=new Array(A+this.padLength);I[0]=128;for(var B=1;B<A;B++)I[B]=0;if(S<<=3,this.endian==="big"){for(var O=8;O<this.padLength;O++)I[B++]=0;I[B++]=0,I[B++]=0,I[B++]=0,I[B++]=0,I[B++]=S>>>24&255,I[B++]=S>>>16&255,I[B++]=S>>>8&255,I[B++]=S&255}else for(I[B++]=S&255,I[B++]=S>>>8&255,I[B++]=S>>>16&255,I[B++]=S>>>24&255,I[B++]=0,I[B++]=0,I[B++]=0,I[B++]=0,O=8;O<this.padLength;O++)I[B++]=0;return I},common$2}var sha={},common$1={},hasRequiredCommon;function requireCommon(){if(hasRequiredCommon)return common$1;hasRequiredCommon=1;var n=requireUtils(),r=n.rotr32;function _(N,U,j,z){if(N===0)return E(U,j,z);if(N===1||N===3)return C(U,j,z);if(N===2)return S(U,j,z)}common$1.ft_1=_;function E(N,U,j){return N&U^~N&j}common$1.ch32=E;function S(N,U,j){return N&U^N&j^U&j}common$1.maj32=S;function C(N,U,j){return N^U^j}common$1.p32=C;function A(N){return r(N,2)^r(N,13)^r(N,22)}common$1.s0_256=A;function I(N){return r(N,6)^r(N,11)^r(N,25)}common$1.s1_256=I;function B(N){return r(N,7)^r(N,18)^N>>>3}common$1.g0_256=B;function O(N){return r(N,17)^r(N,19)^N>>>10}return common$1.g1_256=O,common$1}var _1,hasRequired_1;function require_1(){if(hasRequired_1)return _1;hasRequired_1=1;var n=requireUtils(),r=requireCommon$1(),_=requireCommon(),E=n.rotl32,S=n.sum32,C=n.sum32_5,A=_.ft_1,I=r.BlockHash,B=[1518500249,1859775393,2400959708,3395469782];function O(){if(!(this instanceof O))return new O;I.call(this),this.h=[1732584193,4023233417,2562383102,271733878,3285377520],this.W=new Array(80)}return n.inherits(O,I),_1=O,O.blockSize=512,O.outSize=160,O.hmacStrength=80,O.padLength=64,O.prototype._update=function(U,j){for(var z=this.W,Z=0;Z<16;Z++)z[Z]=U[j+Z];for(;Z<z.length;Z++)z[Z]=E(z[Z-3]^z[Z-8]^z[Z-14]^z[Z-16],1);var X=this.h[0],Q=this.h[1],se=this.h[2],oe=this.h[3],ue=this.h[4];for(Z=0;Z<z.length;Z++){var we=~~(Z/20),Te=C(E(X,5),A(we,Q,se,oe),ue,z[Z],B[we]);ue=oe,oe=se,se=E(Q,30),Q=X,X=Te}this.h[0]=S(this.h[0],X),this.h[1]=S(this.h[1],Q),this.h[2]=S(this.h[2],se),this.h[3]=S(this.h[3],oe),this.h[4]=S(this.h[4],ue)},O.prototype._digest=function(U){return U==="hex"?n.toHex32(this.h,"big"):n.split32(this.h,"big")},_1}var _256,hasRequired_256;function require_256(){if(hasRequired_256)return _256;hasRequired_256=1;var n=requireUtils(),r=requireCommon$1(),_=requireCommon(),E=requireMinimalisticAssert(),S=n.sum32,C=n.sum32_4,A=n.sum32_5,I=_.ch32,B=_.maj32,O=_.s0_256,N=_.s1_256,U=_.g0_256,j=_.g1_256,z=r.BlockHash,Z=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298];function X(){if(!(this instanceof X))return new X;z.call(this),this.h=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],this.k=Z,this.W=new Array(64)}return n.inherits(X,z),_256=X,X.blockSize=512,X.outSize=256,X.hmacStrength=192,X.padLength=64,X.prototype._update=function(se,oe){for(var ue=this.W,we=0;we<16;we++)ue[we]=se[oe+we];for(;we<ue.length;we++)ue[we]=C(j(ue[we-2]),ue[we-7],U(ue[we-15]),ue[we-16]);var Te=this.h[0],xe=this.h[1],Re=this.h[2],Ne=this.h[3],Fe=this.h[4],ht=this.h[5],nt=this.h[6],Ee=this.h[7];for(E(this.k.length===ue.length),we=0;we<ue.length;we++){var Ce=A(Ee,N(Fe),I(Fe,ht,nt),this.k[we],ue[we]),_e=S(O(Te),B(Te,xe,Re));Ee=nt,nt=ht,ht=Fe,Fe=S(Ne,Ce),Ne=Re,Re=xe,xe=Te,Te=S(Ce,_e)}this.h[0]=S(this.h[0],Te),this.h[1]=S(this.h[1],xe),this.h[2]=S(this.h[2],Re),this.h[3]=S(this.h[3],Ne),this.h[4]=S(this.h[4],Fe),this.h[5]=S(this.h[5],ht),this.h[6]=S(this.h[6],nt),this.h[7]=S(this.h[7],Ee)},X.prototype._digest=function(se){return se==="hex"?n.toHex32(this.h,"big"):n.split32(this.h,"big")},_256}var _224,hasRequired_224;function require_224(){if(hasRequired_224)return _224;hasRequired_224=1;var n=requireUtils(),r=require_256();function _(){if(!(this instanceof _))return new _;r.call(this),this.h=[3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428]}return n.inherits(_,r),_224=_,_.blockSize=512,_.outSize=224,_.hmacStrength=192,_.padLength=64,_.prototype._digest=function(S){return S==="hex"?n.toHex32(this.h.slice(0,7),"big"):n.split32(this.h.slice(0,7),"big")},_224}var _512,hasRequired_512;function require_512(){if(hasRequired_512)return _512;hasRequired_512=1;var n=requireUtils(),r=requireCommon$1(),_=requireMinimalisticAssert(),E=n.rotr64_hi,S=n.rotr64_lo,C=n.shr64_hi,A=n.shr64_lo,I=n.sum64,B=n.sum64_hi,O=n.sum64_lo,N=n.sum64_4_hi,U=n.sum64_4_lo,j=n.sum64_5_hi,z=n.sum64_5_lo,Z=r.BlockHash,X=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591];function Q(){if(!(this instanceof Q))return new Q;Z.call(this),this.h=[1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209],this.k=X,this.W=new Array(160)}n.inherits(Q,Z),_512=Q,Q.blockSize=1024,Q.outSize=512,Q.hmacStrength=192,Q.padLength=128,Q.prototype._prepareBlock=function(_e,Ie){for(var He=this.W,Be=0;Be<32;Be++)He[Be]=_e[Ie+Be];for(;Be<He.length;Be+=2){var Ge=nt(He[Be-4],He[Be-3]),je=Ee(He[Be-4],He[Be-3]),Ve=He[Be-14],Pe=He[Be-13],Me=Fe(He[Be-30],He[Be-29]),tt=ht(He[Be-30],He[Be-29]),Ke=He[Be-32],mt=He[Be-31];He[Be]=N(Ge,je,Ve,Pe,Me,tt,Ke,mt),He[Be+1]=U(Ge,je,Ve,Pe,Me,tt,Ke,mt)}},Q.prototype._update=function(_e,Ie){this._prepareBlock(_e,Ie);var He=this.W,Be=this.h[0],Ge=this.h[1],je=this.h[2],Ve=this.h[3],Pe=this.h[4],Me=this.h[5],tt=this.h[6],Ke=this.h[7],mt=this.h[8],ct=this.h[9],Qe=this.h[10],dt=this.h[11],vt=this.h[12],At=this.h[13],bt=this.h[14],ft=this.h[15];_(this.k.length===He.length);for(var Et=0;Et<He.length;Et+=2){var Ye=bt,Ct=ft,Pt=Re(mt,ct),St=Ne(mt,ct),$t=se(mt,ct,Qe,dt,vt),kt=oe(mt,ct,Qe,dt,vt,At),Ft=this.k[Et],qt=this.k[Et+1],Mt=He[Et],Wt=He[Et+1],Zt=j(Ye,Ct,Pt,St,$t,kt,Ft,qt,Mt,Wt),Yt=z(Ye,Ct,Pt,St,$t,kt,Ft,qt,Mt,Wt);Ye=Te(Be,Ge),Ct=xe(Be,Ge),Pt=ue(Be,Ge,je,Ve,Pe),St=we(Be,Ge,je,Ve,Pe,Me);var ur=B(Ye,Ct,Pt,St),xt=O(Ye,Ct,Pt,St);bt=vt,ft=At,vt=Qe,At=dt,Qe=mt,dt=ct,mt=B(tt,Ke,Zt,Yt),ct=O(Ke,Ke,Zt,Yt),tt=Pe,Ke=Me,Pe=je,Me=Ve,je=Be,Ve=Ge,Be=B(Zt,Yt,ur,xt),Ge=O(Zt,Yt,ur,xt)}I(this.h,0,Be,Ge),I(this.h,2,je,Ve),I(this.h,4,Pe,Me),I(this.h,6,tt,Ke),I(this.h,8,mt,ct),I(this.h,10,Qe,dt),I(this.h,12,vt,At),I(this.h,14,bt,ft)},Q.prototype._digest=function(_e){return _e==="hex"?n.toHex32(this.h,"big"):n.split32(this.h,"big")};function se(Ce,_e,Ie,He,Be){var Ge=Ce&Ie^~Ce&Be;return Ge<0&&(Ge+=4294967296),Ge}function oe(Ce,_e,Ie,He,Be,Ge){var je=_e&He^~_e&Ge;return je<0&&(je+=4294967296),je}function ue(Ce,_e,Ie,He,Be){var Ge=Ce&Ie^Ce&Be^Ie&Be;return Ge<0&&(Ge+=4294967296),Ge}function we(Ce,_e,Ie,He,Be,Ge){var je=_e&He^_e&Ge^He&Ge;return je<0&&(je+=4294967296),je}function Te(Ce,_e){var Ie=E(Ce,_e,28),He=E(_e,Ce,2),Be=E(_e,Ce,7),Ge=Ie^He^Be;return Ge<0&&(Ge+=4294967296),Ge}function xe(Ce,_e){var Ie=S(Ce,_e,28),He=S(_e,Ce,2),Be=S(_e,Ce,7),Ge=Ie^He^Be;return Ge<0&&(Ge+=4294967296),Ge}function Re(Ce,_e){var Ie=E(Ce,_e,14),He=E(Ce,_e,18),Be=E(_e,Ce,9),Ge=Ie^He^Be;return Ge<0&&(Ge+=4294967296),Ge}function Ne(Ce,_e){var Ie=S(Ce,_e,14),He=S(Ce,_e,18),Be=S(_e,Ce,9),Ge=Ie^He^Be;return Ge<0&&(Ge+=4294967296),Ge}function Fe(Ce,_e){var Ie=E(Ce,_e,1),He=E(Ce,_e,8),Be=C(Ce,_e,7),Ge=Ie^He^Be;return Ge<0&&(Ge+=4294967296),Ge}function ht(Ce,_e){var Ie=S(Ce,_e,1),He=S(Ce,_e,8),Be=A(Ce,_e,7),Ge=Ie^He^Be;return Ge<0&&(Ge+=4294967296),Ge}function nt(Ce,_e){var Ie=E(Ce,_e,19),He=E(_e,Ce,29),Be=C(Ce,_e,6),Ge=Ie^He^Be;return Ge<0&&(Ge+=4294967296),Ge}function Ee(Ce,_e){var Ie=S(Ce,_e,19),He=S(_e,Ce,29),Be=A(Ce,_e,6),Ge=Ie^He^Be;return Ge<0&&(Ge+=4294967296),Ge}return _512}var _384,hasRequired_384;function require_384(){if(hasRequired_384)return _384;hasRequired_384=1;var n=requireUtils(),r=require_512();function _(){if(!(this instanceof _))return new _;r.call(this),this.h=[3418070365,3238371032,1654270250,914150663,2438529370,812702999,355462360,4144912697,1731405415,4290775857,2394180231,1750603025,3675008525,1694076839,1203062813,3204075428]}return n.inherits(_,r),_384=_,_.blockSize=1024,_.outSize=384,_.hmacStrength=192,_.padLength=128,_.prototype._digest=function(S){return S==="hex"?n.toHex32(this.h.slice(0,12),"big"):n.split32(this.h.slice(0,12),"big")},_384}var hasRequiredSha;function requireSha(){return hasRequiredSha||(hasRequiredSha=1,sha.sha1=require_1(),sha.sha224=require_224(),sha.sha256=require_256(),sha.sha384=require_384(),sha.sha512=require_512()),sha}var ripemd={},hasRequiredRipemd;function requireRipemd(){if(hasRequiredRipemd)return ripemd;hasRequiredRipemd=1;var n=requireUtils(),r=requireCommon$1(),_=n.rotl32,E=n.sum32,S=n.sum32_3,C=n.sum32_4,A=r.BlockHash;function I(){if(!(this instanceof I))return new I;A.call(this),this.h=[1732584193,4023233417,2562383102,271733878,3285377520],this.endian="little"}n.inherits(I,A),ripemd.ripemd160=I,I.blockSize=512,I.outSize=160,I.hmacStrength=192,I.padLength=64,I.prototype._update=function(Q,se){for(var oe=this.h[0],ue=this.h[1],we=this.h[2],Te=this.h[3],xe=this.h[4],Re=oe,Ne=ue,Fe=we,ht=Te,nt=xe,Ee=0;Ee<80;Ee++){var Ce=E(_(C(oe,B(Ee,ue,we,Te),Q[U[Ee]+se],O(Ee)),z[Ee]),xe);oe=xe,xe=Te,Te=_(we,10),we=ue,ue=Ce,Ce=E(_(C(Re,B(79-Ee,Ne,Fe,ht),Q[j[Ee]+se],N(Ee)),Z[Ee]),nt),Re=nt,nt=ht,ht=_(Fe,10),Fe=Ne,Ne=Ce}Ce=S(this.h[1],we,ht),this.h[1]=S(this.h[2],Te,nt),this.h[2]=S(this.h[3],xe,Re),this.h[3]=S(this.h[4],oe,Ne),this.h[4]=S(this.h[0],ue,Fe),this.h[0]=Ce},I.prototype._digest=function(Q){return Q==="hex"?n.toHex32(this.h,"little"):n.split32(this.h,"little")};function B(X,Q,se,oe){return X<=15?Q^se^oe:X<=31?Q&se|~Q&oe:X<=47?(Q|~se)^oe:X<=63?Q&oe|se&~oe:Q^(se|~oe)}function O(X){return X<=15?0:X<=31?1518500249:X<=47?1859775393:X<=63?2400959708:2840853838}function N(X){return X<=15?1352829926:X<=31?1548603684:X<=47?1836072691:X<=63?2053994217:0}var U=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13],j=[5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11],z=[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6],Z=[8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11];return ripemd}var hmac$1,hasRequiredHmac;function requireHmac(){if(hasRequiredHmac)return hmac$1;hasRequiredHmac=1;var n=requireUtils(),r=requireMinimalisticAssert();function _(E,S,C){if(!(this instanceof _))return new _(E,S,C);this.Hash=E,this.blockSize=E.blockSize/8,this.outSize=E.outSize/8,this.inner=null,this.outer=null,this._init(n.toArray(S,C))}return hmac$1=_,_.prototype._init=function(S){S.length>this.blockSize&&(S=new this.Hash().update(S).digest()),r(S.length<=this.blockSize);for(var C=S.length;C<this.blockSize;C++)S.push(0);for(C=0;C<S.length;C++)S[C]^=54;for(this.inner=new this.Hash().update(S),C=0;C<S.length;C++)S[C]^=106;this.outer=new this.Hash().update(S)},_.prototype.update=function(S,C){return this.inner.update(S,C),this},_.prototype.digest=function(S){return this.outer.update(this.inner.digest()),this.outer.digest(S)},hmac$1}var hasRequiredHash;function requireHash(){return hasRequiredHash||(hasRequiredHash=1,function(n){var r=n;r.utils=requireUtils(),r.common=requireCommon$1(),r.sha=requireSha(),r.ripemd=requireRipemd(),r.hmac=requireHmac(),r.sha1=r.sha.sha1,r.sha256=r.sha.sha256,r.sha224=r.sha.sha224,r.sha384=r.sha.sha384,r.sha512=r.sha.sha512,r.ripemd160=r.ripemd.ripemd160}(hash$2)),hash$2}var secp256k1$1,hasRequiredSecp256k1;function requireSecp256k1(){return hasRequiredSecp256k1||(hasRequiredSecp256k1=1,secp256k1$1={doubles:{step:4,points:[["e60fce93b59e9ec53011aabc21c23e97b2a31369b87a5ae9c44ee89e2a6dec0a","f7e3507399e595929db99f34f57937101296891e44d23f0be1f32cce69616821"],["8282263212c609d9ea2a6e3e172de238d8c39cabd5ac1ca10646e23fd5f51508","11f8a8098557dfe45e8256e830b60ace62d613ac2f7b17bed31b6eaff6e26caf"],["175e159f728b865a72f99cc6c6fc846de0b93833fd2222ed73fce5b551e5b739","d3506e0d9e3c79eba4ef97a51ff71f5eacb5955add24345c6efa6ffee9fed695"],["363d90d447b00c9c99ceac05b6262ee053441c7e55552ffe526bad8f83ff4640","4e273adfc732221953b445397f3363145b9a89008199ecb62003c7f3bee9de9"],["8b4b5f165df3c2be8c6244b5b745638843e4a781a15bcd1b69f79a55dffdf80c","4aad0a6f68d308b4b3fbd7813ab0da04f9e336546162ee56b3eff0c65fd4fd36"],["723cbaa6e5db996d6bf771c00bd548c7b700dbffa6c0e77bcb6115925232fcda","96e867b5595cc498a921137488824d6e2660a0653779494801dc069d9eb39f5f"],["eebfa4d493bebf98ba5feec812c2d3b50947961237a919839a533eca0e7dd7fa","5d9a8ca3970ef0f269ee7edaf178089d9ae4cdc3a711f712ddfd4fdae1de8999"],["100f44da696e71672791d0a09b7bde459f1215a29b3c03bfefd7835b39a48db0","cdd9e13192a00b772ec8f3300c090666b7ff4a18ff5195ac0fbd5cd62bc65a09"],["e1031be262c7ed1b1dc9227a4a04c017a77f8d4464f3b3852c8acde6e534fd2d","9d7061928940405e6bb6a4176597535af292dd419e1ced79a44f18f29456a00d"],["feea6cae46d55b530ac2839f143bd7ec5cf8b266a41d6af52d5e688d9094696d","e57c6b6c97dce1bab06e4e12bf3ecd5c981c8957cc41442d3155debf18090088"],["da67a91d91049cdcb367be4be6ffca3cfeed657d808583de33fa978bc1ec6cb1","9bacaa35481642bc41f463f7ec9780e5dec7adc508f740a17e9ea8e27a68be1d"],["53904faa0b334cdda6e000935ef22151ec08d0f7bb11069f57545ccc1a37b7c0","5bc087d0bc80106d88c9eccac20d3c1c13999981e14434699dcb096b022771c8"],["8e7bcd0bd35983a7719cca7764ca906779b53a043a9b8bcaeff959f43ad86047","10b7770b2a3da4b3940310420ca9514579e88e2e47fd68b3ea10047e8460372a"],["385eed34c1cdff21e6d0818689b81bde71a7f4f18397e6690a841e1599c43862","283bebc3e8ea23f56701de19e9ebf4576b304eec2086dc8cc0458fe5542e5453"],["6f9d9b803ecf191637c73a4413dfa180fddf84a5947fbc9c606ed86c3fac3a7","7c80c68e603059ba69b8e2a30e45c4d47ea4dd2f5c281002d86890603a842160"],["3322d401243c4e2582a2147c104d6ecbf774d163db0f5e5313b7e0e742d0e6bd","56e70797e9664ef5bfb019bc4ddaf9b72805f63ea2873af624f3a2e96c28b2a0"],["85672c7d2de0b7da2bd1770d89665868741b3f9af7643397721d74d28134ab83","7c481b9b5b43b2eb6374049bfa62c2e5e77f17fcc5298f44c8e3094f790313a6"],["948bf809b1988a46b06c9f1919413b10f9226c60f668832ffd959af60c82a0a","53a562856dcb6646dc6b74c5d1c3418c6d4dff08c97cd2bed4cb7f88d8c8e589"],["6260ce7f461801c34f067ce0f02873a8f1b0e44dfc69752accecd819f38fd8e8","bc2da82b6fa5b571a7f09049776a1ef7ecd292238051c198c1a84e95b2b4ae17"],["e5037de0afc1d8d43d8348414bbf4103043ec8f575bfdc432953cc8d2037fa2d","4571534baa94d3b5f9f98d09fb990bddbd5f5b03ec481f10e0e5dc841d755bda"],["e06372b0f4a207adf5ea905e8f1771b4e7e8dbd1c6a6c5b725866a0ae4fce725","7a908974bce18cfe12a27bb2ad5a488cd7484a7787104870b27034f94eee31dd"],["213c7a715cd5d45358d0bbf9dc0ce02204b10bdde2a3f58540ad6908d0559754","4b6dad0b5ae462507013ad06245ba190bb4850f5f36a7eeddff2c27534b458f2"],["4e7c272a7af4b34e8dbb9352a5419a87e2838c70adc62cddf0cc3a3b08fbd53c","17749c766c9d0b18e16fd09f6def681b530b9614bff7dd33e0b3941817dcaae6"],["fea74e3dbe778b1b10f238ad61686aa5c76e3db2be43057632427e2840fb27b6","6e0568db9b0b13297cf674deccb6af93126b596b973f7b77701d3db7f23cb96f"],["76e64113f677cf0e10a2570d599968d31544e179b760432952c02a4417bdde39","c90ddf8dee4e95cf577066d70681f0d35e2a33d2b56d2032b4b1752d1901ac01"],["c738c56b03b2abe1e8281baa743f8f9a8f7cc643df26cbee3ab150242bcbb891","893fb578951ad2537f718f2eacbfbbbb82314eef7880cfe917e735d9699a84c3"],["d895626548b65b81e264c7637c972877d1d72e5f3a925014372e9f6588f6c14b","febfaa38f2bc7eae728ec60818c340eb03428d632bb067e179363ed75d7d991f"],["b8da94032a957518eb0f6433571e8761ceffc73693e84edd49150a564f676e03","2804dfa44805a1e4d7c99cc9762808b092cc584d95ff3b511488e4e74efdf6e7"],["e80fea14441fb33a7d8adab9475d7fab2019effb5156a792f1a11778e3c0df5d","eed1de7f638e00771e89768ca3ca94472d155e80af322ea9fcb4291b6ac9ec78"],["a301697bdfcd704313ba48e51d567543f2a182031efd6915ddc07bbcc4e16070","7370f91cfb67e4f5081809fa25d40f9b1735dbf7c0a11a130c0d1a041e177ea1"],["90ad85b389d6b936463f9d0512678de208cc330b11307fffab7ac63e3fb04ed4","e507a3620a38261affdcbd9427222b839aefabe1582894d991d4d48cb6ef150"],["8f68b9d2f63b5f339239c1ad981f162ee88c5678723ea3351b7b444c9ec4c0da","662a9f2dba063986de1d90c2b6be215dbbea2cfe95510bfdf23cbf79501fff82"],["e4f3fb0176af85d65ff99ff9198c36091f48e86503681e3e6686fd5053231e11","1e63633ad0ef4f1c1661a6d0ea02b7286cc7e74ec951d1c9822c38576feb73bc"],["8c00fa9b18ebf331eb961537a45a4266c7034f2f0d4e1d0716fb6eae20eae29e","efa47267fea521a1a9dc343a3736c974c2fadafa81e36c54e7d2a4c66702414b"],["e7a26ce69dd4829f3e10cec0a9e98ed3143d084f308b92c0997fddfc60cb3e41","2a758e300fa7984b471b006a1aafbb18d0a6b2c0420e83e20e8a9421cf2cfd51"],["b6459e0ee3662ec8d23540c223bcbdc571cbcb967d79424f3cf29eb3de6b80ef","67c876d06f3e06de1dadf16e5661db3c4b3ae6d48e35b2ff30bf0b61a71ba45"],["d68a80c8280bb840793234aa118f06231d6f1fc67e73c5a5deda0f5b496943e8","db8ba9fff4b586d00c4b1f9177b0e28b5b0e7b8f7845295a294c84266b133120"],["324aed7df65c804252dc0270907a30b09612aeb973449cea4095980fc28d3d5d","648a365774b61f2ff130c0c35aec1f4f19213b0c7e332843967224af96ab7c84"],["4df9c14919cde61f6d51dfdbe5fee5dceec4143ba8d1ca888e8bd373fd054c96","35ec51092d8728050974c23a1d85d4b5d506cdc288490192ebac06cad10d5d"],["9c3919a84a474870faed8a9c1cc66021523489054d7f0308cbfc99c8ac1f98cd","ddb84f0f4a4ddd57584f044bf260e641905326f76c64c8e6be7e5e03d4fc599d"],["6057170b1dd12fdf8de05f281d8e06bb91e1493a8b91d4cc5a21382120a959e5","9a1af0b26a6a4807add9a2daf71df262465152bc3ee24c65e899be932385a2a8"],["a576df8e23a08411421439a4518da31880cef0fba7d4df12b1a6973eecb94266","40a6bf20e76640b2c92b97afe58cd82c432e10a7f514d9f3ee8be11ae1b28ec8"],["7778a78c28dec3e30a05fe9629de8c38bb30d1f5cf9a3a208f763889be58ad71","34626d9ab5a5b22ff7098e12f2ff580087b38411ff24ac563b513fc1fd9f43ac"],["928955ee637a84463729fd30e7afd2ed5f96274e5ad7e5cb09eda9c06d903ac","c25621003d3f42a827b78a13093a95eeac3d26efa8a8d83fc5180e935bcd091f"],["85d0fef3ec6db109399064f3a0e3b2855645b4a907ad354527aae75163d82751","1f03648413a38c0be29d496e582cf5663e8751e96877331582c237a24eb1f962"],["ff2b0dce97eece97c1c9b6041798b85dfdfb6d8882da20308f5404824526087e","493d13fef524ba188af4c4dc54d07936c7b7ed6fb90e2ceb2c951e01f0c29907"],["827fbbe4b1e880ea9ed2b2e6301b212b57f1ee148cd6dd28780e5e2cf856e241","c60f9c923c727b0b71bef2c67d1d12687ff7a63186903166d605b68baec293ec"],["eaa649f21f51bdbae7be4ae34ce6e5217a58fdce7f47f9aa7f3b58fa2120e2b3","be3279ed5bbbb03ac69a80f89879aa5a01a6b965f13f7e59d47a5305ba5ad93d"],["e4a42d43c5cf169d9391df6decf42ee541b6d8f0c9a137401e23632dda34d24f","4d9f92e716d1c73526fc99ccfb8ad34ce886eedfa8d8e4f13a7f7131deba9414"],["1ec80fef360cbdd954160fadab352b6b92b53576a88fea4947173b9d4300bf19","aeefe93756b5340d2f3a4958a7abbf5e0146e77f6295a07b671cdc1cc107cefd"],["146a778c04670c2f91b00af4680dfa8bce3490717d58ba889ddb5928366642be","b318e0ec3354028add669827f9d4b2870aaa971d2f7e5ed1d0b297483d83efd0"],["fa50c0f61d22e5f07e3acebb1aa07b128d0012209a28b9776d76a8793180eef9","6b84c6922397eba9b72cd2872281a68a5e683293a57a213b38cd8d7d3f4f2811"],["da1d61d0ca721a11b1a5bf6b7d88e8421a288ab5d5bba5220e53d32b5f067ec2","8157f55a7c99306c79c0766161c91e2966a73899d279b48a655fba0f1ad836f1"],["a8e282ff0c9706907215ff98e8fd416615311de0446f1e062a73b0610d064e13","7f97355b8db81c09abfb7f3c5b2515888b679a3e50dd6bd6cef7c73111f4cc0c"],["174a53b9c9a285872d39e56e6913cab15d59b1fa512508c022f382de8319497c","ccc9dc37abfc9c1657b4155f2c47f9e6646b3a1d8cb9854383da13ac079afa73"],["959396981943785c3d3e57edf5018cdbe039e730e4918b3d884fdff09475b7ba","2e7e552888c331dd8ba0386a4b9cd6849c653f64c8709385e9b8abf87524f2fd"],["d2a63a50ae401e56d645a1153b109a8fcca0a43d561fba2dbb51340c9d82b151","e82d86fb6443fcb7565aee58b2948220a70f750af484ca52d4142174dcf89405"],["64587e2335471eb890ee7896d7cfdc866bacbdbd3839317b3436f9b45617e073","d99fcdd5bf6902e2ae96dd6447c299a185b90a39133aeab358299e5e9faf6589"],["8481bde0e4e4d885b3a546d3e549de042f0aa6cea250e7fd358d6c86dd45e458","38ee7b8cba5404dd84a25bf39cecb2ca900a79c42b262e556d64b1b59779057e"],["13464a57a78102aa62b6979ae817f4637ffcfed3c4b1ce30bcd6303f6caf666b","69be159004614580ef7e433453ccb0ca48f300a81d0942e13f495a907f6ecc27"],["bc4a9df5b713fe2e9aef430bcc1dc97a0cd9ccede2f28588cada3a0d2d83f366","d3a81ca6e785c06383937adf4b798caa6e8a9fbfa547b16d758d666581f33c1"],["8c28a97bf8298bc0d23d8c749452a32e694b65e30a9472a3954ab30fe5324caa","40a30463a3305193378fedf31f7cc0eb7ae784f0451cb9459e71dc73cbef9482"],["8ea9666139527a8c1dd94ce4f071fd23c8b350c5a4bb33748c4ba111faccae0","620efabbc8ee2782e24e7c0cfb95c5d735b783be9cf0f8e955af34a30e62b945"],["dd3625faef5ba06074669716bbd3788d89bdde815959968092f76cc4eb9a9787","7a188fa3520e30d461da2501045731ca941461982883395937f68d00c644a573"],["f710d79d9eb962297e4f6232b40e8f7feb2bc63814614d692c12de752408221e","ea98e67232d3b3295d3b535532115ccac8612c721851617526ae47a9c77bfc82"]]},naf:{wnd:7,points:[["f9308a019258c31049344f85f89d5229b531c845836f99b08601f113bce036f9","388f7b0f632de8140fe337e62a37f3566500a99934c2231b6cb9fd7584b8e672"],["2f8bde4d1a07209355b4a7250a5c5128e88b84bddc619ab7cba8d569b240efe4","d8ac222636e5e3d6d4dba9dda6c9c426f788271bab0d6840dca87d3aa6ac62d6"],["5cbdf0646e5db4eaa398f365f2ea7a0e3d419b7e0330e39ce92bddedcac4f9bc","6aebca40ba255960a3178d6d861a54dba813d0b813fde7b5a5082628087264da"],["acd484e2f0c7f65309ad178a9f559abde09796974c57e714c35f110dfc27ccbe","cc338921b0a7d9fd64380971763b61e9add888a4375f8e0f05cc262ac64f9c37"],["774ae7f858a9411e5ef4246b70c65aac5649980be5c17891bbec17895da008cb","d984a032eb6b5e190243dd56d7b7b365372db1e2dff9d6a8301d74c9c953c61b"],["f28773c2d975288bc7d1d205c3748651b075fbc6610e58cddeeddf8f19405aa8","ab0902e8d880a89758212eb65cdaf473a1a06da521fa91f29b5cb52db03ed81"],["d7924d4f7d43ea965a465ae3095ff41131e5946f3c85f79e44adbcf8e27e080e","581e2872a86c72a683842ec228cc6defea40af2bd896d3a5c504dc9ff6a26b58"],["defdea4cdb677750a420fee807eacf21eb9898ae79b9768766e4faa04a2d4a34","4211ab0694635168e997b0ead2a93daeced1f4a04a95c0f6cfb199f69e56eb77"],["2b4ea0a797a443d293ef5cff444f4979f06acfebd7e86d277475656138385b6c","85e89bc037945d93b343083b5a1c86131a01f60c50269763b570c854e5c09b7a"],["352bbf4a4cdd12564f93fa332ce333301d9ad40271f8107181340aef25be59d5","321eb4075348f534d59c18259dda3e1f4a1b3b2e71b1039c67bd3d8bcf81998c"],["2fa2104d6b38d11b0230010559879124e42ab8dfeff5ff29dc9cdadd4ecacc3f","2de1068295dd865b64569335bd5dd80181d70ecfc882648423ba76b532b7d67"],["9248279b09b4d68dab21a9b066edda83263c3d84e09572e269ca0cd7f5453714","73016f7bf234aade5d1aa71bdea2b1ff3fc0de2a887912ffe54a32ce97cb3402"],["daed4f2be3a8bf278e70132fb0beb7522f570e144bf615c07e996d443dee8729","a69dce4a7d6c98e8d4a1aca87ef8d7003f83c230f3afa726ab40e52290be1c55"],["c44d12c7065d812e8acf28d7cbb19f9011ecd9e9fdf281b0e6a3b5e87d22e7db","2119a460ce326cdc76c45926c982fdac0e106e861edf61c5a039063f0e0e6482"],["6a245bf6dc698504c89a20cfded60853152b695336c28063b61c65cbd269e6b4","e022cf42c2bd4a708b3f5126f16a24ad8b33ba48d0423b6efd5e6348100d8a82"],["1697ffa6fd9de627c077e3d2fe541084ce13300b0bec1146f95ae57f0d0bd6a5","b9c398f186806f5d27561506e4557433a2cf15009e498ae7adee9d63d01b2396"],["605bdb019981718b986d0f07e834cb0d9deb8360ffb7f61df982345ef27a7479","2972d2de4f8d20681a78d93ec96fe23c26bfae84fb14db43b01e1e9056b8c49"],["62d14dab4150bf497402fdc45a215e10dcb01c354959b10cfe31c7e9d87ff33d","80fc06bd8cc5b01098088a1950eed0db01aa132967ab472235f5642483b25eaf"],["80c60ad0040f27dade5b4b06c408e56b2c50e9f56b9b8b425e555c2f86308b6f","1c38303f1cc5c30f26e66bad7fe72f70a65eed4cbe7024eb1aa01f56430bd57a"],["7a9375ad6167ad54aa74c6348cc54d344cc5dc9487d847049d5eabb0fa03c8fb","d0e3fa9eca8726909559e0d79269046bdc59ea10c70ce2b02d499ec224dc7f7"],["d528ecd9b696b54c907a9ed045447a79bb408ec39b68df504bb51f459bc3ffc9","eecf41253136e5f99966f21881fd656ebc4345405c520dbc063465b521409933"],["49370a4b5f43412ea25f514e8ecdad05266115e4a7ecb1387231808f8b45963","758f3f41afd6ed428b3081b0512fd62a54c3f3afbb5b6764b653052a12949c9a"],["77f230936ee88cbbd73df930d64702ef881d811e0e1498e2f1c13eb1fc345d74","958ef42a7886b6400a08266e9ba1b37896c95330d97077cbbe8eb3c7671c60d6"],["f2dac991cc4ce4b9ea44887e5c7c0bce58c80074ab9d4dbaeb28531b7739f530","e0dedc9b3b2f8dad4da1f32dec2531df9eb5fbeb0598e4fd1a117dba703a3c37"],["463b3d9f662621fb1b4be8fbbe2520125a216cdfc9dae3debcba4850c690d45b","5ed430d78c296c3543114306dd8622d7c622e27c970a1de31cb377b01af7307e"],["f16f804244e46e2a09232d4aff3b59976b98fac14328a2d1a32496b49998f247","cedabd9b82203f7e13d206fcdf4e33d92a6c53c26e5cce26d6579962c4e31df6"],["caf754272dc84563b0352b7a14311af55d245315ace27c65369e15f7151d41d1","cb474660ef35f5f2a41b643fa5e460575f4fa9b7962232a5c32f908318a04476"],["2600ca4b282cb986f85d0f1709979d8b44a09c07cb86d7c124497bc86f082120","4119b88753c15bd6a693b03fcddbb45d5ac6be74ab5f0ef44b0be9475a7e4b40"],["7635ca72d7e8432c338ec53cd12220bc01c48685e24f7dc8c602a7746998e435","91b649609489d613d1d5e590f78e6d74ecfc061d57048bad9e76f302c5b9c61"],["754e3239f325570cdbbf4a87deee8a66b7f2b33479d468fbc1a50743bf56cc18","673fb86e5bda30fb3cd0ed304ea49a023ee33d0197a695d0c5d98093c536683"],["e3e6bd1071a1e96aff57859c82d570f0330800661d1c952f9fe2694691d9b9e8","59c9e0bba394e76f40c0aa58379a3cb6a5a2283993e90c4167002af4920e37f5"],["186b483d056a033826ae73d88f732985c4ccb1f32ba35f4b4cc47fdcf04aa6eb","3b952d32c67cf77e2e17446e204180ab21fb8090895138b4a4a797f86e80888b"],["df9d70a6b9876ce544c98561f4be4f725442e6d2b737d9c91a8321724ce0963f","55eb2dafd84d6ccd5f862b785dc39d4ab157222720ef9da217b8c45cf2ba2417"],["5edd5cc23c51e87a497ca815d5dce0f8ab52554f849ed8995de64c5f34ce7143","efae9c8dbc14130661e8cec030c89ad0c13c66c0d17a2905cdc706ab7399a868"],["290798c2b6476830da12fe02287e9e777aa3fba1c355b17a722d362f84614fba","e38da76dcd440621988d00bcf79af25d5b29c094db2a23146d003afd41943e7a"],["af3c423a95d9f5b3054754efa150ac39cd29552fe360257362dfdecef4053b45","f98a3fd831eb2b749a93b0e6f35cfb40c8cd5aa667a15581bc2feded498fd9c6"],["766dbb24d134e745cccaa28c99bf274906bb66b26dcf98df8d2fed50d884249a","744b1152eacbe5e38dcc887980da38b897584a65fa06cedd2c924f97cbac5996"],["59dbf46f8c94759ba21277c33784f41645f7b44f6c596a58ce92e666191abe3e","c534ad44175fbc300f4ea6ce648309a042ce739a7919798cd85e216c4a307f6e"],["f13ada95103c4537305e691e74e9a4a8dd647e711a95e73cb62dc6018cfd87b8","e13817b44ee14de663bf4bc808341f326949e21a6a75c2570778419bdaf5733d"],["7754b4fa0e8aced06d4167a2c59cca4cda1869c06ebadfb6488550015a88522c","30e93e864e669d82224b967c3020b8fa8d1e4e350b6cbcc537a48b57841163a2"],["948dcadf5990e048aa3874d46abef9d701858f95de8041d2a6828c99e2262519","e491a42537f6e597d5d28a3224b1bc25df9154efbd2ef1d2cbba2cae5347d57e"],["7962414450c76c1689c7b48f8202ec37fb224cf5ac0bfa1570328a8a3d7c77ab","100b610ec4ffb4760d5c1fc133ef6f6b12507a051f04ac5760afa5b29db83437"],["3514087834964b54b15b160644d915485a16977225b8847bb0dd085137ec47ca","ef0afbb2056205448e1652c48e8127fc6039e77c15c2378b7e7d15a0de293311"],["d3cc30ad6b483e4bc79ce2c9dd8bc54993e947eb8df787b442943d3f7b527eaf","8b378a22d827278d89c5e9be8f9508ae3c2ad46290358630afb34db04eede0a4"],["1624d84780732860ce1c78fcbfefe08b2b29823db913f6493975ba0ff4847610","68651cf9b6da903e0914448c6cd9d4ca896878f5282be4c8cc06e2a404078575"],["733ce80da955a8a26902c95633e62a985192474b5af207da6df7b4fd5fc61cd4","f5435a2bd2badf7d485a4d8b8db9fcce3e1ef8e0201e4578c54673bc1dc5ea1d"],["15d9441254945064cf1a1c33bbd3b49f8966c5092171e699ef258dfab81c045c","d56eb30b69463e7234f5137b73b84177434800bacebfc685fc37bbe9efe4070d"],["a1d0fcf2ec9de675b612136e5ce70d271c21417c9d2b8aaaac138599d0717940","edd77f50bcb5a3cab2e90737309667f2641462a54070f3d519212d39c197a629"],["e22fbe15c0af8ccc5780c0735f84dbe9a790badee8245c06c7ca37331cb36980","a855babad5cd60c88b430a69f53a1a7a38289154964799be43d06d77d31da06"],["311091dd9860e8e20ee13473c1155f5f69635e394704eaa74009452246cfa9b3","66db656f87d1f04fffd1f04788c06830871ec5a64feee685bd80f0b1286d8374"],["34c1fd04d301be89b31c0442d3e6ac24883928b45a9340781867d4232ec2dbdf","9414685e97b1b5954bd46f730174136d57f1ceeb487443dc5321857ba73abee"],["f219ea5d6b54701c1c14de5b557eb42a8d13f3abbcd08affcc2a5e6b049b8d63","4cb95957e83d40b0f73af4544cccf6b1f4b08d3c07b27fb8d8c2962a400766d1"],["d7b8740f74a8fbaab1f683db8f45de26543a5490bca627087236912469a0b448","fa77968128d9c92ee1010f337ad4717eff15db5ed3c049b3411e0315eaa4593b"],["32d31c222f8f6f0ef86f7c98d3a3335ead5bcd32abdd94289fe4d3091aa824bf","5f3032f5892156e39ccd3d7915b9e1da2e6dac9e6f26e961118d14b8462e1661"],["7461f371914ab32671045a155d9831ea8793d77cd59592c4340f86cbc18347b5","8ec0ba238b96bec0cbdddcae0aa442542eee1ff50c986ea6b39847b3cc092ff6"],["ee079adb1df1860074356a25aa38206a6d716b2c3e67453d287698bad7b2b2d6","8dc2412aafe3be5c4c5f37e0ecc5f9f6a446989af04c4e25ebaac479ec1c8c1e"],["16ec93e447ec83f0467b18302ee620f7e65de331874c9dc72bfd8616ba9da6b5","5e4631150e62fb40d0e8c2a7ca5804a39d58186a50e497139626778e25b0674d"],["eaa5f980c245f6f038978290afa70b6bd8855897f98b6aa485b96065d537bd99","f65f5d3e292c2e0819a528391c994624d784869d7e6ea67fb18041024edc07dc"],["78c9407544ac132692ee1910a02439958ae04877151342ea96c4b6b35a49f51","f3e0319169eb9b85d5404795539a5e68fa1fbd583c064d2462b675f194a3ddb4"],["494f4be219a1a77016dcd838431aea0001cdc8ae7a6fc688726578d9702857a5","42242a969283a5f339ba7f075e36ba2af925ce30d767ed6e55f4b031880d562c"],["a598a8030da6d86c6bc7f2f5144ea549d28211ea58faa70ebf4c1e665c1fe9b5","204b5d6f84822c307e4b4a7140737aec23fc63b65b35f86a10026dbd2d864e6b"],["c41916365abb2b5d09192f5f2dbeafec208f020f12570a184dbadc3e58595997","4f14351d0087efa49d245b328984989d5caf9450f34bfc0ed16e96b58fa9913"],["841d6063a586fa475a724604da03bc5b92a2e0d2e0a36acfe4c73a5514742881","73867f59c0659e81904f9a1c7543698e62562d6744c169ce7a36de01a8d6154"],["5e95bb399a6971d376026947f89bde2f282b33810928be4ded112ac4d70e20d5","39f23f366809085beebfc71181313775a99c9aed7d8ba38b161384c746012865"],["36e4641a53948fd476c39f8a99fd974e5ec07564b5315d8bf99471bca0ef2f66","d2424b1b1abe4eb8164227b085c9aa9456ea13493fd563e06fd51cf5694c78fc"],["336581ea7bfbbb290c191a2f507a41cf5643842170e914faeab27c2c579f726","ead12168595fe1be99252129b6e56b3391f7ab1410cd1e0ef3dcdcabd2fda224"],["8ab89816dadfd6b6a1f2634fcf00ec8403781025ed6890c4849742706bd43ede","6fdcef09f2f6d0a044e654aef624136f503d459c3e89845858a47a9129cdd24e"],["1e33f1a746c9c5778133344d9299fcaa20b0938e8acff2544bb40284b8c5fb94","60660257dd11b3aa9c8ed618d24edff2306d320f1d03010e33a7d2057f3b3b6"],["85b7c1dcb3cec1b7ee7f30ded79dd20a0ed1f4cc18cbcfcfa410361fd8f08f31","3d98a9cdd026dd43f39048f25a8847f4fcafad1895d7a633c6fed3c35e999511"],["29df9fbd8d9e46509275f4b125d6d45d7fbe9a3b878a7af872a2800661ac5f51","b4c4fe99c775a606e2d8862179139ffda61dc861c019e55cd2876eb2a27d84b"],["a0b1cae06b0a847a3fea6e671aaf8adfdfe58ca2f768105c8082b2e449fce252","ae434102edde0958ec4b19d917a6a28e6b72da1834aff0e650f049503a296cf2"],["4e8ceafb9b3e9a136dc7ff67e840295b499dfb3b2133e4ba113f2e4c0e121e5","cf2174118c8b6d7a4b48f6d534ce5c79422c086a63460502b827ce62a326683c"],["d24a44e047e19b6f5afb81c7ca2f69080a5076689a010919f42725c2b789a33b","6fb8d5591b466f8fc63db50f1c0f1c69013f996887b8244d2cdec417afea8fa3"],["ea01606a7a6c9cdd249fdfcfacb99584001edd28abbab77b5104e98e8e3b35d4","322af4908c7312b0cfbfe369f7a7b3cdb7d4494bc2823700cfd652188a3ea98d"],["af8addbf2b661c8a6c6328655eb96651252007d8c5ea31be4ad196de8ce2131f","6749e67c029b85f52a034eafd096836b2520818680e26ac8f3dfbcdb71749700"],["e3ae1974566ca06cc516d47e0fb165a674a3dabcfca15e722f0e3450f45889","2aeabe7e4531510116217f07bf4d07300de97e4874f81f533420a72eeb0bd6a4"],["591ee355313d99721cf6993ffed1e3e301993ff3ed258802075ea8ced397e246","b0ea558a113c30bea60fc4775460c7901ff0b053d25ca2bdeee98f1a4be5d196"],["11396d55fda54c49f19aa97318d8da61fa8584e47b084945077cf03255b52984","998c74a8cd45ac01289d5833a7beb4744ff536b01b257be4c5767bea93ea57a4"],["3c5d2a1ba39c5a1790000738c9e0c40b8dcdfd5468754b6405540157e017aa7a","b2284279995a34e2f9d4de7396fc18b80f9b8b9fdd270f6661f79ca4c81bd257"],["cc8704b8a60a0defa3a99a7299f2e9c3fbc395afb04ac078425ef8a1793cc030","bdd46039feed17881d1e0862db347f8cf395b74fc4bcdc4e940b74e3ac1f1b13"],["c533e4f7ea8555aacd9777ac5cad29b97dd4defccc53ee7ea204119b2889b197","6f0a256bc5efdf429a2fb6242f1a43a2d9b925bb4a4b3a26bb8e0f45eb596096"],["c14f8f2ccb27d6f109f6d08d03cc96a69ba8c34eec07bbcf566d48e33da6593","c359d6923bb398f7fd4473e16fe1c28475b740dd098075e6c0e8649113dc3a38"],["a6cbc3046bc6a450bac24789fa17115a4c9739ed75f8f21ce441f72e0b90e6ef","21ae7f4680e889bb130619e2c0f95a360ceb573c70603139862afd617fa9b9f"],["347d6d9a02c48927ebfb86c1359b1caf130a3c0267d11ce6344b39f99d43cc38","60ea7f61a353524d1c987f6ecec92f086d565ab687870cb12689ff1e31c74448"],["da6545d2181db8d983f7dcb375ef5866d47c67b1bf31c8cf855ef7437b72656a","49b96715ab6878a79e78f07ce5680c5d6673051b4935bd897fea824b77dc208a"],["c40747cc9d012cb1a13b8148309c6de7ec25d6945d657146b9d5994b8feb1111","5ca560753be2a12fc6de6caf2cb489565db936156b9514e1bb5e83037e0fa2d4"],["4e42c8ec82c99798ccf3a610be870e78338c7f713348bd34c8203ef4037f3502","7571d74ee5e0fb92a7a8b33a07783341a5492144cc54bcc40a94473693606437"],["3775ab7089bc6af823aba2e1af70b236d251cadb0c86743287522a1b3b0dedea","be52d107bcfa09d8bcb9736a828cfa7fac8db17bf7a76a2c42ad961409018cf7"],["cee31cbf7e34ec379d94fb814d3d775ad954595d1314ba8846959e3e82f74e26","8fd64a14c06b589c26b947ae2bcf6bfa0149ef0be14ed4d80f448a01c43b1c6d"],["b4f9eaea09b6917619f6ea6a4eb5464efddb58fd45b1ebefcdc1a01d08b47986","39e5c9925b5a54b07433a4f18c61726f8bb131c012ca542eb24a8ac07200682a"],["d4263dfc3d2df923a0179a48966d30ce84e2515afc3dccc1b77907792ebcc60e","62dfaf07a0f78feb30e30d6295853ce189e127760ad6cf7fae164e122a208d54"],["48457524820fa65a4f8d35eb6930857c0032acc0a4a2de422233eeda897612c4","25a748ab367979d98733c38a1fa1c2e7dc6cc07db2d60a9ae7a76aaa49bd0f77"],["dfeeef1881101f2cb11644f3a2afdfc2045e19919152923f367a1767c11cceda","ecfb7056cf1de042f9420bab396793c0c390bde74b4bbdff16a83ae09a9a7517"],["6d7ef6b17543f8373c573f44e1f389835d89bcbc6062ced36c82df83b8fae859","cd450ec335438986dfefa10c57fea9bcc521a0959b2d80bbf74b190dca712d10"],["e75605d59102a5a2684500d3b991f2e3f3c88b93225547035af25af66e04541f","f5c54754a8f71ee540b9b48728473e314f729ac5308b06938360990e2bfad125"],["eb98660f4c4dfaa06a2be453d5020bc99a0c2e60abe388457dd43fefb1ed620c","6cb9a8876d9cb8520609af3add26cd20a0a7cd8a9411131ce85f44100099223e"],["13e87b027d8514d35939f2e6892b19922154596941888336dc3563e3b8dba942","fef5a3c68059a6dec5d624114bf1e91aac2b9da568d6abeb2570d55646b8adf1"],["ee163026e9fd6fe017c38f06a5be6fc125424b371ce2708e7bf4491691e5764a","1acb250f255dd61c43d94ccc670d0f58f49ae3fa15b96623e5430da0ad6c62b2"],["b268f5ef9ad51e4d78de3a750c2dc89b1e626d43505867999932e5db33af3d80","5f310d4b3c99b9ebb19f77d41c1dee018cf0d34fd4191614003e945a1216e423"],["ff07f3118a9df035e9fad85eb6c7bfe42b02f01ca99ceea3bf7ffdba93c4750d","438136d603e858a3a5c440c38eccbaddc1d2942114e2eddd4740d098ced1f0d8"],["8d8b9855c7c052a34146fd20ffb658bea4b9f69e0d825ebec16e8c3ce2b526a1","cdb559eedc2d79f926baf44fb84ea4d44bcf50fee51d7ceb30e2e7f463036758"],["52db0b5384dfbf05bfa9d472d7ae26dfe4b851ceca91b1eba54263180da32b63","c3b997d050ee5d423ebaf66a6db9f57b3180c902875679de924b69d84a7b375"],["e62f9490d3d51da6395efd24e80919cc7d0f29c3f3fa48c6fff543becbd43352","6d89ad7ba4876b0b22c2ca280c682862f342c8591f1daf5170e07bfd9ccafa7d"],["7f30ea2476b399b4957509c88f77d0191afa2ff5cb7b14fd6d8e7d65aaab1193","ca5ef7d4b231c94c3b15389a5f6311e9daff7bb67b103e9880ef4bff637acaec"],["5098ff1e1d9f14fb46a210fada6c903fef0fb7b4a1dd1d9ac60a0361800b7a00","9731141d81fc8f8084d37c6e7542006b3ee1b40d60dfe5362a5b132fd17ddc0"],["32b78c7de9ee512a72895be6b9cbefa6e2f3c4ccce445c96b9f2c81e2778ad58","ee1849f513df71e32efc3896ee28260c73bb80547ae2275ba497237794c8753c"],["e2cb74fddc8e9fbcd076eef2a7c72b0ce37d50f08269dfc074b581550547a4f7","d3aa2ed71c9dd2247a62df062736eb0baddea9e36122d2be8641abcb005cc4a4"],["8438447566d4d7bedadc299496ab357426009a35f235cb141be0d99cd10ae3a8","c4e1020916980a4da5d01ac5e6ad330734ef0d7906631c4f2390426b2edd791f"],["4162d488b89402039b584c6fc6c308870587d9c46f660b878ab65c82c711d67e","67163e903236289f776f22c25fb8a3afc1732f2b84b4e95dbda47ae5a0852649"],["3fad3fa84caf0f34f0f89bfd2dcf54fc175d767aec3e50684f3ba4a4bf5f683d","cd1bc7cb6cc407bb2f0ca647c718a730cf71872e7d0d2a53fa20efcdfe61826"],["674f2600a3007a00568c1a7ce05d0816c1fb84bf1370798f1c69532faeb1a86b","299d21f9413f33b3edf43b257004580b70db57da0b182259e09eecc69e0d38a5"],["d32f4da54ade74abb81b815ad1fb3b263d82d6c692714bcff87d29bd5ee9f08f","f9429e738b8e53b968e99016c059707782e14f4535359d582fc416910b3eea87"],["30e4e670435385556e593657135845d36fbb6931f72b08cb1ed954f1e3ce3ff6","462f9bce619898638499350113bbc9b10a878d35da70740dc695a559eb88db7b"],["be2062003c51cc3004682904330e4dee7f3dcd10b01e580bf1971b04d4cad297","62188bc49d61e5428573d48a74e1c655b1c61090905682a0d5558ed72dccb9bc"],["93144423ace3451ed29e0fb9ac2af211cb6e84a601df5993c419859fff5df04a","7c10dfb164c3425f5c71a3f9d7992038f1065224f72bb9d1d902a6d13037b47c"],["b015f8044f5fcbdcf21ca26d6c34fb8197829205c7b7d2a7cb66418c157b112c","ab8c1e086d04e813744a655b2df8d5f83b3cdc6faa3088c1d3aea1454e3a1d5f"],["d5e9e1da649d97d89e4868117a465a3a4f8a18de57a140d36b3f2af341a21b52","4cb04437f391ed73111a13cc1d4dd0db1693465c2240480d8955e8592f27447a"],["d3ae41047dd7ca065dbf8ed77b992439983005cd72e16d6f996a5316d36966bb","bd1aeb21ad22ebb22a10f0303417c6d964f8cdd7df0aca614b10dc14d125ac46"],["463e2763d885f958fc66cdd22800f0a487197d0a82e377b49f80af87c897b065","bfefacdb0e5d0fd7df3a311a94de062b26b80c61fbc97508b79992671ef7ca7f"],["7985fdfd127c0567c6f53ec1bb63ec3158e597c40bfe747c83cddfc910641917","603c12daf3d9862ef2b25fe1de289aed24ed291e0ec6708703a5bd567f32ed03"],["74a1ad6b5f76e39db2dd249410eac7f99e74c59cb83d2d0ed5ff1543da7703e9","cc6157ef18c9c63cd6193d83631bbea0093e0968942e8c33d5737fd790e0db08"],["30682a50703375f602d416664ba19b7fc9bab42c72747463a71d0896b22f6da3","553e04f6b018b4fa6c8f39e7f311d3176290d0e0f19ca73f17714d9977a22ff8"],["9e2158f0d7c0d5f26c3791efefa79597654e7a2b2464f52b1ee6c1347769ef57","712fcdd1b9053f09003a3481fa7762e9ffd7c8ef35a38509e2fbf2629008373"],["176e26989a43c9cfeba4029c202538c28172e566e3c4fce7322857f3be327d66","ed8cc9d04b29eb877d270b4878dc43c19aefd31f4eee09ee7b47834c1fa4b1c3"],["75d46efea3771e6e68abb89a13ad747ecf1892393dfc4f1b7004788c50374da8","9852390a99507679fd0b86fd2b39a868d7efc22151346e1a3ca4726586a6bed8"],["809a20c67d64900ffb698c4c825f6d5f2310fb0451c869345b7319f645605721","9e994980d9917e22b76b061927fa04143d096ccc54963e6a5ebfa5f3f8e286c1"],["1b38903a43f7f114ed4500b4eac7083fdefece1cf29c63528d563446f972c180","4036edc931a60ae889353f77fd53de4a2708b26b6f5da72ad3394119daf408f9"]]}}),secp256k1$1}var hasRequiredCurves;function requireCurves(){return hasRequiredCurves||(hasRequiredCurves=1,function(n){var r=n,_=requireHash(),E=requireCurve(),S=requireUtils$1(),C=S.assert;function A(O){O.type==="short"?this.curve=new E.short(O):O.type==="edwards"?this.curve=new E.edwards(O):this.curve=new E.mont(O),this.g=this.curve.g,this.n=this.curve.n,this.hash=O.hash,C(this.g.validate(),"Invalid curve"),C(this.g.mul(this.n).isInfinity(),"Invalid curve, G*N != O")}r.PresetCurve=A;function I(O,N){Object.defineProperty(r,O,{configurable:!0,enumerable:!0,get:function(){var U=new A(N);return Object.defineProperty(r,O,{configurable:!0,enumerable:!0,value:U}),U}})}I("p192",{type:"short",prime:"p192",p:"ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff",a:"ffffffff ffffffff ffffffff fffffffe ffffffff fffffffc",b:"64210519 e59c80e7 0fa7e9ab 72243049 feb8deec c146b9b1",n:"ffffffff ffffffff ffffffff 99def836 146bc9b1 b4d22831",hash:_.sha256,gRed:!1,g:["188da80e b03090f6 7cbf20eb 43a18800 f4ff0afd 82ff1012","07192b95 ffc8da78 631011ed 6b24cdd5 73f977a1 1e794811"]}),I("p224",{type:"short",prime:"p224",p:"ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001",a:"ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff fffffffe",b:"b4050a85 0c04b3ab f5413256 5044b0b7 d7bfd8ba 270b3943 2355ffb4",n:"ffffffff ffffffff ffffffff ffff16a2 e0b8f03e 13dd2945 5c5c2a3d",hash:_.sha256,gRed:!1,g:["b70e0cbd 6bb4bf7f 321390b9 4a03c1d3 56c21122 343280d6 115c1d21","bd376388 b5f723fb 4c22dfe6 cd4375a0 5a074764 44d58199 85007e34"]}),I("p256",{type:"short",prime:null,p:"ffffffff 00000001 00000000 00000000 00000000 ffffffff ffffffff ffffffff",a:"ffffffff 00000001 00000000 00000000 00000000 ffffffff ffffffff fffffffc",b:"5ac635d8 aa3a93e7 b3ebbd55 769886bc 651d06b0 cc53b0f6 3bce3c3e 27d2604b",n:"ffffffff 00000000 ffffffff ffffffff bce6faad a7179e84 f3b9cac2 fc632551",hash:_.sha256,gRed:!1,g:["6b17d1f2 e12c4247 f8bce6e5 63a440f2 77037d81 2deb33a0 f4a13945 d898c296","4fe342e2 fe1a7f9b 8ee7eb4a 7c0f9e16 2bce3357 6b315ece cbb64068 37bf51f5"]}),I("p384",{type:"short",prime:null,p:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe ffffffff 00000000 00000000 ffffffff",a:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe ffffffff 00000000 00000000 fffffffc",b:"b3312fa7 e23ee7e4 988e056b e3f82d19 181d9c6e fe814112 0314088f 5013875a c656398d 8a2ed19d 2a85c8ed d3ec2aef",n:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff c7634d81 f4372ddf 581a0db2 48b0a77a ecec196a ccc52973",hash:_.sha384,gRed:!1,g:["aa87ca22 be8b0537 8eb1c71e f320ad74 6e1d3b62 8ba79b98 59f741e0 82542a38 5502f25d bf55296c 3a545e38 72760ab7","3617de4a 96262c6f 5d9e98bf 9292dc29 f8f41dbd 289a147c e9da3113 b5f0b8c0 0a60b1ce 1d7e819d 7a431d7c 90ea0e5f"]}),I("p521",{type:"short",prime:null,p:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff",a:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffc",b:"00000051 953eb961 8e1c9a1f 929a21a0 b68540ee a2da725b 99b315f3 b8b48991 8ef109e1 56193951 ec7e937b 1652c0bd 3bb1bf07 3573df88 3d2c34f1 ef451fd4 6b503f00",n:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffa 51868783 bf2f966b 7fcc0148 f709a5d0 3bb5c9b8 899c47ae bb6fb71e 91386409",hash:_.sha512,gRed:!1,g:["000000c6 858e06b7 0404e9cd 9e3ecb66 2395b442 9c648139 053fb521 f828af60 6b4d3dba a14b5e77 efe75928 fe1dc127 a2ffa8de 3348b3c1 856a429b f97e7e31 c2e5bd66","00000118 39296a78 9a3bc004 5c8a5fb4 2c7d1bd9 98f54449 579b4468 17afbd17 273e662c 97ee7299 5ef42640 c550b901 3fad0761 353c7086 a272c240 88be9476 9fd16650"]}),I("curve25519",{type:"mont",prime:"p25519",p:"7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed",a:"76d06",b:"1",n:"1000000000000000 0000000000000000 14def9dea2f79cd6 5812631a5cf5d3ed",hash:_.sha256,gRed:!1,g:["9"]}),I("ed25519",{type:"edwards",prime:"p25519",p:"7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed",a:"-1",c:"1",d:"52036cee2b6ffe73 8cc740797779e898 00700a4d4141d8ab 75eb4dca135978a3",n:"1000000000000000 0000000000000000 14def9dea2f79cd6 5812631a5cf5d3ed",hash:_.sha256,gRed:!1,g:["216936d3cd6e53fec0a4e231fdd6dc5c692cc7609525a7b2c9562d608f25d51a","6666666666666666666666666666666666666666666666666666666666666658"]});var B;try{B=requireSecp256k1()}catch{B=void 0}I("secp256k1",{type:"short",prime:"k256",p:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f",a:"0",b:"7",n:"ffffffff ffffffff ffffffff fffffffe baaedce6 af48a03b bfd25e8c d0364141",h:"1",hash:_.sha256,beta:"7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee",lambda:"5363ad4cc05c30e0a5261c028812645a122e22ea20816678df02967c1b23bd72",basis:[{a:"3086d221a7d46bcde86c90e49284eb15",b:"-e4437ed6010e88286f547fa90abfe4c3"},{a:"114ca50f7a8e2f3f657c1108d9d44cfd8",b:"3086d221a7d46bcde86c90e49284eb15"}],gRed:!1,g:["79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798","483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8",B]})}(curves)),curves}var hmacDrbg,hasRequiredHmacDrbg;function requireHmacDrbg(){if(hasRequiredHmacDrbg)return hmacDrbg;hasRequiredHmacDrbg=1;var n=requireHash(),r=requireUtils$2(),_=requireMinimalisticAssert();function E(S){if(!(this instanceof E))return new E(S);this.hash=S.hash,this.predResist=!!S.predResist,this.outLen=this.hash.outSize,this.minEntropy=S.minEntropy||this.hash.hmacStrength,this._reseed=null,this.reseedInterval=null,this.K=null,this.V=null;var C=r.toArray(S.entropy,S.entropyEnc||"hex"),A=r.toArray(S.nonce,S.nonceEnc||"hex"),I=r.toArray(S.pers,S.persEnc||"hex");_(C.length>=this.minEntropy/8,"Not enough entropy. Minimum is: "+this.minEntropy+" bits"),this._init(C,A,I)}return hmacDrbg=E,E.prototype._init=function(C,A,I){var B=C.concat(A).concat(I);this.K=new Array(this.outLen/8),this.V=new Array(this.outLen/8);for(var O=0;O<this.V.length;O++)this.K[O]=0,this.V[O]=1;this._update(B),this._reseed=1,this.reseedInterval=281474976710656},E.prototype._hmac=function(){return new n.hmac(this.hash,this.K)},E.prototype._update=function(C){var A=this._hmac().update(this.V).update([0]);C&&(A=A.update(C)),this.K=A.digest(),this.V=this._hmac().update(this.V).digest(),C&&(this.K=this._hmac().update(this.V).update([1]).update(C).digest(),this.V=this._hmac().update(this.V).digest())},E.prototype.reseed=function(C,A,I,B){typeof A!="string"&&(B=I,I=A,A=null),C=r.toArray(C,A),I=r.toArray(I,B),_(C.length>=this.minEntropy/8,"Not enough entropy. Minimum is: "+this.minEntropy+" bits"),this._update(C.concat(I||[])),this._reseed=1},E.prototype.generate=function(C,A,I,B){if(this._reseed>this.reseedInterval)throw new Error("Reseed is required");typeof A!="string"&&(B=I,I=A,A=null),I&&(I=r.toArray(I,B||"hex"),this._update(I));for(var O=[];O.length<C;)this.V=this._hmac().update(this.V).digest(),O=O.concat(this.V);var N=O.slice(0,C);return this._update(I),this._reseed++,r.encode(N,A)},hmacDrbg}var key$1,hasRequiredKey$1;function requireKey$1(){if(hasRequiredKey$1)return key$1;hasRequiredKey$1=1;var n=requireBn$1(),r=requireUtils$1(),_=r.assert;function E(S,C){this.ec=S,this.priv=null,this.pub=null,C.priv&&this._importPrivate(C.priv,C.privEnc),C.pub&&this._importPublic(C.pub,C.pubEnc)}return key$1=E,E.fromPublic=function(C,A,I){return A instanceof E?A:new E(C,{pub:A,pubEnc:I})},E.fromPrivate=function(C,A,I){return A instanceof E?A:new E(C,{priv:A,privEnc:I})},E.prototype.validate=function(){var C=this.getPublic();return C.isInfinity()?{result:!1,reason:"Invalid public key"}:C.validate()?C.mul(this.ec.curve.n).isInfinity()?{result:!0,reason:null}:{result:!1,reason:"Public key * N != O"}:{result:!1,reason:"Public key is not a point"}},E.prototype.getPublic=function(C,A){return typeof C=="string"&&(A=C,C=null),this.pub||(this.pub=this.ec.g.mul(this.priv)),A?this.pub.encode(A,C):this.pub},E.prototype.getPrivate=function(C){return C==="hex"?this.priv.toString(16,2):this.priv},E.prototype._importPrivate=function(C,A){this.priv=new n(C,A||16),this.priv=this.priv.umod(this.ec.curve.n)},E.prototype._importPublic=function(C,A){if(C.x||C.y){this.ec.curve.type==="mont"?_(C.x,"Need x coordinate"):(this.ec.curve.type==="short"||this.ec.curve.type==="edwards")&&_(C.x&&C.y,"Need both x and y coordinate"),this.pub=this.ec.curve.point(C.x,C.y);return}this.pub=this.ec.curve.decodePoint(C,A)},E.prototype.derive=function(C){return C.validate()||_(C.validate(),"public point not validated"),C.mul(this.priv).getX()},E.prototype.sign=function(C,A,I){return this.ec.sign(C,this,A,I)},E.prototype.verify=function(C,A){return this.ec.verify(C,A,this)},E.prototype.inspect=function(){return"<Key priv: "+(this.priv&&this.priv.toString(16,2))+" pub: "+(this.pub&&this.pub.inspect())+" >"},key$1}var signature$1,hasRequiredSignature$1;function requireSignature$1(){if(hasRequiredSignature$1)return signature$1;hasRequiredSignature$1=1;var n=requireBn$1(),r=requireUtils$1(),_=r.assert;function E(B,O){if(B instanceof E)return B;this._importDER(B,O)||(_(B.r&&B.s,"Signature without r or s"),this.r=new n(B.r,16),this.s=new n(B.s,16),B.recoveryParam===void 0?this.recoveryParam=null:this.recoveryParam=B.recoveryParam)}signature$1=E;function S(){this.place=0}function C(B,O){var N=B[O.place++];if(!(N&128))return N;var U=N&15;if(U===0||U>4)return!1;for(var j=0,z=0,Z=O.place;z<U;z++,Z++)j<<=8,j|=B[Z],j>>>=0;return j<=127?!1:(O.place=Z,j)}function A(B){for(var O=0,N=B.length-1;!B[O]&&!(B[O+1]&128)&&O<N;)O++;return O===0?B:B.slice(O)}E.prototype._importDER=function(O,N){O=r.toArray(O,N);var U=new S;if(O[U.place++]!==48)return!1;var j=C(O,U);if(j===!1||j+U.place!==O.length||O[U.place++]!==2)return!1;var z=C(O,U);if(z===!1)return!1;var Z=O.slice(U.place,z+U.place);if(U.place+=z,O[U.place++]!==2)return!1;var X=C(O,U);if(X===!1||O.length!==X+U.place)return!1;var Q=O.slice(U.place,X+U.place);if(Z[0]===0)if(Z[1]&128)Z=Z.slice(1);else return!1;if(Q[0]===0)if(Q[1]&128)Q=Q.slice(1);else return!1;return this.r=new n(Z),this.s=new n(Q),this.recoveryParam=null,!0};function I(B,O){if(O<128){B.push(O);return}var N=1+(Math.log(O)/Math.LN2>>>3);for(B.push(N|128);--N;)B.push(O>>>(N<<3)&255);B.push(O)}return E.prototype.toDER=function(O){var N=this.r.toArray(),U=this.s.toArray();for(N[0]&128&&(N=[0].concat(N)),U[0]&128&&(U=[0].concat(U)),N=A(N),U=A(U);!U[0]&&!(U[1]&128);)U=U.slice(1);var j=[2];I(j,N.length),j=j.concat(N),j.push(2),I(j,U.length);var z=j.concat(U),Z=[48];return I(Z,z.length),Z=Z.concat(z),r.encode(Z,O)},signature$1}var ec,hasRequiredEc;function requireEc(){if(hasRequiredEc)return ec;hasRequiredEc=1;var n=requireBn$1(),r=requireHmacDrbg(),_=requireUtils$1(),E=requireCurves(),S=requireBrorand(),C=_.assert,A=requireKey$1(),I=requireSignature$1();function B(O){if(!(this instanceof B))return new B(O);typeof O=="string"&&(C(Object.prototype.hasOwnProperty.call(E,O),"Unknown curve "+O),O=E[O]),O instanceof E.PresetCurve&&(O={curve:O}),this.curve=O.curve.curve,this.n=this.curve.n,this.nh=this.n.ushrn(1),this.g=this.curve.g,this.g=O.curve.g,this.g.precompute(O.curve.n.bitLength()+1),this.hash=O.hash||O.curve.hash}return ec=B,B.prototype.keyPair=function(N){return new A(this,N)},B.prototype.keyFromPrivate=function(N,U){return A.fromPrivate(this,N,U)},B.prototype.keyFromPublic=function(N,U){return A.fromPublic(this,N,U)},B.prototype.genKeyPair=function(N){N||(N={});for(var U=new r({hash:this.hash,pers:N.pers,persEnc:N.persEnc||"utf8",entropy:N.entropy||S(this.hash.hmacStrength),entropyEnc:N.entropy&&N.entropyEnc||"utf8",nonce:this.n.toArray()}),j=this.n.byteLength(),z=this.n.sub(new n(2));;){var Z=new n(U.generate(j));if(!(Z.cmp(z)>0))return Z.iaddn(1),this.keyFromPrivate(Z)}},B.prototype._truncateToN=function(N,U){var j=N.byteLength()*8-this.n.bitLength();return j>0&&(N=N.ushrn(j)),!U&&N.cmp(this.n)>=0?N.sub(this.n):N},B.prototype.sign=function(N,U,j,z){typeof j=="object"&&(z=j,j=null),z||(z={}),U=this.keyFromPrivate(U,j),N=this._truncateToN(new n(N,16));for(var Z=this.n.byteLength(),X=U.getPrivate().toArray("be",Z),Q=N.toArray("be",Z),se=new r({hash:this.hash,entropy:X,nonce:Q,pers:z.pers,persEnc:z.persEnc||"utf8"}),oe=this.n.sub(new n(1)),ue=0;;ue++){var we=z.k?z.k(ue):new n(se.generate(this.n.byteLength()));if(we=this._truncateToN(we,!0),!(we.cmpn(1)<=0||we.cmp(oe)>=0)){var Te=this.g.mul(we);if(!Te.isInfinity()){var xe=Te.getX(),Re=xe.umod(this.n);if(Re.cmpn(0)!==0){var Ne=we.invm(this.n).mul(Re.mul(U.getPrivate()).iadd(N));if(Ne=Ne.umod(this.n),Ne.cmpn(0)!==0){var Fe=(Te.getY().isOdd()?1:0)|(xe.cmp(Re)!==0?2:0);return z.canonical&&Ne.cmp(this.nh)>0&&(Ne=this.n.sub(Ne),Fe^=1),new I({r:Re,s:Ne,recoveryParam:Fe})}}}}}},B.prototype.verify=function(N,U,j,z){N=this._truncateToN(new n(N,16)),j=this.keyFromPublic(j,z),U=new I(U,"hex");var Z=U.r,X=U.s;if(Z.cmpn(1)<0||Z.cmp(this.n)>=0||X.cmpn(1)<0||X.cmp(this.n)>=0)return!1;var Q=X.invm(this.n),se=Q.mul(N).umod(this.n),oe=Q.mul(Z).umod(this.n),ue;return this.curve._maxwellTrick?(ue=this.g.jmulAdd(se,j.getPublic(),oe),ue.isInfinity()?!1:ue.eqXToP(Z)):(ue=this.g.mulAdd(se,j.getPublic(),oe),ue.isInfinity()?!1:ue.getX().umod(this.n).cmp(Z)===0)},B.prototype.recoverPubKey=function(O,N,U,j){C((3&U)===U,"The recovery param is more than two bits"),N=new I(N,j);var z=this.n,Z=new n(O),X=N.r,Q=N.s,se=U&1,oe=U>>1;if(X.cmp(this.curve.p.umod(this.curve.n))>=0&&oe)throw new Error("Unable to find sencond key candinate");oe?X=this.curve.pointFromX(X.add(this.curve.n),se):X=this.curve.pointFromX(X,se);var ue=N.r.invm(z),we=z.sub(Z).mul(ue).umod(z),Te=Q.mul(ue).umod(z);return this.g.mulAdd(we,X,Te)},B.prototype.getKeyRecoveryParam=function(O,N,U,j){if(N=new I(N,j),N.recoveryParam!==null)return N.recoveryParam;for(var z=0;z<4;z++){var Z;try{Z=this.recoverPubKey(O,N,z)}catch{continue}if(Z.eq(U))return z}throw new Error("Unable to find valid recovery factor")},ec}var key,hasRequiredKey;function requireKey(){if(hasRequiredKey)return key;hasRequiredKey=1;var n=requireUtils$1(),r=n.assert,_=n.parseBytes,E=n.cachedProperty;function S(C,A){this.eddsa=C,this._secret=_(A.secret),C.isPoint(A.pub)?this._pub=A.pub:this._pubBytes=_(A.pub)}return S.fromPublic=function(A,I){return I instanceof S?I:new S(A,{pub:I})},S.fromSecret=function(A,I){return I instanceof S?I:new S(A,{secret:I})},S.prototype.secret=function(){return this._secret},E(S,"pubBytes",function(){return this.eddsa.encodePoint(this.pub())}),E(S,"pub",function(){return this._pubBytes?this.eddsa.decodePoint(this._pubBytes):this.eddsa.g.mul(this.priv())}),E(S,"privBytes",function(){var A=this.eddsa,I=this.hash(),B=A.encodingLength-1,O=I.slice(0,A.encodingLength);return O[0]&=248,O[B]&=127,O[B]|=64,O}),E(S,"priv",function(){return this.eddsa.decodeInt(this.privBytes())}),E(S,"hash",function(){return this.eddsa.hash().update(this.secret()).digest()}),E(S,"messagePrefix",function(){return this.hash().slice(this.eddsa.encodingLength)}),S.prototype.sign=function(A){return r(this._secret,"KeyPair can only verify"),this.eddsa.sign(A,this)},S.prototype.verify=function(A,I){return this.eddsa.verify(A,I,this)},S.prototype.getSecret=function(A){return r(this._secret,"KeyPair is public only"),n.encode(this.secret(),A)},S.prototype.getPublic=function(A){return n.encode(this.pubBytes(),A)},key=S,key}var signature,hasRequiredSignature;function requireSignature(){if(hasRequiredSignature)return signature;hasRequiredSignature=1;var n=requireBn$1(),r=requireUtils$1(),_=r.assert,E=r.cachedProperty,S=r.parseBytes;function C(A,I){this.eddsa=A,typeof I!="object"&&(I=S(I)),Array.isArray(I)&&(I={R:I.slice(0,A.encodingLength),S:I.slice(A.encodingLength)}),_(I.R&&I.S,"Signature without R or S"),A.isPoint(I.R)&&(this._R=I.R),I.S instanceof n&&(this._S=I.S),this._Rencoded=Array.isArray(I.R)?I.R:I.Rencoded,this._Sencoded=Array.isArray(I.S)?I.S:I.Sencoded}return E(C,"S",function(){return this.eddsa.decodeInt(this.Sencoded())}),E(C,"R",function(){return this.eddsa.decodePoint(this.Rencoded())}),E(C,"Rencoded",function(){return this.eddsa.encodePoint(this.R())}),E(C,"Sencoded",function(){return this.eddsa.encodeInt(this.S())}),C.prototype.toBytes=function(){return this.Rencoded().concat(this.Sencoded())},C.prototype.toHex=function(){return r.encode(this.toBytes(),"hex").toUpperCase()},signature=C,signature}var eddsa,hasRequiredEddsa;function requireEddsa(){if(hasRequiredEddsa)return eddsa;hasRequiredEddsa=1;var n=requireHash(),r=requireCurves(),_=requireUtils$1(),E=_.assert,S=_.parseBytes,C=requireKey(),A=requireSignature();function I(B){if(E(B==="ed25519","only tested with ed25519 so far"),!(this instanceof I))return new I(B);B=r[B].curve,this.curve=B,this.g=B.g,this.g.precompute(B.n.bitLength()+1),this.pointClass=B.point().constructor,this.encodingLength=Math.ceil(B.n.bitLength()/8),this.hash=n.sha512}return eddsa=I,I.prototype.sign=function(O,N){O=S(O);var U=this.keyFromSecret(N),j=this.hashInt(U.messagePrefix(),O),z=this.g.mul(j),Z=this.encodePoint(z),X=this.hashInt(Z,U.pubBytes(),O).mul(U.priv()),Q=j.add(X).umod(this.curve.n);return this.makeSignature({R:z,S:Q,Rencoded:Z})},I.prototype.verify=function(O,N,U){O=S(O),N=this.makeSignature(N);var j=this.keyFromPublic(U),z=this.hashInt(N.Rencoded(),j.pubBytes(),O),Z=this.g.mul(N.S()),X=N.R().add(j.pub().mul(z));return X.eq(Z)},I.prototype.hashInt=function(){for(var O=this.hash(),N=0;N<arguments.length;N++)O.update(arguments[N]);return _.intFromLE(O.digest()).umod(this.curve.n)},I.prototype.keyFromPublic=function(O){return C.fromPublic(this,O)},I.prototype.keyFromSecret=function(O){return C.fromSecret(this,O)},I.prototype.makeSignature=function(O){return O instanceof A?O:new A(this,O)},I.prototype.encodePoint=function(O){var N=O.getY().toArray("le",this.encodingLength);return N[this.encodingLength-1]|=O.getX().isOdd()?128:0,N},I.prototype.decodePoint=function(O){O=_.parseBytes(O);var N=O.length-1,U=O.slice(0,N).concat(O[N]&-129),j=(O[N]&128)!==0,z=_.intFromLE(U);return this.curve.pointFromY(z,j)},I.prototype.encodeInt=function(O){return O.toArray("le",this.encodingLength)},I.prototype.decodeInt=function(O){return _.intFromLE(O)},I.prototype.isPoint=function(O){return O instanceof this.pointClass},eddsa}var hasRequiredElliptic;function requireElliptic(){return hasRequiredElliptic||(hasRequiredElliptic=1,function(n){var r=n;r.version=require$$0.version,r.utils=requireUtils$1(),r.rand=requireBrorand(),r.curve=requireCurve(),r.curves=requireCurves(),r.ec=requireEc(),r.eddsa=requireEddsa()}(elliptic)),elliptic}var asn1$3={},asn1$2={},api={},hasRequiredApi;function requireApi(){return hasRequiredApi||(hasRequiredApi=1,function(n){var r=requireAsn1$1(),_=inherits_browserExports,E=n;E.define=function(A,I){return new S(A,I)};function S(C,A){this.name=C,this.body=A,this.decoders={},this.encoders={}}S.prototype._createNamed=function(A){var I;try{I=require$$1$2.runInThisContext("(function "+this.name+`(entity) {
  this._initNamed(entity);
})`)}catch{I=function(O){this._initNamed(O)}}return _(I,A),I.prototype._initNamed=function(O){A.call(this,O)},new I(this)},S.prototype._getDecoder=function(A){return A=A||"der",this.decoders.hasOwnProperty(A)||(this.decoders[A]=this._createNamed(r.decoders[A])),this.decoders[A]},S.prototype.decode=function(A,I,B){return this._getDecoder(I).decode(A,B)},S.prototype._getEncoder=function(A){return A=A||"der",this.encoders.hasOwnProperty(A)||(this.encoders[A]=this._createNamed(r.encoders[A])),this.encoders[A]},S.prototype.encode=function(A,I,B){return this._getEncoder(I).encode(A,B)}}(api)),api}var base$3={},reporter={},hasRequiredReporter;function requireReporter(){if(hasRequiredReporter)return reporter;hasRequiredReporter=1;var n=inherits_browserExports;function r(E){this._reporterState={obj:null,path:[],options:E||{},errors:[]}}reporter.Reporter=r,r.prototype.isError=function(S){return S instanceof _},r.prototype.save=function(){var S=this._reporterState;return{obj:S.obj,pathLen:S.path.length}},r.prototype.restore=function(S){var C=this._reporterState;C.obj=S.obj,C.path=C.path.slice(0,S.pathLen)},r.prototype.enterKey=function(S){return this._reporterState.path.push(S)},r.prototype.exitKey=function(S){var C=this._reporterState;C.path=C.path.slice(0,S-1)},r.prototype.leaveKey=function(S,C,A){var I=this._reporterState;this.exitKey(S),I.obj!==null&&(I.obj[C]=A)},r.prototype.path=function(){return this._reporterState.path.join("/")},r.prototype.enterObject=function(){var S=this._reporterState,C=S.obj;return S.obj={},C},r.prototype.leaveObject=function(S){var C=this._reporterState,A=C.obj;return C.obj=S,A},r.prototype.error=function(S){var C,A=this._reporterState,I=S instanceof _;if(I?C=S:C=new _(A.path.map(function(B){return"["+JSON.stringify(B)+"]"}).join(""),S.message||S,S.stack),!A.options.partial)throw C;return I||A.errors.push(C),C},r.prototype.wrapResult=function(S){var C=this._reporterState;return C.options.partial?{result:this.isError(S)?null:S,errors:C.errors}:S};function _(E,S){this.path=E,this.rethrow(S)}return n(_,Error),_.prototype.rethrow=function(S){if(this.message=S+" at: "+(this.path||"(shallow)"),Error.captureStackTrace&&Error.captureStackTrace(this,_),!this.stack)try{throw new Error(this.message)}catch(C){this.stack=C.stack}return this},reporter}var buffer={},hasRequiredBuffer;function requireBuffer(){if(hasRequiredBuffer)return buffer;hasRequiredBuffer=1;var n=inherits_browserExports,r=requireBase().Reporter,_=buffer$2.Buffer;function E(C,A){if(r.call(this,A),!_.isBuffer(C)){this.error("Input not Buffer");return}this.base=C,this.offset=0,this.length=C.length}n(E,r),buffer.DecoderBuffer=E,E.prototype.save=function(){return{offset:this.offset,reporter:r.prototype.save.call(this)}},E.prototype.restore=function(A){var I=new E(this.base);return I.offset=A.offset,I.length=this.offset,this.offset=A.offset,r.prototype.restore.call(this,A.reporter),I},E.prototype.isEmpty=function(){return this.offset===this.length},E.prototype.readUInt8=function(A){return this.offset+1<=this.length?this.base.readUInt8(this.offset++,!0):this.error(A||"DecoderBuffer overrun")},E.prototype.skip=function(A,I){if(!(this.offset+A<=this.length))return this.error(I||"DecoderBuffer overrun");var B=new E(this.base);return B._reporterState=this._reporterState,B.offset=this.offset,B.length=this.offset+A,this.offset+=A,B},E.prototype.raw=function(A){return this.base.slice(A?A.offset:this.offset,this.length)};function S(C,A){if(Array.isArray(C))this.length=0,this.value=C.map(function(I){return I instanceof S||(I=new S(I,A)),this.length+=I.length,I},this);else if(typeof C=="number"){if(!(0<=C&&C<=255))return A.error("non-byte EncoderBuffer value");this.value=C,this.length=1}else if(typeof C=="string")this.value=C,this.length=_.byteLength(C);else if(_.isBuffer(C))this.value=C,this.length=C.length;else return A.error("Unsupported type: "+typeof C)}return buffer.EncoderBuffer=S,S.prototype.join=function(A,I){return A||(A=new _(this.length)),I||(I=0),this.length===0||(Array.isArray(this.value)?this.value.forEach(function(B){B.join(A,I),I+=B.length}):(typeof this.value=="number"?A[I]=this.value:typeof this.value=="string"?A.write(this.value,I):_.isBuffer(this.value)&&this.value.copy(A,I),I+=this.length)),A},buffer}var node,hasRequiredNode;function requireNode(){if(hasRequiredNode)return node;hasRequiredNode=1;var n=requireBase().Reporter,r=requireBase().EncoderBuffer,_=requireBase().DecoderBuffer,E=requireMinimalisticAssert(),S=["seq","seqof","set","setof","objid","bool","gentime","utctime","null_","enum","int","objDesc","bitstr","bmpstr","charstr","genstr","graphstr","ia5str","iso646str","numstr","octstr","printstr","t61str","unistr","utf8str","videostr"],C=["key","obj","use","optional","explicit","implicit","def","choice","any","contains"].concat(S),A=["_peekTag","_decodeTag","_use","_decodeStr","_decodeObjid","_decodeTime","_decodeNull","_decodeInt","_decodeBool","_decodeList","_encodeComposite","_encodeStr","_encodeObjid","_encodeTime","_encodeNull","_encodeInt","_encodeBool"];function I(O,N){var U={};this._baseState=U,U.enc=O,U.parent=N||null,U.children=null,U.tag=null,U.args=null,U.reverseArgs=null,U.choice=null,U.optional=!1,U.any=!1,U.obj=!1,U.use=null,U.useDecoder=null,U.key=null,U.default=null,U.explicit=null,U.implicit=null,U.contains=null,U.parent||(U.children=[],this._wrap())}node=I;var B=["enc","parent","children","tag","args","reverseArgs","choice","optional","any","obj","use","alteredUse","key","default","explicit","implicit","contains"];return I.prototype.clone=function(){var N=this._baseState,U={};B.forEach(function(z){U[z]=N[z]});var j=new this.constructor(U.parent);return j._baseState=U,j},I.prototype._wrap=function(){var N=this._baseState;C.forEach(function(U){this[U]=function(){var z=new this.constructor(this);return N.children.push(z),z[U].apply(z,arguments)}},this)},I.prototype._init=function(N){var U=this._baseState;E(U.parent===null),N.call(this),U.children=U.children.filter(function(j){return j._baseState.parent===this},this),E.equal(U.children.length,1,"Root node can have only one child")},I.prototype._useArgs=function(N){var U=this._baseState,j=N.filter(function(z){return z instanceof this.constructor},this);N=N.filter(function(z){return!(z instanceof this.constructor)},this),j.length!==0&&(E(U.children===null),U.children=j,j.forEach(function(z){z._baseState.parent=this},this)),N.length!==0&&(E(U.args===null),U.args=N,U.reverseArgs=N.map(function(z){if(typeof z!="object"||z.constructor!==Object)return z;var Z={};return Object.keys(z).forEach(function(X){X==(X|0)&&(X|=0);var Q=z[X];Z[Q]=X}),Z}))},A.forEach(function(O){I.prototype[O]=function(){var U=this._baseState;throw new Error(O+" not implemented for encoding: "+U.enc)}}),S.forEach(function(O){I.prototype[O]=function(){var U=this._baseState,j=Array.prototype.slice.call(arguments);return E(U.tag===null),U.tag=O,this._useArgs(j),this}}),I.prototype.use=function(N){E(N);var U=this._baseState;return E(U.use===null),U.use=N,this},I.prototype.optional=function(){var N=this._baseState;return N.optional=!0,this},I.prototype.def=function(N){var U=this._baseState;return E(U.default===null),U.default=N,U.optional=!0,this},I.prototype.explicit=function(N){var U=this._baseState;return E(U.explicit===null&&U.implicit===null),U.explicit=N,this},I.prototype.implicit=function(N){var U=this._baseState;return E(U.explicit===null&&U.implicit===null),U.implicit=N,this},I.prototype.obj=function(){var N=this._baseState,U=Array.prototype.slice.call(arguments);return N.obj=!0,U.length!==0&&this._useArgs(U),this},I.prototype.key=function(N){var U=this._baseState;return E(U.key===null),U.key=N,this},I.prototype.any=function(){var N=this._baseState;return N.any=!0,this},I.prototype.choice=function(N){var U=this._baseState;return E(U.choice===null),U.choice=N,this._useArgs(Object.keys(N).map(function(j){return N[j]})),this},I.prototype.contains=function(N){var U=this._baseState;return E(U.use===null),U.contains=N,this},I.prototype._decode=function(N,U){var j=this._baseState;if(j.parent===null)return N.wrapResult(j.children[0]._decode(N,U));var z=j.default,Z=!0,X=null;if(j.key!==null&&(X=N.enterKey(j.key)),j.optional){var Q=null;if(j.explicit!==null?Q=j.explicit:j.implicit!==null?Q=j.implicit:j.tag!==null&&(Q=j.tag),Q===null&&!j.any){var se=N.save();try{j.choice===null?this._decodeGeneric(j.tag,N,U):this._decodeChoice(N,U),Z=!0}catch{Z=!1}N.restore(se)}else if(Z=this._peekTag(N,Q,j.any),N.isError(Z))return Z}var oe;if(j.obj&&Z&&(oe=N.enterObject()),Z){if(j.explicit!==null){var ue=this._decodeTag(N,j.explicit);if(N.isError(ue))return ue;N=ue}var we=N.offset;if(j.use===null&&j.choice===null){if(j.any)var se=N.save();var Te=this._decodeTag(N,j.implicit!==null?j.implicit:j.tag,j.any);if(N.isError(Te))return Te;j.any?z=N.raw(se):N=Te}if(U&&U.track&&j.tag!==null&&U.track(N.path(),we,N.length,"tagged"),U&&U.track&&j.tag!==null&&U.track(N.path(),N.offset,N.length,"content"),j.any?z=z:j.choice===null?z=this._decodeGeneric(j.tag,N,U):z=this._decodeChoice(N,U),N.isError(z))return z;if(!j.any&&j.choice===null&&j.children!==null&&j.children.forEach(function(Ne){Ne._decode(N,U)}),j.contains&&(j.tag==="octstr"||j.tag==="bitstr")){var xe=new _(z);z=this._getUse(j.contains,N._reporterState.obj)._decode(xe,U)}}return j.obj&&Z&&(z=N.leaveObject(oe)),j.key!==null&&(z!==null||Z===!0)?N.leaveKey(X,j.key,z):X!==null&&N.exitKey(X),z},I.prototype._decodeGeneric=function(N,U,j){var z=this._baseState;return N==="seq"||N==="set"?null:N==="seqof"||N==="setof"?this._decodeList(U,N,z.args[0],j):/str$/.test(N)?this._decodeStr(U,N,j):N==="objid"&&z.args?this._decodeObjid(U,z.args[0],z.args[1],j):N==="objid"?this._decodeObjid(U,null,null,j):N==="gentime"||N==="utctime"?this._decodeTime(U,N,j):N==="null_"?this._decodeNull(U,j):N==="bool"?this._decodeBool(U,j):N==="objDesc"?this._decodeStr(U,N,j):N==="int"||N==="enum"?this._decodeInt(U,z.args&&z.args[0],j):z.use!==null?this._getUse(z.use,U._reporterState.obj)._decode(U,j):U.error("unknown tag: "+N)},I.prototype._getUse=function(N,U){var j=this._baseState;return j.useDecoder=this._use(N,U),E(j.useDecoder._baseState.parent===null),j.useDecoder=j.useDecoder._baseState.children[0],j.implicit!==j.useDecoder._baseState.implicit&&(j.useDecoder=j.useDecoder.clone(),j.useDecoder._baseState.implicit=j.implicit),j.useDecoder},I.prototype._decodeChoice=function(N,U){var j=this._baseState,z=null,Z=!1;return Object.keys(j.choice).some(function(X){var Q=N.save(),se=j.choice[X];try{var oe=se._decode(N,U);if(N.isError(oe))return!1;z={type:X,value:oe},Z=!0}catch{return N.restore(Q),!1}return!0},this),Z?z:N.error("Choice not matched")},I.prototype._createEncoderBuffer=function(N){return new r(N,this.reporter)},I.prototype._encode=function(N,U,j){var z=this._baseState;if(!(z.default!==null&&z.default===N)){var Z=this._encodeValue(N,U,j);if(Z!==void 0&&!this._skipDefault(Z,U,j))return Z}},I.prototype._encodeValue=function(N,U,j){var z=this._baseState;if(z.parent===null)return z.children[0]._encode(N,U||new n);var se=null;if(this.reporter=U,z.optional&&N===void 0)if(z.default!==null)N=z.default;else return;var Z=null,X=!1;if(z.any)se=this._createEncoderBuffer(N);else if(z.choice)se=this._encodeChoice(N,U);else if(z.contains)Z=this._getUse(z.contains,j)._encode(N,U),X=!0;else if(z.children)Z=z.children.map(function(we){if(we._baseState.tag==="null_")return we._encode(null,U,N);if(we._baseState.key===null)return U.error("Child should have a key");var Te=U.enterKey(we._baseState.key);if(typeof N!="object")return U.error("Child expected, but input is not object");var xe=we._encode(N[we._baseState.key],U,N);return U.leaveKey(Te),xe},this).filter(function(we){return we}),Z=this._createEncoderBuffer(Z);else if(z.tag==="seqof"||z.tag==="setof"){if(!(z.args&&z.args.length===1))return U.error("Too many args for : "+z.tag);if(!Array.isArray(N))return U.error("seqof/setof, but data is not Array");var Q=this.clone();Q._baseState.implicit=null,Z=this._createEncoderBuffer(N.map(function(we){var Te=this._baseState;return this._getUse(Te.args[0],N)._encode(we,U)},Q))}else z.use!==null?se=this._getUse(z.use,j)._encode(N,U):(Z=this._encodePrimitive(z.tag,N),X=!0);var se;if(!z.any&&z.choice===null){var oe=z.implicit!==null?z.implicit:z.tag,ue=z.implicit===null?"universal":"context";oe===null?z.use===null&&U.error("Tag could be omitted only for .use()"):z.use===null&&(se=this._encodeComposite(oe,X,ue,Z))}return z.explicit!==null&&(se=this._encodeComposite(z.explicit,!1,"context",se)),se},I.prototype._encodeChoice=function(N,U){var j=this._baseState,z=j.choice[N.type];return z||E(!1,N.type+" not found in "+JSON.stringify(Object.keys(j.choice))),z._encode(N.value,U)},I.prototype._encodePrimitive=function(N,U){var j=this._baseState;if(/str$/.test(N))return this._encodeStr(U,N);if(N==="objid"&&j.args)return this._encodeObjid(U,j.reverseArgs[0],j.args[1]);if(N==="objid")return this._encodeObjid(U,null,null);if(N==="gentime"||N==="utctime")return this._encodeTime(U,N);if(N==="null_")return this._encodeNull();if(N==="int"||N==="enum")return this._encodeInt(U,j.args&&j.reverseArgs[0]);if(N==="bool")return this._encodeBool(U);if(N==="objDesc")return this._encodeStr(U,N);throw new Error("Unsupported tag: "+N)},I.prototype._isNumstr=function(N){return/^[0-9 ]*$/.test(N)},I.prototype._isPrintstr=function(N){return/^[A-Za-z0-9 '\(\)\+,\-\.\/:=\?]*$/.test(N)},node}var hasRequiredBase;function requireBase(){return hasRequiredBase||(hasRequiredBase=1,function(n){var r=n;r.Reporter=requireReporter().Reporter,r.DecoderBuffer=requireBuffer().DecoderBuffer,r.EncoderBuffer=requireBuffer().EncoderBuffer,r.Node=requireNode()}(base$3)),base$3}var constants$2={},der={},hasRequiredDer$2;function requireDer$2(){return hasRequiredDer$2||(hasRequiredDer$2=1,function(n){var r=requireConstants();n.tagClass={0:"universal",1:"application",2:"context",3:"private"},n.tagClassByName=r._reverse(n.tagClass),n.tag={0:"end",1:"bool",2:"int",3:"bitstr",4:"octstr",5:"null_",6:"objid",7:"objDesc",8:"external",9:"real",10:"enum",11:"embed",12:"utf8str",13:"relativeOid",16:"seq",17:"set",18:"numstr",19:"printstr",20:"t61str",21:"videostr",22:"ia5str",23:"utctime",24:"gentime",25:"graphstr",26:"iso646str",27:"genstr",28:"unistr",29:"charstr",30:"bmpstr"},n.tagByName=r._reverse(n.tag)}(der)),der}var hasRequiredConstants;function requireConstants(){return hasRequiredConstants||(hasRequiredConstants=1,function(n){var r=n;r._reverse=function(E){var S={};return Object.keys(E).forEach(function(C){(C|0)==C&&(C=C|0);var A=E[C];S[A]=C}),S},r.der=requireDer$2()}(constants$2)),constants$2}var decoders$1={},der_1$1,hasRequiredDer$1;function requireDer$1(){if(hasRequiredDer$1)return der_1$1;hasRequiredDer$1=1;var n=inherits_browserExports,r=requireAsn1$1(),_=r.base,E=r.bignum,S=r.constants.der;function C(O){this.enc="der",this.name=O.name,this.entity=O,this.tree=new A,this.tree._init(O.body)}der_1$1=C,C.prototype.decode=function(N,U){return N instanceof _.DecoderBuffer||(N=new _.DecoderBuffer(N,U)),this.tree._decode(N,U)};function A(O){_.Node.call(this,"der",O)}n(A,_.Node),A.prototype._peekTag=function(N,U,j){if(N.isEmpty())return!1;var z=N.save(),Z=I(N,'Failed to peek tag: "'+U+'"');return N.isError(Z)?Z:(N.restore(z),Z.tag===U||Z.tagStr===U||Z.tagStr+"of"===U||j)},A.prototype._decodeTag=function(N,U,j){var z=I(N,'Failed to decode tag of "'+U+'"');if(N.isError(z))return z;var Z=B(N,z.primitive,'Failed to get length of "'+U+'"');if(N.isError(Z))return Z;if(!j&&z.tag!==U&&z.tagStr!==U&&z.tagStr+"of"!==U)return N.error('Failed to match tag: "'+U+'"');if(z.primitive||Z!==null)return N.skip(Z,'Failed to match body of: "'+U+'"');var X=N.save(),Q=this._skipUntilEnd(N,'Failed to skip indefinite length body: "'+this.tag+'"');return N.isError(Q)?Q:(Z=N.offset-X.offset,N.restore(X),N.skip(Z,'Failed to match body of: "'+U+'"'))},A.prototype._skipUntilEnd=function(N,U){for(;;){var j=I(N,U);if(N.isError(j))return j;var z=B(N,j.primitive,U);if(N.isError(z))return z;var Z;if(j.primitive||z!==null?Z=N.skip(z):Z=this._skipUntilEnd(N,U),N.isError(Z))return Z;if(j.tagStr==="end")break}},A.prototype._decodeList=function(N,U,j,z){for(var Z=[];!N.isEmpty();){var X=this._peekTag(N,"end");if(N.isError(X))return X;var Q=j.decode(N,"der",z);if(N.isError(Q)&&X)break;Z.push(Q)}return Z},A.prototype._decodeStr=function(N,U){if(U==="bitstr"){var j=N.readUInt8();return N.isError(j)?j:{unused:j,data:N.raw()}}else if(U==="bmpstr"){var z=N.raw();if(z.length%2===1)return N.error("Decoding of string type: bmpstr length mismatch");for(var Z="",X=0;X<z.length/2;X++)Z+=String.fromCharCode(z.readUInt16BE(X*2));return Z}else if(U==="numstr"){var Q=N.raw().toString("ascii");return this._isNumstr(Q)?Q:N.error("Decoding of string type: numstr unsupported characters")}else{if(U==="octstr")return N.raw();if(U==="objDesc")return N.raw();if(U==="printstr"){var se=N.raw().toString("ascii");return this._isPrintstr(se)?se:N.error("Decoding of string type: printstr unsupported characters")}else return/str$/.test(U)?N.raw().toString():N.error("Decoding of string type: "+U+" unsupported")}},A.prototype._decodeObjid=function(N,U,j){for(var z,Z=[],X=0;!N.isEmpty();){var Q=N.readUInt8();X<<=7,X|=Q&127,Q&128||(Z.push(X),X=0)}Q&128&&Z.push(X);var se=Z[0]/40|0,oe=Z[0]%40;if(j?z=Z:z=[se,oe].concat(Z.slice(1)),U){var ue=U[z.join(" ")];ue===void 0&&(ue=U[z.join(".")]),ue!==void 0&&(z=ue)}return z},A.prototype._decodeTime=function(N,U){var j=N.raw().toString();if(U==="gentime")var z=j.slice(0,4)|0,Z=j.slice(4,6)|0,X=j.slice(6,8)|0,Q=j.slice(8,10)|0,se=j.slice(10,12)|0,oe=j.slice(12,14)|0;else if(U==="utctime"){var z=j.slice(0,2)|0,Z=j.slice(2,4)|0,X=j.slice(4,6)|0,Q=j.slice(6,8)|0,se=j.slice(8,10)|0,oe=j.slice(10,12)|0;z<70?z=2e3+z:z=1900+z}else return N.error("Decoding "+U+" time is not supported yet");return Date.UTC(z,Z-1,X,Q,se,oe,0)},A.prototype._decodeNull=function(N){return null},A.prototype._decodeBool=function(N){var U=N.readUInt8();return N.isError(U)?U:U!==0},A.prototype._decodeInt=function(N,U){var j=N.raw(),z=new E(j);return U&&(z=U[z.toString(10)]||z),z},A.prototype._use=function(N,U){return typeof N=="function"&&(N=N(U)),N._getDecoder("der").tree};function I(O,N){var U=O.readUInt8(N);if(O.isError(U))return U;var j=S.tagClass[U>>6],z=(U&32)===0;if((U&31)===31){var Z=U;for(U=0;(Z&128)===128;){if(Z=O.readUInt8(N),O.isError(Z))return Z;U<<=7,U|=Z&127}}else U&=31;var X=S.tag[U];return{cls:j,primitive:z,tag:U,tagStr:X}}function B(O,N,U){var j=O.readUInt8(U);if(O.isError(j))return j;if(!N&&j===128)return null;if(!(j&128))return j;var z=j&127;if(z>4)return O.error("length octect is too long");j=0;for(var Z=0;Z<z;Z++){j<<=8;var X=O.readUInt8(U);if(O.isError(X))return X;j|=X}return j}return der_1$1}var pem$2,hasRequiredPem$1;function requirePem$1(){if(hasRequiredPem$1)return pem$2;hasRequiredPem$1=1;var n=inherits_browserExports,r=buffer$2.Buffer,_=requireDer$1();function E(S){_.call(this,S),this.enc="pem"}return n(E,_),pem$2=E,E.prototype.decode=function(C,A){for(var I=C.toString().split(/[\r\n]+/g),B=A.label.toUpperCase(),O=/^-----(BEGIN|END) ([^-]+)-----$/,N=-1,U=-1,j=0;j<I.length;j++){var z=I[j].match(O);if(z!==null&&z[2]===B)if(N===-1){if(z[1]!=="BEGIN")break;N=j}else{if(z[1]!=="END")break;U=j;break}}if(N===-1||U===-1)throw new Error("PEM section not found for: "+B);var Z=I.slice(N+1,U).join("");Z.replace(/[^a-z0-9\+\/=]+/gi,"");var X=new r(Z,"base64");return _.prototype.decode.call(this,X,A)},pem$2}var hasRequiredDecoders;function requireDecoders(){return hasRequiredDecoders||(hasRequiredDecoders=1,function(n){var r=n;r.der=requireDer$1(),r.pem=requirePem$1()}(decoders$1)),decoders$1}var encoders={},der_1,hasRequiredDer;function requireDer(){if(hasRequiredDer)return der_1;hasRequiredDer=1;var n=inherits_browserExports,r=buffer$2.Buffer,_=requireAsn1$1(),E=_.base,S=_.constants.der;function C(O){this.enc="der",this.name=O.name,this.entity=O,this.tree=new A,this.tree._init(O.body)}der_1=C,C.prototype.encode=function(N,U){return this.tree._encode(N,U).join()};function A(O){E.Node.call(this,"der",O)}n(A,E.Node),A.prototype._encodeComposite=function(N,U,j,z){var Z=B(N,U,j,this.reporter);if(z.length<128){var se=new r(2);return se[0]=Z,se[1]=z.length,this._createEncoderBuffer([se,z])}for(var X=1,Q=z.length;Q>=256;Q>>=8)X++;var se=new r(2+X);se[0]=Z,se[1]=128|X;for(var Q=1+X,oe=z.length;oe>0;Q--,oe>>=8)se[Q]=oe&255;return this._createEncoderBuffer([se,z])},A.prototype._encodeStr=function(N,U){if(U==="bitstr")return this._createEncoderBuffer([N.unused|0,N.data]);if(U==="bmpstr"){for(var j=new r(N.length*2),z=0;z<N.length;z++)j.writeUInt16BE(N.charCodeAt(z),z*2);return this._createEncoderBuffer(j)}else return U==="numstr"?this._isNumstr(N)?this._createEncoderBuffer(N):this.reporter.error("Encoding of string type: numstr supports only digits and space"):U==="printstr"?this._isPrintstr(N)?this._createEncoderBuffer(N):this.reporter.error("Encoding of string type: printstr supports only latin upper and lower case letters, digits, space, apostrophe, left and rigth parenthesis, plus sign, comma, hyphen, dot, slash, colon, equal sign, question mark"):/str$/.test(U)?this._createEncoderBuffer(N):U==="objDesc"?this._createEncoderBuffer(N):this.reporter.error("Encoding of string type: "+U+" unsupported")},A.prototype._encodeObjid=function(N,U,j){if(typeof N=="string"){if(!U)return this.reporter.error("string objid given, but no values map found");if(!U.hasOwnProperty(N))return this.reporter.error("objid not found in values map");N=U[N].split(/[\s\.]+/g);for(var z=0;z<N.length;z++)N[z]|=0}else if(Array.isArray(N)){N=N.slice();for(var z=0;z<N.length;z++)N[z]|=0}if(!Array.isArray(N))return this.reporter.error("objid() should be either array or string, got: "+JSON.stringify(N));if(!j){if(N[1]>=40)return this.reporter.error("Second objid identifier OOB");N.splice(0,2,N[0]*40+N[1])}for(var Z=0,z=0;z<N.length;z++){var X=N[z];for(Z++;X>=128;X>>=7)Z++}for(var Q=new r(Z),se=Q.length-1,z=N.length-1;z>=0;z--){var X=N[z];for(Q[se--]=X&127;(X>>=7)>0;)Q[se--]=128|X&127}return this._createEncoderBuffer(Q)};function I(O){return O<10?"0"+O:O}A.prototype._encodeTime=function(N,U){var j,z=new Date(N);return U==="gentime"?j=[I(z.getFullYear()),I(z.getUTCMonth()+1),I(z.getUTCDate()),I(z.getUTCHours()),I(z.getUTCMinutes()),I(z.getUTCSeconds()),"Z"].join(""):U==="utctime"?j=[I(z.getFullYear()%100),I(z.getUTCMonth()+1),I(z.getUTCDate()),I(z.getUTCHours()),I(z.getUTCMinutes()),I(z.getUTCSeconds()),"Z"].join(""):this.reporter.error("Encoding "+U+" time is not supported yet"),this._encodeStr(j,"octstr")},A.prototype._encodeNull=function(){return this._createEncoderBuffer("")},A.prototype._encodeInt=function(N,U){if(typeof N=="string"){if(!U)return this.reporter.error("String int or enum given, but no values map");if(!U.hasOwnProperty(N))return this.reporter.error("Values map doesn't contain: "+JSON.stringify(N));N=U[N]}if(typeof N!="number"&&!r.isBuffer(N)){var j=N.toArray();!N.sign&&j[0]&128&&j.unshift(0),N=new r(j)}if(r.isBuffer(N)){var z=N.length;N.length===0&&z++;var X=new r(z);return N.copy(X),N.length===0&&(X[0]=0),this._createEncoderBuffer(X)}if(N<128)return this._createEncoderBuffer(N);if(N<256)return this._createEncoderBuffer([0,N]);for(var z=1,Z=N;Z>=256;Z>>=8)z++;for(var X=new Array(z),Z=X.length-1;Z>=0;Z--)X[Z]=N&255,N>>=8;return X[0]&128&&X.unshift(0),this._createEncoderBuffer(new r(X))},A.prototype._encodeBool=function(N){return this._createEncoderBuffer(N?255:0)},A.prototype._use=function(N,U){return typeof N=="function"&&(N=N(U)),N._getEncoder("der").tree},A.prototype._skipDefault=function(N,U,j){var z=this._baseState,Z;if(z.default===null)return!1;var X=N.join();if(z.defaultBuffer===void 0&&(z.defaultBuffer=this._encodeValue(z.default,U,j).join()),X.length!==z.defaultBuffer.length)return!1;for(Z=0;Z<X.length;Z++)if(X[Z]!==z.defaultBuffer[Z])return!1;return!0};function B(O,N,U,j){var z;if(O==="seqof"?O="seq":O==="setof"&&(O="set"),S.tagByName.hasOwnProperty(O))z=S.tagByName[O];else if(typeof O=="number"&&(O|0)===O)z=O;else return j.error("Unknown tag: "+O);return z>=31?j.error("Multi-octet tag encoding unsupported"):(N||(z|=32),z|=S.tagClassByName[U||"universal"]<<6,z)}return der_1}var pem$1,hasRequiredPem;function requirePem(){if(hasRequiredPem)return pem$1;hasRequiredPem=1;var n=inherits_browserExports,r=requireDer();function _(E){r.call(this,E),this.enc="pem"}return n(_,r),pem$1=_,_.prototype.encode=function(S,C){for(var A=r.prototype.encode.call(this,S),I=A.toString("base64"),B=["-----BEGIN "+C.label+"-----"],O=0;O<I.length;O+=64)B.push(I.slice(O,O+64));return B.push("-----END "+C.label+"-----"),B.join(`
`)},pem$1}var hasRequiredEncoders;function requireEncoders(){return hasRequiredEncoders||(hasRequiredEncoders=1,function(n){var r=n;r.der=requireDer(),r.pem=requirePem()}(encoders)),encoders}var hasRequiredAsn1$1;function requireAsn1$1(){return hasRequiredAsn1$1||(hasRequiredAsn1$1=1,function(n){var r=n;r.bignum=requireBn$1(),r.define=requireApi().define,r.base=requireBase(),r.constants=requireConstants(),r.decoders=requireDecoders(),r.encoders=requireEncoders()}(asn1$2)),asn1$2}var certificate,hasRequiredCertificate;function requireCertificate(){if(hasRequiredCertificate)return certificate;hasRequiredCertificate=1;var n=requireAsn1$1(),r=n.define("Time",function(){this.choice({utcTime:this.utctime(),generalTime:this.gentime()})}),_=n.define("AttributeTypeValue",function(){this.seq().obj(this.key("type").objid(),this.key("value").any())}),E=n.define("AlgorithmIdentifier",function(){this.seq().obj(this.key("algorithm").objid(),this.key("parameters").optional(),this.key("curve").objid().optional())}),S=n.define("SubjectPublicKeyInfo",function(){this.seq().obj(this.key("algorithm").use(E),this.key("subjectPublicKey").bitstr())}),C=n.define("RelativeDistinguishedName",function(){this.setof(_)}),A=n.define("RDNSequence",function(){this.seqof(C)}),I=n.define("Name",function(){this.choice({rdnSequence:this.use(A)})}),B=n.define("Validity",function(){this.seq().obj(this.key("notBefore").use(r),this.key("notAfter").use(r))}),O=n.define("Extension",function(){this.seq().obj(this.key("extnID").objid(),this.key("critical").bool().def(!1),this.key("extnValue").octstr())}),N=n.define("TBSCertificate",function(){this.seq().obj(this.key("version").explicit(0).int().optional(),this.key("serialNumber").int(),this.key("signature").use(E),this.key("issuer").use(I),this.key("validity").use(B),this.key("subject").use(I),this.key("subjectPublicKeyInfo").use(S),this.key("issuerUniqueID").implicit(1).bitstr().optional(),this.key("subjectUniqueID").implicit(2).bitstr().optional(),this.key("extensions").explicit(3).seqof(O).optional())}),U=n.define("X509Certificate",function(){this.seq().obj(this.key("tbsCertificate").use(N),this.key("signatureAlgorithm").use(E),this.key("signatureValue").bitstr())});return certificate=U,certificate}var hasRequiredAsn1;function requireAsn1(){if(hasRequiredAsn1)return asn1$3;hasRequiredAsn1=1;var n=requireAsn1$1();asn1$3.certificate=requireCertificate();var r=n.define("RSAPrivateKey",function(){this.seq().obj(this.key("version").int(),this.key("modulus").int(),this.key("publicExponent").int(),this.key("privateExponent").int(),this.key("prime1").int(),this.key("prime2").int(),this.key("exponent1").int(),this.key("exponent2").int(),this.key("coefficient").int())});asn1$3.RSAPrivateKey=r;var _=n.define("RSAPublicKey",function(){this.seq().obj(this.key("modulus").int(),this.key("publicExponent").int())});asn1$3.RSAPublicKey=_;var E=n.define("AlgorithmIdentifier",function(){this.seq().obj(this.key("algorithm").objid(),this.key("none").null_().optional(),this.key("curve").objid().optional(),this.key("params").seq().obj(this.key("p").int(),this.key("q").int(),this.key("g").int()).optional())}),S=n.define("SubjectPublicKeyInfo",function(){this.seq().obj(this.key("algorithm").use(E),this.key("subjectPublicKey").bitstr())});asn1$3.PublicKey=S;var C=n.define("PrivateKeyInfo",function(){this.seq().obj(this.key("version").int(),this.key("algorithm").use(E),this.key("subjectPrivateKey").octstr())});asn1$3.PrivateKey=C;var A=n.define("EncryptedPrivateKeyInfo",function(){this.seq().obj(this.key("algorithm").seq().obj(this.key("id").objid(),this.key("decrypt").seq().obj(this.key("kde").seq().obj(this.key("id").objid(),this.key("kdeparams").seq().obj(this.key("salt").octstr(),this.key("iters").int())),this.key("cipher").seq().obj(this.key("algo").objid(),this.key("iv").octstr()))),this.key("subjectPrivateKey").octstr())});asn1$3.EncryptedPrivateKey=A;var I=n.define("DSAPrivateKey",function(){this.seq().obj(this.key("version").int(),this.key("p").int(),this.key("q").int(),this.key("g").int(),this.key("pub_key").int(),this.key("priv_key").int())});asn1$3.DSAPrivateKey=I,asn1$3.DSAparam=n.define("DSAparam",function(){this.int()});var B=n.define("ECParameters",function(){this.choice({namedCurve:this.objid()})}),O=n.define("ECPrivateKey",function(){this.seq().obj(this.key("version").int(),this.key("privateKey").octstr(),this.key("parameters").optional().explicit(0).use(B),this.key("publicKey").optional().explicit(1).bitstr())});return asn1$3.ECPrivateKey=O,asn1$3.signature=n.define("signature",function(){this.seq().obj(this.key("r").int(),this.key("s").int())}),asn1$3}const require$$1={"2.16.840.1.101.3.4.1.1":"aes-128-ecb","2.16.840.1.101.3.4.1.2":"aes-128-cbc","2.16.840.1.101.3.4.1.3":"aes-128-ofb","2.16.840.1.101.3.4.1.4":"aes-128-cfb","2.16.840.1.101.3.4.1.21":"aes-192-ecb","2.16.840.1.101.3.4.1.22":"aes-192-cbc","2.16.840.1.101.3.4.1.23":"aes-192-ofb","2.16.840.1.101.3.4.1.24":"aes-192-cfb","2.16.840.1.101.3.4.1.41":"aes-256-ecb","2.16.840.1.101.3.4.1.42":"aes-256-cbc","2.16.840.1.101.3.4.1.43":"aes-256-ofb","2.16.840.1.101.3.4.1.44":"aes-256-cfb"};var fixProc,hasRequiredFixProc;function requireFixProc(){if(hasRequiredFixProc)return fixProc;hasRequiredFixProc=1;var n=/Proc-Type: 4,ENCRYPTED[\n\r]+DEK-Info: AES-((?:128)|(?:192)|(?:256))-CBC,([0-9A-H]+)[\n\r]+([0-9A-z\n\r+/=]+)[\n\r]+/m,r=/^-----BEGIN ((?:.*? KEY)|CERTIFICATE)-----/m,_=/^-----BEGIN ((?:.*? KEY)|CERTIFICATE)-----([0-9A-z\n\r+/=]+)-----END \1-----$/m,E=requireEvp_bytestokey(),S=requireBrowser$6(),C=requireSafeBuffer().Buffer;return fixProc=function(A,I){var B=A.toString(),O=B.match(n),N;if(O){var j="aes"+O[1],z=C.from(O[2],"hex"),Z=C.from(O[3].replace(/[\r\n]/g,""),"base64"),X=E(I,z.slice(0,8),parseInt(O[1],10)).key,Q=[],se=S.createDecipheriv(j,X,z);Q.push(se.update(Z)),Q.push(se.final()),N=C.concat(Q)}else{var U=B.match(_);N=C.from(U[2].replace(/[\r\n]/g,""),"base64")}var oe=B.match(r)[1];return{tag:oe,data:N}},fixProc}var parseAsn1,hasRequiredParseAsn1;function requireParseAsn1(){if(hasRequiredParseAsn1)return parseAsn1;hasRequiredParseAsn1=1;var n=requireAsn1(),r=require$$1,_=requireFixProc(),E=requireBrowser$6(),S=requireBrowser$7(),C=requireSafeBuffer().Buffer;function A(B,O){var N=B.algorithm.decrypt.kde.kdeparams.salt,U=parseInt(B.algorithm.decrypt.kde.kdeparams.iters.toString(),10),j=r[B.algorithm.decrypt.cipher.algo.join(".")],z=B.algorithm.decrypt.cipher.iv,Z=B.subjectPrivateKey,X=parseInt(j.split("-")[1],10)/8,Q=S.pbkdf2Sync(O,N,U,X,"sha1"),se=E.createDecipheriv(j,Q,z),oe=[];return oe.push(se.update(Z)),oe.push(se.final()),C.concat(oe)}function I(B){var O;typeof B=="object"&&!C.isBuffer(B)&&(O=B.passphrase,B=B.key),typeof B=="string"&&(B=C.from(B));var N=_(B,O),U=N.tag,j=N.data,z,Z;switch(U){case"CERTIFICATE":Z=n.certificate.decode(j,"der").tbsCertificate.subjectPublicKeyInfo;case"PUBLIC KEY":switch(Z||(Z=n.PublicKey.decode(j,"der")),z=Z.algorithm.algorithm.join("."),z){case"1.2.840.113549.1.1.1":return n.RSAPublicKey.decode(Z.subjectPublicKey.data,"der");case"1.2.840.10045.2.1":return Z.subjectPrivateKey=Z.subjectPublicKey,{type:"ec",data:Z};case"1.2.840.10040.4.1":return Z.algorithm.params.pub_key=n.DSAparam.decode(Z.subjectPublicKey.data,"der"),{type:"dsa",data:Z.algorithm.params};default:throw new Error("unknown key id "+z)}case"ENCRYPTED PRIVATE KEY":j=n.EncryptedPrivateKey.decode(j,"der"),j=A(j,O);case"PRIVATE KEY":switch(Z=n.PrivateKey.decode(j,"der"),z=Z.algorithm.algorithm.join("."),z){case"1.2.840.113549.1.1.1":return n.RSAPrivateKey.decode(Z.subjectPrivateKey,"der");case"1.2.840.10045.2.1":return{curve:Z.algorithm.curve,privateKey:n.ECPrivateKey.decode(Z.subjectPrivateKey,"der").privateKey};case"1.2.840.10040.4.1":return Z.algorithm.params.priv_key=n.DSAparam.decode(Z.subjectPrivateKey,"der"),{type:"dsa",params:Z.algorithm.params};default:throw new Error("unknown key id "+z)}case"RSA PUBLIC KEY":return n.RSAPublicKey.decode(j,"der");case"RSA PRIVATE KEY":return n.RSAPrivateKey.decode(j,"der");case"DSA PRIVATE KEY":return{type:"dsa",params:n.DSAPrivateKey.decode(j,"der")};case"EC PRIVATE KEY":return j=n.ECPrivateKey.decode(j,"der"),{curve:j.parameters.value,privateKey:j.privateKey};default:throw new Error("unknown key type "+U)}}return I.signature=n.signature,parseAsn1=I,parseAsn1}const require$$4$1={"1.3.132.0.10":"secp256k1","1.3.132.0.33":"p224","1.2.840.10045.3.1.1":"p192","1.2.840.10045.3.1.7":"p256","1.3.132.0.34":"p384","1.3.132.0.35":"p521"};var hasRequiredSign;function requireSign(){if(hasRequiredSign)return sign.exports;hasRequiredSign=1;var n=requireSafeBuffer().Buffer,r=requireBrowser$8(),_=requireBrowserifyRsa(),E=requireElliptic().ec,S=requireBn(),C=requireParseAsn1(),A=require$$4$1,I=1;function B(se,oe,ue,we,Te){var xe=C(oe);if(xe.curve){if(we!=="ecdsa"&&we!=="ecdsa/rsa")throw new Error("wrong private key type");return O(se,xe)}else if(xe.type==="dsa"){if(we!=="dsa")throw new Error("wrong private key type");return N(se,xe,ue)}if(we!=="rsa"&&we!=="ecdsa/rsa")throw new Error("wrong private key type");if(oe.padding!==void 0&&oe.padding!==I)throw new Error("illegal or unsupported padding mode");se=n.concat([Te,se]);for(var Re=xe.modulus.byteLength(),Ne=[0,1];se.length+Ne.length+1<Re;)Ne.push(255);Ne.push(0);for(var Fe=-1;++Fe<se.length;)Ne.push(se[Fe]);var ht=_(Ne,xe);return ht}function O(se,oe){var ue=A[oe.curve.join(".")];if(!ue)throw new Error("unknown curve "+oe.curve.join("."));var we=new E(ue),Te=we.keyFromPrivate(oe.privateKey),xe=Te.sign(se);return n.from(xe.toDER())}function N(se,oe,ue){for(var we=oe.params.priv_key,Te=oe.params.p,xe=oe.params.q,Re=oe.params.g,Ne=new S(0),Fe,ht=z(se,xe).mod(xe),nt=!1,Ee=j(we,xe,se,ue);nt===!1;)Fe=X(xe,Ee,ue),Ne=Q(Re,Fe,Te,xe),nt=Fe.invm(xe).imul(ht.add(we.mul(Ne))).mod(xe),nt.cmpn(0)===0&&(nt=!1,Ne=new S(0));return U(Ne,nt)}function U(se,oe){se=se.toArray(),oe=oe.toArray(),se[0]&128&&(se=[0].concat(se)),oe[0]&128&&(oe=[0].concat(oe));var ue=se.length+oe.length+4,we=[48,ue,2,se.length];return we=we.concat(se,[2,oe.length],oe),n.from(we)}function j(se,oe,ue,we){if(se=n.from(se.toArray()),se.length<oe.byteLength()){var Te=n.alloc(oe.byteLength()-se.length);se=n.concat([Te,se])}var xe=ue.length,Re=Z(ue,oe),Ne=n.alloc(xe);Ne.fill(1);var Fe=n.alloc(xe);return Fe=r(we,Fe).update(Ne).update(n.from([0])).update(se).update(Re).digest(),Ne=r(we,Fe).update(Ne).digest(),Fe=r(we,Fe).update(Ne).update(n.from([1])).update(se).update(Re).digest(),Ne=r(we,Fe).update(Ne).digest(),{k:Fe,v:Ne}}function z(se,oe){var ue=new S(se),we=(se.length<<3)-oe.bitLength();return we>0&&ue.ishrn(we),ue}function Z(se,oe){se=z(se,oe),se=se.mod(oe);var ue=n.from(se.toArray());if(ue.length<oe.byteLength()){var we=n.alloc(oe.byteLength()-ue.length);ue=n.concat([we,ue])}return ue}function X(se,oe,ue){var we,Te;do{for(we=n.alloc(0);we.length*8<se.bitLength();)oe.v=r(ue,oe.k).update(oe.v).digest(),we=n.concat([we,oe.v]);Te=z(we,se),oe.k=r(ue,oe.k).update(oe.v).update(n.from([0])).digest(),oe.v=r(ue,oe.k).update(oe.v).digest()}while(Te.cmp(se)!==-1);return Te}function Q(se,oe,ue,we){return se.toRed(S.mont(ue)).redPow(oe).fromRed().mod(we)}return sign.exports=B,sign.exports.getKey=j,sign.exports.makeKey=X,sign.exports}var verify_1,hasRequiredVerify;function requireVerify(){if(hasRequiredVerify)return verify_1;hasRequiredVerify=1;var n=requireSafeBuffer().Buffer,r=requireBn(),_=requireElliptic().ec,E=requireParseAsn1(),S=require$$4$1;function C(O,N,U,j,z){var Z=E(U);if(Z.type==="ec"){if(j!=="ecdsa"&&j!=="ecdsa/rsa")throw new Error("wrong public key type");return A(O,N,Z)}else if(Z.type==="dsa"){if(j!=="dsa")throw new Error("wrong public key type");return I(O,N,Z)}if(j!=="rsa"&&j!=="ecdsa/rsa")throw new Error("wrong public key type");N=n.concat([z,N]);for(var X=Z.modulus.byteLength(),Q=[1],se=0;N.length+Q.length+2<X;)Q.push(255),se+=1;Q.push(0);for(var oe=-1;++oe<N.length;)Q.push(N[oe]);Q=n.from(Q);var ue=r.mont(Z.modulus);O=new r(O).toRed(ue),O=O.redPow(new r(Z.publicExponent)),O=n.from(O.fromRed().toArray());var we=se<8?1:0;for(X=Math.min(O.length,Q.length),O.length!==Q.length&&(we=1),oe=-1;++oe<X;)we|=O[oe]^Q[oe];return we===0}function A(O,N,U){var j=S[U.data.algorithm.curve.join(".")];if(!j)throw new Error("unknown curve "+U.data.algorithm.curve.join("."));var z=new _(j),Z=U.data.subjectPrivateKey.data;return z.verify(N,O,Z)}function I(O,N,U){var j=U.data.p,z=U.data.q,Z=U.data.g,X=U.data.pub_key,Q=E.signature.decode(O,"der"),se=Q.s,oe=Q.r;B(se,z),B(oe,z);var ue=r.mont(j),we=se.invm(z),Te=Z.toRed(ue).redPow(new r(N).mul(we).mod(z)).fromRed().mul(X.toRed(ue).redPow(oe.mul(we).mod(z)).fromRed()).mod(j).mod(z);return Te.cmp(oe)===0}function B(O,N){if(O.cmpn(0)<=0)throw new Error("invalid sig");if(O.cmp(N)>=0)throw new Error("invalid sig")}return verify_1=C,verify_1}var browser$7,hasRequiredBrowser$3;function requireBrowser$3(){if(hasRequiredBrowser$3)return browser$7;hasRequiredBrowser$3=1;var n=requireSafeBuffer().Buffer,r=requireBrowser$9(),_=requireReadableBrowser(),E=inherits_browserExports,S=requireSign(),C=requireVerify(),A=require$$6;Object.keys(A).forEach(function(U){A[U].id=n.from(A[U].id,"hex"),A[U.toLowerCase()]=A[U]});function I(U){_.Writable.call(this);var j=A[U];if(!j)throw new Error("Unknown message digest");this._hashType=j.hash,this._hash=r(j.hash),this._tag=j.id,this._signType=j.sign}E(I,_.Writable),I.prototype._write=function(j,z,Z){this._hash.update(j),Z()},I.prototype.update=function(j,z){return this._hash.update(typeof j=="string"?n.from(j,z):j),this},I.prototype.sign=function(j,z){this.end();var Z=this._hash.digest(),X=S(Z,j,this._hashType,this._signType,this._tag);return z?X.toString(z):X};function B(U){_.Writable.call(this);var j=A[U];if(!j)throw new Error("Unknown message digest");this._hash=r(j.hash),this._tag=j.id,this._signType=j.sign}E(B,_.Writable),B.prototype._write=function(j,z,Z){this._hash.update(j),Z()},B.prototype.update=function(j,z){return this._hash.update(typeof j=="string"?n.from(j,z):j),this},B.prototype.verify=function(j,z,Z){var X=typeof z=="string"?n.from(z,Z):z;this.end();var Q=this._hash.digest();return C(X,Q,j,this._signType,this._tag)};function O(U){return new I(U)}function N(U){return new B(U)}return browser$7={Sign:O,Verify:N,createSign:O,createVerify:N},browser$7}var browser$6,hasRequiredBrowser$2;function requireBrowser$2(){if(hasRequiredBrowser$2)return browser$6;hasRequiredBrowser$2=1;var n=requireElliptic(),r=requireBn$1();browser$6=function(A){return new E(A)};var _={secp256k1:{name:"secp256k1",byteLength:32},secp224r1:{name:"p224",byteLength:28},prime256v1:{name:"p256",byteLength:32},prime192v1:{name:"p192",byteLength:24},ed25519:{name:"ed25519",byteLength:32},secp384r1:{name:"p384",byteLength:48},secp521r1:{name:"p521",byteLength:66}};_.p224=_.secp224r1,_.p256=_.secp256r1=_.prime256v1,_.p192=_.secp192r1=_.prime192v1,_.p384=_.secp384r1,_.p521=_.secp521r1;function E(C){this.curveType=_[C],this.curveType||(this.curveType={name:C}),this.curve=new n.ec(this.curveType.name),this.keys=void 0}E.prototype.generateKeys=function(C,A){return this.keys=this.curve.genKeyPair(),this.getPublicKey(C,A)},E.prototype.computeSecret=function(C,A,I){A=A||"utf8",Buffer$4.isBuffer(C)||(C=new Buffer$4(C,A));var B=this.curve.keyFromPublic(C).getPublic(),O=B.mul(this.keys.getPrivate()).getX();return S(O,I,this.curveType.byteLength)},E.prototype.getPublicKey=function(C,A){var I=this.keys.getPublic(A==="compressed",!0);return A==="hybrid"&&(I[I.length-1]%2?I[0]=7:I[0]=6),S(I,C)},E.prototype.getPrivateKey=function(C){return S(this.keys.getPrivate(),C)},E.prototype.setPublicKey=function(C,A){return A=A||"utf8",Buffer$4.isBuffer(C)||(C=new Buffer$4(C,A)),this.keys._importPublic(C),this},E.prototype.setPrivateKey=function(C,A){A=A||"utf8",Buffer$4.isBuffer(C)||(C=new Buffer$4(C,A));var I=new r(C);return I=I.toString(16),this.keys=this.curve.genKeyPair(),this.keys._importPrivate(I),this};function S(C,A,I){Array.isArray(C)||(C=C.toArray());var B=new Buffer$4(C);if(I&&B.length<I){var O=new Buffer$4(I-B.length);O.fill(0),B=Buffer$4.concat([O,B])}return A?B.toString(A):B}return browser$6}var browser$5={},mgf,hasRequiredMgf;function requireMgf(){if(hasRequiredMgf)return mgf;hasRequiredMgf=1;var n=requireBrowser$9(),r=requireSafeBuffer().Buffer;mgf=function(E,S){for(var C=r.alloc(0),A=0,I;C.length<S;)I=_(A++),C=r.concat([C,n("sha1").update(E).update(I).digest()]);return C.slice(0,S)};function _(E){var S=r.allocUnsafe(4);return S.writeUInt32BE(E,0),S}return mgf}var xor$1,hasRequiredXor;function requireXor(){return hasRequiredXor||(hasRequiredXor=1,xor$1=function(r,_){for(var E=r.length,S=-1;++S<E;)r[S]^=_[S];return r}),xor$1}var withPublic_1,hasRequiredWithPublic;function requireWithPublic(){if(hasRequiredWithPublic)return withPublic_1;hasRequiredWithPublic=1;var n=requireBn$1(),r=requireSafeBuffer().Buffer;function _(E,S){return r.from(E.toRed(n.mont(S.modulus)).redPow(new n(S.publicExponent)).fromRed().toArray())}return withPublic_1=_,withPublic_1}var publicEncrypt,hasRequiredPublicEncrypt;function requirePublicEncrypt(){if(hasRequiredPublicEncrypt)return publicEncrypt;hasRequiredPublicEncrypt=1;var n=requireParseAsn1(),r=requireBrowser$b(),_=requireBrowser$9(),E=requireMgf(),S=requireXor(),C=requireBn$1(),A=requireWithPublic(),I=requireBrowserifyRsa(),B=requireSafeBuffer().Buffer;publicEncrypt=function(z,Z,X){var Q;z.padding?Q=z.padding:X?Q=1:Q=4;var se=n(z),oe;if(Q===4)oe=O(se,Z);else if(Q===1)oe=N(se,Z,X);else if(Q===3){if(oe=new C(Z),oe.cmp(se.modulus)>=0)throw new Error("data too long for modulus")}else throw new Error("unknown padding");return X?I(oe,se):A(oe,se)};function O(j,z){var Z=j.modulus.byteLength(),X=z.length,Q=_("sha1").update(B.alloc(0)).digest(),se=Q.length,oe=2*se;if(X>Z-oe-2)throw new Error("message too long");var ue=B.alloc(Z-X-oe-2),we=Z-se-1,Te=r(se),xe=S(B.concat([Q,ue,B.alloc(1,1),z],we),E(Te,we)),Re=S(Te,E(xe,se));return new C(B.concat([B.alloc(1),Re,xe],Z))}function N(j,z,Z){var X=z.length,Q=j.modulus.byteLength();if(X>Q-11)throw new Error("message too long");var se;return Z?se=B.alloc(Q-X-3,255):se=U(Q-X-3),new C(B.concat([B.from([0,Z?1:2]),se,B.alloc(1),z],Q))}function U(j){for(var z=B.allocUnsafe(j),Z=0,X=r(j*2),Q=0,se;Z<j;)Q===X.length&&(X=r(j*2),Q=0),se=X[Q++],se&&(z[Z++]=se);return z}return publicEncrypt}var privateDecrypt,hasRequiredPrivateDecrypt;function requirePrivateDecrypt(){if(hasRequiredPrivateDecrypt)return privateDecrypt;hasRequiredPrivateDecrypt=1;var n=requireParseAsn1(),r=requireMgf(),_=requireXor(),E=requireBn$1(),S=requireBrowserifyRsa(),C=requireBrowser$9(),A=requireWithPublic(),I=requireSafeBuffer().Buffer;privateDecrypt=function(j,z,Z){var X;j.padding?X=j.padding:Z?X=1:X=4;var Q=n(j),se=Q.modulus.byteLength();if(z.length>se||new E(z).cmp(Q.modulus)>=0)throw new Error("decryption error");var oe;Z?oe=A(new E(z),Q):oe=S(z,Q);var ue=I.alloc(se-oe.length);if(oe=I.concat([ue,oe],se),X===4)return B(Q,oe);if(X===1)return O(Q,oe,Z);if(X===3)return oe;throw new Error("unknown padding")};function B(U,j){var z=U.modulus.byteLength(),Z=C("sha1").update(I.alloc(0)).digest(),X=Z.length;if(j[0]!==0)throw new Error("decryption error");var Q=j.slice(1,X+1),se=j.slice(X+1),oe=_(Q,r(se,X)),ue=_(se,r(oe,z-X-1));if(N(Z,ue.slice(0,X)))throw new Error("decryption error");for(var we=X;ue[we]===0;)we++;if(ue[we++]!==1)throw new Error("decryption error");return ue.slice(we)}function O(U,j,z){for(var Z=j.slice(0,2),X=2,Q=0;j[X++]!==0;)if(X>=j.length){Q++;break}var se=j.slice(2,X-1);if((Z.toString("hex")!=="0002"&&!z||Z.toString("hex")!=="0001"&&z)&&Q++,se.length<8&&Q++,Q)throw new Error("decryption error");return j.slice(X)}function N(U,j){U=I.from(U),j=I.from(j);var z=0,Z=U.length;U.length!==j.length&&(z++,Z=Math.min(U.length,j.length));for(var X=-1;++X<Z;)z+=U[X]^j[X];return z}return privateDecrypt}var hasRequiredBrowser$1;function requireBrowser$1(){return hasRequiredBrowser$1||(hasRequiredBrowser$1=1,function(n){n.publicEncrypt=requirePublicEncrypt(),n.privateDecrypt=requirePrivateDecrypt(),n.privateEncrypt=function(_,E){return n.publicEncrypt(_,E,!0)},n.publicDecrypt=function(_,E){return n.privateDecrypt(_,E,!0)}}(browser$5)),browser$5}var browser$4={},hasRequiredBrowser;function requireBrowser(){if(hasRequiredBrowser)return browser$4;hasRequiredBrowser=1;function n(){throw new Error(`secure random number generation not supported by this browser
use chrome, FireFox or Internet Explorer 11`)}var r=requireSafeBuffer(),_=requireBrowser$b(),E=r.Buffer,S=r.kMaxLength,C=commonjsGlobal.crypto||commonjsGlobal.msCrypto,A=Math.pow(2,32)-1;function I(j,z){if(typeof j!="number"||j!==j)throw new TypeError("offset must be a number");if(j>A||j<0)throw new TypeError("offset must be a uint32");if(j>S||j>z)throw new RangeError("offset out of range")}function B(j,z,Z){if(typeof j!="number"||j!==j)throw new TypeError("size must be a number");if(j>A||j<0)throw new TypeError("size must be a uint32");if(j+z>Z||j>S)throw new RangeError("buffer too small")}C&&C.getRandomValues||!browser$1$1.browser?(browser$4.randomFill=O,browser$4.randomFillSync=U):(browser$4.randomFill=n,browser$4.randomFillSync=n);function O(j,z,Z,X){if(!E.isBuffer(j)&&!(j instanceof commonjsGlobal.Uint8Array))throw new TypeError('"buf" argument must be a Buffer or Uint8Array');if(typeof z=="function")X=z,z=0,Z=j.length;else if(typeof Z=="function")X=Z,Z=j.length-z;else if(typeof X!="function")throw new TypeError('"cb" argument must be a function');return I(z,j.length),B(Z,z,j.length),N(j,z,Z,X)}function N(j,z,Z,X){if(browser$1$1.browser){var Q=j.buffer,se=new Uint8Array(Q,z,Z);if(C.getRandomValues(se),X){browser$1$1.nextTick(function(){X(null,j)});return}return j}if(X){_(Z,function(ue,we){if(ue)return X(ue);we.copy(j,z),X(null,j)});return}var oe=_(Z);return oe.copy(j,z),j}function U(j,z,Z){if(typeof z>"u"&&(z=0),!E.isBuffer(j)&&!(j instanceof commonjsGlobal.Uint8Array))throw new TypeError('"buf" argument must be a Buffer or Uint8Array');return I(z,j.length),Z===void 0&&(Z=j.length-z),B(Z,z,j.length),N(j,z,Z)}return browser$4}var hasRequiredCryptoBrowserify;function requireCryptoBrowserify(){if(hasRequiredCryptoBrowserify)return cryptoBrowserify;hasRequiredCryptoBrowserify=1,cryptoBrowserify.randomBytes=cryptoBrowserify.rng=cryptoBrowserify.pseudoRandomBytes=cryptoBrowserify.prng=requireBrowser$b(),cryptoBrowserify.createHash=cryptoBrowserify.Hash=requireBrowser$9(),cryptoBrowserify.createHmac=cryptoBrowserify.Hmac=requireBrowser$8();var n=requireAlgos(),r=Object.keys(n),_=["sha1","sha224","sha256","sha384","sha512","md5","rmd160"].concat(r);cryptoBrowserify.getHashes=function(){return _};var E=requireBrowser$7();cryptoBrowserify.pbkdf2=E.pbkdf2,cryptoBrowserify.pbkdf2Sync=E.pbkdf2Sync;var S=requireBrowser$5();cryptoBrowserify.Cipher=S.Cipher,cryptoBrowserify.createCipher=S.createCipher,cryptoBrowserify.Cipheriv=S.Cipheriv,cryptoBrowserify.createCipheriv=S.createCipheriv,cryptoBrowserify.Decipher=S.Decipher,cryptoBrowserify.createDecipher=S.createDecipher,cryptoBrowserify.Decipheriv=S.Decipheriv,cryptoBrowserify.createDecipheriv=S.createDecipheriv,cryptoBrowserify.getCiphers=S.getCiphers,cryptoBrowserify.listCiphers=S.listCiphers;var C=requireBrowser$4();cryptoBrowserify.DiffieHellmanGroup=C.DiffieHellmanGroup,cryptoBrowserify.createDiffieHellmanGroup=C.createDiffieHellmanGroup,cryptoBrowserify.getDiffieHellman=C.getDiffieHellman,cryptoBrowserify.createDiffieHellman=C.createDiffieHellman,cryptoBrowserify.DiffieHellman=C.DiffieHellman;var A=requireBrowser$3();cryptoBrowserify.createSign=A.createSign,cryptoBrowserify.Sign=A.Sign,cryptoBrowserify.createVerify=A.createVerify,cryptoBrowserify.Verify=A.Verify,cryptoBrowserify.createECDH=requireBrowser$2();var I=requireBrowser$1();cryptoBrowserify.publicEncrypt=I.publicEncrypt,cryptoBrowserify.privateEncrypt=I.privateEncrypt,cryptoBrowserify.publicDecrypt=I.publicDecrypt,cryptoBrowserify.privateDecrypt=I.privateDecrypt;var B=requireBrowser();return cryptoBrowserify.randomFill=B.randomFill,cryptoBrowserify.randomFillSync=B.randomFillSync,cryptoBrowserify.createCredentials=function(){throw new Error(["sorry, createCredentials is not implemented yet","we accept pull requests","https://github.com/crypto-browserify/crypto-browserify"].join(`
`))},cryptoBrowserify.constants={DH_CHECK_P_NOT_SAFE_PRIME:2,DH_CHECK_P_NOT_PRIME:1,DH_UNABLE_TO_CHECK_GENERATOR:4,DH_NOT_SUITABLE_GENERATOR:8,NPN_ENABLED:1,ALPN_ENABLED:1,RSA_PKCS1_PADDING:1,RSA_SSLV23_PADDING:2,RSA_NO_PADDING:3,RSA_PKCS1_OAEP_PADDING:4,RSA_X931_PADDING:5,RSA_PKCS1_PSS_PADDING:6,POINT_CONVERSION_COMPRESSED:2,POINT_CONVERSION_UNCOMPRESSED:4,POINT_CONVERSION_HYBRID:6},cryptoBrowserify}var forge$c=forge$m,pkcs5=forge$c.pkcs5=forge$c.pkcs5||{},crypto$4;forge$c.util.isNodejs&&!forge$c.options.usePureJavaScript&&(crypto$4=requireCryptoBrowserify());forge$c.pbkdf2=pkcs5.pbkdf2=function(n,r,_,E,S,C){if(typeof S=="function"&&(C=S,S=null),forge$c.util.isNodejs&&!forge$c.options.usePureJavaScript&&crypto$4.pbkdf2&&(S===null||typeof S!="object")&&(crypto$4.pbkdf2Sync.length>4||!S||S==="sha1"))return typeof S!="string"&&(S="sha1"),n=Buffer$4.from(n,"binary"),r=Buffer$4.from(r,"binary"),C?crypto$4.pbkdf2Sync.length===4?crypto$4.pbkdf2(n,r,_,E,function(ue,we){if(ue)return C(ue);C(null,we.toString("binary"))}):crypto$4.pbkdf2(n,r,_,E,S,function(ue,we){if(ue)return C(ue);C(null,we.toString("binary"))}):crypto$4.pbkdf2Sync.length===4?crypto$4.pbkdf2Sync(n,r,_,E).toString("binary"):crypto$4.pbkdf2Sync(n,r,_,E,S).toString("binary");if((typeof S>"u"||S===null)&&(S="sha1"),typeof S=="string"){if(!(S in forge$c.md.algorithms))throw new Error("Unknown hash algorithm: "+S);S=forge$c.md[S].create()}var A=S.digestLength;if(E>4294967295*A){var I=new Error("Derived key is too long.");if(C)return C(I);throw I}var B=Math.ceil(E/A),O=E-(B-1)*A,N=forge$c.hmac.create();N.start(S,n);var U="",j,z,Z;if(!C){for(var X=1;X<=B;++X){N.start(null,null),N.update(r),N.update(forge$c.util.int32ToBytes(X)),j=Z=N.digest().getBytes();for(var Q=2;Q<=_;++Q)N.start(null,null),N.update(Z),z=N.digest().getBytes(),j=forge$c.util.xorBytes(j,z,A),Z=z;U+=X<B?j:j.substr(0,O)}return U}var X=1,Q;function se(){if(X>B)return C(null,U);N.start(null,null),N.update(r),N.update(forge$c.util.int32ToBytes(X)),j=Z=N.digest().getBytes(),Q=2,oe()}function oe(){if(Q<=_)return N.start(null,null),N.update(Z),z=N.digest().getBytes(),j=forge$c.util.xorBytes(j,z,A),Z=z,++Q,forge$c.util.setImmediate(oe);U+=X<B?j:j.substr(0,O),++X,se()}se()};var forge$b=forge$m,pem=forge$b.pem=forge$b.pem||{};pem.encode=function(n,r){r=r||{};var _="-----BEGIN "+n.type+`-----\r
`,E;if(n.procType&&(E={name:"Proc-Type",values:[String(n.procType.version),n.procType.type]},_+=foldHeader(E)),n.contentDomain&&(E={name:"Content-Domain",values:[n.contentDomain]},_+=foldHeader(E)),n.dekInfo&&(E={name:"DEK-Info",values:[n.dekInfo.algorithm]},n.dekInfo.parameters&&E.values.push(n.dekInfo.parameters),_+=foldHeader(E)),n.headers)for(var S=0;S<n.headers.length;++S)_+=foldHeader(n.headers[S]);return n.procType&&(_+=`\r
`),_+=forge$b.util.encode64(n.body,r.maxline||64)+`\r
`,_+="-----END "+n.type+`-----\r
`,_};pem.decode=function(n){for(var r=[],_=/\s*-----BEGIN ([A-Z0-9- ]+)-----\r?\n?([\x21-\x7e\s]+?(?:\r?\n\r?\n))?([:A-Za-z0-9+\/=\s]+?)-----END \1-----/g,E=/([\x21-\x7e]+):\s*([\x21-\x7e\s^:]+)/,S=/\r?\n/,C;C=_.exec(n),!!C;){var A=C[1];A==="NEW CERTIFICATE REQUEST"&&(A="CERTIFICATE REQUEST");var I={type:A,procType:null,contentDomain:null,dekInfo:null,headers:[],body:forge$b.util.decode64(C[3])};if(r.push(I),!!C[2]){for(var B=C[2].split(S),O=0;C&&O<B.length;){for(var N=B[O].replace(/\s+$/,""),U=O+1;U<B.length;++U){var j=B[U];if(!/\s/.test(j[0]))break;N+=j,O=U}if(C=N.match(E),C){for(var z={name:C[1],values:[]},Z=C[2].split(","),X=0;X<Z.length;++X)z.values.push(ltrim(Z[X]));if(I.procType)if(!I.contentDomain&&z.name==="Content-Domain")I.contentDomain=Z[0]||"";else if(!I.dekInfo&&z.name==="DEK-Info"){if(z.values.length===0)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must have at least one subfield.');I.dekInfo={algorithm:Z[0],parameters:Z[1]||null}}else I.headers.push(z);else{if(z.name!=="Proc-Type")throw new Error('Invalid PEM formatted message. The first encapsulated header must be "Proc-Type".');if(z.values.length!==2)throw new Error('Invalid PEM formatted message. The "Proc-Type" header must have two subfields.');I.procType={version:Z[0],type:Z[1]}}}++O}if(I.procType==="ENCRYPTED"&&!I.dekInfo)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must be present if "Proc-Type" is "ENCRYPTED".')}}if(r.length===0)throw new Error("Invalid PEM formatted message.");return r};function foldHeader(n){for(var r=n.name+": ",_=[],E=function(B,O){return" "+O},S=0;S<n.values.length;++S)_.push(n.values[S].replace(/^(\S+\r\n)/,E));r+=_.join(",")+`\r
`;for(var C=0,A=-1,S=0;S<r.length;++S,++C)if(C>65&&A!==-1){var I=r[A];I===","?(++A,r=r.substr(0,A)+`\r
 `+r.substr(A)):r=r.substr(0,A)+`\r
`+I+r.substr(A+1),C=S-A-1,A=-1,++S}else(r[S]===" "||r[S]==="	"||r[S]===",")&&(A=S);return r}function ltrim(n){return n.replace(/^\s+/,"")}var forge$a=forge$m,sha256$3=forge$a.sha256=forge$a.sha256||{};forge$a.md.sha256=forge$a.md.algorithms.sha256=sha256$3;sha256$3.create=function(){_initialized$2||_init$2();var n=null,r=forge$a.util.createBuffer(),_=new Array(64),E={algorithm:"sha256",blockLength:64,digestLength:32,messageLength:0,fullMessageLength:null,messageLengthSize:8};return E.start=function(){E.messageLength=0,E.fullMessageLength=E.messageLength64=[];for(var S=E.messageLengthSize/4,C=0;C<S;++C)E.fullMessageLength.push(0);return r=forge$a.util.createBuffer(),n={h0:1779033703,h1:3144134277,h2:1013904242,h3:2773480762,h4:1359893119,h5:2600822924,h6:528734635,h7:1541459225},E},E.start(),E.update=function(S,C){C==="utf8"&&(S=forge$a.util.encodeUtf8(S));var A=S.length;E.messageLength+=A,A=[A/4294967296>>>0,A>>>0];for(var I=E.fullMessageLength.length-1;I>=0;--I)E.fullMessageLength[I]+=A[1],A[1]=A[0]+(E.fullMessageLength[I]/4294967296>>>0),E.fullMessageLength[I]=E.fullMessageLength[I]>>>0,A[0]=A[1]/4294967296>>>0;return r.putBytes(S),_update$2(n,_,r),(r.read>2048||r.length()===0)&&r.compact(),E},E.digest=function(){var S=forge$a.util.createBuffer();S.putBytes(r.bytes());var C=E.fullMessageLength[E.fullMessageLength.length-1]+E.messageLengthSize,A=C&E.blockLength-1;S.putBytes(_padding$2.substr(0,E.blockLength-A));for(var I,B,O=E.fullMessageLength[0]*8,N=0;N<E.fullMessageLength.length-1;++N)I=E.fullMessageLength[N+1]*8,B=I/4294967296>>>0,O+=B,S.putInt32(O>>>0),O=I>>>0;S.putInt32(O);var U={h0:n.h0,h1:n.h1,h2:n.h2,h3:n.h3,h4:n.h4,h5:n.h5,h6:n.h6,h7:n.h7};_update$2(U,_,S);var j=forge$a.util.createBuffer();return j.putInt32(U.h0),j.putInt32(U.h1),j.putInt32(U.h2),j.putInt32(U.h3),j.putInt32(U.h4),j.putInt32(U.h5),j.putInt32(U.h6),j.putInt32(U.h7),j},E};var _padding$2=null,_initialized$2=!1,_k$1=null;function _init$2(){_padding$2="",_padding$2+=forge$a.util.fillString("\0",64),_k$1=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],_initialized$2=!0}function _update$2(n,r,_){for(var E,S,C,A,I,B,O,N,U,j,z,Z,X,Q,se,oe=_.length();oe>=64;){for(O=0;O<16;++O)r[O]=_.getInt32();for(;O<64;++O)E=r[O-2],E=(E>>>17|E<<15)^(E>>>19|E<<13)^E>>>10,S=r[O-15],S=(S>>>7|S<<25)^(S>>>18|S<<14)^S>>>3,r[O]=E+r[O-7]+S+r[O-16]|0;for(N=n.h0,U=n.h1,j=n.h2,z=n.h3,Z=n.h4,X=n.h5,Q=n.h6,se=n.h7,O=0;O<64;++O)A=(Z>>>6|Z<<26)^(Z>>>11|Z<<21)^(Z>>>25|Z<<7),I=Q^Z&(X^Q),C=(N>>>2|N<<30)^(N>>>13|N<<19)^(N>>>22|N<<10),B=N&U|j&(N^U),E=se+A+I+_k$1[O]+r[O],S=C+B,se=Q,Q=X,X=Z,Z=z+E>>>0,z=j,j=U,U=N,N=E+S>>>0;n.h0=n.h0+N|0,n.h1=n.h1+U|0,n.h2=n.h2+j|0,n.h3=n.h3+z|0,n.h4=n.h4+Z|0,n.h5=n.h5+X|0,n.h6=n.h6+Q|0,n.h7=n.h7+se|0,oe-=64}}var forge$9=forge$m,_crypto$1=null;forge$9.util.isNodejs&&!forge$9.options.usePureJavaScript&&!browser$1$1.versions["node-webkit"]&&(_crypto$1=requireCryptoBrowserify());var prng=forge$9.prng=forge$9.prng||{};prng.create=function(n){for(var r={plugin:n,key:null,seed:null,time:null,reseeds:0,generated:0,keyBytes:""},_=n.md,E=new Array(32),S=0;S<32;++S)E[S]=_.create();r.pools=E,r.pool=0,r.generate=function(O,N){if(!N)return r.generateSync(O);var U=r.plugin.cipher,j=r.plugin.increment,z=r.plugin.formatKey,Z=r.plugin.formatSeed,X=forge$9.util.createBuffer();r.key=null,Q();function Q(se){if(se)return N(se);if(X.length()>=O)return N(null,X.getBytes(O));if(r.generated>1048575&&(r.key=null),r.key===null)return forge$9.util.nextTick(function(){C(Q)});var oe=U(r.key,r.seed);r.generated+=oe.length,X.putBytes(oe),r.key=z(U(r.key,j(r.seed))),r.seed=Z(U(r.key,r.seed)),forge$9.util.setImmediate(Q)}},r.generateSync=function(O){var N=r.plugin.cipher,U=r.plugin.increment,j=r.plugin.formatKey,z=r.plugin.formatSeed;r.key=null;for(var Z=forge$9.util.createBuffer();Z.length()<O;){r.generated>1048575&&(r.key=null),r.key===null&&A();var X=N(r.key,r.seed);r.generated+=X.length,Z.putBytes(X),r.key=j(N(r.key,U(r.seed))),r.seed=z(N(r.key,r.seed))}return Z.getBytes(O)};function C(O){if(r.pools[0].messageLength>=32)return I(),O();var N=32-r.pools[0].messageLength<<5;r.seedFile(N,function(U,j){if(U)return O(U);r.collect(j),I(),O()})}function A(){if(r.pools[0].messageLength>=32)return I();var O=32-r.pools[0].messageLength<<5;r.collect(r.seedFileSync(O)),I()}function I(){r.reseeds=r.reseeds===4294967295?0:r.reseeds+1;var O=r.plugin.md.create();O.update(r.keyBytes);for(var N=1,U=0;U<32;++U)r.reseeds%N===0&&(O.update(r.pools[U].digest().getBytes()),r.pools[U].start()),N=N<<1;r.keyBytes=O.digest().getBytes(),O.start(),O.update(r.keyBytes);var j=O.digest().getBytes();r.key=r.plugin.formatKey(r.keyBytes),r.seed=r.plugin.formatSeed(j),r.generated=0}function B(O){var N=null,U=forge$9.util.globalScope,j=U.crypto||U.msCrypto;j&&j.getRandomValues&&(N=function(Te){return j.getRandomValues(Te)});var z=forge$9.util.createBuffer();if(N)for(;z.length()<O;){var Z=Math.max(1,Math.min(O-z.length(),65536)/4),X=new Uint32Array(Math.floor(Z));try{N(X);for(var Q=0;Q<X.length;++Q)z.putInt32(X[Q])}catch(Te){if(!(typeof QuotaExceededError<"u"&&Te instanceof QuotaExceededError))throw Te}}if(z.length()<O)for(var se,oe,ue,we=Math.floor(Math.random()*65536);z.length()<O;){oe=16807*(we&65535),se=16807*(we>>16),oe+=(se&32767)<<16,oe+=se>>15,oe=(oe&2147483647)+(oe>>31),we=oe&4294967295;for(var Q=0;Q<3;++Q)ue=we>>>(Q<<3),ue^=Math.floor(Math.random()*256),z.putByte(ue&255)}return z.getBytes(O)}return _crypto$1?(r.seedFile=function(O,N){_crypto$1.randomBytes(O,function(U,j){if(U)return N(U);N(null,j.toString())})},r.seedFileSync=function(O){return _crypto$1.randomBytes(O).toString()}):(r.seedFile=function(O,N){try{N(null,B(O))}catch(U){N(U)}},r.seedFileSync=B),r.collect=function(O){for(var N=O.length,U=0;U<N;++U)r.pools[r.pool].update(O.substr(U,1)),r.pool=r.pool===31?0:r.pool+1},r.collectInt=function(O,N){for(var U="",j=0;j<N;j+=8)U+=String.fromCharCode(O>>j&255);r.collect(U)},r.registerWorker=function(O){if(O===self)r.seedFile=function(U,j){function z(Z){var X=Z.data;X.forge&&X.forge.prng&&(self.removeEventListener("message",z),j(X.forge.prng.err,X.forge.prng.bytes))}self.addEventListener("message",z),self.postMessage({forge:{prng:{needed:U}}})};else{var N=function(U){var j=U.data;j.forge&&j.forge.prng&&r.seedFile(j.forge.prng.needed,function(z,Z){O.postMessage({forge:{prng:{err:z,bytes:Z}}})})};O.addEventListener("message",N)}},r};var forge$8=forge$m;(function(){if(forge$8.random&&forge$8.random.getBytes){forge$8.random;return}(function(n){var r={},_=new Array(4),E=forge$8.util.createBuffer();r.formatKey=function(U){var j=forge$8.util.createBuffer(U);return U=new Array(4),U[0]=j.getInt32(),U[1]=j.getInt32(),U[2]=j.getInt32(),U[3]=j.getInt32(),forge$8.aes._expandKey(U,!1)},r.formatSeed=function(U){var j=forge$8.util.createBuffer(U);return U=new Array(4),U[0]=j.getInt32(),U[1]=j.getInt32(),U[2]=j.getInt32(),U[3]=j.getInt32(),U},r.cipher=function(U,j){return forge$8.aes._updateBlock(U,j,_,!1),E.putInt32(_[0]),E.putInt32(_[1]),E.putInt32(_[2]),E.putInt32(_[3]),E.getBytes()},r.increment=function(U){return++U[3],U},r.md=forge$8.md.sha256;function S(){var U=forge$8.prng.create(r);return U.getBytes=function(j,z){return U.generate(j,z)},U.getBytesSync=function(j){return U.generate(j)},U}var C=S(),A=null,I=forge$8.util.globalScope,B=I.crypto||I.msCrypto;if(B&&B.getRandomValues&&(A=function(U){return B.getRandomValues(U)}),forge$8.options.usePureJavaScript||!forge$8.util.isNodejs&&!A){if(C.collectInt(+new Date,32),typeof navigator<"u"){var O="";for(var N in navigator)try{typeof navigator[N]=="string"&&(O+=navigator[N])}catch{}C.collect(O),O=null}n&&(n().mousemove(function(U){C.collectInt(U.clientX,16),C.collectInt(U.clientY,16)}),n().keypress(function(U){C.collectInt(U.charCode,8)}))}if(!forge$8.random)forge$8.random=C;else for(var N in C)forge$8.random[N]=C[N];forge$8.random.createInstance=S,forge$8.random})(typeof jQuery<"u"?jQuery:null)})();var forge$7=forge$m,piTable=[217,120,249,196,25,221,181,237,40,233,253,121,74,160,216,157,198,126,55,131,43,118,83,142,98,76,100,136,68,139,251,162,23,154,89,245,135,179,79,19,97,69,109,141,9,129,125,50,189,143,64,235,134,183,123,11,240,149,33,34,92,107,78,130,84,214,101,147,206,96,178,28,115,86,192,20,167,140,241,220,18,117,202,31,59,190,228,209,66,61,212,48,163,60,182,38,111,191,14,218,70,105,7,87,39,242,29,155,188,148,67,3,248,17,199,246,144,239,62,231,6,195,213,47,200,102,30,215,8,232,234,222,128,82,238,247,132,170,114,172,53,77,106,42,150,26,210,113,90,21,73,116,75,159,208,94,4,24,164,236,194,224,65,110,15,81,203,204,36,145,175,80,161,244,112,57,153,124,58,133,35,184,180,122,252,2,54,91,37,85,151,49,45,93,250,152,227,138,146,174,5,223,41,16,103,108,186,201,211,0,230,207,225,158,168,44,99,22,1,63,88,226,137,169,13,56,52,27,171,51,255,176,187,72,12,95,185,177,205,46,197,243,219,71,229,165,156,119,10,166,32,104,254,127,193,173],s=[1,2,3,5],rol=function(n,r){return n<<r&65535|(n&65535)>>16-r},ror=function(n,r){return(n&65535)>>r|n<<16-r&65535};forge$7.rc2=forge$7.rc2||{};forge$7.rc2.expandKey=function(n,r){typeof n=="string"&&(n=forge$7.util.createBuffer(n)),r=r||128;var _=n,E=n.length(),S=r,C=Math.ceil(S/8),A=255>>(S&7),I;for(I=E;I<128;I++)_.putByte(piTable[_.at(I-1)+_.at(I-E)&255]);for(_.setAt(128-C,piTable[_.at(128-C)&A]),I=127-C;I>=0;I--)_.setAt(I,piTable[_.at(I+1)^_.at(I+C)]);return _};var createCipher$1=function(n,r,_){var E=!1,S=null,C=null,A=null,I,B,O,N,U=[];for(n=forge$7.rc2.expandKey(n,r),O=0;O<64;O++)U.push(n.getInt16Le());_?(I=function(Z){for(O=0;O<4;O++)Z[O]+=U[N]+(Z[(O+3)%4]&Z[(O+2)%4])+(~Z[(O+3)%4]&Z[(O+1)%4]),Z[O]=rol(Z[O],s[O]),N++},B=function(Z){for(O=0;O<4;O++)Z[O]+=U[Z[(O+3)%4]&63]}):(I=function(Z){for(O=3;O>=0;O--)Z[O]=ror(Z[O],s[O]),Z[O]-=U[N]+(Z[(O+3)%4]&Z[(O+2)%4])+(~Z[(O+3)%4]&Z[(O+1)%4]),N--},B=function(Z){for(O=3;O>=0;O--)Z[O]-=U[Z[(O+3)%4]&63]});var j=function(Z){var X=[];for(O=0;O<4;O++){var Q=S.getInt16Le();A!==null&&(_?Q^=A.getInt16Le():A.putInt16Le(Q)),X.push(Q&65535)}N=_?0:63;for(var se=0;se<Z.length;se++)for(var oe=0;oe<Z[se][0];oe++)Z[se][1](X);for(O=0;O<4;O++)A!==null&&(_?A.putInt16Le(X[O]):X[O]^=A.getInt16Le()),C.putInt16Le(X[O])},z=null;return z={start:function(Z,X){Z&&typeof Z=="string"&&(Z=forge$7.util.createBuffer(Z)),E=!1,S=forge$7.util.createBuffer(),C=X||new forge$7.util.createBuffer,A=Z,z.output=C},update:function(Z){for(E||S.putBuffer(Z);S.length()>=8;)j([[5,I],[1,B],[6,I],[1,B],[5,I]])},finish:function(Z){var X=!0;if(_)if(Z)X=Z(8,S,!_);else{var Q=S.length()===8?8:8-S.length();S.fillWithByte(Q,Q)}if(X&&(E=!0,z.update()),!_&&(X=S.length()===0,X))if(Z)X=Z(8,C,!_);else{var se=C.length(),oe=C.at(se-1);oe>se?X=!1:C.truncate(oe)}return X}},z};forge$7.rc2.startEncrypting=function(n,r,_){var E=forge$7.rc2.createEncryptionCipher(n,128);return E.start(r,_),E};forge$7.rc2.createEncryptionCipher=function(n,r){return createCipher$1(n,r,!0)};forge$7.rc2.startDecrypting=function(n,r,_){var E=forge$7.rc2.createDecryptionCipher(n,128);return E.start(r,_),E};forge$7.rc2.createDecryptionCipher=function(n,r){return createCipher$1(n,r,!1)};var forge$6=forge$m;forge$6.jsbn=forge$6.jsbn||{};var dbits;function BigInteger$2(n,r,_){this.data=[],n!=null&&(typeof n=="number"?this.fromNumber(n,r,_):r==null&&typeof n!="string"?this.fromString(n,256):this.fromString(n,r))}forge$6.jsbn.BigInteger=BigInteger$2;function nbi(){return new BigInteger$2(null)}function am1(n,r,_,E,S,C){for(;--C>=0;){var A=r*this.data[n++]+_.data[E]+S;S=Math.floor(A/67108864),_.data[E++]=A&67108863}return S}function am2(n,r,_,E,S,C){for(var A=r&32767,I=r>>15;--C>=0;){var B=this.data[n]&32767,O=this.data[n++]>>15,N=I*B+O*A;B=A*B+((N&32767)<<15)+_.data[E]+(S&1073741823),S=(B>>>30)+(N>>>15)+I*O+(S>>>30),_.data[E++]=B&1073741823}return S}function am3(n,r,_,E,S,C){for(var A=r&16383,I=r>>14;--C>=0;){var B=this.data[n]&16383,O=this.data[n++]>>14,N=I*B+O*A;B=A*B+((N&16383)<<14)+_.data[E]+S,S=(B>>28)+(N>>14)+I*O,_.data[E++]=B&268435455}return S}typeof navigator>"u"?(BigInteger$2.prototype.am=am3,dbits=28):navigator.appName=="Microsoft Internet Explorer"?(BigInteger$2.prototype.am=am2,dbits=30):navigator.appName!="Netscape"?(BigInteger$2.prototype.am=am1,dbits=26):(BigInteger$2.prototype.am=am3,dbits=28);BigInteger$2.prototype.DB=dbits;BigInteger$2.prototype.DM=(1<<dbits)-1;BigInteger$2.prototype.DV=1<<dbits;var BI_FP=52;BigInteger$2.prototype.FV=Math.pow(2,BI_FP);BigInteger$2.prototype.F1=BI_FP-dbits;BigInteger$2.prototype.F2=2*dbits-BI_FP;var BI_RM="0123456789abcdefghijklmnopqrstuvwxyz",BI_RC=new Array,rr,vv;rr=48;for(vv=0;vv<=9;++vv)BI_RC[rr++]=vv;rr=97;for(vv=10;vv<36;++vv)BI_RC[rr++]=vv;rr=65;for(vv=10;vv<36;++vv)BI_RC[rr++]=vv;function int2char(n){return BI_RM.charAt(n)}function intAt(n,r){var _=BI_RC[n.charCodeAt(r)];return _??-1}function bnpCopyTo(n){for(var r=this.t-1;r>=0;--r)n.data[r]=this.data[r];n.t=this.t,n.s=this.s}function bnpFromInt(n){this.t=1,this.s=n<0?-1:0,n>0?this.data[0]=n:n<-1?this.data[0]=n+this.DV:this.t=0}function nbv(n){var r=nbi();return r.fromInt(n),r}function bnpFromString(n,r){var _;if(r==16)_=4;else if(r==8)_=3;else if(r==256)_=8;else if(r==2)_=1;else if(r==32)_=5;else if(r==4)_=2;else{this.fromRadix(n,r);return}this.t=0,this.s=0;for(var E=n.length,S=!1,C=0;--E>=0;){var A=_==8?n[E]&255:intAt(n,E);if(A<0){n.charAt(E)=="-"&&(S=!0);continue}S=!1,C==0?this.data[this.t++]=A:C+_>this.DB?(this.data[this.t-1]|=(A&(1<<this.DB-C)-1)<<C,this.data[this.t++]=A>>this.DB-C):this.data[this.t-1]|=A<<C,C+=_,C>=this.DB&&(C-=this.DB)}_==8&&n[0]&128&&(this.s=-1,C>0&&(this.data[this.t-1]|=(1<<this.DB-C)-1<<C)),this.clamp(),S&&BigInteger$2.ZERO.subTo(this,this)}function bnpClamp(){for(var n=this.s&this.DM;this.t>0&&this.data[this.t-1]==n;)--this.t}function bnToString(n){if(this.s<0)return"-"+this.negate().toString(n);var r;if(n==16)r=4;else if(n==8)r=3;else if(n==2)r=1;else if(n==32)r=5;else if(n==4)r=2;else return this.toRadix(n);var _=(1<<r)-1,E,S=!1,C="",A=this.t,I=this.DB-A*this.DB%r;if(A-- >0)for(I<this.DB&&(E=this.data[A]>>I)>0&&(S=!0,C=int2char(E));A>=0;)I<r?(E=(this.data[A]&(1<<I)-1)<<r-I,E|=this.data[--A]>>(I+=this.DB-r)):(E=this.data[A]>>(I-=r)&_,I<=0&&(I+=this.DB,--A)),E>0&&(S=!0),S&&(C+=int2char(E));return S?C:"0"}function bnNegate(){var n=nbi();return BigInteger$2.ZERO.subTo(this,n),n}function bnAbs(){return this.s<0?this.negate():this}function bnCompareTo(n){var r=this.s-n.s;if(r!=0)return r;var _=this.t;if(r=_-n.t,r!=0)return this.s<0?-r:r;for(;--_>=0;)if((r=this.data[_]-n.data[_])!=0)return r;return 0}function nbits(n){var r=1,_;return(_=n>>>16)!=0&&(n=_,r+=16),(_=n>>8)!=0&&(n=_,r+=8),(_=n>>4)!=0&&(n=_,r+=4),(_=n>>2)!=0&&(n=_,r+=2),(_=n>>1)!=0&&(n=_,r+=1),r}function bnBitLength(){return this.t<=0?0:this.DB*(this.t-1)+nbits(this.data[this.t-1]^this.s&this.DM)}function bnpDLShiftTo(n,r){var _;for(_=this.t-1;_>=0;--_)r.data[_+n]=this.data[_];for(_=n-1;_>=0;--_)r.data[_]=0;r.t=this.t+n,r.s=this.s}function bnpDRShiftTo(n,r){for(var _=n;_<this.t;++_)r.data[_-n]=this.data[_];r.t=Math.max(this.t-n,0),r.s=this.s}function bnpLShiftTo(n,r){var _=n%this.DB,E=this.DB-_,S=(1<<E)-1,C=Math.floor(n/this.DB),A=this.s<<_&this.DM,I;for(I=this.t-1;I>=0;--I)r.data[I+C+1]=this.data[I]>>E|A,A=(this.data[I]&S)<<_;for(I=C-1;I>=0;--I)r.data[I]=0;r.data[C]=A,r.t=this.t+C+1,r.s=this.s,r.clamp()}function bnpRShiftTo(n,r){r.s=this.s;var _=Math.floor(n/this.DB);if(_>=this.t){r.t=0;return}var E=n%this.DB,S=this.DB-E,C=(1<<E)-1;r.data[0]=this.data[_]>>E;for(var A=_+1;A<this.t;++A)r.data[A-_-1]|=(this.data[A]&C)<<S,r.data[A-_]=this.data[A]>>E;E>0&&(r.data[this.t-_-1]|=(this.s&C)<<S),r.t=this.t-_,r.clamp()}function bnpSubTo(n,r){for(var _=0,E=0,S=Math.min(n.t,this.t);_<S;)E+=this.data[_]-n.data[_],r.data[_++]=E&this.DM,E>>=this.DB;if(n.t<this.t){for(E-=n.s;_<this.t;)E+=this.data[_],r.data[_++]=E&this.DM,E>>=this.DB;E+=this.s}else{for(E+=this.s;_<n.t;)E-=n.data[_],r.data[_++]=E&this.DM,E>>=this.DB;E-=n.s}r.s=E<0?-1:0,E<-1?r.data[_++]=this.DV+E:E>0&&(r.data[_++]=E),r.t=_,r.clamp()}function bnpMultiplyTo(n,r){var _=this.abs(),E=n.abs(),S=_.t;for(r.t=S+E.t;--S>=0;)r.data[S]=0;for(S=0;S<E.t;++S)r.data[S+_.t]=_.am(0,E.data[S],r,S,0,_.t);r.s=0,r.clamp(),this.s!=n.s&&BigInteger$2.ZERO.subTo(r,r)}function bnpSquareTo(n){for(var r=this.abs(),_=n.t=2*r.t;--_>=0;)n.data[_]=0;for(_=0;_<r.t-1;++_){var E=r.am(_,r.data[_],n,2*_,0,1);(n.data[_+r.t]+=r.am(_+1,2*r.data[_],n,2*_+1,E,r.t-_-1))>=r.DV&&(n.data[_+r.t]-=r.DV,n.data[_+r.t+1]=1)}n.t>0&&(n.data[n.t-1]+=r.am(_,r.data[_],n,2*_,0,1)),n.s=0,n.clamp()}function bnpDivRemTo(n,r,_){var E=n.abs();if(!(E.t<=0)){var S=this.abs();if(S.t<E.t){r?.fromInt(0),_!=null&&this.copyTo(_);return}_==null&&(_=nbi());var C=nbi(),A=this.s,I=n.s,B=this.DB-nbits(E.data[E.t-1]);B>0?(E.lShiftTo(B,C),S.lShiftTo(B,_)):(E.copyTo(C),S.copyTo(_));var O=C.t,N=C.data[O-1];if(N!=0){var U=N*(1<<this.F1)+(O>1?C.data[O-2]>>this.F2:0),j=this.FV/U,z=(1<<this.F1)/U,Z=1<<this.F2,X=_.t,Q=X-O,se=r??nbi();for(C.dlShiftTo(Q,se),_.compareTo(se)>=0&&(_.data[_.t++]=1,_.subTo(se,_)),BigInteger$2.ONE.dlShiftTo(O,se),se.subTo(C,C);C.t<O;)C.data[C.t++]=0;for(;--Q>=0;){var oe=_.data[--X]==N?this.DM:Math.floor(_.data[X]*j+(_.data[X-1]+Z)*z);if((_.data[X]+=C.am(0,oe,_,Q,0,O))<oe)for(C.dlShiftTo(Q,se),_.subTo(se,_);_.data[X]<--oe;)_.subTo(se,_)}r!=null&&(_.drShiftTo(O,r),A!=I&&BigInteger$2.ZERO.subTo(r,r)),_.t=O,_.clamp(),B>0&&_.rShiftTo(B,_),A<0&&BigInteger$2.ZERO.subTo(_,_)}}}function bnMod(n){var r=nbi();return this.abs().divRemTo(n,null,r),this.s<0&&r.compareTo(BigInteger$2.ZERO)>0&&n.subTo(r,r),r}function Classic(n){this.m=n}function cConvert(n){return n.s<0||n.compareTo(this.m)>=0?n.mod(this.m):n}function cRevert(n){return n}function cReduce(n){n.divRemTo(this.m,null,n)}function cMulTo(n,r,_){n.multiplyTo(r,_),this.reduce(_)}function cSqrTo(n,r){n.squareTo(r),this.reduce(r)}Classic.prototype.convert=cConvert;Classic.prototype.revert=cRevert;Classic.prototype.reduce=cReduce;Classic.prototype.mulTo=cMulTo;Classic.prototype.sqrTo=cSqrTo;function bnpInvDigit(){if(this.t<1)return 0;var n=this.data[0];if(!(n&1))return 0;var r=n&3;return r=r*(2-(n&15)*r)&15,r=r*(2-(n&255)*r)&255,r=r*(2-((n&65535)*r&65535))&65535,r=r*(2-n*r%this.DV)%this.DV,r>0?this.DV-r:-r}function Montgomery(n){this.m=n,this.mp=n.invDigit(),this.mpl=this.mp&32767,this.mph=this.mp>>15,this.um=(1<<n.DB-15)-1,this.mt2=2*n.t}function montConvert(n){var r=nbi();return n.abs().dlShiftTo(this.m.t,r),r.divRemTo(this.m,null,r),n.s<0&&r.compareTo(BigInteger$2.ZERO)>0&&this.m.subTo(r,r),r}function montRevert(n){var r=nbi();return n.copyTo(r),this.reduce(r),r}function montReduce(n){for(;n.t<=this.mt2;)n.data[n.t++]=0;for(var r=0;r<this.m.t;++r){var _=n.data[r]&32767,E=_*this.mpl+((_*this.mph+(n.data[r]>>15)*this.mpl&this.um)<<15)&n.DM;for(_=r+this.m.t,n.data[_]+=this.m.am(0,E,n,r,0,this.m.t);n.data[_]>=n.DV;)n.data[_]-=n.DV,n.data[++_]++}n.clamp(),n.drShiftTo(this.m.t,n),n.compareTo(this.m)>=0&&n.subTo(this.m,n)}function montSqrTo(n,r){n.squareTo(r),this.reduce(r)}function montMulTo(n,r,_){n.multiplyTo(r,_),this.reduce(_)}Montgomery.prototype.convert=montConvert;Montgomery.prototype.revert=montRevert;Montgomery.prototype.reduce=montReduce;Montgomery.prototype.mulTo=montMulTo;Montgomery.prototype.sqrTo=montSqrTo;function bnpIsEven(){return(this.t>0?this.data[0]&1:this.s)==0}function bnpExp(n,r){if(n>4294967295||n<1)return BigInteger$2.ONE;var _=nbi(),E=nbi(),S=r.convert(this),C=nbits(n)-1;for(S.copyTo(_);--C>=0;)if(r.sqrTo(_,E),(n&1<<C)>0)r.mulTo(E,S,_);else{var A=_;_=E,E=A}return r.revert(_)}function bnModPowInt(n,r){var _;return n<256||r.isEven()?_=new Classic(r):_=new Montgomery(r),this.exp(n,_)}BigInteger$2.prototype.copyTo=bnpCopyTo;BigInteger$2.prototype.fromInt=bnpFromInt;BigInteger$2.prototype.fromString=bnpFromString;BigInteger$2.prototype.clamp=bnpClamp;BigInteger$2.prototype.dlShiftTo=bnpDLShiftTo;BigInteger$2.prototype.drShiftTo=bnpDRShiftTo;BigInteger$2.prototype.lShiftTo=bnpLShiftTo;BigInteger$2.prototype.rShiftTo=bnpRShiftTo;BigInteger$2.prototype.subTo=bnpSubTo;BigInteger$2.prototype.multiplyTo=bnpMultiplyTo;BigInteger$2.prototype.squareTo=bnpSquareTo;BigInteger$2.prototype.divRemTo=bnpDivRemTo;BigInteger$2.prototype.invDigit=bnpInvDigit;BigInteger$2.prototype.isEven=bnpIsEven;BigInteger$2.prototype.exp=bnpExp;BigInteger$2.prototype.toString=bnToString;BigInteger$2.prototype.negate=bnNegate;BigInteger$2.prototype.abs=bnAbs;BigInteger$2.prototype.compareTo=bnCompareTo;BigInteger$2.prototype.bitLength=bnBitLength;BigInteger$2.prototype.mod=bnMod;BigInteger$2.prototype.modPowInt=bnModPowInt;BigInteger$2.ZERO=nbv(0);BigInteger$2.ONE=nbv(1);function bnClone(){var n=nbi();return this.copyTo(n),n}function bnIntValue(){if(this.s<0){if(this.t==1)return this.data[0]-this.DV;if(this.t==0)return-1}else{if(this.t==1)return this.data[0];if(this.t==0)return 0}return(this.data[1]&(1<<32-this.DB)-1)<<this.DB|this.data[0]}function bnByteValue(){return this.t==0?this.s:this.data[0]<<24>>24}function bnShortValue(){return this.t==0?this.s:this.data[0]<<16>>16}function bnpChunkSize(n){return Math.floor(Math.LN2*this.DB/Math.log(n))}function bnSigNum(){return this.s<0?-1:this.t<=0||this.t==1&&this.data[0]<=0?0:1}function bnpToRadix(n){if(n==null&&(n=10),this.signum()==0||n<2||n>36)return"0";var r=this.chunkSize(n),_=Math.pow(n,r),E=nbv(_),S=nbi(),C=nbi(),A="";for(this.divRemTo(E,S,C);S.signum()>0;)A=(_+C.intValue()).toString(n).substr(1)+A,S.divRemTo(E,S,C);return C.intValue().toString(n)+A}function bnpFromRadix(n,r){this.fromInt(0),r==null&&(r=10);for(var _=this.chunkSize(r),E=Math.pow(r,_),S=!1,C=0,A=0,I=0;I<n.length;++I){var B=intAt(n,I);if(B<0){n.charAt(I)=="-"&&this.signum()==0&&(S=!0);continue}A=r*A+B,++C>=_&&(this.dMultiply(E),this.dAddOffset(A,0),C=0,A=0)}C>0&&(this.dMultiply(Math.pow(r,C)),this.dAddOffset(A,0)),S&&BigInteger$2.ZERO.subTo(this,this)}function bnpFromNumber(n,r,_){if(typeof r=="number")if(n<2)this.fromInt(1);else for(this.fromNumber(n,_),this.testBit(n-1)||this.bitwiseTo(BigInteger$2.ONE.shiftLeft(n-1),op_or,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(r);)this.dAddOffset(2,0),this.bitLength()>n&&this.subTo(BigInteger$2.ONE.shiftLeft(n-1),this);else{var E=new Array,S=n&7;E.length=(n>>3)+1,r.nextBytes(E),S>0?E[0]&=(1<<S)-1:E[0]=0,this.fromString(E,256)}}function bnToByteArray(){var n=this.t,r=new Array;r[0]=this.s;var _=this.DB-n*this.DB%8,E,S=0;if(n-- >0)for(_<this.DB&&(E=this.data[n]>>_)!=(this.s&this.DM)>>_&&(r[S++]=E|this.s<<this.DB-_);n>=0;)_<8?(E=(this.data[n]&(1<<_)-1)<<8-_,E|=this.data[--n]>>(_+=this.DB-8)):(E=this.data[n]>>(_-=8)&255,_<=0&&(_+=this.DB,--n)),E&128&&(E|=-256),S==0&&(this.s&128)!=(E&128)&&++S,(S>0||E!=this.s)&&(r[S++]=E);return r}function bnEquals(n){return this.compareTo(n)==0}function bnMin(n){return this.compareTo(n)<0?this:n}function bnMax(n){return this.compareTo(n)>0?this:n}function bnpBitwiseTo(n,r,_){var E,S,C=Math.min(n.t,this.t);for(E=0;E<C;++E)_.data[E]=r(this.data[E],n.data[E]);if(n.t<this.t){for(S=n.s&this.DM,E=C;E<this.t;++E)_.data[E]=r(this.data[E],S);_.t=this.t}else{for(S=this.s&this.DM,E=C;E<n.t;++E)_.data[E]=r(S,n.data[E]);_.t=n.t}_.s=r(this.s,n.s),_.clamp()}function op_and(n,r){return n&r}function bnAnd(n){var r=nbi();return this.bitwiseTo(n,op_and,r),r}function op_or(n,r){return n|r}function bnOr(n){var r=nbi();return this.bitwiseTo(n,op_or,r),r}function op_xor(n,r){return n^r}function bnXor(n){var r=nbi();return this.bitwiseTo(n,op_xor,r),r}function op_andnot(n,r){return n&~r}function bnAndNot(n){var r=nbi();return this.bitwiseTo(n,op_andnot,r),r}function bnNot(){for(var n=nbi(),r=0;r<this.t;++r)n.data[r]=this.DM&~this.data[r];return n.t=this.t,n.s=~this.s,n}function bnShiftLeft(n){var r=nbi();return n<0?this.rShiftTo(-n,r):this.lShiftTo(n,r),r}function bnShiftRight(n){var r=nbi();return n<0?this.lShiftTo(-n,r):this.rShiftTo(n,r),r}function lbit(n){if(n==0)return-1;var r=0;return n&65535||(n>>=16,r+=16),n&255||(n>>=8,r+=8),n&15||(n>>=4,r+=4),n&3||(n>>=2,r+=2),n&1||++r,r}function bnGetLowestSetBit(){for(var n=0;n<this.t;++n)if(this.data[n]!=0)return n*this.DB+lbit(this.data[n]);return this.s<0?this.t*this.DB:-1}function cbit(n){for(var r=0;n!=0;)n&=n-1,++r;return r}function bnBitCount(){for(var n=0,r=this.s&this.DM,_=0;_<this.t;++_)n+=cbit(this.data[_]^r);return n}function bnTestBit(n){var r=Math.floor(n/this.DB);return r>=this.t?this.s!=0:(this.data[r]&1<<n%this.DB)!=0}function bnpChangeBit(n,r){var _=BigInteger$2.ONE.shiftLeft(n);return this.bitwiseTo(_,r,_),_}function bnSetBit(n){return this.changeBit(n,op_or)}function bnClearBit(n){return this.changeBit(n,op_andnot)}function bnFlipBit(n){return this.changeBit(n,op_xor)}function bnpAddTo(n,r){for(var _=0,E=0,S=Math.min(n.t,this.t);_<S;)E+=this.data[_]+n.data[_],r.data[_++]=E&this.DM,E>>=this.DB;if(n.t<this.t){for(E+=n.s;_<this.t;)E+=this.data[_],r.data[_++]=E&this.DM,E>>=this.DB;E+=this.s}else{for(E+=this.s;_<n.t;)E+=n.data[_],r.data[_++]=E&this.DM,E>>=this.DB;E+=n.s}r.s=E<0?-1:0,E>0?r.data[_++]=E:E<-1&&(r.data[_++]=this.DV+E),r.t=_,r.clamp()}function bnAdd(n){var r=nbi();return this.addTo(n,r),r}function bnSubtract(n){var r=nbi();return this.subTo(n,r),r}function bnMultiply(n){var r=nbi();return this.multiplyTo(n,r),r}function bnDivide(n){var r=nbi();return this.divRemTo(n,r,null),r}function bnRemainder(n){var r=nbi();return this.divRemTo(n,null,r),r}function bnDivideAndRemainder(n){var r=nbi(),_=nbi();return this.divRemTo(n,r,_),new Array(r,_)}function bnpDMultiply(n){this.data[this.t]=this.am(0,n-1,this,0,0,this.t),++this.t,this.clamp()}function bnpDAddOffset(n,r){if(n!=0){for(;this.t<=r;)this.data[this.t++]=0;for(this.data[r]+=n;this.data[r]>=this.DV;)this.data[r]-=this.DV,++r>=this.t&&(this.data[this.t++]=0),++this.data[r]}}function NullExp(){}function nNop(n){return n}function nMulTo(n,r,_){n.multiplyTo(r,_)}function nSqrTo(n,r){n.squareTo(r)}NullExp.prototype.convert=nNop;NullExp.prototype.revert=nNop;NullExp.prototype.mulTo=nMulTo;NullExp.prototype.sqrTo=nSqrTo;function bnPow(n){return this.exp(n,new NullExp)}function bnpMultiplyLowerTo(n,r,_){var E=Math.min(this.t+n.t,r);for(_.s=0,_.t=E;E>0;)_.data[--E]=0;var S;for(S=_.t-this.t;E<S;++E)_.data[E+this.t]=this.am(0,n.data[E],_,E,0,this.t);for(S=Math.min(n.t,r);E<S;++E)this.am(0,n.data[E],_,E,0,r-E);_.clamp()}function bnpMultiplyUpperTo(n,r,_){--r;var E=_.t=this.t+n.t-r;for(_.s=0;--E>=0;)_.data[E]=0;for(E=Math.max(r-this.t,0);E<n.t;++E)_.data[this.t+E-r]=this.am(r-E,n.data[E],_,0,0,this.t+E-r);_.clamp(),_.drShiftTo(1,_)}function Barrett(n){this.r2=nbi(),this.q3=nbi(),BigInteger$2.ONE.dlShiftTo(2*n.t,this.r2),this.mu=this.r2.divide(n),this.m=n}function barrettConvert(n){if(n.s<0||n.t>2*this.m.t)return n.mod(this.m);if(n.compareTo(this.m)<0)return n;var r=nbi();return n.copyTo(r),this.reduce(r),r}function barrettRevert(n){return n}function barrettReduce(n){for(n.drShiftTo(this.m.t-1,this.r2),n.t>this.m.t+1&&(n.t=this.m.t+1,n.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);n.compareTo(this.r2)<0;)n.dAddOffset(1,this.m.t+1);for(n.subTo(this.r2,n);n.compareTo(this.m)>=0;)n.subTo(this.m,n)}function barrettSqrTo(n,r){n.squareTo(r),this.reduce(r)}function barrettMulTo(n,r,_){n.multiplyTo(r,_),this.reduce(_)}Barrett.prototype.convert=barrettConvert;Barrett.prototype.revert=barrettRevert;Barrett.prototype.reduce=barrettReduce;Barrett.prototype.mulTo=barrettMulTo;Barrett.prototype.sqrTo=barrettSqrTo;function bnModPow(n,r){var _=n.bitLength(),E,S=nbv(1),C;if(_<=0)return S;_<18?E=1:_<48?E=3:_<144?E=4:_<768?E=5:E=6,_<8?C=new Classic(r):r.isEven()?C=new Barrett(r):C=new Montgomery(r);var A=new Array,I=3,B=E-1,O=(1<<E)-1;if(A[1]=C.convert(this),E>1){var N=nbi();for(C.sqrTo(A[1],N);I<=O;)A[I]=nbi(),C.mulTo(N,A[I-2],A[I]),I+=2}var U=n.t-1,j,z=!0,Z=nbi(),X;for(_=nbits(n.data[U])-1;U>=0;){for(_>=B?j=n.data[U]>>_-B&O:(j=(n.data[U]&(1<<_+1)-1)<<B-_,U>0&&(j|=n.data[U-1]>>this.DB+_-B)),I=E;!(j&1);)j>>=1,--I;if((_-=I)<0&&(_+=this.DB,--U),z)A[j].copyTo(S),z=!1;else{for(;I>1;)C.sqrTo(S,Z),C.sqrTo(Z,S),I-=2;I>0?C.sqrTo(S,Z):(X=S,S=Z,Z=X),C.mulTo(Z,A[j],S)}for(;U>=0&&!(n.data[U]&1<<_);)C.sqrTo(S,Z),X=S,S=Z,Z=X,--_<0&&(_=this.DB-1,--U)}return C.revert(S)}function bnGCD(n){var r=this.s<0?this.negate():this.clone(),_=n.s<0?n.negate():n.clone();if(r.compareTo(_)<0){var E=r;r=_,_=E}var S=r.getLowestSetBit(),C=_.getLowestSetBit();if(C<0)return r;for(S<C&&(C=S),C>0&&(r.rShiftTo(C,r),_.rShiftTo(C,_));r.signum()>0;)(S=r.getLowestSetBit())>0&&r.rShiftTo(S,r),(S=_.getLowestSetBit())>0&&_.rShiftTo(S,_),r.compareTo(_)>=0?(r.subTo(_,r),r.rShiftTo(1,r)):(_.subTo(r,_),_.rShiftTo(1,_));return C>0&&_.lShiftTo(C,_),_}function bnpModInt(n){if(n<=0)return 0;var r=this.DV%n,_=this.s<0?n-1:0;if(this.t>0)if(r==0)_=this.data[0]%n;else for(var E=this.t-1;E>=0;--E)_=(r*_+this.data[E])%n;return _}function bnModInverse(n){var r=n.isEven();if(this.isEven()&&r||n.signum()==0)return BigInteger$2.ZERO;for(var _=n.clone(),E=this.clone(),S=nbv(1),C=nbv(0),A=nbv(0),I=nbv(1);_.signum()!=0;){for(;_.isEven();)_.rShiftTo(1,_),r?((!S.isEven()||!C.isEven())&&(S.addTo(this,S),C.subTo(n,C)),S.rShiftTo(1,S)):C.isEven()||C.subTo(n,C),C.rShiftTo(1,C);for(;E.isEven();)E.rShiftTo(1,E),r?((!A.isEven()||!I.isEven())&&(A.addTo(this,A),I.subTo(n,I)),A.rShiftTo(1,A)):I.isEven()||I.subTo(n,I),I.rShiftTo(1,I);_.compareTo(E)>=0?(_.subTo(E,_),r&&S.subTo(A,S),C.subTo(I,C)):(E.subTo(_,E),r&&A.subTo(S,A),I.subTo(C,I))}if(E.compareTo(BigInteger$2.ONE)!=0)return BigInteger$2.ZERO;if(I.compareTo(n)>=0)return I.subtract(n);if(I.signum()<0)I.addTo(n,I);else return I;return I.signum()<0?I.add(n):I}var lowprimes=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509],lplim=(1<<26)/lowprimes[lowprimes.length-1];function bnIsProbablePrime(n){var r,_=this.abs();if(_.t==1&&_.data[0]<=lowprimes[lowprimes.length-1]){for(r=0;r<lowprimes.length;++r)if(_.data[0]==lowprimes[r])return!0;return!1}if(_.isEven())return!1;for(r=1;r<lowprimes.length;){for(var E=lowprimes[r],S=r+1;S<lowprimes.length&&E<lplim;)E*=lowprimes[S++];for(E=_.modInt(E);r<S;)if(E%lowprimes[r++]==0)return!1}return _.millerRabin(n)}function bnpMillerRabin(n){var r=this.subtract(BigInteger$2.ONE),_=r.getLowestSetBit();if(_<=0)return!1;for(var E=r.shiftRight(_),S=bnGetPrng(),C,A=0;A<n;++A){do C=new BigInteger$2(this.bitLength(),S);while(C.compareTo(BigInteger$2.ONE)<=0||C.compareTo(r)>=0);var I=C.modPow(E,this);if(I.compareTo(BigInteger$2.ONE)!=0&&I.compareTo(r)!=0){for(var B=1;B++<_&&I.compareTo(r)!=0;)if(I=I.modPowInt(2,this),I.compareTo(BigInteger$2.ONE)==0)return!1;if(I.compareTo(r)!=0)return!1}}return!0}function bnGetPrng(){return{nextBytes:function(n){for(var r=0;r<n.length;++r)n[r]=Math.floor(Math.random()*256)}}}BigInteger$2.prototype.chunkSize=bnpChunkSize;BigInteger$2.prototype.toRadix=bnpToRadix;BigInteger$2.prototype.fromRadix=bnpFromRadix;BigInteger$2.prototype.fromNumber=bnpFromNumber;BigInteger$2.prototype.bitwiseTo=bnpBitwiseTo;BigInteger$2.prototype.changeBit=bnpChangeBit;BigInteger$2.prototype.addTo=bnpAddTo;BigInteger$2.prototype.dMultiply=bnpDMultiply;BigInteger$2.prototype.dAddOffset=bnpDAddOffset;BigInteger$2.prototype.multiplyLowerTo=bnpMultiplyLowerTo;BigInteger$2.prototype.multiplyUpperTo=bnpMultiplyUpperTo;BigInteger$2.prototype.modInt=bnpModInt;BigInteger$2.prototype.millerRabin=bnpMillerRabin;BigInteger$2.prototype.clone=bnClone;BigInteger$2.prototype.intValue=bnIntValue;BigInteger$2.prototype.byteValue=bnByteValue;BigInteger$2.prototype.shortValue=bnShortValue;BigInteger$2.prototype.signum=bnSigNum;BigInteger$2.prototype.toByteArray=bnToByteArray;BigInteger$2.prototype.equals=bnEquals;BigInteger$2.prototype.min=bnMin;BigInteger$2.prototype.max=bnMax;BigInteger$2.prototype.and=bnAnd;BigInteger$2.prototype.or=bnOr;BigInteger$2.prototype.xor=bnXor;BigInteger$2.prototype.andNot=bnAndNot;BigInteger$2.prototype.not=bnNot;BigInteger$2.prototype.shiftLeft=bnShiftLeft;BigInteger$2.prototype.shiftRight=bnShiftRight;BigInteger$2.prototype.getLowestSetBit=bnGetLowestSetBit;BigInteger$2.prototype.bitCount=bnBitCount;BigInteger$2.prototype.testBit=bnTestBit;BigInteger$2.prototype.setBit=bnSetBit;BigInteger$2.prototype.clearBit=bnClearBit;BigInteger$2.prototype.flipBit=bnFlipBit;BigInteger$2.prototype.add=bnAdd;BigInteger$2.prototype.subtract=bnSubtract;BigInteger$2.prototype.multiply=bnMultiply;BigInteger$2.prototype.divide=bnDivide;BigInteger$2.prototype.remainder=bnRemainder;BigInteger$2.prototype.divideAndRemainder=bnDivideAndRemainder;BigInteger$2.prototype.modPow=bnModPow;BigInteger$2.prototype.modInverse=bnModInverse;BigInteger$2.prototype.pow=bnPow;BigInteger$2.prototype.gcd=bnGCD;BigInteger$2.prototype.isProbablePrime=bnIsProbablePrime;var forge$5=forge$m,sha1$1=forge$5.sha1=forge$5.sha1||{};forge$5.md.sha1=forge$5.md.algorithms.sha1=sha1$1;sha1$1.create=function(){_initialized$1||_init$1();var n=null,r=forge$5.util.createBuffer(),_=new Array(80),E={algorithm:"sha1",blockLength:64,digestLength:20,messageLength:0,fullMessageLength:null,messageLengthSize:8};return E.start=function(){E.messageLength=0,E.fullMessageLength=E.messageLength64=[];for(var S=E.messageLengthSize/4,C=0;C<S;++C)E.fullMessageLength.push(0);return r=forge$5.util.createBuffer(),n={h0:1732584193,h1:4023233417,h2:2562383102,h3:271733878,h4:3285377520},E},E.start(),E.update=function(S,C){C==="utf8"&&(S=forge$5.util.encodeUtf8(S));var A=S.length;E.messageLength+=A,A=[A/4294967296>>>0,A>>>0];for(var I=E.fullMessageLength.length-1;I>=0;--I)E.fullMessageLength[I]+=A[1],A[1]=A[0]+(E.fullMessageLength[I]/4294967296>>>0),E.fullMessageLength[I]=E.fullMessageLength[I]>>>0,A[0]=A[1]/4294967296>>>0;return r.putBytes(S),_update$1(n,_,r),(r.read>2048||r.length()===0)&&r.compact(),E},E.digest=function(){var S=forge$5.util.createBuffer();S.putBytes(r.bytes());var C=E.fullMessageLength[E.fullMessageLength.length-1]+E.messageLengthSize,A=C&E.blockLength-1;S.putBytes(_padding$1.substr(0,E.blockLength-A));for(var I,B,O=E.fullMessageLength[0]*8,N=0;N<E.fullMessageLength.length-1;++N)I=E.fullMessageLength[N+1]*8,B=I/4294967296>>>0,O+=B,S.putInt32(O>>>0),O=I>>>0;S.putInt32(O);var U={h0:n.h0,h1:n.h1,h2:n.h2,h3:n.h3,h4:n.h4};_update$1(U,_,S);var j=forge$5.util.createBuffer();return j.putInt32(U.h0),j.putInt32(U.h1),j.putInt32(U.h2),j.putInt32(U.h3),j.putInt32(U.h4),j},E};var _padding$1=null,_initialized$1=!1;function _init$1(){_padding$1="",_padding$1+=forge$5.util.fillString("\0",64),_initialized$1=!0}function _update$1(n,r,_){for(var E,S,C,A,I,B,O,N,U=_.length();U>=64;){for(S=n.h0,C=n.h1,A=n.h2,I=n.h3,B=n.h4,N=0;N<16;++N)E=_.getInt32(),r[N]=E,O=I^C&(A^I),E=(S<<5|S>>>27)+O+B+1518500249+E,B=I,I=A,A=(C<<30|C>>>2)>>>0,C=S,S=E;for(;N<20;++N)E=r[N-3]^r[N-8]^r[N-14]^r[N-16],E=E<<1|E>>>31,r[N]=E,O=I^C&(A^I),E=(S<<5|S>>>27)+O+B+1518500249+E,B=I,I=A,A=(C<<30|C>>>2)>>>0,C=S,S=E;for(;N<32;++N)E=r[N-3]^r[N-8]^r[N-14]^r[N-16],E=E<<1|E>>>31,r[N]=E,O=C^A^I,E=(S<<5|S>>>27)+O+B+1859775393+E,B=I,I=A,A=(C<<30|C>>>2)>>>0,C=S,S=E;for(;N<40;++N)E=r[N-6]^r[N-16]^r[N-28]^r[N-32],E=E<<2|E>>>30,r[N]=E,O=C^A^I,E=(S<<5|S>>>27)+O+B+1859775393+E,B=I,I=A,A=(C<<30|C>>>2)>>>0,C=S,S=E;for(;N<60;++N)E=r[N-6]^r[N-16]^r[N-28]^r[N-32],E=E<<2|E>>>30,r[N]=E,O=C&A|I&(C^A),E=(S<<5|S>>>27)+O+B+2400959708+E,B=I,I=A,A=(C<<30|C>>>2)>>>0,C=S,S=E;for(;N<80;++N)E=r[N-6]^r[N-16]^r[N-28]^r[N-32],E=E<<2|E>>>30,r[N]=E,O=C^A^I,E=(S<<5|S>>>27)+O+B+3395469782+E,B=I,I=A,A=(C<<30|C>>>2)>>>0,C=S,S=E;n.h0=n.h0+S|0,n.h1=n.h1+C|0,n.h2=n.h2+A|0,n.h3=n.h3+I|0,n.h4=n.h4+B|0,U-=64}}var forge$4=forge$m,pkcs1=forge$4.pkcs1=forge$4.pkcs1||{};pkcs1.encode_rsa_oaep=function(n,r,_){var E,S,C,A;typeof _=="string"?(E=_,S=arguments[3]||void 0,C=arguments[4]||void 0):_&&(E=_.label||void 0,S=_.seed||void 0,C=_.md||void 0,_.mgf1&&_.mgf1.md&&(A=_.mgf1.md)),C?C.start():C=forge$4.md.sha1.create(),A||(A=C);var I=Math.ceil(n.n.bitLength()/8),B=I-2*C.digestLength-2;if(r.length>B){var O=new Error("RSAES-OAEP input message length is too long.");throw O.length=r.length,O.maxLength=B,O}E||(E=""),C.update(E,"raw");for(var N=C.digest(),U="",j=B-r.length,z=0;z<j;z++)U+="\0";var Z=N.getBytes()+U+""+r;if(!S)S=forge$4.random.getBytes(C.digestLength);else if(S.length!==C.digestLength){var O=new Error("Invalid RSAES-OAEP seed. The seed length must match the digest length.");throw O.seedLength=S.length,O.digestLength=C.digestLength,O}var X=rsa_mgf1(S,I-C.digestLength-1,A),Q=forge$4.util.xorBytes(Z,X,Z.length),se=rsa_mgf1(Q,C.digestLength,A),oe=forge$4.util.xorBytes(S,se,S.length);return"\0"+oe+Q};pkcs1.decode_rsa_oaep=function(n,r,_){var E,S,C;typeof _=="string"?(E=_,S=arguments[3]||void 0):_&&(E=_.label||void 0,S=_.md||void 0,_.mgf1&&_.mgf1.md&&(C=_.mgf1.md));var A=Math.ceil(n.n.bitLength()/8);if(r.length!==A){var Q=new Error("RSAES-OAEP encoded message length is invalid.");throw Q.length=r.length,Q.expectedLength=A,Q}if(S===void 0?S=forge$4.md.sha1.create():S.start(),C||(C=S),A<2*S.digestLength+2)throw new Error("RSAES-OAEP key is too short for the hash function.");E||(E=""),S.update(E,"raw");for(var I=S.digest().getBytes(),B=r.charAt(0),O=r.substring(1,S.digestLength+1),N=r.substring(1+S.digestLength),U=rsa_mgf1(N,S.digestLength,C),j=forge$4.util.xorBytes(O,U,O.length),z=rsa_mgf1(j,A-S.digestLength-1,C),Z=forge$4.util.xorBytes(N,z,N.length),X=Z.substring(0,S.digestLength),Q=B!=="\0",se=0;se<S.digestLength;++se)Q|=I.charAt(se)!==X.charAt(se);for(var oe=1,ue=S.digestLength,we=S.digestLength;we<Z.length;we++){var Te=Z.charCodeAt(we),xe=Te&1^1,Re=oe?65534:0;Q|=Te&Re,oe=oe&xe,ue+=oe}if(Q||Z.charCodeAt(ue)!==1)throw new Error("Invalid RSAES-OAEP padding.");return Z.substring(ue+1)};function rsa_mgf1(n,r,_){_||(_=forge$4.md.sha1.create());for(var E="",S=Math.ceil(r/_.digestLength),C=0;C<S;++C){var A=String.fromCharCode(C>>24&255,C>>16&255,C>>8&255,C&255);_.start(),_.update(n+A),E+=_.digest().getBytes()}return E.substring(0,r)}var forge$3=forge$m;(function(){if(forge$3.prime){forge$3.prime;return}var n=forge$3.prime=forge$3.prime||{},r=forge$3.jsbn.BigInteger,_=[6,4,2,4,2,4,6,2],E=new r(null);E.fromInt(30);var S=function(U,j){return U|j};n.generateProbablePrime=function(U,j,z){typeof j=="function"&&(z=j,j={}),j=j||{};var Z=j.algorithm||"PRIMEINC";typeof Z=="string"&&(Z={name:Z}),Z.options=Z.options||{};var X=j.prng||forge$3.random,Q={nextBytes:function(se){for(var oe=X.getBytesSync(se.length),ue=0;ue<se.length;++ue)se[ue]=oe.charCodeAt(ue)}};if(Z.name==="PRIMEINC")return C(U,Q,Z.options,z);throw new Error("Invalid prime generation algorithm: "+Z.name)};function C(U,j,z,Z){return"workers"in z?B(U,j,z,Z):A(U,j,z,Z)}function A(U,j,z,Z){var X=O(U,j),Q=0,se=N(X.bitLength());"millerRabinTests"in z&&(se=z.millerRabinTests);var oe=10;"maxBlockTime"in z&&(oe=z.maxBlockTime),I(X,U,j,Q,se,oe,Z)}function I(U,j,z,Z,X,Q,se){var oe=+new Date;do{if(U.bitLength()>j&&(U=O(j,z)),U.isProbablePrime(X))return se(null,U);U.dAddOffset(_[Z++%8],0)}while(Q<0||+new Date-oe<Q);forge$3.util.setImmediate(function(){I(U,j,z,Z,X,Q,se)})}function B(U,j,z,Z){if(typeof Worker>"u")return A(U,j,z,Z);var X=O(U,j),Q=z.workers,se=z.workLoad||100,oe=se*30/8,ue=z.workerScript||"forge/prime.worker.js";if(Q===-1)return forge$3.util.estimateCores(function(Te,xe){Te&&(xe=2),Q=xe-1,we()});we();function we(){Q=Math.max(1,Q);for(var Te=[],xe=0;xe<Q;++xe)Te[xe]=new Worker(ue);for(var xe=0;xe<Q;++xe)Te[xe].addEventListener("message",Ne);var Re=!1;function Ne(Fe){if(!Re){var ht=Fe.data;if(ht.found){for(var nt=0;nt<Te.length;++nt)Te[nt].terminate();return Re=!0,Z(null,new r(ht.prime,16))}X.bitLength()>U&&(X=O(U,j));var Ee=X.toString(16);Fe.target.postMessage({hex:Ee,workLoad:se}),X.dAddOffset(oe,0)}}}}function O(U,j){var z=new r(U,j),Z=U-1;return z.testBit(Z)||z.bitwiseTo(r.ONE.shiftLeft(Z),S,z),z.dAddOffset(31-z.mod(E).byteValue(),0),z}function N(U){return U<=100?27:U<=150?18:U<=200?15:U<=250?12:U<=300?9:U<=350?8:U<=400?7:U<=500?6:U<=600?5:U<=800?4:U<=1250?3:2}})();var forge$2=forge$m;if(typeof BigInteger$1>"u")var BigInteger$1=forge$2.jsbn.BigInteger;var _crypto=forge$2.util.isNodejs?requireCryptoBrowserify():null,asn1$1=forge$2.asn1,util$2=forge$2.util;forge$2.pki=forge$2.pki||{};forge$2.pki.rsa=forge$2.rsa=forge$2.rsa||{};var pki$1=forge$2.pki,GCD_30_DELTA=[6,4,2,4,2,4,6,2],privateKeyValidator={name:"PrivateKeyInfo",tagClass:asn1$1.Class.UNIVERSAL,type:asn1$1.Type.SEQUENCE,constructed:!0,value:[{name:"PrivateKeyInfo.version",tagClass:asn1$1.Class.UNIVERSAL,type:asn1$1.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"PrivateKeyInfo.privateKeyAlgorithm",tagClass:asn1$1.Class.UNIVERSAL,type:asn1$1.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:asn1$1.Class.UNIVERSAL,type:asn1$1.Type.OID,constructed:!1,capture:"privateKeyOid"}]},{name:"PrivateKeyInfo",tagClass:asn1$1.Class.UNIVERSAL,type:asn1$1.Type.OCTETSTRING,constructed:!1,capture:"privateKey"}]},rsaPrivateKeyValidator={name:"RSAPrivateKey",tagClass:asn1$1.Class.UNIVERSAL,type:asn1$1.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPrivateKey.version",tagClass:asn1$1.Class.UNIVERSAL,type:asn1$1.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"RSAPrivateKey.modulus",tagClass:asn1$1.Class.UNIVERSAL,type:asn1$1.Type.INTEGER,constructed:!1,capture:"privateKeyModulus"},{name:"RSAPrivateKey.publicExponent",tagClass:asn1$1.Class.UNIVERSAL,type:asn1$1.Type.INTEGER,constructed:!1,capture:"privateKeyPublicExponent"},{name:"RSAPrivateKey.privateExponent",tagClass:asn1$1.Class.UNIVERSAL,type:asn1$1.Type.INTEGER,constructed:!1,capture:"privateKeyPrivateExponent"},{name:"RSAPrivateKey.prime1",tagClass:asn1$1.Class.UNIVERSAL,type:asn1$1.Type.INTEGER,constructed:!1,capture:"privateKeyPrime1"},{name:"RSAPrivateKey.prime2",tagClass:asn1$1.Class.UNIVERSAL,type:asn1$1.Type.INTEGER,constructed:!1,capture:"privateKeyPrime2"},{name:"RSAPrivateKey.exponent1",tagClass:asn1$1.Class.UNIVERSAL,type:asn1$1.Type.INTEGER,constructed:!1,capture:"privateKeyExponent1"},{name:"RSAPrivateKey.exponent2",tagClass:asn1$1.Class.UNIVERSAL,type:asn1$1.Type.INTEGER,constructed:!1,capture:"privateKeyExponent2"},{name:"RSAPrivateKey.coefficient",tagClass:asn1$1.Class.UNIVERSAL,type:asn1$1.Type.INTEGER,constructed:!1,capture:"privateKeyCoefficient"}]},rsaPublicKeyValidator={name:"RSAPublicKey",tagClass:asn1$1.Class.UNIVERSAL,type:asn1$1.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPublicKey.modulus",tagClass:asn1$1.Class.UNIVERSAL,type:asn1$1.Type.INTEGER,constructed:!1,capture:"publicKeyModulus"},{name:"RSAPublicKey.exponent",tagClass:asn1$1.Class.UNIVERSAL,type:asn1$1.Type.INTEGER,constructed:!1,capture:"publicKeyExponent"}]},publicKeyValidator=forge$2.pki.rsa.publicKeyValidator={name:"SubjectPublicKeyInfo",tagClass:asn1$1.Class.UNIVERSAL,type:asn1$1.Type.SEQUENCE,constructed:!0,captureAsn1:"subjectPublicKeyInfo",value:[{name:"SubjectPublicKeyInfo.AlgorithmIdentifier",tagClass:asn1$1.Class.UNIVERSAL,type:asn1$1.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:asn1$1.Class.UNIVERSAL,type:asn1$1.Type.OID,constructed:!1,capture:"publicKeyOid"}]},{name:"SubjectPublicKeyInfo.subjectPublicKey",tagClass:asn1$1.Class.UNIVERSAL,type:asn1$1.Type.BITSTRING,constructed:!1,value:[{name:"SubjectPublicKeyInfo.subjectPublicKey.RSAPublicKey",tagClass:asn1$1.Class.UNIVERSAL,type:asn1$1.Type.SEQUENCE,constructed:!0,optional:!0,captureAsn1:"rsaPublicKey"}]}]},digestInfoValidator={name:"DigestInfo",tagClass:asn1$1.Class.UNIVERSAL,type:asn1$1.Type.SEQUENCE,constructed:!0,value:[{name:"DigestInfo.DigestAlgorithm",tagClass:asn1$1.Class.UNIVERSAL,type:asn1$1.Type.SEQUENCE,constructed:!0,value:[{name:"DigestInfo.DigestAlgorithm.algorithmIdentifier",tagClass:asn1$1.Class.UNIVERSAL,type:asn1$1.Type.OID,constructed:!1,capture:"algorithmIdentifier"},{name:"DigestInfo.DigestAlgorithm.parameters",tagClass:asn1$1.Class.UNIVERSAL,type:asn1$1.Type.NULL,capture:"parameters",optional:!0,constructed:!1}]},{name:"DigestInfo.digest",tagClass:asn1$1.Class.UNIVERSAL,type:asn1$1.Type.OCTETSTRING,constructed:!1,capture:"digest"}]},emsaPkcs1v15encode=function(n){var r;if(n.algorithm in pki$1.oids)r=pki$1.oids[n.algorithm];else{var _=new Error("Unknown message digest algorithm.");throw _.algorithm=n.algorithm,_}var E=asn1$1.oidToDer(r).getBytes(),S=asn1$1.create(asn1$1.Class.UNIVERSAL,asn1$1.Type.SEQUENCE,!0,[]),C=asn1$1.create(asn1$1.Class.UNIVERSAL,asn1$1.Type.SEQUENCE,!0,[]);C.value.push(asn1$1.create(asn1$1.Class.UNIVERSAL,asn1$1.Type.OID,!1,E)),C.value.push(asn1$1.create(asn1$1.Class.UNIVERSAL,asn1$1.Type.NULL,!1,""));var A=asn1$1.create(asn1$1.Class.UNIVERSAL,asn1$1.Type.OCTETSTRING,!1,n.digest().getBytes());return S.value.push(C),S.value.push(A),asn1$1.toDer(S).getBytes()},_modPow=function(n,r,_){if(_)return n.modPow(r.e,r.n);if(!r.p||!r.q)return n.modPow(r.d,r.n);r.dP||(r.dP=r.d.mod(r.p.subtract(BigInteger$1.ONE))),r.dQ||(r.dQ=r.d.mod(r.q.subtract(BigInteger$1.ONE))),r.qInv||(r.qInv=r.q.modInverse(r.p));var E;do E=new BigInteger$1(forge$2.util.bytesToHex(forge$2.random.getBytes(r.n.bitLength()/8)),16);while(E.compareTo(r.n)>=0||!E.gcd(r.n).equals(BigInteger$1.ONE));n=n.multiply(E.modPow(r.e,r.n)).mod(r.n);for(var S=n.mod(r.p).modPow(r.dP,r.p),C=n.mod(r.q).modPow(r.dQ,r.q);S.compareTo(C)<0;)S=S.add(r.p);var A=S.subtract(C).multiply(r.qInv).mod(r.p).multiply(r.q).add(C);return A=A.multiply(E.modInverse(r.n)).mod(r.n),A};pki$1.rsa.encrypt=function(n,r,_){var E=_,S,C=Math.ceil(r.n.bitLength()/8);_!==!1&&_!==!0?(E=_===2,S=_encodePkcs1_v1_5(n,r,_)):(S=forge$2.util.createBuffer(),S.putBytes(n));for(var A=new BigInteger$1(S.toHex(),16),I=_modPow(A,r,E),B=I.toString(16),O=forge$2.util.createBuffer(),N=C-Math.ceil(B.length/2);N>0;)O.putByte(0),--N;return O.putBytes(forge$2.util.hexToBytes(B)),O.getBytes()};pki$1.rsa.decrypt=function(n,r,_,E){var S=Math.ceil(r.n.bitLength()/8);if(n.length!==S){var C=new Error("Encrypted message length is invalid.");throw C.length=n.length,C.expected=S,C}var A=new BigInteger$1(forge$2.util.createBuffer(n).toHex(),16);if(A.compareTo(r.n)>=0)throw new Error("Encrypted message is invalid.");for(var I=_modPow(A,r,_),B=I.toString(16),O=forge$2.util.createBuffer(),N=S-Math.ceil(B.length/2);N>0;)O.putByte(0),--N;return O.putBytes(forge$2.util.hexToBytes(B)),E!==!1?_decodePkcs1_v1_5(O.getBytes(),r,_):O.getBytes()};pki$1.rsa.createKeyPairGenerationState=function(n,r,_){typeof n=="string"&&(n=parseInt(n,10)),n=n||2048,_=_||{};var E=_.prng||forge$2.random,S={nextBytes:function(I){for(var B=E.getBytesSync(I.length),O=0;O<I.length;++O)I[O]=B.charCodeAt(O)}},C=_.algorithm||"PRIMEINC",A;if(C==="PRIMEINC")A={algorithm:C,state:0,bits:n,rng:S,eInt:r||65537,e:new BigInteger$1(null),p:null,q:null,qBits:n>>1,pBits:n-(n>>1),pqState:0,num:null,keys:null},A.e.fromInt(A.eInt);else throw new Error("Invalid key generation algorithm: "+C);return A};pki$1.rsa.stepKeyPairGenerationState=function(n,r){"algorithm"in n||(n.algorithm="PRIMEINC");var _=new BigInteger$1(null);_.fromInt(30);for(var E=0,S=function(U,j){return U|j},C=+new Date,A,I=0;n.keys===null&&(r<=0||I<r);){if(n.state===0){var B=n.p===null?n.pBits:n.qBits,O=B-1;n.pqState===0?(n.num=new BigInteger$1(B,n.rng),n.num.testBit(O)||n.num.bitwiseTo(BigInteger$1.ONE.shiftLeft(O),S,n.num),n.num.dAddOffset(31-n.num.mod(_).byteValue(),0),E=0,++n.pqState):n.pqState===1?n.num.bitLength()>B?n.pqState=0:n.num.isProbablePrime(_getMillerRabinTests(n.num.bitLength()))?++n.pqState:n.num.dAddOffset(GCD_30_DELTA[E++%8],0):n.pqState===2?n.pqState=n.num.subtract(BigInteger$1.ONE).gcd(n.e).compareTo(BigInteger$1.ONE)===0?3:0:n.pqState===3&&(n.pqState=0,n.p===null?n.p=n.num:n.q=n.num,n.p!==null&&n.q!==null&&++n.state,n.num=null)}else if(n.state===1)n.p.compareTo(n.q)<0&&(n.num=n.p,n.p=n.q,n.q=n.num),++n.state;else if(n.state===2)n.p1=n.p.subtract(BigInteger$1.ONE),n.q1=n.q.subtract(BigInteger$1.ONE),n.phi=n.p1.multiply(n.q1),++n.state;else if(n.state===3)n.phi.gcd(n.e).compareTo(BigInteger$1.ONE)===0?++n.state:(n.p=null,n.q=null,n.state=0);else if(n.state===4)n.n=n.p.multiply(n.q),n.n.bitLength()===n.bits?++n.state:(n.q=null,n.state=0);else if(n.state===5){var N=n.e.modInverse(n.phi);n.keys={privateKey:pki$1.rsa.setPrivateKey(n.n,n.e,N,n.p,n.q,N.mod(n.p1),N.mod(n.q1),n.q.modInverse(n.p)),publicKey:pki$1.rsa.setPublicKey(n.n,n.e)}}A=+new Date,I+=A-C,C=A}return n.keys!==null};pki$1.rsa.generateKeyPair=function(n,r,_,E){if(arguments.length===1?typeof n=="object"?(_=n,n=void 0):typeof n=="function"&&(E=n,n=void 0):arguments.length===2?typeof n=="number"?typeof r=="function"?(E=r,r=void 0):typeof r!="number"&&(_=r,r=void 0):(_=n,E=r,n=void 0,r=void 0):arguments.length===3&&(typeof r=="number"?typeof _=="function"&&(E=_,_=void 0):(E=_,_=r,r=void 0)),_=_||{},n===void 0&&(n=_.bits||2048),r===void 0&&(r=_.e||65537),!forge$2.options.usePureJavaScript&&!_.prng&&n>=256&&n<=16384&&(r===65537||r===3)){if(E){if(_detectNodeCrypto("generateKeyPair"))return _crypto.generateKeyPair("rsa",{modulusLength:n,publicExponent:r,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}},function(I,B,O){if(I)return E(I);E(null,{privateKey:pki$1.privateKeyFromPem(O),publicKey:pki$1.publicKeyFromPem(B)})});if(_detectSubtleCrypto("generateKey")&&_detectSubtleCrypto("exportKey"))return util$2.globalScope.crypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:n,publicExponent:_intToUint8Array(r),hash:{name:"SHA-256"}},!0,["sign","verify"]).then(function(I){return util$2.globalScope.crypto.subtle.exportKey("pkcs8",I.privateKey)}).then(void 0,function(I){E(I)}).then(function(I){if(I){var B=pki$1.privateKeyFromAsn1(asn1$1.fromDer(forge$2.util.createBuffer(I)));E(null,{privateKey:B,publicKey:pki$1.setRsaPublicKey(B.n,B.e)})}});if(_detectSubtleMsCrypto("generateKey")&&_detectSubtleMsCrypto("exportKey")){var S=util$2.globalScope.msCrypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:n,publicExponent:_intToUint8Array(r),hash:{name:"SHA-256"}},!0,["sign","verify"]);S.oncomplete=function(I){var B=I.target.result,O=util$2.globalScope.msCrypto.subtle.exportKey("pkcs8",B.privateKey);O.oncomplete=function(N){var U=N.target.result,j=pki$1.privateKeyFromAsn1(asn1$1.fromDer(forge$2.util.createBuffer(U)));E(null,{privateKey:j,publicKey:pki$1.setRsaPublicKey(j.n,j.e)})},O.onerror=function(N){E(N)}},S.onerror=function(I){E(I)};return}}else if(_detectNodeCrypto("generateKeyPairSync")){var C=_crypto.generateKeyPairSync("rsa",{modulusLength:n,publicExponent:r,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}});return{privateKey:pki$1.privateKeyFromPem(C.privateKey),publicKey:pki$1.publicKeyFromPem(C.publicKey)}}}var A=pki$1.rsa.createKeyPairGenerationState(n,r,_);if(!E)return pki$1.rsa.stepKeyPairGenerationState(A,0),A.keys;_generateKeyPair(A,_,E)};pki$1.setRsaPublicKey=pki$1.rsa.setPublicKey=function(n,r){var _={n,e:r};return _.encrypt=function(E,S,C){if(typeof S=="string"?S=S.toUpperCase():S===void 0&&(S="RSAES-PKCS1-V1_5"),S==="RSAES-PKCS1-V1_5")S={encode:function(I,B,O){return _encodePkcs1_v1_5(I,B,2).getBytes()}};else if(S==="RSA-OAEP"||S==="RSAES-OAEP")S={encode:function(I,B){return forge$2.pkcs1.encode_rsa_oaep(B,I,C)}};else if(["RAW","NONE","NULL",null].indexOf(S)!==-1)S={encode:function(I){return I}};else if(typeof S=="string")throw new Error('Unsupported encryption scheme: "'+S+'".');var A=S.encode(E,_,!0);return pki$1.rsa.encrypt(A,_,!0)},_.verify=function(E,S,C,A){typeof C=="string"?C=C.toUpperCase():C===void 0&&(C="RSASSA-PKCS1-V1_5"),A===void 0&&(A={_parseAllDigestBytes:!0}),"_parseAllDigestBytes"in A||(A._parseAllDigestBytes=!0),C==="RSASSA-PKCS1-V1_5"?C={verify:function(B,O){O=_decodePkcs1_v1_5(O,_,!0);var N=asn1$1.fromDer(O,{parseAllBytes:A._parseAllDigestBytes}),U={},j=[];if(!asn1$1.validate(N,digestInfoValidator,U,j)){var z=new Error("ASN.1 object does not contain a valid RSASSA-PKCS1-v1_5 DigestInfo value.");throw z.errors=j,z}var Z=asn1$1.derToOid(U.algorithmIdentifier);if(!(Z===forge$2.oids.md2||Z===forge$2.oids.md5||Z===forge$2.oids.sha1||Z===forge$2.oids.sha224||Z===forge$2.oids.sha256||Z===forge$2.oids.sha384||Z===forge$2.oids.sha512||Z===forge$2.oids["sha512-224"]||Z===forge$2.oids["sha512-256"])){var z=new Error("Unknown RSASSA-PKCS1-v1_5 DigestAlgorithm identifier.");throw z.oid=Z,z}if((Z===forge$2.oids.md2||Z===forge$2.oids.md5)&&!("parameters"in U))throw new Error("ASN.1 object does not contain a valid RSASSA-PKCS1-v1_5 DigestInfo value. Missing algorithm identifer NULL parameters.");return B===U.digest}}:(C==="NONE"||C==="NULL"||C===null)&&(C={verify:function(B,O){return O=_decodePkcs1_v1_5(O,_,!0),B===O}});var I=pki$1.rsa.decrypt(S,_,!0,!1);return C.verify(E,I,_.n.bitLength())},_};pki$1.setRsaPrivateKey=pki$1.rsa.setPrivateKey=function(n,r,_,E,S,C,A,I){var B={n,e:r,d:_,p:E,q:S,dP:C,dQ:A,qInv:I};return B.decrypt=function(O,N,U){typeof N=="string"?N=N.toUpperCase():N===void 0&&(N="RSAES-PKCS1-V1_5");var j=pki$1.rsa.decrypt(O,B,!1,!1);if(N==="RSAES-PKCS1-V1_5")N={decode:_decodePkcs1_v1_5};else if(N==="RSA-OAEP"||N==="RSAES-OAEP")N={decode:function(z,Z){return forge$2.pkcs1.decode_rsa_oaep(Z,z,U)}};else if(["RAW","NONE","NULL",null].indexOf(N)!==-1)N={decode:function(z){return z}};else throw new Error('Unsupported encryption scheme: "'+N+'".');return N.decode(j,B,!1)},B.sign=function(O,N){var U=!1;typeof N=="string"&&(N=N.toUpperCase()),N===void 0||N==="RSASSA-PKCS1-V1_5"?(N={encode:emsaPkcs1v15encode},U=1):(N==="NONE"||N==="NULL"||N===null)&&(N={encode:function(){return O}},U=1);var j=N.encode(O,B.n.bitLength());return pki$1.rsa.encrypt(j,B,U)},B};pki$1.wrapRsaPrivateKey=function(n){return asn1$1.create(asn1$1.Class.UNIVERSAL,asn1$1.Type.SEQUENCE,!0,[asn1$1.create(asn1$1.Class.UNIVERSAL,asn1$1.Type.INTEGER,!1,asn1$1.integerToDer(0).getBytes()),asn1$1.create(asn1$1.Class.UNIVERSAL,asn1$1.Type.SEQUENCE,!0,[asn1$1.create(asn1$1.Class.UNIVERSAL,asn1$1.Type.OID,!1,asn1$1.oidToDer(pki$1.oids.rsaEncryption).getBytes()),asn1$1.create(asn1$1.Class.UNIVERSAL,asn1$1.Type.NULL,!1,"")]),asn1$1.create(asn1$1.Class.UNIVERSAL,asn1$1.Type.OCTETSTRING,!1,asn1$1.toDer(n).getBytes())])};pki$1.privateKeyFromAsn1=function(n){var r={},_=[];if(asn1$1.validate(n,privateKeyValidator,r,_)&&(n=asn1$1.fromDer(forge$2.util.createBuffer(r.privateKey))),r={},_=[],!asn1$1.validate(n,rsaPrivateKeyValidator,r,_)){var E=new Error("Cannot read private key. ASN.1 object does not contain an RSAPrivateKey.");throw E.errors=_,E}var S,C,A,I,B,O,N,U;return S=forge$2.util.createBuffer(r.privateKeyModulus).toHex(),C=forge$2.util.createBuffer(r.privateKeyPublicExponent).toHex(),A=forge$2.util.createBuffer(r.privateKeyPrivateExponent).toHex(),I=forge$2.util.createBuffer(r.privateKeyPrime1).toHex(),B=forge$2.util.createBuffer(r.privateKeyPrime2).toHex(),O=forge$2.util.createBuffer(r.privateKeyExponent1).toHex(),N=forge$2.util.createBuffer(r.privateKeyExponent2).toHex(),U=forge$2.util.createBuffer(r.privateKeyCoefficient).toHex(),pki$1.setRsaPrivateKey(new BigInteger$1(S,16),new BigInteger$1(C,16),new BigInteger$1(A,16),new BigInteger$1(I,16),new BigInteger$1(B,16),new BigInteger$1(O,16),new BigInteger$1(N,16),new BigInteger$1(U,16))};pki$1.privateKeyToAsn1=pki$1.privateKeyToRSAPrivateKey=function(n){return asn1$1.create(asn1$1.Class.UNIVERSAL,asn1$1.Type.SEQUENCE,!0,[asn1$1.create(asn1$1.Class.UNIVERSAL,asn1$1.Type.INTEGER,!1,asn1$1.integerToDer(0).getBytes()),asn1$1.create(asn1$1.Class.UNIVERSAL,asn1$1.Type.INTEGER,!1,_bnToBytes(n.n)),asn1$1.create(asn1$1.Class.UNIVERSAL,asn1$1.Type.INTEGER,!1,_bnToBytes(n.e)),asn1$1.create(asn1$1.Class.UNIVERSAL,asn1$1.Type.INTEGER,!1,_bnToBytes(n.d)),asn1$1.create(asn1$1.Class.UNIVERSAL,asn1$1.Type.INTEGER,!1,_bnToBytes(n.p)),asn1$1.create(asn1$1.Class.UNIVERSAL,asn1$1.Type.INTEGER,!1,_bnToBytes(n.q)),asn1$1.create(asn1$1.Class.UNIVERSAL,asn1$1.Type.INTEGER,!1,_bnToBytes(n.dP)),asn1$1.create(asn1$1.Class.UNIVERSAL,asn1$1.Type.INTEGER,!1,_bnToBytes(n.dQ)),asn1$1.create(asn1$1.Class.UNIVERSAL,asn1$1.Type.INTEGER,!1,_bnToBytes(n.qInv))])};pki$1.publicKeyFromAsn1=function(n){var r={},_=[];if(asn1$1.validate(n,publicKeyValidator,r,_)){var E=asn1$1.derToOid(r.publicKeyOid);if(E!==pki$1.oids.rsaEncryption){var S=new Error("Cannot read public key. Unknown OID.");throw S.oid=E,S}n=r.rsaPublicKey}if(_=[],!asn1$1.validate(n,rsaPublicKeyValidator,r,_)){var S=new Error("Cannot read public key. ASN.1 object does not contain an RSAPublicKey.");throw S.errors=_,S}var C=forge$2.util.createBuffer(r.publicKeyModulus).toHex(),A=forge$2.util.createBuffer(r.publicKeyExponent).toHex();return pki$1.setRsaPublicKey(new BigInteger$1(C,16),new BigInteger$1(A,16))};pki$1.publicKeyToAsn1=pki$1.publicKeyToSubjectPublicKeyInfo=function(n){return asn1$1.create(asn1$1.Class.UNIVERSAL,asn1$1.Type.SEQUENCE,!0,[asn1$1.create(asn1$1.Class.UNIVERSAL,asn1$1.Type.SEQUENCE,!0,[asn1$1.create(asn1$1.Class.UNIVERSAL,asn1$1.Type.OID,!1,asn1$1.oidToDer(pki$1.oids.rsaEncryption).getBytes()),asn1$1.create(asn1$1.Class.UNIVERSAL,asn1$1.Type.NULL,!1,"")]),asn1$1.create(asn1$1.Class.UNIVERSAL,asn1$1.Type.BITSTRING,!1,[pki$1.publicKeyToRSAPublicKey(n)])])};pki$1.publicKeyToRSAPublicKey=function(n){return asn1$1.create(asn1$1.Class.UNIVERSAL,asn1$1.Type.SEQUENCE,!0,[asn1$1.create(asn1$1.Class.UNIVERSAL,asn1$1.Type.INTEGER,!1,_bnToBytes(n.n)),asn1$1.create(asn1$1.Class.UNIVERSAL,asn1$1.Type.INTEGER,!1,_bnToBytes(n.e))])};function _encodePkcs1_v1_5(n,r,_){var E=forge$2.util.createBuffer(),S=Math.ceil(r.n.bitLength()/8);if(n.length>S-11){var C=new Error("Message is too long for PKCS#1 v1.5 padding.");throw C.length=n.length,C.max=S-11,C}E.putByte(0),E.putByte(_);var A=S-3-n.length,I;if(_===0||_===1){I=_===0?0:255;for(var B=0;B<A;++B)E.putByte(I)}else for(;A>0;){for(var O=0,N=forge$2.random.getBytes(A),B=0;B<A;++B)I=N.charCodeAt(B),I===0?++O:E.putByte(I);A=O}return E.putByte(0),E.putBytes(n),E}function _decodePkcs1_v1_5(n,r,_,E){var S=Math.ceil(r.n.bitLength()/8),C=forge$2.util.createBuffer(n),A=C.getByte(),I=C.getByte();if(A!==0||_&&I!==0&&I!==1||!_&&I!=2||_&&I===0&&typeof E>"u")throw new Error("Encryption block is invalid.");var B=0;if(I===0){B=S-3-E;for(var O=0;O<B;++O)if(C.getByte()!==0)throw new Error("Encryption block is invalid.")}else if(I===1)for(B=0;C.length()>1;){if(C.getByte()!==255){--C.read;break}++B}else if(I===2)for(B=0;C.length()>1;){if(C.getByte()===0){--C.read;break}++B}var N=C.getByte();if(N!==0||B!==S-3-C.length())throw new Error("Encryption block is invalid.");return C.getBytes()}function _generateKeyPair(n,r,_){typeof r=="function"&&(_=r,r={}),r=r||{};var E={algorithm:{name:r.algorithm||"PRIMEINC",options:{workers:r.workers||2,workLoad:r.workLoad||100,workerScript:r.workerScript}}};"prng"in r&&(E.prng=r.prng),S();function S(){C(n.pBits,function(I,B){if(I)return _(I);if(n.p=B,n.q!==null)return A(I,n.q);C(n.qBits,A)})}function C(I,B){forge$2.prime.generateProbablePrime(I,E,B)}function A(I,B){if(I)return _(I);if(n.q=B,n.p.compareTo(n.q)<0){var O=n.p;n.p=n.q,n.q=O}if(n.p.subtract(BigInteger$1.ONE).gcd(n.e).compareTo(BigInteger$1.ONE)!==0){n.p=null,S();return}if(n.q.subtract(BigInteger$1.ONE).gcd(n.e).compareTo(BigInteger$1.ONE)!==0){n.q=null,C(n.qBits,A);return}if(n.p1=n.p.subtract(BigInteger$1.ONE),n.q1=n.q.subtract(BigInteger$1.ONE),n.phi=n.p1.multiply(n.q1),n.phi.gcd(n.e).compareTo(BigInteger$1.ONE)!==0){n.p=n.q=null,S();return}if(n.n=n.p.multiply(n.q),n.n.bitLength()!==n.bits){n.q=null,C(n.qBits,A);return}var N=n.e.modInverse(n.phi);n.keys={privateKey:pki$1.rsa.setPrivateKey(n.n,n.e,N,n.p,n.q,N.mod(n.p1),N.mod(n.q1),n.q.modInverse(n.p)),publicKey:pki$1.rsa.setPublicKey(n.n,n.e)},_(null,n.keys)}}function _bnToBytes(n){var r=n.toString(16);r[0]>="8"&&(r="00"+r);var _=forge$2.util.hexToBytes(r);return _.length>1&&(_.charCodeAt(0)===0&&!(_.charCodeAt(1)&128)||_.charCodeAt(0)===255&&(_.charCodeAt(1)&128)===128)?_.substr(1):_}function _getMillerRabinTests(n){return n<=100?27:n<=150?18:n<=200?15:n<=250?12:n<=300?9:n<=350?8:n<=400?7:n<=500?6:n<=600?5:n<=800?4:n<=1250?3:2}function _detectNodeCrypto(n){return forge$2.util.isNodejs&&typeof _crypto[n]=="function"}function _detectSubtleCrypto(n){return typeof util$2.globalScope<"u"&&typeof util$2.globalScope.crypto=="object"&&typeof util$2.globalScope.crypto.subtle=="object"&&typeof util$2.globalScope.crypto.subtle[n]=="function"}function _detectSubtleMsCrypto(n){return typeof util$2.globalScope<"u"&&typeof util$2.globalScope.msCrypto=="object"&&typeof util$2.globalScope.msCrypto.subtle=="object"&&typeof util$2.globalScope.msCrypto.subtle[n]=="function"}function _intToUint8Array(n){for(var r=forge$2.util.hexToBytes(n.toString(16)),_=new Uint8Array(r.length),E=0;E<r.length;++E)_[E]=r.charCodeAt(E);return _}var forge$1=forge$m;if(typeof BigInteger>"u")var BigInteger=forge$1.jsbn.BigInteger;var asn1=forge$1.asn1,pki=forge$1.pki=forge$1.pki||{};pki.pbe=forge$1.pbe=forge$1.pbe||{};var oids=pki.oids,encryptedPrivateKeyValidator={name:"EncryptedPrivateKeyInfo",tagClass:asn1.Class.UNIVERSAL,type:asn1.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedPrivateKeyInfo.encryptionAlgorithm",tagClass:asn1.Class.UNIVERSAL,type:asn1.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:asn1.Class.UNIVERSAL,type:asn1.Type.OID,constructed:!1,capture:"encryptionOid"},{name:"AlgorithmIdentifier.parameters",tagClass:asn1.Class.UNIVERSAL,type:asn1.Type.SEQUENCE,constructed:!0,captureAsn1:"encryptionParams"}]},{name:"EncryptedPrivateKeyInfo.encryptedData",tagClass:asn1.Class.UNIVERSAL,type:asn1.Type.OCTETSTRING,constructed:!1,capture:"encryptedData"}]},PBES2AlgorithmsValidator={name:"PBES2Algorithms",tagClass:asn1.Class.UNIVERSAL,type:asn1.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc",tagClass:asn1.Class.UNIVERSAL,type:asn1.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc.oid",tagClass:asn1.Class.UNIVERSAL,type:asn1.Type.OID,constructed:!1,capture:"kdfOid"},{name:"PBES2Algorithms.params",tagClass:asn1.Class.UNIVERSAL,type:asn1.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.params.salt",tagClass:asn1.Class.UNIVERSAL,type:asn1.Type.OCTETSTRING,constructed:!1,capture:"kdfSalt"},{name:"PBES2Algorithms.params.iterationCount",tagClass:asn1.Class.UNIVERSAL,type:asn1.Type.INTEGER,constructed:!1,capture:"kdfIterationCount"},{name:"PBES2Algorithms.params.keyLength",tagClass:asn1.Class.UNIVERSAL,type:asn1.Type.INTEGER,constructed:!1,optional:!0,capture:"keyLength"},{name:"PBES2Algorithms.params.prf",tagClass:asn1.Class.UNIVERSAL,type:asn1.Type.SEQUENCE,constructed:!0,optional:!0,value:[{name:"PBES2Algorithms.params.prf.algorithm",tagClass:asn1.Class.UNIVERSAL,type:asn1.Type.OID,constructed:!1,capture:"prfOid"}]}]}]},{name:"PBES2Algorithms.encryptionScheme",tagClass:asn1.Class.UNIVERSAL,type:asn1.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.encryptionScheme.oid",tagClass:asn1.Class.UNIVERSAL,type:asn1.Type.OID,constructed:!1,capture:"encOid"},{name:"PBES2Algorithms.encryptionScheme.iv",tagClass:asn1.Class.UNIVERSAL,type:asn1.Type.OCTETSTRING,constructed:!1,capture:"encIv"}]}]},pkcs12PbeParamsValidator={name:"pkcs-12PbeParams",tagClass:asn1.Class.UNIVERSAL,type:asn1.Type.SEQUENCE,constructed:!0,value:[{name:"pkcs-12PbeParams.salt",tagClass:asn1.Class.UNIVERSAL,type:asn1.Type.OCTETSTRING,constructed:!1,capture:"salt"},{name:"pkcs-12PbeParams.iterations",tagClass:asn1.Class.UNIVERSAL,type:asn1.Type.INTEGER,constructed:!1,capture:"iterations"}]};pki.encryptPrivateKeyInfo=function(n,r,_){_=_||{},_.saltSize=_.saltSize||8,_.count=_.count||2048,_.algorithm=_.algorithm||"aes128",_.prfAlgorithm=_.prfAlgorithm||"sha1";var E=forge$1.random.getBytesSync(_.saltSize),S=_.count,C=asn1.integerToDer(S),A,I,B;if(_.algorithm.indexOf("aes")===0||_.algorithm==="des"){var O,N,U;switch(_.algorithm){case"aes128":A=16,O=16,N=oids["aes128-CBC"],U=forge$1.aes.createEncryptionCipher;break;case"aes192":A=24,O=16,N=oids["aes192-CBC"],U=forge$1.aes.createEncryptionCipher;break;case"aes256":A=32,O=16,N=oids["aes256-CBC"],U=forge$1.aes.createEncryptionCipher;break;case"des":A=8,O=8,N=oids.desCBC,U=forge$1.des.createEncryptionCipher;break;default:var j=new Error("Cannot encrypt private key. Unknown encryption algorithm.");throw j.algorithm=_.algorithm,j}var z="hmacWith"+_.prfAlgorithm.toUpperCase(),Z=prfAlgorithmToMessageDigest(z),X=forge$1.pkcs5.pbkdf2(r,E,S,A,Z),Q=forge$1.random.getBytesSync(O),se=U(X);se.start(Q),se.update(asn1.toDer(n)),se.finish(),B=se.output.getBytes();var oe=createPbkdf2Params(E,C,A,z);I=asn1.create(asn1.Class.UNIVERSAL,asn1.Type.SEQUENCE,!0,[asn1.create(asn1.Class.UNIVERSAL,asn1.Type.OID,!1,asn1.oidToDer(oids.pkcs5PBES2).getBytes()),asn1.create(asn1.Class.UNIVERSAL,asn1.Type.SEQUENCE,!0,[asn1.create(asn1.Class.UNIVERSAL,asn1.Type.SEQUENCE,!0,[asn1.create(asn1.Class.UNIVERSAL,asn1.Type.OID,!1,asn1.oidToDer(oids.pkcs5PBKDF2).getBytes()),oe]),asn1.create(asn1.Class.UNIVERSAL,asn1.Type.SEQUENCE,!0,[asn1.create(asn1.Class.UNIVERSAL,asn1.Type.OID,!1,asn1.oidToDer(N).getBytes()),asn1.create(asn1.Class.UNIVERSAL,asn1.Type.OCTETSTRING,!1,Q)])])])}else if(_.algorithm==="3des"){A=24;var ue=new forge$1.util.ByteBuffer(E),X=pki.pbe.generatePkcs12Key(r,ue,1,S,A),Q=pki.pbe.generatePkcs12Key(r,ue,2,S,A),se=forge$1.des.createEncryptionCipher(X);se.start(Q),se.update(asn1.toDer(n)),se.finish(),B=se.output.getBytes(),I=asn1.create(asn1.Class.UNIVERSAL,asn1.Type.SEQUENCE,!0,[asn1.create(asn1.Class.UNIVERSAL,asn1.Type.OID,!1,asn1.oidToDer(oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]).getBytes()),asn1.create(asn1.Class.UNIVERSAL,asn1.Type.SEQUENCE,!0,[asn1.create(asn1.Class.UNIVERSAL,asn1.Type.OCTETSTRING,!1,E),asn1.create(asn1.Class.UNIVERSAL,asn1.Type.INTEGER,!1,C.getBytes())])])}else{var j=new Error("Cannot encrypt private key. Unknown encryption algorithm.");throw j.algorithm=_.algorithm,j}var we=asn1.create(asn1.Class.UNIVERSAL,asn1.Type.SEQUENCE,!0,[I,asn1.create(asn1.Class.UNIVERSAL,asn1.Type.OCTETSTRING,!1,B)]);return we};pki.decryptPrivateKeyInfo=function(n,r){var _=null,E={},S=[];if(!asn1.validate(n,encryptedPrivateKeyValidator,E,S)){var C=new Error("Cannot read encrypted private key. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw C.errors=S,C}var A=asn1.derToOid(E.encryptionOid),I=pki.pbe.getCipher(A,E.encryptionParams,r),B=forge$1.util.createBuffer(E.encryptedData);return I.update(B),I.finish()&&(_=asn1.fromDer(I.output)),_};pki.encryptedPrivateKeyToPem=function(n,r){var _={type:"ENCRYPTED PRIVATE KEY",body:asn1.toDer(n).getBytes()};return forge$1.pem.encode(_,{maxline:r})};pki.encryptedPrivateKeyFromPem=function(n){var r=forge$1.pem.decode(n)[0];if(r.type!=="ENCRYPTED PRIVATE KEY"){var _=new Error('Could not convert encrypted private key from PEM; PEM header type is "ENCRYPTED PRIVATE KEY".');throw _.headerType=r.type,_}if(r.procType&&r.procType.type==="ENCRYPTED")throw new Error("Could not convert encrypted private key from PEM; PEM is encrypted.");return asn1.fromDer(r.body)};pki.encryptRsaPrivateKey=function(n,r,_){if(_=_||{},!_.legacy){var E=pki.wrapRsaPrivateKey(pki.privateKeyToAsn1(n));return E=pki.encryptPrivateKeyInfo(E,r,_),pki.encryptedPrivateKeyToPem(E)}var S,C,A,I;switch(_.algorithm){case"aes128":S="AES-128-CBC",A=16,C=forge$1.random.getBytesSync(16),I=forge$1.aes.createEncryptionCipher;break;case"aes192":S="AES-192-CBC",A=24,C=forge$1.random.getBytesSync(16),I=forge$1.aes.createEncryptionCipher;break;case"aes256":S="AES-256-CBC",A=32,C=forge$1.random.getBytesSync(16),I=forge$1.aes.createEncryptionCipher;break;case"3des":S="DES-EDE3-CBC",A=24,C=forge$1.random.getBytesSync(8),I=forge$1.des.createEncryptionCipher;break;case"des":S="DES-CBC",A=8,C=forge$1.random.getBytesSync(8),I=forge$1.des.createEncryptionCipher;break;default:var B=new Error('Could not encrypt RSA private key; unsupported encryption algorithm "'+_.algorithm+'".');throw B.algorithm=_.algorithm,B}var O=forge$1.pbe.opensslDeriveBytes(r,C.substr(0,8),A),N=I(O);N.start(C),N.update(asn1.toDer(pki.privateKeyToAsn1(n))),N.finish();var U={type:"RSA PRIVATE KEY",procType:{version:"4",type:"ENCRYPTED"},dekInfo:{algorithm:S,parameters:forge$1.util.bytesToHex(C).toUpperCase()},body:N.output.getBytes()};return forge$1.pem.encode(U)};pki.decryptRsaPrivateKey=function(n,r){var _=null,E=forge$1.pem.decode(n)[0];if(E.type!=="ENCRYPTED PRIVATE KEY"&&E.type!=="PRIVATE KEY"&&E.type!=="RSA PRIVATE KEY"){var S=new Error('Could not convert private key from PEM; PEM header type is not "ENCRYPTED PRIVATE KEY", "PRIVATE KEY", or "RSA PRIVATE KEY".');throw S.headerType=S,S}if(E.procType&&E.procType.type==="ENCRYPTED"){var C,A;switch(E.dekInfo.algorithm){case"DES-CBC":C=8,A=forge$1.des.createDecryptionCipher;break;case"DES-EDE3-CBC":C=24,A=forge$1.des.createDecryptionCipher;break;case"AES-128-CBC":C=16,A=forge$1.aes.createDecryptionCipher;break;case"AES-192-CBC":C=24,A=forge$1.aes.createDecryptionCipher;break;case"AES-256-CBC":C=32,A=forge$1.aes.createDecryptionCipher;break;case"RC2-40-CBC":C=5,A=function(U){return forge$1.rc2.createDecryptionCipher(U,40)};break;case"RC2-64-CBC":C=8,A=function(U){return forge$1.rc2.createDecryptionCipher(U,64)};break;case"RC2-128-CBC":C=16,A=function(U){return forge$1.rc2.createDecryptionCipher(U,128)};break;default:var S=new Error('Could not decrypt private key; unsupported encryption algorithm "'+E.dekInfo.algorithm+'".');throw S.algorithm=E.dekInfo.algorithm,S}var I=forge$1.util.hexToBytes(E.dekInfo.parameters),B=forge$1.pbe.opensslDeriveBytes(r,I.substr(0,8),C),O=A(B);if(O.start(I),O.update(forge$1.util.createBuffer(E.body)),O.finish())_=O.output.getBytes();else return _}else _=E.body;return E.type==="ENCRYPTED PRIVATE KEY"?_=pki.decryptPrivateKeyInfo(asn1.fromDer(_),r):_=asn1.fromDer(_),_!==null&&(_=pki.privateKeyFromAsn1(_)),_};pki.pbe.generatePkcs12Key=function(n,r,_,E,S,C){var A,I;if(typeof C>"u"||C===null){if(!("sha1"in forge$1.md))throw new Error('"sha1" hash algorithm unavailable.');C=forge$1.md.sha1.create()}var B=C.digestLength,O=C.blockLength,N=new forge$1.util.ByteBuffer,U=new forge$1.util.ByteBuffer;if(n!=null){for(I=0;I<n.length;I++)U.putInt16(n.charCodeAt(I));U.putInt16(0)}var j=U.length(),z=r.length(),Z=new forge$1.util.ByteBuffer;Z.fillWithByte(_,O);var X=O*Math.ceil(z/O),Q=new forge$1.util.ByteBuffer;for(I=0;I<X;I++)Q.putByte(r.at(I%z));var se=O*Math.ceil(j/O),oe=new forge$1.util.ByteBuffer;for(I=0;I<se;I++)oe.putByte(U.at(I%j));var ue=Q;ue.putBuffer(oe);for(var we=Math.ceil(S/B),Te=1;Te<=we;Te++){var xe=new forge$1.util.ByteBuffer;xe.putBytes(Z.bytes()),xe.putBytes(ue.bytes());for(var Re=0;Re<E;Re++)C.start(),C.update(xe.getBytes()),xe=C.digest();var Ne=new forge$1.util.ByteBuffer;for(I=0;I<O;I++)Ne.putByte(xe.at(I%B));var Fe=Math.ceil(z/O)+Math.ceil(j/O),ht=new forge$1.util.ByteBuffer;for(A=0;A<Fe;A++){var nt=new forge$1.util.ByteBuffer(ue.getBytes(O)),Ee=511;for(I=Ne.length()-1;I>=0;I--)Ee=Ee>>8,Ee+=Ne.at(I)+nt.at(I),nt.setAt(I,Ee&255);ht.putBuffer(nt)}ue=ht,N.putBuffer(xe)}return N.truncate(N.length()-S),N};pki.pbe.getCipher=function(n,r,_){switch(n){case pki.oids.pkcs5PBES2:return pki.pbe.getCipherForPBES2(n,r,_);case pki.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:case pki.oids["pbewithSHAAnd40BitRC2-CBC"]:return pki.pbe.getCipherForPKCS12PBE(n,r,_);default:var E=new Error("Cannot read encrypted PBE data block. Unsupported OID.");throw E.oid=n,E.supportedOids=["pkcs5PBES2","pbeWithSHAAnd3-KeyTripleDES-CBC","pbewithSHAAnd40BitRC2-CBC"],E}};pki.pbe.getCipherForPBES2=function(n,r,_){var E={},S=[];if(!asn1.validate(r,PBES2AlgorithmsValidator,E,S)){var C=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw C.errors=S,C}if(n=asn1.derToOid(E.kdfOid),n!==pki.oids.pkcs5PBKDF2){var C=new Error("Cannot read encrypted private key. Unsupported key derivation function OID.");throw C.oid=n,C.supportedOids=["pkcs5PBKDF2"],C}if(n=asn1.derToOid(E.encOid),n!==pki.oids["aes128-CBC"]&&n!==pki.oids["aes192-CBC"]&&n!==pki.oids["aes256-CBC"]&&n!==pki.oids["des-EDE3-CBC"]&&n!==pki.oids.desCBC){var C=new Error("Cannot read encrypted private key. Unsupported encryption scheme OID.");throw C.oid=n,C.supportedOids=["aes128-CBC","aes192-CBC","aes256-CBC","des-EDE3-CBC","desCBC"],C}var A=E.kdfSalt,I=forge$1.util.createBuffer(E.kdfIterationCount);I=I.getInt(I.length()<<3);var B,O;switch(pki.oids[n]){case"aes128-CBC":B=16,O=forge$1.aes.createDecryptionCipher;break;case"aes192-CBC":B=24,O=forge$1.aes.createDecryptionCipher;break;case"aes256-CBC":B=32,O=forge$1.aes.createDecryptionCipher;break;case"des-EDE3-CBC":B=24,O=forge$1.des.createDecryptionCipher;break;case"desCBC":B=8,O=forge$1.des.createDecryptionCipher;break}var N=prfOidToMessageDigest(E.prfOid),U=forge$1.pkcs5.pbkdf2(_,A,I,B,N),j=E.encIv,z=O(U);return z.start(j),z};pki.pbe.getCipherForPKCS12PBE=function(n,r,_){var E={},S=[];if(!asn1.validate(r,pkcs12PbeParamsValidator,E,S)){var C=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw C.errors=S,C}var A=forge$1.util.createBuffer(E.salt),I=forge$1.util.createBuffer(E.iterations);I=I.getInt(I.length()<<3);var B,O,N;switch(n){case pki.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:B=24,O=8,N=forge$1.des.startDecrypting;break;case pki.oids["pbewithSHAAnd40BitRC2-CBC"]:B=5,O=8,N=function(X,Q){var se=forge$1.rc2.createDecryptionCipher(X,40);return se.start(Q,null),se};break;default:var C=new Error("Cannot read PKCS #12 PBE data block. Unsupported OID.");throw C.oid=n,C}var U=prfOidToMessageDigest(E.prfOid),j=pki.pbe.generatePkcs12Key(_,A,1,I,B,U);U.start();var z=pki.pbe.generatePkcs12Key(_,A,2,I,O,U);return N(j,z)};pki.pbe.opensslDeriveBytes=function(n,r,_,E){if(typeof E>"u"||E===null){if(!("md5"in forge$1.md))throw new Error('"md5" hash algorithm unavailable.');E=forge$1.md.md5.create()}r===null&&(r="");for(var S=[hash$1(E,n+r)],C=16,A=1;C<_;++A,C+=16)S.push(hash$1(E,S[A-1]+n+r));return S.join("").substr(0,_)};function hash$1(n,r){return n.start().update(r).digest().getBytes()}function prfOidToMessageDigest(n){var r;if(!n)r="hmacWithSHA1";else if(r=pki.oids[asn1.derToOid(n)],!r){var _=new Error("Unsupported PRF OID.");throw _.oid=n,_.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"],_}return prfAlgorithmToMessageDigest(r)}function prfAlgorithmToMessageDigest(n){var r=forge$1.md;switch(n){case"hmacWithSHA224":r=forge$1.md.sha512;case"hmacWithSHA1":case"hmacWithSHA256":case"hmacWithSHA384":case"hmacWithSHA512":n=n.substr(8).toLowerCase();break;default:var _=new Error("Unsupported PRF algorithm.");throw _.algorithm=n,_.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"],_}if(!r||!(n in r))throw new Error("Unknown hash algorithm: "+n);return r[n].create()}function createPbkdf2Params(n,r,_,E){var S=asn1.create(asn1.Class.UNIVERSAL,asn1.Type.SEQUENCE,!0,[asn1.create(asn1.Class.UNIVERSAL,asn1.Type.OCTETSTRING,!1,n),asn1.create(asn1.Class.UNIVERSAL,asn1.Type.INTEGER,!1,r.getBytes())]);return E!=="hmacWithSHA1"&&S.value.push(asn1.create(asn1.Class.UNIVERSAL,asn1.Type.INTEGER,!1,forge$1.util.hexToBytes(_.toString(16))),asn1.create(asn1.Class.UNIVERSAL,asn1.Type.SEQUENCE,!0,[asn1.create(asn1.Class.UNIVERSAL,asn1.Type.OID,!1,asn1.oidToDer(pki.oids[E]).getBytes()),asn1.create(asn1.Class.UNIVERSAL,asn1.Type.NULL,!1,"")])),S}function equals$1(n,r){if(n===r)return!0;if(n.byteLength!==r.byteLength)return!1;for(let _=0;_<n.byteLength;_++)if(n[_]!==r[_])return!1;return!0}function asUint8Array$1(n){return n}function concat$4(n,r){r==null&&(r=n.reduce((S,C)=>S+C.length,0));const _=allocUnsafe$1(r);let E=0;for(const S of n)_.set(S,E),E+=S.length;return _}function bigIntegerToUintBase64url$1(n,r){let _=Uint8Array.from(n.abs().toByteArray());if(_=_[0]===0?_.subarray(1):_,r!=null){if(_.length>r)throw new Error("byte array longer than desired length");_=concat$4([new Uint8Array(r-_.length),_])}return toString$4(_,"base64url")}function base64urlToBigInteger$1(n){const r=base64urlToBuffer$1(n);return new forge$n.jsbn.BigInteger(toString$4(r,"base16"),16)}function base64urlToBuffer$1(n,r){let _=fromString$3(n,"base64urlpad");if(r!=null){if(_.length>r)throw new Error("byte array longer than desired length");_=concat$4([new Uint8Array(r-_.length),_])}return _}function isPromise$5(n){return n==null?!1:typeof n.then=="function"&&typeof n.catch=="function"&&typeof n.finally=="function"}function number$2(n){if(!Number.isSafeInteger(n)||n<0)throw new Error(`positive integer expected, not ${n}`)}function isBytes$3(n){return n instanceof Uint8Array||n!=null&&typeof n=="object"&&n.constructor.name==="Uint8Array"}function bytes$1(n,...r){if(!isBytes$3(n))throw new Error("Uint8Array expected");if(r.length>0&&!r.includes(n.length))throw new Error(`Uint8Array expected of length ${r}, not of length=${n.length}`)}function hash(n){if(typeof n!="function"||typeof n.create!="function")throw new Error("Hash should be wrapped by utils.wrapConstructor");number$2(n.outputLen),number$2(n.blockLen)}function exists$2(n,r=!0){if(n.destroyed)throw new Error("Hash instance has been destroyed");if(r&&n.finished)throw new Error("Hash#digest() has already been called")}function output$1(n,r){bytes$1(n);const _=r.outputLen;if(n.length<_)throw new Error(`digestInto() expects output buffer of length at least ${_}`)}const crypto$2=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0,crypto$3=Object.freeze(Object.defineProperty({__proto__:null,crypto:crypto$2},Symbol.toStringTag,{value:"Module"}));/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */const createView$1=n=>new DataView(n.buffer,n.byteOffset,n.byteLength),rotr=(n,r)=>n<<32-r|n>>>r,rotl$1=(n,r)=>n<<r|n>>>32-r>>>0;new Uint8Array(new Uint32Array([287454020]).buffer)[0];const nextTick=async()=>{};async function asyncLoop(n,r,_){let E=Date.now();for(let S=0;S<n;S++){_(S);const C=Date.now()-E;C>=0&&C<r||(await nextTick(),E+=C)}}function utf8ToBytes$2(n){if(typeof n!="string")throw new Error(`utf8ToBytes expected string, got ${typeof n}`);return new Uint8Array(new TextEncoder().encode(n))}function toBytes$2(n){return typeof n=="string"&&(n=utf8ToBytes$2(n)),bytes$1(n),n}function concatBytes$1(...n){let r=0;for(let E=0;E<n.length;E++){const S=n[E];bytes$1(S),r+=S.length}const _=new Uint8Array(r);for(let E=0,S=0;E<n.length;E++){const C=n[E];_.set(C,S),S+=C.length}return _}class Hash{clone(){return this._cloneInto()}}const toStr={}.toString;function checkOpts$1(n,r){if(r!==void 0&&toStr.call(r)!=="[object Object]")throw new Error("Options should be object or undefined");return Object.assign(n,r)}function wrapConstructor(n){const r=E=>n().update(toBytes$2(E)).digest(),_=n();return r.outputLen=_.outputLen,r.blockLen=_.blockLen,r.create=()=>n(),r}function randomBytes$3(n=32){if(crypto$2&&typeof crypto$2.getRandomValues=="function")return crypto$2.getRandomValues(new Uint8Array(n));throw new Error("crypto.getRandomValues must be defined")}function setBigUint64$1(n,r,_,E){if(typeof n.setBigUint64=="function")return n.setBigUint64(r,_,E);const S=BigInt(32),C=BigInt(4294967295),A=Number(_>>S&C),I=Number(_&C),B=E?4:0,O=E?0:4;n.setUint32(r+B,A,E),n.setUint32(r+O,I,E)}const Chi=(n,r,_)=>n&r^~n&_,Maj=(n,r,_)=>n&r^n&_^r&_;class HashMD extends Hash{constructor(r,_,E,S){super(),this.blockLen=r,this.outputLen=_,this.padOffset=E,this.isLE=S,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(r),this.view=createView$1(this.buffer)}update(r){exists$2(this);const{view:_,buffer:E,blockLen:S}=this;r=toBytes$2(r);const C=r.length;for(let A=0;A<C;){const I=Math.min(S-this.pos,C-A);if(I===S){const B=createView$1(r);for(;S<=C-A;A+=S)this.process(B,A);continue}E.set(r.subarray(A,A+I),this.pos),this.pos+=I,A+=I,this.pos===S&&(this.process(_,0),this.pos=0)}return this.length+=r.length,this.roundClean(),this}digestInto(r){exists$2(this),output$1(r,this),this.finished=!0;const{buffer:_,view:E,blockLen:S,isLE:C}=this;let{pos:A}=this;_[A++]=128,this.buffer.subarray(A).fill(0),this.padOffset>S-A&&(this.process(E,0),A=0);for(let U=A;U<S;U++)_[U]=0;setBigUint64$1(E,S-8,BigInt(this.length*8),C),this.process(E,0);const I=createView$1(r),B=this.outputLen;if(B%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const O=B/4,N=this.get();if(O>N.length)throw new Error("_sha2: outputLen bigger than state");for(let U=0;U<O;U++)I.setUint32(4*U,N[U],C)}digest(){const{buffer:r,outputLen:_}=this;this.digestInto(r);const E=r.slice(0,_);return this.destroy(),E}_cloneInto(r){r||(r=new this.constructor),r.set(...this.get());const{blockLen:_,buffer:E,length:S,finished:C,destroyed:A,pos:I}=this;return r.length=S,r.pos=I,r.finished=C,r.destroyed=A,S%_&&r.buffer.set(E),r}}const U32_MASK64=BigInt(2**32-1),_32n=BigInt(32);function fromBig(n,r=!1){return r?{h:Number(n&U32_MASK64),l:Number(n>>_32n&U32_MASK64)}:{h:Number(n>>_32n&U32_MASK64)|0,l:Number(n&U32_MASK64)|0}}function split(n,r=!1){let _=new Uint32Array(n.length),E=new Uint32Array(n.length);for(let S=0;S<n.length;S++){const{h:C,l:A}=fromBig(n[S],r);[_[S],E[S]]=[C,A]}return[_,E]}const toBig=(n,r)=>BigInt(n>>>0)<<_32n|BigInt(r>>>0),shrSH=(n,r,_)=>n>>>_,shrSL=(n,r,_)=>n<<32-_|r>>>_,rotrSH=(n,r,_)=>n>>>_|r<<32-_,rotrSL=(n,r,_)=>n<<32-_|r>>>_,rotrBH=(n,r,_)=>n<<64-_|r>>>_-32,rotrBL=(n,r,_)=>n>>>_-32|r<<64-_,rotr32H=(n,r)=>r,rotr32L=(n,r)=>n,rotlSH=(n,r,_)=>n<<_|r>>>32-_,rotlSL=(n,r,_)=>r<<_|n>>>32-_,rotlBH=(n,r,_)=>r<<_-32|n>>>64-_,rotlBL=(n,r,_)=>n<<_-32|r>>>64-_;function add(n,r,_,E){const S=(r>>>0)+(E>>>0);return{h:n+_+(S/2**32|0)|0,l:S|0}}const add3L=(n,r,_)=>(n>>>0)+(r>>>0)+(_>>>0),add3H=(n,r,_,E)=>r+_+E+(n/2**32|0)|0,add4L=(n,r,_,E)=>(n>>>0)+(r>>>0)+(_>>>0)+(E>>>0),add4H=(n,r,_,E,S)=>r+_+E+S+(n/2**32|0)|0,add5L=(n,r,_,E,S)=>(n>>>0)+(r>>>0)+(_>>>0)+(E>>>0)+(S>>>0),add5H=(n,r,_,E,S,C)=>r+_+E+S+C+(n/2**32|0)|0,u64={fromBig,split,toBig,shrSH,shrSL,rotrSH,rotrSL,rotrBH,rotrBL,rotr32H,rotr32L,rotlSH,rotlSL,rotlBH,rotlBL,add,add3L,add3H,add4L,add4H,add5H,add5L},[SHA512_Kh,SHA512_Kl]=u64.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(n=>BigInt(n))),SHA512_W_H=new Uint32Array(80),SHA512_W_L=new Uint32Array(80);class SHA512 extends HashMD{constructor(){super(128,64,16,!1),this.Ah=1779033703,this.Al=-205731576,this.Bh=-1150833019,this.Bl=-2067093701,this.Ch=1013904242,this.Cl=-23791573,this.Dh=-1521486534,this.Dl=1595750129,this.Eh=1359893119,this.El=-1377402159,this.Fh=-1694144372,this.Fl=725511199,this.Gh=528734635,this.Gl=-79577749,this.Hh=1541459225,this.Hl=327033209}get(){const{Ah:r,Al:_,Bh:E,Bl:S,Ch:C,Cl:A,Dh:I,Dl:B,Eh:O,El:N,Fh:U,Fl:j,Gh:z,Gl:Z,Hh:X,Hl:Q}=this;return[r,_,E,S,C,A,I,B,O,N,U,j,z,Z,X,Q]}set(r,_,E,S,C,A,I,B,O,N,U,j,z,Z,X,Q){this.Ah=r|0,this.Al=_|0,this.Bh=E|0,this.Bl=S|0,this.Ch=C|0,this.Cl=A|0,this.Dh=I|0,this.Dl=B|0,this.Eh=O|0,this.El=N|0,this.Fh=U|0,this.Fl=j|0,this.Gh=z|0,this.Gl=Z|0,this.Hh=X|0,this.Hl=Q|0}process(r,_){for(let ue=0;ue<16;ue++,_+=4)SHA512_W_H[ue]=r.getUint32(_),SHA512_W_L[ue]=r.getUint32(_+=4);for(let ue=16;ue<80;ue++){const we=SHA512_W_H[ue-15]|0,Te=SHA512_W_L[ue-15]|0,xe=u64.rotrSH(we,Te,1)^u64.rotrSH(we,Te,8)^u64.shrSH(we,Te,7),Re=u64.rotrSL(we,Te,1)^u64.rotrSL(we,Te,8)^u64.shrSL(we,Te,7),Ne=SHA512_W_H[ue-2]|0,Fe=SHA512_W_L[ue-2]|0,ht=u64.rotrSH(Ne,Fe,19)^u64.rotrBH(Ne,Fe,61)^u64.shrSH(Ne,Fe,6),nt=u64.rotrSL(Ne,Fe,19)^u64.rotrBL(Ne,Fe,61)^u64.shrSL(Ne,Fe,6),Ee=u64.add4L(Re,nt,SHA512_W_L[ue-7],SHA512_W_L[ue-16]),Ce=u64.add4H(Ee,xe,ht,SHA512_W_H[ue-7],SHA512_W_H[ue-16]);SHA512_W_H[ue]=Ce|0,SHA512_W_L[ue]=Ee|0}let{Ah:E,Al:S,Bh:C,Bl:A,Ch:I,Cl:B,Dh:O,Dl:N,Eh:U,El:j,Fh:z,Fl:Z,Gh:X,Gl:Q,Hh:se,Hl:oe}=this;for(let ue=0;ue<80;ue++){const we=u64.rotrSH(U,j,14)^u64.rotrSH(U,j,18)^u64.rotrBH(U,j,41),Te=u64.rotrSL(U,j,14)^u64.rotrSL(U,j,18)^u64.rotrBL(U,j,41),xe=U&z^~U&X,Re=j&Z^~j&Q,Ne=u64.add5L(oe,Te,Re,SHA512_Kl[ue],SHA512_W_L[ue]),Fe=u64.add5H(Ne,se,we,xe,SHA512_Kh[ue],SHA512_W_H[ue]),ht=Ne|0,nt=u64.rotrSH(E,S,28)^u64.rotrBH(E,S,34)^u64.rotrBH(E,S,39),Ee=u64.rotrSL(E,S,28)^u64.rotrBL(E,S,34)^u64.rotrBL(E,S,39),Ce=E&C^E&I^C&I,_e=S&A^S&B^A&B;se=X|0,oe=Q|0,X=z|0,Q=Z|0,z=U|0,Z=j|0,{h:U,l:j}=u64.add(O|0,N|0,Fe|0,ht|0),O=I|0,N=B|0,I=C|0,B=A|0,C=E|0,A=S|0;const Ie=u64.add3L(ht,Ee,_e);E=u64.add3H(Ie,Fe,nt,Ce),S=Ie|0}({h:E,l:S}=u64.add(this.Ah|0,this.Al|0,E|0,S|0)),{h:C,l:A}=u64.add(this.Bh|0,this.Bl|0,C|0,A|0),{h:I,l:B}=u64.add(this.Ch|0,this.Cl|0,I|0,B|0),{h:O,l:N}=u64.add(this.Dh|0,this.Dl|0,O|0,N|0),{h:U,l:j}=u64.add(this.Eh|0,this.El|0,U|0,j|0),{h:z,l:Z}=u64.add(this.Fh|0,this.Fl|0,z|0,Z|0),{h:X,l:Q}=u64.add(this.Gh|0,this.Gl|0,X|0,Q|0),{h:se,l:oe}=u64.add(this.Hh|0,this.Hl|0,se|0,oe|0),this.set(E,S,C,A,I,B,O,N,U,j,z,Z,X,Q,se,oe)}roundClean(){SHA512_W_H.fill(0),SHA512_W_L.fill(0)}destroy(){this.buffer.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}const sha512$1=wrapConstructor(()=>new SHA512);/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const _0n$5=BigInt(0),_1n$7=BigInt(1),_2n$4=BigInt(2);function isBytes$2(n){return n instanceof Uint8Array||n!=null&&typeof n=="object"&&n.constructor.name==="Uint8Array"}function abytes(n){if(!isBytes$2(n))throw new Error("Uint8Array expected")}const hexes=Array.from({length:256},(n,r)=>r.toString(16).padStart(2,"0"));function bytesToHex(n){abytes(n);let r="";for(let _=0;_<n.length;_++)r+=hexes[n[_]];return r}function numberToHexUnpadded(n){const r=n.toString(16);return r.length&1?`0${r}`:r}function hexToNumber(n){if(typeof n!="string")throw new Error("hex string expected, got "+typeof n);return BigInt(n===""?"0":`0x${n}`)}const asciis={_0:48,_9:57,_A:65,_F:70,_a:97,_f:102};function asciiToBase16(n){if(n>=asciis._0&&n<=asciis._9)return n-asciis._0;if(n>=asciis._A&&n<=asciis._F)return n-(asciis._A-10);if(n>=asciis._a&&n<=asciis._f)return n-(asciis._a-10)}function hexToBytes(n){if(typeof n!="string")throw new Error("hex string expected, got "+typeof n);const r=n.length,_=r/2;if(r%2)throw new Error("padded hex string expected, got unpadded hex of length "+r);const E=new Uint8Array(_);for(let S=0,C=0;S<_;S++,C+=2){const A=asciiToBase16(n.charCodeAt(C)),I=asciiToBase16(n.charCodeAt(C+1));if(A===void 0||I===void 0){const B=n[C]+n[C+1];throw new Error('hex string expected, got non-hex character "'+B+'" at index '+C)}E[S]=A*16+I}return E}function bytesToNumberBE(n){return hexToNumber(bytesToHex(n))}function bytesToNumberLE(n){return abytes(n),hexToNumber(bytesToHex(Uint8Array.from(n).reverse()))}function numberToBytesBE(n,r){return hexToBytes(n.toString(16).padStart(r*2,"0"))}function numberToBytesLE(n,r){return numberToBytesBE(n,r).reverse()}function numberToVarBytesBE(n){return hexToBytes(numberToHexUnpadded(n))}function ensureBytes$1(n,r,_){let E;if(typeof r=="string")try{E=hexToBytes(r)}catch(C){throw new Error(`${n} must be valid hex string, got "${r}". Cause: ${C}`)}else if(isBytes$2(r))E=Uint8Array.from(r);else throw new Error(`${n} must be hex string or Uint8Array`);const S=E.length;if(typeof _=="number"&&S!==_)throw new Error(`${n} expected ${_} bytes, got ${S}`);return E}function concatBytes(...n){let r=0;for(let E=0;E<n.length;E++){const S=n[E];abytes(S),r+=S.length}const _=new Uint8Array(r);for(let E=0,S=0;E<n.length;E++){const C=n[E];_.set(C,S),S+=C.length}return _}function equalBytes$1(n,r){if(n.length!==r.length)return!1;let _=0;for(let E=0;E<n.length;E++)_|=n[E]^r[E];return _===0}function utf8ToBytes$1(n){if(typeof n!="string")throw new Error(`utf8ToBytes expected string, got ${typeof n}`);return new Uint8Array(new TextEncoder().encode(n))}function bitLen(n){let r;for(r=0;n>_0n$5;n>>=_1n$7,r+=1);return r}function bitGet(n,r){return n>>BigInt(r)&_1n$7}function bitSet(n,r,_){return n|(_?_1n$7:_0n$5)<<BigInt(r)}const bitMask=n=>(_2n$4<<BigInt(n-1))-_1n$7,u8n=n=>new Uint8Array(n),u8fr=n=>Uint8Array.from(n);function createHmacDrbg(n,r,_){if(typeof n!="number"||n<2)throw new Error("hashLen must be a number");if(typeof r!="number"||r<2)throw new Error("qByteLen must be a number");if(typeof _!="function")throw new Error("hmacFn must be a function");let E=u8n(n),S=u8n(n),C=0;const A=()=>{E.fill(1),S.fill(0),C=0},I=(...U)=>_(S,E,...U),B=(U=u8n())=>{S=I(u8fr([0]),U),E=I(),U.length!==0&&(S=I(u8fr([1]),U),E=I())},O=()=>{if(C++>=1e3)throw new Error("drbg: tried 1000 values");let U=0;const j=[];for(;U<r;){E=I();const z=E.slice();j.push(z),U+=E.length}return concatBytes(...j)};return(U,j)=>{A(),B(U);let z;for(;!(z=j(O()));)B();return A(),z}}const validatorFns={bigint:n=>typeof n=="bigint",function:n=>typeof n=="function",boolean:n=>typeof n=="boolean",string:n=>typeof n=="string",stringOrUint8Array:n=>typeof n=="string"||isBytes$2(n),isSafeInteger:n=>Number.isSafeInteger(n),array:n=>Array.isArray(n),field:(n,r)=>r.Fp.isValid(n),hash:n=>typeof n=="function"&&Number.isSafeInteger(n.outputLen)};function validateObject(n,r,_={}){const E=(S,C,A)=>{const I=validatorFns[C];if(typeof I!="function")throw new Error(`Invalid validator "${C}", expected function`);const B=n[S];if(!(A&&B===void 0)&&!I(B,n))throw new Error(`Invalid param ${String(S)}=${B} (${typeof B}), expected ${C}`)};for(const[S,C]of Object.entries(r))E(S,C,!1);for(const[S,C]of Object.entries(_))E(S,C,!0);return n}const ut=Object.freeze(Object.defineProperty({__proto__:null,abytes,bitGet,bitLen,bitMask,bitSet,bytesToHex,bytesToNumberBE,bytesToNumberLE,concatBytes,createHmacDrbg,ensureBytes:ensureBytes$1,equalBytes:equalBytes$1,hexToBytes,hexToNumber,isBytes:isBytes$2,numberToBytesBE,numberToBytesLE,numberToHexUnpadded,numberToVarBytesBE,utf8ToBytes:utf8ToBytes$1,validateObject},Symbol.toStringTag,{value:"Module"}));/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const _0n$4=BigInt(0),_1n$6=BigInt(1),_2n$3=BigInt(2),_3n$1=BigInt(3),_4n=BigInt(4),_5n$1=BigInt(5),_8n$1=BigInt(8);BigInt(9);BigInt(16);function mod(n,r){const _=n%r;return _>=_0n$4?_:r+_}function pow(n,r,_){if(_<=_0n$4||r<_0n$4)throw new Error("Expected power/modulo > 0");if(_===_1n$6)return _0n$4;let E=_1n$6;for(;r>_0n$4;)r&_1n$6&&(E=E*n%_),n=n*n%_,r>>=_1n$6;return E}function pow2(n,r,_){let E=n;for(;r-- >_0n$4;)E*=E,E%=_;return E}function invert(n,r){if(n===_0n$4||r<=_0n$4)throw new Error(`invert: expected positive integers, got n=${n} mod=${r}`);let _=mod(n,r),E=r,S=_0n$4,C=_1n$6;for(;_!==_0n$4;){const I=E/_,B=E%_,O=S-C*I;E=_,_=B,S=C,C=O}if(E!==_1n$6)throw new Error("invert: does not exist");return mod(S,r)}function tonelliShanks(n){const r=(n-_1n$6)/_2n$3;let _,E,S;for(_=n-_1n$6,E=0;_%_2n$3===_0n$4;_/=_2n$3,E++);for(S=_2n$3;S<n&&pow(S,r,n)!==n-_1n$6;S++);if(E===1){const A=(n+_1n$6)/_4n;return function(B,O){const N=B.pow(O,A);if(!B.eql(B.sqr(N),O))throw new Error("Cannot find square root");return N}}const C=(_+_1n$6)/_2n$3;return function(I,B){if(I.pow(B,r)===I.neg(I.ONE))throw new Error("Cannot find square root");let O=E,N=I.pow(I.mul(I.ONE,S),_),U=I.pow(B,C),j=I.pow(B,_);for(;!I.eql(j,I.ONE);){if(I.eql(j,I.ZERO))return I.ZERO;let z=1;for(let X=I.sqr(j);z<O&&!I.eql(X,I.ONE);z++)X=I.sqr(X);const Z=I.pow(N,_1n$6<<BigInt(O-z-1));N=I.sqr(Z),U=I.mul(U,Z),j=I.mul(j,N),O=z}return U}}function FpSqrt(n){if(n%_4n===_3n$1){const r=(n+_1n$6)/_4n;return function(E,S){const C=E.pow(S,r);if(!E.eql(E.sqr(C),S))throw new Error("Cannot find square root");return C}}if(n%_8n$1===_5n$1){const r=(n-_5n$1)/_8n$1;return function(E,S){const C=E.mul(S,_2n$3),A=E.pow(C,r),I=E.mul(S,A),B=E.mul(E.mul(I,_2n$3),A),O=E.mul(I,E.sub(B,E.ONE));if(!E.eql(E.sqr(O),S))throw new Error("Cannot find square root");return O}}return tonelliShanks(n)}const isNegativeLE=(n,r)=>(mod(n,r)&_1n$6)===_1n$6,FIELD_FIELDS=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function validateField(n){const r={ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"},_=FIELD_FIELDS.reduce((E,S)=>(E[S]="function",E),r);return validateObject(n,_)}function FpPow(n,r,_){if(_<_0n$4)throw new Error("Expected power > 0");if(_===_0n$4)return n.ONE;if(_===_1n$6)return r;let E=n.ONE,S=r;for(;_>_0n$4;)_&_1n$6&&(E=n.mul(E,S)),S=n.sqr(S),_>>=_1n$6;return E}function FpInvertBatch(n,r){const _=new Array(r.length),E=r.reduce((C,A,I)=>n.is0(A)?C:(_[I]=C,n.mul(C,A)),n.ONE),S=n.inv(E);return r.reduceRight((C,A,I)=>n.is0(A)?C:(_[I]=n.mul(C,_[I]),n.mul(C,A)),S),_}function nLength(n,r){const _=r!==void 0?r:n.toString(2).length,E=Math.ceil(_/8);return{nBitLength:_,nByteLength:E}}function Field(n,r,_=!1,E={}){if(n<=_0n$4)throw new Error(`Expected Field ORDER > 0, got ${n}`);const{nBitLength:S,nByteLength:C}=nLength(n,r);if(C>2048)throw new Error("Field lengths over 2048 bytes are not supported");const A=FpSqrt(n),I=Object.freeze({ORDER:n,BITS:S,BYTES:C,MASK:bitMask(S),ZERO:_0n$4,ONE:_1n$6,create:B=>mod(B,n),isValid:B=>{if(typeof B!="bigint")throw new Error(`Invalid field element: expected bigint, got ${typeof B}`);return _0n$4<=B&&B<n},is0:B=>B===_0n$4,isOdd:B=>(B&_1n$6)===_1n$6,neg:B=>mod(-B,n),eql:(B,O)=>B===O,sqr:B=>mod(B*B,n),add:(B,O)=>mod(B+O,n),sub:(B,O)=>mod(B-O,n),mul:(B,O)=>mod(B*O,n),pow:(B,O)=>FpPow(I,B,O),div:(B,O)=>mod(B*invert(O,n),n),sqrN:B=>B*B,addN:(B,O)=>B+O,subN:(B,O)=>B-O,mulN:(B,O)=>B*O,inv:B=>invert(B,n),sqrt:E.sqrt||(B=>A(I,B)),invertBatch:B=>FpInvertBatch(I,B),cmov:(B,O,N)=>N?O:B,toBytes:B=>_?numberToBytesLE(B,C):numberToBytesBE(B,C),fromBytes:B=>{if(B.length!==C)throw new Error(`Fp.fromBytes: expected ${C}, got ${B.length}`);return _?bytesToNumberLE(B):bytesToNumberBE(B)}});return Object.freeze(I)}function FpSqrtEven(n,r){if(!n.isOdd)throw new Error("Field doesn't have isOdd");const _=n.sqrt(r);return n.isOdd(_)?n.neg(_):_}function getFieldBytesLength(n){if(typeof n!="bigint")throw new Error("field order must be bigint");const r=n.toString(2).length;return Math.ceil(r/8)}function getMinHashLength(n){const r=getFieldBytesLength(n);return r+Math.ceil(r/2)}function mapHashToField(n,r,_=!1){const E=n.length,S=getFieldBytesLength(r),C=getMinHashLength(r);if(E<16||E<C||E>1024)throw new Error(`expected ${C}-1024 bytes of input, got ${E}`);const A=_?bytesToNumberBE(n):bytesToNumberLE(n),I=mod(A,r-_1n$6)+_1n$6;return _?numberToBytesLE(I,S):numberToBytesBE(I,S)}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const _0n$3=BigInt(0),_1n$5=BigInt(1);function wNAF(n,r){const _=(S,C)=>{const A=C.negate();return S?A:C},E=S=>{const C=Math.ceil(r/S)+1,A=2**(S-1);return{windows:C,windowSize:A}};return{constTimeNegate:_,unsafeLadder(S,C){let A=n.ZERO,I=S;for(;C>_0n$3;)C&_1n$5&&(A=A.add(I)),I=I.double(),C>>=_1n$5;return A},precomputeWindow(S,C){const{windows:A,windowSize:I}=E(C),B=[];let O=S,N=O;for(let U=0;U<A;U++){N=O,B.push(N);for(let j=1;j<I;j++)N=N.add(O),B.push(N);O=N.double()}return B},wNAF(S,C,A){const{windows:I,windowSize:B}=E(S);let O=n.ZERO,N=n.BASE;const U=BigInt(2**S-1),j=2**S,z=BigInt(S);for(let Z=0;Z<I;Z++){const X=Z*B;let Q=Number(A&U);A>>=z,Q>B&&(Q-=j,A+=_1n$5);const se=X,oe=X+Math.abs(Q)-1,ue=Z%2!==0,we=Q<0;Q===0?N=N.add(_(ue,C[se])):O=O.add(_(we,C[oe]))}return{p:O,f:N}},wNAFCached(S,C,A,I){const B=S._WINDOW_SIZE||1;let O=C.get(S);return O||(O=this.precomputeWindow(S,B),B!==1&&C.set(S,I(O))),this.wNAF(B,O,A)}}}function validateBasic(n){return validateField(n.Fp),validateObject(n,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...nLength(n.n,n.nBitLength),...n,p:n.Fp.ORDER})}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const _0n$2=BigInt(0),_1n$4=BigInt(1),_2n$2=BigInt(2),_8n=BigInt(8),VERIFY_DEFAULT={zip215:!0};function validateOpts$2(n){const r=validateBasic(n);return validateObject(n,{hash:"function",a:"bigint",d:"bigint",randomBytes:"function"},{adjustScalarBytes:"function",domain:"function",uvRatio:"function",mapToCurve:"function"}),Object.freeze({...r})}function twistedEdwards(n){const r=validateOpts$2(n),{Fp:_,n:E,prehash:S,hash:C,randomBytes:A,nByteLength:I,h:B}=r,O=_2n$2<<BigInt(I*8)-_1n$4,N=_.create,U=r.uvRatio||((Ge,je)=>{try{return{isValid:!0,value:_.sqrt(Ge*_.inv(je))}}catch{return{isValid:!1,value:_0n$2}}}),j=r.adjustScalarBytes||(Ge=>Ge),z=r.domain||((Ge,je,Ve)=>{if(je.length||Ve)throw new Error("Contexts/pre-hash are not supported");return Ge}),Z=Ge=>typeof Ge=="bigint"&&_0n$2<Ge,X=(Ge,je)=>Z(Ge)&&Z(je)&&Ge<je,Q=Ge=>Ge===_0n$2||X(Ge,O);function se(Ge,je){if(X(Ge,je))return Ge;throw new Error(`Expected valid scalar < ${je}, got ${typeof Ge} ${Ge}`)}function oe(Ge){return Ge===_0n$2?Ge:se(Ge,E)}const ue=new Map;function we(Ge){if(!(Ge instanceof Te))throw new Error("ExtendedPoint expected")}class Te{constructor(je,Ve,Pe,Me){if(this.ex=je,this.ey=Ve,this.ez=Pe,this.et=Me,!Q(je))throw new Error("x required");if(!Q(Ve))throw new Error("y required");if(!Q(Pe))throw new Error("z required");if(!Q(Me))throw new Error("t required")}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static fromAffine(je){if(je instanceof Te)throw new Error("extended point not allowed");const{x:Ve,y:Pe}=je||{};if(!Q(Ve)||!Q(Pe))throw new Error("invalid affine point");return new Te(Ve,Pe,_1n$4,N(Ve*Pe))}static normalizeZ(je){const Ve=_.invertBatch(je.map(Pe=>Pe.ez));return je.map((Pe,Me)=>Pe.toAffine(Ve[Me])).map(Te.fromAffine)}_setWindowSize(je){this._WINDOW_SIZE=je,ue.delete(this)}assertValidity(){const{a:je,d:Ve}=r;if(this.is0())throw new Error("bad point: ZERO");const{ex:Pe,ey:Me,ez:tt,et:Ke}=this,mt=N(Pe*Pe),ct=N(Me*Me),Qe=N(tt*tt),dt=N(Qe*Qe),vt=N(mt*je),At=N(Qe*N(vt+ct)),bt=N(dt+N(Ve*N(mt*ct)));if(At!==bt)throw new Error("bad point: equation left != right (1)");const ft=N(Pe*Me),Et=N(tt*Ke);if(ft!==Et)throw new Error("bad point: equation left != right (2)")}equals(je){we(je);const{ex:Ve,ey:Pe,ez:Me}=this,{ex:tt,ey:Ke,ez:mt}=je,ct=N(Ve*mt),Qe=N(tt*Me),dt=N(Pe*mt),vt=N(Ke*Me);return ct===Qe&&dt===vt}is0(){return this.equals(Te.ZERO)}negate(){return new Te(N(-this.ex),this.ey,this.ez,N(-this.et))}double(){const{a:je}=r,{ex:Ve,ey:Pe,ez:Me}=this,tt=N(Ve*Ve),Ke=N(Pe*Pe),mt=N(_2n$2*N(Me*Me)),ct=N(je*tt),Qe=Ve+Pe,dt=N(N(Qe*Qe)-tt-Ke),vt=ct+Ke,At=vt-mt,bt=ct-Ke,ft=N(dt*At),Et=N(vt*bt),Ye=N(dt*bt),Ct=N(At*vt);return new Te(ft,Et,Ct,Ye)}add(je){we(je);const{a:Ve,d:Pe}=r,{ex:Me,ey:tt,ez:Ke,et:mt}=this,{ex:ct,ey:Qe,ez:dt,et:vt}=je;if(Ve===BigInt(-1)){const Mt=N((tt-Me)*(Qe+ct)),Wt=N((tt+Me)*(Qe-ct)),Zt=N(Wt-Mt);if(Zt===_0n$2)return this.double();const Yt=N(Ke*_2n$2*vt),ur=N(mt*_2n$2*dt),xt=ur+Yt,pt=Wt+Mt,yt=ur-Yt,Bt=N(xt*Zt),Ht=N(pt*yt),nr=N(xt*yt),Qt=N(Zt*pt);return new Te(Bt,Ht,Qt,nr)}const At=N(Me*ct),bt=N(tt*Qe),ft=N(mt*Pe*vt),Et=N(Ke*dt),Ye=N((Me+tt)*(ct+Qe)-At-bt),Ct=Et-ft,Pt=Et+ft,St=N(bt-Ve*At),$t=N(Ye*Ct),kt=N(Pt*St),Ft=N(Ye*St),qt=N(Ct*Pt);return new Te($t,kt,qt,Ft)}subtract(je){return this.add(je.negate())}wNAF(je){return Ne.wNAFCached(this,ue,je,Te.normalizeZ)}multiply(je){const{p:Ve,f:Pe}=this.wNAF(se(je,E));return Te.normalizeZ([Ve,Pe])[0]}multiplyUnsafe(je){let Ve=oe(je);return Ve===_0n$2?Re:this.equals(Re)||Ve===_1n$4?this:this.equals(xe)?this.wNAF(Ve).p:Ne.unsafeLadder(this,Ve)}isSmallOrder(){return this.multiplyUnsafe(B).is0()}isTorsionFree(){return Ne.unsafeLadder(this,E).is0()}toAffine(je){const{ex:Ve,ey:Pe,ez:Me}=this,tt=this.is0();je==null&&(je=tt?_8n:_.inv(Me));const Ke=N(Ve*je),mt=N(Pe*je),ct=N(Me*je);if(tt)return{x:_0n$2,y:_1n$4};if(ct!==_1n$4)throw new Error("invZ was invalid");return{x:Ke,y:mt}}clearCofactor(){const{h:je}=r;return je===_1n$4?this:this.multiplyUnsafe(je)}static fromHex(je,Ve=!1){const{d:Pe,a:Me}=r,tt=_.BYTES;je=ensureBytes$1("pointHex",je,tt);const Ke=je.slice(),mt=je[tt-1];Ke[tt-1]=mt&-129;const ct=bytesToNumberLE(Ke);ct===_0n$2||(Ve?se(ct,O):se(ct,_.ORDER));const Qe=N(ct*ct),dt=N(Qe-_1n$4),vt=N(Pe*Qe-Me);let{isValid:At,value:bt}=U(dt,vt);if(!At)throw new Error("Point.fromHex: invalid y coordinate");const ft=(bt&_1n$4)===_1n$4,Et=(mt&128)!==0;if(!Ve&&bt===_0n$2&&Et)throw new Error("Point.fromHex: x=0 and x_0=1");return Et!==ft&&(bt=N(-bt)),Te.fromAffine({x:bt,y:ct})}static fromPrivateKey(je){return nt(je).point}toRawBytes(){const{x:je,y:Ve}=this.toAffine(),Pe=numberToBytesLE(Ve,_.BYTES);return Pe[Pe.length-1]|=je&_1n$4?128:0,Pe}toHex(){return bytesToHex(this.toRawBytes())}}Te.BASE=new Te(r.Gx,r.Gy,_1n$4,N(r.Gx*r.Gy)),Te.ZERO=new Te(_0n$2,_1n$4,_1n$4,_0n$2);const{BASE:xe,ZERO:Re}=Te,Ne=wNAF(Te,I*8);function Fe(Ge){return mod(Ge,E)}function ht(Ge){return Fe(bytesToNumberLE(Ge))}function nt(Ge){const je=I;Ge=ensureBytes$1("private key",Ge,je);const Ve=ensureBytes$1("hashed private key",C(Ge),2*je),Pe=j(Ve.slice(0,je)),Me=Ve.slice(je,2*je),tt=ht(Pe),Ke=xe.multiply(tt),mt=Ke.toRawBytes();return{head:Pe,prefix:Me,scalar:tt,point:Ke,pointBytes:mt}}function Ee(Ge){return nt(Ge).pointBytes}function Ce(Ge=new Uint8Array,...je){const Ve=concatBytes(...je);return ht(C(z(Ve,ensureBytes$1("context",Ge),!!S)))}function _e(Ge,je,Ve={}){Ge=ensureBytes$1("message",Ge),S&&(Ge=S(Ge));const{prefix:Pe,scalar:Me,pointBytes:tt}=nt(je),Ke=Ce(Ve.context,Pe,Ge),mt=xe.multiply(Ke).toRawBytes(),ct=Ce(Ve.context,mt,tt,Ge),Qe=Fe(Ke+ct*Me);oe(Qe);const dt=concatBytes(mt,numberToBytesLE(Qe,_.BYTES));return ensureBytes$1("result",dt,I*2)}const Ie=VERIFY_DEFAULT;function He(Ge,je,Ve,Pe=Ie){const{context:Me,zip215:tt}=Pe,Ke=_.BYTES;Ge=ensureBytes$1("signature",Ge,2*Ke),je=ensureBytes$1("message",je),S&&(je=S(je));const mt=bytesToNumberLE(Ge.slice(Ke,2*Ke));let ct,Qe,dt;try{ct=Te.fromHex(Ve,tt),Qe=Te.fromHex(Ge.slice(0,Ke),tt),dt=xe.multiplyUnsafe(mt)}catch{return!1}if(!tt&&ct.isSmallOrder())return!1;const vt=Ce(Me,Qe.toRawBytes(),ct.toRawBytes(),je);return Qe.add(ct.multiplyUnsafe(vt)).subtract(dt).clearCofactor().equals(Te.ZERO)}return xe._setWindowSize(8),{CURVE:r,getPublicKey:Ee,sign:_e,verify:He,ExtendedPoint:Te,utils:{getExtendedPublicKey:nt,randomPrivateKey:()=>A(_.BYTES),precompute(Ge=8,je=Te.BASE){return je._setWindowSize(Ge),je.multiply(BigInt(3)),je}}}}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const _0n$1=BigInt(0),_1n$3=BigInt(1);function validateOpts$1(n){return validateObject(n,{a:"bigint"},{montgomeryBits:"isSafeInteger",nByteLength:"isSafeInteger",adjustScalarBytes:"function",domain:"function",powPminus2:"function",Gu:"bigint"}),Object.freeze({...n})}function montgomery(n){const r=validateOpts$1(n),{P:_}=r,E=ue=>mod(ue,_),S=r.montgomeryBits,C=Math.ceil(S/8),A=r.nByteLength,I=r.adjustScalarBytes||(ue=>ue),B=r.powPminus2||(ue=>pow(ue,_-BigInt(2),_));function O(ue,we,Te){const xe=E(ue*(we-Te));return we=E(we-xe),Te=E(Te+xe),[we,Te]}function N(ue){if(typeof ue=="bigint"&&_0n$1<=ue&&ue<_)return ue;throw new Error("Expected valid scalar 0 < scalar < CURVE.P")}const U=(r.a-BigInt(2))/BigInt(4);function j(ue,we){const Te=N(ue),xe=N(we),Re=Te;let Ne=_1n$3,Fe=_0n$1,ht=Te,nt=_1n$3,Ee=_0n$1,Ce;for(let Ie=BigInt(S-1);Ie>=_0n$1;Ie--){const He=xe>>Ie&_1n$3;Ee^=He,Ce=O(Ee,Ne,ht),Ne=Ce[0],ht=Ce[1],Ce=O(Ee,Fe,nt),Fe=Ce[0],nt=Ce[1],Ee=He;const Be=Ne+Fe,Ge=E(Be*Be),je=Ne-Fe,Ve=E(je*je),Pe=Ge-Ve,Me=ht+nt,tt=ht-nt,Ke=E(tt*Be),mt=E(Me*je),ct=Ke+mt,Qe=Ke-mt;ht=E(ct*ct),nt=E(Re*E(Qe*Qe)),Ne=E(Ge*Ve),Fe=E(Pe*(Ge+E(U*Pe)))}Ce=O(Ee,Ne,ht),Ne=Ce[0],ht=Ce[1],Ce=O(Ee,Fe,nt),Fe=Ce[0],nt=Ce[1];const _e=B(Fe);return E(Ne*_e)}function z(ue){return numberToBytesLE(E(ue),C)}function Z(ue){const we=ensureBytes$1("u coordinate",ue,C);return A===32&&(we[31]&=127),bytesToNumberLE(we)}function X(ue){const we=ensureBytes$1("scalar",ue),Te=we.length;if(Te!==C&&Te!==A)throw new Error(`Expected ${C} or ${A} bytes, got ${Te}`);return bytesToNumberLE(I(we))}function Q(ue,we){const Te=Z(we),xe=X(ue),Re=j(Te,xe);if(Re===_0n$1)throw new Error("Invalid private or public key received");return z(Re)}const se=z(r.Gu);function oe(ue){return Q(ue,se)}return{scalarMult:Q,scalarMultBase:oe,getSharedSecret:(ue,we)=>Q(ue,we),getPublicKey:ue=>oe(ue),utils:{randomPrivateKey:()=>r.randomBytes(r.nByteLength)},GuBytes:se}}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const ED25519_P=BigInt("57896044618658097711785492504343953926634992332820282019728792003956564819949"),ED25519_SQRT_M1=BigInt("19681161376707505956807079304988542015446066515923890162744021073123829784752");BigInt(0);const _1n$2=BigInt(1),_2n$1=BigInt(2),_5n=BigInt(5),_10n=BigInt(10),_20n=BigInt(20),_40n=BigInt(40),_80n=BigInt(80);function ed25519_pow_2_252_3(n){const r=ED25519_P,E=n*n%r*n%r,S=pow2(E,_2n$1,r)*E%r,C=pow2(S,_1n$2,r)*n%r,A=pow2(C,_5n,r)*C%r,I=pow2(A,_10n,r)*A%r,B=pow2(I,_20n,r)*I%r,O=pow2(B,_40n,r)*B%r,N=pow2(O,_80n,r)*O%r,U=pow2(N,_80n,r)*O%r,j=pow2(U,_10n,r)*A%r;return{pow_p_5_8:pow2(j,_2n$1,r)*n%r,b2:E}}function adjustScalarBytes(n){return n[0]&=248,n[31]&=127,n[31]|=64,n}function uvRatio(n,r){const _=ED25519_P,E=mod(r*r*r,_),S=mod(E*E*r,_),C=ed25519_pow_2_252_3(n*S).pow_p_5_8;let A=mod(n*E*C,_);const I=mod(r*A*A,_),B=A,O=mod(A*ED25519_SQRT_M1,_),N=I===n,U=I===mod(-n,_),j=I===mod(-n*ED25519_SQRT_M1,_);return N&&(A=B),(U||j)&&(A=O),isNegativeLE(A,_)&&(A=mod(-A,_)),{isValid:N||U,value:A}}const Fp$1=Field(ED25519_P,void 0,!0),ed25519Defaults={a:BigInt(-1),d:BigInt("37095705934669439343138083508754565189542113879843219016388785533085940283555"),Fp:Fp$1,n:BigInt("7237005577332262213973186563042994240857116359379907606001950938285454250989"),h:BigInt(8),Gx:BigInt("15112221349535400772501151409588531511454012693041857206046113283949847762202"),Gy:BigInt("46316835694926478169428394003475163141307993866256225615783033603165251855960"),hash:sha512$1,randomBytes:randomBytes$3,adjustScalarBytes,uvRatio},ed25519=twistedEdwards(ed25519Defaults);function ed25519_domain(n,r,_){if(r.length>255)throw new Error("Context is too big");return concatBytes$1(utf8ToBytes$2("SigEd25519 no Ed25519 collisions"),new Uint8Array([_?1:0,r.length]),r,n)}({...ed25519Defaults});({...ed25519Defaults});const x25519=montgomery({P:ED25519_P,a:BigInt(486662),montgomeryBits:255,nByteLength:32,Gu:BigInt(9),powPminus2:n=>{const r=ED25519_P,{pow_p_5_8:_,b2:E}=ed25519_pow_2_252_3(n);return mod(pow2(_,BigInt(3),r)*E,r)},adjustScalarBytes,randomBytes:randomBytes$3}),ELL2_C1=(Fp$1.ORDER+BigInt(3))/BigInt(8);Fp$1.pow(_2n$1,ELL2_C1);Fp$1.sqrt(Fp$1.neg(Fp$1.ONE));(Fp$1.ORDER-BigInt(5))/BigInt(8);BigInt(486662);FpSqrtEven(Fp$1,Fp$1.neg(BigInt(486664)));BigInt("25063068953384623474111414158702152701244531502492656460079210482610430750235");BigInt("54469307008909316920995813868745141605393597292927456921205312896311721017578");BigInt("1159843021668779879193775521855586647937357759715417654439879720876111806838");BigInt("40440834346308536858101042469323190826248399146238708352240133220865137265952");BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff");const PUBLIC_KEY_BYTE_LENGTH$2=32,PRIVATE_KEY_BYTE_LENGTH$2=64,KEYS_BYTE_LENGTH$2=32;function generateKey$8(){const n=ed25519.utils.randomPrivateKey(),r=ed25519.getPublicKey(n);return{privateKey:concatKeys$2(n,r),publicKey:r}}function generateKeyFromSeed$2(n){if(n.length!==KEYS_BYTE_LENGTH$2)throw new TypeError('"seed" must be 32 bytes in length.');if(!(n instanceof Uint8Array))throw new TypeError('"seed" must be a node.js Buffer, or Uint8Array.');const r=n,_=ed25519.getPublicKey(r);return{privateKey:concatKeys$2(r,_),publicKey:_}}function hashAndSign$8(n,r){const _=n.subarray(0,KEYS_BYTE_LENGTH$2);return ed25519.sign(r instanceof Uint8Array?r:r.subarray(),_)}function hashAndVerify$8(n,r,_){return ed25519.verify(r,_ instanceof Uint8Array?_:_.subarray(),n)}function concatKeys$2(n,r){const _=new Uint8Array(PRIVATE_KEY_BYTE_LENGTH$2);for(let E=0;E<KEYS_BYTE_LENGTH$2;E++)_[E]=n[E],_[KEYS_BYTE_LENGTH$2+E]=r[E];return _}const derivedEmptyPasswordKey$2={alg:"A128GCM",ext:!0,k:"scm9jmO_4BJAgdwWGVulLg",key_ops:["encrypt","decrypt"],kty:"oct"};function create$2(n){const r=n?.algorithm??"AES-GCM";let _=n?.keyLength??16;const E=n?.nonceLength??12,S=n?.digest??"SHA-256",C=n?.saltLength??16,A=n?.iterations??32767,I=webcrypto$2.get();_*=8;async function B(U,j){const z=I.getRandomValues(new Uint8Array(C)),Z=I.getRandomValues(new Uint8Array(E)),X={name:r,iv:Z};typeof j=="string"&&(j=fromString$3(j));let Q;if(j.length===0){Q=await I.subtle.importKey("jwk",derivedEmptyPasswordKey$2,{name:"AES-GCM"},!0,["encrypt"]);try{const oe={name:"PBKDF2",salt:z,iterations:A,hash:{name:S}},ue=await I.subtle.importKey("raw",j,{name:"PBKDF2"},!1,["deriveKey"]);Q=await I.subtle.deriveKey(oe,ue,{name:r,length:_},!0,["encrypt"])}catch{Q=await I.subtle.importKey("jwk",derivedEmptyPasswordKey$2,{name:"AES-GCM"},!0,["encrypt"])}}else{const oe={name:"PBKDF2",salt:z,iterations:A,hash:{name:S}},ue=await I.subtle.importKey("raw",j,{name:"PBKDF2"},!1,["deriveKey"]);Q=await I.subtle.deriveKey(oe,ue,{name:r,length:_},!0,["encrypt"])}const se=await I.subtle.encrypt(X,Q,U);return concat$4([z,X.iv,new Uint8Array(se)])}async function O(U,j){const z=U.subarray(0,C),Z=U.subarray(C,C+E),X=U.subarray(C+E),Q={name:r,iv:Z};typeof j=="string"&&(j=fromString$3(j));let se;if(j.length===0)try{const ue={name:"PBKDF2",salt:z,iterations:A,hash:{name:S}},we=await I.subtle.importKey("raw",j,{name:"PBKDF2"},!1,["deriveKey"]);se=await I.subtle.deriveKey(ue,we,{name:r,length:_},!0,["decrypt"])}catch{se=await I.subtle.importKey("jwk",derivedEmptyPasswordKey$2,{name:"AES-GCM"},!0,["decrypt"])}else{const ue={name:"PBKDF2",salt:z,iterations:A,hash:{name:S}},we=await I.subtle.importKey("raw",j,{name:"PBKDF2"},!1,["deriveKey"]);se=await I.subtle.deriveKey(ue,we,{name:r,length:_},!0,["decrypt"])}const oe=await I.subtle.decrypt(Q,se,X);return new Uint8Array(oe)}return{encrypt:B,decrypt:O}}async function exporter$3(n,r){const E=await create$2().encrypt(n,r);return base64$5.encode(E)}const N1$2=Math.pow(2,7),N2$2=Math.pow(2,14),N3$2=Math.pow(2,21),N4$2=Math.pow(2,28),N5$2=Math.pow(2,35),N6$2=Math.pow(2,42),N7$2=Math.pow(2,49),MSB$5=128,REST$5=127;function encodingLength(n){if(n<N1$2)return 1;if(n<N2$2)return 2;if(n<N3$2)return 3;if(n<N4$2)return 4;if(n<N5$2)return 5;if(n<N6$2)return 6;if(n<N7$2)return 7;if(Number.MAX_SAFE_INTEGER!=null&&n>Number.MAX_SAFE_INTEGER)throw new RangeError("Could not encode varint");return 8}function encodeUint8Array(n,r,_=0){switch(encodingLength(n)){case 8:r[_++]=n&255|MSB$5,n/=128;case 7:r[_++]=n&255|MSB$5,n/=128;case 6:r[_++]=n&255|MSB$5,n/=128;case 5:r[_++]=n&255|MSB$5,n/=128;case 4:r[_++]=n&255|MSB$5,n>>>=7;case 3:r[_++]=n&255|MSB$5,n>>>=7;case 2:r[_++]=n&255|MSB$5,n>>>=7;case 1:{r[_++]=n&255,n>>>=7;break}default:throw new Error("unreachable")}return r}function encodeUint8ArrayList(n,r,_=0){switch(encodingLength(n)){case 8:r.set(_++,n&255|MSB$5),n/=128;case 7:r.set(_++,n&255|MSB$5),n/=128;case 6:r.set(_++,n&255|MSB$5),n/=128;case 5:r.set(_++,n&255|MSB$5),n/=128;case 4:r.set(_++,n&255|MSB$5),n>>>=7;case 3:r.set(_++,n&255|MSB$5),n>>>=7;case 2:r.set(_++,n&255|MSB$5),n>>>=7;case 1:{r.set(_++,n&255),n>>>=7;break}default:throw new Error("unreachable")}return r}function decodeUint8Array(n,r){let _=n[r],E=0;if(E+=_&REST$5,_<MSB$5||(_=n[r+1],E+=(_&REST$5)<<7,_<MSB$5)||(_=n[r+2],E+=(_&REST$5)<<14,_<MSB$5)||(_=n[r+3],E+=(_&REST$5)<<21,_<MSB$5)||(_=n[r+4],E+=(_&REST$5)*N4$2,_<MSB$5)||(_=n[r+5],E+=(_&REST$5)*N5$2,_<MSB$5)||(_=n[r+6],E+=(_&REST$5)*N6$2,_<MSB$5)||(_=n[r+7],E+=(_&REST$5)*N7$2,_<MSB$5))return E;throw new RangeError("Could not decode varint")}function decodeUint8ArrayList(n,r){let _=n.get(r),E=0;if(E+=_&REST$5,_<MSB$5||(_=n.get(r+1),E+=(_&REST$5)<<7,_<MSB$5)||(_=n.get(r+2),E+=(_&REST$5)<<14,_<MSB$5)||(_=n.get(r+3),E+=(_&REST$5)<<21,_<MSB$5)||(_=n.get(r+4),E+=(_&REST$5)*N4$2,_<MSB$5)||(_=n.get(r+5),E+=(_&REST$5)*N5$2,_<MSB$5)||(_=n.get(r+6),E+=(_&REST$5)*N6$2,_<MSB$5)||(_=n.get(r+7),E+=(_&REST$5)*N7$2,_<MSB$5))return E;throw new RangeError("Could not decode varint")}function encode$b(n,r,_=0){return r==null&&(r=allocUnsafe$1(encodingLength(n))),r instanceof Uint8Array?encodeUint8Array(n,r,_):encodeUint8ArrayList(n,r,_)}function decode$b(n,r=0){return n instanceof Uint8Array?decodeUint8Array(n,r):decodeUint8ArrayList(n,r)}const f32=new Float32Array([-0]),f8b=new Uint8Array(f32.buffer);function writeFloatLE(n,r,_){f32[0]=n,r[_]=f8b[0],r[_+1]=f8b[1],r[_+2]=f8b[2],r[_+3]=f8b[3]}function readFloatLE(n,r){return f8b[0]=n[r],f8b[1]=n[r+1],f8b[2]=n[r+2],f8b[3]=n[r+3],f32[0]}const f64=new Float64Array([-0]),d8b=new Uint8Array(f64.buffer);function writeDoubleLE(n,r,_){f64[0]=n,r[_]=d8b[0],r[_+1]=d8b[1],r[_+2]=d8b[2],r[_+3]=d8b[3],r[_+4]=d8b[4],r[_+5]=d8b[5],r[_+6]=d8b[6],r[_+7]=d8b[7]}function readDoubleLE(n,r){return d8b[0]=n[r],d8b[1]=n[r+1],d8b[2]=n[r+2],d8b[3]=n[r+3],d8b[4]=n[r+4],d8b[5]=n[r+5],d8b[6]=n[r+6],d8b[7]=n[r+7],f64[0]}const MAX_SAFE_NUMBER_INTEGER=BigInt(Number.MAX_SAFE_INTEGER),MIN_SAFE_NUMBER_INTEGER=BigInt(Number.MIN_SAFE_INTEGER);class LongBits{lo;hi;constructor(r,_){this.lo=r|0,this.hi=_|0}toNumber(r=!1){if(!r&&this.hi>>>31>0){const _=~this.lo+1>>>0;let E=~this.hi>>>0;return _===0&&(E=E+1>>>0),-(_+E*4294967296)}return this.lo+this.hi*4294967296}toBigInt(r=!1){if(r)return BigInt(this.lo>>>0)+(BigInt(this.hi>>>0)<<32n);if(this.hi>>>31){const _=~this.lo+1>>>0;let E=~this.hi>>>0;return _===0&&(E=E+1>>>0),-(BigInt(_)+(BigInt(E)<<32n))}return BigInt(this.lo>>>0)+(BigInt(this.hi>>>0)<<32n)}toString(r=!1){return this.toBigInt(r).toString()}zzEncode(){const r=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^r)>>>0,this.lo=(this.lo<<1^r)>>>0,this}zzDecode(){const r=-(this.lo&1);return this.lo=((this.lo>>>1|this.hi<<31)^r)>>>0,this.hi=(this.hi>>>1^r)>>>0,this}length(){const r=this.lo,_=(this.lo>>>28|this.hi<<4)>>>0,E=this.hi>>>24;return E===0?_===0?r<16384?r<128?1:2:r<2097152?3:4:_<16384?_<128?5:6:_<2097152?7:8:E<128?9:10}static fromBigInt(r){if(r===0n)return zero;if(r<MAX_SAFE_NUMBER_INTEGER&&r>MIN_SAFE_NUMBER_INTEGER)return this.fromNumber(Number(r));const _=r<0n;_&&(r=-r);let E=r>>32n,S=r-(E<<32n);return _&&(E=~E|0n,S=~S|0n,++S>TWO_32&&(S=0n,++E>TWO_32&&(E=0n))),new LongBits(Number(S),Number(E))}static fromNumber(r){if(r===0)return zero;const _=r<0;_&&(r=-r);let E=r>>>0,S=(r-E)/4294967296>>>0;return _&&(S=~S>>>0,E=~E>>>0,++E>4294967295&&(E=0,++S>4294967295&&(S=0))),new LongBits(E,S)}static from(r){return typeof r=="number"?LongBits.fromNumber(r):typeof r=="bigint"?LongBits.fromBigInt(r):typeof r=="string"?LongBits.fromBigInt(BigInt(r)):r.low!=null||r.high!=null?new LongBits(r.low>>>0,r.high>>>0):zero}}const zero=new LongBits(0,0);zero.toBigInt=function(){return 0n};zero.zzEncode=zero.zzDecode=function(){return this};zero.length=function(){return 1};const TWO_32=4294967296n;function length$3(n){let r=0,_=0;for(let E=0;E<n.length;++E)_=n.charCodeAt(E),_<128?r+=1:_<2048?r+=2:(_&64512)===55296&&(n.charCodeAt(E+1)&64512)===56320?(++E,r+=4):r+=3;return r}function read$3(n,r,_){if(_-r<1)return"";let S;const C=[];let A=0,I;for(;r<_;)I=n[r++],I<128?C[A++]=I:I>191&&I<224?C[A++]=(I&31)<<6|n[r++]&63:I>239&&I<365?(I=((I&7)<<18|(n[r++]&63)<<12|(n[r++]&63)<<6|n[r++]&63)-65536,C[A++]=55296+(I>>10),C[A++]=56320+(I&1023)):C[A++]=(I&15)<<12|(n[r++]&63)<<6|n[r++]&63,A>8191&&((S??(S=[])).push(String.fromCharCode.apply(String,C)),A=0);return S!=null?(A>0&&S.push(String.fromCharCode.apply(String,C.slice(0,A))),S.join("")):String.fromCharCode.apply(String,C.slice(0,A))}function write$1(n,r,_){const E=_;let S,C;for(let A=0;A<n.length;++A)S=n.charCodeAt(A),S<128?r[_++]=S:S<2048?(r[_++]=S>>6|192,r[_++]=S&63|128):(S&64512)===55296&&((C=n.charCodeAt(A+1))&64512)===56320?(S=65536+((S&1023)<<10)+(C&1023),++A,r[_++]=S>>18|240,r[_++]=S>>12&63|128,r[_++]=S>>6&63|128,r[_++]=S&63|128):(r[_++]=S>>12|224,r[_++]=S>>6&63|128,r[_++]=S&63|128);return _-E}function indexOutOfRange(n,r){return RangeError(`index out of range: ${n.pos} + ${r??1} > ${n.len}`)}function readFixed32End(n,r){return(n[r-4]|n[r-3]<<8|n[r-2]<<16|n[r-1]<<24)>>>0}class Uint8ArrayReader{buf;pos;len;_slice=Uint8Array.prototype.subarray;constructor(r){this.buf=r,this.pos=0,this.len=r.length}uint32(){let r=4294967295;if(r=(this.buf[this.pos]&127)>>>0,this.buf[this.pos++]<128||(r=(r|(this.buf[this.pos]&127)<<7)>>>0,this.buf[this.pos++]<128)||(r=(r|(this.buf[this.pos]&127)<<14)>>>0,this.buf[this.pos++]<128)||(r=(r|(this.buf[this.pos]&127)<<21)>>>0,this.buf[this.pos++]<128)||(r=(r|(this.buf[this.pos]&15)<<28)>>>0,this.buf[this.pos++]<128))return r;if((this.pos+=5)>this.len)throw this.pos=this.len,indexOutOfRange(this,10);return r}int32(){return this.uint32()|0}sint32(){const r=this.uint32();return r>>>1^-(r&1)|0}bool(){return this.uint32()!==0}fixed32(){if(this.pos+4>this.len)throw indexOutOfRange(this,4);return readFixed32End(this.buf,this.pos+=4)}sfixed32(){if(this.pos+4>this.len)throw indexOutOfRange(this,4);return readFixed32End(this.buf,this.pos+=4)|0}float(){if(this.pos+4>this.len)throw indexOutOfRange(this,4);const r=readFloatLE(this.buf,this.pos);return this.pos+=4,r}double(){if(this.pos+8>this.len)throw indexOutOfRange(this,4);const r=readDoubleLE(this.buf,this.pos);return this.pos+=8,r}bytes(){const r=this.uint32(),_=this.pos,E=this.pos+r;if(E>this.len)throw indexOutOfRange(this,r);return this.pos+=r,_===E?new Uint8Array(0):this.buf.subarray(_,E)}string(){const r=this.bytes();return read$3(r,0,r.length)}skip(r){if(typeof r=="number"){if(this.pos+r>this.len)throw indexOutOfRange(this,r);this.pos+=r}else do if(this.pos>=this.len)throw indexOutOfRange(this);while(this.buf[this.pos++]&128);return this}skipType(r){switch(r){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;(r=this.uint32()&7)!==4;)this.skipType(r);break;case 5:this.skip(4);break;default:throw Error(`invalid wire type ${r} at offset ${this.pos}`)}return this}readLongVarint(){const r=new LongBits(0,0);let _=0;if(this.len-this.pos>4){for(;_<4;++_)if(r.lo=(r.lo|(this.buf[this.pos]&127)<<_*7)>>>0,this.buf[this.pos++]<128)return r;if(r.lo=(r.lo|(this.buf[this.pos]&127)<<28)>>>0,r.hi=(r.hi|(this.buf[this.pos]&127)>>4)>>>0,this.buf[this.pos++]<128)return r;_=0}else{for(;_<3;++_){if(this.pos>=this.len)throw indexOutOfRange(this);if(r.lo=(r.lo|(this.buf[this.pos]&127)<<_*7)>>>0,this.buf[this.pos++]<128)return r}return r.lo=(r.lo|(this.buf[this.pos++]&127)<<_*7)>>>0,r}if(this.len-this.pos>4){for(;_<5;++_)if(r.hi=(r.hi|(this.buf[this.pos]&127)<<_*7+3)>>>0,this.buf[this.pos++]<128)return r}else for(;_<5;++_){if(this.pos>=this.len)throw indexOutOfRange(this);if(r.hi=(r.hi|(this.buf[this.pos]&127)<<_*7+3)>>>0,this.buf[this.pos++]<128)return r}throw Error("invalid varint encoding")}readFixed64(){if(this.pos+8>this.len)throw indexOutOfRange(this,8);const r=readFixed32End(this.buf,this.pos+=4),_=readFixed32End(this.buf,this.pos+=4);return new LongBits(r,_)}int64(){return this.readLongVarint().toBigInt()}int64Number(){return this.readLongVarint().toNumber()}int64String(){return this.readLongVarint().toString()}uint64(){return this.readLongVarint().toBigInt(!0)}uint64Number(){const r=decodeUint8Array(this.buf,this.pos);return this.pos+=encodingLength(r),r}uint64String(){return this.readLongVarint().toString(!0)}sint64(){return this.readLongVarint().zzDecode().toBigInt()}sint64Number(){return this.readLongVarint().zzDecode().toNumber()}sint64String(){return this.readLongVarint().zzDecode().toString()}fixed64(){return this.readFixed64().toBigInt()}fixed64Number(){return this.readFixed64().toNumber()}fixed64String(){return this.readFixed64().toString()}sfixed64(){return this.readFixed64().toBigInt()}sfixed64Number(){return this.readFixed64().toNumber()}sfixed64String(){return this.readFixed64().toString()}}function createReader(n){return new Uint8ArrayReader(n instanceof Uint8Array?n:n.subarray())}function decodeMessage$1(n,r,_){const E=createReader(n);return r.decode(E,void 0,_)}function pool(n){const r=n??8192,_=r>>>1;let E,S=r;return function(A){if(A<1||A>_)return allocUnsafe$1(A);S+A>r&&(E=allocUnsafe$1(r),S=0);const I=E.subarray(S,S+=A);return S&7&&(S=(S|7)+1),I}}class Op{fn;len;next;val;constructor(r,_,E){this.fn=r,this.len=_,this.next=void 0,this.val=E}}function noop(){}class State{head;tail;len;next;constructor(r){this.head=r.head,this.tail=r.tail,this.len=r.len,this.next=r.states}}const bufferPool=pool();function alloc(n){return globalThis.Buffer!=null?allocUnsafe$1(n):bufferPool(n)}class Uint8ArrayWriter{len;head;tail;states;constructor(){this.len=0,this.head=new Op(noop,0,0),this.tail=this.head,this.states=null}_push(r,_,E){return this.tail=this.tail.next=new Op(r,_,E),this.len+=_,this}uint32(r){return this.len+=(this.tail=this.tail.next=new VarintOp((r=r>>>0)<128?1:r<16384?2:r<2097152?3:r<268435456?4:5,r)).len,this}int32(r){return r<0?this._push(writeVarint64,10,LongBits.fromNumber(r)):this.uint32(r)}sint32(r){return this.uint32((r<<1^r>>31)>>>0)}uint64(r){const _=LongBits.fromBigInt(r);return this._push(writeVarint64,_.length(),_)}uint64Number(r){return this._push(encodeUint8Array,encodingLength(r),r)}uint64String(r){return this.uint64(BigInt(r))}int64(r){return this.uint64(r)}int64Number(r){return this.uint64Number(r)}int64String(r){return this.uint64String(r)}sint64(r){const _=LongBits.fromBigInt(r).zzEncode();return this._push(writeVarint64,_.length(),_)}sint64Number(r){const _=LongBits.fromNumber(r).zzEncode();return this._push(writeVarint64,_.length(),_)}sint64String(r){return this.sint64(BigInt(r))}bool(r){return this._push(writeByte,1,r?1:0)}fixed32(r){return this._push(writeFixed32,4,r>>>0)}sfixed32(r){return this.fixed32(r)}fixed64(r){const _=LongBits.fromBigInt(r);return this._push(writeFixed32,4,_.lo)._push(writeFixed32,4,_.hi)}fixed64Number(r){const _=LongBits.fromNumber(r);return this._push(writeFixed32,4,_.lo)._push(writeFixed32,4,_.hi)}fixed64String(r){return this.fixed64(BigInt(r))}sfixed64(r){return this.fixed64(r)}sfixed64Number(r){return this.fixed64Number(r)}sfixed64String(r){return this.fixed64String(r)}float(r){return this._push(writeFloatLE,4,r)}double(r){return this._push(writeDoubleLE,8,r)}bytes(r){const _=r.length>>>0;return _===0?this._push(writeByte,1,0):this.uint32(_)._push(writeBytes,_,r)}string(r){const _=length$3(r);return _!==0?this.uint32(_)._push(write$1,_,r):this._push(writeByte,1,0)}fork(){return this.states=new State(this),this.head=this.tail=new Op(noop,0,0),this.len=0,this}reset(){return this.states!=null?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new Op(noop,0,0),this.len=0),this}ldelim(){const r=this.head,_=this.tail,E=this.len;return this.reset().uint32(E),E!==0&&(this.tail.next=r.next,this.tail=_,this.len+=E),this}finish(){let r=this.head.next;const _=alloc(this.len);let E=0;for(;r!=null;)r.fn(r.val,_,E),E+=r.len,r=r.next;return _}}function writeByte(n,r,_){r[_]=n&255}function writeVarint32(n,r,_){for(;n>127;)r[_++]=n&127|128,n>>>=7;r[_]=n}class VarintOp extends Op{next;constructor(r,_){super(writeVarint32,r,_),this.next=void 0}}function writeVarint64(n,r,_){for(;n.hi!==0;)r[_++]=n.lo&127|128,n.lo=(n.lo>>>7|n.hi<<25)>>>0,n.hi>>>=7;for(;n.lo>127;)r[_++]=n.lo&127|128,n.lo=n.lo>>>7;r[_++]=n.lo}function writeFixed32(n,r,_){r[_]=n&255,r[_+1]=n>>>8&255,r[_+2]=n>>>16&255,r[_+3]=n>>>24}function writeBytes(n,r,_){r.set(n,_)}globalThis.Buffer!=null&&(Uint8ArrayWriter.prototype.bytes=function(n){const r=n.length>>>0;return this.uint32(r),r>0&&this._push(writeBytesBuffer,r,n),this},Uint8ArrayWriter.prototype.string=function(n){const r=globalThis.Buffer.byteLength(n);return this.uint32(r),r>0&&this._push(writeStringBuffer,r,n),this});function writeBytesBuffer(n,r,_){r.set(n,_)}function writeStringBuffer(n,r,_){n.length<40?write$1(n,r,_):r.utf8Write!=null?r.utf8Write(n,_):r.set(fromString$3(n),_)}function createWriter(){return new Uint8ArrayWriter}function encodeMessage(n,r){const _=createWriter();return r.encode(n,_,{lengthDelimited:!1}),_.finish()}var CODEC_TYPES;(function(n){n[n.VARINT=0]="VARINT",n[n.BIT64=1]="BIT64",n[n.LENGTH_DELIMITED=2]="LENGTH_DELIMITED",n[n.START_GROUP=3]="START_GROUP",n[n.END_GROUP=4]="END_GROUP",n[n.BIT32=5]="BIT32"})(CODEC_TYPES||(CODEC_TYPES={}));function createCodec$2(n,r,_,E){return{name:n,type:r,encode:_,decode:E}}function enumeration(n){function r(S){if(n[S.toString()]==null)throw new Error("Invalid enum value");return n[S]}const _=function(C,A){const I=r(C);A.int32(I)},E=function(C){const A=C.int32();return r(A)};return createCodec$2("enum",CODEC_TYPES.VARINT,_,E)}function message(n,r){return createCodec$2("message",CODEC_TYPES.LENGTH_DELIMITED,n,r)}let CodeError$3=class extends Error{code;constructor(r,_,E){super(r,E),this.code=_}};var KeyType$2;(function(n){n.RSA="RSA",n.Ed25519="Ed25519",n.Secp256k1="Secp256k1"})(KeyType$2||(KeyType$2={}));var __KeyTypeValues$2;(function(n){n[n.RSA=0]="RSA",n[n.Ed25519=1]="Ed25519",n[n.Secp256k1=2]="Secp256k1"})(__KeyTypeValues$2||(__KeyTypeValues$2={}));(function(n){n.codec=()=>enumeration(__KeyTypeValues$2)})(KeyType$2||(KeyType$2={}));var PublicKey$2;(function(n){let r;n.codec=()=>(r==null&&(r=message((_,E,S={})=>{S.lengthDelimited!==!1&&E.fork(),_.Type!=null&&(E.uint32(8),KeyType$2.codec().encode(_.Type,E)),_.Data!=null&&(E.uint32(18),E.bytes(_.Data)),S.lengthDelimited!==!1&&E.ldelim()},(_,E)=>{const S={},C=E==null?_.len:_.pos+E;for(;_.pos<C;){const A=_.uint32();switch(A>>>3){case 1:S.Type=KeyType$2.codec().decode(_);break;case 2:S.Data=_.bytes();break;default:_.skipType(A&7);break}}return S})),r),n.encode=_=>encodeMessage(_,n.codec()),n.decode=_=>decodeMessage$1(_,n.codec())})(PublicKey$2||(PublicKey$2={}));var PrivateKey$2;(function(n){let r;n.codec=()=>(r==null&&(r=message((_,E,S={})=>{S.lengthDelimited!==!1&&E.fork(),_.Type!=null&&(E.uint32(8),KeyType$2.codec().encode(_.Type,E)),_.Data!=null&&(E.uint32(18),E.bytes(_.Data)),S.lengthDelimited!==!1&&E.ldelim()},(_,E)=>{const S={},C=E==null?_.len:_.pos+E;for(;_.pos<C;){const A=_.uint32();switch(A>>>3){case 1:S.Type=KeyType$2.codec().decode(_);break;case 2:S.Data=_.bytes();break;default:_.skipType(A&7);break}}return S})),r),n.encode=_=>encodeMessage(_,n.codec()),n.decode=_=>decodeMessage$1(_,n.codec())})(PrivateKey$2||(PrivateKey$2={}));let Ed25519PublicKey$2=class{_key;constructor(r){this._key=ensureKey$2(r,PUBLIC_KEY_BYTE_LENGTH$2)}verify(r,_){return hashAndVerify$8(this._key,_,r)}marshal(){return this._key}get bytes(){return PublicKey$2.encode({Type:KeyType$2.Ed25519,Data:this.marshal()}).subarray()}equals(r){return equals$1(this.bytes,r.bytes)}hash(){const r=sha256$6.digest(this.bytes);return isPromise$5(r)?r.then(({bytes:_})=>_):r.bytes}},Ed25519PrivateKey$2=class{_key;_publicKey;constructor(r,_){this._key=ensureKey$2(r,PRIVATE_KEY_BYTE_LENGTH$2),this._publicKey=ensureKey$2(_,PUBLIC_KEY_BYTE_LENGTH$2)}sign(r){return hashAndSign$8(this._key,r)}get public(){return new Ed25519PublicKey$2(this._publicKey)}marshal(){return this._key}get bytes(){return PrivateKey$2.encode({Type:KeyType$2.Ed25519,Data:this.marshal()}).subarray()}equals(r){return equals$1(this.bytes,r.bytes)}async hash(){const r=sha256$6.digest(this.bytes);let _;return isPromise$5(r)?{bytes:_}=await r:_=r.bytes,_}async id(){const r=identity$6.digest(this.public.bytes);return base58btc.encode(r.bytes).substring(1)}async export(r,_="libp2p-key"){if(_==="libp2p-key")return exporter$3(this.bytes,r);throw new CodeError$4(`export format '${_}' is not supported`,"ERR_INVALID_EXPORT_FORMAT")}};function unmarshalEd25519PrivateKey$2(n){if(n.length>PRIVATE_KEY_BYTE_LENGTH$2){n=ensureKey$2(n,PRIVATE_KEY_BYTE_LENGTH$2+PUBLIC_KEY_BYTE_LENGTH$2);const E=n.subarray(0,PRIVATE_KEY_BYTE_LENGTH$2),S=n.subarray(PRIVATE_KEY_BYTE_LENGTH$2,n.length);return new Ed25519PrivateKey$2(E,S)}n=ensureKey$2(n,PRIVATE_KEY_BYTE_LENGTH$2);const r=n.subarray(0,PRIVATE_KEY_BYTE_LENGTH$2),_=n.subarray(PUBLIC_KEY_BYTE_LENGTH$2);return new Ed25519PrivateKey$2(r,_)}function unmarshalEd25519PublicKey$2(n){return n=ensureKey$2(n,PUBLIC_KEY_BYTE_LENGTH$2),new Ed25519PublicKey$2(n)}async function generateKeyPair$a(){const{privateKey:n,publicKey:r}=generateKey$8();return new Ed25519PrivateKey$2(n,r)}async function generateKeyPairFromSeed$2(n){const{privateKey:r,publicKey:_}=generateKeyFromSeed$2(n);return new Ed25519PrivateKey$2(r,_)}function ensureKey$2(n,r){if(n=Uint8Array.from(n??[]),n.length!==r)throw new CodeError$4(`Key must be a Uint8Array of length ${r}, got ${n.length}`,"ERR_INVALID_KEY_TYPE");return n}const Ed25519$2=Object.freeze(Object.defineProperty({__proto__:null,Ed25519PrivateKey:Ed25519PrivateKey$2,Ed25519PublicKey:Ed25519PublicKey$2,generateKeyPair:generateKeyPair$a,generateKeyPairFromSeed:generateKeyPairFromSeed$2,unmarshalEd25519PrivateKey:unmarshalEd25519PrivateKey$2,unmarshalEd25519PublicKey:unmarshalEd25519PublicKey$2},Symbol.toStringTag,{value:"Module"})),bits$1={"P-256":256,"P-384":384,"P-521":521},curveTypes$1=Object.keys(bits$1);curveTypes$1.join(" / ");var forge=forge$m,sha512=forge.sha512=forge.sha512||{};forge.md.sha512=forge.md.algorithms.sha512=sha512;var sha384=forge.sha384=forge.sha512.sha384=forge.sha512.sha384||{};sha384.create=function(){return sha512.create("SHA-384")};forge.md.sha384=forge.md.algorithms.sha384=sha384;forge.sha512.sha256=forge.sha512.sha256||{create:function(){return sha512.create("SHA-512/256")}};forge.md["sha512/256"]=forge.md.algorithms["sha512/256"]=forge.sha512.sha256;forge.sha512.sha224=forge.sha512.sha224||{create:function(){return sha512.create("SHA-512/224")}};forge.md["sha512/224"]=forge.md.algorithms["sha512/224"]=forge.sha512.sha224;sha512.create=function(n){if(_initialized||_init(),typeof n>"u"&&(n="SHA-512"),!(n in _states))throw new Error("Invalid SHA-512 algorithm: "+n);for(var r=_states[n],_=null,E=forge.util.createBuffer(),S=new Array(80),C=0;C<80;++C)S[C]=new Array(2);var A=64;switch(n){case"SHA-384":A=48;break;case"SHA-512/256":A=32;break;case"SHA-512/224":A=28;break}var I={algorithm:n.replace("-","").toLowerCase(),blockLength:128,digestLength:A,messageLength:0,fullMessageLength:null,messageLengthSize:16};return I.start=function(){I.messageLength=0,I.fullMessageLength=I.messageLength128=[];for(var B=I.messageLengthSize/4,O=0;O<B;++O)I.fullMessageLength.push(0);E=forge.util.createBuffer(),_=new Array(r.length);for(var O=0;O<r.length;++O)_[O]=r[O].slice(0);return I},I.start(),I.update=function(B,O){O==="utf8"&&(B=forge.util.encodeUtf8(B));var N=B.length;I.messageLength+=N,N=[N/4294967296>>>0,N>>>0];for(var U=I.fullMessageLength.length-1;U>=0;--U)I.fullMessageLength[U]+=N[1],N[1]=N[0]+(I.fullMessageLength[U]/4294967296>>>0),I.fullMessageLength[U]=I.fullMessageLength[U]>>>0,N[0]=N[1]/4294967296>>>0;return E.putBytes(B),_update(_,S,E),(E.read>2048||E.length()===0)&&E.compact(),I},I.digest=function(){var B=forge.util.createBuffer();B.putBytes(E.bytes());var O=I.fullMessageLength[I.fullMessageLength.length-1]+I.messageLengthSize,N=O&I.blockLength-1;B.putBytes(_padding.substr(0,I.blockLength-N));for(var U,j,z=I.fullMessageLength[0]*8,Z=0;Z<I.fullMessageLength.length-1;++Z)U=I.fullMessageLength[Z+1]*8,j=U/4294967296>>>0,z+=j,B.putInt32(z>>>0),z=U>>>0;B.putInt32(z);for(var X=new Array(_.length),Z=0;Z<_.length;++Z)X[Z]=_[Z].slice(0);_update(X,S,B);var Q=forge.util.createBuffer(),se;n==="SHA-512"?se=X.length:n==="SHA-384"?se=X.length-2:se=X.length-4;for(var Z=0;Z<se;++Z)Q.putInt32(X[Z][0]),(Z!==se-1||n!=="SHA-512/224")&&Q.putInt32(X[Z][1]);return Q},I};var _padding=null,_initialized=!1,_k=null,_states=null;function _init(){_padding="",_padding+=forge.util.fillString("\0",128),_k=[[1116352408,3609767458],[1899447441,602891725],[3049323471,3964484399],[3921009573,2173295548],[961987163,4081628472],[1508970993,3053834265],[2453635748,2937671579],[2870763221,3664609560],[3624381080,2734883394],[310598401,1164996542],[607225278,1323610764],[1426881987,3590304994],[1925078388,4068182383],[2162078206,991336113],[2614888103,633803317],[3248222580,3479774868],[3835390401,2666613458],[4022224774,944711139],[264347078,2341262773],[604807628,2007800933],[770255983,1495990901],[1249150122,1856431235],[1555081692,3175218132],[1996064986,2198950837],[2554220882,3999719339],[2821834349,766784016],[2952996808,2566594879],[3210313671,3203337956],[3336571891,1034457026],[3584528711,2466948901],[113926993,3758326383],[338241895,168717936],[666307205,1188179964],[773529912,1546045734],[1294757372,1522805485],[1396182291,2643833823],[1695183700,2343527390],[1986661051,1014477480],[2177026350,1206759142],[2456956037,344077627],[2730485921,1290863460],[2820302411,3158454273],[3259730800,3505952657],[3345764771,106217008],[3516065817,3606008344],[3600352804,1432725776],[4094571909,1467031594],[275423344,851169720],[430227734,3100823752],[506948616,1363258195],[659060556,3750685593],[883997877,3785050280],[958139571,3318307427],[1322822218,3812723403],[1537002063,2003034995],[1747873779,3602036899],[1955562222,1575990012],[2024104815,1125592928],[2227730452,2716904306],[2361852424,442776044],[2428436474,593698344],[2756734187,3733110249],[3204031479,2999351573],[3329325298,3815920427],[3391569614,3928383900],[3515267271,566280711],[3940187606,3454069534],[4118630271,4000239992],[116418474,1914138554],[174292421,2731055270],[289380356,3203993006],[460393269,320620315],[685471733,587496836],[852142971,1086792851],[1017036298,365543100],[1126000580,2618297676],[1288033470,3409855158],[1501505948,4234509866],[1607167915,987167468],[1816402316,1246189591]],_states={},_states["SHA-512"]=[[1779033703,4089235720],[3144134277,2227873595],[1013904242,4271175723],[2773480762,1595750129],[1359893119,2917565137],[2600822924,725511199],[528734635,4215389547],[1541459225,327033209]],_states["SHA-384"]=[[3418070365,3238371032],[1654270250,914150663],[2438529370,812702999],[355462360,4144912697],[1731405415,4290775857],[2394180231,1750603025],[3675008525,1694076839],[1203062813,3204075428]],_states["SHA-512/256"]=[[573645204,4230739756],[2673172387,3360449730],[596883563,1867755857],[2520282905,1497426621],[2519219938,2827943907],[3193839141,1401305490],[721525244,746961066],[246885852,2177182882]],_states["SHA-512/224"]=[[2352822216,424955298],[1944164710,2312950998],[502970286,855612546],[1738396948,1479516111],[258812777,2077511080],[2011393907,79989058],[1067287976,1780299464],[286451373,2446758561]],_initialized=!0}function _update(n,r,_){for(var E,S,C,A,I,B,O,N,U,j,z,Z,X,Q,se,oe,ue,we,Te,xe,Re,Ne,Fe,ht,nt,Ee,Ce,_e,Ie,He,Be,Ge,je,Ve,Pe,Me=_.length();Me>=128;){for(Ie=0;Ie<16;++Ie)r[Ie][0]=_.getInt32()>>>0,r[Ie][1]=_.getInt32()>>>0;for(;Ie<80;++Ie)Ge=r[Ie-2],He=Ge[0],Be=Ge[1],E=((He>>>19|Be<<13)^(Be>>>29|He<<3)^He>>>6)>>>0,S=((He<<13|Be>>>19)^(Be<<3|He>>>29)^(He<<26|Be>>>6))>>>0,Ve=r[Ie-15],He=Ve[0],Be=Ve[1],C=((He>>>1|Be<<31)^(He>>>8|Be<<24)^He>>>7)>>>0,A=((He<<31|Be>>>1)^(He<<24|Be>>>8)^(He<<25|Be>>>7))>>>0,je=r[Ie-7],Pe=r[Ie-16],Be=S+je[1]+A+Pe[1],r[Ie][0]=E+je[0]+C+Pe[0]+(Be/4294967296>>>0)>>>0,r[Ie][1]=Be>>>0;for(X=n[0][0],Q=n[0][1],se=n[1][0],oe=n[1][1],ue=n[2][0],we=n[2][1],Te=n[3][0],xe=n[3][1],Re=n[4][0],Ne=n[4][1],Fe=n[5][0],ht=n[5][1],nt=n[6][0],Ee=n[6][1],Ce=n[7][0],_e=n[7][1],Ie=0;Ie<80;++Ie)O=((Re>>>14|Ne<<18)^(Re>>>18|Ne<<14)^(Ne>>>9|Re<<23))>>>0,N=((Re<<18|Ne>>>14)^(Re<<14|Ne>>>18)^(Ne<<23|Re>>>9))>>>0,U=(nt^Re&(Fe^nt))>>>0,j=(Ee^Ne&(ht^Ee))>>>0,I=((X>>>28|Q<<4)^(Q>>>2|X<<30)^(Q>>>7|X<<25))>>>0,B=((X<<4|Q>>>28)^(Q<<30|X>>>2)^(Q<<25|X>>>7))>>>0,z=(X&se|ue&(X^se))>>>0,Z=(Q&oe|we&(Q^oe))>>>0,Be=_e+N+j+_k[Ie][1]+r[Ie][1],E=Ce+O+U+_k[Ie][0]+r[Ie][0]+(Be/4294967296>>>0)>>>0,S=Be>>>0,Be=B+Z,C=I+z+(Be/4294967296>>>0)>>>0,A=Be>>>0,Ce=nt,_e=Ee,nt=Fe,Ee=ht,Fe=Re,ht=Ne,Be=xe+S,Re=Te+E+(Be/4294967296>>>0)>>>0,Ne=Be>>>0,Te=ue,xe=we,ue=se,we=oe,se=X,oe=Q,Be=S+A,X=E+C+(Be/4294967296>>>0)>>>0,Q=Be>>>0;Be=n[0][1]+Q,n[0][0]=n[0][0]+X+(Be/4294967296>>>0)>>>0,n[0][1]=Be>>>0,Be=n[1][1]+oe,n[1][0]=n[1][0]+se+(Be/4294967296>>>0)>>>0,n[1][1]=Be>>>0,Be=n[2][1]+we,n[2][0]=n[2][0]+ue+(Be/4294967296>>>0)>>>0,n[2][1]=Be>>>0,Be=n[3][1]+xe,n[3][0]=n[3][0]+Te+(Be/4294967296>>>0)>>>0,n[3][1]=Be>>>0,Be=n[4][1]+Ne,n[4][0]=n[4][0]+Re+(Be/4294967296>>>0)>>>0,n[4][1]=Be>>>0,Be=n[5][1]+ht,n[5][0]=n[5][0]+Fe+(Be/4294967296>>>0)>>>0,n[5][1]=Be>>>0,Be=n[6][1]+Ee,n[6][0]=n[6][0]+nt+(Be/4294967296>>>0)>>>0,n[6][1]=Be>>>0,Be=n[7][1]+_e,n[7][0]=n[7][0]+Ce+(Be/4294967296>>>0)>>>0,n[7][1]=Be>>>0,Me-=128}}function randomBytes$2(n){if(isNaN(n)||n<=0)throw new CodeError$4("random bytes length must be a Number bigger than 0","ERR_INVALID_LENGTH");return randomBytes$3(n)}function convert$1(n,r){return r.map(_=>base64urlToBigInteger$1(n[_]))}function jwk2priv$1(n){return forge$n.pki.setRsaPrivateKey(...convert$1(n,["n","e","d","p","q","dp","dq","qi"]))}function jwk2pub$1(n){return forge$n.pki.setRsaPublicKey(...convert$1(n,["n","e"]))}function pkcs1ToJwk$2(n){const r=forge$n.asn1.fromDer(toString$4(n,"ascii")),_=forge$n.pki.privateKeyFromAsn1(r);return{kty:"RSA",n:bigIntegerToUintBase64url$1(_.n),e:bigIntegerToUintBase64url$1(_.e),d:bigIntegerToUintBase64url$1(_.d),p:bigIntegerToUintBase64url$1(_.p),q:bigIntegerToUintBase64url$1(_.q),dp:bigIntegerToUintBase64url$1(_.dP),dq:bigIntegerToUintBase64url$1(_.dQ),qi:bigIntegerToUintBase64url$1(_.qInv),alg:"RS256"}}function jwkToPkcs1$2(n){if(n.n==null||n.e==null||n.d==null||n.p==null||n.q==null||n.dp==null||n.dq==null||n.qi==null)throw new CodeError$4("JWK was missing components","ERR_INVALID_PARAMETERS");const r=forge$n.pki.privateKeyToAsn1({n:base64urlToBigInteger$1(n.n),e:base64urlToBigInteger$1(n.e),d:base64urlToBigInteger$1(n.d),p:base64urlToBigInteger$1(n.p),q:base64urlToBigInteger$1(n.q),dP:base64urlToBigInteger$1(n.dp),dQ:base64urlToBigInteger$1(n.dq),qInv:base64urlToBigInteger$1(n.qi)});return fromString$3(forge$n.asn1.toDer(r).getBytes(),"ascii")}function pkixToJwk$2(n){const r=forge$n.asn1.fromDer(toString$4(n,"ascii")),_=forge$n.pki.publicKeyFromAsn1(r);return{kty:"RSA",n:bigIntegerToUintBase64url$1(_.n),e:bigIntegerToUintBase64url$1(_.e)}}function jwkToPkix$2(n){if(n.n==null||n.e==null)throw new CodeError$4("JWK was missing components","ERR_INVALID_PARAMETERS");const r=forge$n.pki.publicKeyToAsn1({n:base64urlToBigInteger$1(n.n),e:base64urlToBigInteger$1(n.e)});return fromString$3(forge$n.asn1.toDer(r).getBytes(),"ascii")}async function generateKey$7(n){const r=await webcrypto$2.get().subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:n,publicExponent:new Uint8Array([1,0,1]),hash:{name:"SHA-256"}},!0,["sign","verify"]),_=await exportKey$2(r);return{privateKey:_[0],publicKey:_[1]}}async function unmarshalPrivateKey$4(n){const _=[await webcrypto$2.get().subtle.importKey("jwk",n,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!0,["sign"]),await derivePublicFromPrivate$2(n)],E=await exportKey$2({privateKey:_[0],publicKey:_[1]});return{privateKey:E[0],publicKey:E[1]}}async function hashAndSign$7(n,r){const _=await webcrypto$2.get().subtle.importKey("jwk",n,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!1,["sign"]),E=await webcrypto$2.get().subtle.sign({name:"RSASSA-PKCS1-v1_5"},_,r instanceof Uint8Array?r:r.subarray());return new Uint8Array(E,0,E.byteLength)}async function hashAndVerify$7(n,r,_){const E=await webcrypto$2.get().subtle.importKey("jwk",n,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!1,["verify"]);return webcrypto$2.get().subtle.verify({name:"RSASSA-PKCS1-v1_5"},E,r,_ instanceof Uint8Array?_:_.subarray())}async function exportKey$2(n){if(n.privateKey==null||n.publicKey==null)throw new CodeError$4("Private and public key are required","ERR_INVALID_PARAMETERS");return Promise.all([webcrypto$2.get().subtle.exportKey("jwk",n.privateKey),webcrypto$2.get().subtle.exportKey("jwk",n.publicKey)])}async function derivePublicFromPrivate$2(n){return webcrypto$2.get().subtle.importKey("jwk",{kty:n.kty,n:n.n,e:n.e},{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!0,["verify"])}function convertKey$1(n,r,_,E){const S=r?jwk2pub$1(n):jwk2priv$1(n),C=toString$4(_ instanceof Uint8Array?_:_.subarray(),"ascii"),A=E(C,S);return fromString$3(A,"ascii")}function encrypt$1(n,r){return convertKey$1(n,!0,r,(_,E)=>E.encrypt(_))}function decrypt$1(n,r){return convertKey$1(n,!1,r,(_,E)=>E.decrypt(_))}function keySize$2(n){if(n.kty!=="RSA")throw new CodeError$4("invalid key type","ERR_INVALID_KEY_TYPE");if(n.n==null)throw new CodeError$4("invalid key modulus","ERR_INVALID_KEY_MODULUS");return fromString$3(n.n,"base64url").length*8}const MAX_KEY_SIZE$1=8192;let RsaPublicKey$2=class{_key;constructor(r){this._key=r}verify(r,_){return hashAndVerify$7(this._key,_,r)}marshal(){return jwkToPkix$2(this._key)}get bytes(){return PublicKey$2.encode({Type:KeyType$2.RSA,Data:this.marshal()}).subarray()}encrypt(r){return encrypt$1(this._key,r)}equals(r){return equals$1(this.bytes,r.bytes)}hash(){const r=sha256$6.digest(this.bytes);return isPromise$5(r)?r.then(({bytes:_})=>_):r.bytes}},RsaPrivateKey$2=class{_key;_publicKey;constructor(r,_){this._key=r,this._publicKey=_}genSecret(){return randomBytes$2(16)}sign(r){return hashAndSign$7(this._key,r)}get public(){if(this._publicKey==null)throw new CodeError$4("public key not provided","ERR_PUBKEY_NOT_PROVIDED");return new RsaPublicKey$2(this._publicKey)}decrypt(r){return decrypt$1(this._key,r)}marshal(){return jwkToPkcs1$2(this._key)}get bytes(){return PrivateKey$2.encode({Type:KeyType$2.RSA,Data:this.marshal()}).subarray()}equals(r){return equals$1(this.bytes,r.bytes)}hash(){const r=sha256$6.digest(this.bytes);return isPromise$5(r)?r.then(({bytes:_})=>_):r.bytes}async id(){const r=await this.public.hash();return toString$4(r,"base58btc")}async export(r,_="pkcs-8"){if(_==="pkcs-8"){const E=new forge$n.util.ByteBuffer(this.marshal()),S=forge$n.asn1.fromDer(E),C=forge$n.pki.privateKeyFromAsn1(S),A={algorithm:"aes256",count:1e4,saltSize:128/8,prfAlgorithm:"sha512"};return forge$n.pki.encryptRsaPrivateKey(C,r,A)}else{if(_==="libp2p-key")return exporter$3(this.bytes,r);throw new CodeError$4(`export format '${_}' is not supported`,"ERR_INVALID_EXPORT_FORMAT")}}};async function unmarshalRsaPrivateKey$2(n){const r=pkcs1ToJwk$2(n);if(keySize$2(r)>MAX_KEY_SIZE$1)throw new CodeError$4("key size is too large","ERR_KEY_SIZE_TOO_LARGE");const _=await unmarshalPrivateKey$4(r);return new RsaPrivateKey$2(_.privateKey,_.publicKey)}function unmarshalRsaPublicKey$2(n){const r=pkixToJwk$2(n);if(keySize$2(r)>MAX_KEY_SIZE$1)throw new CodeError$4("key size is too large","ERR_KEY_SIZE_TOO_LARGE");return new RsaPublicKey$2(r)}async function fromJwk$2(n){if(keySize$2(n)>MAX_KEY_SIZE$1)throw new CodeError$4("key size is too large","ERR_KEY_SIZE_TOO_LARGE");const r=await unmarshalPrivateKey$4(n);return new RsaPrivateKey$2(r.privateKey,r.publicKey)}async function generateKeyPair$9(n){if(n>MAX_KEY_SIZE$1)throw new CodeError$4("key size is too large","ERR_KEY_SIZE_TOO_LARGE");const r=await generateKey$7(n);return new RsaPrivateKey$2(r.privateKey,r.publicKey)}const RSA$2=Object.freeze(Object.defineProperty({__proto__:null,MAX_KEY_SIZE:MAX_KEY_SIZE$1,RsaPrivateKey:RsaPrivateKey$2,RsaPublicKey:RsaPublicKey$2,fromJwk:fromJwk$2,generateKeyPair:generateKeyPair$9,unmarshalRsaPrivateKey:unmarshalRsaPrivateKey$2,unmarshalRsaPublicKey:unmarshalRsaPublicKey$2},Symbol.toStringTag,{value:"Module"})),SHA256_K=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),SHA256_IV=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),SHA256_W=new Uint32Array(64);class SHA256 extends HashMD{constructor(){super(64,32,8,!1),this.A=SHA256_IV[0]|0,this.B=SHA256_IV[1]|0,this.C=SHA256_IV[2]|0,this.D=SHA256_IV[3]|0,this.E=SHA256_IV[4]|0,this.F=SHA256_IV[5]|0,this.G=SHA256_IV[6]|0,this.H=SHA256_IV[7]|0}get(){const{A:r,B:_,C:E,D:S,E:C,F:A,G:I,H:B}=this;return[r,_,E,S,C,A,I,B]}set(r,_,E,S,C,A,I,B){this.A=r|0,this.B=_|0,this.C=E|0,this.D=S|0,this.E=C|0,this.F=A|0,this.G=I|0,this.H=B|0}process(r,_){for(let U=0;U<16;U++,_+=4)SHA256_W[U]=r.getUint32(_,!1);for(let U=16;U<64;U++){const j=SHA256_W[U-15],z=SHA256_W[U-2],Z=rotr(j,7)^rotr(j,18)^j>>>3,X=rotr(z,17)^rotr(z,19)^z>>>10;SHA256_W[U]=X+SHA256_W[U-7]+Z+SHA256_W[U-16]|0}let{A:E,B:S,C,D:A,E:I,F:B,G:O,H:N}=this;for(let U=0;U<64;U++){const j=rotr(I,6)^rotr(I,11)^rotr(I,25),z=N+j+Chi(I,B,O)+SHA256_K[U]+SHA256_W[U]|0,X=(rotr(E,2)^rotr(E,13)^rotr(E,22))+Maj(E,S,C)|0;N=O,O=B,B=I,I=A+z|0,A=C,C=S,S=E,E=z+X|0}E=E+this.A|0,S=S+this.B|0,C=C+this.C|0,A=A+this.D|0,I=I+this.E|0,B=B+this.F|0,O=O+this.G|0,N=N+this.H|0,this.set(E,S,C,A,I,B,O,N)}roundClean(){SHA256_W.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}}const sha256$2=wrapConstructor(()=>new SHA256);/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */function validatePointOpts(n){const r=validateBasic(n);validateObject(r,{a:"field",b:"field"},{allowedPrivateKeyLengths:"array",wrapPrivateKey:"boolean",isTorsionFree:"function",clearCofactor:"function",allowInfinityPoint:"boolean",fromBytes:"function",toBytes:"function"});const{endo:_,Fp:E,a:S}=r;if(_){if(!E.eql(S,E.ZERO))throw new Error("Endomorphism can only be defined for Koblitz curves that have a=0");if(typeof _!="object"||typeof _.beta!="bigint"||typeof _.splitScalar!="function")throw new Error("Expected endomorphism with beta: bigint and splitScalar: function")}return Object.freeze({...r})}const{bytesToNumberBE:b2n,hexToBytes:h2b}=ut,DER={Err:class extends Error{constructor(r=""){super(r)}},_parseInt(n){const{Err:r}=DER;if(n.length<2||n[0]!==2)throw new r("Invalid signature integer tag");const _=n[1],E=n.subarray(2,_+2);if(!_||E.length!==_)throw new r("Invalid signature integer: wrong length");if(E[0]&128)throw new r("Invalid signature integer: negative");if(E[0]===0&&!(E[1]&128))throw new r("Invalid signature integer: unnecessary leading zero");return{d:b2n(E),l:n.subarray(_+2)}},toSig(n){const{Err:r}=DER,_=typeof n=="string"?h2b(n):n;abytes(_);let E=_.length;if(E<2||_[0]!=48)throw new r("Invalid signature tag");if(_[1]!==E-2)throw new r("Invalid signature: incorrect length");const{d:S,l:C}=DER._parseInt(_.subarray(2)),{d:A,l:I}=DER._parseInt(C);if(I.length)throw new r("Invalid signature: left bytes after parsing");return{r:S,s:A}},hexFromSig(n){const r=O=>Number.parseInt(O[0],16)&8?"00"+O:O,_=O=>{const N=O.toString(16);return N.length&1?`0${N}`:N},E=r(_(n.s)),S=r(_(n.r)),C=E.length/2,A=S.length/2,I=_(C),B=_(A);return`30${_(A+C+4)}02${B}${S}02${I}${E}`}},_0n=BigInt(0),_1n$1=BigInt(1);BigInt(2);const _3n=BigInt(3);BigInt(4);function weierstrassPoints(n){const r=validatePointOpts(n),{Fp:_}=r,E=r.toBytes||((Z,X,Q)=>{const se=X.toAffine();return concatBytes(Uint8Array.from([4]),_.toBytes(se.x),_.toBytes(se.y))}),S=r.fromBytes||(Z=>{const X=Z.subarray(1),Q=_.fromBytes(X.subarray(0,_.BYTES)),se=_.fromBytes(X.subarray(_.BYTES,2*_.BYTES));return{x:Q,y:se}});function C(Z){const{a:X,b:Q}=r,se=_.sqr(Z),oe=_.mul(se,Z);return _.add(_.add(oe,_.mul(Z,X)),Q)}if(!_.eql(_.sqr(r.Gy),C(r.Gx)))throw new Error("bad generator point: equation left != right");function A(Z){return typeof Z=="bigint"&&_0n<Z&&Z<r.n}function I(Z){if(!A(Z))throw new Error("Expected valid bigint: 0 < bigint < curve.n")}function B(Z){const{allowedPrivateKeyLengths:X,nByteLength:Q,wrapPrivateKey:se,n:oe}=r;if(X&&typeof Z!="bigint"){if(isBytes$2(Z)&&(Z=bytesToHex(Z)),typeof Z!="string"||!X.includes(Z.length))throw new Error("Invalid key");Z=Z.padStart(Q*2,"0")}let ue;try{ue=typeof Z=="bigint"?Z:bytesToNumberBE(ensureBytes$1("private key",Z,Q))}catch{throw new Error(`private key must be ${Q} bytes, hex or bigint, not ${typeof Z}`)}return se&&(ue=mod(ue,oe)),I(ue),ue}const O=new Map;function N(Z){if(!(Z instanceof U))throw new Error("ProjectivePoint expected")}class U{constructor(X,Q,se){if(this.px=X,this.py=Q,this.pz=se,X==null||!_.isValid(X))throw new Error("x required");if(Q==null||!_.isValid(Q))throw new Error("y required");if(se==null||!_.isValid(se))throw new Error("z required")}static fromAffine(X){const{x:Q,y:se}=X||{};if(!X||!_.isValid(Q)||!_.isValid(se))throw new Error("invalid affine point");if(X instanceof U)throw new Error("projective point not allowed");const oe=ue=>_.eql(ue,_.ZERO);return oe(Q)&&oe(se)?U.ZERO:new U(Q,se,_.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(X){const Q=_.invertBatch(X.map(se=>se.pz));return X.map((se,oe)=>se.toAffine(Q[oe])).map(U.fromAffine)}static fromHex(X){const Q=U.fromAffine(S(ensureBytes$1("pointHex",X)));return Q.assertValidity(),Q}static fromPrivateKey(X){return U.BASE.multiply(B(X))}_setWindowSize(X){this._WINDOW_SIZE=X,O.delete(this)}assertValidity(){if(this.is0()){if(r.allowInfinityPoint&&!_.is0(this.py))return;throw new Error("bad point: ZERO")}const{x:X,y:Q}=this.toAffine();if(!_.isValid(X)||!_.isValid(Q))throw new Error("bad point: x or y not FE");const se=_.sqr(Q),oe=C(X);if(!_.eql(se,oe))throw new Error("bad point: equation left != right");if(!this.isTorsionFree())throw new Error("bad point: not in prime-order subgroup")}hasEvenY(){const{y:X}=this.toAffine();if(_.isOdd)return!_.isOdd(X);throw new Error("Field doesn't support isOdd")}equals(X){N(X);const{px:Q,py:se,pz:oe}=this,{px:ue,py:we,pz:Te}=X,xe=_.eql(_.mul(Q,Te),_.mul(ue,oe)),Re=_.eql(_.mul(se,Te),_.mul(we,oe));return xe&&Re}negate(){return new U(this.px,_.neg(this.py),this.pz)}double(){const{a:X,b:Q}=r,se=_.mul(Q,_3n),{px:oe,py:ue,pz:we}=this;let Te=_.ZERO,xe=_.ZERO,Re=_.ZERO,Ne=_.mul(oe,oe),Fe=_.mul(ue,ue),ht=_.mul(we,we),nt=_.mul(oe,ue);return nt=_.add(nt,nt),Re=_.mul(oe,we),Re=_.add(Re,Re),Te=_.mul(X,Re),xe=_.mul(se,ht),xe=_.add(Te,xe),Te=_.sub(Fe,xe),xe=_.add(Fe,xe),xe=_.mul(Te,xe),Te=_.mul(nt,Te),Re=_.mul(se,Re),ht=_.mul(X,ht),nt=_.sub(Ne,ht),nt=_.mul(X,nt),nt=_.add(nt,Re),Re=_.add(Ne,Ne),Ne=_.add(Re,Ne),Ne=_.add(Ne,ht),Ne=_.mul(Ne,nt),xe=_.add(xe,Ne),ht=_.mul(ue,we),ht=_.add(ht,ht),Ne=_.mul(ht,nt),Te=_.sub(Te,Ne),Re=_.mul(ht,Fe),Re=_.add(Re,Re),Re=_.add(Re,Re),new U(Te,xe,Re)}add(X){N(X);const{px:Q,py:se,pz:oe}=this,{px:ue,py:we,pz:Te}=X;let xe=_.ZERO,Re=_.ZERO,Ne=_.ZERO;const Fe=r.a,ht=_.mul(r.b,_3n);let nt=_.mul(Q,ue),Ee=_.mul(se,we),Ce=_.mul(oe,Te),_e=_.add(Q,se),Ie=_.add(ue,we);_e=_.mul(_e,Ie),Ie=_.add(nt,Ee),_e=_.sub(_e,Ie),Ie=_.add(Q,oe);let He=_.add(ue,Te);return Ie=_.mul(Ie,He),He=_.add(nt,Ce),Ie=_.sub(Ie,He),He=_.add(se,oe),xe=_.add(we,Te),He=_.mul(He,xe),xe=_.add(Ee,Ce),He=_.sub(He,xe),Ne=_.mul(Fe,Ie),xe=_.mul(ht,Ce),Ne=_.add(xe,Ne),xe=_.sub(Ee,Ne),Ne=_.add(Ee,Ne),Re=_.mul(xe,Ne),Ee=_.add(nt,nt),Ee=_.add(Ee,nt),Ce=_.mul(Fe,Ce),Ie=_.mul(ht,Ie),Ee=_.add(Ee,Ce),Ce=_.sub(nt,Ce),Ce=_.mul(Fe,Ce),Ie=_.add(Ie,Ce),nt=_.mul(Ee,Ie),Re=_.add(Re,nt),nt=_.mul(He,Ie),xe=_.mul(_e,xe),xe=_.sub(xe,nt),nt=_.mul(_e,Ee),Ne=_.mul(He,Ne),Ne=_.add(Ne,nt),new U(xe,Re,Ne)}subtract(X){return this.add(X.negate())}is0(){return this.equals(U.ZERO)}wNAF(X){return z.wNAFCached(this,O,X,Q=>{const se=_.invertBatch(Q.map(oe=>oe.pz));return Q.map((oe,ue)=>oe.toAffine(se[ue])).map(U.fromAffine)})}multiplyUnsafe(X){const Q=U.ZERO;if(X===_0n)return Q;if(I(X),X===_1n$1)return this;const{endo:se}=r;if(!se)return z.unsafeLadder(this,X);let{k1neg:oe,k1:ue,k2neg:we,k2:Te}=se.splitScalar(X),xe=Q,Re=Q,Ne=this;for(;ue>_0n||Te>_0n;)ue&_1n$1&&(xe=xe.add(Ne)),Te&_1n$1&&(Re=Re.add(Ne)),Ne=Ne.double(),ue>>=_1n$1,Te>>=_1n$1;return oe&&(xe=xe.negate()),we&&(Re=Re.negate()),Re=new U(_.mul(Re.px,se.beta),Re.py,Re.pz),xe.add(Re)}multiply(X){I(X);let Q=X,se,oe;const{endo:ue}=r;if(ue){const{k1neg:we,k1:Te,k2neg:xe,k2:Re}=ue.splitScalar(Q);let{p:Ne,f:Fe}=this.wNAF(Te),{p:ht,f:nt}=this.wNAF(Re);Ne=z.constTimeNegate(we,Ne),ht=z.constTimeNegate(xe,ht),ht=new U(_.mul(ht.px,ue.beta),ht.py,ht.pz),se=Ne.add(ht),oe=Fe.add(nt)}else{const{p:we,f:Te}=this.wNAF(Q);se=we,oe=Te}return U.normalizeZ([se,oe])[0]}multiplyAndAddUnsafe(X,Q,se){const oe=U.BASE,ue=(Te,xe)=>xe===_0n||xe===_1n$1||!Te.equals(oe)?Te.multiplyUnsafe(xe):Te.multiply(xe),we=ue(this,Q).add(ue(X,se));return we.is0()?void 0:we}toAffine(X){const{px:Q,py:se,pz:oe}=this,ue=this.is0();X==null&&(X=ue?_.ONE:_.inv(oe));const we=_.mul(Q,X),Te=_.mul(se,X),xe=_.mul(oe,X);if(ue)return{x:_.ZERO,y:_.ZERO};if(!_.eql(xe,_.ONE))throw new Error("invZ was invalid");return{x:we,y:Te}}isTorsionFree(){const{h:X,isTorsionFree:Q}=r;if(X===_1n$1)return!0;if(Q)return Q(U,this);throw new Error("isTorsionFree() has not been declared for the elliptic curve")}clearCofactor(){const{h:X,clearCofactor:Q}=r;return X===_1n$1?this:Q?Q(U,this):this.multiplyUnsafe(r.h)}toRawBytes(X=!0){return this.assertValidity(),E(U,this,X)}toHex(X=!0){return bytesToHex(this.toRawBytes(X))}}U.BASE=new U(r.Gx,r.Gy,_.ONE),U.ZERO=new U(_.ZERO,_.ONE,_.ZERO);const j=r.nBitLength,z=wNAF(U,r.endo?Math.ceil(j/2):j);return{CURVE:r,ProjectivePoint:U,normPrivateKeyToScalar:B,weierstrassEquation:C,isWithinCurveOrder:A}}function validateOpts(n){const r=validateBasic(n);return validateObject(r,{hash:"hash",hmac:"function",randomBytes:"function"},{bits2int:"function",bits2int_modN:"function",lowS:"boolean"}),Object.freeze({lowS:!0,...r})}function weierstrass(n){const r=validateOpts(n),{Fp:_,n:E}=r,S=_.BYTES+1,C=2*_.BYTES+1;function A(Ie){return _0n<Ie&&Ie<_.ORDER}function I(Ie){return mod(Ie,E)}function B(Ie){return invert(Ie,E)}const{ProjectivePoint:O,normPrivateKeyToScalar:N,weierstrassEquation:U,isWithinCurveOrder:j}=weierstrassPoints({...r,toBytes(Ie,He,Be){const Ge=He.toAffine(),je=_.toBytes(Ge.x),Ve=concatBytes;return Be?Ve(Uint8Array.from([He.hasEvenY()?2:3]),je):Ve(Uint8Array.from([4]),je,_.toBytes(Ge.y))},fromBytes(Ie){const He=Ie.length,Be=Ie[0],Ge=Ie.subarray(1);if(He===S&&(Be===2||Be===3)){const je=bytesToNumberBE(Ge);if(!A(je))throw new Error("Point is not on curve");const Ve=U(je);let Pe;try{Pe=_.sqrt(Ve)}catch(Ke){const mt=Ke instanceof Error?": "+Ke.message:"";throw new Error("Point is not on curve"+mt)}const Me=(Pe&_1n$1)===_1n$1;return(Be&1)===1!==Me&&(Pe=_.neg(Pe)),{x:je,y:Pe}}else if(He===C&&Be===4){const je=_.fromBytes(Ge.subarray(0,_.BYTES)),Ve=_.fromBytes(Ge.subarray(_.BYTES,2*_.BYTES));return{x:je,y:Ve}}else throw new Error(`Point of length ${He} was invalid. Expected ${S} compressed bytes or ${C} uncompressed bytes`)}}),z=Ie=>bytesToHex(numberToBytesBE(Ie,r.nByteLength));function Z(Ie){const He=E>>_1n$1;return Ie>He}function X(Ie){return Z(Ie)?I(-Ie):Ie}const Q=(Ie,He,Be)=>bytesToNumberBE(Ie.slice(He,Be));class se{constructor(He,Be,Ge){this.r=He,this.s=Be,this.recovery=Ge,this.assertValidity()}static fromCompact(He){const Be=r.nByteLength;return He=ensureBytes$1("compactSignature",He,Be*2),new se(Q(He,0,Be),Q(He,Be,2*Be))}static fromDER(He){const{r:Be,s:Ge}=DER.toSig(ensureBytes$1("DER",He));return new se(Be,Ge)}assertValidity(){if(!j(this.r))throw new Error("r must be 0 < r < CURVE.n");if(!j(this.s))throw new Error("s must be 0 < s < CURVE.n")}addRecoveryBit(He){return new se(this.r,this.s,He)}recoverPublicKey(He){const{r:Be,s:Ge,recovery:je}=this,Ve=Re(ensureBytes$1("msgHash",He));if(je==null||![0,1,2,3].includes(je))throw new Error("recovery id invalid");const Pe=je===2||je===3?Be+r.n:Be;if(Pe>=_.ORDER)throw new Error("recovery id 2 or 3 invalid");const Me=je&1?"03":"02",tt=O.fromHex(Me+z(Pe)),Ke=B(Pe),mt=I(-Ve*Ke),ct=I(Ge*Ke),Qe=O.BASE.multiplyAndAddUnsafe(tt,mt,ct);if(!Qe)throw new Error("point at infinify");return Qe.assertValidity(),Qe}hasHighS(){return Z(this.s)}normalizeS(){return this.hasHighS()?new se(this.r,I(-this.s),this.recovery):this}toDERRawBytes(){return hexToBytes(this.toDERHex())}toDERHex(){return DER.hexFromSig({r:this.r,s:this.s})}toCompactRawBytes(){return hexToBytes(this.toCompactHex())}toCompactHex(){return z(this.r)+z(this.s)}}const oe={isValidPrivateKey(Ie){try{return N(Ie),!0}catch{return!1}},normPrivateKeyToScalar:N,randomPrivateKey:()=>{const Ie=getMinHashLength(r.n);return mapHashToField(r.randomBytes(Ie),r.n)},precompute(Ie=8,He=O.BASE){return He._setWindowSize(Ie),He.multiply(BigInt(3)),He}};function ue(Ie,He=!0){return O.fromPrivateKey(Ie).toRawBytes(He)}function we(Ie){const He=isBytes$2(Ie),Be=typeof Ie=="string",Ge=(He||Be)&&Ie.length;return He?Ge===S||Ge===C:Be?Ge===2*S||Ge===2*C:Ie instanceof O}function Te(Ie,He,Be=!0){if(we(Ie))throw new Error("first arg must be private key");if(!we(He))throw new Error("second arg must be public key");return O.fromHex(He).multiply(N(Ie)).toRawBytes(Be)}const xe=r.bits2int||function(Ie){const He=bytesToNumberBE(Ie),Be=Ie.length*8-r.nBitLength;return Be>0?He>>BigInt(Be):He},Re=r.bits2int_modN||function(Ie){return I(xe(Ie))},Ne=bitMask(r.nBitLength);function Fe(Ie){if(typeof Ie!="bigint")throw new Error("bigint expected");if(!(_0n<=Ie&&Ie<Ne))throw new Error(`bigint expected < 2^${r.nBitLength}`);return numberToBytesBE(Ie,r.nByteLength)}function ht(Ie,He,Be=nt){if(["recovered","canonical"].some(vt=>vt in Be))throw new Error("sign() legacy options not supported");const{hash:Ge,randomBytes:je}=r;let{lowS:Ve,prehash:Pe,extraEntropy:Me}=Be;Ve==null&&(Ve=!0),Ie=ensureBytes$1("msgHash",Ie),Pe&&(Ie=ensureBytes$1("prehashed msgHash",Ge(Ie)));const tt=Re(Ie),Ke=N(He),mt=[Fe(Ke),Fe(tt)];if(Me!=null&&Me!==!1){const vt=Me===!0?je(_.BYTES):Me;mt.push(ensureBytes$1("extraEntropy",vt))}const ct=concatBytes(...mt),Qe=tt;function dt(vt){const At=xe(vt);if(!j(At))return;const bt=B(At),ft=O.BASE.multiply(At).toAffine(),Et=I(ft.x);if(Et===_0n)return;const Ye=I(bt*I(Qe+Et*Ke));if(Ye===_0n)return;let Ct=(ft.x===Et?0:2)|Number(ft.y&_1n$1),Pt=Ye;return Ve&&Z(Ye)&&(Pt=X(Ye),Ct^=1),new se(Et,Pt,Ct)}return{seed:ct,k2sig:dt}}const nt={lowS:r.lowS,prehash:!1},Ee={lowS:r.lowS,prehash:!1};function Ce(Ie,He,Be=nt){const{seed:Ge,k2sig:je}=ht(Ie,He,Be),Ve=r;return createHmacDrbg(Ve.hash.outputLen,Ve.nByteLength,Ve.hmac)(Ge,je)}O.BASE._setWindowSize(8);function _e(Ie,He,Be,Ge=Ee){const je=Ie;if(He=ensureBytes$1("msgHash",He),Be=ensureBytes$1("publicKey",Be),"strict"in Ge)throw new Error("options.strict was renamed to lowS");const{lowS:Ve,prehash:Pe}=Ge;let Me,tt;try{if(typeof je=="string"||isBytes$2(je))try{Me=se.fromDER(je)}catch(ft){if(!(ft instanceof DER.Err))throw ft;Me=se.fromCompact(je)}else if(typeof je=="object"&&typeof je.r=="bigint"&&typeof je.s=="bigint"){const{r:ft,s:Et}=je;Me=new se(ft,Et)}else throw new Error("PARSE");tt=O.fromHex(Be)}catch(ft){if(ft.message==="PARSE")throw new Error("signature must be Signature instance, Uint8Array or hex string");return!1}if(Ve&&Me.hasHighS())return!1;Pe&&(He=r.hash(He));const{r:Ke,s:mt}=Me,ct=Re(He),Qe=B(mt),dt=I(ct*Qe),vt=I(Ke*Qe),At=O.BASE.multiplyAndAddUnsafe(tt,dt,vt)?.toAffine();return At?I(At.x)===Ke:!1}return{CURVE:r,getPublicKey:ue,getSharedSecret:Te,sign:Ce,verify:_e,ProjectivePoint:O,Signature:se,utils:oe}}class HMAC extends Hash{constructor(r,_){super(),this.finished=!1,this.destroyed=!1,hash(r);const E=toBytes$2(_);if(this.iHash=r.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const S=this.blockLen,C=new Uint8Array(S);C.set(E.length>S?r.create().update(E).digest():E);for(let A=0;A<C.length;A++)C[A]^=54;this.iHash.update(C),this.oHash=r.create();for(let A=0;A<C.length;A++)C[A]^=106;this.oHash.update(C),C.fill(0)}update(r){return exists$2(this),this.iHash.update(r),this}digestInto(r){exists$2(this),bytes$1(r,this.outputLen),this.finished=!0,this.iHash.digestInto(r),this.oHash.update(r),this.oHash.digestInto(r),this.destroy()}digest(){const r=new Uint8Array(this.oHash.outputLen);return this.digestInto(r),r}_cloneInto(r){r||(r=Object.create(Object.getPrototypeOf(this),{}));const{oHash:_,iHash:E,finished:S,destroyed:C,blockLen:A,outputLen:I}=this;return r=r,r.finished=S,r.destroyed=C,r.blockLen=A,r.outputLen=I,r.oHash=_._cloneInto(r.oHash),r.iHash=E._cloneInto(r.iHash),r}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}const hmac=(n,r,_)=>new HMAC(n,r).update(_).digest();hmac.create=(n,r)=>new HMAC(n,r);/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */function getHash(n){return{hash:n,hmac:(r,..._)=>hmac(n,r,concatBytes$1(..._)),randomBytes:randomBytes$3}}function createCurve(n,r){const _=E=>weierstrass({...n,...getHash(E)});return Object.freeze({..._(r),create:_})}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const secp256k1P=BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),secp256k1N=BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),_1n=BigInt(1),_2n=BigInt(2),divNearest=(n,r)=>(n+r/_2n)/r;function sqrtMod(n){const r=secp256k1P,_=BigInt(3),E=BigInt(6),S=BigInt(11),C=BigInt(22),A=BigInt(23),I=BigInt(44),B=BigInt(88),O=n*n*n%r,N=O*O*n%r,U=pow2(N,_,r)*N%r,j=pow2(U,_,r)*N%r,z=pow2(j,_2n,r)*O%r,Z=pow2(z,S,r)*z%r,X=pow2(Z,C,r)*Z%r,Q=pow2(X,I,r)*X%r,se=pow2(Q,B,r)*Q%r,oe=pow2(se,I,r)*X%r,ue=pow2(oe,_,r)*N%r,we=pow2(ue,A,r)*Z%r,Te=pow2(we,E,r)*O%r,xe=pow2(Te,_2n,r);if(!Fp.eql(Fp.sqr(xe),n))throw new Error("Cannot find square root");return xe}const Fp=Field(secp256k1P,void 0,void 0,{sqrt:sqrtMod}),secp256k1=createCurve({a:BigInt(0),b:BigInt(7),Fp,n:secp256k1N,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),h:BigInt(1),lowS:!0,endo:{beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar:n=>{const r=secp256k1N,_=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),E=-_1n*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),S=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),C=_,A=BigInt("0x100000000000000000000000000000000"),I=divNearest(C*n,r),B=divNearest(-E*n,r);let O=mod(n-I*_-B*S,r),N=mod(-I*E-B*C,r);const U=O>A,j=N>A;if(U&&(O=r-O),j&&(N=r-N),O>A||N>A)throw new Error("splitScalar: Endomorphism failed, k="+n);return{k1neg:U,k1:O,k2neg:j,k2:N}}}},sha256$2);BigInt(0);secp256k1.ProjectivePoint;function generateKey$6(){return secp256k1.utils.randomPrivateKey()}function hashAndSign$6(n,r){const _=sha256$6.digest(r instanceof Uint8Array?r:r.subarray());if(isPromise$5(_))return _.then(({digest:E})=>secp256k1.sign(E,n).toDERRawBytes()).catch(E=>{throw new CodeError$4(String(E),"ERR_INVALID_INPUT")});try{return secp256k1.sign(_.digest,n).toDERRawBytes()}catch(E){throw new CodeError$4(String(E),"ERR_INVALID_INPUT")}}function hashAndVerify$6(n,r,_){const E=sha256$6.digest(_ instanceof Uint8Array?_:_.subarray());if(isPromise$5(E))return E.then(({digest:S})=>secp256k1.verify(r,S,n)).catch(S=>{throw new CodeError$4(String(S),"ERR_INVALID_INPUT")});try{return secp256k1.verify(r,E.digest,n)}catch(S){throw new CodeError$4(String(S),"ERR_INVALID_INPUT")}}function compressPublicKey$2(n){return secp256k1.ProjectivePoint.fromHex(n).toRawBytes(!0)}function validatePrivateKey$2(n){try{secp256k1.getPublicKey(n,!0)}catch(r){throw new CodeError$4(String(r),"ERR_INVALID_PRIVATE_KEY")}}function validatePublicKey$2(n){try{secp256k1.ProjectivePoint.fromHex(n)}catch(r){throw new CodeError$4(String(r),"ERR_INVALID_PUBLIC_KEY")}}function computePublicKey$2(n){try{return secp256k1.getPublicKey(n,!0)}catch(r){throw new CodeError$4(String(r),"ERR_INVALID_PRIVATE_KEY")}}let Secp256k1PublicKey$2=class{_key;constructor(r){validatePublicKey$2(r),this._key=r}verify(r,_){return hashAndVerify$6(this._key,_,r)}marshal(){return compressPublicKey$2(this._key)}get bytes(){return PublicKey$2.encode({Type:KeyType$2.Secp256k1,Data:this.marshal()}).subarray()}equals(r){return equals$1(this.bytes,r.bytes)}async hash(){const r=sha256$6.digest(this.bytes);let _;return isPromise$5(r)?{bytes:_}=await r:_=r.bytes,_}},Secp256k1PrivateKey$2=class{_key;_publicKey;constructor(r,_){this._key=r,this._publicKey=_??computePublicKey$2(r),validatePrivateKey$2(this._key),validatePublicKey$2(this._publicKey)}sign(r){return hashAndSign$6(this._key,r)}get public(){return new Secp256k1PublicKey$2(this._publicKey)}marshal(){return this._key}get bytes(){return PrivateKey$2.encode({Type:KeyType$2.Secp256k1,Data:this.marshal()}).subarray()}equals(r){return equals$1(this.bytes,r.bytes)}hash(){const r=sha256$6.digest(this.bytes);return isPromise$5(r)?r.then(({bytes:_})=>_):r.bytes}async id(){const r=await this.public.hash();return toString$4(r,"base58btc")}async export(r,_="libp2p-key"){if(_==="libp2p-key")return exporter$3(this.bytes,r);throw new CodeError$4(`export format '${_}' is not supported`,"ERR_INVALID_EXPORT_FORMAT")}};function unmarshalSecp256k1PrivateKey$2(n){return new Secp256k1PrivateKey$2(n)}function unmarshalSecp256k1PublicKey$2(n){return new Secp256k1PublicKey$2(n)}async function generateKeyPair$8(){const n=generateKey$6();return new Secp256k1PrivateKey$2(n)}const Secp256k1$2=Object.freeze(Object.defineProperty({__proto__:null,Secp256k1PrivateKey:Secp256k1PrivateKey$2,Secp256k1PublicKey:Secp256k1PublicKey$2,generateKeyPair:generateKeyPair$8,unmarshalSecp256k1PrivateKey:unmarshalSecp256k1PrivateKey$2,unmarshalSecp256k1PublicKey:unmarshalSecp256k1PublicKey$2},Symbol.toStringTag,{value:"Module"})),supportedKeys$2={rsa:RSA$2,ed25519:Ed25519$2,secp256k1:Secp256k1$2};function unsupportedKey$2(n){const r=Object.keys(supportedKeys$2).join(" / ");return new CodeError$4(`invalid or unsupported key type ${n}. Must be ${r}`,"ERR_UNSUPPORTED_KEY_TYPE")}function typeToKey$1(n){if(n=n.toLowerCase(),n==="rsa"||n==="ed25519"||n==="secp256k1")return supportedKeys$2[n];throw unsupportedKey$2(n)}async function generateKeyPair$7(n,r){return typeToKey$1(n).generateKeyPair(r??2048)}function unmarshalPublicKey$2(n){const r=PublicKey$2.decode(n),_=r.Data??new Uint8Array;switch(r.Type){case KeyType$2.RSA:return supportedKeys$2.rsa.unmarshalRsaPublicKey(_);case KeyType$2.Ed25519:return supportedKeys$2.ed25519.unmarshalEd25519PublicKey(_);case KeyType$2.Secp256k1:return supportedKeys$2.secp256k1.unmarshalSecp256k1PublicKey(_);default:throw unsupportedKey$2(r.Type??"unknown")}}async function unmarshalPrivateKey$3(n){const r=PrivateKey$2.decode(n),_=r.Data??new Uint8Array;switch(r.Type){case KeyType$2.RSA:return supportedKeys$2.rsa.unmarshalRsaPrivateKey(_);case KeyType$2.Ed25519:return supportedKeys$2.ed25519.unmarshalEd25519PrivateKey(_);case KeyType$2.Secp256k1:return supportedKeys$2.secp256k1.unmarshalSecp256k1PrivateKey(_);default:throw unsupportedKey$2(r.Type??"RSA")}}function compare(n,r){for(let _=0;_<n.byteLength;_++){if(n[_]<r[_])return-1;if(n[_]>r[_])return 1}return n.byteLength>r.byteLength?1:n.byteLength<r.byteLength?-1:0}const unmarshal$2=supportedKeys$2.secp256k1.unmarshalSecp256k1PrivateKey,unmarshalPubKey=supportedKeys$2.secp256k1.unmarshalSecp256k1PublicKey,verifySignature=async(n,r,_)=>{if(!n)throw new Error("No signature given");if(!r)throw new Error("Given publicKey was undefined");if(!_)throw new Error("Given input data was undefined");_ instanceof Uint8Array||(_=typeof _=="string"?fromString$3(_):new Uint8Array(_));const E=(C,A,I)=>C.verify(A,I);let S=!1;try{const C=unmarshalPubKey(fromString$3(r,"base16"));S=await E(C,_,fromString$3(n,"base16"))}catch{}return Promise.resolve(S)},signMessage=async(n,r)=>{if(!n)throw new Error("No signing key given");if(!r)throw new Error("Given input data was undefined");return r instanceof Uint8Array||(r=typeof r=="string"?fromString$3(r):new Uint8Array(r)),toString$4(await n.sign(r),"base16")},verifiedCachePromise=LRUStorage({size:1e3}),verifyMessage=async(n,r,_)=>{const E=await verifiedCachePromise,S=await E.get(n);let C=!1;if(S){const A=(I,B)=>B instanceof Uint8Array?compare(I,B)===0:I.toString()===B.toString();C=S.publicKey===r&&A(S.data,_)}else{const A=await verifySignature(n,r,_);C=A,A&&await E.put(n,{publicKey:r,data:_})}return C},defaultPath="./keystore",KeyStore=async({storage:n,path:r}={})=>{n=n||await ComposedStorage(await LRUStorage({size:1e3}),await LevelStorage({path:r||defaultPath}));const _=async()=>{await n.close()},E=async()=>{await n.clear()},S=async O=>{if(!O)throw new Error("id needed to check a key");let N=!1;try{const U=await n.get("private_"+O);N=U!=null}catch{console.error("Error: ENOENT: no such file or directory")}return N},C=async(O,N)=>{await n.put("private_"+O,N.privateKey)};return{clear:E,close:_,hasKey:S,addKey:C,createKey:async O=>{if(!O)throw new Error("id needed to create a key");const N=await generateKeyPair$7("secp256k1"),U=await unmarshalPrivateKey$3(N.bytes),z={publicKey:U.public.marshal(),privateKey:U.marshal()};return await C(O,z),U},getKey:async O=>{if(!O)throw new Error("id needed to get a key");let N;try{N=await n.get("private_"+O)}catch{}if(N)return unmarshal$2(N)},getPublic:(O,N={})=>{const U=["hex","buffer"],j=N.format||"hex";if(U.indexOf(j)===-1)throw new Error("Supported formats are `hex` and `buffer`");const z=O.public.marshal();return j==="buffer"?z:toString$4(z,"base16")}}},codec$4=dagCbor,hasher$4=sha256$7,hashStringEncoding$4=base58btc$1,Identity=async({id:n,publicKey:r,signatures:_,type:E,sign:S,verify:C}={})=>{if(!n)throw new Error("Identity id is required");if(!r)throw new Error("Invalid public key");if(!_)throw new Error("Signatures object is required");if(!_.id)throw new Error("Signature of id is required");if(!_.publicKey)throw new Error("Signature of publicKey+id is required");if(!E)throw new Error("Identity type is required");_=Object.assign({},_);const A={id:n,publicKey:r,signatures:_,type:E,sign:S,verify:C},{hash:I,bytes:B}=await _encodeIdentity(A);return A.hash=I,A.bytes=B,A},_encodeIdentity=async n=>{const{id:r,publicKey:_,signatures:E,type:S}=n,C={id:r,publicKey:_,signatures:E,type:S},{cid:A,bytes:I}=await encode$k({value:C,codec:codec$4,hasher:hasher$4});return{hash:A.toString(hashStringEncoding$4),bytes:Uint8Array.from(I)}},decodeIdentity=async n=>{const{value:r}=await decode$m({bytes:n,codec:codec$4,hasher:hasher$4});return Identity({...r})},isIdentity=n=>!!(n.id&&n.hash&&n.bytes&&n.publicKey&&n.signatures&&n.signatures.id&&n.signatures.publicKey&&n.type),isEqual=(n,r)=>n.id===r.id&&n.hash===r.hash&&n.type===r.type&&n.publicKey===r.publicKey&&n.signatures.id===r.signatures.id&&n.signatures.publicKey===r.signatures.publicKey,type$8="publickey",verifyIdentity=async n=>{const{id:r,publicKey:_,signatures:E}=n;return verifyMessage(E.publicKey,r,_+E.id)},PublicKeyIdentityProvider=({keystore:n})=>async()=>{if(!n)throw new Error("PublicKeyIdentityProvider requires a keystore parameter");return{type:type$8,getId:async({id:E}={})=>{if(!E)throw new Error("id is required");const S=await n.getKey(E)||await n.createKey(E);return toString$4(S.public.marshal(),"base16")},signIdentity:async(E,{id:S}={})=>{if(!S)throw new Error("id is required");const C=await n.getKey(S);if(!C)throw new Error(`Signing key for '${S}' not found`);return signMessage(C,E)}}};PublicKeyIdentityProvider.verifyIdentity=verifyIdentity;PublicKeyIdentityProvider.type=type$8;const identityProviders={},isProviderSupported=n=>Object.keys(identityProviders).includes(n),getIdentityProvider=n=>{if(!isProviderSupported(n))throw new Error(`IdentityProvider type '${n}' is not supported`);return identityProviders[n]},useIdentityProvider=n=>{if(!n.type||typeof n.type!="string")throw new Error("Given IdentityProvider doesn't have a field 'type'.");if(!n.verifyIdentity)throw new Error("Given IdentityProvider doesn't have a function 'verifyIdentity'.");identityProviders[n.type]=n};useIdentityProvider(PublicKeyIdentityProvider);const DefaultIdentityKeysPath=posixJoin("./orbitdb","identities"),Identities=async({keystore:n,path:r,storage:_,ipfs:E}={})=>{n=n||await KeyStore({path:r||DefaultIdentityKeysPath}),_||(_=E?await ComposedStorage(await LRUStorage({size:1e3}),await IPFSBlockStorage({ipfs:E,pin:!0})):await MemoryStorage$1());const S=await LRUStorage({size:1e3}),C=async N=>{const U=await _.get(N);if(U)return decodeIdentity(U)},A=async(N={})=>{N.keystore=n;const U=getIdentityProvider("publickey"),z=await(N.provider||U({keystore:n}))();if(!getIdentityProvider(z.type))throw new Error("Identity provider is unknown. Use useIdentityProvider(provider) to register the identity provider");const Z=await z.getId(N),X=await n.getKey(Z)||await n.createKey(Z),Q=n.getPublic(X),se=await signMessage(X,Z),oe=await z.signIdentity(Q+se,N),we=await Identity({id:Z,publicKey:Q,signatures:{id:se,publicKey:oe},type:z.type,sign:B,verify:O});return await _.put(we.hash,we.bytes),we},I=async N=>{if(!isIdentity(N))return!1;const{id:U,publicKey:j,signatures:z}=N;if(!await O(z.id,j,U))return!1;const X=await S.get(z.id);if(X)return isEqual(N,X);const se=await getIdentityProvider(N.type).verifyIdentity(N);return se&&await S.put(z.id,N),se},B=async(N,U)=>{const j=await n.getKey(N.id);if(!j)throw new Error("Private signing key not found from KeyStore");return await signMessage(j,U)},O=async(N,U,j)=>await verifyMessage(N,U,j);return{createIdentity:A,verifyIdentity:I,getIdentity:C,sign:B,verify:O,keystore:n}},isValidAddress=n=>{if(n=n.toString(),!n.startsWith("/orbitdb")&&!n.startsWith("\\orbitdb"))return!1;n=n.replaceAll("/orbitdb/",""),n=n.replaceAll("\\orbitdb\\",""),n=n.replaceAll("/",""),n=n.replaceAll("\\","");let r;try{r=CID$1.parse(n,base58btc$1)}catch{return!1}return r!==void 0},OrbitDBAddress=n=>{if(n&&n.protocol==="orbitdb"&&n.hash)return n;const r="orbitdb",_=n.replace("/orbitdb/","").replace("\\orbitdb\\","");return{protocol:r,hash:_,address:n,toString:()=>posixJoin("/",r,_)}},codec$3=dagCbor,hasher$3=sha256$7,hashStringEncoding$3=base58btc$1,ManifestStore=async({ipfs:n,storage:r}={})=>(r=r||await ComposedStorage(await LRUStorage({size:1e3}),await IPFSBlockStorage({ipfs:n,pin:!0})),{get:async C=>{const A=await r.get(C),{value:I}=await decode$m({bytes:A,codec:codec$3,hasher:hasher$3});return I},create:async({name:C,type:A,accessController:I,meta:B})=>{if(!C)throw new Error("name is required");if(!A)throw new Error("type is required");if(!I)throw new Error("accessController is required");const O=Object.assign({name:C,type:A,accessController:I},B!==void 0?{meta:B}:{}),{cid:N,bytes:U}=await encode$k({value:O,codec:codec$3,hasher:hasher$3}),j=N.toString(hashStringEncoding$3);return await r.put(j,U),{hash:j,manifest:O}},close:async()=>{await r.close()}}),createId=async(n=32)=>{const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";let _="",E=0;for(;E<n;)_+=r.charAt(Math.floor(Math.random()*r.length)),E+=1;return _},codec$2=dagCbor,hasher$2=sha256$7,hashStringEncoding$2=base58btc$1,AccessControlList=async({storage:n,type:r,params:_})=>{const E={type:r,..._},{cid:S,bytes:C}=await encode$k({value:E,codec:codec$2,hasher:hasher$2}),A=S.toString(hashStringEncoding$2);return await n.put(A,C),A},type$7="ipfs",IPFSAccessController=({write:n,storage:r}={})=>async({orbitdb:_,identities:E,address:S})=>{if(r=r||await ComposedStorage(await LRUStorage({size:1e3}),await IPFSBlockStorage({ipfs:_.ipfs,pin:!0})),n=n||[_.identity.id],S){const A=await r.get(S.replaceAll("/ipfs/","")),{value:I}=await decode$m({bytes:A,codec:codec$2,hasher:hasher$2});n=I.write}else S=await AccessControlList({storage:r,type:type$7,params:{write:n}}),S=posixJoin("/",type$7,S);return{type:type$7,address:S,write:n,canAppend:async A=>{const I=await E.getIdentity(A.identity);if(!I)return!1;const{id:B}=I;return n.includes(B)||n.includes("*")?E.verifyIdentity(I):!1}}};IPFSAccessController.type=type$7;const type$6="orbitdb",OrbitDBAccessController=({write:n}={})=>async({orbitdb:r,identities:_,address:E,name:S})=>{E=E||S||await createId(64),n=n||[r.identity.id];const C=await r.open(E,{type:"keyvalue",AccessController:IPFSAccessController({write:n})});E=C.address;const A=async Z=>{const X=await _.getIdentity(Z.identity);if(!X)return!1;const{id:Q}=X;return await U("write",Q)||await U("admin",Q)?_.verifyIdentity(X):!1},I=async()=>{const Z=[];for await(const Q of C.iterator())Z[Q.key]=Q.value;const X=Q=>{const se=Q[0];Z[se]=new Set([...Z[se]||[],...Q[1]])};return Object.entries({...Z,admin:new Set([...Z.admin||[],...C.access.write])}).forEach(X),Z},B=async Z=>(await I())[Z]||new Set([]),O=async()=>{await C.close()},N=async()=>{await C.drop()},U=async(Z,X)=>{const Q=new Set(await B(Z));return Q.has(X)||Q.has("*")};return{type:type$6,address:E,write:n,canAppend:A,capabilities:I,get:B,grant:async(Z,X)=>{const Q=new Set([...await C.get(Z)||[],X]);await C.put(Z,Array.from(Q.values()))},revoke:async(Z,X)=>{const Q=new Set(await C.get(Z)||[]);Q.delete(X),Q.size>0?await C.put(Z,Array.from(Q.values())):await C.del(Z)},close:O,drop:N,events:C.events}};OrbitDBAccessController.type=type$6;const accessControllers={},getAccessController=n=>{if(!accessControllers[n])throw new Error(`AccessController type '${n}' is not supported`);return accessControllers[n]},useAccessController=n=>{if(!n.type)throw new Error("AccessController does not contain required field 'type'.");accessControllers[n.type]=n};useAccessController(IPFSAccessController);useAccessController(OrbitDBAccessController);const DefaultDatabaseType="events",DefaultAccessController=IPFSAccessController,OrbitDB=async({ipfs:n,id:r,identity:_,identities:E,directory:S}={})=>{if(n==null)throw new Error("IPFS instance is a required argument.");r=r||await createId();const C=n.libp2p.peerId;S=S||"./orbitdb";let A;E?A=E.keystore:(A=await KeyStore({path:posixJoin(S,"./keystore")}),E=await Identities({ipfs:n,keystore:A})),_?_.provider&&(_=await E.createIdentity({..._})):_=await E.createIdentity({id:r});const I=await ManifestStore({ipfs:n});let B={};const O=async(j,{type:z,meta:Z,sync:X,Database:Q,AccessController:se,headsStorage:oe,entryStorage:ue,indexStorage:we,referencesCount:Te}={})=>{let xe,Re,Ne;if(B[j])return B[j];if(isValidAddress(j)){const ht=OrbitDBAddress(j);Re=await I.get(ht.hash);const nt=Re.accessController.split("/",2).pop();se=getAccessController(nt)(),Ne=await se({orbitdb:{open:O,identity:_,ipfs:n},identities:E,address:Re.accessController}),xe=Re.name,z=z||Re.type,Z=Re.meta}else{z=z||DefaultDatabaseType,se=se||DefaultAccessController(),Ne=await se({orbitdb:{open:O,identity:_,ipfs:n},identities:E,name:j});const ht=await I.create({name:j,type:z,accessController:Ne.address,meta:Z});if(Re=ht.manifest,j=OrbitDBAddress(ht.hash),xe=Re.name,Z=Re.meta,B[j])return B[j]}if(Q=Q||getDatabaseType(z)(),!Q)throw new Error(`Unsupported database type: '${z}'`);j=j.toString();const Fe=await Q({ipfs:n,identity:_,address:j,name:xe,access:Ne,directory:S,meta:Z,syncAutomatically:X,headsStorage:oe,entryStorage:ue,indexStorage:we,referencesCount:Te});return Fe.events.on("close",N(j)),B[j]=Fe,Fe},N=j=>()=>{delete B[j]};return{id:r,open:O,stop:async()=>{for(const j of Object.values(B))await j.close();A&&await A.close(),I&&await I.close(),B={}},ipfs:n,directory:S,keystore:A,identity:_,peerId:C}};function readonly({enumerable:n=!0,configurable:r=!1}={}){return{enumerable:n,configurable:r,writable:!1}}function*linksWithin(n,r){if(r!=null&&typeof r=="object")if(Array.isArray(r))for(const[_,E]of r.entries()){const S=[...n,_],C=CID.asCID(E);C!=null?yield[S.join("/"),C]:typeof E=="object"&&(yield*links(E,S))}else{const _=CID.asCID(r);_!=null?yield[n.join("/"),_]:yield*links(r,n)}}function*links(n,r){if(n==null||n instanceof Uint8Array)return;const _=CID.asCID(n);_!=null&&(yield[r.join("/"),_]);for(const[E,S]of Object.entries(n)){const C=[...r,E];yield*linksWithin(C,S)}}function*treeWithin(n,r){if(Array.isArray(r))for(const[_,E]of r.entries()){const S=[...n,_];yield S.join("/"),typeof E=="object"&&CID.asCID(E)==null&&(yield*tree(E,S))}else yield*tree(r,n)}function*tree(n,r){if(!(n==null||typeof n!="object"))for(const[_,E]of Object.entries(n)){const S=[...r,_];yield S.join("/"),E!=null&&!(E instanceof Uint8Array)&&typeof E=="object"&&CID.asCID(E)==null&&(yield*treeWithin(S,E))}}function get(n,r){let _=n;for(const[E,S]of r.entries()){if(_=_[S],_==null)throw new Error(`Object has no property at ${r.slice(0,E+1).map(A=>`[${JSON.stringify(A)}]`).join("")}`);const C=CID.asCID(_);if(C!=null)return{value:C,remaining:r.slice(E+1).join("/")}}return{value:_}}class Block{cid;bytes;value;asBlock;constructor({cid:r,bytes:_,value:E}){if(r==null||_==null||typeof E>"u")throw new Error("Missing required argument");this.cid=r,this.bytes=_,this.value=E,this.asBlock=this,Object.defineProperties(this,{cid:readonly(),bytes:readonly(),value:readonly(),asBlock:readonly()})}links(){return links(this.value,[])}tree(){return tree(this.value,[])}get(r="/"){return get(this.value,r.split("/").filter(Boolean))}}async function encode$a({value:n,codec:r,hasher:_}){if(typeof n>"u")throw new Error('Missing required argument "value"');if(r==null||_==null)throw new Error("Missing required argument: codec or hasher");const E=r.encode(n),S=await _.digest(E),C=CID.create(1,r.code,S);return new Block({value:n,bytes:E,cid:C})}async function decode$a({bytes:n,codec:r,hasher:_}){if(n==null)throw new Error('Missing required argument "bytes"');if(r==null||_==null)throw new Error("Missing required argument: codec or hasher");const E=r.decode(n),S=await _.digest(n),C=CID.create(1,r.code,S);return new Block({value:E,bytes:n,cid:C})}const MODRATEUR="MODRATEUR",MEMBRE="MEMBRE",rles=[MODRATEUR,MEMBRE],type$5="feed",Feed=()=>async({ipfs:n,identity:r,address:_,name:E,access:S,directory:C,meta:A,headsStorage:I,entryStorage:B,indexStorage:O,referencesCount:N,syncAutomatically:U,onUpdate:j})=>{const z=await Database({ipfs:n,identity:r,address:_,name:E,access:S,directory:C,meta:A,headsStorage:I,entryStorage:B,indexStorage:O,referencesCount:N,syncAutomatically:U,onUpdate:j}),{addOperation:Z,log:X}=z,Q=async we=>Z({op:"ADD",key:null,value:we}),se=async we=>Z({op:"DEL",key:null,value:we}),oe=async function*({amount:we}={}){const Te={};let xe=0;for await(const Re of X.traverse()){const{op:Ne,value:Fe}=Re.payload,{hash:ht}=Re;if(Ne==="ADD"&&!Te[ht]){xe++;const nt=Re.hash;Te[nt]=!0,yield{value:Fe,hash:nt}}else Ne==="DEL"&&!Te[Fe]&&(Te[Fe]=!0);if(we!==void 0&&xe>=we)break}};return{...z,type:type$5,add:Q,remove:se,iterator:oe,all:async()=>{const we=[];for await(const Te of oe())we.unshift(Te);return we}}};Feed.type=type$5;const registerFeed=()=>useDatabaseType(Feed),type$4="set",Set$2=()=>async({ipfs:n,identity:r,address:_,name:E,access:S,directory:C,meta:A,headsStorage:I,entryStorage:B,indexStorage:O,referencesCount:N,syncAutomatically:U,onUpdate:j})=>{const z=await Database({ipfs:n,identity:r,address:_,name:E,access:S,directory:C,meta:A,headsStorage:I,entryStorage:B,indexStorage:O,referencesCount:N,syncAutomatically:U,onUpdate:j}),{addOperation:Z,log:X}=z,Q=async we=>Z({op:"ADD",key:null,value:we}),se=async we=>Z({op:"DEL",key:null,value:we}),oe=async function*({amount:we}={}){const Te={};let xe=0;for await(const Re of X.traverse()){const{op:Ne,value:Fe}=Re.payload,ht=JSON.stringify(Fe);if(Ne==="ADD"&&!Te[ht]){Te[ht]=!0,xe++;const nt=Re.hash;yield{value:Fe,hash:nt}}else Ne==="DEL"&&!Te[ht]&&(Te[ht]=!0);if(we!==void 0&&xe>=we)break}};return{...z,type:type$4,add:Q,del:se,iterator:oe,all:async()=>{const we=[];for await(const Te of oe())we.unshift(Te);return we}}};Set$2.type=type$4;const registerSet=()=>useDatabaseType(Set$2),type$3="ordered-keyvalue",OrderedKeyValue=()=>async({ipfs:n,identity:r,address:_,name:E,access:S,directory:C,meta:A,headsStorage:I,entryStorage:B,indexStorage:O,referencesCount:N,syncAutomatically:U,onUpdate:j})=>{const z=await Database({ipfs:n,identity:r,address:_,name:E,access:S,directory:C,meta:A,headsStorage:I,entryStorage:B,indexStorage:O,referencesCount:N,syncAutomatically:U,onUpdate:j}),{addOperation:Z,log:X}=z,Q=async(xe,Re,Ne)=>{const Fe={value:Re};return Ne!==void 0&&(Fe.position=Ne),Z({op:"PUT",key:xe,value:Fe})},se=async(xe,Re)=>Z({op:"MOVE",key:xe,value:Re}),oe=async xe=>Z({op:"DEL",key:xe,value:null}),ue=async xe=>{for await(const Re of X.traverse()){const{op:Ne,key:Fe,value:ht}=Re.payload;if(Ne==="PUT"&&Fe===xe)return ht;if(Ne==="DEL"&&Fe===xe)return}},we=async function*({amount:xe}={}){const Re={},Ne={};let Fe=0;for await(const ht of X.traverse()){const{op:nt,key:Ee,value:Ce}=ht.payload;if(!Ee)return;if(nt==="PUT"&&!Re[Ee]){Re[Ee]=!0;const _e=Ce,Ie=ht.hash,He=Ne[Ee]!==void 0?Ne[Ee]:_e.position!==void 0?_e.position:0;Ne[Ee]=He,Fe++,yield{key:Ee,value:_e.value,position:He,hash:Ie}}else nt==="MOVE"&&!Re[Ee]?Ne[Ee]=Ce:nt==="DEL"&&!Re[Ee]&&(Re[Ee]=!0);if(xe!==void 0&&Fe>=xe)break}};return{...z,type:type$3,put:Q,set:Q,del:oe,move:se,get:ue,iterator:we,all:async()=>{const xe=[];for await(const Re of we())xe.unshift(Re);return xe.sort((Re,Ne)=>Re.position>Ne.position?1:Re.position===Ne.position?0:-1).map(Re=>({key:Re.key,value:Re.value,hash:Re.hash}))}}};OrderedKeyValue.type=type$3;const registerOrderedKeyValue=()=>useDatabaseType(OrderedKeyValue);var ajv$1={exports:{}},core$3={},validate$4={},boolSchema={},errors={},codegen={},code$4={};(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.regexpCode=n.getEsmExportName=n.getProperty=n.safeStringify=n.stringify=n.strConcat=n.addCodeArg=n.str=n._=n.nil=n._Code=n.Name=n.IDENTIFIER=n._CodeOrName=void 0;class r{}n._CodeOrName=r,n.IDENTIFIER=/^[a-z$_][a-z$_0-9]*$/i;class _ extends r{constructor(oe){if(super(),!n.IDENTIFIER.test(oe))throw new Error("CodeGen: name must be a valid identifier");this.str=oe}toString(){return this.str}emptyStr(){return!1}get names(){return{[this.str]:1}}}n.Name=_;class E extends r{constructor(oe){super(),this._items=typeof oe=="string"?[oe]:oe}toString(){return this.str}emptyStr(){if(this._items.length>1)return!1;const oe=this._items[0];return oe===""||oe==='""'}get str(){var oe;return(oe=this._str)!==null&&oe!==void 0?oe:this._str=this._items.reduce((ue,we)=>`${ue}${we}`,"")}get names(){var oe;return(oe=this._names)!==null&&oe!==void 0?oe:this._names=this._items.reduce((ue,we)=>(we instanceof _&&(ue[we.str]=(ue[we.str]||0)+1),ue),{})}}n._Code=E,n.nil=new E("");function S(se,...oe){const ue=[se[0]];let we=0;for(;we<oe.length;)I(ue,oe[we]),ue.push(se[++we]);return new E(ue)}n._=S;const C=new E("+");function A(se,...oe){const ue=[z(se[0])];let we=0;for(;we<oe.length;)ue.push(C),I(ue,oe[we]),ue.push(C,z(se[++we]));return B(ue),new E(ue)}n.str=A;function I(se,oe){oe instanceof E?se.push(...oe._items):oe instanceof _?se.push(oe):se.push(U(oe))}n.addCodeArg=I;function B(se){let oe=1;for(;oe<se.length-1;){if(se[oe]===C){const ue=O(se[oe-1],se[oe+1]);if(ue!==void 0){se.splice(oe-1,3,ue);continue}se[oe++]="+"}oe++}}function O(se,oe){if(oe==='""')return se;if(se==='""')return oe;if(typeof se=="string")return oe instanceof _||se[se.length-1]!=='"'?void 0:typeof oe!="string"?`${se.slice(0,-1)}${oe}"`:oe[0]==='"'?se.slice(0,-1)+oe.slice(1):void 0;if(typeof oe=="string"&&oe[0]==='"'&&!(se instanceof _))return`"${se}${oe.slice(1)}`}function N(se,oe){return oe.emptyStr()?se:se.emptyStr()?oe:A`${se}${oe}`}n.strConcat=N;function U(se){return typeof se=="number"||typeof se=="boolean"||se===null?se:z(Array.isArray(se)?se.join(","):se)}function j(se){return new E(z(se))}n.stringify=j;function z(se){return JSON.stringify(se).replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029")}n.safeStringify=z;function Z(se){return typeof se=="string"&&n.IDENTIFIER.test(se)?new E(`.${se}`):S`[${se}]`}n.getProperty=Z;function X(se){if(typeof se=="string"&&n.IDENTIFIER.test(se))return new E(`${se}`);throw new Error(`CodeGen: invalid export name: ${se}, use explicit $id name mapping`)}n.getEsmExportName=X;function Q(se){return new E(se.toString())}n.regexpCode=Q})(code$4);var scope={};(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.ValueScope=n.ValueScopeName=n.Scope=n.varKinds=n.UsedValueState=void 0;const r=code$4;class _ extends Error{constructor(O){super(`CodeGen: "code" for ${O} not defined`),this.value=O.value}}var E;(function(B){B[B.Started=0]="Started",B[B.Completed=1]="Completed"})(E=n.UsedValueState||(n.UsedValueState={})),n.varKinds={const:new r.Name("const"),let:new r.Name("let"),var:new r.Name("var")};class S{constructor({prefixes:O,parent:N}={}){this._names={},this._prefixes=O,this._parent=N}toName(O){return O instanceof r.Name?O:this.name(O)}name(O){return new r.Name(this._newName(O))}_newName(O){const N=this._names[O]||this._nameGroup(O);return`${O}${N.index++}`}_nameGroup(O){var N,U;if(!((U=(N=this._parent)===null||N===void 0?void 0:N._prefixes)===null||U===void 0)&&U.has(O)||this._prefixes&&!this._prefixes.has(O))throw new Error(`CodeGen: prefix "${O}" is not allowed in this scope`);return this._names[O]={prefix:O,index:0}}}n.Scope=S;class C extends r.Name{constructor(O,N){super(N),this.prefix=O}setValue(O,{property:N,itemIndex:U}){this.value=O,this.scopePath=(0,r._)`.${new r.Name(N)}[${U}]`}}n.ValueScopeName=C;const A=(0,r._)`\n`;class I extends S{constructor(O){super(O),this._values={},this._scope=O.scope,this.opts={...O,_n:O.lines?A:r.nil}}get(){return this._scope}name(O){return new C(O,this._newName(O))}value(O,N){var U;if(N.ref===void 0)throw new Error("CodeGen: ref must be passed in value");const j=this.toName(O),{prefix:z}=j,Z=(U=N.key)!==null&&U!==void 0?U:N.ref;let X=this._values[z];if(X){const oe=X.get(Z);if(oe)return oe}else X=this._values[z]=new Map;X.set(Z,j);const Q=this._scope[z]||(this._scope[z]=[]),se=Q.length;return Q[se]=N.ref,j.setValue(N,{property:z,itemIndex:se}),j}getValue(O,N){const U=this._values[O];if(U)return U.get(N)}scopeRefs(O,N=this._values){return this._reduceValues(N,U=>{if(U.scopePath===void 0)throw new Error(`CodeGen: name "${U}" has no value`);return(0,r._)`${O}${U.scopePath}`})}scopeCode(O=this._values,N,U){return this._reduceValues(O,j=>{if(j.value===void 0)throw new Error(`CodeGen: name "${j}" has no value`);return j.value.code},N,U)}_reduceValues(O,N,U={},j){let z=r.nil;for(const Z in O){const X=O[Z];if(!X)continue;const Q=U[Z]=U[Z]||new Map;X.forEach(se=>{if(Q.has(se))return;Q.set(se,E.Started);let oe=N(se);if(oe){const ue=this.opts.es5?n.varKinds.var:n.varKinds.const;z=(0,r._)`${z}${ue} ${se} = ${oe};${this.opts._n}`}else if(oe=j?.(se))z=(0,r._)`${z}${oe}${this.opts._n}`;else throw new _(se);Q.set(se,E.Completed)})}return z}}n.ValueScope=I})(scope);(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.or=n.and=n.not=n.CodeGen=n.operators=n.varKinds=n.ValueScopeName=n.ValueScope=n.Scope=n.Name=n.regexpCode=n.stringify=n.getProperty=n.nil=n.strConcat=n.str=n._=void 0;const r=code$4,_=scope;var E=code$4;Object.defineProperty(n,"_",{enumerable:!0,get:function(){return E._}}),Object.defineProperty(n,"str",{enumerable:!0,get:function(){return E.str}}),Object.defineProperty(n,"strConcat",{enumerable:!0,get:function(){return E.strConcat}}),Object.defineProperty(n,"nil",{enumerable:!0,get:function(){return E.nil}}),Object.defineProperty(n,"getProperty",{enumerable:!0,get:function(){return E.getProperty}}),Object.defineProperty(n,"stringify",{enumerable:!0,get:function(){return E.stringify}}),Object.defineProperty(n,"regexpCode",{enumerable:!0,get:function(){return E.regexpCode}}),Object.defineProperty(n,"Name",{enumerable:!0,get:function(){return E.Name}});var S=scope;Object.defineProperty(n,"Scope",{enumerable:!0,get:function(){return S.Scope}}),Object.defineProperty(n,"ValueScope",{enumerable:!0,get:function(){return S.ValueScope}}),Object.defineProperty(n,"ValueScopeName",{enumerable:!0,get:function(){return S.ValueScopeName}}),Object.defineProperty(n,"varKinds",{enumerable:!0,get:function(){return S.varKinds}}),n.operators={GT:new r._Code(">"),GTE:new r._Code(">="),LT:new r._Code("<"),LTE:new r._Code("<="),EQ:new r._Code("==="),NEQ:new r._Code("!=="),NOT:new r._Code("!"),OR:new r._Code("||"),AND:new r._Code("&&"),ADD:new r._Code("+")};class C{optimizeNodes(){return this}optimizeNames(Ke,mt){return this}}class A extends C{constructor(Ke,mt,ct){super(),this.varKind=Ke,this.name=mt,this.rhs=ct}render({es5:Ke,_n:mt}){const ct=Ke?_.varKinds.var:this.varKind,Qe=this.rhs===void 0?"":` = ${this.rhs}`;return`${ct} ${this.name}${Qe};`+mt}optimizeNames(Ke,mt){if(Ke[this.name.str])return this.rhs&&(this.rhs=_e(this.rhs,Ke,mt)),this}get names(){return this.rhs instanceof r._CodeOrName?this.rhs.names:{}}}class I extends C{constructor(Ke,mt,ct){super(),this.lhs=Ke,this.rhs=mt,this.sideEffects=ct}render({_n:Ke}){return`${this.lhs} = ${this.rhs};`+Ke}optimizeNames(Ke,mt){if(!(this.lhs instanceof r.Name&&!Ke[this.lhs.str]&&!this.sideEffects))return this.rhs=_e(this.rhs,Ke,mt),this}get names(){const Ke=this.lhs instanceof r.Name?{}:{...this.lhs.names};return Ce(Ke,this.rhs)}}class B extends I{constructor(Ke,mt,ct,Qe){super(Ke,ct,Qe),this.op=mt}render({_n:Ke}){return`${this.lhs} ${this.op}= ${this.rhs};`+Ke}}class O extends C{constructor(Ke){super(),this.label=Ke,this.names={}}render({_n:Ke}){return`${this.label}:`+Ke}}class N extends C{constructor(Ke){super(),this.label=Ke,this.names={}}render({_n:Ke}){return`break${this.label?` ${this.label}`:""};`+Ke}}class U extends C{constructor(Ke){super(),this.error=Ke}render({_n:Ke}){return`throw ${this.error};`+Ke}get names(){return this.error.names}}class j extends C{constructor(Ke){super(),this.code=Ke}render({_n:Ke}){return`${this.code};`+Ke}optimizeNodes(){return`${this.code}`?this:void 0}optimizeNames(Ke,mt){return this.code=_e(this.code,Ke,mt),this}get names(){return this.code instanceof r._CodeOrName?this.code.names:{}}}class z extends C{constructor(Ke=[]){super(),this.nodes=Ke}render(Ke){return this.nodes.reduce((mt,ct)=>mt+ct.render(Ke),"")}optimizeNodes(){const{nodes:Ke}=this;let mt=Ke.length;for(;mt--;){const ct=Ke[mt].optimizeNodes();Array.isArray(ct)?Ke.splice(mt,1,...ct):ct?Ke[mt]=ct:Ke.splice(mt,1)}return Ke.length>0?this:void 0}optimizeNames(Ke,mt){const{nodes:ct}=this;let Qe=ct.length;for(;Qe--;){const dt=ct[Qe];dt.optimizeNames(Ke,mt)||(Ie(Ke,dt.names),ct.splice(Qe,1))}return ct.length>0?this:void 0}get names(){return this.nodes.reduce((Ke,mt)=>Ee(Ke,mt.names),{})}}class Z extends z{render(Ke){return"{"+Ke._n+super.render(Ke)+"}"+Ke._n}}class X extends z{}class Q extends Z{}Q.kind="else";class se extends Z{constructor(Ke,mt){super(mt),this.condition=Ke}render(Ke){let mt=`if(${this.condition})`+super.render(Ke);return this.else&&(mt+="else "+this.else.render(Ke)),mt}optimizeNodes(){super.optimizeNodes();const Ke=this.condition;if(Ke===!0)return this.nodes;let mt=this.else;if(mt){const ct=mt.optimizeNodes();mt=this.else=Array.isArray(ct)?new Q(ct):ct}if(mt)return Ke===!1?mt instanceof se?mt:mt.nodes:this.nodes.length?this:new se(He(Ke),mt instanceof se?[mt]:mt.nodes);if(!(Ke===!1||!this.nodes.length))return this}optimizeNames(Ke,mt){var ct;if(this.else=(ct=this.else)===null||ct===void 0?void 0:ct.optimizeNames(Ke,mt),!!(super.optimizeNames(Ke,mt)||this.else))return this.condition=_e(this.condition,Ke,mt),this}get names(){const Ke=super.names;return Ce(Ke,this.condition),this.else&&Ee(Ke,this.else.names),Ke}}se.kind="if";class oe extends Z{}oe.kind="for";class ue extends oe{constructor(Ke){super(),this.iteration=Ke}render(Ke){return`for(${this.iteration})`+super.render(Ke)}optimizeNames(Ke,mt){if(super.optimizeNames(Ke,mt))return this.iteration=_e(this.iteration,Ke,mt),this}get names(){return Ee(super.names,this.iteration.names)}}class we extends oe{constructor(Ke,mt,ct,Qe){super(),this.varKind=Ke,this.name=mt,this.from=ct,this.to=Qe}render(Ke){const mt=Ke.es5?_.varKinds.var:this.varKind,{name:ct,from:Qe,to:dt}=this;return`for(${mt} ${ct}=${Qe}; ${ct}<${dt}; ${ct}++)`+super.render(Ke)}get names(){const Ke=Ce(super.names,this.from);return Ce(Ke,this.to)}}class Te extends oe{constructor(Ke,mt,ct,Qe){super(),this.loop=Ke,this.varKind=mt,this.name=ct,this.iterable=Qe}render(Ke){return`for(${this.varKind} ${this.name} ${this.loop} ${this.iterable})`+super.render(Ke)}optimizeNames(Ke,mt){if(super.optimizeNames(Ke,mt))return this.iterable=_e(this.iterable,Ke,mt),this}get names(){return Ee(super.names,this.iterable.names)}}class xe extends Z{constructor(Ke,mt,ct){super(),this.name=Ke,this.args=mt,this.async=ct}render(Ke){return`${this.async?"async ":""}function ${this.name}(${this.args})`+super.render(Ke)}}xe.kind="func";class Re extends z{render(Ke){return"return "+super.render(Ke)}}Re.kind="return";class Ne extends Z{render(Ke){let mt="try"+super.render(Ke);return this.catch&&(mt+=this.catch.render(Ke)),this.finally&&(mt+=this.finally.render(Ke)),mt}optimizeNodes(){var Ke,mt;return super.optimizeNodes(),(Ke=this.catch)===null||Ke===void 0||Ke.optimizeNodes(),(mt=this.finally)===null||mt===void 0||mt.optimizeNodes(),this}optimizeNames(Ke,mt){var ct,Qe;return super.optimizeNames(Ke,mt),(ct=this.catch)===null||ct===void 0||ct.optimizeNames(Ke,mt),(Qe=this.finally)===null||Qe===void 0||Qe.optimizeNames(Ke,mt),this}get names(){const Ke=super.names;return this.catch&&Ee(Ke,this.catch.names),this.finally&&Ee(Ke,this.finally.names),Ke}}class Fe extends Z{constructor(Ke){super(),this.error=Ke}render(Ke){return`catch(${this.error})`+super.render(Ke)}}Fe.kind="catch";class ht extends Z{render(Ke){return"finally"+super.render(Ke)}}ht.kind="finally";class nt{constructor(Ke,mt={}){this._values={},this._blockStarts=[],this._constants={},this.opts={...mt,_n:mt.lines?`
`:""},this._extScope=Ke,this._scope=new _.Scope({parent:Ke}),this._nodes=[new X]}toString(){return this._root.render(this.opts)}name(Ke){return this._scope.name(Ke)}scopeName(Ke){return this._extScope.name(Ke)}scopeValue(Ke,mt){const ct=this._extScope.value(Ke,mt);return(this._values[ct.prefix]||(this._values[ct.prefix]=new Set)).add(ct),ct}getScopeValue(Ke,mt){return this._extScope.getValue(Ke,mt)}scopeRefs(Ke){return this._extScope.scopeRefs(Ke,this._values)}scopeCode(){return this._extScope.scopeCode(this._values)}_def(Ke,mt,ct,Qe){const dt=this._scope.toName(mt);return ct!==void 0&&Qe&&(this._constants[dt.str]=ct),this._leafNode(new A(Ke,dt,ct)),dt}const(Ke,mt,ct){return this._def(_.varKinds.const,Ke,mt,ct)}let(Ke,mt,ct){return this._def(_.varKinds.let,Ke,mt,ct)}var(Ke,mt,ct){return this._def(_.varKinds.var,Ke,mt,ct)}assign(Ke,mt,ct){return this._leafNode(new I(Ke,mt,ct))}add(Ke,mt){return this._leafNode(new B(Ke,n.operators.ADD,mt))}code(Ke){return typeof Ke=="function"?Ke():Ke!==r.nil&&this._leafNode(new j(Ke)),this}object(...Ke){const mt=["{"];for(const[ct,Qe]of Ke)mt.length>1&&mt.push(","),mt.push(ct),(ct!==Qe||this.opts.es5)&&(mt.push(":"),(0,r.addCodeArg)(mt,Qe));return mt.push("}"),new r._Code(mt)}if(Ke,mt,ct){if(this._blockNode(new se(Ke)),mt&&ct)this.code(mt).else().code(ct).endIf();else if(mt)this.code(mt).endIf();else if(ct)throw new Error('CodeGen: "else" body without "then" body');return this}elseIf(Ke){return this._elseNode(new se(Ke))}else(){return this._elseNode(new Q)}endIf(){return this._endBlockNode(se,Q)}_for(Ke,mt){return this._blockNode(Ke),mt&&this.code(mt).endFor(),this}for(Ke,mt){return this._for(new ue(Ke),mt)}forRange(Ke,mt,ct,Qe,dt=this.opts.es5?_.varKinds.var:_.varKinds.let){const vt=this._scope.toName(Ke);return this._for(new we(dt,vt,mt,ct),()=>Qe(vt))}forOf(Ke,mt,ct,Qe=_.varKinds.const){const dt=this._scope.toName(Ke);if(this.opts.es5){const vt=mt instanceof r.Name?mt:this.var("_arr",mt);return this.forRange("_i",0,(0,r._)`${vt}.length`,At=>{this.var(dt,(0,r._)`${vt}[${At}]`),ct(dt)})}return this._for(new Te("of",Qe,dt,mt),()=>ct(dt))}forIn(Ke,mt,ct,Qe=this.opts.es5?_.varKinds.var:_.varKinds.const){if(this.opts.ownProperties)return this.forOf(Ke,(0,r._)`Object.keys(${mt})`,ct);const dt=this._scope.toName(Ke);return this._for(new Te("in",Qe,dt,mt),()=>ct(dt))}endFor(){return this._endBlockNode(oe)}label(Ke){return this._leafNode(new O(Ke))}break(Ke){return this._leafNode(new N(Ke))}return(Ke){const mt=new Re;if(this._blockNode(mt),this.code(Ke),mt.nodes.length!==1)throw new Error('CodeGen: "return" should have one node');return this._endBlockNode(Re)}try(Ke,mt,ct){if(!mt&&!ct)throw new Error('CodeGen: "try" without "catch" and "finally"');const Qe=new Ne;if(this._blockNode(Qe),this.code(Ke),mt){const dt=this.name("e");this._currNode=Qe.catch=new Fe(dt),mt(dt)}return ct&&(this._currNode=Qe.finally=new ht,this.code(ct)),this._endBlockNode(Fe,ht)}throw(Ke){return this._leafNode(new U(Ke))}block(Ke,mt){return this._blockStarts.push(this._nodes.length),Ke&&this.code(Ke).endBlock(mt),this}endBlock(Ke){const mt=this._blockStarts.pop();if(mt===void 0)throw new Error("CodeGen: not in self-balancing block");const ct=this._nodes.length-mt;if(ct<0||Ke!==void 0&&ct!==Ke)throw new Error(`CodeGen: wrong number of nodes: ${ct} vs ${Ke} expected`);return this._nodes.length=mt,this}func(Ke,mt=r.nil,ct,Qe){return this._blockNode(new xe(Ke,mt,ct)),Qe&&this.code(Qe).endFunc(),this}endFunc(){return this._endBlockNode(xe)}optimize(Ke=1){for(;Ke-- >0;)this._root.optimizeNodes(),this._root.optimizeNames(this._root.names,this._constants)}_leafNode(Ke){return this._currNode.nodes.push(Ke),this}_blockNode(Ke){this._currNode.nodes.push(Ke),this._nodes.push(Ke)}_endBlockNode(Ke,mt){const ct=this._currNode;if(ct instanceof Ke||mt&&ct instanceof mt)return this._nodes.pop(),this;throw new Error(`CodeGen: not in block "${mt?`${Ke.kind}/${mt.kind}`:Ke.kind}"`)}_elseNode(Ke){const mt=this._currNode;if(!(mt instanceof se))throw new Error('CodeGen: "else" without "if"');return this._currNode=mt.else=Ke,this}get _root(){return this._nodes[0]}get _currNode(){const Ke=this._nodes;return Ke[Ke.length-1]}set _currNode(Ke){const mt=this._nodes;mt[mt.length-1]=Ke}}n.CodeGen=nt;function Ee(tt,Ke){for(const mt in Ke)tt[mt]=(tt[mt]||0)+(Ke[mt]||0);return tt}function Ce(tt,Ke){return Ke instanceof r._CodeOrName?Ee(tt,Ke.names):tt}function _e(tt,Ke,mt){if(tt instanceof r.Name)return ct(tt);if(!Qe(tt))return tt;return new r._Code(tt._items.reduce((dt,vt)=>(vt instanceof r.Name&&(vt=ct(vt)),vt instanceof r._Code?dt.push(...vt._items):dt.push(vt),dt),[]));function ct(dt){const vt=mt[dt.str];return vt===void 0||Ke[dt.str]!==1?dt:(delete Ke[dt.str],vt)}function Qe(dt){return dt instanceof r._Code&&dt._items.some(vt=>vt instanceof r.Name&&Ke[vt.str]===1&&mt[vt.str]!==void 0)}}function Ie(tt,Ke){for(const mt in Ke)tt[mt]=(tt[mt]||0)-(Ke[mt]||0)}function He(tt){return typeof tt=="boolean"||typeof tt=="number"||tt===null?!tt:(0,r._)`!${Me(tt)}`}n.not=He;const Be=Pe(n.operators.AND);function Ge(...tt){return tt.reduce(Be)}n.and=Ge;const je=Pe(n.operators.OR);function Ve(...tt){return tt.reduce(je)}n.or=Ve;function Pe(tt){return(Ke,mt)=>Ke===r.nil?mt:mt===r.nil?Ke:(0,r._)`${Me(Ke)} ${tt} ${Me(mt)}`}function Me(tt){return tt instanceof r.Name?tt:(0,r._)`(${tt})`}})(codegen);var util$1={};(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.checkStrictMode=n.getErrorPath=n.Type=n.useFunc=n.setEvaluated=n.evaluatedPropsToName=n.mergeEvaluated=n.eachItem=n.unescapeJsonPointer=n.escapeJsonPointer=n.escapeFragment=n.unescapeFragment=n.schemaRefOrVal=n.schemaHasRulesButRef=n.schemaHasRules=n.checkUnknownRules=n.alwaysValidSchema=n.toHash=void 0;const r=codegen,_=code$4;function E(xe){const Re={};for(const Ne of xe)Re[Ne]=!0;return Re}n.toHash=E;function S(xe,Re){return typeof Re=="boolean"?Re:Object.keys(Re).length===0?!0:(C(xe,Re),!A(Re,xe.self.RULES.all))}n.alwaysValidSchema=S;function C(xe,Re=xe.schema){const{opts:Ne,self:Fe}=xe;if(!Ne.strictSchema||typeof Re=="boolean")return;const ht=Fe.RULES.keywords;for(const nt in Re)ht[nt]||Te(xe,`unknown keyword: "${nt}"`)}n.checkUnknownRules=C;function A(xe,Re){if(typeof xe=="boolean")return!xe;for(const Ne in xe)if(Re[Ne])return!0;return!1}n.schemaHasRules=A;function I(xe,Re){if(typeof xe=="boolean")return!xe;for(const Ne in xe)if(Ne!=="$ref"&&Re.all[Ne])return!0;return!1}n.schemaHasRulesButRef=I;function B({topSchemaRef:xe,schemaPath:Re},Ne,Fe,ht){if(!ht){if(typeof Ne=="number"||typeof Ne=="boolean")return Ne;if(typeof Ne=="string")return(0,r._)`${Ne}`}return(0,r._)`${xe}${Re}${(0,r.getProperty)(Fe)}`}n.schemaRefOrVal=B;function O(xe){return j(decodeURIComponent(xe))}n.unescapeFragment=O;function N(xe){return encodeURIComponent(U(xe))}n.escapeFragment=N;function U(xe){return typeof xe=="number"?`${xe}`:xe.replace(/~/g,"~0").replace(/\//g,"~1")}n.escapeJsonPointer=U;function j(xe){return xe.replace(/~1/g,"/").replace(/~0/g,"~")}n.unescapeJsonPointer=j;function z(xe,Re){if(Array.isArray(xe))for(const Ne of xe)Re(Ne);else Re(xe)}n.eachItem=z;function Z({mergeNames:xe,mergeToName:Re,mergeValues:Ne,resultToName:Fe}){return(ht,nt,Ee,Ce)=>{const _e=Ee===void 0?nt:Ee instanceof r.Name?(nt instanceof r.Name?xe(ht,nt,Ee):Re(ht,nt,Ee),Ee):nt instanceof r.Name?(Re(ht,Ee,nt),nt):Ne(nt,Ee);return Ce===r.Name&&!(_e instanceof r.Name)?Fe(ht,_e):_e}}n.mergeEvaluated={props:Z({mergeNames:(xe,Re,Ne)=>xe.if((0,r._)`${Ne} !== true && ${Re} !== undefined`,()=>{xe.if((0,r._)`${Re} === true`,()=>xe.assign(Ne,!0),()=>xe.assign(Ne,(0,r._)`${Ne} || {}`).code((0,r._)`Object.assign(${Ne}, ${Re})`))}),mergeToName:(xe,Re,Ne)=>xe.if((0,r._)`${Ne} !== true`,()=>{Re===!0?xe.assign(Ne,!0):(xe.assign(Ne,(0,r._)`${Ne} || {}`),Q(xe,Ne,Re))}),mergeValues:(xe,Re)=>xe===!0?!0:{...xe,...Re},resultToName:X}),items:Z({mergeNames:(xe,Re,Ne)=>xe.if((0,r._)`${Ne} !== true && ${Re} !== undefined`,()=>xe.assign(Ne,(0,r._)`${Re} === true ? true : ${Ne} > ${Re} ? ${Ne} : ${Re}`)),mergeToName:(xe,Re,Ne)=>xe.if((0,r._)`${Ne} !== true`,()=>xe.assign(Ne,Re===!0?!0:(0,r._)`${Ne} > ${Re} ? ${Ne} : ${Re}`)),mergeValues:(xe,Re)=>xe===!0?!0:Math.max(xe,Re),resultToName:(xe,Re)=>xe.var("items",Re)})};function X(xe,Re){if(Re===!0)return xe.var("props",!0);const Ne=xe.var("props",(0,r._)`{}`);return Re!==void 0&&Q(xe,Ne,Re),Ne}n.evaluatedPropsToName=X;function Q(xe,Re,Ne){Object.keys(Ne).forEach(Fe=>xe.assign((0,r._)`${Re}${(0,r.getProperty)(Fe)}`,!0))}n.setEvaluated=Q;const se={};function oe(xe,Re){return xe.scopeValue("func",{ref:Re,code:se[Re.code]||(se[Re.code]=new _._Code(Re.code))})}n.useFunc=oe;var ue;(function(xe){xe[xe.Num=0]="Num",xe[xe.Str=1]="Str"})(ue=n.Type||(n.Type={}));function we(xe,Re,Ne){if(xe instanceof r.Name){const Fe=Re===ue.Num;return Ne?Fe?(0,r._)`"[" + ${xe} + "]"`:(0,r._)`"['" + ${xe} + "']"`:Fe?(0,r._)`"/" + ${xe}`:(0,r._)`"/" + ${xe}.replace(/~/g, "~0").replace(/\\//g, "~1")`}return Ne?(0,r.getProperty)(xe).toString():"/"+U(xe)}n.getErrorPath=we;function Te(xe,Re,Ne=xe.opts.strictSchema){if(Ne){if(Re=`strict mode: ${Re}`,Ne===!0)throw new Error(Re);xe.self.logger.warn(Re)}}n.checkStrictMode=Te})(util$1);var names$5={};Object.defineProperty(names$5,"__esModule",{value:!0});const codegen_1$t=codegen,names$4={data:new codegen_1$t.Name("data"),valCxt:new codegen_1$t.Name("valCxt"),instancePath:new codegen_1$t.Name("instancePath"),parentData:new codegen_1$t.Name("parentData"),parentDataProperty:new codegen_1$t.Name("parentDataProperty"),rootData:new codegen_1$t.Name("rootData"),dynamicAnchors:new codegen_1$t.Name("dynamicAnchors"),vErrors:new codegen_1$t.Name("vErrors"),errors:new codegen_1$t.Name("errors"),this:new codegen_1$t.Name("this"),self:new codegen_1$t.Name("self"),scope:new codegen_1$t.Name("scope"),json:new codegen_1$t.Name("json"),jsonPos:new codegen_1$t.Name("jsonPos"),jsonLen:new codegen_1$t.Name("jsonLen"),jsonPart:new codegen_1$t.Name("jsonPart")};names$5.default=names$4;(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.extendErrors=n.resetErrorsCount=n.reportExtraError=n.reportError=n.keyword$DataError=n.keywordError=void 0;const r=codegen,_=util$1,E=names$5;n.keywordError={message:({keyword:Q})=>(0,r.str)`must pass "${Q}" keyword validation`},n.keyword$DataError={message:({keyword:Q,schemaType:se})=>se?(0,r.str)`"${Q}" keyword must be ${se} ($data)`:(0,r.str)`"${Q}" keyword is invalid ($data)`};function S(Q,se=n.keywordError,oe,ue){const{it:we}=Q,{gen:Te,compositeRule:xe,allErrors:Re}=we,Ne=U(Q,se,oe);ue??(xe||Re)?B(Te,Ne):O(we,(0,r._)`[${Ne}]`)}n.reportError=S;function C(Q,se=n.keywordError,oe){const{it:ue}=Q,{gen:we,compositeRule:Te,allErrors:xe}=ue,Re=U(Q,se,oe);B(we,Re),Te||xe||O(ue,E.default.vErrors)}n.reportExtraError=C;function A(Q,se){Q.assign(E.default.errors,se),Q.if((0,r._)`${E.default.vErrors} !== null`,()=>Q.if(se,()=>Q.assign((0,r._)`${E.default.vErrors}.length`,se),()=>Q.assign(E.default.vErrors,null)))}n.resetErrorsCount=A;function I({gen:Q,keyword:se,schemaValue:oe,data:ue,errsCount:we,it:Te}){if(we===void 0)throw new Error("ajv implementation error");const xe=Q.name("err");Q.forRange("i",we,E.default.errors,Re=>{Q.const(xe,(0,r._)`${E.default.vErrors}[${Re}]`),Q.if((0,r._)`${xe}.instancePath === undefined`,()=>Q.assign((0,r._)`${xe}.instancePath`,(0,r.strConcat)(E.default.instancePath,Te.errorPath))),Q.assign((0,r._)`${xe}.schemaPath`,(0,r.str)`${Te.errSchemaPath}/${se}`),Te.opts.verbose&&(Q.assign((0,r._)`${xe}.schema`,oe),Q.assign((0,r._)`${xe}.data`,ue))})}n.extendErrors=I;function B(Q,se){const oe=Q.const("err",se);Q.if((0,r._)`${E.default.vErrors} === null`,()=>Q.assign(E.default.vErrors,(0,r._)`[${oe}]`),(0,r._)`${E.default.vErrors}.push(${oe})`),Q.code((0,r._)`${E.default.errors}++`)}function O(Q,se){const{gen:oe,validateName:ue,schemaEnv:we}=Q;we.$async?oe.throw((0,r._)`new ${Q.ValidationError}(${se})`):(oe.assign((0,r._)`${ue}.errors`,se),oe.return(!1))}const N={keyword:new r.Name("keyword"),schemaPath:new r.Name("schemaPath"),params:new r.Name("params"),propertyName:new r.Name("propertyName"),message:new r.Name("message"),schema:new r.Name("schema"),parentSchema:new r.Name("parentSchema")};function U(Q,se,oe){const{createErrors:ue}=Q.it;return ue===!1?(0,r._)`{}`:j(Q,se,oe)}function j(Q,se,oe={}){const{gen:ue,it:we}=Q,Te=[z(we,oe),Z(Q,oe)];return X(Q,se,Te),ue.object(...Te)}function z({errorPath:Q},{instancePath:se}){const oe=se?(0,r.str)`${Q}${(0,_.getErrorPath)(se,_.Type.Str)}`:Q;return[E.default.instancePath,(0,r.strConcat)(E.default.instancePath,oe)]}function Z({keyword:Q,it:{errSchemaPath:se}},{schemaPath:oe,parentSchema:ue}){let we=ue?se:(0,r.str)`${se}/${Q}`;return oe&&(we=(0,r.str)`${we}${(0,_.getErrorPath)(oe,_.Type.Str)}`),[N.schemaPath,we]}function X(Q,{params:se,message:oe},ue){const{keyword:we,data:Te,schemaValue:xe,it:Re}=Q,{opts:Ne,propertyName:Fe,topSchemaRef:ht,schemaPath:nt}=Re;ue.push([N.keyword,we],[N.params,typeof se=="function"?se(Q):se||(0,r._)`{}`]),Ne.messages&&ue.push([N.message,typeof oe=="function"?oe(Q):oe]),Ne.verbose&&ue.push([N.schema,xe],[N.parentSchema,(0,r._)`${ht}${nt}`],[E.default.data,Te]),Fe&&ue.push([N.propertyName,Fe])}})(errors);Object.defineProperty(boolSchema,"__esModule",{value:!0});boolSchema.boolOrEmptySchema=boolSchema.topBoolOrEmptySchema=void 0;const errors_1$2=errors,codegen_1$s=codegen,names_1$6=names$5,boolError={message:"boolean schema is false"};function topBoolOrEmptySchema(n){const{gen:r,schema:_,validateName:E}=n;_===!1?falseSchemaError(n,!1):typeof _=="object"&&_.$async===!0?r.return(names_1$6.default.data):(r.assign((0,codegen_1$s._)`${E}.errors`,null),r.return(!0))}boolSchema.topBoolOrEmptySchema=topBoolOrEmptySchema;function boolOrEmptySchema(n,r){const{gen:_,schema:E}=n;E===!1?(_.var(r,!1),falseSchemaError(n)):_.var(r,!0)}boolSchema.boolOrEmptySchema=boolOrEmptySchema;function falseSchemaError(n,r){const{gen:_,data:E}=n,S={gen:_,keyword:"false schema",data:E,schema:!1,schemaCode:!1,schemaValue:!1,params:{},it:n};(0,errors_1$2.reportError)(S,boolError,void 0,r)}var dataType={},rules={};Object.defineProperty(rules,"__esModule",{value:!0});rules.getRules=rules.isJSONType=void 0;const _jsonTypes=["string","number","integer","boolean","null","object","array"],jsonTypes=new Set(_jsonTypes);function isJSONType(n){return typeof n=="string"&&jsonTypes.has(n)}rules.isJSONType=isJSONType;function getRules(){const n={number:{type:"number",rules:[]},string:{type:"string",rules:[]},array:{type:"array",rules:[]},object:{type:"object",rules:[]}};return{types:{...n,integer:!0,boolean:!0,null:!0},rules:[{rules:[]},n.number,n.string,n.array,n.object],post:{rules:[]},all:{},keywords:{}}}rules.getRules=getRules;var applicability={};Object.defineProperty(applicability,"__esModule",{value:!0});applicability.shouldUseRule=applicability.shouldUseGroup=applicability.schemaHasRulesForType=void 0;function schemaHasRulesForType({schema:n,self:r},_){const E=r.RULES.types[_];return E&&E!==!0&&shouldUseGroup(n,E)}applicability.schemaHasRulesForType=schemaHasRulesForType;function shouldUseGroup(n,r){return r.rules.some(_=>shouldUseRule(n,_))}applicability.shouldUseGroup=shouldUseGroup;function shouldUseRule(n,r){var _;return n[r.keyword]!==void 0||((_=r.definition.implements)===null||_===void 0?void 0:_.some(E=>n[E]!==void 0))}applicability.shouldUseRule=shouldUseRule;(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.reportTypeError=n.checkDataTypes=n.checkDataType=n.coerceAndCheckDataType=n.getJSONTypes=n.getSchemaTypes=n.DataType=void 0;const r=rules,_=applicability,E=errors,S=codegen,C=util$1;var A;(function(ue){ue[ue.Correct=0]="Correct",ue[ue.Wrong=1]="Wrong"})(A=n.DataType||(n.DataType={}));function I(ue){const we=B(ue.type);if(we.includes("null")){if(ue.nullable===!1)throw new Error("type: null contradicts nullable: false")}else{if(!we.length&&ue.nullable!==void 0)throw new Error('"nullable" cannot be used without "type"');ue.nullable===!0&&we.push("null")}return we}n.getSchemaTypes=I;function B(ue){const we=Array.isArray(ue)?ue:ue?[ue]:[];if(we.every(r.isJSONType))return we;throw new Error("type must be JSONType or JSONType[]: "+we.join(","))}n.getJSONTypes=B;function O(ue,we){const{gen:Te,data:xe,opts:Re}=ue,Ne=U(we,Re.coerceTypes),Fe=we.length>0&&!(Ne.length===0&&we.length===1&&(0,_.schemaHasRulesForType)(ue,we[0]));if(Fe){const ht=X(we,xe,Re.strictNumbers,A.Wrong);Te.if(ht,()=>{Ne.length?j(ue,we,Ne):se(ue)})}return Fe}n.coerceAndCheckDataType=O;const N=new Set(["string","number","integer","boolean","null"]);function U(ue,we){return we?ue.filter(Te=>N.has(Te)||we==="array"&&Te==="array"):[]}function j(ue,we,Te){const{gen:xe,data:Re,opts:Ne}=ue,Fe=xe.let("dataType",(0,S._)`typeof ${Re}`),ht=xe.let("coerced",(0,S._)`undefined`);Ne.coerceTypes==="array"&&xe.if((0,S._)`${Fe} == 'object' && Array.isArray(${Re}) && ${Re}.length == 1`,()=>xe.assign(Re,(0,S._)`${Re}[0]`).assign(Fe,(0,S._)`typeof ${Re}`).if(X(we,Re,Ne.strictNumbers),()=>xe.assign(ht,Re))),xe.if((0,S._)`${ht} !== undefined`);for(const Ee of Te)(N.has(Ee)||Ee==="array"&&Ne.coerceTypes==="array")&&nt(Ee);xe.else(),se(ue),xe.endIf(),xe.if((0,S._)`${ht} !== undefined`,()=>{xe.assign(Re,ht),z(ue,ht)});function nt(Ee){switch(Ee){case"string":xe.elseIf((0,S._)`${Fe} == "number" || ${Fe} == "boolean"`).assign(ht,(0,S._)`"" + ${Re}`).elseIf((0,S._)`${Re} === null`).assign(ht,(0,S._)`""`);return;case"number":xe.elseIf((0,S._)`${Fe} == "boolean" || ${Re} === null
              || (${Fe} == "string" && ${Re} && ${Re} == +${Re})`).assign(ht,(0,S._)`+${Re}`);return;case"integer":xe.elseIf((0,S._)`${Fe} === "boolean" || ${Re} === null
              || (${Fe} === "string" && ${Re} && ${Re} == +${Re} && !(${Re} % 1))`).assign(ht,(0,S._)`+${Re}`);return;case"boolean":xe.elseIf((0,S._)`${Re} === "false" || ${Re} === 0 || ${Re} === null`).assign(ht,!1).elseIf((0,S._)`${Re} === "true" || ${Re} === 1`).assign(ht,!0);return;case"null":xe.elseIf((0,S._)`${Re} === "" || ${Re} === 0 || ${Re} === false`),xe.assign(ht,null);return;case"array":xe.elseIf((0,S._)`${Fe} === "string" || ${Fe} === "number"
              || ${Fe} === "boolean" || ${Re} === null`).assign(ht,(0,S._)`[${Re}]`)}}}function z({gen:ue,parentData:we,parentDataProperty:Te},xe){ue.if((0,S._)`${we} !== undefined`,()=>ue.assign((0,S._)`${we}[${Te}]`,xe))}function Z(ue,we,Te,xe=A.Correct){const Re=xe===A.Correct?S.operators.EQ:S.operators.NEQ;let Ne;switch(ue){case"null":return(0,S._)`${we} ${Re} null`;case"array":Ne=(0,S._)`Array.isArray(${we})`;break;case"object":Ne=(0,S._)`${we} && typeof ${we} == "object" && !Array.isArray(${we})`;break;case"integer":Ne=Fe((0,S._)`!(${we} % 1) && !isNaN(${we})`);break;case"number":Ne=Fe();break;default:return(0,S._)`typeof ${we} ${Re} ${ue}`}return xe===A.Correct?Ne:(0,S.not)(Ne);function Fe(ht=S.nil){return(0,S.and)((0,S._)`typeof ${we} == "number"`,ht,Te?(0,S._)`isFinite(${we})`:S.nil)}}n.checkDataType=Z;function X(ue,we,Te,xe){if(ue.length===1)return Z(ue[0],we,Te,xe);let Re;const Ne=(0,C.toHash)(ue);if(Ne.array&&Ne.object){const Fe=(0,S._)`typeof ${we} != "object"`;Re=Ne.null?Fe:(0,S._)`!${we} || ${Fe}`,delete Ne.null,delete Ne.array,delete Ne.object}else Re=S.nil;Ne.number&&delete Ne.integer;for(const Fe in Ne)Re=(0,S.and)(Re,Z(Fe,we,Te,xe));return Re}n.checkDataTypes=X;const Q={message:({schema:ue})=>`must be ${ue}`,params:({schema:ue,schemaValue:we})=>typeof ue=="string"?(0,S._)`{type: ${ue}}`:(0,S._)`{type: ${we}}`};function se(ue){const we=oe(ue);(0,E.reportError)(we,Q)}n.reportTypeError=se;function oe(ue){const{gen:we,data:Te,schema:xe}=ue,Re=(0,C.schemaRefOrVal)(ue,xe,"type");return{gen:we,keyword:"type",data:Te,schema:xe.type,schemaCode:Re,schemaValue:Re,parentSchema:xe,params:{},it:ue}}})(dataType);var defaults$1={};Object.defineProperty(defaults$1,"__esModule",{value:!0});defaults$1.assignDefaults=void 0;const codegen_1$r=codegen,util_1$p=util$1;function assignDefaults(n,r){const{properties:_,items:E}=n.schema;if(r==="object"&&_)for(const S in _)assignDefault(n,S,_[S].default);else r==="array"&&Array.isArray(E)&&E.forEach((S,C)=>assignDefault(n,C,S.default))}defaults$1.assignDefaults=assignDefaults;function assignDefault(n,r,_){const{gen:E,compositeRule:S,data:C,opts:A}=n;if(_===void 0)return;const I=(0,codegen_1$r._)`${C}${(0,codegen_1$r.getProperty)(r)}`;if(S){(0,util_1$p.checkStrictMode)(n,`default is ignored for: ${I}`);return}let B=(0,codegen_1$r._)`${I} === undefined`;A.useDefaults==="empty"&&(B=(0,codegen_1$r._)`${B} || ${I} === null || ${I} === ""`),E.if(B,(0,codegen_1$r._)`${I} = ${(0,codegen_1$r.stringify)(_)}`)}var keyword={},code$3={};Object.defineProperty(code$3,"__esModule",{value:!0});code$3.validateUnion=code$3.validateArray=code$3.usePattern=code$3.callValidateCode=code$3.schemaProperties=code$3.allSchemaProperties=code$3.noPropertyInData=code$3.propertyInData=code$3.isOwnProperty=code$3.hasPropFunc=code$3.reportMissingProp=code$3.checkMissingProp=code$3.checkReportMissingProp=void 0;const codegen_1$q=codegen,util_1$o=util$1,names_1$5=names$5,util_2$1=util$1;function checkReportMissingProp(n,r){const{gen:_,data:E,it:S}=n;_.if(noPropertyInData(_,E,r,S.opts.ownProperties),()=>{n.setParams({missingProperty:(0,codegen_1$q._)`${r}`},!0),n.error()})}code$3.checkReportMissingProp=checkReportMissingProp;function checkMissingProp({gen:n,data:r,it:{opts:_}},E,S){return(0,codegen_1$q.or)(...E.map(C=>(0,codegen_1$q.and)(noPropertyInData(n,r,C,_.ownProperties),(0,codegen_1$q._)`${S} = ${C}`)))}code$3.checkMissingProp=checkMissingProp;function reportMissingProp(n,r){n.setParams({missingProperty:r},!0),n.error()}code$3.reportMissingProp=reportMissingProp;function hasPropFunc(n){return n.scopeValue("func",{ref:Object.prototype.hasOwnProperty,code:(0,codegen_1$q._)`Object.prototype.hasOwnProperty`})}code$3.hasPropFunc=hasPropFunc;function isOwnProperty(n,r,_){return(0,codegen_1$q._)`${hasPropFunc(n)}.call(${r}, ${_})`}code$3.isOwnProperty=isOwnProperty;function propertyInData(n,r,_,E){const S=(0,codegen_1$q._)`${r}${(0,codegen_1$q.getProperty)(_)} !== undefined`;return E?(0,codegen_1$q._)`${S} && ${isOwnProperty(n,r,_)}`:S}code$3.propertyInData=propertyInData;function noPropertyInData(n,r,_,E){const S=(0,codegen_1$q._)`${r}${(0,codegen_1$q.getProperty)(_)} === undefined`;return E?(0,codegen_1$q.or)(S,(0,codegen_1$q.not)(isOwnProperty(n,r,_))):S}code$3.noPropertyInData=noPropertyInData;function allSchemaProperties(n){return n?Object.keys(n).filter(r=>r!=="__proto__"):[]}code$3.allSchemaProperties=allSchemaProperties;function schemaProperties(n,r){return allSchemaProperties(r).filter(_=>!(0,util_1$o.alwaysValidSchema)(n,r[_]))}code$3.schemaProperties=schemaProperties;function callValidateCode({schemaCode:n,data:r,it:{gen:_,topSchemaRef:E,schemaPath:S,errorPath:C},it:A},I,B,O){const N=O?(0,codegen_1$q._)`${n}, ${r}, ${E}${S}`:r,U=[[names_1$5.default.instancePath,(0,codegen_1$q.strConcat)(names_1$5.default.instancePath,C)],[names_1$5.default.parentData,A.parentData],[names_1$5.default.parentDataProperty,A.parentDataProperty],[names_1$5.default.rootData,names_1$5.default.rootData]];A.opts.dynamicRef&&U.push([names_1$5.default.dynamicAnchors,names_1$5.default.dynamicAnchors]);const j=(0,codegen_1$q._)`${N}, ${_.object(...U)}`;return B!==codegen_1$q.nil?(0,codegen_1$q._)`${I}.call(${B}, ${j})`:(0,codegen_1$q._)`${I}(${j})`}code$3.callValidateCode=callValidateCode;const newRegExp=(0,codegen_1$q._)`new RegExp`;function usePattern({gen:n,it:{opts:r}},_){const E=r.unicodeRegExp?"u":"",{regExp:S}=r.code,C=S(_,E);return n.scopeValue("pattern",{key:C.toString(),ref:C,code:(0,codegen_1$q._)`${S.code==="new RegExp"?newRegExp:(0,util_2$1.useFunc)(n,S)}(${_}, ${E})`})}code$3.usePattern=usePattern;function validateArray(n){const{gen:r,data:_,keyword:E,it:S}=n,C=r.name("valid");if(S.allErrors){const I=r.let("valid",!0);return A(()=>r.assign(I,!1)),I}return r.var(C,!0),A(()=>r.break()),C;function A(I){const B=r.const("len",(0,codegen_1$q._)`${_}.length`);r.forRange("i",0,B,O=>{n.subschema({keyword:E,dataProp:O,dataPropType:util_1$o.Type.Num},C),r.if((0,codegen_1$q.not)(C),I)})}}code$3.validateArray=validateArray;function validateUnion(n){const{gen:r,schema:_,keyword:E,it:S}=n;if(!Array.isArray(_))throw new Error("ajv implementation error");if(_.some(B=>(0,util_1$o.alwaysValidSchema)(S,B))&&!S.opts.unevaluated)return;const A=r.let("valid",!1),I=r.name("_valid");r.block(()=>_.forEach((B,O)=>{const N=n.subschema({keyword:E,schemaProp:O,compositeRule:!0},I);r.assign(A,(0,codegen_1$q._)`${A} || ${I}`),n.mergeValidEvaluated(N,I)||r.if((0,codegen_1$q.not)(A))})),n.result(A,()=>n.reset(),()=>n.error(!0))}code$3.validateUnion=validateUnion;Object.defineProperty(keyword,"__esModule",{value:!0});keyword.validateKeywordUsage=keyword.validSchemaType=keyword.funcKeywordCode=keyword.macroKeywordCode=void 0;const codegen_1$p=codegen,names_1$4=names$5,code_1$9=code$3,errors_1$1=errors;function macroKeywordCode(n,r){const{gen:_,keyword:E,schema:S,parentSchema:C,it:A}=n,I=r.macro.call(A.self,S,C,A),B=useKeyword(_,E,I);A.opts.validateSchema!==!1&&A.self.validateSchema(I,!0);const O=_.name("valid");n.subschema({schema:I,schemaPath:codegen_1$p.nil,errSchemaPath:`${A.errSchemaPath}/${E}`,topSchemaRef:B,compositeRule:!0},O),n.pass(O,()=>n.error(!0))}keyword.macroKeywordCode=macroKeywordCode;function funcKeywordCode(n,r){var _;const{gen:E,keyword:S,schema:C,parentSchema:A,$data:I,it:B}=n;checkAsyncKeyword(B,r);const O=!I&&r.compile?r.compile.call(B.self,C,A,B):r.validate,N=useKeyword(E,S,O),U=E.let("valid");n.block$data(U,j),n.ok((_=r.valid)!==null&&_!==void 0?_:U);function j(){if(r.errors===!1)X(),r.modifying&&modifyData(n),Q(()=>n.error());else{const se=r.async?z():Z();r.modifying&&modifyData(n),Q(()=>addErrs(n,se))}}function z(){const se=E.let("ruleErrs",null);return E.try(()=>X((0,codegen_1$p._)`await `),oe=>E.assign(U,!1).if((0,codegen_1$p._)`${oe} instanceof ${B.ValidationError}`,()=>E.assign(se,(0,codegen_1$p._)`${oe}.errors`),()=>E.throw(oe))),se}function Z(){const se=(0,codegen_1$p._)`${N}.errors`;return E.assign(se,null),X(codegen_1$p.nil),se}function X(se=r.async?(0,codegen_1$p._)`await `:codegen_1$p.nil){const oe=B.opts.passContext?names_1$4.default.this:names_1$4.default.self,ue=!("compile"in r&&!I||r.schema===!1);E.assign(U,(0,codegen_1$p._)`${se}${(0,code_1$9.callValidateCode)(n,N,oe,ue)}`,r.modifying)}function Q(se){var oe;E.if((0,codegen_1$p.not)((oe=r.valid)!==null&&oe!==void 0?oe:U),se)}}keyword.funcKeywordCode=funcKeywordCode;function modifyData(n){const{gen:r,data:_,it:E}=n;r.if(E.parentData,()=>r.assign(_,(0,codegen_1$p._)`${E.parentData}[${E.parentDataProperty}]`))}function addErrs(n,r){const{gen:_}=n;_.if((0,codegen_1$p._)`Array.isArray(${r})`,()=>{_.assign(names_1$4.default.vErrors,(0,codegen_1$p._)`${names_1$4.default.vErrors} === null ? ${r} : ${names_1$4.default.vErrors}.concat(${r})`).assign(names_1$4.default.errors,(0,codegen_1$p._)`${names_1$4.default.vErrors}.length`),(0,errors_1$1.extendErrors)(n)},()=>n.error())}function checkAsyncKeyword({schemaEnv:n},r){if(r.async&&!n.$async)throw new Error("async keyword in sync schema")}function useKeyword(n,r,_){if(_===void 0)throw new Error(`keyword "${r}" failed to compile`);return n.scopeValue("keyword",typeof _=="function"?{ref:_}:{ref:_,code:(0,codegen_1$p.stringify)(_)})}function validSchemaType(n,r,_=!1){return!r.length||r.some(E=>E==="array"?Array.isArray(n):E==="object"?n&&typeof n=="object"&&!Array.isArray(n):typeof n==E||_&&typeof n>"u")}keyword.validSchemaType=validSchemaType;function validateKeywordUsage({schema:n,opts:r,self:_,errSchemaPath:E},S,C){if(Array.isArray(S.keyword)?!S.keyword.includes(C):S.keyword!==C)throw new Error("ajv implementation error");const A=S.dependencies;if(A?.some(I=>!Object.prototype.hasOwnProperty.call(n,I)))throw new Error(`parent schema must have dependencies of ${C}: ${A.join(",")}`);if(S.validateSchema&&!S.validateSchema(n[C])){const B=`keyword "${C}" value is invalid at path "${E}": `+_.errorsText(S.validateSchema.errors);if(r.validateSchema==="log")_.logger.error(B);else throw new Error(B)}}keyword.validateKeywordUsage=validateKeywordUsage;var subschema={};Object.defineProperty(subschema,"__esModule",{value:!0});subschema.extendSubschemaMode=subschema.extendSubschemaData=subschema.getSubschema=void 0;const codegen_1$o=codegen,util_1$n=util$1;function getSubschema(n,{keyword:r,schemaProp:_,schema:E,schemaPath:S,errSchemaPath:C,topSchemaRef:A}){if(r!==void 0&&E!==void 0)throw new Error('both "keyword" and "schema" passed, only one allowed');if(r!==void 0){const I=n.schema[r];return _===void 0?{schema:I,schemaPath:(0,codegen_1$o._)`${n.schemaPath}${(0,codegen_1$o.getProperty)(r)}`,errSchemaPath:`${n.errSchemaPath}/${r}`}:{schema:I[_],schemaPath:(0,codegen_1$o._)`${n.schemaPath}${(0,codegen_1$o.getProperty)(r)}${(0,codegen_1$o.getProperty)(_)}`,errSchemaPath:`${n.errSchemaPath}/${r}/${(0,util_1$n.escapeFragment)(_)}`}}if(E!==void 0){if(S===void 0||C===void 0||A===void 0)throw new Error('"schemaPath", "errSchemaPath" and "topSchemaRef" are required with "schema"');return{schema:E,schemaPath:S,topSchemaRef:A,errSchemaPath:C}}throw new Error('either "keyword" or "schema" must be passed')}subschema.getSubschema=getSubschema;function extendSubschemaData(n,r,{dataProp:_,dataPropType:E,data:S,dataTypes:C,propertyName:A}){if(S!==void 0&&_!==void 0)throw new Error('both "data" and "dataProp" passed, only one allowed');const{gen:I}=r;if(_!==void 0){const{errorPath:O,dataPathArr:N,opts:U}=r,j=I.let("data",(0,codegen_1$o._)`${r.data}${(0,codegen_1$o.getProperty)(_)}`,!0);B(j),n.errorPath=(0,codegen_1$o.str)`${O}${(0,util_1$n.getErrorPath)(_,E,U.jsPropertySyntax)}`,n.parentDataProperty=(0,codegen_1$o._)`${_}`,n.dataPathArr=[...N,n.parentDataProperty]}if(S!==void 0){const O=S instanceof codegen_1$o.Name?S:I.let("data",S,!0);B(O),A!==void 0&&(n.propertyName=A)}C&&(n.dataTypes=C);function B(O){n.data=O,n.dataLevel=r.dataLevel+1,n.dataTypes=[],r.definedProperties=new Set,n.parentData=r.data,n.dataNames=[...r.dataNames,O]}}subschema.extendSubschemaData=extendSubschemaData;function extendSubschemaMode(n,{jtdDiscriminator:r,jtdMetadata:_,compositeRule:E,createErrors:S,allErrors:C}){E!==void 0&&(n.compositeRule=E),S!==void 0&&(n.createErrors=S),C!==void 0&&(n.allErrors=C),n.jtdDiscriminator=r,n.jtdMetadata=_}subschema.extendSubschemaMode=extendSubschemaMode;var resolve$8={},fastDeepEqual=function n(r,_){if(r===_)return!0;if(r&&_&&typeof r=="object"&&typeof _=="object"){if(r.constructor!==_.constructor)return!1;var E,S,C;if(Array.isArray(r)){if(E=r.length,E!=_.length)return!1;for(S=E;S--!==0;)if(!n(r[S],_[S]))return!1;return!0}if(r.constructor===RegExp)return r.source===_.source&&r.flags===_.flags;if(r.valueOf!==Object.prototype.valueOf)return r.valueOf()===_.valueOf();if(r.toString!==Object.prototype.toString)return r.toString()===_.toString();if(C=Object.keys(r),E=C.length,E!==Object.keys(_).length)return!1;for(S=E;S--!==0;)if(!Object.prototype.hasOwnProperty.call(_,C[S]))return!1;for(S=E;S--!==0;){var A=C[S];if(!n(r[A],_[A]))return!1}return!0}return r!==r&&_!==_},jsonSchemaTraverse={exports:{}},traverse$1=jsonSchemaTraverse.exports=function(n,r,_){typeof r=="function"&&(_=r,r={}),_=r.cb||_;var E=typeof _=="function"?_:_.pre||function(){},S=_.post||function(){};_traverse(r,E,S,n,"",n)};traverse$1.keywords={additionalItems:!0,items:!0,contains:!0,additionalProperties:!0,propertyNames:!0,not:!0,if:!0,then:!0,else:!0};traverse$1.arrayKeywords={items:!0,allOf:!0,anyOf:!0,oneOf:!0};traverse$1.propsKeywords={$defs:!0,definitions:!0,properties:!0,patternProperties:!0,dependencies:!0};traverse$1.skipKeywords={default:!0,enum:!0,const:!0,required:!0,maximum:!0,minimum:!0,exclusiveMaximum:!0,exclusiveMinimum:!0,multipleOf:!0,maxLength:!0,minLength:!0,pattern:!0,format:!0,maxItems:!0,minItems:!0,uniqueItems:!0,maxProperties:!0,minProperties:!0};function _traverse(n,r,_,E,S,C,A,I,B,O){if(E&&typeof E=="object"&&!Array.isArray(E)){r(E,S,C,A,I,B,O);for(var N in E){var U=E[N];if(Array.isArray(U)){if(N in traverse$1.arrayKeywords)for(var j=0;j<U.length;j++)_traverse(n,r,_,U[j],S+"/"+N+"/"+j,C,S,N,E,j)}else if(N in traverse$1.propsKeywords){if(U&&typeof U=="object")for(var z in U)_traverse(n,r,_,U[z],S+"/"+N+"/"+escapeJsonPtr(z),C,S,N,E,z)}else(N in traverse$1.keywords||n.allKeys&&!(N in traverse$1.skipKeywords))&&_traverse(n,r,_,U,S+"/"+N,C,S,N,E)}_(E,S,C,A,I,B,O)}}function escapeJsonPtr(n){return n.replace(/~/g,"~0").replace(/\//g,"~1")}var jsonSchemaTraverseExports=jsonSchemaTraverse.exports;Object.defineProperty(resolve$8,"__esModule",{value:!0});resolve$8.getSchemaRefs=resolve$8.resolveUrl=resolve$8.normalizeId=resolve$8._getFullPath=resolve$8.getFullPath=resolve$8.inlineRef=void 0;const util_1$m=util$1,equal$2=fastDeepEqual,traverse=jsonSchemaTraverseExports,SIMPLE_INLINED=new Set(["type","format","pattern","maxLength","minLength","maxProperties","minProperties","maxItems","minItems","maximum","minimum","uniqueItems","multipleOf","required","enum","const"]);function inlineRef(n,r=!0){return typeof n=="boolean"?!0:r===!0?!hasRef(n):r?countKeys(n)<=r:!1}resolve$8.inlineRef=inlineRef;const REF_KEYWORDS=new Set(["$ref","$recursiveRef","$recursiveAnchor","$dynamicRef","$dynamicAnchor"]);function hasRef(n){for(const r in n){if(REF_KEYWORDS.has(r))return!0;const _=n[r];if(Array.isArray(_)&&_.some(hasRef)||typeof _=="object"&&hasRef(_))return!0}return!1}function countKeys(n){let r=0;for(const _ in n){if(_==="$ref")return 1/0;if(r++,!SIMPLE_INLINED.has(_)&&(typeof n[_]=="object"&&(0,util_1$m.eachItem)(n[_],E=>r+=countKeys(E)),r===1/0))return 1/0}return r}function getFullPath(n,r="",_){_!==!1&&(r=normalizeId(r));const E=n.parse(r);return _getFullPath(n,E)}resolve$8.getFullPath=getFullPath;function _getFullPath(n,r){return n.serialize(r).split("#")[0]+"#"}resolve$8._getFullPath=_getFullPath;const TRAILING_SLASH_HASH=/#\/?$/;function normalizeId(n){return n?n.replace(TRAILING_SLASH_HASH,""):""}resolve$8.normalizeId=normalizeId;function resolveUrl(n,r,_){return _=normalizeId(_),n.resolve(r,_)}resolve$8.resolveUrl=resolveUrl;const ANCHOR=/^[a-z_][-a-z0-9._]*$/i;function getSchemaRefs(n,r){if(typeof n=="boolean")return{};const{schemaId:_,uriResolver:E}=this.opts,S=normalizeId(n[_]||r),C={"":S},A=getFullPath(E,S,!1),I={},B=new Set;return traverse(n,{allKeys:!0},(U,j,z,Z)=>{if(Z===void 0)return;const X=A+j;let Q=C[Z];typeof U[_]=="string"&&(Q=se.call(this,U[_])),oe.call(this,U.$anchor),oe.call(this,U.$dynamicAnchor),C[j]=Q;function se(ue){const we=this.opts.uriResolver.resolve;if(ue=normalizeId(Q?we(Q,ue):ue),B.has(ue))throw N(ue);B.add(ue);let Te=this.refs[ue];return typeof Te=="string"&&(Te=this.refs[Te]),typeof Te=="object"?O(U,Te.schema,ue):ue!==normalizeId(X)&&(ue[0]==="#"?(O(U,I[ue],ue),I[ue]=U):this.refs[ue]=X),ue}function oe(ue){if(typeof ue=="string"){if(!ANCHOR.test(ue))throw new Error(`invalid anchor "${ue}"`);se.call(this,`#${ue}`)}}}),I;function O(U,j,z){if(j!==void 0&&!equal$2(U,j))throw N(z)}function N(U){return new Error(`reference "${U}" resolves to more than one schema`)}}resolve$8.getSchemaRefs=getSchemaRefs;Object.defineProperty(validate$4,"__esModule",{value:!0});validate$4.getData=validate$4.KeywordCxt=validate$4.validateFunctionCode=void 0;const boolSchema_1=boolSchema,dataType_1$1=dataType,applicability_1=applicability,dataType_2=dataType,defaults_1=defaults$1,keyword_1=keyword,subschema_1=subschema,codegen_1$n=codegen,names_1$3=names$5,resolve_1$2=resolve$8,util_1$l=util$1,errors_1=errors;function validateFunctionCode(n){if(isSchemaObj(n)&&(checkKeywords(n),schemaCxtHasRules(n))){topSchemaObjCode(n);return}validateFunction(n,()=>(0,boolSchema_1.topBoolOrEmptySchema)(n))}validate$4.validateFunctionCode=validateFunctionCode;function validateFunction({gen:n,validateName:r,schema:_,schemaEnv:E,opts:S},C){S.code.es5?n.func(r,(0,codegen_1$n._)`${names_1$3.default.data}, ${names_1$3.default.valCxt}`,E.$async,()=>{n.code((0,codegen_1$n._)`"use strict"; ${funcSourceUrl(_,S)}`),destructureValCxtES5(n,S),n.code(C)}):n.func(r,(0,codegen_1$n._)`${names_1$3.default.data}, ${destructureValCxt(S)}`,E.$async,()=>n.code(funcSourceUrl(_,S)).code(C))}function destructureValCxt(n){return(0,codegen_1$n._)`{${names_1$3.default.instancePath}="", ${names_1$3.default.parentData}, ${names_1$3.default.parentDataProperty}, ${names_1$3.default.rootData}=${names_1$3.default.data}${n.dynamicRef?(0,codegen_1$n._)`, ${names_1$3.default.dynamicAnchors}={}`:codegen_1$n.nil}}={}`}function destructureValCxtES5(n,r){n.if(names_1$3.default.valCxt,()=>{n.var(names_1$3.default.instancePath,(0,codegen_1$n._)`${names_1$3.default.valCxt}.${names_1$3.default.instancePath}`),n.var(names_1$3.default.parentData,(0,codegen_1$n._)`${names_1$3.default.valCxt}.${names_1$3.default.parentData}`),n.var(names_1$3.default.parentDataProperty,(0,codegen_1$n._)`${names_1$3.default.valCxt}.${names_1$3.default.parentDataProperty}`),n.var(names_1$3.default.rootData,(0,codegen_1$n._)`${names_1$3.default.valCxt}.${names_1$3.default.rootData}`),r.dynamicRef&&n.var(names_1$3.default.dynamicAnchors,(0,codegen_1$n._)`${names_1$3.default.valCxt}.${names_1$3.default.dynamicAnchors}`)},()=>{n.var(names_1$3.default.instancePath,(0,codegen_1$n._)`""`),n.var(names_1$3.default.parentData,(0,codegen_1$n._)`undefined`),n.var(names_1$3.default.parentDataProperty,(0,codegen_1$n._)`undefined`),n.var(names_1$3.default.rootData,names_1$3.default.data),r.dynamicRef&&n.var(names_1$3.default.dynamicAnchors,(0,codegen_1$n._)`{}`)})}function topSchemaObjCode(n){const{schema:r,opts:_,gen:E}=n;validateFunction(n,()=>{_.$comment&&r.$comment&&commentKeyword(n),checkNoDefault(n),E.let(names_1$3.default.vErrors,null),E.let(names_1$3.default.errors,0),_.unevaluated&&resetEvaluated(n),typeAndKeywords(n),returnResults(n)})}function resetEvaluated(n){const{gen:r,validateName:_}=n;n.evaluated=r.const("evaluated",(0,codegen_1$n._)`${_}.evaluated`),r.if((0,codegen_1$n._)`${n.evaluated}.dynamicProps`,()=>r.assign((0,codegen_1$n._)`${n.evaluated}.props`,(0,codegen_1$n._)`undefined`)),r.if((0,codegen_1$n._)`${n.evaluated}.dynamicItems`,()=>r.assign((0,codegen_1$n._)`${n.evaluated}.items`,(0,codegen_1$n._)`undefined`))}function funcSourceUrl(n,r){const _=typeof n=="object"&&n[r.schemaId];return _&&(r.code.source||r.code.process)?(0,codegen_1$n._)`/*# sourceURL=${_} */`:codegen_1$n.nil}function subschemaCode(n,r){if(isSchemaObj(n)&&(checkKeywords(n),schemaCxtHasRules(n))){subSchemaObjCode(n,r);return}(0,boolSchema_1.boolOrEmptySchema)(n,r)}function schemaCxtHasRules({schema:n,self:r}){if(typeof n=="boolean")return!n;for(const _ in n)if(r.RULES.all[_])return!0;return!1}function isSchemaObj(n){return typeof n.schema!="boolean"}function subSchemaObjCode(n,r){const{schema:_,gen:E,opts:S}=n;S.$comment&&_.$comment&&commentKeyword(n),updateContext(n),checkAsyncSchema(n);const C=E.const("_errs",names_1$3.default.errors);typeAndKeywords(n,C),E.var(r,(0,codegen_1$n._)`${C} === ${names_1$3.default.errors}`)}function checkKeywords(n){(0,util_1$l.checkUnknownRules)(n),checkRefsAndKeywords(n)}function typeAndKeywords(n,r){if(n.opts.jtd)return schemaKeywords(n,[],!1,r);const _=(0,dataType_1$1.getSchemaTypes)(n.schema),E=(0,dataType_1$1.coerceAndCheckDataType)(n,_);schemaKeywords(n,_,!E,r)}function checkRefsAndKeywords(n){const{schema:r,errSchemaPath:_,opts:E,self:S}=n;r.$ref&&E.ignoreKeywordsWithRef&&(0,util_1$l.schemaHasRulesButRef)(r,S.RULES)&&S.logger.warn(`$ref: keywords ignored in schema at path "${_}"`)}function checkNoDefault(n){const{schema:r,opts:_}=n;r.default!==void 0&&_.useDefaults&&_.strictSchema&&(0,util_1$l.checkStrictMode)(n,"default is ignored in the schema root")}function updateContext(n){const r=n.schema[n.opts.schemaId];r&&(n.baseId=(0,resolve_1$2.resolveUrl)(n.opts.uriResolver,n.baseId,r))}function checkAsyncSchema(n){if(n.schema.$async&&!n.schemaEnv.$async)throw new Error("async schema in sync schema")}function commentKeyword({gen:n,schemaEnv:r,schema:_,errSchemaPath:E,opts:S}){const C=_.$comment;if(S.$comment===!0)n.code((0,codegen_1$n._)`${names_1$3.default.self}.logger.log(${C})`);else if(typeof S.$comment=="function"){const A=(0,codegen_1$n.str)`${E}/$comment`,I=n.scopeValue("root",{ref:r.root});n.code((0,codegen_1$n._)`${names_1$3.default.self}.opts.$comment(${C}, ${A}, ${I}.schema)`)}}function returnResults(n){const{gen:r,schemaEnv:_,validateName:E,ValidationError:S,opts:C}=n;_.$async?r.if((0,codegen_1$n._)`${names_1$3.default.errors} === 0`,()=>r.return(names_1$3.default.data),()=>r.throw((0,codegen_1$n._)`new ${S}(${names_1$3.default.vErrors})`)):(r.assign((0,codegen_1$n._)`${E}.errors`,names_1$3.default.vErrors),C.unevaluated&&assignEvaluated(n),r.return((0,codegen_1$n._)`${names_1$3.default.errors} === 0`))}function assignEvaluated({gen:n,evaluated:r,props:_,items:E}){_ instanceof codegen_1$n.Name&&n.assign((0,codegen_1$n._)`${r}.props`,_),E instanceof codegen_1$n.Name&&n.assign((0,codegen_1$n._)`${r}.items`,E)}function schemaKeywords(n,r,_,E){const{gen:S,schema:C,data:A,allErrors:I,opts:B,self:O}=n,{RULES:N}=O;if(C.$ref&&(B.ignoreKeywordsWithRef||!(0,util_1$l.schemaHasRulesButRef)(C,N))){S.block(()=>keywordCode(n,"$ref",N.all.$ref.definition));return}B.jtd||checkStrictTypes(n,r),S.block(()=>{for(const j of N.rules)U(j);U(N.post)});function U(j){(0,applicability_1.shouldUseGroup)(C,j)&&(j.type?(S.if((0,dataType_2.checkDataType)(j.type,A,B.strictNumbers)),iterateKeywords(n,j),r.length===1&&r[0]===j.type&&_&&(S.else(),(0,dataType_2.reportTypeError)(n)),S.endIf()):iterateKeywords(n,j),I||S.if((0,codegen_1$n._)`${names_1$3.default.errors} === ${E||0}`))}}function iterateKeywords(n,r){const{gen:_,schema:E,opts:{useDefaults:S}}=n;S&&(0,defaults_1.assignDefaults)(n,r.type),_.block(()=>{for(const C of r.rules)(0,applicability_1.shouldUseRule)(E,C)&&keywordCode(n,C.keyword,C.definition,r.type)})}function checkStrictTypes(n,r){n.schemaEnv.meta||!n.opts.strictTypes||(checkContextTypes(n,r),n.opts.allowUnionTypes||checkMultipleTypes(n,r),checkKeywordTypes(n,n.dataTypes))}function checkContextTypes(n,r){if(r.length){if(!n.dataTypes.length){n.dataTypes=r;return}r.forEach(_=>{includesType(n.dataTypes,_)||strictTypesError(n,`type "${_}" not allowed by context "${n.dataTypes.join(",")}"`)}),narrowSchemaTypes(n,r)}}function checkMultipleTypes(n,r){r.length>1&&!(r.length===2&&r.includes("null"))&&strictTypesError(n,"use allowUnionTypes to allow union type keyword")}function checkKeywordTypes(n,r){const _=n.self.RULES.all;for(const E in _){const S=_[E];if(typeof S=="object"&&(0,applicability_1.shouldUseRule)(n.schema,S)){const{type:C}=S.definition;C.length&&!C.some(A=>hasApplicableType(r,A))&&strictTypesError(n,`missing type "${C.join(",")}" for keyword "${E}"`)}}}function hasApplicableType(n,r){return n.includes(r)||r==="number"&&n.includes("integer")}function includesType(n,r){return n.includes(r)||r==="integer"&&n.includes("number")}function narrowSchemaTypes(n,r){const _=[];for(const E of n.dataTypes)includesType(r,E)?_.push(E):r.includes("integer")&&E==="number"&&_.push("integer");n.dataTypes=_}function strictTypesError(n,r){const _=n.schemaEnv.baseId+n.errSchemaPath;r+=` at "${_}" (strictTypes)`,(0,util_1$l.checkStrictMode)(n,r,n.opts.strictTypes)}class KeywordCxt{constructor(r,_,E){if((0,keyword_1.validateKeywordUsage)(r,_,E),this.gen=r.gen,this.allErrors=r.allErrors,this.keyword=E,this.data=r.data,this.schema=r.schema[E],this.$data=_.$data&&r.opts.$data&&this.schema&&this.schema.$data,this.schemaValue=(0,util_1$l.schemaRefOrVal)(r,this.schema,E,this.$data),this.schemaType=_.schemaType,this.parentSchema=r.schema,this.params={},this.it=r,this.def=_,this.$data)this.schemaCode=r.gen.const("vSchema",getData(this.$data,r));else if(this.schemaCode=this.schemaValue,!(0,keyword_1.validSchemaType)(this.schema,_.schemaType,_.allowUndefined))throw new Error(`${E} value must be ${JSON.stringify(_.schemaType)}`);("code"in _?_.trackErrors:_.errors!==!1)&&(this.errsCount=r.gen.const("_errs",names_1$3.default.errors))}result(r,_,E){this.failResult((0,codegen_1$n.not)(r),_,E)}failResult(r,_,E){this.gen.if(r),E?E():this.error(),_?(this.gen.else(),_(),this.allErrors&&this.gen.endIf()):this.allErrors?this.gen.endIf():this.gen.else()}pass(r,_){this.failResult((0,codegen_1$n.not)(r),void 0,_)}fail(r){if(r===void 0){this.error(),this.allErrors||this.gen.if(!1);return}this.gen.if(r),this.error(),this.allErrors?this.gen.endIf():this.gen.else()}fail$data(r){if(!this.$data)return this.fail(r);const{schemaCode:_}=this;this.fail((0,codegen_1$n._)`${_} !== undefined && (${(0,codegen_1$n.or)(this.invalid$data(),r)})`)}error(r,_,E){if(_){this.setParams(_),this._error(r,E),this.setParams({});return}this._error(r,E)}_error(r,_){(r?errors_1.reportExtraError:errors_1.reportError)(this,this.def.error,_)}$dataError(){(0,errors_1.reportError)(this,this.def.$dataError||errors_1.keyword$DataError)}reset(){if(this.errsCount===void 0)throw new Error('add "trackErrors" to keyword definition');(0,errors_1.resetErrorsCount)(this.gen,this.errsCount)}ok(r){this.allErrors||this.gen.if(r)}setParams(r,_){_?Object.assign(this.params,r):this.params=r}block$data(r,_,E=codegen_1$n.nil){this.gen.block(()=>{this.check$data(r,E),_()})}check$data(r=codegen_1$n.nil,_=codegen_1$n.nil){if(!this.$data)return;const{gen:E,schemaCode:S,schemaType:C,def:A}=this;E.if((0,codegen_1$n.or)((0,codegen_1$n._)`${S} === undefined`,_)),r!==codegen_1$n.nil&&E.assign(r,!0),(C.length||A.validateSchema)&&(E.elseIf(this.invalid$data()),this.$dataError(),r!==codegen_1$n.nil&&E.assign(r,!1)),E.else()}invalid$data(){const{gen:r,schemaCode:_,schemaType:E,def:S,it:C}=this;return(0,codegen_1$n.or)(A(),I());function A(){if(E.length){if(!(_ instanceof codegen_1$n.Name))throw new Error("ajv implementation error");const B=Array.isArray(E)?E:[E];return(0,codegen_1$n._)`${(0,dataType_2.checkDataTypes)(B,_,C.opts.strictNumbers,dataType_2.DataType.Wrong)}`}return codegen_1$n.nil}function I(){if(S.validateSchema){const B=r.scopeValue("validate$data",{ref:S.validateSchema});return(0,codegen_1$n._)`!${B}(${_})`}return codegen_1$n.nil}}subschema(r,_){const E=(0,subschema_1.getSubschema)(this.it,r);(0,subschema_1.extendSubschemaData)(E,this.it,r),(0,subschema_1.extendSubschemaMode)(E,r);const S={...this.it,...E,items:void 0,props:void 0};return subschemaCode(S,_),S}mergeEvaluated(r,_){const{it:E,gen:S}=this;E.opts.unevaluated&&(E.props!==!0&&r.props!==void 0&&(E.props=util_1$l.mergeEvaluated.props(S,r.props,E.props,_)),E.items!==!0&&r.items!==void 0&&(E.items=util_1$l.mergeEvaluated.items(S,r.items,E.items,_)))}mergeValidEvaluated(r,_){const{it:E,gen:S}=this;if(E.opts.unevaluated&&(E.props!==!0||E.items!==!0))return S.if(_,()=>this.mergeEvaluated(r,codegen_1$n.Name)),!0}}validate$4.KeywordCxt=KeywordCxt;function keywordCode(n,r,_,E){const S=new KeywordCxt(n,_,r);"code"in _?_.code(S,E):S.$data&&_.validate?(0,keyword_1.funcKeywordCode)(S,_):"macro"in _?(0,keyword_1.macroKeywordCode)(S,_):(_.compile||_.validate)&&(0,keyword_1.funcKeywordCode)(S,_)}const JSON_POINTER=/^\/(?:[^~]|~0|~1)*$/,RELATIVE_JSON_POINTER=/^([0-9]+)(#|\/(?:[^~]|~0|~1)*)?$/;function getData(n,{dataLevel:r,dataNames:_,dataPathArr:E}){let S,C;if(n==="")return names_1$3.default.rootData;if(n[0]==="/"){if(!JSON_POINTER.test(n))throw new Error(`Invalid JSON-pointer: ${n}`);S=n,C=names_1$3.default.rootData}else{const O=RELATIVE_JSON_POINTER.exec(n);if(!O)throw new Error(`Invalid JSON-pointer: ${n}`);const N=+O[1];if(S=O[2],S==="#"){if(N>=r)throw new Error(B("property/index",N));return E[r-N]}if(N>r)throw new Error(B("data",N));if(C=_[r-N],!S)return C}let A=C;const I=S.split("/");for(const O of I)O&&(C=(0,codegen_1$n._)`${C}${(0,codegen_1$n.getProperty)((0,util_1$l.unescapeJsonPointer)(O))}`,A=(0,codegen_1$n._)`${A} && ${C}`);return A;function B(O,N){return`Cannot access ${O} ${N} levels up, current level is ${r}`}}validate$4.getData=getData;var validation_error={};Object.defineProperty(validation_error,"__esModule",{value:!0});class ValidationError extends Error{constructor(r){super("validation failed"),this.errors=r,this.ajv=this.validation=!0}}validation_error.default=ValidationError;var ref_error={};Object.defineProperty(ref_error,"__esModule",{value:!0});const resolve_1$1=resolve$8;class MissingRefError extends Error{constructor(r,_,E,S){super(S||`can't resolve reference ${E} from id ${_}`),this.missingRef=(0,resolve_1$1.resolveUrl)(r,_,E),this.missingSchema=(0,resolve_1$1.normalizeId)((0,resolve_1$1.getFullPath)(r,this.missingRef))}}ref_error.default=MissingRefError;var compile={};Object.defineProperty(compile,"__esModule",{value:!0});compile.resolveSchema=compile.getCompilingSchema=compile.resolveRef=compile.compileSchema=compile.SchemaEnv=void 0;const codegen_1$m=codegen,validation_error_1=validation_error,names_1$2=names$5,resolve_1=resolve$8,util_1$k=util$1,validate_1$1=validate$4;class SchemaEnv{constructor(r){var _;this.refs={},this.dynamicAnchors={};let E;typeof r.schema=="object"&&(E=r.schema),this.schema=r.schema,this.schemaId=r.schemaId,this.root=r.root||this,this.baseId=(_=r.baseId)!==null&&_!==void 0?_:(0,resolve_1.normalizeId)(E?.[r.schemaId||"$id"]),this.schemaPath=r.schemaPath,this.localRefs=r.localRefs,this.meta=r.meta,this.$async=E?.$async,this.refs={}}}compile.SchemaEnv=SchemaEnv;function compileSchema(n){const r=getCompilingSchema.call(this,n);if(r)return r;const _=(0,resolve_1.getFullPath)(this.opts.uriResolver,n.root.baseId),{es5:E,lines:S}=this.opts.code,{ownProperties:C}=this.opts,A=new codegen_1$m.CodeGen(this.scope,{es5:E,lines:S,ownProperties:C});let I;n.$async&&(I=A.scopeValue("Error",{ref:validation_error_1.default,code:(0,codegen_1$m._)`require("ajv/dist/runtime/validation_error").default`}));const B=A.scopeName("validate");n.validateName=B;const O={gen:A,allErrors:this.opts.allErrors,data:names_1$2.default.data,parentData:names_1$2.default.parentData,parentDataProperty:names_1$2.default.parentDataProperty,dataNames:[names_1$2.default.data],dataPathArr:[codegen_1$m.nil],dataLevel:0,dataTypes:[],definedProperties:new Set,topSchemaRef:A.scopeValue("schema",this.opts.code.source===!0?{ref:n.schema,code:(0,codegen_1$m.stringify)(n.schema)}:{ref:n.schema}),validateName:B,ValidationError:I,schema:n.schema,schemaEnv:n,rootId:_,baseId:n.baseId||_,schemaPath:codegen_1$m.nil,errSchemaPath:n.schemaPath||(this.opts.jtd?"":"#"),errorPath:(0,codegen_1$m._)`""`,opts:this.opts,self:this};let N;try{this._compilations.add(n),(0,validate_1$1.validateFunctionCode)(O),A.optimize(this.opts.code.optimize);const U=A.toString();N=`${A.scopeRefs(names_1$2.default.scope)}return ${U}`,this.opts.code.process&&(N=this.opts.code.process(N,n));const z=new Function(`${names_1$2.default.self}`,`${names_1$2.default.scope}`,N)(this,this.scope.get());if(this.scope.value(B,{ref:z}),z.errors=null,z.schema=n.schema,z.schemaEnv=n,n.$async&&(z.$async=!0),this.opts.code.source===!0&&(z.source={validateName:B,validateCode:U,scopeValues:A._values}),this.opts.unevaluated){const{props:Z,items:X}=O;z.evaluated={props:Z instanceof codegen_1$m.Name?void 0:Z,items:X instanceof codegen_1$m.Name?void 0:X,dynamicProps:Z instanceof codegen_1$m.Name,dynamicItems:X instanceof codegen_1$m.Name},z.source&&(z.source.evaluated=(0,codegen_1$m.stringify)(z.evaluated))}return n.validate=z,n}catch(U){throw delete n.validate,delete n.validateName,N&&this.logger.error("Error compiling schema, function code:",N),U}finally{this._compilations.delete(n)}}compile.compileSchema=compileSchema;function resolveRef(n,r,_){var E;_=(0,resolve_1.resolveUrl)(this.opts.uriResolver,r,_);const S=n.refs[_];if(S)return S;let C=resolve$7.call(this,n,_);if(C===void 0){const A=(E=n.localRefs)===null||E===void 0?void 0:E[_],{schemaId:I}=this.opts;A&&(C=new SchemaEnv({schema:A,schemaId:I,root:n,baseId:r}))}if(C!==void 0)return n.refs[_]=inlineOrCompile.call(this,C)}compile.resolveRef=resolveRef;function inlineOrCompile(n){return(0,resolve_1.inlineRef)(n.schema,this.opts.inlineRefs)?n.schema:n.validate?n:compileSchema.call(this,n)}function getCompilingSchema(n){for(const r of this._compilations)if(sameSchemaEnv(r,n))return r}compile.getCompilingSchema=getCompilingSchema;function sameSchemaEnv(n,r){return n.schema===r.schema&&n.root===r.root&&n.baseId===r.baseId}function resolve$7(n,r){let _;for(;typeof(_=this.refs[r])=="string";)r=_;return _||this.schemas[r]||resolveSchema.call(this,n,r)}function resolveSchema(n,r){const _=this.opts.uriResolver.parse(r),E=(0,resolve_1._getFullPath)(this.opts.uriResolver,_);let S=(0,resolve_1.getFullPath)(this.opts.uriResolver,n.baseId,void 0);if(Object.keys(n.schema).length>0&&E===S)return getJsonPointer.call(this,_,n);const C=(0,resolve_1.normalizeId)(E),A=this.refs[C]||this.schemas[C];if(typeof A=="string"){const I=resolveSchema.call(this,n,A);return typeof I?.schema!="object"?void 0:getJsonPointer.call(this,_,I)}if(typeof A?.schema=="object"){if(A.validate||compileSchema.call(this,A),C===(0,resolve_1.normalizeId)(r)){const{schema:I}=A,{schemaId:B}=this.opts,O=I[B];return O&&(S=(0,resolve_1.resolveUrl)(this.opts.uriResolver,S,O)),new SchemaEnv({schema:I,schemaId:B,root:n,baseId:S})}return getJsonPointer.call(this,_,A)}}compile.resolveSchema=resolveSchema;const PREVENT_SCOPE_CHANGE=new Set(["properties","patternProperties","enum","dependencies","definitions"]);function getJsonPointer(n,{baseId:r,schema:_,root:E}){var S;if(((S=n.fragment)===null||S===void 0?void 0:S[0])!=="/")return;for(const I of n.fragment.slice(1).split("/")){if(typeof _=="boolean")return;const B=_[(0,util_1$k.unescapeFragment)(I)];if(B===void 0)return;_=B;const O=typeof _=="object"&&_[this.opts.schemaId];!PREVENT_SCOPE_CHANGE.has(I)&&O&&(r=(0,resolve_1.resolveUrl)(this.opts.uriResolver,r,O))}let C;if(typeof _!="boolean"&&_.$ref&&!(0,util_1$k.schemaHasRulesButRef)(_,this.RULES)){const I=(0,resolve_1.resolveUrl)(this.opts.uriResolver,r,_.$ref);C=resolveSchema.call(this,E,I)}const{schemaId:A}=this.opts;if(C=C||new SchemaEnv({schema:_,schemaId:A,root:E,baseId:r}),C.schema!==C.root.schema)return C}const $id$1="https://raw.githubusercontent.com/ajv-validator/ajv/master/lib/refs/data.json#",description="Meta-schema for $data reference (JSON AnySchema extension proposal)",type$2="object",required$1=["$data"],properties$2={$data:{type:"string",anyOf:[{format:"relative-json-pointer"},{format:"json-pointer"}]}},additionalProperties$1=!1,require$$9={$id:$id$1,description,type:type$2,required:required$1,properties:properties$2,additionalProperties:additionalProperties$1};var uri$1={},uri_all={exports:{}};/** @license URI.js v4.4.1 (c) 2011 Gary Court. License: http://github.com/garycourt/uri-js */(function(n,r){(function(_,E){E(r)})(commonjsGlobal,function(_){function E(){for(var Kt=arguments.length,jt=Array(Kt),wt=0;wt<Kt;wt++)jt[wt]=arguments[wt];if(jt.length>1){jt[0]=jt[0].slice(0,-1);for(var Rt=jt.length-1,Tt=1;Tt<Rt;++Tt)jt[Tt]=jt[Tt].slice(1,-1);return jt[Rt]=jt[Rt].slice(1),jt.join("")}else return jt[0]}function S(Kt){return"(?:"+Kt+")"}function C(Kt){return Kt===void 0?"undefined":Kt===null?"null":Object.prototype.toString.call(Kt).split(" ").pop().split("]").shift().toLowerCase()}function A(Kt){return Kt.toUpperCase()}function I(Kt){return Kt!=null?Kt instanceof Array?Kt:typeof Kt.length!="number"||Kt.split||Kt.setInterval||Kt.call?[Kt]:Array.prototype.slice.call(Kt):[]}function B(Kt,jt){var wt=Kt;if(jt)for(var Rt in jt)wt[Rt]=jt[Rt];return wt}function O(Kt){var jt="[A-Za-z]",wt="[0-9]",Rt=E(wt,"[A-Fa-f]"),Tt=S(S("%[EFef]"+Rt+"%"+Rt+Rt+"%"+Rt+Rt)+"|"+S("%[89A-Fa-f]"+Rt+"%"+Rt+Rt)+"|"+S("%"+Rt+Rt)),Dt="[\\:\\/\\?\\#\\[\\]\\@]",Ot="[\\!\\$\\&\\'\\(\\)\\*\\+\\,\\;\\=]",Vt=E(Dt,Ot),Jt=Kt?"[\\xA0-\\u200D\\u2010-\\u2029\\u202F-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF]":"[]",lr=Kt?"[\\uE000-\\uF8FF]":"[]",tr=E(jt,wt,"[\\-\\.\\_\\~]",Jt);S(jt+E(jt,wt,"[\\+\\-\\.]")+"*"),S(S(Tt+"|"+E(tr,Ot,"[\\:]"))+"*");var ir=S(S("25[0-5]")+"|"+S("2[0-4]"+wt)+"|"+S("1"+wt+wt)+"|"+S("0?[1-9]"+wt)+"|0?0?"+wt),sr=S(ir+"\\."+ir+"\\."+ir+"\\."+ir),dr=S(Rt+"{1,4}"),yr=S(S(dr+"\\:"+dr)+"|"+sr),Er=S(S(dr+"\\:")+"{6}"+yr),pr=S("\\:\\:"+S(dr+"\\:")+"{5}"+yr),_r=S(S(dr)+"?\\:\\:"+S(dr+"\\:")+"{4}"+yr),Ar=S(S(S(dr+"\\:")+"{0,1}"+dr)+"?\\:\\:"+S(dr+"\\:")+"{3}"+yr),Ur=S(S(S(dr+"\\:")+"{0,2}"+dr)+"?\\:\\:"+S(dr+"\\:")+"{2}"+yr),Hr=S(S(S(dr+"\\:")+"{0,3}"+dr)+"?\\:\\:"+dr+"\\:"+yr),Yr=S(S(S(dr+"\\:")+"{0,4}"+dr)+"?\\:\\:"+yr),dn=S(S(S(dr+"\\:")+"{0,5}"+dr)+"?\\:\\:"+dr),pn=S(S(S(dr+"\\:")+"{0,6}"+dr)+"?\\:\\:"),wn=S([Er,pr,_r,Ar,Ur,Hr,Yr,dn,pn].join("|")),mn=S(S(tr+"|"+Tt)+"+");S("[vV]"+Rt+"+\\."+E(tr,Ot,"[\\:]")+"+"),S(S(Tt+"|"+E(tr,Ot))+"*");var Tn=S(Tt+"|"+E(tr,Ot,"[\\:\\@]"));return S(S(Tt+"|"+E(tr,Ot,"[\\@]"))+"+"),S(S(Tn+"|"+E("[\\/\\?]",lr))+"*"),{NOT_SCHEME:new RegExp(E("[^]",jt,wt,"[\\+\\-\\.]"),"g"),NOT_USERINFO:new RegExp(E("[^\\%\\:]",tr,Ot),"g"),NOT_HOST:new RegExp(E("[^\\%\\[\\]\\:]",tr,Ot),"g"),NOT_PATH:new RegExp(E("[^\\%\\/\\:\\@]",tr,Ot),"g"),NOT_PATH_NOSCHEME:new RegExp(E("[^\\%\\/\\@]",tr,Ot),"g"),NOT_QUERY:new RegExp(E("[^\\%]",tr,Ot,"[\\:\\@\\/\\?]",lr),"g"),NOT_FRAGMENT:new RegExp(E("[^\\%]",tr,Ot,"[\\:\\@\\/\\?]"),"g"),ESCAPE:new RegExp(E("[^]",tr,Ot),"g"),UNRESERVED:new RegExp(tr,"g"),OTHER_CHARS:new RegExp(E("[^\\%]",tr,Vt),"g"),PCT_ENCODED:new RegExp(Tt,"g"),IPV4ADDRESS:new RegExp("^("+sr+")$"),IPV6ADDRESS:new RegExp("^\\[?("+wn+")"+S(S("\\%25|\\%(?!"+Rt+"{2})")+"("+mn+")")+"?\\]?$")}}var N=O(!1),U=O(!0),j=function(){function Kt(jt,wt){var Rt=[],Tt=!0,Dt=!1,Ot=void 0;try{for(var Vt=jt[Symbol.iterator](),Jt;!(Tt=(Jt=Vt.next()).done)&&(Rt.push(Jt.value),!(wt&&Rt.length===wt));Tt=!0);}catch(lr){Dt=!0,Ot=lr}finally{try{!Tt&&Vt.return&&Vt.return()}finally{if(Dt)throw Ot}}return Rt}return function(jt,wt){if(Array.isArray(jt))return jt;if(Symbol.iterator in Object(jt))return Kt(jt,wt);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),z=function(Kt){if(Array.isArray(Kt)){for(var jt=0,wt=Array(Kt.length);jt<Kt.length;jt++)wt[jt]=Kt[jt];return wt}else return Array.from(Kt)},Z=2147483647,X=36,Q=1,se=26,oe=38,ue=700,we=72,Te=128,xe="-",Re=/^xn--/,Ne=/[^\0-\x7E]/,Fe=/[\x2E\u3002\uFF0E\uFF61]/g,ht={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},nt=X-Q,Ee=Math.floor,Ce=String.fromCharCode;function _e(Kt){throw new RangeError(ht[Kt])}function Ie(Kt,jt){for(var wt=[],Rt=Kt.length;Rt--;)wt[Rt]=jt(Kt[Rt]);return wt}function He(Kt,jt){var wt=Kt.split("@"),Rt="";wt.length>1&&(Rt=wt[0]+"@",Kt=wt[1]),Kt=Kt.replace(Fe,".");var Tt=Kt.split("."),Dt=Ie(Tt,jt).join(".");return Rt+Dt}function Be(Kt){for(var jt=[],wt=0,Rt=Kt.length;wt<Rt;){var Tt=Kt.charCodeAt(wt++);if(Tt>=55296&&Tt<=56319&&wt<Rt){var Dt=Kt.charCodeAt(wt++);(Dt&64512)==56320?jt.push(((Tt&1023)<<10)+(Dt&1023)+65536):(jt.push(Tt),wt--)}else jt.push(Tt)}return jt}var Ge=function(jt){return String.fromCodePoint.apply(String,z(jt))},je=function(jt){return jt-48<10?jt-22:jt-65<26?jt-65:jt-97<26?jt-97:X},Ve=function(jt,wt){return jt+22+75*(jt<26)-((wt!=0)<<5)},Pe=function(jt,wt,Rt){var Tt=0;for(jt=Rt?Ee(jt/ue):jt>>1,jt+=Ee(jt/wt);jt>nt*se>>1;Tt+=X)jt=Ee(jt/nt);return Ee(Tt+(nt+1)*jt/(jt+oe))},Me=function(jt){var wt=[],Rt=jt.length,Tt=0,Dt=Te,Ot=we,Vt=jt.lastIndexOf(xe);Vt<0&&(Vt=0);for(var Jt=0;Jt<Vt;++Jt)jt.charCodeAt(Jt)>=128&&_e("not-basic"),wt.push(jt.charCodeAt(Jt));for(var lr=Vt>0?Vt+1:0;lr<Rt;){for(var tr=Tt,ir=1,sr=X;;sr+=X){lr>=Rt&&_e("invalid-input");var dr=je(jt.charCodeAt(lr++));(dr>=X||dr>Ee((Z-Tt)/ir))&&_e("overflow"),Tt+=dr*ir;var yr=sr<=Ot?Q:sr>=Ot+se?se:sr-Ot;if(dr<yr)break;var Er=X-yr;ir>Ee(Z/Er)&&_e("overflow"),ir*=Er}var pr=wt.length+1;Ot=Pe(Tt-tr,pr,tr==0),Ee(Tt/pr)>Z-Dt&&_e("overflow"),Dt+=Ee(Tt/pr),Tt%=pr,wt.splice(Tt++,0,Dt)}return String.fromCodePoint.apply(String,wt)},tt=function(jt){var wt=[];jt=Be(jt);var Rt=jt.length,Tt=Te,Dt=0,Ot=we,Vt=!0,Jt=!1,lr=void 0;try{for(var tr=jt[Symbol.iterator](),ir;!(Vt=(ir=tr.next()).done);Vt=!0){var sr=ir.value;sr<128&&wt.push(Ce(sr))}}catch(ci){Jt=!0,lr=ci}finally{try{!Vt&&tr.return&&tr.return()}finally{if(Jt)throw lr}}var dr=wt.length,yr=dr;for(dr&&wt.push(xe);yr<Rt;){var Er=Z,pr=!0,_r=!1,Ar=void 0;try{for(var Ur=jt[Symbol.iterator](),Hr;!(pr=(Hr=Ur.next()).done);pr=!0){var Yr=Hr.value;Yr>=Tt&&Yr<Er&&(Er=Yr)}}catch(ci){_r=!0,Ar=ci}finally{try{!pr&&Ur.return&&Ur.return()}finally{if(_r)throw Ar}}var dn=yr+1;Er-Tt>Ee((Z-Dt)/dn)&&_e("overflow"),Dt+=(Er-Tt)*dn,Tt=Er;var pn=!0,wn=!1,mn=void 0;try{for(var Tn=jt[Symbol.iterator](),Rn;!(pn=(Rn=Tn.next()).done);pn=!0){var hi=Rn.value;if(hi<Tt&&++Dt>Z&&_e("overflow"),hi==Tt){for(var Di=Dt,Oi=X;;Oi+=X){var xi=Oi<=Ot?Q:Oi>=Ot+se?se:Oi-Ot;if(Di<xi)break;var xs=Di-xi,as=X-xi;wt.push(Ce(Ve(xi+xs%as,0))),Di=Ee(xs/as)}wt.push(Ce(Ve(Di,0))),Ot=Pe(Dt,dn,yr==dr),Dt=0,++yr}}}catch(ci){wn=!0,mn=ci}finally{try{!pn&&Tn.return&&Tn.return()}finally{if(wn)throw mn}}++Dt,++Tt}return wt.join("")},Ke=function(jt){return He(jt,function(wt){return Re.test(wt)?Me(wt.slice(4).toLowerCase()):wt})},mt=function(jt){return He(jt,function(wt){return Ne.test(wt)?"xn--"+tt(wt):wt})},ct={version:"2.1.0",ucs2:{decode:Be,encode:Ge},decode:Me,encode:tt,toASCII:mt,toUnicode:Ke},Qe={};function dt(Kt){var jt=Kt.charCodeAt(0),wt=void 0;return jt<16?wt="%0"+jt.toString(16).toUpperCase():jt<128?wt="%"+jt.toString(16).toUpperCase():jt<2048?wt="%"+(jt>>6|192).toString(16).toUpperCase()+"%"+(jt&63|128).toString(16).toUpperCase():wt="%"+(jt>>12|224).toString(16).toUpperCase()+"%"+(jt>>6&63|128).toString(16).toUpperCase()+"%"+(jt&63|128).toString(16).toUpperCase(),wt}function vt(Kt){for(var jt="",wt=0,Rt=Kt.length;wt<Rt;){var Tt=parseInt(Kt.substr(wt+1,2),16);if(Tt<128)jt+=String.fromCharCode(Tt),wt+=3;else if(Tt>=194&&Tt<224){if(Rt-wt>=6){var Dt=parseInt(Kt.substr(wt+4,2),16);jt+=String.fromCharCode((Tt&31)<<6|Dt&63)}else jt+=Kt.substr(wt,6);wt+=6}else if(Tt>=224){if(Rt-wt>=9){var Ot=parseInt(Kt.substr(wt+4,2),16),Vt=parseInt(Kt.substr(wt+7,2),16);jt+=String.fromCharCode((Tt&15)<<12|(Ot&63)<<6|Vt&63)}else jt+=Kt.substr(wt,9);wt+=9}else jt+=Kt.substr(wt,3),wt+=3}return jt}function At(Kt,jt){function wt(Rt){var Tt=vt(Rt);return Tt.match(jt.UNRESERVED)?Tt:Rt}return Kt.scheme&&(Kt.scheme=String(Kt.scheme).replace(jt.PCT_ENCODED,wt).toLowerCase().replace(jt.NOT_SCHEME,"")),Kt.userinfo!==void 0&&(Kt.userinfo=String(Kt.userinfo).replace(jt.PCT_ENCODED,wt).replace(jt.NOT_USERINFO,dt).replace(jt.PCT_ENCODED,A)),Kt.host!==void 0&&(Kt.host=String(Kt.host).replace(jt.PCT_ENCODED,wt).toLowerCase().replace(jt.NOT_HOST,dt).replace(jt.PCT_ENCODED,A)),Kt.path!==void 0&&(Kt.path=String(Kt.path).replace(jt.PCT_ENCODED,wt).replace(Kt.scheme?jt.NOT_PATH:jt.NOT_PATH_NOSCHEME,dt).replace(jt.PCT_ENCODED,A)),Kt.query!==void 0&&(Kt.query=String(Kt.query).replace(jt.PCT_ENCODED,wt).replace(jt.NOT_QUERY,dt).replace(jt.PCT_ENCODED,A)),Kt.fragment!==void 0&&(Kt.fragment=String(Kt.fragment).replace(jt.PCT_ENCODED,wt).replace(jt.NOT_FRAGMENT,dt).replace(jt.PCT_ENCODED,A)),Kt}function bt(Kt){return Kt.replace(/^0*(.*)/,"$1")||"0"}function ft(Kt,jt){var wt=Kt.match(jt.IPV4ADDRESS)||[],Rt=j(wt,2),Tt=Rt[1];return Tt?Tt.split(".").map(bt).join("."):Kt}function Et(Kt,jt){var wt=Kt.match(jt.IPV6ADDRESS)||[],Rt=j(wt,3),Tt=Rt[1],Dt=Rt[2];if(Tt){for(var Ot=Tt.toLowerCase().split("::").reverse(),Vt=j(Ot,2),Jt=Vt[0],lr=Vt[1],tr=lr?lr.split(":").map(bt):[],ir=Jt.split(":").map(bt),sr=jt.IPV4ADDRESS.test(ir[ir.length-1]),dr=sr?7:8,yr=ir.length-dr,Er=Array(dr),pr=0;pr<dr;++pr)Er[pr]=tr[pr]||ir[yr+pr]||"";sr&&(Er[dr-1]=ft(Er[dr-1],jt));var _r=Er.reduce(function(dn,pn,wn){if(!pn||pn==="0"){var mn=dn[dn.length-1];mn&&mn.index+mn.length===wn?mn.length++:dn.push({index:wn,length:1})}return dn},[]),Ar=_r.sort(function(dn,pn){return pn.length-dn.length})[0],Ur=void 0;if(Ar&&Ar.length>1){var Hr=Er.slice(0,Ar.index),Yr=Er.slice(Ar.index+Ar.length);Ur=Hr.join(":")+"::"+Yr.join(":")}else Ur=Er.join(":");return Dt&&(Ur+="%"+Dt),Ur}else return Kt}var Ye=/^(?:([^:\/?#]+):)?(?:\/\/((?:([^\/?#@]*)@)?(\[[^\/?#\]]+\]|[^\/?#:]*)(?:\:(\d*))?))?([^?#]*)(?:\?([^#]*))?(?:#((?:.|\n|\r)*))?/i,Ct="".match(/(){0}/)[1]===void 0;function Pt(Kt){var jt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},wt={},Rt=jt.iri!==!1?U:N;jt.reference==="suffix"&&(Kt=(jt.scheme?jt.scheme+":":"")+"//"+Kt);var Tt=Kt.match(Ye);if(Tt){Ct?(wt.scheme=Tt[1],wt.userinfo=Tt[3],wt.host=Tt[4],wt.port=parseInt(Tt[5],10),wt.path=Tt[6]||"",wt.query=Tt[7],wt.fragment=Tt[8],isNaN(wt.port)&&(wt.port=Tt[5])):(wt.scheme=Tt[1]||void 0,wt.userinfo=Kt.indexOf("@")!==-1?Tt[3]:void 0,wt.host=Kt.indexOf("//")!==-1?Tt[4]:void 0,wt.port=parseInt(Tt[5],10),wt.path=Tt[6]||"",wt.query=Kt.indexOf("?")!==-1?Tt[7]:void 0,wt.fragment=Kt.indexOf("#")!==-1?Tt[8]:void 0,isNaN(wt.port)&&(wt.port=Kt.match(/\/\/(?:.|\n)*\:(?:\/|\?|\#|$)/)?Tt[4]:void 0)),wt.host&&(wt.host=Et(ft(wt.host,Rt),Rt)),wt.scheme===void 0&&wt.userinfo===void 0&&wt.host===void 0&&wt.port===void 0&&!wt.path&&wt.query===void 0?wt.reference="same-document":wt.scheme===void 0?wt.reference="relative":wt.fragment===void 0?wt.reference="absolute":wt.reference="uri",jt.reference&&jt.reference!=="suffix"&&jt.reference!==wt.reference&&(wt.error=wt.error||"URI is not a "+jt.reference+" reference.");var Dt=Qe[(jt.scheme||wt.scheme||"").toLowerCase()];if(!jt.unicodeSupport&&(!Dt||!Dt.unicodeSupport)){if(wt.host&&(jt.domainHost||Dt&&Dt.domainHost))try{wt.host=ct.toASCII(wt.host.replace(Rt.PCT_ENCODED,vt).toLowerCase())}catch(Ot){wt.error=wt.error||"Host's domain name can not be converted to ASCII via punycode: "+Ot}At(wt,N)}else At(wt,Rt);Dt&&Dt.parse&&Dt.parse(wt,jt)}else wt.error=wt.error||"URI can not be parsed.";return wt}function St(Kt,jt){var wt=jt.iri!==!1?U:N,Rt=[];return Kt.userinfo!==void 0&&(Rt.push(Kt.userinfo),Rt.push("@")),Kt.host!==void 0&&Rt.push(Et(ft(String(Kt.host),wt),wt).replace(wt.IPV6ADDRESS,function(Tt,Dt,Ot){return"["+Dt+(Ot?"%25"+Ot:"")+"]"})),(typeof Kt.port=="number"||typeof Kt.port=="string")&&(Rt.push(":"),Rt.push(String(Kt.port))),Rt.length?Rt.join(""):void 0}var $t=/^\.\.?\//,kt=/^\/\.(\/|$)/,Ft=/^\/\.\.(\/|$)/,qt=/^\/?(?:.|\n)*?(?=\/|$)/;function Mt(Kt){for(var jt=[];Kt.length;)if(Kt.match($t))Kt=Kt.replace($t,"");else if(Kt.match(kt))Kt=Kt.replace(kt,"/");else if(Kt.match(Ft))Kt=Kt.replace(Ft,"/"),jt.pop();else if(Kt==="."||Kt==="..")Kt="";else{var wt=Kt.match(qt);if(wt){var Rt=wt[0];Kt=Kt.slice(Rt.length),jt.push(Rt)}else throw new Error("Unexpected dot segment condition")}return jt.join("")}function Wt(Kt){var jt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},wt=jt.iri?U:N,Rt=[],Tt=Qe[(jt.scheme||Kt.scheme||"").toLowerCase()];if(Tt&&Tt.serialize&&Tt.serialize(Kt,jt),Kt.host&&!wt.IPV6ADDRESS.test(Kt.host)){if(jt.domainHost||Tt&&Tt.domainHost)try{Kt.host=jt.iri?ct.toUnicode(Kt.host):ct.toASCII(Kt.host.replace(wt.PCT_ENCODED,vt).toLowerCase())}catch(Vt){Kt.error=Kt.error||"Host's domain name can not be converted to "+(jt.iri?"Unicode":"ASCII")+" via punycode: "+Vt}}At(Kt,wt),jt.reference!=="suffix"&&Kt.scheme&&(Rt.push(Kt.scheme),Rt.push(":"));var Dt=St(Kt,jt);if(Dt!==void 0&&(jt.reference!=="suffix"&&Rt.push("//"),Rt.push(Dt),Kt.path&&Kt.path.charAt(0)!=="/"&&Rt.push("/")),Kt.path!==void 0){var Ot=Kt.path;!jt.absolutePath&&(!Tt||!Tt.absolutePath)&&(Ot=Mt(Ot)),Dt===void 0&&(Ot=Ot.replace(/^\/\//,"/%2F")),Rt.push(Ot)}return Kt.query!==void 0&&(Rt.push("?"),Rt.push(Kt.query)),Kt.fragment!==void 0&&(Rt.push("#"),Rt.push(Kt.fragment)),Rt.join("")}function Zt(Kt,jt){var wt=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},Rt=arguments[3],Tt={};return Rt||(Kt=Pt(Wt(Kt,wt),wt),jt=Pt(Wt(jt,wt),wt)),wt=wt||{},!wt.tolerant&&jt.scheme?(Tt.scheme=jt.scheme,Tt.userinfo=jt.userinfo,Tt.host=jt.host,Tt.port=jt.port,Tt.path=Mt(jt.path||""),Tt.query=jt.query):(jt.userinfo!==void 0||jt.host!==void 0||jt.port!==void 0?(Tt.userinfo=jt.userinfo,Tt.host=jt.host,Tt.port=jt.port,Tt.path=Mt(jt.path||""),Tt.query=jt.query):(jt.path?(jt.path.charAt(0)==="/"?Tt.path=Mt(jt.path):((Kt.userinfo!==void 0||Kt.host!==void 0||Kt.port!==void 0)&&!Kt.path?Tt.path="/"+jt.path:Kt.path?Tt.path=Kt.path.slice(0,Kt.path.lastIndexOf("/")+1)+jt.path:Tt.path=jt.path,Tt.path=Mt(Tt.path)),Tt.query=jt.query):(Tt.path=Kt.path,jt.query!==void 0?Tt.query=jt.query:Tt.query=Kt.query),Tt.userinfo=Kt.userinfo,Tt.host=Kt.host,Tt.port=Kt.port),Tt.scheme=Kt.scheme),Tt.fragment=jt.fragment,Tt}function Yt(Kt,jt,wt){var Rt=B({scheme:"null"},wt);return Wt(Zt(Pt(Kt,Rt),Pt(jt,Rt),Rt,!0),Rt)}function ur(Kt,jt){return typeof Kt=="string"?Kt=Wt(Pt(Kt,jt),jt):C(Kt)==="object"&&(Kt=Pt(Wt(Kt,jt),jt)),Kt}function xt(Kt,jt,wt){return typeof Kt=="string"?Kt=Wt(Pt(Kt,wt),wt):C(Kt)==="object"&&(Kt=Wt(Kt,wt)),typeof jt=="string"?jt=Wt(Pt(jt,wt),wt):C(jt)==="object"&&(jt=Wt(jt,wt)),Kt===jt}function pt(Kt,jt){return Kt&&Kt.toString().replace(!jt||!jt.iri?N.ESCAPE:U.ESCAPE,dt)}function yt(Kt,jt){return Kt&&Kt.toString().replace(!jt||!jt.iri?N.PCT_ENCODED:U.PCT_ENCODED,vt)}var Bt={scheme:"http",domainHost:!0,parse:function(jt,wt){return jt.host||(jt.error=jt.error||"HTTP URIs must have a host."),jt},serialize:function(jt,wt){var Rt=String(jt.scheme).toLowerCase()==="https";return(jt.port===(Rt?443:80)||jt.port==="")&&(jt.port=void 0),jt.path||(jt.path="/"),jt}},Ht={scheme:"https",domainHost:Bt.domainHost,parse:Bt.parse,serialize:Bt.serialize};function nr(Kt){return typeof Kt.secure=="boolean"?Kt.secure:String(Kt.scheme).toLowerCase()==="wss"}var Qt={scheme:"ws",domainHost:!0,parse:function(jt,wt){var Rt=jt;return Rt.secure=nr(Rt),Rt.resourceName=(Rt.path||"/")+(Rt.query?"?"+Rt.query:""),Rt.path=void 0,Rt.query=void 0,Rt},serialize:function(jt,wt){if((jt.port===(nr(jt)?443:80)||jt.port==="")&&(jt.port=void 0),typeof jt.secure=="boolean"&&(jt.scheme=jt.secure?"wss":"ws",jt.secure=void 0),jt.resourceName){var Rt=jt.resourceName.split("?"),Tt=j(Rt,2),Dt=Tt[0],Ot=Tt[1];jt.path=Dt&&Dt!=="/"?Dt:void 0,jt.query=Ot,jt.resourceName=void 0}return jt.fragment=void 0,jt}},xr={scheme:"wss",domainHost:Qt.domainHost,parse:Qt.parse,serialize:Qt.serialize},kr={},Sr="[A-Za-z0-9\\-\\.\\_\\~\\xA0-\\u200D\\u2010-\\u2029\\u202F-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF]",$r="[0-9A-Fa-f]",Rr=S(S("%[EFef]"+$r+"%"+$r+$r+"%"+$r+$r)+"|"+S("%[89A-Fa-f]"+$r+"%"+$r+$r)+"|"+S("%"+$r+$r)),Dr="[A-Za-z0-9\\!\\$\\%\\'\\*\\+\\-\\^\\_\\`\\{\\|\\}\\~]",tn="[\\!\\$\\%\\'\\(\\)\\*\\+\\,\\-\\.0-9\\<\\>A-Z\\x5E-\\x7E]",Jr=E(tn,'[\\"\\\\]'),Pr="[\\!\\$\\'\\(\\)\\*\\+\\,\\;\\:\\@]",Wr=new RegExp(Sr,"g"),Qr=new RegExp(Rr,"g"),Fr=new RegExp(E("[^]",Dr,"[\\.]",'[\\"]',Jr),"g"),an=new RegExp(E("[^]",Sr,Pr),"g"),cn=an;function Lr(Kt){var jt=vt(Kt);return jt.match(Wr)?jt:Kt}var ln={scheme:"mailto",parse:function(jt,wt){var Rt=jt,Tt=Rt.to=Rt.path?Rt.path.split(","):[];if(Rt.path=void 0,Rt.query){for(var Dt=!1,Ot={},Vt=Rt.query.split("&"),Jt=0,lr=Vt.length;Jt<lr;++Jt){var tr=Vt[Jt].split("=");switch(tr[0]){case"to":for(var ir=tr[1].split(","),sr=0,dr=ir.length;sr<dr;++sr)Tt.push(ir[sr]);break;case"subject":Rt.subject=yt(tr[1],wt);break;case"body":Rt.body=yt(tr[1],wt);break;default:Dt=!0,Ot[yt(tr[0],wt)]=yt(tr[1],wt);break}}Dt&&(Rt.headers=Ot)}Rt.query=void 0;for(var yr=0,Er=Tt.length;yr<Er;++yr){var pr=Tt[yr].split("@");if(pr[0]=yt(pr[0]),wt.unicodeSupport)pr[1]=yt(pr[1],wt).toLowerCase();else try{pr[1]=ct.toASCII(yt(pr[1],wt).toLowerCase())}catch(_r){Rt.error=Rt.error||"Email address's domain name can not be converted to ASCII via punycode: "+_r}Tt[yr]=pr.join("@")}return Rt},serialize:function(jt,wt){var Rt=jt,Tt=I(jt.to);if(Tt){for(var Dt=0,Ot=Tt.length;Dt<Ot;++Dt){var Vt=String(Tt[Dt]),Jt=Vt.lastIndexOf("@"),lr=Vt.slice(0,Jt).replace(Qr,Lr).replace(Qr,A).replace(Fr,dt),tr=Vt.slice(Jt+1);try{tr=wt.iri?ct.toUnicode(tr):ct.toASCII(yt(tr,wt).toLowerCase())}catch(yr){Rt.error=Rt.error||"Email address's domain name can not be converted to "+(wt.iri?"Unicode":"ASCII")+" via punycode: "+yr}Tt[Dt]=lr+"@"+tr}Rt.path=Tt.join(",")}var ir=jt.headers=jt.headers||{};jt.subject&&(ir.subject=jt.subject),jt.body&&(ir.body=jt.body);var sr=[];for(var dr in ir)ir[dr]!==kr[dr]&&sr.push(dr.replace(Qr,Lr).replace(Qr,A).replace(an,dt)+"="+ir[dr].replace(Qr,Lr).replace(Qr,A).replace(cn,dt));return sr.length&&(Rt.query=sr.join("&")),Rt}},fn=/^([^\:]+)\:(.*)/,Or={scheme:"urn",parse:function(jt,wt){var Rt=jt.path&&jt.path.match(fn),Tt=jt;if(Rt){var Dt=wt.scheme||Tt.scheme||"urn",Ot=Rt[1].toLowerCase(),Vt=Rt[2],Jt=Dt+":"+(wt.nid||Ot),lr=Qe[Jt];Tt.nid=Ot,Tt.nss=Vt,Tt.path=void 0,lr&&(Tt=lr.parse(Tt,wt))}else Tt.error=Tt.error||"URN can not be parsed.";return Tt},serialize:function(jt,wt){var Rt=wt.scheme||jt.scheme||"urn",Tt=jt.nid,Dt=Rt+":"+(wt.nid||Tt),Ot=Qe[Dt];Ot&&(jt=Ot.serialize(jt,wt));var Vt=jt,Jt=jt.nss;return Vt.path=(Tt||wt.nid)+":"+Jt,Vt}},nn=/^[0-9A-Fa-f]{8}(?:\-[0-9A-Fa-f]{4}){3}\-[0-9A-Fa-f]{12}$/,rn={scheme:"urn:uuid",parse:function(jt,wt){var Rt=jt;return Rt.uuid=Rt.nss,Rt.nss=void 0,!wt.tolerant&&(!Rt.uuid||!Rt.uuid.match(nn))&&(Rt.error=Rt.error||"UUID is not valid."),Rt},serialize:function(jt,wt){var Rt=jt;return Rt.nss=(jt.uuid||"").toLowerCase(),Rt}};Qe[Bt.scheme]=Bt,Qe[Ht.scheme]=Ht,Qe[Qt.scheme]=Qt,Qe[xr.scheme]=xr,Qe[ln.scheme]=ln,Qe[Or.scheme]=Or,Qe[rn.scheme]=rn,_.SCHEMES=Qe,_.pctEncChar=dt,_.pctDecChars=vt,_.parse=Pt,_.removeDotSegments=Mt,_.serialize=Wt,_.resolveComponents=Zt,_.resolve=Yt,_.normalize=ur,_.equal=xt,_.escapeComponent=pt,_.unescapeComponent=yt,Object.defineProperty(_,"__esModule",{value:!0})})})(uri_all,uri_all.exports);var uri_allExports=uri_all.exports;Object.defineProperty(uri$1,"__esModule",{value:!0});const uri=uri_allExports;uri.code='require("ajv/dist/runtime/uri").default';uri$1.default=uri;(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.CodeGen=n.Name=n.nil=n.stringify=n.str=n._=n.KeywordCxt=void 0;var r=validate$4;Object.defineProperty(n,"KeywordCxt",{enumerable:!0,get:function(){return r.KeywordCxt}});var _=codegen;Object.defineProperty(n,"_",{enumerable:!0,get:function(){return _._}}),Object.defineProperty(n,"str",{enumerable:!0,get:function(){return _.str}}),Object.defineProperty(n,"stringify",{enumerable:!0,get:function(){return _.stringify}}),Object.defineProperty(n,"nil",{enumerable:!0,get:function(){return _.nil}}),Object.defineProperty(n,"Name",{enumerable:!0,get:function(){return _.Name}}),Object.defineProperty(n,"CodeGen",{enumerable:!0,get:function(){return _.CodeGen}});const E=validation_error,S=ref_error,C=rules,A=compile,I=codegen,B=resolve$8,O=dataType,N=util$1,U=require$$9,j=uri$1,z=(Ve,Pe)=>new RegExp(Ve,Pe);z.code="new RegExp";const Z=["removeAdditional","useDefaults","coerceTypes"],X=new Set(["validate","serialize","parse","wrapper","root","schema","keyword","pattern","formats","validate$data","func","obj","Error"]),Q={errorDataPath:"",format:"`validateFormats: false` can be used instead.",nullable:'"nullable" keyword is supported by default.',jsonPointers:"Deprecated jsPropertySyntax can be used instead.",extendRefs:"Deprecated ignoreKeywordsWithRef can be used instead.",missingRefs:"Pass empty schema with $id that should be ignored to ajv.addSchema.",processCode:"Use option `code: {process: (code, schemaEnv: object) => string}`",sourceCode:"Use option `code: {source: true}`",strictDefaults:"It is default now, see option `strict`.",strictKeywords:"It is default now, see option `strict`.",uniqueItems:'"uniqueItems" keyword is always validated.',unknownFormats:"Disable strict mode or pass `true` to `ajv.addFormat` (or `formats` option).",cache:"Map is used as cache, schema object as key.",serialize:"Map is used as cache, schema object as key.",ajvErrors:"It is default now."},se={ignoreKeywordsWithRef:"",jsPropertySyntax:"",unicode:'"minLength"/"maxLength" account for unicode characters by default.'},oe=200;function ue(Ve){var Pe,Me,tt,Ke,mt,ct,Qe,dt,vt,At,bt,ft,Et,Ye,Ct,Pt,St,$t,kt,Ft,qt,Mt,Wt,Zt,Yt;const ur=Ve.strict,xt=(Pe=Ve.code)===null||Pe===void 0?void 0:Pe.optimize,pt=xt===!0||xt===void 0?1:xt||0,yt=(tt=(Me=Ve.code)===null||Me===void 0?void 0:Me.regExp)!==null&&tt!==void 0?tt:z,Bt=(Ke=Ve.uriResolver)!==null&&Ke!==void 0?Ke:j.default;return{strictSchema:(ct=(mt=Ve.strictSchema)!==null&&mt!==void 0?mt:ur)!==null&&ct!==void 0?ct:!0,strictNumbers:(dt=(Qe=Ve.strictNumbers)!==null&&Qe!==void 0?Qe:ur)!==null&&dt!==void 0?dt:!0,strictTypes:(At=(vt=Ve.strictTypes)!==null&&vt!==void 0?vt:ur)!==null&&At!==void 0?At:"log",strictTuples:(ft=(bt=Ve.strictTuples)!==null&&bt!==void 0?bt:ur)!==null&&ft!==void 0?ft:"log",strictRequired:(Ye=(Et=Ve.strictRequired)!==null&&Et!==void 0?Et:ur)!==null&&Ye!==void 0?Ye:!1,code:Ve.code?{...Ve.code,optimize:pt,regExp:yt}:{optimize:pt,regExp:yt},loopRequired:(Ct=Ve.loopRequired)!==null&&Ct!==void 0?Ct:oe,loopEnum:(Pt=Ve.loopEnum)!==null&&Pt!==void 0?Pt:oe,meta:(St=Ve.meta)!==null&&St!==void 0?St:!0,messages:($t=Ve.messages)!==null&&$t!==void 0?$t:!0,inlineRefs:(kt=Ve.inlineRefs)!==null&&kt!==void 0?kt:!0,schemaId:(Ft=Ve.schemaId)!==null&&Ft!==void 0?Ft:"$id",addUsedSchema:(qt=Ve.addUsedSchema)!==null&&qt!==void 0?qt:!0,validateSchema:(Mt=Ve.validateSchema)!==null&&Mt!==void 0?Mt:!0,validateFormats:(Wt=Ve.validateFormats)!==null&&Wt!==void 0?Wt:!0,unicodeRegExp:(Zt=Ve.unicodeRegExp)!==null&&Zt!==void 0?Zt:!0,int32range:(Yt=Ve.int32range)!==null&&Yt!==void 0?Yt:!0,uriResolver:Bt}}class we{constructor(Pe={}){this.schemas={},this.refs={},this.formats={},this._compilations=new Set,this._loading={},this._cache=new Map,Pe=this.opts={...Pe,...ue(Pe)};const{es5:Me,lines:tt}=this.opts.code;this.scope=new I.ValueScope({scope:{},prefixes:X,es5:Me,lines:tt}),this.logger=Ee(Pe.logger);const Ke=Pe.validateFormats;Pe.validateFormats=!1,this.RULES=(0,C.getRules)(),Te.call(this,Q,Pe,"NOT SUPPORTED"),Te.call(this,se,Pe,"DEPRECATED","warn"),this._metaOpts=ht.call(this),Pe.formats&&Ne.call(this),this._addVocabularies(),this._addDefaultMetaSchema(),Pe.keywords&&Fe.call(this,Pe.keywords),typeof Pe.meta=="object"&&this.addMetaSchema(Pe.meta),Re.call(this),Pe.validateFormats=Ke}_addVocabularies(){this.addKeyword("$async")}_addDefaultMetaSchema(){const{$data:Pe,meta:Me,schemaId:tt}=this.opts;let Ke=U;tt==="id"&&(Ke={...U},Ke.id=Ke.$id,delete Ke.$id),Me&&Pe&&this.addMetaSchema(Ke,Ke[tt],!1)}defaultMeta(){const{meta:Pe,schemaId:Me}=this.opts;return this.opts.defaultMeta=typeof Pe=="object"?Pe[Me]||Pe:void 0}validate(Pe,Me){let tt;if(typeof Pe=="string"){if(tt=this.getSchema(Pe),!tt)throw new Error(`no schema with key or ref "${Pe}"`)}else tt=this.compile(Pe);const Ke=tt(Me);return"$async"in tt||(this.errors=tt.errors),Ke}compile(Pe,Me){const tt=this._addSchema(Pe,Me);return tt.validate||this._compileSchemaEnv(tt)}compileAsync(Pe,Me){if(typeof this.opts.loadSchema!="function")throw new Error("options.loadSchema should be a function");const{loadSchema:tt}=this.opts;return Ke.call(this,Pe,Me);async function Ke(At,bt){await mt.call(this,At.$schema);const ft=this._addSchema(At,bt);return ft.validate||ct.call(this,ft)}async function mt(At){At&&!this.getSchema(At)&&await Ke.call(this,{$ref:At},!0)}async function ct(At){try{return this._compileSchemaEnv(At)}catch(bt){if(!(bt instanceof S.default))throw bt;return Qe.call(this,bt),await dt.call(this,bt.missingSchema),ct.call(this,At)}}function Qe({missingSchema:At,missingRef:bt}){if(this.refs[At])throw new Error(`AnySchema ${At} is loaded but ${bt} cannot be resolved`)}async function dt(At){const bt=await vt.call(this,At);this.refs[At]||await mt.call(this,bt.$schema),this.refs[At]||this.addSchema(bt,At,Me)}async function vt(At){const bt=this._loading[At];if(bt)return bt;try{return await(this._loading[At]=tt(At))}finally{delete this._loading[At]}}}addSchema(Pe,Me,tt,Ke=this.opts.validateSchema){if(Array.isArray(Pe)){for(const ct of Pe)this.addSchema(ct,void 0,tt,Ke);return this}let mt;if(typeof Pe=="object"){const{schemaId:ct}=this.opts;if(mt=Pe[ct],mt!==void 0&&typeof mt!="string")throw new Error(`schema ${ct} must be string`)}return Me=(0,B.normalizeId)(Me||mt),this._checkUnique(Me),this.schemas[Me]=this._addSchema(Pe,tt,Me,Ke,!0),this}addMetaSchema(Pe,Me,tt=this.opts.validateSchema){return this.addSchema(Pe,Me,!0,tt),this}validateSchema(Pe,Me){if(typeof Pe=="boolean")return!0;let tt;if(tt=Pe.$schema,tt!==void 0&&typeof tt!="string")throw new Error("$schema must be a string");if(tt=tt||this.opts.defaultMeta||this.defaultMeta(),!tt)return this.logger.warn("meta-schema not available"),this.errors=null,!0;const Ke=this.validate(tt,Pe);if(!Ke&&Me){const mt="schema is invalid: "+this.errorsText();if(this.opts.validateSchema==="log")this.logger.error(mt);else throw new Error(mt)}return Ke}getSchema(Pe){let Me;for(;typeof(Me=xe.call(this,Pe))=="string";)Pe=Me;if(Me===void 0){const{schemaId:tt}=this.opts,Ke=new A.SchemaEnv({schema:{},schemaId:tt});if(Me=A.resolveSchema.call(this,Ke,Pe),!Me)return;this.refs[Pe]=Me}return Me.validate||this._compileSchemaEnv(Me)}removeSchema(Pe){if(Pe instanceof RegExp)return this._removeAllSchemas(this.schemas,Pe),this._removeAllSchemas(this.refs,Pe),this;switch(typeof Pe){case"undefined":return this._removeAllSchemas(this.schemas),this._removeAllSchemas(this.refs),this._cache.clear(),this;case"string":{const Me=xe.call(this,Pe);return typeof Me=="object"&&this._cache.delete(Me.schema),delete this.schemas[Pe],delete this.refs[Pe],this}case"object":{const Me=Pe;this._cache.delete(Me);let tt=Pe[this.opts.schemaId];return tt&&(tt=(0,B.normalizeId)(tt),delete this.schemas[tt],delete this.refs[tt]),this}default:throw new Error("ajv.removeSchema: invalid parameter")}}addVocabulary(Pe){for(const Me of Pe)this.addKeyword(Me);return this}addKeyword(Pe,Me){let tt;if(typeof Pe=="string")tt=Pe,typeof Me=="object"&&(this.logger.warn("these parameters are deprecated, see docs for addKeyword"),Me.keyword=tt);else if(typeof Pe=="object"&&Me===void 0){if(Me=Pe,tt=Me.keyword,Array.isArray(tt)&&!tt.length)throw new Error("addKeywords: keyword must be string or non-empty array")}else throw new Error("invalid addKeywords parameters");if(_e.call(this,tt,Me),!Me)return(0,N.eachItem)(tt,mt=>Ie.call(this,mt)),this;Be.call(this,Me);const Ke={...Me,type:(0,O.getJSONTypes)(Me.type),schemaType:(0,O.getJSONTypes)(Me.schemaType)};return(0,N.eachItem)(tt,Ke.type.length===0?mt=>Ie.call(this,mt,Ke):mt=>Ke.type.forEach(ct=>Ie.call(this,mt,Ke,ct))),this}getKeyword(Pe){const Me=this.RULES.all[Pe];return typeof Me=="object"?Me.definition:!!Me}removeKeyword(Pe){const{RULES:Me}=this;delete Me.keywords[Pe],delete Me.all[Pe];for(const tt of Me.rules){const Ke=tt.rules.findIndex(mt=>mt.keyword===Pe);Ke>=0&&tt.rules.splice(Ke,1)}return this}addFormat(Pe,Me){return typeof Me=="string"&&(Me=new RegExp(Me)),this.formats[Pe]=Me,this}errorsText(Pe=this.errors,{separator:Me=", ",dataVar:tt="data"}={}){return!Pe||Pe.length===0?"No errors":Pe.map(Ke=>`${tt}${Ke.instancePath} ${Ke.message}`).reduce((Ke,mt)=>Ke+Me+mt)}$dataMetaSchema(Pe,Me){const tt=this.RULES.all;Pe=JSON.parse(JSON.stringify(Pe));for(const Ke of Me){const mt=Ke.split("/").slice(1);let ct=Pe;for(const Qe of mt)ct=ct[Qe];for(const Qe in tt){const dt=tt[Qe];if(typeof dt!="object")continue;const{$data:vt}=dt.definition,At=ct[Qe];vt&&At&&(ct[Qe]=je(At))}}return Pe}_removeAllSchemas(Pe,Me){for(const tt in Pe){const Ke=Pe[tt];(!Me||Me.test(tt))&&(typeof Ke=="string"?delete Pe[tt]:Ke&&!Ke.meta&&(this._cache.delete(Ke.schema),delete Pe[tt]))}}_addSchema(Pe,Me,tt,Ke=this.opts.validateSchema,mt=this.opts.addUsedSchema){let ct;const{schemaId:Qe}=this.opts;if(typeof Pe=="object")ct=Pe[Qe];else{if(this.opts.jtd)throw new Error("schema must be object");if(typeof Pe!="boolean")throw new Error("schema must be object or boolean")}let dt=this._cache.get(Pe);if(dt!==void 0)return dt;tt=(0,B.normalizeId)(ct||tt);const vt=B.getSchemaRefs.call(this,Pe,tt);return dt=new A.SchemaEnv({schema:Pe,schemaId:Qe,meta:Me,baseId:tt,localRefs:vt}),this._cache.set(dt.schema,dt),mt&&!tt.startsWith("#")&&(tt&&this._checkUnique(tt),this.refs[tt]=dt),Ke&&this.validateSchema(Pe,!0),dt}_checkUnique(Pe){if(this.schemas[Pe]||this.refs[Pe])throw new Error(`schema with key or id "${Pe}" already exists`)}_compileSchemaEnv(Pe){if(Pe.meta?this._compileMetaSchema(Pe):A.compileSchema.call(this,Pe),!Pe.validate)throw new Error("ajv implementation error");return Pe.validate}_compileMetaSchema(Pe){const Me=this.opts;this.opts=this._metaOpts;try{A.compileSchema.call(this,Pe)}finally{this.opts=Me}}}n.default=we,we.ValidationError=E.default,we.MissingRefError=S.default;function Te(Ve,Pe,Me,tt="error"){for(const Ke in Ve){const mt=Ke;mt in Pe&&this.logger[tt](`${Me}: option ${Ke}. ${Ve[mt]}`)}}function xe(Ve){return Ve=(0,B.normalizeId)(Ve),this.schemas[Ve]||this.refs[Ve]}function Re(){const Ve=this.opts.schemas;if(Ve)if(Array.isArray(Ve))this.addSchema(Ve);else for(const Pe in Ve)this.addSchema(Ve[Pe],Pe)}function Ne(){for(const Ve in this.opts.formats){const Pe=this.opts.formats[Ve];Pe&&this.addFormat(Ve,Pe)}}function Fe(Ve){if(Array.isArray(Ve)){this.addVocabulary(Ve);return}this.logger.warn("keywords option as map is deprecated, pass array");for(const Pe in Ve){const Me=Ve[Pe];Me.keyword||(Me.keyword=Pe),this.addKeyword(Me)}}function ht(){const Ve={...this.opts};for(const Pe of Z)delete Ve[Pe];return Ve}const nt={log(){},warn(){},error(){}};function Ee(Ve){if(Ve===!1)return nt;if(Ve===void 0)return console;if(Ve.log&&Ve.warn&&Ve.error)return Ve;throw new Error("logger must implement log, warn and error methods")}const Ce=/^[a-z_$][a-z0-9_$:-]*$/i;function _e(Ve,Pe){const{RULES:Me}=this;if((0,N.eachItem)(Ve,tt=>{if(Me.keywords[tt])throw new Error(`Keyword ${tt} is already defined`);if(!Ce.test(tt))throw new Error(`Keyword ${tt} has invalid name`)}),!!Pe&&Pe.$data&&!("code"in Pe||"validate"in Pe))throw new Error('$data keyword must have "code" or "validate" function')}function Ie(Ve,Pe,Me){var tt;const Ke=Pe?.post;if(Me&&Ke)throw new Error('keyword with "post" flag cannot have "type"');const{RULES:mt}=this;let ct=Ke?mt.post:mt.rules.find(({type:dt})=>dt===Me);if(ct||(ct={type:Me,rules:[]},mt.rules.push(ct)),mt.keywords[Ve]=!0,!Pe)return;const Qe={keyword:Ve,definition:{...Pe,type:(0,O.getJSONTypes)(Pe.type),schemaType:(0,O.getJSONTypes)(Pe.schemaType)}};Pe.before?He.call(this,ct,Qe,Pe.before):ct.rules.push(Qe),mt.all[Ve]=Qe,(tt=Pe.implements)===null||tt===void 0||tt.forEach(dt=>this.addKeyword(dt))}function He(Ve,Pe,Me){const tt=Ve.rules.findIndex(Ke=>Ke.keyword===Me);tt>=0?Ve.rules.splice(tt,0,Pe):(Ve.rules.push(Pe),this.logger.warn(`rule ${Me} is not defined`))}function Be(Ve){let{metaSchema:Pe}=Ve;Pe!==void 0&&(Ve.$data&&this.opts.$data&&(Pe=je(Pe)),Ve.validateSchema=this.compile(Pe,!0))}const Ge={$ref:"https://raw.githubusercontent.com/ajv-validator/ajv/master/lib/refs/data.json#"};function je(Ve){return{anyOf:[Ve,Ge]}}})(core$3);var draft7={},core$2={},id={};Object.defineProperty(id,"__esModule",{value:!0});const def$s={keyword:"id",code(){throw new Error('NOT SUPPORTED: keyword "id", use "$id" for schema ID')}};id.default=def$s;var ref={};Object.defineProperty(ref,"__esModule",{value:!0});ref.callRef=ref.getValidate=void 0;const ref_error_1=ref_error,code_1$8=code$3,codegen_1$l=codegen,names_1$1=names$5,compile_1$1=compile,util_1$j=util$1,def$r={keyword:"$ref",schemaType:"string",code(n){const{gen:r,schema:_,it:E}=n,{baseId:S,schemaEnv:C,validateName:A,opts:I,self:B}=E,{root:O}=C;if((_==="#"||_==="#/")&&S===O.baseId)return U();const N=compile_1$1.resolveRef.call(B,O,S,_);if(N===void 0)throw new ref_error_1.default(E.opts.uriResolver,S,_);if(N instanceof compile_1$1.SchemaEnv)return j(N);return z(N);function U(){if(C===O)return callRef(n,A,C,C.$async);const Z=r.scopeValue("root",{ref:O});return callRef(n,(0,codegen_1$l._)`${Z}.validate`,O,O.$async)}function j(Z){const X=getValidate(n,Z);callRef(n,X,Z,Z.$async)}function z(Z){const X=r.scopeValue("schema",I.code.source===!0?{ref:Z,code:(0,codegen_1$l.stringify)(Z)}:{ref:Z}),Q=r.name("valid"),se=n.subschema({schema:Z,dataTypes:[],schemaPath:codegen_1$l.nil,topSchemaRef:X,errSchemaPath:_},Q);n.mergeEvaluated(se),n.ok(Q)}}};function getValidate(n,r){const{gen:_}=n;return r.validate?_.scopeValue("validate",{ref:r.validate}):(0,codegen_1$l._)`${_.scopeValue("wrapper",{ref:r})}.validate`}ref.getValidate=getValidate;function callRef(n,r,_,E){const{gen:S,it:C}=n,{allErrors:A,schemaEnv:I,opts:B}=C,O=B.passContext?names_1$1.default.this:codegen_1$l.nil;E?N():U();function N(){if(!I.$async)throw new Error("async schema referenced by sync schema");const Z=S.let("valid");S.try(()=>{S.code((0,codegen_1$l._)`await ${(0,code_1$8.callValidateCode)(n,r,O)}`),z(r),A||S.assign(Z,!0)},X=>{S.if((0,codegen_1$l._)`!(${X} instanceof ${C.ValidationError})`,()=>S.throw(X)),j(X),A||S.assign(Z,!1)}),n.ok(Z)}function U(){n.result((0,code_1$8.callValidateCode)(n,r,O),()=>z(r),()=>j(r))}function j(Z){const X=(0,codegen_1$l._)`${Z}.errors`;S.assign(names_1$1.default.vErrors,(0,codegen_1$l._)`${names_1$1.default.vErrors} === null ? ${X} : ${names_1$1.default.vErrors}.concat(${X})`),S.assign(names_1$1.default.errors,(0,codegen_1$l._)`${names_1$1.default.vErrors}.length`)}function z(Z){var X;if(!C.opts.unevaluated)return;const Q=(X=_?.validate)===null||X===void 0?void 0:X.evaluated;if(C.props!==!0)if(Q&&!Q.dynamicProps)Q.props!==void 0&&(C.props=util_1$j.mergeEvaluated.props(S,Q.props,C.props));else{const se=S.var("props",(0,codegen_1$l._)`${Z}.evaluated.props`);C.props=util_1$j.mergeEvaluated.props(S,se,C.props,codegen_1$l.Name)}if(C.items!==!0)if(Q&&!Q.dynamicItems)Q.items!==void 0&&(C.items=util_1$j.mergeEvaluated.items(S,Q.items,C.items));else{const se=S.var("items",(0,codegen_1$l._)`${Z}.evaluated.items`);C.items=util_1$j.mergeEvaluated.items(S,se,C.items,codegen_1$l.Name)}}}ref.callRef=callRef;ref.default=def$r;Object.defineProperty(core$2,"__esModule",{value:!0});const id_1=id,ref_1=ref,core$1=["$schema","$id","$defs","$vocabulary",{keyword:"$comment"},"definitions",id_1.default,ref_1.default];core$2.default=core$1;var validation$1={},limitNumber={};Object.defineProperty(limitNumber,"__esModule",{value:!0});const codegen_1$k=codegen,ops=codegen_1$k.operators,KWDs={maximum:{okStr:"<=",ok:ops.LTE,fail:ops.GT},minimum:{okStr:">=",ok:ops.GTE,fail:ops.LT},exclusiveMaximum:{okStr:"<",ok:ops.LT,fail:ops.GTE},exclusiveMinimum:{okStr:">",ok:ops.GT,fail:ops.LTE}},error$i={message:({keyword:n,schemaCode:r})=>(0,codegen_1$k.str)`must be ${KWDs[n].okStr} ${r}`,params:({keyword:n,schemaCode:r})=>(0,codegen_1$k._)`{comparison: ${KWDs[n].okStr}, limit: ${r}}`},def$q={keyword:Object.keys(KWDs),type:"number",schemaType:"number",$data:!0,error:error$i,code(n){const{keyword:r,data:_,schemaCode:E}=n;n.fail$data((0,codegen_1$k._)`${_} ${KWDs[r].fail} ${E} || isNaN(${_})`)}};limitNumber.default=def$q;var multipleOf={};Object.defineProperty(multipleOf,"__esModule",{value:!0});const codegen_1$j=codegen,error$h={message:({schemaCode:n})=>(0,codegen_1$j.str)`must be multiple of ${n}`,params:({schemaCode:n})=>(0,codegen_1$j._)`{multipleOf: ${n}}`},def$p={keyword:"multipleOf",type:"number",schemaType:"number",$data:!0,error:error$h,code(n){const{gen:r,data:_,schemaCode:E,it:S}=n,C=S.opts.multipleOfPrecision,A=r.let("res"),I=C?(0,codegen_1$j._)`Math.abs(Math.round(${A}) - ${A}) > 1e-${C}`:(0,codegen_1$j._)`${A} !== parseInt(${A})`;n.fail$data((0,codegen_1$j._)`(${E} === 0 || (${A} = ${_}/${E}, ${I}))`)}};multipleOf.default=def$p;var limitLength={},ucs2length$1={};Object.defineProperty(ucs2length$1,"__esModule",{value:!0});function ucs2length(n){const r=n.length;let _=0,E=0,S;for(;E<r;)_++,S=n.charCodeAt(E++),S>=55296&&S<=56319&&E<r&&(S=n.charCodeAt(E),(S&64512)===56320&&E++);return _}ucs2length$1.default=ucs2length;ucs2length.code='require("ajv/dist/runtime/ucs2length").default';Object.defineProperty(limitLength,"__esModule",{value:!0});const codegen_1$i=codegen,util_1$i=util$1,ucs2length_1=ucs2length$1,error$g={message({keyword:n,schemaCode:r}){const _=n==="maxLength"?"more":"fewer";return(0,codegen_1$i.str)`must NOT have ${_} than ${r} characters`},params:({schemaCode:n})=>(0,codegen_1$i._)`{limit: ${n}}`},def$o={keyword:["maxLength","minLength"],type:"string",schemaType:"number",$data:!0,error:error$g,code(n){const{keyword:r,data:_,schemaCode:E,it:S}=n,C=r==="maxLength"?codegen_1$i.operators.GT:codegen_1$i.operators.LT,A=S.opts.unicode===!1?(0,codegen_1$i._)`${_}.length`:(0,codegen_1$i._)`${(0,util_1$i.useFunc)(n.gen,ucs2length_1.default)}(${_})`;n.fail$data((0,codegen_1$i._)`${A} ${C} ${E}`)}};limitLength.default=def$o;var pattern={};Object.defineProperty(pattern,"__esModule",{value:!0});const code_1$7=code$3,codegen_1$h=codegen,error$f={message:({schemaCode:n})=>(0,codegen_1$h.str)`must match pattern "${n}"`,params:({schemaCode:n})=>(0,codegen_1$h._)`{pattern: ${n}}`},def$n={keyword:"pattern",type:"string",schemaType:"string",$data:!0,error:error$f,code(n){const{data:r,$data:_,schema:E,schemaCode:S,it:C}=n,A=C.opts.unicodeRegExp?"u":"",I=_?(0,codegen_1$h._)`(new RegExp(${S}, ${A}))`:(0,code_1$7.usePattern)(n,E);n.fail$data((0,codegen_1$h._)`!${I}.test(${r})`)}};pattern.default=def$n;var limitProperties={};Object.defineProperty(limitProperties,"__esModule",{value:!0});const codegen_1$g=codegen,error$e={message({keyword:n,schemaCode:r}){const _=n==="maxProperties"?"more":"fewer";return(0,codegen_1$g.str)`must NOT have ${_} than ${r} properties`},params:({schemaCode:n})=>(0,codegen_1$g._)`{limit: ${n}}`},def$m={keyword:["maxProperties","minProperties"],type:"object",schemaType:"number",$data:!0,error:error$e,code(n){const{keyword:r,data:_,schemaCode:E}=n,S=r==="maxProperties"?codegen_1$g.operators.GT:codegen_1$g.operators.LT;n.fail$data((0,codegen_1$g._)`Object.keys(${_}).length ${S} ${E}`)}};limitProperties.default=def$m;var required={};Object.defineProperty(required,"__esModule",{value:!0});const code_1$6=code$3,codegen_1$f=codegen,util_1$h=util$1,error$d={message:({params:{missingProperty:n}})=>(0,codegen_1$f.str)`must have required property '${n}'`,params:({params:{missingProperty:n}})=>(0,codegen_1$f._)`{missingProperty: ${n}}`},def$l={keyword:"required",type:"object",schemaType:"array",$data:!0,error:error$d,code(n){const{gen:r,schema:_,schemaCode:E,data:S,$data:C,it:A}=n,{opts:I}=A;if(!C&&_.length===0)return;const B=_.length>=I.loopRequired;if(A.allErrors?O():N(),I.strictRequired){const z=n.parentSchema.properties,{definedProperties:Z}=n.it;for(const X of _)if(z?.[X]===void 0&&!Z.has(X)){const Q=A.schemaEnv.baseId+A.errSchemaPath,se=`required property "${X}" is not defined at "${Q}" (strictRequired)`;(0,util_1$h.checkStrictMode)(A,se,A.opts.strictRequired)}}function O(){if(B||C)n.block$data(codegen_1$f.nil,U);else for(const z of _)(0,code_1$6.checkReportMissingProp)(n,z)}function N(){const z=r.let("missing");if(B||C){const Z=r.let("valid",!0);n.block$data(Z,()=>j(z,Z)),n.ok(Z)}else r.if((0,code_1$6.checkMissingProp)(n,_,z)),(0,code_1$6.reportMissingProp)(n,z),r.else()}function U(){r.forOf("prop",E,z=>{n.setParams({missingProperty:z}),r.if((0,code_1$6.noPropertyInData)(r,S,z,I.ownProperties),()=>n.error())})}function j(z,Z){n.setParams({missingProperty:z}),r.forOf(z,E,()=>{r.assign(Z,(0,code_1$6.propertyInData)(r,S,z,I.ownProperties)),r.if((0,codegen_1$f.not)(Z),()=>{n.error(),r.break()})},codegen_1$f.nil)}}};required.default=def$l;var limitItems={};Object.defineProperty(limitItems,"__esModule",{value:!0});const codegen_1$e=codegen,error$c={message({keyword:n,schemaCode:r}){const _=n==="maxItems"?"more":"fewer";return(0,codegen_1$e.str)`must NOT have ${_} than ${r} items`},params:({schemaCode:n})=>(0,codegen_1$e._)`{limit: ${n}}`},def$k={keyword:["maxItems","minItems"],type:"array",schemaType:"number",$data:!0,error:error$c,code(n){const{keyword:r,data:_,schemaCode:E}=n,S=r==="maxItems"?codegen_1$e.operators.GT:codegen_1$e.operators.LT;n.fail$data((0,codegen_1$e._)`${_}.length ${S} ${E}`)}};limitItems.default=def$k;var uniqueItems={},equal$1={};Object.defineProperty(equal$1,"__esModule",{value:!0});const equal=fastDeepEqual;equal.code='require("ajv/dist/runtime/equal").default';equal$1.default=equal;Object.defineProperty(uniqueItems,"__esModule",{value:!0});const dataType_1=dataType,codegen_1$d=codegen,util_1$g=util$1,equal_1$2=equal$1,error$b={message:({params:{i:n,j:r}})=>(0,codegen_1$d.str)`must NOT have duplicate items (items ## ${r} and ${n} are identical)`,params:({params:{i:n,j:r}})=>(0,codegen_1$d._)`{i: ${n}, j: ${r}}`},def$j={keyword:"uniqueItems",type:"array",schemaType:"boolean",$data:!0,error:error$b,code(n){const{gen:r,data:_,$data:E,schema:S,parentSchema:C,schemaCode:A,it:I}=n;if(!E&&!S)return;const B=r.let("valid"),O=C.items?(0,dataType_1.getSchemaTypes)(C.items):[];n.block$data(B,N,(0,codegen_1$d._)`${A} === false`),n.ok(B);function N(){const Z=r.let("i",(0,codegen_1$d._)`${_}.length`),X=r.let("j");n.setParams({i:Z,j:X}),r.assign(B,!0),r.if((0,codegen_1$d._)`${Z} > 1`,()=>(U()?j:z)(Z,X))}function U(){return O.length>0&&!O.some(Z=>Z==="object"||Z==="array")}function j(Z,X){const Q=r.name("item"),se=(0,dataType_1.checkDataTypes)(O,Q,I.opts.strictNumbers,dataType_1.DataType.Wrong),oe=r.const("indices",(0,codegen_1$d._)`{}`);r.for((0,codegen_1$d._)`;${Z}--;`,()=>{r.let(Q,(0,codegen_1$d._)`${_}[${Z}]`),r.if(se,(0,codegen_1$d._)`continue`),O.length>1&&r.if((0,codegen_1$d._)`typeof ${Q} == "string"`,(0,codegen_1$d._)`${Q} += "_"`),r.if((0,codegen_1$d._)`typeof ${oe}[${Q}] == "number"`,()=>{r.assign(X,(0,codegen_1$d._)`${oe}[${Q}]`),n.error(),r.assign(B,!1).break()}).code((0,codegen_1$d._)`${oe}[${Q}] = ${Z}`)})}function z(Z,X){const Q=(0,util_1$g.useFunc)(r,equal_1$2.default),se=r.name("outer");r.label(se).for((0,codegen_1$d._)`;${Z}--;`,()=>r.for((0,codegen_1$d._)`${X} = ${Z}; ${X}--;`,()=>r.if((0,codegen_1$d._)`${Q}(${_}[${Z}], ${_}[${X}])`,()=>{n.error(),r.assign(B,!1).break(se)})))}}};uniqueItems.default=def$j;var _const={};Object.defineProperty(_const,"__esModule",{value:!0});const codegen_1$c=codegen,util_1$f=util$1,equal_1$1=equal$1,error$a={message:"must be equal to constant",params:({schemaCode:n})=>(0,codegen_1$c._)`{allowedValue: ${n}}`},def$i={keyword:"const",$data:!0,error:error$a,code(n){const{gen:r,data:_,$data:E,schemaCode:S,schema:C}=n;E||C&&typeof C=="object"?n.fail$data((0,codegen_1$c._)`!${(0,util_1$f.useFunc)(r,equal_1$1.default)}(${_}, ${S})`):n.fail((0,codegen_1$c._)`${C} !== ${_}`)}};_const.default=def$i;var _enum={};Object.defineProperty(_enum,"__esModule",{value:!0});const codegen_1$b=codegen,util_1$e=util$1,equal_1=equal$1,error$9={message:"must be equal to one of the allowed values",params:({schemaCode:n})=>(0,codegen_1$b._)`{allowedValues: ${n}}`},def$h={keyword:"enum",schemaType:"array",$data:!0,error:error$9,code(n){const{gen:r,data:_,$data:E,schema:S,schemaCode:C,it:A}=n;if(!E&&S.length===0)throw new Error("enum must have non-empty array");const I=S.length>=A.opts.loopEnum;let B;const O=()=>B??(B=(0,util_1$e.useFunc)(r,equal_1.default));let N;if(I||E)N=r.let("valid"),n.block$data(N,U);else{if(!Array.isArray(S))throw new Error("ajv implementation error");const z=r.const("vSchema",C);N=(0,codegen_1$b.or)(...S.map((Z,X)=>j(z,X)))}n.pass(N);function U(){r.assign(N,!1),r.forOf("v",C,z=>r.if((0,codegen_1$b._)`${O()}(${_}, ${z})`,()=>r.assign(N,!0).break()))}function j(z,Z){const X=S[Z];return typeof X=="object"&&X!==null?(0,codegen_1$b._)`${O()}(${_}, ${z}[${Z}])`:(0,codegen_1$b._)`${_} === ${X}`}}};_enum.default=def$h;Object.defineProperty(validation$1,"__esModule",{value:!0});const limitNumber_1=limitNumber,multipleOf_1=multipleOf,limitLength_1=limitLength,pattern_1=pattern,limitProperties_1=limitProperties,required_1=required,limitItems_1=limitItems,uniqueItems_1=uniqueItems,const_1=_const,enum_1=_enum,validation=[limitNumber_1.default,multipleOf_1.default,limitLength_1.default,pattern_1.default,limitProperties_1.default,required_1.default,limitItems_1.default,uniqueItems_1.default,{keyword:"type",schemaType:["string","array"]},{keyword:"nullable",schemaType:"boolean"},const_1.default,enum_1.default];validation$1.default=validation;var applicator={},additionalItems={};Object.defineProperty(additionalItems,"__esModule",{value:!0});additionalItems.validateAdditionalItems=void 0;const codegen_1$a=codegen,util_1$d=util$1,error$8={message:({params:{len:n}})=>(0,codegen_1$a.str)`must NOT have more than ${n} items`,params:({params:{len:n}})=>(0,codegen_1$a._)`{limit: ${n}}`},def$g={keyword:"additionalItems",type:"array",schemaType:["boolean","object"],before:"uniqueItems",error:error$8,code(n){const{parentSchema:r,it:_}=n,{items:E}=r;if(!Array.isArray(E)){(0,util_1$d.checkStrictMode)(_,'"additionalItems" is ignored when "items" is not an array of schemas');return}validateAdditionalItems(n,E)}};function validateAdditionalItems(n,r){const{gen:_,schema:E,data:S,keyword:C,it:A}=n;A.items=!0;const I=_.const("len",(0,codegen_1$a._)`${S}.length`);if(E===!1)n.setParams({len:r.length}),n.pass((0,codegen_1$a._)`${I} <= ${r.length}`);else if(typeof E=="object"&&!(0,util_1$d.alwaysValidSchema)(A,E)){const O=_.var("valid",(0,codegen_1$a._)`${I} <= ${r.length}`);_.if((0,codegen_1$a.not)(O),()=>B(O)),n.ok(O)}function B(O){_.forRange("i",r.length,I,N=>{n.subschema({keyword:C,dataProp:N,dataPropType:util_1$d.Type.Num},O),A.allErrors||_.if((0,codegen_1$a.not)(O),()=>_.break())})}}additionalItems.validateAdditionalItems=validateAdditionalItems;additionalItems.default=def$g;var prefixItems={},items={};Object.defineProperty(items,"__esModule",{value:!0});items.validateTuple=void 0;const codegen_1$9=codegen,util_1$c=util$1,code_1$5=code$3,def$f={keyword:"items",type:"array",schemaType:["object","array","boolean"],before:"uniqueItems",code(n){const{schema:r,it:_}=n;if(Array.isArray(r))return validateTuple(n,"additionalItems",r);_.items=!0,!(0,util_1$c.alwaysValidSchema)(_,r)&&n.ok((0,code_1$5.validateArray)(n))}};function validateTuple(n,r,_=n.schema){const{gen:E,parentSchema:S,data:C,keyword:A,it:I}=n;N(S),I.opts.unevaluated&&_.length&&I.items!==!0&&(I.items=util_1$c.mergeEvaluated.items(E,_.length,I.items));const B=E.name("valid"),O=E.const("len",(0,codegen_1$9._)`${C}.length`);_.forEach((U,j)=>{(0,util_1$c.alwaysValidSchema)(I,U)||(E.if((0,codegen_1$9._)`${O} > ${j}`,()=>n.subschema({keyword:A,schemaProp:j,dataProp:j},B)),n.ok(B))});function N(U){const{opts:j,errSchemaPath:z}=I,Z=_.length,X=Z===U.minItems&&(Z===U.maxItems||U[r]===!1);if(j.strictTuples&&!X){const Q=`"${A}" is ${Z}-tuple, but minItems or maxItems/${r} are not specified or different at path "${z}"`;(0,util_1$c.checkStrictMode)(I,Q,j.strictTuples)}}}items.validateTuple=validateTuple;items.default=def$f;Object.defineProperty(prefixItems,"__esModule",{value:!0});const items_1$1=items,def$e={keyword:"prefixItems",type:"array",schemaType:["array"],before:"uniqueItems",code:n=>(0,items_1$1.validateTuple)(n,"items")};prefixItems.default=def$e;var items2020={};Object.defineProperty(items2020,"__esModule",{value:!0});const codegen_1$8=codegen,util_1$b=util$1,code_1$4=code$3,additionalItems_1$1=additionalItems,error$7={message:({params:{len:n}})=>(0,codegen_1$8.str)`must NOT have more than ${n} items`,params:({params:{len:n}})=>(0,codegen_1$8._)`{limit: ${n}}`},def$d={keyword:"items",type:"array",schemaType:["object","boolean"],before:"uniqueItems",error:error$7,code(n){const{schema:r,parentSchema:_,it:E}=n,{prefixItems:S}=_;E.items=!0,!(0,util_1$b.alwaysValidSchema)(E,r)&&(S?(0,additionalItems_1$1.validateAdditionalItems)(n,S):n.ok((0,code_1$4.validateArray)(n)))}};items2020.default=def$d;var contains={};Object.defineProperty(contains,"__esModule",{value:!0});const codegen_1$7=codegen,util_1$a=util$1,error$6={message:({params:{min:n,max:r}})=>r===void 0?(0,codegen_1$7.str)`must contain at least ${n} valid item(s)`:(0,codegen_1$7.str)`must contain at least ${n} and no more than ${r} valid item(s)`,params:({params:{min:n,max:r}})=>r===void 0?(0,codegen_1$7._)`{minContains: ${n}}`:(0,codegen_1$7._)`{minContains: ${n}, maxContains: ${r}}`},def$c={keyword:"contains",type:"array",schemaType:["object","boolean"],before:"uniqueItems",trackErrors:!0,error:error$6,code(n){const{gen:r,schema:_,parentSchema:E,data:S,it:C}=n;let A,I;const{minContains:B,maxContains:O}=E;C.opts.next?(A=B===void 0?1:B,I=O):A=1;const N=r.const("len",(0,codegen_1$7._)`${S}.length`);if(n.setParams({min:A,max:I}),I===void 0&&A===0){(0,util_1$a.checkStrictMode)(C,'"minContains" == 0 without "maxContains": "contains" keyword ignored');return}if(I!==void 0&&A>I){(0,util_1$a.checkStrictMode)(C,'"minContains" > "maxContains" is always invalid'),n.fail();return}if((0,util_1$a.alwaysValidSchema)(C,_)){let X=(0,codegen_1$7._)`${N} >= ${A}`;I!==void 0&&(X=(0,codegen_1$7._)`${X} && ${N} <= ${I}`),n.pass(X);return}C.items=!0;const U=r.name("valid");I===void 0&&A===1?z(U,()=>r.if(U,()=>r.break())):A===0?(r.let(U,!0),I!==void 0&&r.if((0,codegen_1$7._)`${S}.length > 0`,j)):(r.let(U,!1),j()),n.result(U,()=>n.reset());function j(){const X=r.name("_valid"),Q=r.let("count",0);z(X,()=>r.if(X,()=>Z(Q)))}function z(X,Q){r.forRange("i",0,N,se=>{n.subschema({keyword:"contains",dataProp:se,dataPropType:util_1$a.Type.Num,compositeRule:!0},X),Q()})}function Z(X){r.code((0,codegen_1$7._)`${X}++`),I===void 0?r.if((0,codegen_1$7._)`${X} >= ${A}`,()=>r.assign(U,!0).break()):(r.if((0,codegen_1$7._)`${X} > ${I}`,()=>r.assign(U,!1).break()),A===1?r.assign(U,!0):r.if((0,codegen_1$7._)`${X} >= ${A}`,()=>r.assign(U,!0)))}}};contains.default=def$c;var dependencies={};(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.validateSchemaDeps=n.validatePropertyDeps=n.error=void 0;const r=codegen,_=util$1,E=code$3;n.error={message:({params:{property:B,depsCount:O,deps:N}})=>{const U=O===1?"property":"properties";return(0,r.str)`must have ${U} ${N} when property ${B} is present`},params:({params:{property:B,depsCount:O,deps:N,missingProperty:U}})=>(0,r._)`{property: ${B},
    missingProperty: ${U},
    depsCount: ${O},
    deps: ${N}}`};const S={keyword:"dependencies",type:"object",schemaType:"object",error:n.error,code(B){const[O,N]=C(B);A(B,O),I(B,N)}};function C({schema:B}){const O={},N={};for(const U in B){if(U==="__proto__")continue;const j=Array.isArray(B[U])?O:N;j[U]=B[U]}return[O,N]}function A(B,O=B.schema){const{gen:N,data:U,it:j}=B;if(Object.keys(O).length===0)return;const z=N.let("missing");for(const Z in O){const X=O[Z];if(X.length===0)continue;const Q=(0,E.propertyInData)(N,U,Z,j.opts.ownProperties);B.setParams({property:Z,depsCount:X.length,deps:X.join(", ")}),j.allErrors?N.if(Q,()=>{for(const se of X)(0,E.checkReportMissingProp)(B,se)}):(N.if((0,r._)`${Q} && (${(0,E.checkMissingProp)(B,X,z)})`),(0,E.reportMissingProp)(B,z),N.else())}}n.validatePropertyDeps=A;function I(B,O=B.schema){const{gen:N,data:U,keyword:j,it:z}=B,Z=N.name("valid");for(const X in O)(0,_.alwaysValidSchema)(z,O[X])||(N.if((0,E.propertyInData)(N,U,X,z.opts.ownProperties),()=>{const Q=B.subschema({keyword:j,schemaProp:X},Z);B.mergeValidEvaluated(Q,Z)},()=>N.var(Z,!0)),B.ok(Z))}n.validateSchemaDeps=I,n.default=S})(dependencies);var propertyNames={};Object.defineProperty(propertyNames,"__esModule",{value:!0});const codegen_1$6=codegen,util_1$9=util$1,error$5={message:"property name must be valid",params:({params:n})=>(0,codegen_1$6._)`{propertyName: ${n.propertyName}}`},def$b={keyword:"propertyNames",type:"object",schemaType:["object","boolean"],error:error$5,code(n){const{gen:r,schema:_,data:E,it:S}=n;if((0,util_1$9.alwaysValidSchema)(S,_))return;const C=r.name("valid");r.forIn("key",E,A=>{n.setParams({propertyName:A}),n.subschema({keyword:"propertyNames",data:A,dataTypes:["string"],propertyName:A,compositeRule:!0},C),r.if((0,codegen_1$6.not)(C),()=>{n.error(!0),S.allErrors||r.break()})}),n.ok(C)}};propertyNames.default=def$b;var additionalProperties={};Object.defineProperty(additionalProperties,"__esModule",{value:!0});const code_1$3=code$3,codegen_1$5=codegen,names_1=names$5,util_1$8=util$1,error$4={message:"must NOT have additional properties",params:({params:n})=>(0,codegen_1$5._)`{additionalProperty: ${n.additionalProperty}}`},def$a={keyword:"additionalProperties",type:["object"],schemaType:["boolean","object"],allowUndefined:!0,trackErrors:!0,error:error$4,code(n){const{gen:r,schema:_,parentSchema:E,data:S,errsCount:C,it:A}=n;if(!C)throw new Error("ajv implementation error");const{allErrors:I,opts:B}=A;if(A.props=!0,B.removeAdditional!=="all"&&(0,util_1$8.alwaysValidSchema)(A,_))return;const O=(0,code_1$3.allSchemaProperties)(E.properties),N=(0,code_1$3.allSchemaProperties)(E.patternProperties);U(),n.ok((0,codegen_1$5._)`${C} === ${names_1.default.errors}`);function U(){r.forIn("key",S,Q=>{!O.length&&!N.length?Z(Q):r.if(j(Q),()=>Z(Q))})}function j(Q){let se;if(O.length>8){const oe=(0,util_1$8.schemaRefOrVal)(A,E.properties,"properties");se=(0,code_1$3.isOwnProperty)(r,oe,Q)}else O.length?se=(0,codegen_1$5.or)(...O.map(oe=>(0,codegen_1$5._)`${Q} === ${oe}`)):se=codegen_1$5.nil;return N.length&&(se=(0,codegen_1$5.or)(se,...N.map(oe=>(0,codegen_1$5._)`${(0,code_1$3.usePattern)(n,oe)}.test(${Q})`))),(0,codegen_1$5.not)(se)}function z(Q){r.code((0,codegen_1$5._)`delete ${S}[${Q}]`)}function Z(Q){if(B.removeAdditional==="all"||B.removeAdditional&&_===!1){z(Q);return}if(_===!1){n.setParams({additionalProperty:Q}),n.error(),I||r.break();return}if(typeof _=="object"&&!(0,util_1$8.alwaysValidSchema)(A,_)){const se=r.name("valid");B.removeAdditional==="failing"?(X(Q,se,!1),r.if((0,codegen_1$5.not)(se),()=>{n.reset(),z(Q)})):(X(Q,se),I||r.if((0,codegen_1$5.not)(se),()=>r.break()))}}function X(Q,se,oe){const ue={keyword:"additionalProperties",dataProp:Q,dataPropType:util_1$8.Type.Str};oe===!1&&Object.assign(ue,{compositeRule:!0,createErrors:!1,allErrors:!1}),n.subschema(ue,se)}}};additionalProperties.default=def$a;var properties$1={};Object.defineProperty(properties$1,"__esModule",{value:!0});const validate_1=validate$4,code_1$2=code$3,util_1$7=util$1,additionalProperties_1$1=additionalProperties,def$9={keyword:"properties",type:"object",schemaType:"object",code(n){const{gen:r,schema:_,parentSchema:E,data:S,it:C}=n;C.opts.removeAdditional==="all"&&E.additionalProperties===void 0&&additionalProperties_1$1.default.code(new validate_1.KeywordCxt(C,additionalProperties_1$1.default,"additionalProperties"));const A=(0,code_1$2.allSchemaProperties)(_);for(const U of A)C.definedProperties.add(U);C.opts.unevaluated&&A.length&&C.props!==!0&&(C.props=util_1$7.mergeEvaluated.props(r,(0,util_1$7.toHash)(A),C.props));const I=A.filter(U=>!(0,util_1$7.alwaysValidSchema)(C,_[U]));if(I.length===0)return;const B=r.name("valid");for(const U of I)O(U)?N(U):(r.if((0,code_1$2.propertyInData)(r,S,U,C.opts.ownProperties)),N(U),C.allErrors||r.else().var(B,!0),r.endIf()),n.it.definedProperties.add(U),n.ok(B);function O(U){return C.opts.useDefaults&&!C.compositeRule&&_[U].default!==void 0}function N(U){n.subschema({keyword:"properties",schemaProp:U,dataProp:U},B)}}};properties$1.default=def$9;var patternProperties={};Object.defineProperty(patternProperties,"__esModule",{value:!0});const code_1$1=code$3,codegen_1$4=codegen,util_1$6=util$1,util_2=util$1,def$8={keyword:"patternProperties",type:"object",schemaType:"object",code(n){const{gen:r,schema:_,data:E,parentSchema:S,it:C}=n,{opts:A}=C,I=(0,code_1$1.allSchemaProperties)(_),B=I.filter(X=>(0,util_1$6.alwaysValidSchema)(C,_[X]));if(I.length===0||B.length===I.length&&(!C.opts.unevaluated||C.props===!0))return;const O=A.strictSchema&&!A.allowMatchingProperties&&S.properties,N=r.name("valid");C.props!==!0&&!(C.props instanceof codegen_1$4.Name)&&(C.props=(0,util_2.evaluatedPropsToName)(r,C.props));const{props:U}=C;j();function j(){for(const X of I)O&&z(X),C.allErrors?Z(X):(r.var(N,!0),Z(X),r.if(N))}function z(X){for(const Q in O)new RegExp(X).test(Q)&&(0,util_1$6.checkStrictMode)(C,`property ${Q} matches pattern ${X} (use allowMatchingProperties)`)}function Z(X){r.forIn("key",E,Q=>{r.if((0,codegen_1$4._)`${(0,code_1$1.usePattern)(n,X)}.test(${Q})`,()=>{const se=B.includes(X);se||n.subschema({keyword:"patternProperties",schemaProp:X,dataProp:Q,dataPropType:util_2.Type.Str},N),C.opts.unevaluated&&U!==!0?r.assign((0,codegen_1$4._)`${U}[${Q}]`,!0):!se&&!C.allErrors&&r.if((0,codegen_1$4.not)(N),()=>r.break())})})}}};patternProperties.default=def$8;var not={};Object.defineProperty(not,"__esModule",{value:!0});const util_1$5=util$1,def$7={keyword:"not",schemaType:["object","boolean"],trackErrors:!0,code(n){const{gen:r,schema:_,it:E}=n;if((0,util_1$5.alwaysValidSchema)(E,_)){n.fail();return}const S=r.name("valid");n.subschema({keyword:"not",compositeRule:!0,createErrors:!1,allErrors:!1},S),n.failResult(S,()=>n.reset(),()=>n.error())},error:{message:"must NOT be valid"}};not.default=def$7;var anyOf={};Object.defineProperty(anyOf,"__esModule",{value:!0});const code_1=code$3,def$6={keyword:"anyOf",schemaType:"array",trackErrors:!0,code:code_1.validateUnion,error:{message:"must match a schema in anyOf"}};anyOf.default=def$6;var oneOf={};Object.defineProperty(oneOf,"__esModule",{value:!0});const codegen_1$3=codegen,util_1$4=util$1,error$3={message:"must match exactly one schema in oneOf",params:({params:n})=>(0,codegen_1$3._)`{passingSchemas: ${n.passing}}`},def$5={keyword:"oneOf",schemaType:"array",trackErrors:!0,error:error$3,code(n){const{gen:r,schema:_,parentSchema:E,it:S}=n;if(!Array.isArray(_))throw new Error("ajv implementation error");if(S.opts.discriminator&&E.discriminator)return;const C=_,A=r.let("valid",!1),I=r.let("passing",null),B=r.name("_valid");n.setParams({passing:I}),r.block(O),n.result(A,()=>n.reset(),()=>n.error(!0));function O(){C.forEach((N,U)=>{let j;(0,util_1$4.alwaysValidSchema)(S,N)?r.var(B,!0):j=n.subschema({keyword:"oneOf",schemaProp:U,compositeRule:!0},B),U>0&&r.if((0,codegen_1$3._)`${B} && ${A}`).assign(A,!1).assign(I,(0,codegen_1$3._)`[${I}, ${U}]`).else(),r.if(B,()=>{r.assign(A,!0),r.assign(I,U),j&&n.mergeEvaluated(j,codegen_1$3.Name)})})}}};oneOf.default=def$5;var allOf={};Object.defineProperty(allOf,"__esModule",{value:!0});const util_1$3=util$1,def$4={keyword:"allOf",schemaType:"array",code(n){const{gen:r,schema:_,it:E}=n;if(!Array.isArray(_))throw new Error("ajv implementation error");const S=r.name("valid");_.forEach((C,A)=>{if((0,util_1$3.alwaysValidSchema)(E,C))return;const I=n.subschema({keyword:"allOf",schemaProp:A},S);n.ok(S),n.mergeEvaluated(I)})}};allOf.default=def$4;var _if={};Object.defineProperty(_if,"__esModule",{value:!0});const codegen_1$2=codegen,util_1$2=util$1,error$2={message:({params:n})=>(0,codegen_1$2.str)`must match "${n.ifClause}" schema`,params:({params:n})=>(0,codegen_1$2._)`{failingKeyword: ${n.ifClause}}`},def$3={keyword:"if",schemaType:["object","boolean"],trackErrors:!0,error:error$2,code(n){const{gen:r,parentSchema:_,it:E}=n;_.then===void 0&&_.else===void 0&&(0,util_1$2.checkStrictMode)(E,'"if" without "then" and "else" is ignored');const S=hasSchema(E,"then"),C=hasSchema(E,"else");if(!S&&!C)return;const A=r.let("valid",!0),I=r.name("_valid");if(B(),n.reset(),S&&C){const N=r.let("ifClause");n.setParams({ifClause:N}),r.if(I,O("then",N),O("else",N))}else S?r.if(I,O("then")):r.if((0,codegen_1$2.not)(I),O("else"));n.pass(A,()=>n.error(!0));function B(){const N=n.subschema({keyword:"if",compositeRule:!0,createErrors:!1,allErrors:!1},I);n.mergeEvaluated(N)}function O(N,U){return()=>{const j=n.subschema({keyword:N},I);r.assign(A,I),n.mergeValidEvaluated(j,A),U?r.assign(U,(0,codegen_1$2._)`${N}`):n.setParams({ifClause:N})}}}};function hasSchema(n,r){const _=n.schema[r];return _!==void 0&&!(0,util_1$2.alwaysValidSchema)(n,_)}_if.default=def$3;var thenElse={};Object.defineProperty(thenElse,"__esModule",{value:!0});const util_1$1=util$1,def$2={keyword:["then","else"],schemaType:["object","boolean"],code({keyword:n,parentSchema:r,it:_}){r.if===void 0&&(0,util_1$1.checkStrictMode)(_,`"${n}" without "if" is ignored`)}};thenElse.default=def$2;Object.defineProperty(applicator,"__esModule",{value:!0});const additionalItems_1=additionalItems,prefixItems_1=prefixItems,items_1=items,items2020_1=items2020,contains_1=contains,dependencies_1=dependencies,propertyNames_1=propertyNames,additionalProperties_1=additionalProperties,properties_1=properties$1,patternProperties_1=patternProperties,not_1=not,anyOf_1=anyOf,oneOf_1=oneOf,allOf_1=allOf,if_1=_if,thenElse_1=thenElse;function getApplicator(n=!1){const r=[not_1.default,anyOf_1.default,oneOf_1.default,allOf_1.default,if_1.default,thenElse_1.default,propertyNames_1.default,additionalProperties_1.default,dependencies_1.default,properties_1.default,patternProperties_1.default];return n?r.push(prefixItems_1.default,items2020_1.default):r.push(additionalItems_1.default,items_1.default),r.push(contains_1.default),r}applicator.default=getApplicator;var format$2={},format$1={};Object.defineProperty(format$1,"__esModule",{value:!0});const codegen_1$1=codegen,error$1={message:({schemaCode:n})=>(0,codegen_1$1.str)`must match format "${n}"`,params:({schemaCode:n})=>(0,codegen_1$1._)`{format: ${n}}`},def$1={keyword:"format",type:["number","string"],schemaType:"string",$data:!0,error:error$1,code(n,r){const{gen:_,data:E,$data:S,schema:C,schemaCode:A,it:I}=n,{opts:B,errSchemaPath:O,schemaEnv:N,self:U}=I;if(!B.validateFormats)return;S?j():z();function j(){const Z=_.scopeValue("formats",{ref:U.formats,code:B.code.formats}),X=_.const("fDef",(0,codegen_1$1._)`${Z}[${A}]`),Q=_.let("fType"),se=_.let("format");_.if((0,codegen_1$1._)`typeof ${X} == "object" && !(${X} instanceof RegExp)`,()=>_.assign(Q,(0,codegen_1$1._)`${X}.type || "string"`).assign(se,(0,codegen_1$1._)`${X}.validate`),()=>_.assign(Q,(0,codegen_1$1._)`"string"`).assign(se,X)),n.fail$data((0,codegen_1$1.or)(oe(),ue()));function oe(){return B.strictSchema===!1?codegen_1$1.nil:(0,codegen_1$1._)`${A} && !${se}`}function ue(){const we=N.$async?(0,codegen_1$1._)`(${X}.async ? await ${se}(${E}) : ${se}(${E}))`:(0,codegen_1$1._)`${se}(${E})`,Te=(0,codegen_1$1._)`(typeof ${se} == "function" ? ${we} : ${se}.test(${E}))`;return(0,codegen_1$1._)`${se} && ${se} !== true && ${Q} === ${r} && !${Te}`}}function z(){const Z=U.formats[C];if(!Z){oe();return}if(Z===!0)return;const[X,Q,se]=ue(Z);X===r&&n.pass(we());function oe(){if(B.strictSchema===!1){U.logger.warn(Te());return}throw new Error(Te());function Te(){return`unknown format "${C}" ignored in schema at path "${O}"`}}function ue(Te){const xe=Te instanceof RegExp?(0,codegen_1$1.regexpCode)(Te):B.code.formats?(0,codegen_1$1._)`${B.code.formats}${(0,codegen_1$1.getProperty)(C)}`:void 0,Re=_.scopeValue("formats",{key:C,ref:Te,code:xe});return typeof Te=="object"&&!(Te instanceof RegExp)?[Te.type||"string",Te.validate,(0,codegen_1$1._)`${Re}.validate`]:["string",Te,Re]}function we(){if(typeof Z=="object"&&!(Z instanceof RegExp)&&Z.async){if(!N.$async)throw new Error("async format in sync schema");return(0,codegen_1$1._)`await ${se}(${E})`}return typeof Q=="function"?(0,codegen_1$1._)`${se}(${E})`:(0,codegen_1$1._)`${se}.test(${E})`}}}};format$1.default=def$1;Object.defineProperty(format$2,"__esModule",{value:!0});const format_1$1=format$1,format=[format_1$1.default];format$2.default=format;var metadata={};Object.defineProperty(metadata,"__esModule",{value:!0});metadata.contentVocabulary=metadata.metadataVocabulary=void 0;metadata.metadataVocabulary=["title","description","default","deprecated","readOnly","writeOnly","examples"];metadata.contentVocabulary=["contentMediaType","contentEncoding","contentSchema"];Object.defineProperty(draft7,"__esModule",{value:!0});const core_1=core$2,validation_1=validation$1,applicator_1=applicator,format_1=format$2,metadata_1=metadata,draft7Vocabularies=[core_1.default,validation_1.default,(0,applicator_1.default)(),format_1.default,metadata_1.metadataVocabulary,metadata_1.contentVocabulary];draft7.default=draft7Vocabularies;var discriminator={},types$1={};(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.DiscrError=void 0,function(r){r.Tag="tag",r.Mapping="mapping"}(n.DiscrError||(n.DiscrError={}))})(types$1);Object.defineProperty(discriminator,"__esModule",{value:!0});const codegen_1=codegen,types_1=types$1,compile_1=compile,util_1=util$1,error={message:({params:{discrError:n,tagName:r}})=>n===types_1.DiscrError.Tag?`tag "${r}" must be string`:`value of tag "${r}" must be in oneOf`,params:({params:{discrError:n,tag:r,tagName:_}})=>(0,codegen_1._)`{error: ${n}, tag: ${_}, tagValue: ${r}}`},def={keyword:"discriminator",type:"object",schemaType:"object",error,code(n){const{gen:r,data:_,schema:E,parentSchema:S,it:C}=n,{oneOf:A}=S;if(!C.opts.discriminator)throw new Error("discriminator: requires discriminator option");const I=E.propertyName;if(typeof I!="string")throw new Error("discriminator: requires propertyName");if(E.mapping)throw new Error("discriminator: mapping is not supported");if(!A)throw new Error("discriminator: requires oneOf keyword");const B=r.let("valid",!1),O=r.const("tag",(0,codegen_1._)`${_}${(0,codegen_1.getProperty)(I)}`);r.if((0,codegen_1._)`typeof ${O} == "string"`,()=>N(),()=>n.error(!1,{discrError:types_1.DiscrError.Tag,tag:O,tagName:I})),n.ok(B);function N(){const z=j();r.if(!1);for(const Z in z)r.elseIf((0,codegen_1._)`${O} === ${Z}`),r.assign(B,U(z[Z]));r.else(),n.error(!1,{discrError:types_1.DiscrError.Mapping,tag:O,tagName:I}),r.endIf()}function U(z){const Z=r.name("valid"),X=n.subschema({keyword:"oneOf",schemaProp:z},Z);return n.mergeEvaluated(X,codegen_1.Name),Z}function j(){var z;const Z={},X=se(S);let Q=!0;for(let we=0;we<A.length;we++){let Te=A[we];Te?.$ref&&!(0,util_1.schemaHasRulesButRef)(Te,C.self.RULES)&&(Te=compile_1.resolveRef.call(C.self,C.schemaEnv.root,C.baseId,Te?.$ref),Te instanceof compile_1.SchemaEnv&&(Te=Te.schema));const xe=(z=Te?.properties)===null||z===void 0?void 0:z[I];if(typeof xe!="object")throw new Error(`discriminator: oneOf subschemas (or referenced schemas) must have "properties/${I}"`);Q=Q&&(X||se(Te)),oe(xe,we)}if(!Q)throw new Error(`discriminator: "${I}" must be required`);return Z;function se({required:we}){return Array.isArray(we)&&we.includes(I)}function oe(we,Te){if(we.const)ue(we.const,Te);else if(we.enum)for(const xe of we.enum)ue(xe,Te);else throw new Error(`discriminator: "properties/${I}" must have "const" or "enum"`)}function ue(we,Te){if(typeof we!="string"||we in Z)throw new Error(`discriminator: "${I}" values must be unique strings`);Z[we]=Te}}}};discriminator.default=def;const $schema="http://json-schema.org/draft-07/schema#",$id="http://json-schema.org/draft-07/schema#",title="Core schema meta-schema",definitions={schemaArray:{type:"array",minItems:1,items:{$ref:"#"}},nonNegativeInteger:{type:"integer",minimum:0},nonNegativeIntegerDefault0:{allOf:[{$ref:"#/definitions/nonNegativeInteger"},{default:0}]},simpleTypes:{enum:["array","boolean","integer","null","number","object","string"]},stringArray:{type:"array",items:{type:"string"},uniqueItems:!0,default:[]}},type$1=["object","boolean"],properties={$id:{type:"string",format:"uri-reference"},$schema:{type:"string",format:"uri"},$ref:{type:"string",format:"uri-reference"},$comment:{type:"string"},title:{type:"string"},description:{type:"string"},default:!0,readOnly:{type:"boolean",default:!1},examples:{type:"array",items:!0},multipleOf:{type:"number",exclusiveMinimum:0},maximum:{type:"number"},exclusiveMaximum:{type:"number"},minimum:{type:"number"},exclusiveMinimum:{type:"number"},maxLength:{$ref:"#/definitions/nonNegativeInteger"},minLength:{$ref:"#/definitions/nonNegativeIntegerDefault0"},pattern:{type:"string",format:"regex"},additionalItems:{$ref:"#"},items:{anyOf:[{$ref:"#"},{$ref:"#/definitions/schemaArray"}],default:!0},maxItems:{$ref:"#/definitions/nonNegativeInteger"},minItems:{$ref:"#/definitions/nonNegativeIntegerDefault0"},uniqueItems:{type:"boolean",default:!1},contains:{$ref:"#"},maxProperties:{$ref:"#/definitions/nonNegativeInteger"},minProperties:{$ref:"#/definitions/nonNegativeIntegerDefault0"},required:{$ref:"#/definitions/stringArray"},additionalProperties:{$ref:"#"},definitions:{type:"object",additionalProperties:{$ref:"#"},default:{}},properties:{type:"object",additionalProperties:{$ref:"#"},default:{}},patternProperties:{type:"object",additionalProperties:{$ref:"#"},propertyNames:{format:"regex"},default:{}},dependencies:{type:"object",additionalProperties:{anyOf:[{$ref:"#"},{$ref:"#/definitions/stringArray"}]}},propertyNames:{$ref:"#"},const:!0,enum:{type:"array",items:!0,minItems:1,uniqueItems:!0},type:{anyOf:[{$ref:"#/definitions/simpleTypes"},{type:"array",items:{$ref:"#/definitions/simpleTypes"},minItems:1,uniqueItems:!0}]},format:{type:"string"},contentMediaType:{type:"string"},contentEncoding:{type:"string"},if:{$ref:"#"},then:{$ref:"#"},else:{$ref:"#"},allOf:{$ref:"#/definitions/schemaArray"},anyOf:{$ref:"#/definitions/schemaArray"},oneOf:{$ref:"#/definitions/schemaArray"},not:{$ref:"#"}},require$$3$1={$schema,$id,title,definitions,type:type$1,properties,default:!0};(function(n,r){Object.defineProperty(r,"__esModule",{value:!0}),r.MissingRefError=r.ValidationError=r.CodeGen=r.Name=r.nil=r.stringify=r.str=r._=r.KeywordCxt=void 0;const _=core$3,E=draft7,S=discriminator,C=require$$3$1,A=["/properties"],I="http://json-schema.org/draft-07/schema";class B extends _.default{_addVocabularies(){super._addVocabularies(),E.default.forEach(Z=>this.addVocabulary(Z)),this.opts.discriminator&&this.addKeyword(S.default)}_addDefaultMetaSchema(){if(super._addDefaultMetaSchema(),!this.opts.meta)return;const Z=this.opts.$data?this.$dataMetaSchema(C,A):C;this.addMetaSchema(Z,I,!1),this.refs["http://json-schema.org/schema"]=I}defaultMeta(){return this.opts.defaultMeta=super.defaultMeta()||(this.getSchema(I)?I:void 0)}}n.exports=r=B,Object.defineProperty(r,"__esModule",{value:!0}),r.default=B;var O=validate$4;Object.defineProperty(r,"KeywordCxt",{enumerable:!0,get:function(){return O.KeywordCxt}});var N=codegen;Object.defineProperty(r,"_",{enumerable:!0,get:function(){return N._}}),Object.defineProperty(r,"str",{enumerable:!0,get:function(){return N.str}}),Object.defineProperty(r,"stringify",{enumerable:!0,get:function(){return N.stringify}}),Object.defineProperty(r,"nil",{enumerable:!0,get:function(){return N.nil}}),Object.defineProperty(r,"Name",{enumerable:!0,get:function(){return N.Name}}),Object.defineProperty(r,"CodeGen",{enumerable:!0,get:function(){return N.CodeGen}});var U=validation_error;Object.defineProperty(r,"ValidationError",{enumerable:!0,get:function(){return U.default}});var j=ref_error;Object.defineProperty(r,"MissingRefError",{enumerable:!0,get:function(){return j.default}})})(ajv$1,ajv$1.exports);var ajvExports=ajv$1.exports;const Ajv=getDefaultExportFromCjs(ajvExports),ajv=new Ajv({allowUnionTypes:!0}),generateListValidator=n=>({validate:ajv.compile(n)}),generateDictValidator=n=>{const r=ajv.compile(n),_=B=>B===!0?()=>!0:ajv.compile(B),E=Object.fromEntries(Object.entries(n.properties||{}).map(([B,O])=>[B,_(O)])),S=n.additionalProperties?_(n.additionalProperties):()=>!1,C=(B,O)=>A(O)(B),A=B=>E[B]||S;return{validateRoot:r,validateKey:C,getKeyValidator:A,supportedKey:B=>!!E[B]||!!n.additionalProperties}},typedFeed=({db:n,schema:r})=>{const{validate:_}=generateListValidator(r);return new Proxy(n,{get(E,S){return S==="all"?async()=>(await E[S]()).filter(I=>_(I.value)):S==="add"?async C=>{if(_(C))return await E.add(C);throw new Error(C.toString()+JSON.stringify(_.errors,void 0,2))}:E[S]}})},typedKeyValue=({db:n,schema:r})=>{const{validateRoot:_,validateKey:E,getKeyValidator:S,supportedKey:C}=generateDictValidator(r);return new Proxy(n,{get(A,I){return I==="get"?async B=>{if(!C(B))throw new Error(`Unsupported key ${B}.`);const O=await A.get(B);return O===void 0||E(O,B)?O:void 0}:I==="put"||I==="set"?async(B,O)=>{if(!C(B))throw new Error(`Unsupported key ${B}.`);if(E(O,B))return await A.put(B,O);throw new Error(JSON.stringify(S(B).errors,void 0,2))}:I==="all"?async()=>(await A.all()).filter(O=>E(O.value,O.key)):I==="allAsJSON"?async()=>{const B=await A.all(),O=Object.fromEntries(B.map(U=>[U.key,U.value]));if(_(O))return O;throw new Error(JSON.stringify(_.errors,void 0,2))}:A[I]}})},typedOrderedKeyValue=({db:n,schema:r})=>{const{validateKey:_,getKeyValidator:E,supportedKey:S}=generateDictValidator(r);return new Proxy(n,{get(C,A){return A==="get"?async I=>{if(!S(I))throw new Error(`Unsupported key ${I}.`);const B=await C.get(I);if(B===void 0)return B;const{value:O,position:N}=B;return _(O,I)?{value:O,position:N}:void 0}:A==="move"?async(I,B)=>{if(!S(I))throw new Error(`Unsupported key ${I}.`);return await C.move(I,B)}:A==="put"||A==="set"?async(I,B,O)=>{if(!S(I))throw new Error(`Unsupported key ${I}.`);if(_(B,I))return await C.put(I,B,O);throw new Error(JSON.stringify(E(I).errors,void 0,2))}:A==="all"?async()=>(await C.all()).filter(B=>_(B.value,B.key)):C[A]}})},typedSet=({db:n,schema:r})=>{const{validate:_}=generateListValidator(r);return new Proxy(n,{get(E,S){return S==="all"?async()=>(await E[S]()).filter(I=>_(I.value)):S==="add"?async C=>{if(_(C))return await E.add(C);throw new Error(C.toString()+JSON.stringify(_.errors,void 0,2))}:E[S]}})},prparerOrbite=()=>{registerFeed(),registerSet(),registerOrderedKeyValue(),enregistrerContrleurs()};async function initOrbite({sfip:n,dossierOrbite:r}){return prparerOrbite(),await OrbitDB({ipfs:n,id:"constellation",directory:r})}const typerBd=({bd:n,schma:r})=>{switch(n.type){case"feed":return typedFeed({db:n,schema:r});case"set":return typedSet({db:n,schema:r});case"keyvalue":return typedKeyValue({db:n,schema:r});case"ordered-keyvalue":return typedOrderedKeyValue({db:n,schema:r});default:throw new Error("Type de bd non reconnu.")}};class GestionnaireOrbite{orbite;_bdsOrbite;verrouOuvertureBd;_oublierNettoyageBdsOuvertes;constructor(r){this.orbite=r,this._bdsOrbite={},this.verrouOuvertureBd=new s$1,this._oublierNettoyageBdsOuvertes=this.lancerNettoyageBdsOuvertes()}get identity(){return this.orbite.identity}async ouvrirBd({id:r,type:_,options:E}){await this.verrouOuvertureBd.acquire(r);const S=this._bdsOrbite[r],C=v4(),A=async()=>{this._bdsOrbite[r]&&this._bdsOrbite[r].idsRequtes.delete(C)},I=B=>{const{type:O}=B;return _===void 0?!0:O===_};if(S){if(this._bdsOrbite[r].idsRequtes.add(C),this.verrouOuvertureBd.release(r),!I(S.bd))throw new Error(`La bd est de type ${S.bd.type}, et non ${_}.`);return{bd:S.bd,fOublier:A}}try{const B=await this.orbite.open(r,{type:_,...E});return this._bdsOrbite[r]={bd:B,idsRequtes:new Set([C])},this.verrouOuvertureBd.release(r),{bd:B,fOublier:A}}catch(B){throw console.error(B.toString()),B}}async ouvrirBdType({id:r,type:_,schma:E,options:S}){const{bd:C,fOublier:A}=await this.ouvrirBd({id:r,type:_,options:S});return{bd:typerBd({bd:C,schma:E}),fOublier:A}}async crerBdIndpendante({type:r,options:_,nom:E}){const S=await this.orbite.open(E||v4(),{type:r,..._}),{address:C}=S;return this._bdsOrbite[C]={bd:S,idsRequtes:new Set},C}async effacerBd({id:r}){const{bd:_}=await this.ouvrirBd({id:r});await _.drop(),delete this._bdsOrbite[r]}lancerNettoyageBdsOuvertes(){const _=setInterval(async()=>{await Promise.all(Object.keys(this._bdsOrbite).map(async E=>{const{bd:S,idsRequtes:C}=this._bdsOrbite[E];C.size||(delete this._bdsOrbite[E],await S.close())}))},3e5);return async()=>clearInterval(_)}async appliquerFonctionBdOrbite({idBd:r,fonction:_,args:E}){const{bd:S,fOublier:C}=await this.ouvrirBd({id:r}),A=await S[_](...E);return await C(),A}async fermer({arrterOrbite:r}){this._oublierNettoyageBdsOuvertes&&this._oublierNettoyageBdsOuvertes(),r&&await this.orbite.stop()}}class GestionnaireOrbiteGnral{gestionnaires;constructor(){this.gestionnaires={}}obtGestionnaireOrbite({orbite:r}){return this.gestionnaires[r.identity.id]||(this.gestionnaires[r.identity.id]=new GestionnaireOrbite(r)),this.gestionnaires[r.identity.id]}async fermer({orbite:r,arrterOrbite:_}){await this.obtGestionnaireOrbite({orbite:r}).fermer({arrterOrbite:_}),delete this.gestionnaires[r.identity.id]}}const gestionnaireOrbiteGnral=new GestionnaireOrbiteGnral,orbite=Object.freeze(Object.defineProperty({__proto__:null,GestionnaireOrbite,GestionnaireOrbiteGnral,gestionnaireOrbiteGnral,initOrbite,prparerOrbite},Symbol.toStringTag,{value:"Module"})),suivreBdAccs=async(n,r)=>{const _=async()=>{const S=await n.all();await r(S.map(C=>C.value))};return n.events.setMaxListeners(100),n.events.on("update",_),await _(),async()=>{n.events.off("update",_)}};class AccsUtilisateur extends eventsExports.EventEmitter{orbite;idBd;idBdAccs;bdAccs;fOublierBd;oublierSuivi;autoriss;accs;idRequte;prt;constructor(r,_){super(),this.orbite=gestionnaireOrbiteGnral.obtGestionnaireOrbite({orbite:r}),this.idBd=_,this.autoriss=[],this.idRequte=v4(),this.prt=!1}async initialiser(){const{bd:r,fOublier:_}=await this.orbite.ouvrirBd({id:this.idBd});this.fOublierBd=_,this.accs=r.access,this.bdAccs=this.accs.bd,this.idBdAccs=this.bdAccs?.address,await this._miseJour([]),this.oublierSuivi=await suivreBdAccs(this.bdAccs,async E=>{await this._miseJour(E)}),this.prt=!0}async _miseJour(r){const _=[];r=[{id:this.accs.write,rle:MODRATEUR},...r],r.forEach(E=>{_.push(E.id)}),this.autoriss=_,this.emit("misJour")}async fermer(){this.oublierSuivi&&await this.oublierSuivi(),await this.fOublierBd?.()}}class GestionnaireAccs extends eventsExports.EventEmitter{_rles;_rlesIdOrbite;_rlesUtilisateurs;_miseJourEnCours;orbite;constructor(r){super(),this._rles={[MODRATEUR]:[],[MEMBRE]:[]},this._rlesIdOrbite={[MODRATEUR]:[],[MEMBRE]:[]},this._rlesUtilisateurs={[MODRATEUR]:{},[MEMBRE]:{}},this._miseJourEnCours=!1,this.orbite=r}async estUnMembre(r){return this._miseJourEnCours&&await once_1(this,"misJour"),this._rles[MEMBRE].includes(r)}async estUnModrateur(r){return this._miseJourEnCours&&await once_1(this,"misJour"),this._rles[MODRATEUR].includes(r)}async estAutoris(r){return await this.estUnModrateur(r)||await this.estUnMembre(r)}async ajouterlments(r){this._miseJourEnCours=!0,await Promise.all(r.map(async _=>{const{rle:E,id:S}=_;if(isValidAddress(S)){if(!this._rlesUtilisateurs[E][S]){const C=new AccsUtilisateur(this.orbite,S);C.on("misJour",()=>this._mettreRlesJour()),this._rlesUtilisateurs[E][S]=C,await C.initialiser()}}else this._rlesIdOrbite[E].includes(S)||(this._rlesIdOrbite[E].push(S),this._mettreRlesJour())})),this._miseJourEnCours=!1,this._mettreRlesJour(),this.emit("misJour")}_mettreRlesJour(){const r={MODRATEUR:[],MEMBRE:[]};for(const[_,E]of Object.entries(this._rlesIdOrbite)){const S=r[_];E.forEach(C=>{S.includes(C)||S.push(C)})}for(const[_,E]of Object.entries(this._rlesUtilisateurs)){const S=r[_];Object.values(E).forEach(C=>{C.autoriss.forEach(A=>{S.includes(A)||S.push(A)})})}this._rles=r}async fermer(){const r=Object.values(this._rlesUtilisateurs).map(_=>Object.values(_)).flat();await Promise.all(r.map(_=>_.fermer()))}}const pathJoin=(...n)=>n.join("/").replace(/((?<=\/)\/+)|(^\.\/)|((?<=\/)\.\/)/g,"")||".",estUnContrleurConstellation=n=>n.type===nomType,type="contrleur-accs-constellation",codec$1=dagCbor,hasher$1=sha256$6,hashStringEncoding$1=base58btc,PremierModrateur=async({storage:n,type:r,params:_})=>{const E={type:r,..._},{cid:S,bytes:C}=await encode$a({value:E,codec:codec$1,hasher:hasher$1}),A=S.toString(hashStringEncoding$1);return await n.put(A,C),A},ContrleurAccs=({write:n,storage:r}={})=>async({orbitdb:_,identities:E,address:S})=>{r=r||await ComposedStorage(await LRUStorage({size:1e3}),await IPFSBlockStorage({ipfs:_.ipfs,pin:!0})),n=n||_.identity.id;const C=new GestionnaireAccs(_);if(S){const B=await r.get(S.replaceAll("/contrleur-accs-constellation/","")),{value:O}=await decode$a({bytes:B,codec:codec$1,hasher:hasher$1});({write:n}=O)}else S=await PremierModrateur({storage:r,type,params:{write:n}}),S=pathJoin("/",type,S);await C.ajouterlments([{id:n,rle:MODRATEUR}]);const A=async B=>{if(B.payload.op!=="ADD"||!B.payload.value)return!1;const{rle:O,id:N}=B.payload.value,U=rles.includes(O),j=await E.getIdentity(B.identity);if(!j)return!1;const{id:z}=j;return U&&await I(z,B)&&E.verifyIdentity(j)?(O===MODRATEUR&&await C.ajouterlments([{id:N,rle:MODRATEUR}]),!0):!1},I=async(B,O)=>{if(await C.estUnModrateur(B))return!0;const N=O.next;for(const U of N){const j=await r?.get(U),z=await Entry.decode(j);if(await A(z)&&await C.estUnModrateur(B))return!0}return!1};return{type,address:S,write:n,canAppend:A}};ContrleurAccs.type=type;const nomType="contrleur-constellation",codec=dagCbor,hasher=sha256$6,hashStringEncoding=base58btc,schmaBdAccs={type:"object",properties:{rle:{type:"string"},id:{type:"string"}},required:["rle","id"]},ManifestContrleurConstellation=async({storage:n,type:r,params:_})=>{const E={type:r,..._},{cid:S,bytes:C}=await encode$a({value:E,codec,hasher}),A=S.toString(hashStringEncoding);return await n.put(A,C),A},ContrleurConstellation=({write:n,nom:r,storage:_}={})=>async({orbitdb:E,identities:S,address:C})=>{n=n||E.identity.id,r=r||v4(),_=_||await ComposedStorage(await LRUStorage({size:1e3}),await IPFSBlockStorage({ipfs:E.ipfs,pin:!0}));const A=gestionnaireOrbiteGnral.obtGestionnaireOrbite({orbite:E});let I,B,O;if(C){const Ne=await _.get(C.replaceAll(`/${nomType}/`,"")),{value:Fe}=await decode$a({bytes:Ne,codec,hasher});({write:n,nom:r,adresseBdAccs:I}=Fe),{bd:B,fOublier:O}=await A.ouvrirBdType({id:I,type:"set",schma:schmaBdAccs,options:{syncAutomatically:!0}})}else({bd:B,fOublier:O}=await A.ouvrirBdType({id:r,type:"set",schma:schmaBdAccs,options:{AccessController:ContrleurAccs({write:n,storage:_}),syncAutomatically:!0}})),I=B.address,C=await ManifestContrleurConstellation({storage:_,type:nomType,params:{write:n,nom:r,adresseBdAccs:I}}),C=pathJoin("/",nomType,C);const N=new eventsExports.EventEmitter,U=new GestionnaireAccs(E);U.on("misJour",()=>N.emit("misJour"));const z=await suivreBdAccs(B,async Ne=>{Ne=[{rle:MODRATEUR,id:n},...Ne],await U.ajouterlments(Ne)}),Z=async Ne=>await U.estAutoris(Ne);return{type:nomType,address:C,adresseBdAccs:I,write:n,grant:async(Ne,Fe)=>{if(!rles.includes(Ne))throw new Error(`Erreur: Le rle ${Ne} n'existe pas.`);if(!U._rles[Ne].includes(Fe))try{const ht={rle:Ne,id:Fe};await B.add(ht)}catch(ht){const nt=ht;throw nt.toString().includes("not append entry")?new Error(`Erreur : Le rle ${Ne} ne peut pas tre octroy  ${Fe}.`):nt}},revoke:async(Ne,Fe)=>{throw new Error("C'est trs difficile  implmenter...avez-vous des ides ?")},canAppend:async Ne=>{const Fe=await S.getIdentity(Ne.identity);if(!Fe)return!1;const{id:ht}=Fe;return S.verifyIdentity(Fe)&&await Z(ht)},close:async()=>{await z(),await O(),await U.fermer()},drop:async()=>{},suivreUtilisateursAutoriss:async Ne=>{const Fe=async()=>{const nt=Object.keys(U._rlesUtilisateurs[MODRATEUR]).map(Ie=>({idCompte:Ie,rle:MODRATEUR})),Ee=nt.map(Ie=>Ie.idCompte),Ce=Object.keys(U._rlesUtilisateurs[MEMBRE]).map(Ie=>({idCompte:Ie,rle:MEMBRE})).filter(Ie=>!Ee.includes(Ie.idCompte)),_e=[...nt,...Ce];await Ne(_e)};return U.on("misJour",Fe),await Fe(),async()=>{U.off("misJour",Fe)}},suivreIdsOrbiteAutorisescriture:async Ne=>{const Fe=async()=>{await Ne([...U._rles.MEMBRE,...U._rles.MODRATEUR])};return U.on("misJour",Fe),await Fe(),async()=>{U.off("misJour",Fe)}},gestRles:U,estAutoris:Z,estUnMembre:async Ne=>await U.estUnMembre(Ne),estUnModrateur:async Ne=>await U.estUnModrateur(Ne),bd:B}};ContrleurConstellation.type=nomType;const enregistrerContrleurs=()=>{registerSet(),useAccessController(ContrleurConstellation),useAccessController(ContrleurAccs)};/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var XLSX={};XLSX.version="0.19.1";var current_codepage=1200,$cptable,VALID_ANSI=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],CS2CP={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},set_ansi=function(n){VALID_ANSI.indexOf(n)!=-1&&(CS2CP[0]=n)};function reset_ansi(){set_ansi(1252)}var set_cp=function(n){current_codepage=n,set_ansi(n)};function reset_cp(){set_cp(1200),reset_ansi()}function char_codes(n){for(var r=[],_=0,E=n.length;_<E;++_)r[_]=n.charCodeAt(_);return r}function utf16leread(n){for(var r=[],_=0;_<n.length>>1;++_)r[_]=String.fromCharCode(n.charCodeAt(2*_)+(n.charCodeAt(2*_+1)<<8));return r.join("")}function utf16beread(n){for(var r=[],_=0;_<n.length>>1;++_)r[_]=String.fromCharCode(n.charCodeAt(2*_+1)+(n.charCodeAt(2*_)<<8));return r.join("")}var debom=function(n){var r=n.charCodeAt(0),_=n.charCodeAt(1);return r==255&&_==254?utf16leread(n.slice(2)):r==254&&_==255?utf16beread(n.slice(2)):r==65279?n.slice(1):n},_getchar=function(r){return String.fromCharCode(r)},_getansi=function(r){return String.fromCharCode(r)},DENSE=null,Base64_map="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Base64_encode(n){for(var r="",_=0,E=0,S=0,C=0,A=0,I=0,B=0,O=0;O<n.length;)_=n.charCodeAt(O++),C=_>>2,E=n.charCodeAt(O++),A=(_&3)<<4|E>>4,S=n.charCodeAt(O++),I=(E&15)<<2|S>>6,B=S&63,isNaN(E)?I=B=64:isNaN(S)&&(B=64),r+=Base64_map.charAt(C)+Base64_map.charAt(A)+Base64_map.charAt(I)+Base64_map.charAt(B);return r}function Base64_encode_pass(n){for(var r="",_=0,E=0,S=0,C=0,A=0,I=0,B=0,O=0;O<n.length;)_=n.charCodeAt(O++),_>255&&(_=95),C=_>>2,E=n.charCodeAt(O++),E>255&&(E=95),A=(_&3)<<4|E>>4,S=n.charCodeAt(O++),S>255&&(S=95),I=(E&15)<<2|S>>6,B=S&63,isNaN(E)?I=B=64:isNaN(S)&&(B=64),r+=Base64_map.charAt(C)+Base64_map.charAt(A)+Base64_map.charAt(I)+Base64_map.charAt(B);return r}function Base64_decode(n){var r="",_=0,E=0,S=0,C=0,A=0,I=0,B=0;n=n.replace(/^data:([^\/]+\/[^\/]+)?;base64\,/,"").replace(/[^\w\+\/\=]/g,"");for(var O=0;O<n.length;)C=Base64_map.indexOf(n.charAt(O++)),A=Base64_map.indexOf(n.charAt(O++)),_=C<<2|A>>4,r+=String.fromCharCode(_),I=Base64_map.indexOf(n.charAt(O++)),E=(A&15)<<4|I>>2,I!==64&&(r+=String.fromCharCode(E)),B=Base64_map.indexOf(n.charAt(O++)),S=(I&3)<<6|B,B!==64&&(r+=String.fromCharCode(S));return r}var has_buf=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),Buffer_from=function(){if(typeof Buffer<"u"){var n=!Buffer.from;if(!n)try{Buffer.from("foo","utf8")}catch{n=!0}return n?function(r,_){return _?new Buffer(r,_):new Buffer(r)}:Buffer.from.bind(Buffer)}return function(){}}(),buf_utf16le=function(){if(typeof Buffer>"u")return!1;var n=Buffer_from([65,0]);if(!n)return!1;var r=n.toString("utf16le");return r.length==1}();function new_raw_buf(n){return has_buf?Buffer.alloc?Buffer.alloc(n):new Buffer(n):typeof Uint8Array<"u"?new Uint8Array(n):new Array(n)}function new_unsafe_buf(n){return has_buf?Buffer.allocUnsafe?Buffer.allocUnsafe(n):new Buffer(n):typeof Uint8Array<"u"?new Uint8Array(n):new Array(n)}var s2a=function(r){return has_buf?Buffer_from(r,"binary"):r.split("").map(function(_){return _.charCodeAt(0)&255})};function s2ab(n){if(typeof ArrayBuffer>"u")return s2a(n);for(var r=new ArrayBuffer(n.length),_=new Uint8Array(r),E=0;E!=n.length;++E)_[E]=n.charCodeAt(E)&255;return r}function a2s(n){if(Array.isArray(n))return n.map(function(E){return String.fromCharCode(E)}).join("");for(var r=[],_=0;_<n.length;++_)r[_]=String.fromCharCode(n[_]);return r.join("")}function a2u(n){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(n)}function ab2a(n){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(n instanceof ArrayBuffer)return ab2a(new Uint8Array(n));for(var r=new Array(n.length),_=0;_<n.length;++_)r[_]=n[_];return r}var bconcat=has_buf?function(n){return Buffer.concat(n.map(function(r){return Buffer.isBuffer(r)?r:Buffer_from(r)}))}:function(n){if(typeof Uint8Array<"u"){var r=0,_=0;for(r=0;r<n.length;++r)_+=n[r].length;var E=new Uint8Array(_),S=0;for(r=0,_=0;r<n.length;_+=S,++r)S=n[r].length,n[r]instanceof Uint8Array?E.set(n[r],_):typeof n[r]=="string"?E.set(new Uint8Array(s2a(n[r])),_):E.set(new Uint8Array(n[r]),_);return E}return[].concat.apply([],n.map(function(C){return Array.isArray(C)?C:[].slice.call(C)}))};function utf8decode(n){for(var r=[],_=0,E=n.length+250,S=new_raw_buf(n.length+255),C=0;C<n.length;++C){var A=n.charCodeAt(C);if(A<128)S[_++]=A;else if(A<2048)S[_++]=192|A>>6&31,S[_++]=128|A&63;else if(A>=55296&&A<57344){A=(A&1023)+64;var I=n.charCodeAt(++C)&1023;S[_++]=240|A>>8&7,S[_++]=128|A>>2&63,S[_++]=128|I>>6&15|(A&3)<<4,S[_++]=128|I&63}else S[_++]=224|A>>12&15,S[_++]=128|A>>6&63,S[_++]=128|A&63;_>E&&(r.push(S.slice(0,_)),_=0,S=new_raw_buf(65535),E=65530)}return r.push(S.slice(0,_)),bconcat(r)}var chr0=/\u0000/g,chr1=/[\u0001-\u0006]/g;function _strrev(n){for(var r="",_=n.length-1;_>=0;)r+=n.charAt(_--);return r}function pad0(n,r){var _=""+n;return _.length>=r?_:fill("0",r-_.length)+_}function pad_(n,r){var _=""+n;return _.length>=r?_:fill(" ",r-_.length)+_}function rpad_(n,r){var _=""+n;return _.length>=r?_:_+fill(" ",r-_.length)}function pad0r1(n,r){var _=""+Math.round(n);return _.length>=r?_:fill("0",r-_.length)+_}function pad0r2(n,r){var _=""+n;return _.length>=r?_:fill("0",r-_.length)+_}var p2_32=Math.pow(2,32);function pad0r(n,r){if(n>p2_32||n<-p2_32)return pad0r1(n,r);var _=Math.round(n);return pad0r2(_,r)}function SSF_isgeneral(n,r){return r=r||0,n.length>=7+r&&(n.charCodeAt(r)|32)===103&&(n.charCodeAt(r+1)|32)===101&&(n.charCodeAt(r+2)|32)===110&&(n.charCodeAt(r+3)|32)===101&&(n.charCodeAt(r+4)|32)===114&&(n.charCodeAt(r+5)|32)===97&&(n.charCodeAt(r+6)|32)===108}var days=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],months=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function SSF_init_table(n){return n||(n={}),n[0]="General",n[1]="0",n[2]="0.00",n[3]="#,##0",n[4]="#,##0.00",n[9]="0%",n[10]="0.00%",n[11]="0.00E+00",n[12]="# ?/?",n[13]="# ??/??",n[14]="m/d/yy",n[15]="d-mmm-yy",n[16]="d-mmm",n[17]="mmm-yy",n[18]="h:mm AM/PM",n[19]="h:mm:ss AM/PM",n[20]="h:mm",n[21]="h:mm:ss",n[22]="m/d/yy h:mm",n[37]="#,##0 ;(#,##0)",n[38]="#,##0 ;[Red](#,##0)",n[39]="#,##0.00;(#,##0.00)",n[40]="#,##0.00;[Red](#,##0.00)",n[45]="mm:ss",n[46]="[h]:mm:ss",n[47]="mmss.0",n[48]="##0.0E+0",n[49]="@",n[56]='"/ "hh""mm""ss" "',n}var table_fmt={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},SSF_default_map={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},SSF_default_str={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function SSF_frac(n,r,_){for(var E=n<0?-1:1,S=n*E,C=0,A=1,I=0,B=1,O=0,N=0,U=Math.floor(S);O<r&&(U=Math.floor(S),I=U*A+C,N=U*O+B,!(S-U<5e-8));)S=1/(S-U),C=A,A=I,B=O,O=N;if(N>r&&(O>r?(N=B,I=C):(N=O,I=A)),!_)return[0,E*I,N];var j=Math.floor(E*I/N);return[j,E*I-j*N,N]}function SSF_parse_date_code(n,r,_){if(n>2958465||n<0)return null;var E=n|0,S=Math.floor(86400*(n-E)),C=0,A=[],I={D:E,T:S,u:86400*(n-E)-S,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(I.u)<1e-6&&(I.u=0),r&&r.date1904&&(E+=1462),I.u>.9999&&(I.u=0,++S==86400&&(I.T=S=0,++E,++I.D)),E===60)A=_?[1317,10,29]:[1900,2,29],C=3;else if(E===0)A=_?[1317,8,29]:[1900,1,0],C=6;else{E>60&&--E;var B=new Date(1900,0,1);B.setDate(B.getDate()+E-1),A=[B.getFullYear(),B.getMonth()+1,B.getDate()],C=B.getDay(),E<60&&(C=(C+6)%7),_&&(C=SSF_fix_hijri(B,A))}return I.y=A[0],I.m=A[1],I.d=A[2],I.S=S%60,S=Math.floor(S/60),I.M=S%60,S=Math.floor(S/60),I.H=S,I.q=C,I}var SSFbasedate=new Date(1899,11,31,0,0,0),SSFdnthresh=SSFbasedate.getTime(),SSFbase1904=new Date(1900,2,1,0,0,0);function datenum_local(n,r){var _=n.getTime();return r?_-=1461*24*60*60*1e3:n>=SSFbase1904&&(_+=24*60*60*1e3),(_-(SSFdnthresh+(n.getTimezoneOffset()-SSFbasedate.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function SSF_strip_decimal(n){return n.indexOf(".")==-1?n:n.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function SSF_normalize_exp(n){return n.indexOf("E")==-1?n:n.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function SSF_small_exp(n){var r=n<0?12:11,_=SSF_strip_decimal(n.toFixed(12));return _.length<=r||(_=n.toPrecision(10),_.length<=r)?_:n.toExponential(5)}function SSF_large_exp(n){var r=SSF_strip_decimal(n.toFixed(11));return r.length>(n<0?12:11)||r==="0"||r==="-0"?n.toPrecision(6):r}function SSF_general_num(n){var r=Math.floor(Math.log(Math.abs(n))*Math.LOG10E),_;return r>=-4&&r<=-1?_=n.toPrecision(10+r):Math.abs(r)<=9?_=SSF_small_exp(n):r===10?_=n.toFixed(10).substr(0,12):_=SSF_large_exp(n),SSF_strip_decimal(SSF_normalize_exp(_.toUpperCase()))}function SSF_general(n,r){switch(typeof n){case"string":return n;case"boolean":return n?"TRUE":"FALSE";case"number":return(n|0)===n?n.toString(10):SSF_general_num(n);case"undefined":return"";case"object":if(n==null)return"";if(n instanceof Date)return SSF_format(14,datenum_local(n,r&&r.date1904),r)}throw new Error("unsupported value in General format: "+n)}function SSF_fix_hijri(n,r){r[0]-=581;var _=n.getDay();return n<60&&(_=(_+6)%7),_}function SSF_write_date(n,r,_,E){var S="",C=0,A=0,I=_.y,B,O=0;switch(n){case 98:I=_.y+543;case 121:switch(r.length){case 1:case 2:B=I%100,O=2;break;default:B=I%1e4,O=4;break}break;case 109:switch(r.length){case 1:case 2:B=_.m,O=r.length;break;case 3:return months[_.m-1][1];case 5:return months[_.m-1][0];default:return months[_.m-1][2]}break;case 100:switch(r.length){case 1:case 2:B=_.d,O=r.length;break;case 3:return days[_.q][0];default:return days[_.q][1]}break;case 104:switch(r.length){case 1:case 2:B=1+(_.H+11)%12,O=r.length;break;default:throw"bad hour format: "+r}break;case 72:switch(r.length){case 1:case 2:B=_.H,O=r.length;break;default:throw"bad hour format: "+r}break;case 77:switch(r.length){case 1:case 2:B=_.M,O=r.length;break;default:throw"bad minute format: "+r}break;case 115:if(r!="s"&&r!="ss"&&r!=".0"&&r!=".00"&&r!=".000")throw"bad second format: "+r;return _.u===0&&(r=="s"||r=="ss")?pad0(_.S,r.length):(E>=2?A=E===3?1e3:100:A=E===1?10:1,C=Math.round(A*(_.S+_.u)),C>=60*A&&(C=0),r==="s"?C===0?"0":""+C/A:(S=pad0(C,2+E),r==="ss"?S.substr(0,2):"."+S.substr(2,r.length-1)));case 90:switch(r){case"[h]":case"[hh]":B=_.D*24+_.H;break;case"[m]":case"[mm]":B=(_.D*24+_.H)*60+_.M;break;case"[s]":case"[ss]":B=((_.D*24+_.H)*60+_.M)*60+Math.round(_.S+_.u);break;default:throw"bad abstime format: "+r}O=r.length===3?1:2;break;case 101:B=I,O=1;break}var N=O>0?pad0(B,O):"";return N}function commaify(n){var r=3;if(n.length<=r)return n;for(var _=n.length%r,E=n.substr(0,_);_!=n.length;_+=r)E+=(E.length>0?",":"")+n.substr(_,r);return E}var pct1=/%/g;function write_num_pct(n,r,_){var E=r.replace(pct1,""),S=r.length-E.length;return write_num(n,E,_*Math.pow(10,2*S))+fill("%",S)}function write_num_cm(n,r,_){for(var E=r.length-1;r.charCodeAt(E-1)===44;)--E;return write_num(n,r.substr(0,E),_/Math.pow(10,3*(r.length-E)))}function write_num_exp(n,r){var _,E=n.indexOf("E")-n.indexOf(".")-1;if(n.match(/^#+0.0E\+0$/)){if(r==0)return"0.0E+0";if(r<0)return"-"+write_num_exp(n,-r);var S=n.indexOf(".");S===-1&&(S=n.indexOf("E"));var C=Math.floor(Math.log(r)*Math.LOG10E)%S;if(C<0&&(C+=S),_=(r/Math.pow(10,C)).toPrecision(E+1+(S+C)%S),_.indexOf("e")===-1){var A=Math.floor(Math.log(r)*Math.LOG10E);for(_.indexOf(".")===-1?_=_.charAt(0)+"."+_.substr(1)+"E+"+(A-_.length+C):_+="E+"+(A-C);_.substr(0,2)==="0.";)_=_.charAt(0)+_.substr(2,S)+"."+_.substr(2+S),_=_.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");_=_.replace(/\+-/,"-")}_=_.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(I,B,O,N){return B+O+N.substr(0,(S+C)%S)+"."+N.substr(C)+"E"})}else _=r.toExponential(E);return n.match(/E\+00$/)&&_.match(/e[+-]\d$/)&&(_=_.substr(0,_.length-1)+"0"+_.charAt(_.length-1)),n.match(/E\-/)&&_.match(/e\+/)&&(_=_.replace(/e\+/,"e")),_.replace("e","E")}var frac1=/# (\?+)( ?)\/( ?)(\d+)/;function write_num_f1(n,r,_){var E=parseInt(n[4],10),S=Math.round(r*E),C=Math.floor(S/E),A=S-C*E,I=E;return _+(C===0?"":""+C)+" "+(A===0?fill(" ",n[1].length+1+n[4].length):pad_(A,n[1].length)+n[2]+"/"+n[3]+pad0(I,n[4].length))}function write_num_f2(n,r,_){return _+(r===0?"":""+r)+fill(" ",n[1].length+2+n[4].length)}var dec1=/^#*0*\.([0#]+)/,closeparen=/\).*[0#]/,phone=/\(###\) ###\\?-####/;function hashq(n){for(var r="",_,E=0;E!=n.length;++E)switch(_=n.charCodeAt(E)){case 35:break;case 63:r+=" ";break;case 48:r+="0";break;default:r+=String.fromCharCode(_)}return r}function rnd(n,r){var _=Math.pow(10,r);return""+Math.round(n*_)/_}function dec(n,r){var _=n-Math.floor(n),E=Math.pow(10,r);return r<(""+Math.round(_*E)).length?0:Math.round(_*E)}function carry(n,r){return r<(""+Math.round((n-Math.floor(n))*Math.pow(10,r))).length?1:0}function flr(n){return n<2147483647&&n>-2147483648?""+(n>=0?n|0:n-1|0):""+Math.floor(n)}function write_num_flt(n,r,_){if(n.charCodeAt(0)===40&&!r.match(closeparen)){var E=r.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return _>=0?write_num_flt("n",E,_):"("+write_num_flt("n",E,-_)+")"}if(r.charCodeAt(r.length-1)===44)return write_num_cm(n,r,_);if(r.indexOf("%")!==-1)return write_num_pct(n,r,_);if(r.indexOf("E")!==-1)return write_num_exp(r,_);if(r.charCodeAt(0)===36)return"$"+write_num_flt(n,r.substr(r.charAt(1)==" "?2:1),_);var S,C,A,I,B=Math.abs(_),O=_<0?"-":"";if(r.match(/^00+$/))return O+pad0r(B,r.length);if(r.match(/^[#?]+$/))return S=pad0r(_,0),S==="0"&&(S=""),S.length>r.length?S:hashq(r.substr(0,r.length-S.length))+S;if(C=r.match(frac1))return write_num_f1(C,B,O);if(r.match(/^#+0+$/))return O+pad0r(B,r.length-r.indexOf("0"));if(C=r.match(dec1))return S=rnd(_,C[1].length).replace(/^([^\.]+)$/,"$1."+hashq(C[1])).replace(/\.$/,"."+hashq(C[1])).replace(/\.(\d*)$/,function(Z,X){return"."+X+fill("0",hashq(C[1]).length-X.length)}),r.indexOf("0.")!==-1?S:S.replace(/^0\./,".");if(r=r.replace(/^#+([0.])/,"$1"),C=r.match(/^(0*)\.(#*)$/))return O+rnd(B,C[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,C[1].length?"0.":".");if(C=r.match(/^#{1,3},##0(\.?)$/))return O+commaify(pad0r(B,0));if(C=r.match(/^#,##0\.([#0]*0)$/))return _<0?"-"+write_num_flt(n,r,-_):commaify(""+(Math.floor(_)+carry(_,C[1].length)))+"."+pad0(dec(_,C[1].length),C[1].length);if(C=r.match(/^#,#*,#0/))return write_num_flt(n,r.replace(/^#,#*,/,""),_);if(C=r.match(/^([0#]+)(\\?-([0#]+))+$/))return S=_strrev(write_num_flt(n,r.replace(/[\\-]/g,""),_)),A=0,_strrev(_strrev(r.replace(/\\/g,"")).replace(/[0#]/g,function(Z){return A<S.length?S.charAt(A++):Z==="0"?"0":""}));if(r.match(phone))return S=write_num_flt(n,"##########",_),"("+S.substr(0,3)+") "+S.substr(3,3)+"-"+S.substr(6);var N="";if(C=r.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return A=Math.min(C[4].length,7),I=SSF_frac(B,Math.pow(10,A)-1,!1),S=""+O,N=write_num("n",C[1],I[1]),N.charAt(N.length-1)==" "&&(N=N.substr(0,N.length-1)+"0"),S+=N+C[2]+"/"+C[3],N=rpad_(I[2],A),N.length<C[4].length&&(N=hashq(C[4].substr(C[4].length-N.length))+N),S+=N,S;if(C=r.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return A=Math.min(Math.max(C[1].length,C[4].length),7),I=SSF_frac(B,Math.pow(10,A)-1,!0),O+(I[0]||(I[1]?"":"0"))+" "+(I[1]?pad_(I[1],A)+C[2]+"/"+C[3]+rpad_(I[2],A):fill(" ",2*A+1+C[2].length+C[3].length));if(C=r.match(/^[#0?]+$/))return S=pad0r(_,0),r.length<=S.length?S:hashq(r.substr(0,r.length-S.length))+S;if(C=r.match(/^([#0?]+)\.([#0]+)$/)){S=""+_.toFixed(Math.min(C[2].length,10)).replace(/([^0])0+$/,"$1"),A=S.indexOf(".");var U=r.indexOf(".")-A,j=r.length-S.length-U;return hashq(r.substr(0,U)+S+r.substr(r.length-j))}if(C=r.match(/^00,000\.([#0]*0)$/))return A=dec(_,C[1].length),_<0?"-"+write_num_flt(n,r,-_):commaify(flr(_)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(Z){return"00,"+(Z.length<3?pad0(0,3-Z.length):"")+Z})+"."+pad0(A,C[1].length);switch(r){case"###,##0.00":return write_num_flt(n,"#,##0.00",_);case"###,###":case"##,###":case"#,###":var z=commaify(pad0r(B,0));return z!=="0"?O+z:"";case"###,###.00":return write_num_flt(n,"###,##0.00",_).replace(/^0\./,".");case"#,###.00":return write_num_flt(n,"#,##0.00",_).replace(/^0\./,".")}throw new Error("unsupported format |"+r+"|")}function write_num_cm2(n,r,_){for(var E=r.length-1;r.charCodeAt(E-1)===44;)--E;return write_num(n,r.substr(0,E),_/Math.pow(10,3*(r.length-E)))}function write_num_pct2(n,r,_){var E=r.replace(pct1,""),S=r.length-E.length;return write_num(n,E,_*Math.pow(10,2*S))+fill("%",S)}function write_num_exp2(n,r){var _,E=n.indexOf("E")-n.indexOf(".")-1;if(n.match(/^#+0.0E\+0$/)){if(r==0)return"0.0E+0";if(r<0)return"-"+write_num_exp2(n,-r);var S=n.indexOf(".");S===-1&&(S=n.indexOf("E"));var C=Math.floor(Math.log(r)*Math.LOG10E)%S;if(C<0&&(C+=S),_=(r/Math.pow(10,C)).toPrecision(E+1+(S+C)%S),!_.match(/[Ee]/)){var A=Math.floor(Math.log(r)*Math.LOG10E);_.indexOf(".")===-1?_=_.charAt(0)+"."+_.substr(1)+"E+"+(A-_.length+C):_+="E+"+(A-C),_=_.replace(/\+-/,"-")}_=_.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(I,B,O,N){return B+O+N.substr(0,(S+C)%S)+"."+N.substr(C)+"E"})}else _=r.toExponential(E);return n.match(/E\+00$/)&&_.match(/e[+-]\d$/)&&(_=_.substr(0,_.length-1)+"0"+_.charAt(_.length-1)),n.match(/E\-/)&&_.match(/e\+/)&&(_=_.replace(/e\+/,"e")),_.replace("e","E")}function write_num_int(n,r,_){if(n.charCodeAt(0)===40&&!r.match(closeparen)){var E=r.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return _>=0?write_num_int("n",E,_):"("+write_num_int("n",E,-_)+")"}if(r.charCodeAt(r.length-1)===44)return write_num_cm2(n,r,_);if(r.indexOf("%")!==-1)return write_num_pct2(n,r,_);if(r.indexOf("E")!==-1)return write_num_exp2(r,_);if(r.charCodeAt(0)===36)return"$"+write_num_int(n,r.substr(r.charAt(1)==" "?2:1),_);var S,C,A,I,B=Math.abs(_),O=_<0?"-":"";if(r.match(/^00+$/))return O+pad0(B,r.length);if(r.match(/^[#?]+$/))return S=""+_,_===0&&(S=""),S.length>r.length?S:hashq(r.substr(0,r.length-S.length))+S;if(C=r.match(frac1))return write_num_f2(C,B,O);if(r.match(/^#+0+$/))return O+pad0(B,r.length-r.indexOf("0"));if(C=r.match(dec1))return S=(""+_).replace(/^([^\.]+)$/,"$1."+hashq(C[1])).replace(/\.$/,"."+hashq(C[1])),S=S.replace(/\.(\d*)$/,function(Z,X){return"."+X+fill("0",hashq(C[1]).length-X.length)}),r.indexOf("0.")!==-1?S:S.replace(/^0\./,".");if(r=r.replace(/^#+([0.])/,"$1"),C=r.match(/^(0*)\.(#*)$/))return O+(""+B).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,C[1].length?"0.":".");if(C=r.match(/^#{1,3},##0(\.?)$/))return O+commaify(""+B);if(C=r.match(/^#,##0\.([#0]*0)$/))return _<0?"-"+write_num_int(n,r,-_):commaify(""+_)+"."+fill("0",C[1].length);if(C=r.match(/^#,#*,#0/))return write_num_int(n,r.replace(/^#,#*,/,""),_);if(C=r.match(/^([0#]+)(\\?-([0#]+))+$/))return S=_strrev(write_num_int(n,r.replace(/[\\-]/g,""),_)),A=0,_strrev(_strrev(r.replace(/\\/g,"")).replace(/[0#]/g,function(Z){return A<S.length?S.charAt(A++):Z==="0"?"0":""}));if(r.match(phone))return S=write_num_int(n,"##########",_),"("+S.substr(0,3)+") "+S.substr(3,3)+"-"+S.substr(6);var N="";if(C=r.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return A=Math.min(C[4].length,7),I=SSF_frac(B,Math.pow(10,A)-1,!1),S=""+O,N=write_num("n",C[1],I[1]),N.charAt(N.length-1)==" "&&(N=N.substr(0,N.length-1)+"0"),S+=N+C[2]+"/"+C[3],N=rpad_(I[2],A),N.length<C[4].length&&(N=hashq(C[4].substr(C[4].length-N.length))+N),S+=N,S;if(C=r.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return A=Math.min(Math.max(C[1].length,C[4].length),7),I=SSF_frac(B,Math.pow(10,A)-1,!0),O+(I[0]||(I[1]?"":"0"))+" "+(I[1]?pad_(I[1],A)+C[2]+"/"+C[3]+rpad_(I[2],A):fill(" ",2*A+1+C[2].length+C[3].length));if(C=r.match(/^[#0?]+$/))return S=""+_,r.length<=S.length?S:hashq(r.substr(0,r.length-S.length))+S;if(C=r.match(/^([#0]+)\.([#0]+)$/)){S=""+_.toFixed(Math.min(C[2].length,10)).replace(/([^0])0+$/,"$1"),A=S.indexOf(".");var U=r.indexOf(".")-A,j=r.length-S.length-U;return hashq(r.substr(0,U)+S+r.substr(r.length-j))}if(C=r.match(/^00,000\.([#0]*0)$/))return _<0?"-"+write_num_int(n,r,-_):commaify(""+_).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(Z){return"00,"+(Z.length<3?pad0(0,3-Z.length):"")+Z})+"."+pad0(0,C[1].length);switch(r){case"###,###":case"##,###":case"#,###":var z=commaify(""+B);return z!=="0"?O+z:"";default:if(r.match(/\.[0#?]*$/))return write_num_int(n,r.slice(0,r.lastIndexOf(".")),_)+hashq(r.slice(r.lastIndexOf(".")))}throw new Error("unsupported format |"+r+"|")}function write_num(n,r,_){return(_|0)===_?write_num_int(n,r,_):write_num_flt(n,r,_)}function SSF_split_fmt(n){for(var r=[],_=!1,E=0,S=0;E<n.length;++E)switch(n.charCodeAt(E)){case 34:_=!_;break;case 95:case 42:case 92:++E;break;case 59:r[r.length]=n.substr(S,E-S),S=E+1}if(r[r.length]=n.substr(S),_===!0)throw new Error("Format |"+n+"| unterminated string ");return r}var SSF_abstime=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function fmt_is_date(n){for(var r=0,_="",E="";r<n.length;)switch(_=n.charAt(r)){case"G":SSF_isgeneral(n,r)&&(r+=6),r++;break;case'"':for(;n.charCodeAt(++r)!==34&&r<n.length;);++r;break;case"\\":r+=2;break;case"_":r+=2;break;case"@":++r;break;case"B":case"b":if(n.charAt(r+1)==="1"||n.charAt(r+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(n.substr(r,3).toUpperCase()==="A/P"||n.substr(r,5).toUpperCase()==="AM/PM"||n.substr(r,5).toUpperCase()==="/")return!0;++r;break;case"[":for(E=_;n.charAt(r++)!=="]"&&r<n.length;)E+=n.charAt(r);if(E.match(SSF_abstime))return!0;break;case".":case"0":case"#":for(;r<n.length&&("0#?.,E+-%".indexOf(_=n.charAt(++r))>-1||_=="\\"&&n.charAt(r+1)=="-"&&"0#".indexOf(n.charAt(r+2))>-1););break;case"?":for(;n.charAt(++r)===_;);break;case"*":++r,(n.charAt(r)==" "||n.charAt(r)=="*")&&++r;break;case"(":case")":++r;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;r<n.length&&"0123456789".indexOf(n.charAt(++r))>-1;);break;case" ":++r;break;default:++r;break}return!1}function eval_fmt(n,r,_,E){for(var S=[],C="",A=0,I="",B="t",O,N,U,j="H";A<n.length;)switch(I=n.charAt(A)){case"G":if(!SSF_isgeneral(n,A))throw new Error("unrecognized character "+I+" in "+n);S[S.length]={t:"G",v:"General"},A+=7;break;case'"':for(C="";(U=n.charCodeAt(++A))!==34&&A<n.length;)C+=String.fromCharCode(U);S[S.length]={t:"t",v:C},++A;break;case"\\":var z=n.charAt(++A),Z=z==="("||z===")"?z:"t";S[S.length]={t:Z,v:z},++A;break;case"_":S[S.length]={t:"t",v:" "},A+=2;break;case"@":S[S.length]={t:"T",v:r},++A;break;case"B":case"b":if(n.charAt(A+1)==="1"||n.charAt(A+1)==="2"){if(O==null&&(O=SSF_parse_date_code(r,_,n.charAt(A+1)==="2"),O==null))return"";S[S.length]={t:"X",v:n.substr(A,2)},B=I,A+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":I=I.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(r<0||O==null&&(O=SSF_parse_date_code(r,_),O==null))return"";for(C=I;++A<n.length&&n.charAt(A).toLowerCase()===I;)C+=I;I==="m"&&B.toLowerCase()==="h"&&(I="M"),I==="h"&&(I=j),S[S.length]={t:I,v:C},B=I;break;case"A":case"a":case"":var X={t:I,v:I};if(O==null&&(O=SSF_parse_date_code(r,_)),n.substr(A,3).toUpperCase()==="A/P"?(O!=null&&(X.v=O.H>=12?n.charAt(A+2):I),X.t="T",j="h",A+=3):n.substr(A,5).toUpperCase()==="AM/PM"?(O!=null&&(X.v=O.H>=12?"PM":"AM"),X.t="T",A+=5,j="h"):n.substr(A,5).toUpperCase()==="/"?(O!=null&&(X.v=O.H>=12?"":""),X.t="T",A+=5,j="h"):(X.t="t",++A),O==null&&X.t==="T")return"";S[S.length]=X,B=I;break;case"[":for(C=I;n.charAt(A++)!=="]"&&A<n.length;)C+=n.charAt(A);if(C.slice(-1)!=="]")throw'unterminated "[" block: |'+C+"|";if(C.match(SSF_abstime)){if(O==null&&(O=SSF_parse_date_code(r,_),O==null))return"";S[S.length]={t:"Z",v:C.toLowerCase()},B=C.charAt(1)}else C.indexOf("$")>-1&&(C=(C.match(/\$([^-\[\]]*)/)||[])[1]||"$",fmt_is_date(n)||(S[S.length]={t:"t",v:C}));break;case".":if(O!=null){for(C=I;++A<n.length&&(I=n.charAt(A))==="0";)C+=I;S[S.length]={t:"s",v:C};break}case"0":case"#":for(C=I;++A<n.length&&"0#?.,E+-%".indexOf(I=n.charAt(A))>-1;)C+=I;S[S.length]={t:"n",v:C};break;case"?":for(C=I;n.charAt(++A)===I;)C+=I;S[S.length]={t:I,v:C},B=I;break;case"*":++A,(n.charAt(A)==" "||n.charAt(A)=="*")&&++A;break;case"(":case")":S[S.length]={t:E===1?"t":I,v:I},++A;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(C=I;A<n.length&&"0123456789".indexOf(n.charAt(++A))>-1;)C+=n.charAt(A);S[S.length]={t:"D",v:C};break;case" ":S[S.length]={t:I,v:I},++A;break;case"$":S[S.length]={t:"t",v:"$"},++A;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(I)===-1)throw new Error("unrecognized character "+I+" in "+n);S[S.length]={t:"t",v:I},++A;break}var Q=0,se=0,oe;for(A=S.length-1,B="t";A>=0;--A)switch(S[A].t){case"h":case"H":S[A].t=j,B="h",Q<1&&(Q=1);break;case"s":(oe=S[A].v.match(/\.0+$/))&&(se=Math.max(se,oe[0].length-1)),Q<3&&(Q=3);case"d":case"y":case"M":case"e":B=S[A].t;break;case"m":B==="s"&&(S[A].t="M",Q<2&&(Q=2));break;case"X":break;case"Z":Q<1&&S[A].v.match(/[Hh]/)&&(Q=1),Q<2&&S[A].v.match(/[Mm]/)&&(Q=2),Q<3&&S[A].v.match(/[Ss]/)&&(Q=3)}switch(Q){case 0:break;case 1:O.u>=.5&&(O.u=0,++O.S),O.S>=60&&(O.S=0,++O.M),O.M>=60&&(O.M=0,++O.H);break;case 2:O.u>=.5&&(O.u=0,++O.S),O.S>=60&&(O.S=0,++O.M);break}var ue="",we;for(A=0;A<S.length;++A)switch(S[A].t){case"t":case"T":case" ":case"D":break;case"X":S[A].v="",S[A].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":S[A].v=SSF_write_date(S[A].t.charCodeAt(0),S[A].v,O,se),S[A].t="t";break;case"n":case"?":for(we=A+1;S[we]!=null&&((I=S[we].t)==="?"||I==="D"||(I===" "||I==="t")&&S[we+1]!=null&&(S[we+1].t==="?"||S[we+1].t==="t"&&S[we+1].v==="/")||S[A].t==="("&&(I===" "||I==="n"||I===")")||I==="t"&&(S[we].v==="/"||S[we].v===" "&&S[we+1]!=null&&S[we+1].t=="?"));)S[A].v+=S[we].v,S[we]={v:"",t:";"},++we;ue+=S[A].v,A=we-1;break;case"G":S[A].t="t",S[A].v=SSF_general(r,_);break}var Te="",xe,Re;if(ue.length>0){ue.charCodeAt(0)==40?(xe=r<0&&ue.charCodeAt(0)===45?-r:r,Re=write_num("n",ue,xe)):(xe=r<0&&E>1?-r:r,Re=write_num("n",ue,xe),xe<0&&S[0]&&S[0].t=="t"&&(Re=Re.substr(1),S[0].v="-"+S[0].v)),we=Re.length-1;var Ne=S.length;for(A=0;A<S.length;++A)if(S[A]!=null&&S[A].t!="t"&&S[A].v.indexOf(".")>-1){Ne=A;break}var Fe=S.length;if(Ne===S.length&&Re.indexOf("E")===-1){for(A=S.length-1;A>=0;--A)S[A]==null||"n?".indexOf(S[A].t)===-1||(we>=S[A].v.length-1?(we-=S[A].v.length,S[A].v=Re.substr(we+1,S[A].v.length)):we<0?S[A].v="":(S[A].v=Re.substr(0,we+1),we=-1),S[A].t="t",Fe=A);we>=0&&Fe<S.length&&(S[Fe].v=Re.substr(0,we+1)+S[Fe].v)}else if(Ne!==S.length&&Re.indexOf("E")===-1){for(we=Re.indexOf(".")-1,A=Ne;A>=0;--A)if(!(S[A]==null||"n?".indexOf(S[A].t)===-1)){for(N=S[A].v.indexOf(".")>-1&&A===Ne?S[A].v.indexOf(".")-1:S[A].v.length-1,Te=S[A].v.substr(N+1);N>=0;--N)we>=0&&(S[A].v.charAt(N)==="0"||S[A].v.charAt(N)==="#")&&(Te=Re.charAt(we--)+Te);S[A].v=Te,S[A].t="t",Fe=A}for(we>=0&&Fe<S.length&&(S[Fe].v=Re.substr(0,we+1)+S[Fe].v),we=Re.indexOf(".")+1,A=Ne;A<S.length;++A)if(!(S[A]==null||"n?(".indexOf(S[A].t)===-1&&A!==Ne)){for(N=S[A].v.indexOf(".")>-1&&A===Ne?S[A].v.indexOf(".")+1:0,Te=S[A].v.substr(0,N);N<S[A].v.length;++N)we<Re.length&&(Te+=Re.charAt(we++));S[A].v=Te,S[A].t="t",Fe=A}}}for(A=0;A<S.length;++A)S[A]!=null&&"n?".indexOf(S[A].t)>-1&&(xe=E>1&&r<0&&A>0&&S[A-1].v==="-"?-r:r,S[A].v=write_num(S[A].t,S[A].v,xe),S[A].t="t");var ht="";for(A=0;A!==S.length;++A)S[A]!=null&&(ht+=S[A].v);return ht}var cfregex2=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function chkcond(n,r){if(r==null)return!1;var _=parseFloat(r[2]);switch(r[1]){case"=":if(n==_)return!0;break;case">":if(n>_)return!0;break;case"<":if(n<_)return!0;break;case"<>":if(n!=_)return!0;break;case">=":if(n>=_)return!0;break;case"<=":if(n<=_)return!0;break}return!1}function choose_fmt(n,r){var _=SSF_split_fmt(n),E=_.length,S=_[E-1].indexOf("@");if(E<4&&S>-1&&--E,_.length>4)throw new Error("cannot find right format for |"+_.join("|")+"|");if(typeof r!="number")return[4,_.length===4||S>-1?_[_.length-1]:"@"];switch(_.length){case 1:_=S>-1?["General","General","General",_[0]]:[_[0],_[0],_[0],"@"];break;case 2:_=S>-1?[_[0],_[0],_[0],_[1]]:[_[0],_[1],_[0],"@"];break;case 3:_=S>-1?[_[0],_[1],_[0],_[2]]:[_[0],_[1],_[2],"@"];break}var C=r>0?_[0]:r<0?_[1]:_[2];if(_[0].indexOf("[")===-1&&_[1].indexOf("[")===-1)return[E,C];if(_[0].match(/\[[=<>]/)!=null||_[1].match(/\[[=<>]/)!=null){var A=_[0].match(cfregex2),I=_[1].match(cfregex2);return chkcond(r,A)?[E,_[0]]:chkcond(r,I)?[E,_[1]]:[E,_[A!=null&&I!=null?2:1]]}return[E,C]}function SSF_format(n,r,_){_==null&&(_={});var E="";switch(typeof n){case"string":n=="m/d/yy"&&_.dateNF?E=_.dateNF:E=n;break;case"number":n==14&&_.dateNF?E=_.dateNF:E=(_.table!=null?_.table:table_fmt)[n],E==null&&(E=_.table&&_.table[SSF_default_map[n]]||table_fmt[SSF_default_map[n]]),E==null&&(E=SSF_default_str[n]||"General");break}if(SSF_isgeneral(E,0))return SSF_general(r,_);r instanceof Date&&(r=datenum_local(r,_.date1904));var S=choose_fmt(E,r);if(SSF_isgeneral(S[1]))return SSF_general(r,_);if(r===!0)r="TRUE";else if(r===!1)r="FALSE";else if(r===""||r==null)return"";return eval_fmt(S[1],r,_,S[0])}function SSF_load(n,r){if(typeof r!="number"){r=+r||-1;for(var _=0;_<392;++_){if(table_fmt[_]==null){r<0&&(r=_);continue}if(table_fmt[_]==n){r=_;break}}r<0&&(r=391)}return table_fmt[r]=n,r}function SSF_load_table(n){for(var r=0;r!=392;++r)n[r]!==void 0&&SSF_load(n[r],r)}function make_ssf(){table_fmt=SSF_init_table()}var SSFImplicit={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},dateNFregex=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function dateNF_regex(n){var r=typeof n=="number"?table_fmt[n]:n;return r=r.replace(dateNFregex,"(\\d+)"),new RegExp("^"+r+"$")}function dateNF_fix(n,r,_){var E=-1,S=-1,C=-1,A=-1,I=-1,B=-1;(r.match(dateNFregex)||[]).forEach(function(U,j){var z=parseInt(_[j+1],10);switch(U.toLowerCase().charAt(0)){case"y":E=z;break;case"d":C=z;break;case"h":A=z;break;case"s":B=z;break;case"m":A>=0?I=z:S=z;break}}),B>=0&&I==-1&&S>=0&&(I=S,S=-1);var O=(""+(E>=0?E:new Date().getFullYear())).slice(-4)+"-"+("00"+(S>=1?S:1)).slice(-2)+"-"+("00"+(C>=1?C:1)).slice(-2);O.length==7&&(O="0"+O),O.length==8&&(O="20"+O);var N=("00"+(A>=0?A:0)).slice(-2)+":"+("00"+(I>=0?I:0)).slice(-2)+":"+("00"+(B>=0?B:0)).slice(-2);return A==-1&&I==-1&&B==-1?O:E==-1&&S==-1&&C==-1?N:O+"T"+N}var bad_formats={"d.m":"d\\.m"};function SSF__load(n,r){return SSF_load(bad_formats[n]||n,r)}var CRC32=function(){var n={};n.version="1.2.0";function r(){for(var Re=0,Ne=new Array(256),Fe=0;Fe!=256;++Fe)Re=Fe,Re=Re&1?-306674912^Re>>>1:Re>>>1,Re=Re&1?-306674912^Re>>>1:Re>>>1,Re=Re&1?-306674912^Re>>>1:Re>>>1,Re=Re&1?-306674912^Re>>>1:Re>>>1,Re=Re&1?-306674912^Re>>>1:Re>>>1,Re=Re&1?-306674912^Re>>>1:Re>>>1,Re=Re&1?-306674912^Re>>>1:Re>>>1,Re=Re&1?-306674912^Re>>>1:Re>>>1,Ne[Fe]=Re;return typeof Int32Array<"u"?new Int32Array(Ne):Ne}var _=r();function E(Re){var Ne=0,Fe=0,ht=0,nt=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(ht=0;ht!=256;++ht)nt[ht]=Re[ht];for(ht=0;ht!=256;++ht)for(Fe=Re[ht],Ne=256+ht;Ne<4096;Ne+=256)Fe=nt[Ne]=Fe>>>8^Re[Fe&255];var Ee=[];for(ht=1;ht!=16;++ht)Ee[ht-1]=typeof Int32Array<"u"?nt.subarray(ht*256,ht*256+256):nt.slice(ht*256,ht*256+256);return Ee}var S=E(_),C=S[0],A=S[1],I=S[2],B=S[3],O=S[4],N=S[5],U=S[6],j=S[7],z=S[8],Z=S[9],X=S[10],Q=S[11],se=S[12],oe=S[13],ue=S[14];function we(Re,Ne){for(var Fe=Ne^-1,ht=0,nt=Re.length;ht<nt;)Fe=Fe>>>8^_[(Fe^Re.charCodeAt(ht++))&255];return~Fe}function Te(Re,Ne){for(var Fe=Ne^-1,ht=Re.length-15,nt=0;nt<ht;)Fe=ue[Re[nt++]^Fe&255]^oe[Re[nt++]^Fe>>8&255]^se[Re[nt++]^Fe>>16&255]^Q[Re[nt++]^Fe>>>24]^X[Re[nt++]]^Z[Re[nt++]]^z[Re[nt++]]^j[Re[nt++]]^U[Re[nt++]]^N[Re[nt++]]^O[Re[nt++]]^B[Re[nt++]]^I[Re[nt++]]^A[Re[nt++]]^C[Re[nt++]]^_[Re[nt++]];for(ht+=15;nt<ht;)Fe=Fe>>>8^_[(Fe^Re[nt++])&255];return~Fe}function xe(Re,Ne){for(var Fe=Ne^-1,ht=0,nt=Re.length,Ee=0,Ce=0;ht<nt;)Ee=Re.charCodeAt(ht++),Ee<128?Fe=Fe>>>8^_[(Fe^Ee)&255]:Ee<2048?(Fe=Fe>>>8^_[(Fe^(192|Ee>>6&31))&255],Fe=Fe>>>8^_[(Fe^(128|Ee&63))&255]):Ee>=55296&&Ee<57344?(Ee=(Ee&1023)+64,Ce=Re.charCodeAt(ht++)&1023,Fe=Fe>>>8^_[(Fe^(240|Ee>>8&7))&255],Fe=Fe>>>8^_[(Fe^(128|Ee>>2&63))&255],Fe=Fe>>>8^_[(Fe^(128|Ce>>6&15|(Ee&3)<<4))&255],Fe=Fe>>>8^_[(Fe^(128|Ce&63))&255]):(Fe=Fe>>>8^_[(Fe^(224|Ee>>12&15))&255],Fe=Fe>>>8^_[(Fe^(128|Ee>>6&63))&255],Fe=Fe>>>8^_[(Fe^(128|Ee&63))&255]);return~Fe}return n.table=_,n.bstr=we,n.buf=Te,n.str=xe,n}(),CFB=function(){var r={};r.version="1.2.2";function _(wt,Rt){for(var Tt=wt.split("/"),Dt=Rt.split("/"),Ot=0,Vt=0,Jt=Math.min(Tt.length,Dt.length);Ot<Jt;++Ot){if(Vt=Tt[Ot].length-Dt[Ot].length)return Vt;if(Tt[Ot]!=Dt[Ot])return Tt[Ot]<Dt[Ot]?-1:1}return Tt.length-Dt.length}function E(wt){if(wt.charAt(wt.length-1)=="/")return wt.slice(0,-1).indexOf("/")===-1?wt:E(wt.slice(0,-1));var Rt=wt.lastIndexOf("/");return Rt===-1?wt:wt.slice(0,Rt+1)}function S(wt){if(wt.charAt(wt.length-1)=="/")return S(wt.slice(0,-1));var Rt=wt.lastIndexOf("/");return Rt===-1?wt:wt.slice(Rt+1)}function C(wt,Rt){typeof Rt=="string"&&(Rt=new Date(Rt));var Tt=Rt.getHours();Tt=Tt<<6|Rt.getMinutes(),Tt=Tt<<5|Rt.getSeconds()>>>1,wt.write_shift(2,Tt);var Dt=Rt.getFullYear()-1980;Dt=Dt<<4|Rt.getMonth()+1,Dt=Dt<<5|Rt.getDate(),wt.write_shift(2,Dt)}function A(wt){var Rt=wt.read_shift(2)&65535,Tt=wt.read_shift(2)&65535,Dt=new Date,Ot=Tt&31;Tt>>>=5;var Vt=Tt&15;Tt>>>=4,Dt.setMilliseconds(0),Dt.setFullYear(Tt+1980),Dt.setMonth(Vt-1),Dt.setDate(Ot);var Jt=Rt&31;Rt>>>=5;var lr=Rt&63;return Rt>>>=6,Dt.setHours(Rt),Dt.setMinutes(lr),Dt.setSeconds(Jt<<1),Dt}function I(wt){prep_blob(wt,0);for(var Rt={},Tt=0;wt.l<=wt.length-4;){var Dt=wt.read_shift(2),Ot=wt.read_shift(2),Vt=wt.l+Ot,Jt={};switch(Dt){case 21589:Tt=wt.read_shift(1),Tt&1&&(Jt.mtime=wt.read_shift(4)),Ot>5&&(Tt&2&&(Jt.atime=wt.read_shift(4)),Tt&4&&(Jt.ctime=wt.read_shift(4))),Jt.mtime&&(Jt.mt=new Date(Jt.mtime*1e3));break;case 1:{var lr=wt.read_shift(4),tr=wt.read_shift(4);Jt.usz=tr*Math.pow(2,32)+lr,lr=wt.read_shift(4),tr=wt.read_shift(4),Jt.csz=tr*Math.pow(2,32)+lr}break}wt.l=Vt,Rt[Dt]=Jt}return Rt}var B;function O(){return B||(B=_fs)}function N(wt,Rt){if(wt[0]==80&&wt[1]==75)return tn(wt,Rt);if((wt[0]|32)==109&&(wt[1]|32)==105)return ln(wt,Rt);if(wt.length<512)throw new Error("CFB file size "+wt.length+" < 512");var Tt=3,Dt=512,Ot=0,Vt=0,Jt=0,lr=0,tr=0,ir=[],sr=wt.slice(0,512);prep_blob(sr,0);var dr=U(sr);switch(Tt=dr[0],Tt){case 3:Dt=512;break;case 4:Dt=4096;break;case 0:if(dr[1]==0)return tn(wt,Rt);default:throw new Error("Major Version: Expected 3 or 4 saw "+Tt)}Dt!==512&&(sr=wt.slice(0,Dt),prep_blob(sr,28));var yr=wt.slice(0,Dt);j(sr,Tt);var Er=sr.read_shift(4,"i");if(Tt===3&&Er!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Er);sr.l+=4,Jt=sr.read_shift(4,"i"),sr.l+=4,sr.chk("00100000","Mini Stream Cutoff Size: "),lr=sr.read_shift(4,"i"),Ot=sr.read_shift(4,"i"),tr=sr.read_shift(4,"i"),Vt=sr.read_shift(4,"i");for(var pr=-1,_r=0;_r<109&&(pr=sr.read_shift(4,"i"),!(pr<0));++_r)ir[_r]=pr;var Ar=z(wt,Dt);Q(tr,Vt,Ar,Dt,ir);var Ur=oe(Ar,Jt,ir,Dt);Jt<Ur.length&&(Ur[Jt].name="!Directory"),Ot>0&&lr!==Ce&&(Ur[lr].name="!MiniFAT"),Ur[ir[0]].name="!FAT",Ur.fat_addrs=ir,Ur.ssz=Dt;var Hr={},Yr=[],dn=[],pn=[];ue(Jt,Ur,Ar,Yr,Ot,Hr,dn,lr),Z(dn,pn,Yr),Yr.shift();var wn={FileIndex:dn,FullPaths:pn};return Rt&&Rt.raw&&(wn.raw={header:yr,sectors:Ar}),wn}function U(wt){if(wt[wt.l]==80&&wt[wt.l+1]==75)return[0,0];wt.chk(_e,"Header Signature: "),wt.l+=16;var Rt=wt.read_shift(2,"u");return[wt.read_shift(2,"u"),Rt]}function j(wt,Rt){var Tt=9;switch(wt.l+=2,Tt=wt.read_shift(2)){case 9:if(Rt!=3)throw new Error("Sector Shift: Expected 9 saw "+Tt);break;case 12:if(Rt!=4)throw new Error("Sector Shift: Expected 12 saw "+Tt);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+Tt)}wt.chk("0600","Mini Sector Shift: "),wt.chk("000000000000","Reserved: ")}function z(wt,Rt){for(var Tt=Math.ceil(wt.length/Rt)-1,Dt=[],Ot=1;Ot<Tt;++Ot)Dt[Ot-1]=wt.slice(Ot*Rt,(Ot+1)*Rt);return Dt[Tt-1]=wt.slice(Tt*Rt),Dt}function Z(wt,Rt,Tt){for(var Dt=0,Ot=0,Vt=0,Jt=0,lr=0,tr=Tt.length,ir=[],sr=[];Dt<tr;++Dt)ir[Dt]=sr[Dt]=Dt,Rt[Dt]=Tt[Dt];for(;lr<sr.length;++lr)Dt=sr[lr],Ot=wt[Dt].L,Vt=wt[Dt].R,Jt=wt[Dt].C,ir[Dt]===Dt&&(Ot!==-1&&ir[Ot]!==Ot&&(ir[Dt]=ir[Ot]),Vt!==-1&&ir[Vt]!==Vt&&(ir[Dt]=ir[Vt])),Jt!==-1&&(ir[Jt]=Dt),Ot!==-1&&Dt!=ir[Dt]&&(ir[Ot]=ir[Dt],sr.lastIndexOf(Ot)<lr&&sr.push(Ot)),Vt!==-1&&Dt!=ir[Dt]&&(ir[Vt]=ir[Dt],sr.lastIndexOf(Vt)<lr&&sr.push(Vt));for(Dt=1;Dt<tr;++Dt)ir[Dt]===Dt&&(Vt!==-1&&ir[Vt]!==Vt?ir[Dt]=ir[Vt]:Ot!==-1&&ir[Ot]!==Ot&&(ir[Dt]=ir[Ot]));for(Dt=1;Dt<tr;++Dt)if(wt[Dt].type!==0){if(lr=Dt,lr!=ir[lr])do lr=ir[lr],Rt[Dt]=Rt[lr]+"/"+Rt[Dt];while(lr!==0&&ir[lr]!==-1&&lr!=ir[lr]);ir[Dt]=-1}for(Rt[0]+="/",Dt=1;Dt<tr;++Dt)wt[Dt].type!==2&&(Rt[Dt]+="/")}function X(wt,Rt,Tt){for(var Dt=wt.start,Ot=wt.size,Vt=[],Jt=Dt;Tt&&Ot>0&&Jt>=0;)Vt.push(Rt.slice(Jt*Ee,Jt*Ee+Ee)),Ot-=Ee,Jt=__readInt32LE(Tt,Jt*4);return Vt.length===0?new_buf(0):bconcat(Vt).slice(0,wt.size)}function Q(wt,Rt,Tt,Dt,Ot){var Vt=Ce;if(wt===Ce){if(Rt!==0)throw new Error("DIFAT chain shorter than expected")}else if(wt!==-1){var Jt=Tt[wt],lr=(Dt>>>2)-1;if(!Jt)return;for(var tr=0;tr<lr&&(Vt=__readInt32LE(Jt,tr*4))!==Ce;++tr)Ot.push(Vt);Rt>=1&&Q(__readInt32LE(Jt,Dt-4),Rt-1,Tt,Dt,Ot)}}function se(wt,Rt,Tt,Dt,Ot){var Vt=[],Jt=[];Ot||(Ot=[]);var lr=Dt-1,tr=0,ir=0;for(tr=Rt;tr>=0;){Ot[tr]=!0,Vt[Vt.length]=tr,Jt.push(wt[tr]);var sr=Tt[Math.floor(tr*4/Dt)];if(ir=tr*4&lr,Dt<4+ir)throw new Error("FAT boundary crossed: "+tr+" 4 "+Dt);if(!wt[sr])break;tr=__readInt32LE(wt[sr],ir)}return{nodes:Vt,data:__toBuffer([Jt])}}function oe(wt,Rt,Tt,Dt){var Ot=wt.length,Vt=[],Jt=[],lr=[],tr=[],ir=Dt-1,sr=0,dr=0,yr=0,Er=0;for(sr=0;sr<Ot;++sr)if(lr=[],yr=sr+Rt,yr>=Ot&&(yr-=Ot),!Jt[yr]){tr=[];var pr=[];for(dr=yr;dr>=0;){pr[dr]=!0,Jt[dr]=!0,lr[lr.length]=dr,tr.push(wt[dr]);var _r=Tt[Math.floor(dr*4/Dt)];if(Er=dr*4&ir,Dt<4+Er)throw new Error("FAT boundary crossed: "+dr+" 4 "+Dt);if(!wt[_r]||(dr=__readInt32LE(wt[_r],Er),pr[dr]))break}Vt[yr]={nodes:lr,data:__toBuffer([tr])}}return Vt}function ue(wt,Rt,Tt,Dt,Ot,Vt,Jt,lr){for(var tr=0,ir=Dt.length?2:0,sr=Rt[wt].data,dr=0,yr=0,Er;dr<sr.length;dr+=128){var pr=sr.slice(dr,dr+128);prep_blob(pr,64),yr=pr.read_shift(2),Er=__utf16le(pr,0,yr-ir),Dt.push(Er);var _r={name:Er,type:pr.read_shift(1),color:pr.read_shift(1),L:pr.read_shift(4,"i"),R:pr.read_shift(4,"i"),C:pr.read_shift(4,"i"),clsid:pr.read_shift(16),state:pr.read_shift(4,"i"),start:0,size:0},Ar=pr.read_shift(2)+pr.read_shift(2)+pr.read_shift(2)+pr.read_shift(2);Ar!==0&&(_r.ct=we(pr,pr.l-8));var Ur=pr.read_shift(2)+pr.read_shift(2)+pr.read_shift(2)+pr.read_shift(2);Ur!==0&&(_r.mt=we(pr,pr.l-8)),_r.start=pr.read_shift(4,"i"),_r.size=pr.read_shift(4,"i"),_r.size<0&&_r.start<0&&(_r.size=_r.type=0,_r.start=Ce,_r.name=""),_r.type===5?(tr=_r.start,Ot>0&&tr!==Ce&&(Rt[tr].name="!StreamData")):_r.size>=4096?(_r.storage="fat",Rt[_r.start]===void 0&&(Rt[_r.start]=se(Tt,_r.start,Rt.fat_addrs,Rt.ssz)),Rt[_r.start].name=_r.name,_r.content=Rt[_r.start].data.slice(0,_r.size)):(_r.storage="minifat",_r.size<0?_r.size=0:tr!==Ce&&_r.start!==Ce&&Rt[tr]&&(_r.content=X(_r,Rt[tr].data,(Rt[lr]||{}).data))),_r.content&&prep_blob(_r.content,0),Vt[Er]=_r,Jt.push(_r)}}function we(wt,Rt){return new Date((__readUInt32LE(wt,Rt+4)/1e7*Math.pow(2,32)+__readUInt32LE(wt,Rt)/1e7-11644473600)*1e3)}function Te(wt,Rt){return O(),N(B.readFileSync(wt),Rt)}function xe(wt,Rt){var Tt=Rt&&Rt.type;switch(Tt||has_buf&&Buffer.isBuffer(wt)&&(Tt="buffer"),Tt||"base64"){case"file":return Te(wt,Rt);case"base64":return N(s2a(Base64_decode(wt)),Rt);case"binary":return N(s2a(wt),Rt)}return N(wt,Rt)}function Re(wt,Rt){var Tt=Rt||{},Dt=Tt.root||"Root Entry";if(wt.FullPaths||(wt.FullPaths=[]),wt.FileIndex||(wt.FileIndex=[]),wt.FullPaths.length!==wt.FileIndex.length)throw new Error("inconsistent CFB structure");wt.FullPaths.length===0&&(wt.FullPaths[0]=Dt+"/",wt.FileIndex[0]={name:Dt,type:5}),Tt.CLSID&&(wt.FileIndex[0].clsid=Tt.CLSID),Ne(wt)}function Ne(wt){var Rt="Sh33tJ5";if(!CFB.find(wt,"/"+Rt)){var Tt=new_buf(4);Tt[0]=55,Tt[1]=Tt[3]=50,Tt[2]=54,wt.FileIndex.push({name:Rt,type:2,content:Tt,size:4,L:69,R:69,C:69}),wt.FullPaths.push(wt.FullPaths[0]+Rt),Fe(wt)}}function Fe(wt,Rt){Re(wt);for(var Tt=!1,Dt=!1,Ot=wt.FullPaths.length-1;Ot>=0;--Ot){var Vt=wt.FileIndex[Ot];switch(Vt.type){case 0:Dt?Tt=!0:(wt.FileIndex.pop(),wt.FullPaths.pop());break;case 1:case 2:case 5:Dt=!0,isNaN(Vt.R*Vt.L*Vt.C)&&(Tt=!0),Vt.R>-1&&Vt.L>-1&&Vt.R==Vt.L&&(Tt=!0);break;default:Tt=!0;break}}if(!(!Tt&&!Rt)){var Jt=new Date(1987,1,19),lr=0,tr=Object.create?Object.create(null):{},ir=[];for(Ot=0;Ot<wt.FullPaths.length;++Ot)tr[wt.FullPaths[Ot]]=!0,wt.FileIndex[Ot].type!==0&&ir.push([wt.FullPaths[Ot],wt.FileIndex[Ot]]);for(Ot=0;Ot<ir.length;++Ot){var sr=E(ir[Ot][0]);for(Dt=tr[sr];!Dt;){for(;E(sr)&&!tr[E(sr)];)sr=E(sr);ir.push([sr,{name:S(sr).replace("/",""),type:1,clsid:He,ct:Jt,mt:Jt,content:null}]),tr[sr]=!0,sr=E(ir[Ot][0]),Dt=tr[sr]}}for(ir.sort(function(Er,pr){return _(Er[0],pr[0])}),wt.FullPaths=[],wt.FileIndex=[],Ot=0;Ot<ir.length;++Ot)wt.FullPaths[Ot]=ir[Ot][0],wt.FileIndex[Ot]=ir[Ot][1];for(Ot=0;Ot<ir.length;++Ot){var dr=wt.FileIndex[Ot],yr=wt.FullPaths[Ot];if(dr.name=S(yr).replace("/",""),dr.L=dr.R=dr.C=-(dr.color=1),dr.size=dr.content?dr.content.length:0,dr.start=0,dr.clsid=dr.clsid||He,Ot===0)dr.C=ir.length>1?1:-1,dr.size=0,dr.type=5;else if(yr.slice(-1)=="/"){for(lr=Ot+1;lr<ir.length&&E(wt.FullPaths[lr])!=yr;++lr);for(dr.C=lr>=ir.length?-1:lr,lr=Ot+1;lr<ir.length&&E(wt.FullPaths[lr])!=E(yr);++lr);dr.R=lr>=ir.length?-1:lr,dr.type=1}else E(wt.FullPaths[Ot+1]||"")==E(yr)&&(dr.R=Ot+1),dr.type=2}}}function ht(wt,Rt){var Tt=Rt||{};if(Tt.fileType=="mad")return fn(wt,Tt);switch(Fe(wt),Tt.fileType){case"zip":return Pr(wt,Tt)}var Dt=function(Er){for(var pr=0,_r=0,Ar=0;Ar<Er.FileIndex.length;++Ar){var Ur=Er.FileIndex[Ar];if(Ur.content){var Hr=Ur.content.length;Hr>0&&(Hr<4096?pr+=Hr+63>>6:_r+=Hr+511>>9)}}for(var Yr=Er.FullPaths.length+3>>2,dn=pr+7>>3,pn=pr+127>>7,wn=dn+_r+Yr+pn,mn=wn+127>>7,Tn=mn<=109?0:Math.ceil((mn-109)/127);wn+mn+Tn+127>>7>mn;)Tn=++mn<=109?0:Math.ceil((mn-109)/127);var Rn=[1,Tn,mn,pn,Yr,_r,pr,0];return Er.FileIndex[0].size=pr<<6,Rn[7]=(Er.FileIndex[0].start=Rn[0]+Rn[1]+Rn[2]+Rn[3]+Rn[4]+Rn[5])+(Rn[6]+7>>3),Rn}(wt),Ot=new_buf(Dt[7]<<9),Vt=0,Jt=0;{for(Vt=0;Vt<8;++Vt)Ot.write_shift(1,Ie[Vt]);for(Vt=0;Vt<8;++Vt)Ot.write_shift(2,0);for(Ot.write_shift(2,62),Ot.write_shift(2,3),Ot.write_shift(2,65534),Ot.write_shift(2,9),Ot.write_shift(2,6),Vt=0;Vt<3;++Vt)Ot.write_shift(2,0);for(Ot.write_shift(4,0),Ot.write_shift(4,Dt[2]),Ot.write_shift(4,Dt[0]+Dt[1]+Dt[2]+Dt[3]-1),Ot.write_shift(4,0),Ot.write_shift(4,4096),Ot.write_shift(4,Dt[3]?Dt[0]+Dt[1]+Dt[2]-1:Ce),Ot.write_shift(4,Dt[3]),Ot.write_shift(-4,Dt[1]?Dt[0]-1:Ce),Ot.write_shift(4,Dt[1]),Vt=0;Vt<109;++Vt)Ot.write_shift(-4,Vt<Dt[2]?Dt[1]+Vt:-1)}if(Dt[1])for(Jt=0;Jt<Dt[1];++Jt){for(;Vt<236+Jt*127;++Vt)Ot.write_shift(-4,Vt<Dt[2]?Dt[1]+Vt:-1);Ot.write_shift(-4,Jt===Dt[1]-1?Ce:Jt+1)}var lr=function(Er){for(Jt+=Er;Vt<Jt-1;++Vt)Ot.write_shift(-4,Vt+1);Er&&(++Vt,Ot.write_shift(-4,Ce))};for(Jt=Vt=0,Jt+=Dt[1];Vt<Jt;++Vt)Ot.write_shift(-4,Be.DIFSECT);for(Jt+=Dt[2];Vt<Jt;++Vt)Ot.write_shift(-4,Be.FATSECT);lr(Dt[3]),lr(Dt[4]);for(var tr=0,ir=0,sr=wt.FileIndex[0];tr<wt.FileIndex.length;++tr)sr=wt.FileIndex[tr],sr.content&&(ir=sr.content.length,!(ir<4096)&&(sr.start=Jt,lr(ir+511>>9)));for(lr(Dt[6]+7>>3);Ot.l&511;)Ot.write_shift(-4,Be.ENDOFCHAIN);for(Jt=Vt=0,tr=0;tr<wt.FileIndex.length;++tr)sr=wt.FileIndex[tr],sr.content&&(ir=sr.content.length,!(!ir||ir>=4096)&&(sr.start=Jt,lr(ir+63>>6)));for(;Ot.l&511;)Ot.write_shift(-4,Be.ENDOFCHAIN);for(Vt=0;Vt<Dt[4]<<2;++Vt){var dr=wt.FullPaths[Vt];if(!dr||dr.length===0){for(tr=0;tr<17;++tr)Ot.write_shift(4,0);for(tr=0;tr<3;++tr)Ot.write_shift(4,-1);for(tr=0;tr<12;++tr)Ot.write_shift(4,0);continue}sr=wt.FileIndex[Vt],Vt===0&&(sr.start=sr.size?sr.start-1:Ce);var yr=Vt===0&&Tt.root||sr.name;if(yr.length>32&&(console.error("Name "+yr+" will be truncated to "+yr.slice(0,32)),yr=yr.slice(0,32)),ir=2*(yr.length+1),Ot.write_shift(64,yr,"utf16le"),Ot.write_shift(2,ir),Ot.write_shift(1,sr.type),Ot.write_shift(1,sr.color),Ot.write_shift(-4,sr.L),Ot.write_shift(-4,sr.R),Ot.write_shift(-4,sr.C),sr.clsid)Ot.write_shift(16,sr.clsid,"hex");else for(tr=0;tr<4;++tr)Ot.write_shift(4,0);Ot.write_shift(4,sr.state||0),Ot.write_shift(4,0),Ot.write_shift(4,0),Ot.write_shift(4,0),Ot.write_shift(4,0),Ot.write_shift(4,sr.start),Ot.write_shift(4,sr.size),Ot.write_shift(4,0)}for(Vt=1;Vt<wt.FileIndex.length;++Vt)if(sr=wt.FileIndex[Vt],sr.size>=4096)if(Ot.l=sr.start+1<<9,has_buf&&Buffer.isBuffer(sr.content))sr.content.copy(Ot,Ot.l,0,sr.size),Ot.l+=sr.size+511&-512;else{for(tr=0;tr<sr.size;++tr)Ot.write_shift(1,sr.content[tr]);for(;tr&511;++tr)Ot.write_shift(1,0)}for(Vt=1;Vt<wt.FileIndex.length;++Vt)if(sr=wt.FileIndex[Vt],sr.size>0&&sr.size<4096)if(has_buf&&Buffer.isBuffer(sr.content))sr.content.copy(Ot,Ot.l,0,sr.size),Ot.l+=sr.size+63&-64;else{for(tr=0;tr<sr.size;++tr)Ot.write_shift(1,sr.content[tr]);for(;tr&63;++tr)Ot.write_shift(1,0)}if(has_buf)Ot.l=Ot.length;else for(;Ot.l<Ot.length;)Ot.write_shift(1,0);return Ot}function nt(wt,Rt){var Tt=wt.FullPaths.map(function(tr){return tr.toUpperCase()}),Dt=Tt.map(function(tr){var ir=tr.split("/");return ir[ir.length-(tr.slice(-1)=="/"?2:1)]}),Ot=!1;Rt.charCodeAt(0)===47?(Ot=!0,Rt=Tt[0].slice(0,-1)+Rt):Ot=Rt.indexOf("/")!==-1;var Vt=Rt.toUpperCase(),Jt=Ot===!0?Tt.indexOf(Vt):Dt.indexOf(Vt);if(Jt!==-1)return wt.FileIndex[Jt];var lr=!Vt.match(chr1);for(Vt=Vt.replace(chr0,""),lr&&(Vt=Vt.replace(chr1,"!")),Jt=0;Jt<Tt.length;++Jt)if((lr?Tt[Jt].replace(chr1,"!"):Tt[Jt]).replace(chr0,"")==Vt||(lr?Dt[Jt].replace(chr1,"!"):Dt[Jt]).replace(chr0,"")==Vt)return wt.FileIndex[Jt];return null}var Ee=64,Ce=-2,_e="d0cf11e0a1b11ae1",Ie=[208,207,17,224,161,177,26,225],He="00000000000000000000000000000000",Be={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:Ce,FREESECT:-1,HEADER_SIGNATURE:_e,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:He,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function Ge(wt,Rt,Tt){O();var Dt=ht(wt,Tt);B.writeFileSync(Rt,Dt)}function je(wt){for(var Rt=new Array(wt.length),Tt=0;Tt<wt.length;++Tt)Rt[Tt]=String.fromCharCode(wt[Tt]);return Rt.join("")}function Ve(wt,Rt){var Tt=ht(wt,Rt);switch(Rt&&Rt.type||"buffer"){case"file":return O(),B.writeFileSync(Rt.filename,Tt),Tt;case"binary":return typeof Tt=="string"?Tt:je(Tt);case"base64":return Base64_encode(typeof Tt=="string"?Tt:je(Tt));case"buffer":if(has_buf)return Buffer.isBuffer(Tt)?Tt:Buffer_from(Tt);case"array":return typeof Tt=="string"?s2a(Tt):Tt}return Tt}var Pe;function Me(wt){try{var Rt=wt.InflateRaw,Tt=new Rt;if(Tt._processChunk(new Uint8Array([3,0]),Tt._finishFlushFlag),Tt.bytesRead)Pe=wt;else throw new Error("zlib does not expose bytesRead")}catch(Dt){console.error("cannot use native zlib: "+(Dt.message||Dt))}}function tt(wt,Rt){if(!Pe)return Rr(wt,Rt);var Tt=Pe.InflateRaw,Dt=new Tt,Ot=Dt._processChunk(wt.slice(wt.l),Dt._finishFlushFlag);return wt.l+=Dt.bytesRead,Ot}function Ke(wt){return Pe?Pe.deflateRawSync(wt):Bt(wt)}var mt=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],ct=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],Qe=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function dt(wt){var Rt=(wt<<1|wt<<11)&139536|(wt<<5|wt<<15)&558144;return(Rt>>16|Rt>>8|Rt)&255}for(var vt=typeof Uint8Array<"u",At=vt?new Uint8Array(256):[],bt=0;bt<256;++bt)At[bt]=dt(bt);function ft(wt,Rt){var Tt=At[wt&255];return Rt<=8?Tt>>>8-Rt:(Tt=Tt<<8|At[wt>>8&255],Rt<=16?Tt>>>16-Rt:(Tt=Tt<<8|At[wt>>16&255],Tt>>>24-Rt))}function Et(wt,Rt){var Tt=Rt&7,Dt=Rt>>>3;return(wt[Dt]|(Tt<=6?0:wt[Dt+1]<<8))>>>Tt&3}function Ye(wt,Rt){var Tt=Rt&7,Dt=Rt>>>3;return(wt[Dt]|(Tt<=5?0:wt[Dt+1]<<8))>>>Tt&7}function Ct(wt,Rt){var Tt=Rt&7,Dt=Rt>>>3;return(wt[Dt]|(Tt<=4?0:wt[Dt+1]<<8))>>>Tt&15}function Pt(wt,Rt){var Tt=Rt&7,Dt=Rt>>>3;return(wt[Dt]|(Tt<=3?0:wt[Dt+1]<<8))>>>Tt&31}function St(wt,Rt){var Tt=Rt&7,Dt=Rt>>>3;return(wt[Dt]|(Tt<=1?0:wt[Dt+1]<<8))>>>Tt&127}function $t(wt,Rt,Tt){var Dt=Rt&7,Ot=Rt>>>3,Vt=(1<<Tt)-1,Jt=wt[Ot]>>>Dt;return Tt<8-Dt||(Jt|=wt[Ot+1]<<8-Dt,Tt<16-Dt)||(Jt|=wt[Ot+2]<<16-Dt,Tt<24-Dt)||(Jt|=wt[Ot+3]<<24-Dt),Jt&Vt}function kt(wt,Rt,Tt){var Dt=Rt&7,Ot=Rt>>>3;return Dt<=5?wt[Ot]|=(Tt&7)<<Dt:(wt[Ot]|=Tt<<Dt&255,wt[Ot+1]=(Tt&7)>>8-Dt),Rt+3}function Ft(wt,Rt,Tt){var Dt=Rt&7,Ot=Rt>>>3;return Tt=(Tt&1)<<Dt,wt[Ot]|=Tt,Rt+1}function qt(wt,Rt,Tt){var Dt=Rt&7,Ot=Rt>>>3;return Tt<<=Dt,wt[Ot]|=Tt&255,Tt>>>=8,wt[Ot+1]=Tt,Rt+8}function Mt(wt,Rt,Tt){var Dt=Rt&7,Ot=Rt>>>3;return Tt<<=Dt,wt[Ot]|=Tt&255,Tt>>>=8,wt[Ot+1]=Tt&255,wt[Ot+2]=Tt>>>8,Rt+16}function Wt(wt,Rt){var Tt=wt.length,Dt=2*Tt>Rt?2*Tt:Rt+5,Ot=0;if(Tt>=Rt)return wt;if(has_buf){var Vt=new_unsafe_buf(Dt);if(wt.copy)wt.copy(Vt);else for(;Ot<wt.length;++Ot)Vt[Ot]=wt[Ot];return Vt}else if(vt){var Jt=new Uint8Array(Dt);if(Jt.set)Jt.set(wt);else for(;Ot<Tt;++Ot)Jt[Ot]=wt[Ot];return Jt}return wt.length=Dt,wt}function Zt(wt){for(var Rt=new Array(wt),Tt=0;Tt<wt;++Tt)Rt[Tt]=0;return Rt}function Yt(wt,Rt,Tt){var Dt=1,Ot=0,Vt=0,Jt=0,lr=0,tr=wt.length,ir=vt?new Uint16Array(32):Zt(32);for(Vt=0;Vt<32;++Vt)ir[Vt]=0;for(Vt=tr;Vt<Tt;++Vt)wt[Vt]=0;tr=wt.length;var sr=vt?new Uint16Array(tr):Zt(tr);for(Vt=0;Vt<tr;++Vt)ir[Ot=wt[Vt]]++,Dt<Ot&&(Dt=Ot),sr[Vt]=0;for(ir[0]=0,Vt=1;Vt<=Dt;++Vt)ir[Vt+16]=lr=lr+ir[Vt-1]<<1;for(Vt=0;Vt<tr;++Vt)lr=wt[Vt],lr!=0&&(sr[Vt]=ir[lr+16]++);var dr=0;for(Vt=0;Vt<tr;++Vt)if(dr=wt[Vt],dr!=0)for(lr=ft(sr[Vt],Dt)>>Dt-dr,Jt=(1<<Dt+4-dr)-1;Jt>=0;--Jt)Rt[lr|Jt<<dr]=dr&15|Vt<<4;return Dt}var ur=vt?new Uint16Array(512):Zt(512),xt=vt?new Uint16Array(32):Zt(32);if(!vt){for(var pt=0;pt<512;++pt)ur[pt]=0;for(pt=0;pt<32;++pt)xt[pt]=0}(function(){for(var wt=[],Rt=0;Rt<32;Rt++)wt.push(5);Yt(wt,xt,32);var Tt=[];for(Rt=0;Rt<=143;Rt++)Tt.push(8);for(;Rt<=255;Rt++)Tt.push(9);for(;Rt<=279;Rt++)Tt.push(7);for(;Rt<=287;Rt++)Tt.push(8);Yt(Tt,ur,288)})();var yt=function(){for(var Rt=vt?new Uint8Array(32768):[],Tt=0,Dt=0;Tt<Qe.length-1;++Tt)for(;Dt<Qe[Tt+1];++Dt)Rt[Dt]=Tt;for(;Dt<32768;++Dt)Rt[Dt]=29;var Ot=vt?new Uint8Array(259):[];for(Tt=0,Dt=0;Tt<ct.length-1;++Tt)for(;Dt<ct[Tt+1];++Dt)Ot[Dt]=Tt;function Vt(lr,tr){for(var ir=0;ir<lr.length;){var sr=Math.min(65535,lr.length-ir),dr=ir+sr==lr.length;for(tr.write_shift(1,+dr),tr.write_shift(2,sr),tr.write_shift(2,~sr&65535);sr-- >0;)tr[tr.l++]=lr[ir++]}return tr.l}function Jt(lr,tr){for(var ir=0,sr=0,dr=vt?new Uint16Array(32768):[];sr<lr.length;){var yr=Math.min(65535,lr.length-sr);if(yr<10){for(ir=kt(tr,ir,+(sr+yr==lr.length)),ir&7&&(ir+=8-(ir&7)),tr.l=ir/8|0,tr.write_shift(2,yr),tr.write_shift(2,~yr&65535);yr-- >0;)tr[tr.l++]=lr[sr++];ir=tr.l*8;continue}ir=kt(tr,ir,+(sr+yr==lr.length)+2);for(var Er=0;yr-- >0;){var pr=lr[sr];Er=(Er<<5^pr)&32767;var _r=-1,Ar=0;if((_r=dr[Er])&&(_r|=sr&-32768,_r>sr&&(_r-=32768),_r<sr))for(;lr[_r+Ar]==lr[sr+Ar]&&Ar<250;)++Ar;if(Ar>2){pr=Ot[Ar],pr<=22?ir=qt(tr,ir,At[pr+1]>>1)-1:(qt(tr,ir,3),ir+=5,qt(tr,ir,At[pr-23]>>5),ir+=3);var Ur=pr<8?0:pr-4>>2;Ur>0&&(Mt(tr,ir,Ar-ct[pr]),ir+=Ur),pr=Rt[sr-_r],ir=qt(tr,ir,At[pr]>>3),ir-=3;var Hr=pr<4?0:pr-2>>1;Hr>0&&(Mt(tr,ir,sr-_r-Qe[pr]),ir+=Hr);for(var Yr=0;Yr<Ar;++Yr)dr[Er]=sr&32767,Er=(Er<<5^lr[sr])&32767,++sr;yr-=Ar-1}else pr<=143?pr=pr+48:ir=Ft(tr,ir,1),ir=qt(tr,ir,At[pr]),dr[Er]=sr&32767,++sr}ir=qt(tr,ir,0)-1}return tr.l=(ir+7)/8|0,tr.l}return function(tr,ir){return tr.length<8?Vt(tr,ir):Jt(tr,ir)}}();function Bt(wt){var Rt=new_buf(50+Math.floor(wt.length*1.1)),Tt=yt(wt,Rt);return Rt.slice(0,Tt)}var Ht=vt?new Uint16Array(32768):Zt(32768),nr=vt?new Uint16Array(32768):Zt(32768),Qt=vt?new Uint16Array(128):Zt(128),xr=1,kr=1;function Sr(wt,Rt){var Tt=Pt(wt,Rt)+257;Rt+=5;var Dt=Pt(wt,Rt)+1;Rt+=5;var Ot=Ct(wt,Rt)+4;Rt+=4;for(var Vt=0,Jt=vt?new Uint8Array(19):Zt(19),lr=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],tr=1,ir=vt?new Uint8Array(8):Zt(8),sr=vt?new Uint8Array(8):Zt(8),dr=Jt.length,yr=0;yr<Ot;++yr)Jt[mt[yr]]=Vt=Ye(wt,Rt),tr<Vt&&(tr=Vt),ir[Vt]++,Rt+=3;var Er=0;for(ir[0]=0,yr=1;yr<=tr;++yr)sr[yr]=Er=Er+ir[yr-1]<<1;for(yr=0;yr<dr;++yr)(Er=Jt[yr])!=0&&(lr[yr]=sr[Er]++);var pr=0;for(yr=0;yr<dr;++yr)if(pr=Jt[yr],pr!=0){Er=At[lr[yr]]>>8-pr;for(var _r=(1<<7-pr)-1;_r>=0;--_r)Qt[Er|_r<<pr]=pr&7|yr<<3}var Ar=[];for(tr=1;Ar.length<Tt+Dt;)switch(Er=Qt[St(wt,Rt)],Rt+=Er&7,Er>>>=3){case 16:for(Vt=3+Et(wt,Rt),Rt+=2,Er=Ar[Ar.length-1];Vt-- >0;)Ar.push(Er);break;case 17:for(Vt=3+Ye(wt,Rt),Rt+=3;Vt-- >0;)Ar.push(0);break;case 18:for(Vt=11+St(wt,Rt),Rt+=7;Vt-- >0;)Ar.push(0);break;default:Ar.push(Er),tr<Er&&(tr=Er);break}var Ur=Ar.slice(0,Tt),Hr=Ar.slice(Tt);for(yr=Tt;yr<286;++yr)Ur[yr]=0;for(yr=Dt;yr<30;++yr)Hr[yr]=0;return xr=Yt(Ur,Ht,286),kr=Yt(Hr,nr,30),Rt}function $r(wt,Rt){if(wt[0]==3&&!(wt[1]&3))return[new_raw_buf(Rt),2];for(var Tt=0,Dt=0,Ot=new_unsafe_buf(Rt||1<<18),Vt=0,Jt=Ot.length>>>0,lr=0,tr=0;!(Dt&1);){if(Dt=Ye(wt,Tt),Tt+=3,Dt>>>1)Dt>>1==1?(lr=9,tr=5):(Tt=Sr(wt,Tt),lr=xr,tr=kr);else{Tt&7&&(Tt+=8-(Tt&7));var ir=wt[Tt>>>3]|wt[(Tt>>>3)+1]<<8;if(Tt+=32,ir>0)for(!Rt&&Jt<Vt+ir&&(Ot=Wt(Ot,Vt+ir),Jt=Ot.length);ir-- >0;)Ot[Vt++]=wt[Tt>>>3],Tt+=8;continue}for(;;){!Rt&&Jt<Vt+32767&&(Ot=Wt(Ot,Vt+32767),Jt=Ot.length);var sr=$t(wt,Tt,lr),dr=Dt>>>1==1?ur[sr]:Ht[sr];if(Tt+=dr&15,dr>>>=4,!(dr>>>8&255))Ot[Vt++]=dr;else{if(dr==256)break;dr-=257;var yr=dr<8?0:dr-4>>2;yr>5&&(yr=0);var Er=Vt+ct[dr];yr>0&&(Er+=$t(wt,Tt,yr),Tt+=yr),sr=$t(wt,Tt,tr),dr=Dt>>>1==1?xt[sr]:nr[sr],Tt+=dr&15,dr>>>=4;var pr=dr<4?0:dr-2>>1,_r=Qe[dr];for(pr>0&&(_r+=$t(wt,Tt,pr),Tt+=pr),!Rt&&Jt<Er&&(Ot=Wt(Ot,Er+100),Jt=Ot.length);Vt<Er;)Ot[Vt]=Ot[Vt-_r],++Vt}}}return Rt?[Ot,Tt+7>>>3]:[Ot.slice(0,Vt),Tt+7>>>3]}function Rr(wt,Rt){var Tt=wt.slice(wt.l||0),Dt=$r(Tt,Rt);return wt.l+=Dt[1],Dt[0]}function Dr(wt,Rt){if(wt)typeof console<"u"&&console.error(Rt);else throw new Error(Rt)}function tn(wt,Rt){var Tt=wt;prep_blob(Tt,0);var Dt=[],Ot=[],Vt={FileIndex:Dt,FullPaths:Ot};Re(Vt,{root:Rt.root});for(var Jt=Tt.length-4;(Tt[Jt]!=80||Tt[Jt+1]!=75||Tt[Jt+2]!=5||Tt[Jt+3]!=6)&&Jt>=0;)--Jt;Tt.l=Jt+4,Tt.l+=4;var lr=Tt.read_shift(2);Tt.l+=6;var tr=Tt.read_shift(4);for(Tt.l=tr,Jt=0;Jt<lr;++Jt){Tt.l+=20;var ir=Tt.read_shift(4),sr=Tt.read_shift(4),dr=Tt.read_shift(2),yr=Tt.read_shift(2),Er=Tt.read_shift(2);Tt.l+=8;var pr=Tt.read_shift(4),_r=I(Tt.slice(Tt.l+dr,Tt.l+dr+yr));Tt.l+=dr+yr+Er;var Ar=Tt.l;Tt.l=pr+4,_r&&_r[1]&&((_r[1]||{}).usz&&(sr=_r[1].usz),(_r[1]||{}).csz&&(ir=_r[1].csz)),Jr(Tt,ir,sr,Vt,_r),Tt.l=Ar}return Vt}function Jr(wt,Rt,Tt,Dt,Ot){wt.l+=2;var Vt=wt.read_shift(2),Jt=wt.read_shift(2),lr=A(wt);if(Vt&8257)throw new Error("Unsupported ZIP encryption");for(var tr=wt.read_shift(4),ir=wt.read_shift(4),sr=wt.read_shift(4),dr=wt.read_shift(2),yr=wt.read_shift(2),Er="",pr=0;pr<dr;++pr)Er+=String.fromCharCode(wt[wt.l++]);if(yr){var _r=I(wt.slice(wt.l,wt.l+yr));(_r[21589]||{}).mt&&(lr=_r[21589].mt),(_r[1]||{}).usz&&(sr=_r[1].usz),(_r[1]||{}).csz&&(ir=_r[1].csz),Ot&&((Ot[21589]||{}).mt&&(lr=Ot[21589].mt),(Ot[1]||{}).usz&&(sr=_r[1].usz),(Ot[1]||{}).csz&&(ir=_r[1].csz))}wt.l+=yr;var Ar=wt.slice(wt.l,wt.l+ir);switch(Jt){case 8:Ar=tt(wt,sr);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+Jt)}var Ur=!1;Vt&8&&(tr=wt.read_shift(4),tr==134695760&&(tr=wt.read_shift(4),Ur=!0),ir=wt.read_shift(4),sr=wt.read_shift(4)),ir!=Rt&&Dr(Ur,"Bad compressed size: "+Rt+" != "+ir),sr!=Tt&&Dr(Ur,"Bad uncompressed size: "+Tt+" != "+sr),nn(Dt,Er,Ar,{unsafe:!0,mt:lr})}function Pr(wt,Rt){var Tt=Rt||{},Dt=[],Ot=[],Vt=new_buf(1),Jt=Tt.compression?8:0,lr=0,tr=0,ir=0,sr=0,dr=0,yr=wt.FullPaths[0],Er=yr,pr=wt.FileIndex[0],_r=[],Ar=0;for(tr=1;tr<wt.FullPaths.length;++tr)if(Er=wt.FullPaths[tr].slice(yr.length),pr=wt.FileIndex[tr],!(!pr.size||!pr.content||Er=="Sh33tJ5")){var Ur=sr,Hr=new_buf(Er.length);for(ir=0;ir<Er.length;++ir)Hr.write_shift(1,Er.charCodeAt(ir)&127);Hr=Hr.slice(0,Hr.l),_r[dr]=typeof pr.content=="string"?CRC32.bstr(pr.content,0):CRC32.buf(pr.content,0);var Yr=typeof pr.content=="string"?s2a(pr.content):pr.content;Jt==8&&(Yr=Ke(Yr)),Vt=new_buf(30),Vt.write_shift(4,67324752),Vt.write_shift(2,20),Vt.write_shift(2,lr),Vt.write_shift(2,Jt),pr.mt?C(Vt,pr.mt):Vt.write_shift(4,0),Vt.write_shift(-4,_r[dr]),Vt.write_shift(4,Yr.length),Vt.write_shift(4,pr.content.length),Vt.write_shift(2,Hr.length),Vt.write_shift(2,0),sr+=Vt.length,Dt.push(Vt),sr+=Hr.length,Dt.push(Hr),sr+=Yr.length,Dt.push(Yr),Vt=new_buf(46),Vt.write_shift(4,33639248),Vt.write_shift(2,0),Vt.write_shift(2,20),Vt.write_shift(2,lr),Vt.write_shift(2,Jt),Vt.write_shift(4,0),Vt.write_shift(-4,_r[dr]),Vt.write_shift(4,Yr.length),Vt.write_shift(4,pr.content.length),Vt.write_shift(2,Hr.length),Vt.write_shift(2,0),Vt.write_shift(2,0),Vt.write_shift(2,0),Vt.write_shift(2,0),Vt.write_shift(4,0),Vt.write_shift(4,Ur),Ar+=Vt.l,Ot.push(Vt),Ar+=Hr.length,Ot.push(Hr),++dr}return Vt=new_buf(22),Vt.write_shift(4,101010256),Vt.write_shift(2,0),Vt.write_shift(2,0),Vt.write_shift(2,dr),Vt.write_shift(2,dr),Vt.write_shift(4,Ar),Vt.write_shift(4,sr),Vt.write_shift(2,0),bconcat([bconcat(Dt),bconcat(Ot),Vt])}var Wr={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function Qr(wt,Rt){if(wt.ctype)return wt.ctype;var Tt=wt.name||"",Dt=Tt.match(/\.([^\.]+)$/);return Dt&&Wr[Dt[1]]||Rt&&(Dt=(Tt=Rt).match(/[\.\\]([^\.\\])+$/),Dt&&Wr[Dt[1]])?Wr[Dt[1]]:"application/octet-stream"}function Fr(wt){for(var Rt=Base64_encode(wt),Tt=[],Dt=0;Dt<Rt.length;Dt+=76)Tt.push(Rt.slice(Dt,Dt+76));return Tt.join(`\r
`)+`\r
`}function an(wt){var Rt=wt.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(ir){var sr=ir.charCodeAt(0).toString(16).toUpperCase();return"="+(sr.length==1?"0"+sr:sr)});Rt=Rt.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),Rt.charAt(0)==`
`&&(Rt="=0D"+Rt.slice(1)),Rt=Rt.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var Tt=[],Dt=Rt.split(`\r
`),Ot=0;Ot<Dt.length;++Ot){var Vt=Dt[Ot];if(Vt.length==0){Tt.push("");continue}for(var Jt=0;Jt<Vt.length;){var lr=76,tr=Vt.slice(Jt,Jt+lr);tr.charAt(lr-1)=="="?lr--:tr.charAt(lr-2)=="="?lr-=2:tr.charAt(lr-3)=="="&&(lr-=3),tr=Vt.slice(Jt,Jt+lr),Jt+=lr,Jt<Vt.length&&(tr+="="),Tt.push(tr)}}return Tt.join(`\r
`)}function cn(wt){for(var Rt=[],Tt=0;Tt<wt.length;++Tt){for(var Dt=wt[Tt];Tt<=wt.length&&Dt.charAt(Dt.length-1)=="=";)Dt=Dt.slice(0,Dt.length-1)+wt[++Tt];Rt.push(Dt)}for(var Ot=0;Ot<Rt.length;++Ot)Rt[Ot]=Rt[Ot].replace(/[=][0-9A-Fa-f]{2}/g,function(Vt){return String.fromCharCode(parseInt(Vt.slice(1),16))});return s2a(Rt.join(`\r
`))}function Lr(wt,Rt,Tt){for(var Dt="",Ot="",Vt="",Jt,lr=0;lr<10;++lr){var tr=Rt[lr];if(!tr||tr.match(/^\s*$/))break;var ir=tr.match(/^(.*?):\s*([^\s].*)$/);if(ir)switch(ir[1].toLowerCase()){case"content-location":Dt=ir[2].trim();break;case"content-type":Vt=ir[2].trim();break;case"content-transfer-encoding":Ot=ir[2].trim();break}}switch(++lr,Ot.toLowerCase()){case"base64":Jt=s2a(Base64_decode(Rt.slice(lr).join("")));break;case"quoted-printable":Jt=cn(Rt.slice(lr));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+Ot)}var sr=nn(wt,Dt.slice(Tt.length),Jt,{unsafe:!0});Vt&&(sr.ctype=Vt)}function ln(wt,Rt){if(je(wt.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var Tt=Rt&&Rt.root||"",Dt=(has_buf&&Buffer.isBuffer(wt)?wt.toString("binary"):je(wt)).split(`\r
`),Ot=0,Vt="";for(Ot=0;Ot<Dt.length;++Ot)if(Vt=Dt[Ot],!!/^Content-Location:/i.test(Vt)&&(Vt=Vt.slice(Vt.indexOf("file")),Tt||(Tt=Vt.slice(0,Vt.lastIndexOf("/")+1)),Vt.slice(0,Tt.length)!=Tt))for(;Tt.length>0&&(Tt=Tt.slice(0,Tt.length-1),Tt=Tt.slice(0,Tt.lastIndexOf("/")+1),Vt.slice(0,Tt.length)!=Tt););var Jt=(Dt[1]||"").match(/boundary="(.*?)"/);if(!Jt)throw new Error("MAD cannot find boundary");var lr="--"+(Jt[1]||""),tr=[],ir=[],sr={FileIndex:tr,FullPaths:ir};Re(sr);var dr,yr=0;for(Ot=0;Ot<Dt.length;++Ot){var Er=Dt[Ot];Er!==lr&&Er!==lr+"--"||(yr++&&Lr(sr,Dt.slice(dr,Ot),Tt),dr=Ot)}return sr}function fn(wt,Rt){var Tt=Rt||{},Dt=Tt.boundary||"SheetJS";Dt="------="+Dt;for(var Ot=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+Dt.slice(2)+'"',"","",""],Vt=wt.FullPaths[0],Jt=Vt,lr=wt.FileIndex[0],tr=1;tr<wt.FullPaths.length;++tr)if(Jt=wt.FullPaths[tr].slice(Vt.length),lr=wt.FileIndex[tr],!(!lr.size||!lr.content||Jt=="Sh33tJ5")){Jt=Jt.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Ar){return"_x"+Ar.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Ar){return"_u"+Ar.charCodeAt(0).toString(16)+"_"});for(var ir=lr.content,sr=has_buf&&Buffer.isBuffer(ir)?ir.toString("binary"):je(ir),dr=0,yr=Math.min(1024,sr.length),Er=0,pr=0;pr<=yr;++pr)(Er=sr.charCodeAt(pr))>=32&&Er<128&&++dr;var _r=dr>=yr*4/5;Ot.push(Dt),Ot.push("Content-Location: "+(Tt.root||"file:///C:/SheetJS/")+Jt),Ot.push("Content-Transfer-Encoding: "+(_r?"quoted-printable":"base64")),Ot.push("Content-Type: "+Qr(lr,Jt)),Ot.push(""),Ot.push(_r?an(sr):Fr(sr))}return Ot.push(Dt+`--\r
`),Ot.join(`\r
`)}function Or(wt){var Rt={};return Re(Rt,wt),Rt}function nn(wt,Rt,Tt,Dt){var Ot=Dt&&Dt.unsafe;Ot||Re(wt);var Vt=!Ot&&CFB.find(wt,Rt);if(!Vt){var Jt=wt.FullPaths[0];Rt.slice(0,Jt.length)==Jt?Jt=Rt:(Jt.slice(-1)!="/"&&(Jt+="/"),Jt=(Jt+Rt).replace("//","/")),Vt={name:S(Rt),type:2},wt.FileIndex.push(Vt),wt.FullPaths.push(Jt),Ot||CFB.utils.cfb_gc(wt)}return Vt.content=Tt,Vt.size=Tt?Tt.length:0,Dt&&(Dt.CLSID&&(Vt.clsid=Dt.CLSID),Dt.mt&&(Vt.mt=Dt.mt),Dt.ct&&(Vt.ct=Dt.ct)),Vt}function rn(wt,Rt){Re(wt);var Tt=CFB.find(wt,Rt);if(Tt){for(var Dt=0;Dt<wt.FileIndex.length;++Dt)if(wt.FileIndex[Dt]==Tt)return wt.FileIndex.splice(Dt,1),wt.FullPaths.splice(Dt,1),!0}return!1}function Kt(wt,Rt,Tt){Re(wt);var Dt=CFB.find(wt,Rt);if(Dt){for(var Ot=0;Ot<wt.FileIndex.length;++Ot)if(wt.FileIndex[Ot]==Dt)return wt.FileIndex[Ot].name=S(Tt),wt.FullPaths[Ot]=Tt,!0}return!1}function jt(wt){Fe(wt,!0)}return r.find=nt,r.read=xe,r.parse=N,r.write=Ve,r.writeFile=Ge,r.utils={cfb_new:Or,cfb_add:nn,cfb_del:rn,cfb_mov:Kt,cfb_gc:jt,ReadShift,CheckField,prep_blob,bconcat,use_zlib:Me,_deflateRaw:Bt,_inflateRaw:Rr,consts:Be},r}(),_fs;function set_fs(n){_fs=n}function blobify(n){return typeof n=="string"?s2ab(n):Array.isArray(n)?a2u(n):n}function write_dl(n,r,_){if(typeof _fs<"u"&&_fs.writeFileSync)return _?_fs.writeFileSync(n,r,_):_fs.writeFileSync(n,r);if(typeof Deno<"u"){if(_&&typeof r=="string")switch(_){case"utf8":r=new TextEncoder(_).encode(r);break;case"binary":r=s2ab(r);break;default:throw new Error("Unsupported encoding "+_)}return Deno.writeFileSync(n,r)}var E=_=="utf8"?utf8write(r):r;if(typeof IE_SaveFile<"u")return IE_SaveFile(E,n);if(typeof Blob<"u"){var S=new Blob([blobify(E)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(S,n);if(typeof saveAs<"u")return saveAs(S,n);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var C=URL.createObjectURL(S);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(C)},6e4),chrome.downloads.download({url:C,filename:n,saveAs:!0});var A=document.createElement("a");if(A.download!=null)return A.download=n,A.href=C,document.body.appendChild(A),A.click(),document.body.removeChild(A),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(C)},6e4),C}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var I=File(n);return I.open("w"),I.encoding="binary",Array.isArray(r)&&(r=a2s(r)),I.write(r),I.close(),r}catch(B){if(!B.message||!B.message.match(/onstruct/))throw B}throw new Error("cannot save file "+n)}function read_binary(n){if(typeof _fs<"u")return _fs.readFileSync(n);if(typeof Deno<"u")return Deno.readFileSync(n);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var r=File(n);r.open("r"),r.encoding="binary";var _=r.read();return r.close(),_}catch(E){if(!E.message||!E.message.match(/onstruct/))throw E}throw new Error("Cannot access file "+n)}function keys(n){for(var r=Object.keys(n),_=[],E=0;E<r.length;++E)Object.prototype.hasOwnProperty.call(n,r[E])&&_.push(r[E]);return _}function evert_key(n,r){for(var _=[],E=keys(n),S=0;S!==E.length;++S)_[n[E[S]][r]]==null&&(_[n[E[S]][r]]=E[S]);return _}function evert(n){for(var r=[],_=keys(n),E=0;E!==_.length;++E)r[n[_[E]]]=_[E];return r}function evert_num(n){for(var r=[],_=keys(n),E=0;E!==_.length;++E)r[n[_[E]]]=parseInt(_[E],10);return r}function evert_arr(n){for(var r=[],_=keys(n),E=0;E!==_.length;++E)r[n[_[E]]]==null&&(r[n[_[E]]]=[]),r[n[_[E]]].push(_[E]);return r}var basedate=new Date(1899,11,30,0,0,0);function datenum(n,r){var _=n.getTime();r&&(_-=1462*24*60*60*1e3);var E=basedate.getTime()+(n.getTimezoneOffset()-basedate.getTimezoneOffset())*6e4;return(_-E)/(24*60*60*1e3)}var refdate=new Date,dnthresh=basedate.getTime()+(refdate.getTimezoneOffset()-basedate.getTimezoneOffset())*6e4,refoffset=refdate.getTimezoneOffset();function numdate(n){var r=new Date;return r.setTime(n*24*60*60*1e3+dnthresh),r.getTimezoneOffset()!==refoffset&&r.setTime(r.getTime()+(r.getTimezoneOffset()-refoffset)*6e4),r}function parse_isodur(n){var r=0,_=0,E=!1,S=n.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!S)throw new Error("|"+n+"| is not an ISO8601 Duration");for(var C=1;C!=S.length;++C)if(S[C]){switch(_=1,C>3&&(E=!0),S[C].slice(S[C].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+S[C].slice(S[C].length-1));case"D":_*=24;case"H":_*=60;case"M":if(E)_*=60;else throw new Error("Unsupported ISO Duration Field: M")}r+=_*parseInt(S[C],10)}return r}var good_pd_date_1=new Date("2017-02-19T19:06:09.000Z"),good_pd_date=isNaN(good_pd_date_1.getFullYear())?new Date("2/19/17"):good_pd_date_1,good_pd=good_pd_date.getFullYear()==2017;function parseDate(n,r){var _=new Date(n);if(good_pd)return r>0?_.setTime(_.getTime()+_.getTimezoneOffset()*60*1e3):r<0&&_.setTime(_.getTime()-_.getTimezoneOffset()*60*1e3),_;if(n instanceof Date)return n;if(good_pd_date.getFullYear()==1917&&!isNaN(_.getFullYear())){var E=_.getFullYear();return n.indexOf(""+E)>-1||_.setFullYear(_.getFullYear()+100),_}var S=n.match(/\d+/g)||["2017","2","19","0","0","0"],C=new Date(+S[0],+S[1]-1,+S[2],+S[3]||0,+S[4]||0,+S[5]||0);return n.indexOf("Z")>-1&&(C=new Date(C.getTime()-C.getTimezoneOffset()*60*1e3)),C}function cc2str(n,r){if(has_buf&&Buffer.isBuffer(n)){if(r&&buf_utf16le){if(n[0]==255&&n[1]==254)return utf8write(n.slice(2).toString("utf16le"));if(n[1]==254&&n[2]==255)return utf8write(utf16beread(n.slice(2).toString("binary")))}return n.toString("binary")}if(typeof TextDecoder<"u")try{if(r){if(n[0]==255&&n[1]==254)return utf8write(new TextDecoder("utf-16le").decode(n.slice(2)));if(n[0]==254&&n[1]==255)return utf8write(new TextDecoder("utf-16be").decode(n.slice(2)))}var _={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(n)&&(n=new Uint8Array(n)),new TextDecoder("latin1").decode(n).replace(/[]/g,function(C){return _[C]||C})}catch{}for(var E=[],S=0;S!=n.length;++S)E.push(String.fromCharCode(n[S]));return E.join("")}function dup(n){if(typeof JSON<"u"&&!Array.isArray(n))return JSON.parse(JSON.stringify(n));if(typeof n!="object"||n==null)return n;if(n instanceof Date)return new Date(n.getTime());var r={};for(var _ in n)Object.prototype.hasOwnProperty.call(n,_)&&(r[_]=dup(n[_]));return r}function fill(n,r){for(var _="";_.length<r;)_+=n;return _}function fuzzynum(n){var r=Number(n);if(!isNaN(r))return isFinite(r)?r:NaN;if(!/\d/.test(n))return r;var _=1,E=n.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return _*=100,""});return!isNaN(r=Number(E))||(E=E.replace(/[(](.*)[)]/,function(S,C){return _=-_,C}),!isNaN(r=Number(E)))?r/_:r}var FDRE1=/^(0?\d|1[0-2])(?:|:([0-5]?\d)(?:|(\.\d+)(?:|:([0-5]?\d))|:([0-5]?\d)(|\.\d+)))\s+([ap])m?$/;function fuzzytime1(n){return n[2]?n[3]?n[4]?new Date(1899,11,30,+n[1]%12+(n[7]=="p"?12:0),+n[2],+n[4],parseFloat(n[3])*1e3):new Date(1899,11,30,n[7]=="p"?12:0,+n[1],+n[2],parseFloat(n[3])*1e3):n[5]?new Date(1899,11,30,+n[1]%12+(n[7]=="p"?12:0),+n[2],+n[5],n[6]?parseFloat(n[6])*1e3:0):new Date(1899,11,30,+n[1]%12+(n[7]=="p"?12:0),+n[2],0,0):new Date(1899,11,30,+n[1]%12+(n[7]=="p"?12:0),0,0,0)}var lower_months=["january","february","march","april","may","june","july","august","september","october","november","december"];function fuzzydate(n){var r=n.toLowerCase(),_=r.replace(/\s+/g," ").trim(),E=_.match(FDRE1);if(E)return fuzzytime1(E);var S=new Date(n),C=new Date(NaN),A=S.getYear();S.getMonth();var I=S.getDate();if(isNaN(I))return C;if(r.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(r=r.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),r.length>3&&lower_months.indexOf(r)==-1)return C}else if(r.replace(/[ap]m?/,"").match(/[a-z]/))return C;return A<0||A>8099||n.match(/[^-0-9:,\/\\]/)?C:S}var split_regex=function(){var n="abacaba".split(/(:?b)/i).length==5;return function(_,E,S){if(n||typeof E=="string")return _.split(E);for(var C=_.split(E),A=[C[0]],I=1;I<C.length;++I)A.push(S),A.push(C[I]);return A}}();function getdatastr(n){return n?n.content&&n.type?cc2str(n.content,!0):n.data?debom(n.data):n.asNodeBuffer&&has_buf?debom(n.asNodeBuffer().toString("binary")):n.asBinary?debom(n.asBinary()):n._data&&n._data.getContent?debom(cc2str(Array.prototype.slice.call(n._data.getContent(),0))):null:null}function getdatabin(n){if(!n)return null;if(n.data)return char_codes(n.data);if(n.asNodeBuffer&&has_buf)return n.asNodeBuffer();if(n._data&&n._data.getContent){var r=n._data.getContent();return typeof r=="string"?char_codes(r):Array.prototype.slice.call(r)}return n.content&&n.type?n.content:null}function getdata(n){return n&&n.name.slice(-4)===".bin"?getdatabin(n):getdatastr(n)}function safegetzipfile(n,r){for(var _=n.FullPaths||keys(n.files),E=r.toLowerCase().replace(/[\/]/g,"\\"),S=E.replace(/\\/g,"/"),C=0;C<_.length;++C){var A=_[C].replace(/^Root Entry[\/]/,"").toLowerCase();if(E==A||S==A)return n.files?n.files[_[C]]:n.FileIndex[C]}return null}function getzipfile(n,r){var _=safegetzipfile(n,r);if(_==null)throw new Error("Cannot find file "+r+" in zip");return _}function getzipdata(n,r,_){if(!_)return getdata(getzipfile(n,r));if(!r)return null;try{return getzipdata(n,r)}catch{return null}}function getzipstr(n,r,_){if(!_)return getdatastr(getzipfile(n,r));if(!r)return null;try{return getzipstr(n,r)}catch{return null}}function getzipbin(n,r,_){if(!_)return getdatabin(getzipfile(n,r));if(!r)return null;try{return getzipbin(n,r)}catch{return null}}function zipentries(n){for(var r=n.FullPaths||keys(n.files),_=[],E=0;E<r.length;++E)r[E].slice(-1)!="/"&&_.push(r[E].replace(/^Root Entry[\/]/,""));return _.sort()}function zip_add_file(n,r,_){if(n.FullPaths){if(typeof _=="string"){var E;return has_buf?E=Buffer_from(_):E=utf8decode(_),CFB.utils.cfb_add(n,r,E)}CFB.utils.cfb_add(n,r,_)}else n.file(r,_)}function zip_new(){return CFB.utils.cfb_new()}function zip_read(n,r){switch(r.type){case"base64":return CFB.read(n,{type:"base64"});case"binary":return CFB.read(n,{type:"binary"});case"buffer":case"array":return CFB.read(n,{type:"buffer"})}throw new Error("Unrecognized type "+r.type)}function resolve_path(n,r){if(n.charAt(0)=="/")return n.slice(1);var _=r.split("/");r.slice(-1)!="/"&&_.pop();for(var E=n.split("/");E.length!==0;){var S=E.shift();S===".."?_.pop():S!=="."&&_.push(S)}return _.join("/")}var XML_HEADER=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,attregexg=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,tagregex1=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,tagregex2=/<[^>]*>/g,tagregex=XML_HEADER.match(tagregex1)?tagregex1:tagregex2,nsregex=/<\w*:/,nsregex2=/<(\/?)\w+:/;function parsexmltag(n,r,_){for(var E={},S=0,C=0;S!==n.length&&!((C=n.charCodeAt(S))===32||C===10||C===13);++S);if(r||(E[0]=n.slice(0,S)),S===n.length)return E;var A=n.match(attregexg),I=0,B="",O=0,N="",U="",j=1;if(A)for(O=0;O!=A.length;++O){for(U=A[O],C=0;C!=U.length&&U.charCodeAt(C)!==61;++C);for(N=U.slice(0,C).trim();U.charCodeAt(C+1)==32;)++C;for(j=(S=U.charCodeAt(C+1))==34||S==39?1:0,B=U.slice(C+1+j,U.length-j),I=0;I!=N.length&&N.charCodeAt(I)!==58;++I);if(I===N.length)N.indexOf("_")>0&&(N=N.slice(0,N.indexOf("_"))),E[N]=B,_||(E[N.toLowerCase()]=B);else{var z=(I===5&&N.slice(0,5)==="xmlns"?"xmlns":"")+N.slice(I+1);if(E[z]&&N.slice(I-3,I)=="ext")continue;E[z]=B,_||(E[z.toLowerCase()]=B)}}return E}function strip_ns(n){return n.replace(nsregex2,"<$1")}var encodings={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},rencoding=evert(encodings),unescapexml=function(){var n=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,r=/_x([\da-fA-F]{4})_/ig;function _(E){var S=E+"",C=S.indexOf("<![CDATA[");if(C==-1)return S.replace(n,function(I,B){return encodings[I]||String.fromCharCode(parseInt(B,I.indexOf("x")>-1?16:10))||I}).replace(r,function(I,B){return String.fromCharCode(parseInt(B,16))});var A=S.indexOf("]]>");return _(S.slice(0,C))+S.slice(C+9,A)+_(S.slice(A+3))}return function(S,C){var A=_(S);return C?A.replace(/\r\n/g,`
`):A}}(),decregex=/[&<>'"]/g,charegex=/[\u0000-\u0008\u000b-\u001f\uFFFE-\uFFFF]/g;function escapexml(n){var r=n+"";return r.replace(decregex,function(_){return rencoding[_]}).replace(charegex,function(_){return"_x"+("000"+_.charCodeAt(0).toString(16)).slice(-4)+"_"})}function escapexmltag(n){return escapexml(n).replace(/ /g,"_x0020_")}var htmlcharegex=/[\u0000-\u001f]/g;function escapehtml(n){var r=n+"";return r.replace(decregex,function(_){return rencoding[_]}).replace(/\n/g,"<br/>").replace(htmlcharegex,function(_){return"&#x"+("000"+_.charCodeAt(0).toString(16)).slice(-4)+";"})}function escapexlml(n){var r=n+"";return r.replace(decregex,function(_){return rencoding[_]}).replace(htmlcharegex,function(_){return"&#x"+_.charCodeAt(0).toString(16).toUpperCase()+";"})}var xlml_fixstr=function(){var n=/&#(\d+);/g;function r(_,E){return String.fromCharCode(parseInt(E,10))}return function(E){return E.replace(n,r)}}();function xlml_unfixstr(n){return n.replace(/(\r\n|[\r\n])/g,"&#10;")}function parsexmlbool(n){switch(n){case 1:case!0:case"1":case"true":return!0;case 0:case!1:case"0":case"false":return!1}return!1}function utf8reada(n){for(var r="",_=0,E=0,S=0,C=0,A=0,I=0;_<n.length;){if(E=n.charCodeAt(_++),E<128){r+=String.fromCharCode(E);continue}if(S=n.charCodeAt(_++),E>191&&E<224){A=(E&31)<<6,A|=S&63,r+=String.fromCharCode(A);continue}if(C=n.charCodeAt(_++),E<240){r+=String.fromCharCode((E&15)<<12|(S&63)<<6|C&63);continue}A=n.charCodeAt(_++),I=((E&7)<<18|(S&63)<<12|(C&63)<<6|A&63)-65536,r+=String.fromCharCode(55296+(I>>>10&1023)),r+=String.fromCharCode(56320+(I&1023))}return r}function utf8readb(n){var r=new_raw_buf(2*n.length),_,E,S=1,C=0,A=0,I;for(E=0;E<n.length;E+=S)S=1,(I=n.charCodeAt(E))<128?_=I:I<224?(_=(I&31)*64+(n.charCodeAt(E+1)&63),S=2):I<240?(_=(I&15)*4096+(n.charCodeAt(E+1)&63)*64+(n.charCodeAt(E+2)&63),S=3):(S=4,_=(I&7)*262144+(n.charCodeAt(E+1)&63)*4096+(n.charCodeAt(E+2)&63)*64+(n.charCodeAt(E+3)&63),_-=65536,A=55296+(_>>>10&1023),_=56320+(_&1023)),A!==0&&(r[C++]=A&255,r[C++]=A>>>8,A=0),r[C++]=_%256,r[C++]=_>>>8;return r.slice(0,C).toString("ucs2")}function utf8readc(n){return Buffer_from(n,"binary").toString("utf8")}var utf8corpus="foo bar baz",utf8read=has_buf&&(utf8readc(utf8corpus)==utf8reada(utf8corpus)&&utf8readc||utf8readb(utf8corpus)==utf8reada(utf8corpus)&&utf8readb)||utf8reada,utf8write=has_buf?function(n){return Buffer_from(n,"utf8").toString("binary")}:function(n){for(var r=[],_=0,E=0,S=0;_<n.length;)switch(E=n.charCodeAt(_++),!0){case E<128:r.push(String.fromCharCode(E));break;case E<2048:r.push(String.fromCharCode(192+(E>>6))),r.push(String.fromCharCode(128+(E&63)));break;case(E>=55296&&E<57344):E-=55296,S=n.charCodeAt(_++)-56320+(E<<10),r.push(String.fromCharCode(240+(S>>18&7))),r.push(String.fromCharCode(144+(S>>12&63))),r.push(String.fromCharCode(128+(S>>6&63))),r.push(String.fromCharCode(128+(S&63)));break;default:r.push(String.fromCharCode(224+(E>>12))),r.push(String.fromCharCode(128+(E>>6&63))),r.push(String.fromCharCode(128+(E&63)))}return r.join("")},matchtag=function(){var n={};return function(_,E){var S=_+"|"+(E||"");return n[S]?n[S]:n[S]=new RegExp("<(?:\\w+:)?"+_+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+_+">",E||"")}}(),htmldecode=function(){var n=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(r){return[new RegExp("&"+r[0]+";","ig"),r[1]]});return function(_){for(var E=_.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),S=0;S<n.length;++S)E=E.replace(n[S][0],n[S][1]);return E}}(),vtregex=function(){var n={};return function(_){return n[_]!==void 0?n[_]:n[_]=new RegExp("<(?:vt:)?"+_+">([\\s\\S]*?)</(?:vt:)?"+_+">","g")}}(),vtvregex=/<\/?(?:vt:)?variant>/g,vtmregex=/<(?:vt:)([^>]*)>([\s\S]*)</;function parseVector(n,r){var _=parsexmltag(n),E=n.match(vtregex(_.baseType))||[],S=[];if(E.length!=_.size){if(r.WTF)throw new Error("unexpected vector length "+E.length+" != "+_.size);return S}return E.forEach(function(C){var A=C.replace(vtvregex,"").match(vtmregex);A&&S.push({v:utf8read(A[2]),t:A[1]})}),S}var wtregex=/(^\s|\s$|\n)/;function writetag(n,r){return"<"+n+(r.match(wtregex)?' xml:space="preserve"':"")+">"+r+"</"+n+">"}function wxt_helper(n){return keys(n).map(function(r){return" "+r+'="'+n[r]+'"'}).join("")}function writextag(n,r,_){return"<"+n+(_!=null?wxt_helper(_):"")+(r!=null?(r.match(wtregex)?' xml:space="preserve"':"")+">"+r+"</"+n:"/")+">"}function write_w3cdtf(n,r){try{return n.toISOString().replace(/\.\d*/,"")}catch(_){if(r)throw _}return""}function write_vt(n,r){switch(typeof n){case"string":var _=writextag("vt:lpwstr",escapexml(n));return r&&(_=_.replace(/&quot;/g,"_x0022_")),_;case"number":return writextag((n|0)==n?"vt:i4":"vt:r8",escapexml(String(n)));case"boolean":return writextag("vt:bool",n?"true":"false")}if(n instanceof Date)return writextag("vt:filetime",write_w3cdtf(n));throw new Error("Unable to serialize "+n)}function xlml_normalize(n){if(has_buf&&Buffer.isBuffer(n))return n.toString("utf8");if(typeof n=="string")return n;if(typeof Uint8Array<"u"&&n instanceof Uint8Array)return utf8read(a2s(ab2a(n)));throw new Error("Bad input format: expected Buffer or string")}var xlmlregex=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/](?:[^>=]|="[^"]*?")*)?>/mg,XMLNS={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",mx:"http://schemas.microsoft.com/office/mac/excel/2008/main",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",sjs:"http://schemas.openxmlformats.org/package/2006/sheetjs/core-properties",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},XMLNS_main=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],XLMLNS={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function read_double_le(n,r){for(var _=1-2*(n[r+7]>>>7),E=((n[r+7]&127)<<4)+(n[r+6]>>>4&15),S=n[r+6]&15,C=5;C>=0;--C)S=S*256+n[r+C];return E==2047?S==0?_*(1/0):NaN:(E==0?E=-1022:(E-=1023,S+=Math.pow(2,52)),_*Math.pow(2,E-52)*S)}function write_double_le(n,r,_){var E=(r<0||1/r==-1/0?1:0)<<7,S=0,C=0,A=E?-r:r;isFinite(A)?A==0?S=C=0:(S=Math.floor(Math.log(A)/Math.LN2),C=A*Math.pow(2,52-S),S<=-1023&&(!isFinite(C)||C<Math.pow(2,52))?S=-1022:(C-=Math.pow(2,52),S+=1023)):(S=2047,C=isNaN(r)?26985:0);for(var I=0;I<=5;++I,C/=256)n[_+I]=C&255;n[_+6]=(S&15)<<4|C&15,n[_+7]=S>>4|E}var ___toBuffer=function(n){for(var r=[],_=10240,E=0;E<n[0].length;++E)if(n[0][E])for(var S=0,C=n[0][E].length;S<C;S+=_)r.push.apply(r,n[0][E].slice(S,S+_));return r},__toBuffer=has_buf?function(n){return n[0].length>0&&Buffer.isBuffer(n[0][0])?Buffer.concat(n[0].map(function(r){return Buffer.isBuffer(r)?r:Buffer_from(r)})):___toBuffer(n)}:___toBuffer,___utf16le=function(n,r,_){for(var E=[],S=r;S<_;S+=2)E.push(String.fromCharCode(__readUInt16LE(n,S)));return E.join("").replace(chr0,"")},__utf16le=has_buf?function(n,r,_){return!Buffer.isBuffer(n)||!buf_utf16le?___utf16le(n,r,_):n.toString("utf16le",r,_).replace(chr0,"")}:___utf16le,___hexlify=function(n,r,_){for(var E=[],S=r;S<r+_;++S)E.push(("0"+n[S].toString(16)).slice(-2));return E.join("")},__hexlify=has_buf?function(n,r,_){return Buffer.isBuffer(n)?n.toString("hex",r,r+_):___hexlify(n,r,_)}:___hexlify,___utf8=function(n,r,_){for(var E=[],S=r;S<_;S++)E.push(String.fromCharCode(__readUInt8(n,S)));return E.join("")},__utf8=has_buf?function(r,_,E){return Buffer.isBuffer(r)?r.toString("utf8",_,E):___utf8(r,_,E)}:___utf8,___lpstr=function(n,r){var _=__readUInt32LE(n,r);return _>0?__utf8(n,r+4,r+4+_-1):""},__lpstr=___lpstr,___cpstr=function(n,r){var _=__readUInt32LE(n,r);return _>0?__utf8(n,r+4,r+4+_-1):""},__cpstr=___cpstr,___lpwstr=function(n,r){var _=2*__readUInt32LE(n,r);return _>0?__utf8(n,r+4,r+4+_-1):""},__lpwstr=___lpwstr,___lpp4=function(r,_){var E=__readUInt32LE(r,_);return E>0?__utf16le(r,_+4,_+4+E):""},__lpp4=___lpp4,___8lpp4=function(n,r){var _=__readUInt32LE(n,r);return _>0?__utf8(n,r+4,r+4+_):""},__8lpp4=___8lpp4,___double=function(n,r){return read_double_le(n,r)},__double=___double,is_buf=function(r){return Array.isArray(r)||typeof Uint8Array<"u"&&r instanceof Uint8Array};has_buf&&(__lpstr=function(r,_){if(!Buffer.isBuffer(r))return ___lpstr(r,_);var E=r.readUInt32LE(_);return E>0?r.toString("utf8",_+4,_+4+E-1):""},__cpstr=function(r,_){if(!Buffer.isBuffer(r))return ___cpstr(r,_);var E=r.readUInt32LE(_);return E>0?r.toString("utf8",_+4,_+4+E-1):""},__lpwstr=function(r,_){if(!Buffer.isBuffer(r)||!buf_utf16le)return ___lpwstr(r,_);var E=2*r.readUInt32LE(_);return r.toString("utf16le",_+4,_+4+E-1)},__lpp4=function(r,_){if(!Buffer.isBuffer(r)||!buf_utf16le)return ___lpp4(r,_);var E=r.readUInt32LE(_);return r.toString("utf16le",_+4,_+4+E)},__8lpp4=function(r,_){if(!Buffer.isBuffer(r))return ___8lpp4(r,_);var E=r.readUInt32LE(_);return r.toString("utf8",_+4,_+4+E)},__double=function(r,_){return Buffer.isBuffer(r)?r.readDoubleLE(_):___double(r,_)},is_buf=function(r){return Buffer.isBuffer(r)||Array.isArray(r)||typeof Uint8Array<"u"&&r instanceof Uint8Array});var __readUInt8=function(n,r){return n[r]},__readUInt16LE=function(n,r){return n[r+1]*256+n[r]},__readInt16LE=function(n,r){var _=n[r+1]*256+n[r];return _<32768?_:(65535-_+1)*-1},__readUInt32LE=function(n,r){return n[r+3]*(1<<24)+(n[r+2]<<16)+(n[r+1]<<8)+n[r]},__readInt32LE=function(n,r){return n[r+3]<<24|n[r+2]<<16|n[r+1]<<8|n[r]},__readInt32BE=function(n,r){return n[r]<<24|n[r+1]<<16|n[r+2]<<8|n[r+3]};function ReadShift(n,r){var _="",E,S,C=[],A,I,B,O;switch(r){case"dbcs":if(O=this.l,has_buf&&Buffer.isBuffer(this)&&buf_utf16le)_=this.slice(this.l,this.l+2*n).toString("utf16le");else for(B=0;B<n;++B)_+=String.fromCharCode(__readUInt16LE(this,O)),O+=2;n*=2;break;case"utf8":_=__utf8(this,this.l,this.l+n);break;case"utf16le":n*=2,_=__utf16le(this,this.l,this.l+n);break;case"wstr":return ReadShift.call(this,n,"dbcs");case"lpstr-ansi":_=__lpstr(this,this.l),n=4+__readUInt32LE(this,this.l);break;case"lpstr-cp":_=__cpstr(this,this.l),n=4+__readUInt32LE(this,this.l);break;case"lpwstr":_=__lpwstr(this,this.l),n=4+2*__readUInt32LE(this,this.l);break;case"lpp4":n=4+__readUInt32LE(this,this.l),_=__lpp4(this,this.l),n&2&&(n+=2);break;case"8lpp4":n=4+__readUInt32LE(this,this.l),_=__8lpp4(this,this.l),n&3&&(n+=4-(n&3));break;case"cstr":for(n=0,_="";(A=__readUInt8(this,this.l+n++))!==0;)C.push(_getchar(A));_=C.join("");break;case"_wstr":for(n=0,_="";(A=__readUInt16LE(this,this.l+n))!==0;)C.push(_getchar(A)),n+=2;n+=2,_=C.join("");break;case"dbcs-cont":for(_="",O=this.l,B=0;B<n;++B){if(this.lens&&this.lens.indexOf(O)!==-1)return A=__readUInt8(this,O),this.l=O+1,I=ReadShift.call(this,n-B,A?"dbcs-cont":"sbcs-cont"),C.join("")+I;C.push(_getchar(__readUInt16LE(this,O))),O+=2}_=C.join(""),n*=2;break;case"cpstr":case"sbcs-cont":for(_="",O=this.l,B=0;B!=n;++B){if(this.lens&&this.lens.indexOf(O)!==-1)return A=__readUInt8(this,O),this.l=O+1,I=ReadShift.call(this,n-B,A?"dbcs-cont":"sbcs-cont"),C.join("")+I;C.push(_getchar(__readUInt8(this,O))),O+=1}_=C.join("");break;default:switch(n){case 1:return E=__readUInt8(this,this.l),this.l++,E;case 2:return E=(r==="i"?__readInt16LE:__readUInt16LE)(this,this.l),this.l+=2,E;case 4:case-4:return r==="i"||!(this[this.l+3]&128)?(E=(n>0?__readInt32LE:__readInt32BE)(this,this.l),this.l+=4,E):(S=__readUInt32LE(this,this.l),this.l+=4,S);case 8:case-8:if(r==="f")return n==8?S=__double(this,this.l):S=__double([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,S;n=8;case 16:_=__hexlify(this,this.l,n);break}}return this.l+=n,_}var __writeUInt32LE=function(n,r,_){n[_]=r&255,n[_+1]=r>>>8&255,n[_+2]=r>>>16&255,n[_+3]=r>>>24&255},__writeInt32LE=function(n,r,_){n[_]=r&255,n[_+1]=r>>8&255,n[_+2]=r>>16&255,n[_+3]=r>>24&255},__writeUInt16LE=function(n,r,_){n[_]=r&255,n[_+1]=r>>>8&255};function WriteShift(n,r,_){var E=0,S=0;if(_==="dbcs"){for(S=0;S!=r.length;++S)__writeUInt16LE(this,r.charCodeAt(S),this.l+2*S);E=2*r.length}else if(_==="sbcs"||_=="cpstr"){for(r=r.replace(/[^\x00-\x7F]/g,"_"),S=0;S!=r.length;++S)this[this.l+S]=r.charCodeAt(S)&255;E=r.length}else if(_==="hex"){for(;S<n;++S)this[this.l++]=parseInt(r.slice(2*S,2*S+2),16)||0;return this}else if(_==="utf16le"){var C=Math.min(this.l+n,this.length);for(S=0;S<Math.min(r.length,n);++S){var A=r.charCodeAt(S);this[this.l++]=A&255,this[this.l++]=A>>8}for(;this.l<C;)this[this.l++]=0;return this}else switch(n){case 1:E=1,this[this.l]=r&255;break;case 2:E=2,this[this.l]=r&255,r>>>=8,this[this.l+1]=r&255;break;case 3:E=3,this[this.l]=r&255,r>>>=8,this[this.l+1]=r&255,r>>>=8,this[this.l+2]=r&255;break;case 4:E=4,__writeUInt32LE(this,r,this.l);break;case 8:if(E=8,_==="f"){write_double_le(this,r,this.l);break}case 16:break;case-4:E=4,__writeInt32LE(this,r,this.l);break}return this.l+=E,this}function CheckField(n,r){var _=__hexlify(this,this.l,n.length>>1);if(_!==n)throw new Error(r+"Expected "+n+" saw "+_);this.l+=n.length>>1}function prep_blob(n,r){n.l=r,n.read_shift=ReadShift,n.chk=CheckField,n.write_shift=WriteShift}function parsenoop(n,r){n.l+=r}function new_buf(n){var r=new_raw_buf(n);return prep_blob(r,0),r}function recordhopper(n,r,_){if(n){var E,S,C;prep_blob(n,n.l||0);for(var A=n.length,I=0,B=0;n.l<A;){I=n.read_shift(1),I&128&&(I=(I&127)+((n.read_shift(1)&127)<<7));var O=XLSBRecordEnum[I]||XLSBRecordEnum[65535];for(E=n.read_shift(1),C=E&127,S=1;S<4&&E&128;++S)C+=((E=n.read_shift(1))&127)<<7*S;B=n.l+C;var N=O.f&&O.f(n,C,_);if(n.l=B,r(N,O,I))return}}}function buf_array(){var n=[],r=has_buf?256:2048,_=function(O){var N=new_buf(O);return prep_blob(N,0),N},E=_(r),S=function(){E&&(E.l&&(E.length>E.l&&(E=E.slice(0,E.l),E.l=E.length),E.length>0&&n.push(E)),E=null)},C=function(O){return E&&O<E.length-E.l?E:(S(),E=_(Math.max(O+1,r)))},A=function(){return S(),bconcat(n)},I=function(O){S(),E=O,E.l==null&&(E.l=E.length),C(r)};return{next:C,push:I,end:A,_bufs:n}}function write_record(n,r,_,E){var S=+r,C;if(!isNaN(S)){E||(E=XLSBRecordEnum[S].p||(_||[]).length||0),C=1+(S>=128?1:0)+1,E>=128&&++C,E>=16384&&++C,E>=2097152&&++C;var A=n.next(C);S<=127?A.write_shift(1,S):(A.write_shift(1,(S&127)+128),A.write_shift(1,S>>7));for(var I=0;I!=4;++I)if(E>=128)A.write_shift(1,(E&127)+128),E>>=7;else{A.write_shift(1,E);break}E>0&&is_buf(_)&&n.push(_)}}function shift_cell_xls(n,r,_){var E=dup(n);if(r.s?(E.cRel&&(E.c+=r.s.c),E.rRel&&(E.r+=r.s.r)):(E.cRel&&(E.c+=r.c),E.rRel&&(E.r+=r.r)),!_||_.biff<12){for(;E.c>=256;)E.c-=256;for(;E.r>=65536;)E.r-=65536}return E}function shift_range_xls(n,r,_){var E=dup(n);return E.s=shift_cell_xls(E.s,r.s,_),E.e=shift_cell_xls(E.e,r.s,_),E}function encode_cell_xls(n,r){if(n.cRel&&n.c<0)for(n=dup(n);n.c<0;)n.c+=r>8?16384:256;if(n.rRel&&n.r<0)for(n=dup(n);n.r<0;)n.r+=r>8?1048576:r>5?65536:16384;var _=encode_cell(n);return!n.cRel&&n.cRel!=null&&(_=fix_col(_)),!n.rRel&&n.rRel!=null&&(_=fix_row(_)),_}function encode_range_xls(n,r){return n.s.r==0&&!n.s.rRel&&n.e.r==(r.biff>=12?1048575:r.biff>=8?65536:16384)&&!n.e.rRel?(n.s.cRel?"":"$")+encode_col(n.s.c)+":"+(n.e.cRel?"":"$")+encode_col(n.e.c):n.s.c==0&&!n.s.cRel&&n.e.c==(r.biff>=12?16383:255)&&!n.e.cRel?(n.s.rRel?"":"$")+encode_row(n.s.r)+":"+(n.e.rRel?"":"$")+encode_row(n.e.r):encode_cell_xls(n.s,r.biff)+":"+encode_cell_xls(n.e,r.biff)}function decode_row(n){return parseInt(unfix_row(n),10)-1}function encode_row(n){return""+(n+1)}function fix_row(n){return n.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function unfix_row(n){return n.replace(/\$(\d+)$/,"$1")}function decode_col(n){for(var r=unfix_col(n),_=0,E=0;E!==r.length;++E)_=26*_+r.charCodeAt(E)-64;return _-1}function encode_col(n){if(n<0)throw new Error("invalid column "+n);var r="";for(++n;n;n=Math.floor((n-1)/26))r=String.fromCharCode((n-1)%26+65)+r;return r}function fix_col(n){return n.replace(/^([A-Z])/,"$$$1")}function unfix_col(n){return n.replace(/^\$([A-Z])/,"$1")}function split_cell(n){return n.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function decode_cell(n){for(var r=0,_=0,E=0;E<n.length;++E){var S=n.charCodeAt(E);S>=48&&S<=57?r=10*r+(S-48):S>=65&&S<=90&&(_=26*_+(S-64))}return{c:_-1,r:r-1}}function encode_cell(n){for(var r=n.c+1,_="";r;r=(r-1)/26|0)_=String.fromCharCode((r-1)%26+65)+_;return _+(n.r+1)}function decode_range(n){var r=n.indexOf(":");return r==-1?{s:decode_cell(n),e:decode_cell(n)}:{s:decode_cell(n.slice(0,r)),e:decode_cell(n.slice(r+1))}}function encode_range(n,r){return typeof r>"u"||typeof r=="number"?encode_range(n.s,n.e):(typeof n!="string"&&(n=encode_cell(n)),typeof r!="string"&&(r=encode_cell(r)),n==r?n:n+":"+r)}function fix_range(n){var r=decode_range(n);return"$"+encode_col(r.s.c)+"$"+encode_row(r.s.r)+":$"+encode_col(r.e.c)+"$"+encode_row(r.e.r)}function formula_quote_sheet_name(n,r){if(!n&&!(r&&r.biff<=5&&r.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(n)?"'"+n.replace(/'/g,"''")+"'":n}function safe_decode_range(n){var r={s:{c:0,r:0},e:{c:0,r:0}},_=0,E=0,S=0,C=n.length;for(_=0;E<C&&!((S=n.charCodeAt(E)-64)<1||S>26);++E)_=26*_+S;for(r.s.c=--_,_=0;E<C&&!((S=n.charCodeAt(E)-48)<0||S>9);++E)_=10*_+S;if(r.s.r=--_,E===C||S!=10)return r.e.c=r.s.c,r.e.r=r.s.r,r;for(++E,_=0;E!=C&&!((S=n.charCodeAt(E)-64)<1||S>26);++E)_=26*_+S;for(r.e.c=--_,_=0;E!=C&&!((S=n.charCodeAt(E)-48)<0||S>9);++E)_=10*_+S;return r.e.r=--_,r}function safe_format_cell(n,r){var _=n.t=="d"&&r instanceof Date;if(n.z!=null)try{return n.w=SSF_format(n.z,_?datenum(r):r)}catch{}try{return n.w=SSF_format((n.XF||{}).numFmtId||(_?14:0),_?datenum(r):r)}catch{return""+r}}function format_cell(n,r,_){return n==null||n.t==null||n.t=="z"?"":n.w!==void 0?n.w:(n.t=="d"&&!n.z&&_&&_.dateNF&&(n.z=_.dateNF),n.t=="e"?BErr[n.v]||n.v:r==null?safe_format_cell(n,n.v):safe_format_cell(n,r))}function sheet_to_workbook(n,r){var _=r&&r.sheet?r.sheet:"Sheet1",E={};return E[_]=n,{SheetNames:[_],Sheets:E}}function sheet_add_aoa(n,r,_){var E=_||{},S=n?n["!data"]!=null:E.dense,C=n||{};S&&!C["!data"]&&(C["!data"]=[]);var A=0,I=0;if(C&&E.origin!=null){if(typeof E.origin=="number")A=E.origin;else{var B=typeof E.origin=="string"?decode_cell(E.origin):E.origin;A=B.r,I=B.c}C["!ref"]||(C["!ref"]="A1:A1")}var O={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(C["!ref"]){var N=safe_decode_range(C["!ref"]);O.s.c=N.s.c,O.s.r=N.s.r,O.e.c=Math.max(O.e.c,N.e.c),O.e.r=Math.max(O.e.r,N.e.r),A==-1&&(O.e.r=A=N.e.r+1)}for(var U=[],j=0;j!=r.length;++j)if(r[j]){if(!Array.isArray(r[j]))throw new Error("aoa_to_sheet expects an array of arrays");var z=A+j,Z=""+(z+1);S&&(C["!data"][z]||(C["!data"][z]=[]),U=C["!data"][z]);for(var X=0;X!=r[j].length;++X)if(!(typeof r[j][X]>"u")){var Q={v:r[j][X]},se=I+X;if(O.s.r>z&&(O.s.r=z),O.s.c>se&&(O.s.c=se),O.e.r<z&&(O.e.r=z),O.e.c<se&&(O.e.c=se),r[j][X]&&typeof r[j][X]=="object"&&!Array.isArray(r[j][X])&&!(r[j][X]instanceof Date))Q=r[j][X];else if(Array.isArray(Q.v)&&(Q.f=r[j][X][1],Q.v=Q.v[0]),Q.v===null)if(Q.f)Q.t="n";else if(E.nullError)Q.t="e",Q.v=0;else if(E.sheetStubs)Q.t="z";else continue;else typeof Q.v=="number"?Q.t="n":typeof Q.v=="boolean"?Q.t="b":Q.v instanceof Date?(Q.z=E.dateNF||table_fmt[14],E.cellDates?(Q.t="d",Q.w=SSF_format(Q.z,datenum(Q.v,E.date1904))):(Q.t="n",Q.v=datenum(Q.v,E.date1904),Q.w=SSF_format(Q.z,Q.v))):Q.t="s";if(S)U[se]&&U[se].z&&(Q.z=U[se].z),U[se]=Q;else{var oe=encode_col(se)+Z;C[oe]&&C[oe].z&&(Q.z=C[oe].z),C[oe]=Q}}}return O.s.c<1e7&&(C["!ref"]=encode_range(O)),C}function aoa_to_sheet(n,r){return sheet_add_aoa(null,n,r)}function parse_Int32LE(n){return n.read_shift(4,"i")}function write_UInt32LE(n,r){return r||(r=new_buf(4)),r.write_shift(4,n),r}function parse_XLWideString(n){var r=n.read_shift(4);return r===0?"":n.read_shift(r,"dbcs")}function write_XLWideString(n,r){var _=!1;return r==null&&(_=!0,r=new_buf(4+2*n.length)),r.write_shift(4,n.length),n.length>0&&r.write_shift(0,n,"dbcs"),_?r.slice(0,r.l):r}function parse_StrRun(n){return{ich:n.read_shift(2),ifnt:n.read_shift(2)}}function write_StrRun(n,r){return r||(r=new_buf(4)),r.write_shift(2,n.ich||0),r.write_shift(2,n.ifnt||0),r}function parse_RichStr(n,r){var _=n.l,E=n.read_shift(1),S=parse_XLWideString(n),C=[],A={t:S,h:S};if(E&1){for(var I=n.read_shift(4),B=0;B!=I;++B)C.push(parse_StrRun(n));A.r=C}else A.r=[{ich:0,ifnt:0}];return n.l=_+r,A}function write_RichStr(n,r){var _=!1;return r==null&&(_=!0,r=new_buf(15+4*n.t.length)),r.write_shift(1,0),write_XLWideString(n.t,r),_?r.slice(0,r.l):r}var parse_BrtCommentText=parse_RichStr;function write_BrtCommentText(n,r){var _=!1;return r==null&&(_=!0,r=new_buf(23+4*n.t.length)),r.write_shift(1,1),write_XLWideString(n.t,r),r.write_shift(4,1),write_StrRun({ich:0,ifnt:0},r),_?r.slice(0,r.l):r}function parse_XLSBCell(n){var r=n.read_shift(4),_=n.read_shift(2);return _+=n.read_shift(1)<<16,n.l++,{c:r,iStyleRef:_}}function write_XLSBCell(n,r){return r==null&&(r=new_buf(8)),r.write_shift(-4,n.c),r.write_shift(3,n.iStyleRef||n.s),r.write_shift(1,0),r}function parse_XLSBShortCell(n){var r=n.read_shift(2);return r+=n.read_shift(1)<<16,n.l++,{c:-1,iStyleRef:r}}function write_XLSBShortCell(n,r){return r==null&&(r=new_buf(4)),r.write_shift(3,n.iStyleRef||n.s),r.write_shift(1,0),r}var parse_XLSBCodeName=parse_XLWideString,write_XLSBCodeName=write_XLWideString;function parse_XLNullableWideString(n){var r=n.read_shift(4);return r===0||r===4294967295?"":n.read_shift(r,"dbcs")}function write_XLNullableWideString(n,r){var _=!1;return r==null&&(_=!0,r=new_buf(127)),r.write_shift(4,n.length>0?n.length:4294967295),n.length>0&&r.write_shift(0,n,"dbcs"),_?r.slice(0,r.l):r}var parse_XLNameWideString=parse_XLWideString,parse_RelID=parse_XLNullableWideString,write_RelID=write_XLNullableWideString;function parse_RkNumber(n){var r=n.slice(n.l,n.l+4),_=r[0]&1,E=r[0]&2;n.l+=4;var S=E===0?__double([0,0,0,0,r[0]&252,r[1],r[2],r[3]],0):__readInt32LE(r,0)>>2;return _?S/100:S}function write_RkNumber(n,r){r==null&&(r=new_buf(4));var _=0,E=0,S=n*100;if(n==(n|0)&&n>=-(1<<29)&&n<1<<29?E=1:S==(S|0)&&S>=-(1<<29)&&S<1<<29&&(E=1,_=1),E)r.write_shift(-4,((_?S:n)<<2)+(_+2));else throw new Error("unsupported RkNumber "+n)}function parse_RfX(n){var r={s:{},e:{}};return r.s.r=n.read_shift(4),r.e.r=n.read_shift(4),r.s.c=n.read_shift(4),r.e.c=n.read_shift(4),r}function write_RfX(n,r){return r||(r=new_buf(16)),r.write_shift(4,n.s.r),r.write_shift(4,n.e.r),r.write_shift(4,n.s.c),r.write_shift(4,n.e.c),r}var parse_UncheckedRfX=parse_RfX,write_UncheckedRfX=write_RfX;function parse_Xnum(n){if(n.length-n.l<8)throw"XLS Xnum Buffer underflow";return n.read_shift(8,"f")}function write_Xnum(n,r){return(r||new_buf(8)).write_shift(8,n,"f")}function parse_BrtColor(n){var r={},_=n.read_shift(1),E=_>>>1,S=n.read_shift(1),C=n.read_shift(2,"i"),A=n.read_shift(1),I=n.read_shift(1),B=n.read_shift(1);switch(n.l++,E){case 0:r.auto=1;break;case 1:r.index=S;var O=XLSIcv[S];O&&(r.rgb=rgb2Hex(O));break;case 2:r.rgb=rgb2Hex([A,I,B]);break;case 3:r.theme=S;break}return C!=0&&(r.tint=C>0?C/32767:C/32768),r}function write_BrtColor(n,r){if(r||(r=new_buf(8)),!n||n.auto)return r.write_shift(4,0),r.write_shift(4,0),r;n.index!=null?(r.write_shift(1,2),r.write_shift(1,n.index)):n.theme!=null?(r.write_shift(1,6),r.write_shift(1,n.theme)):(r.write_shift(1,5),r.write_shift(1,0));var _=n.tint||0;if(_>0?_*=32767:_<0&&(_*=32768),r.write_shift(2,_),!n.rgb||n.theme!=null)r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);else{var E=n.rgb||"FFFFFF";typeof E=="number"&&(E=("000000"+E.toString(16)).slice(-6)),r.write_shift(1,parseInt(E.slice(0,2),16)),r.write_shift(1,parseInt(E.slice(2,4),16)),r.write_shift(1,parseInt(E.slice(4,6),16)),r.write_shift(1,255)}return r}function parse_FontFlags(n){var r=n.read_shift(1);n.l++;var _={fBold:r&1,fItalic:r&2,fUnderline:r&4,fStrikeout:r&8,fOutline:r&16,fShadow:r&32,fCondense:r&64,fExtend:r&128};return _}function write_FontFlags(n,r){r||(r=new_buf(2));var _=(n.italic?2:0)|(n.strike?8:0)|(n.outline?16:0)|(n.shadow?32:0)|(n.condense?64:0)|(n.extend?128:0);return r.write_shift(1,_),r.write_shift(1,0),r}function parse_ClipboardFormatOrString(n,r){var _={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},E=n.read_shift(4);switch(E){case 0:return"";case 4294967295:case 4294967294:return _[n.read_shift(4)]||""}if(E>400)throw new Error("Unsupported Clipboard: "+E.toString(16));return n.l-=4,n.read_shift(0,r==1?"lpstr":"lpwstr")}function parse_ClipboardFormatOrAnsiString(n){return parse_ClipboardFormatOrString(n,1)}function parse_ClipboardFormatOrUnicodeString(n){return parse_ClipboardFormatOrString(n,2)}var VT_I2=2,VT_I4=3,VT_BOOL=11,VT_VARIANT=12,VT_UI4=19,VT_FILETIME=64,VT_BLOB=65,VT_CF=71,VT_VECTOR_VARIANT=4108,VT_VECTOR_LPSTR=4126,VT_STRING=80,VT_USTR=81,VT_CUSTOM=[VT_STRING,VT_USTR],DocSummaryPIDDSI={1:{n:"CodePage",t:VT_I2},2:{n:"Category",t:VT_STRING},3:{n:"PresentationFormat",t:VT_STRING},4:{n:"ByteCount",t:VT_I4},5:{n:"LineCount",t:VT_I4},6:{n:"ParagraphCount",t:VT_I4},7:{n:"SlideCount",t:VT_I4},8:{n:"NoteCount",t:VT_I4},9:{n:"HiddenCount",t:VT_I4},10:{n:"MultimediaClipCount",t:VT_I4},11:{n:"ScaleCrop",t:VT_BOOL},12:{n:"HeadingPairs",t:VT_VECTOR_VARIANT},13:{n:"TitlesOfParts",t:VT_VECTOR_LPSTR},14:{n:"Manager",t:VT_STRING},15:{n:"Company",t:VT_STRING},16:{n:"LinksUpToDate",t:VT_BOOL},17:{n:"CharacterCount",t:VT_I4},19:{n:"SharedDoc",t:VT_BOOL},22:{n:"HyperlinksChanged",t:VT_BOOL},23:{n:"AppVersion",t:VT_I4,p:"version"},24:{n:"DigSig",t:VT_BLOB},26:{n:"ContentType",t:VT_STRING},27:{n:"ContentStatus",t:VT_STRING},28:{n:"Language",t:VT_STRING},29:{n:"Version",t:VT_STRING},255:{},2147483648:{n:"Locale",t:VT_UI4},2147483651:{n:"Behavior",t:VT_UI4},1919054434:{}},SummaryPIDSI={1:{n:"CodePage",t:VT_I2},2:{n:"Title",t:VT_STRING},3:{n:"Subject",t:VT_STRING},4:{n:"Author",t:VT_STRING},5:{n:"Keywords",t:VT_STRING},6:{n:"Comments",t:VT_STRING},7:{n:"Template",t:VT_STRING},8:{n:"LastAuthor",t:VT_STRING},9:{n:"RevNumber",t:VT_STRING},10:{n:"EditTime",t:VT_FILETIME},11:{n:"LastPrinted",t:VT_FILETIME},12:{n:"CreatedDate",t:VT_FILETIME},13:{n:"ModifiedDate",t:VT_FILETIME},14:{n:"PageCount",t:VT_I4},15:{n:"WordCount",t:VT_I4},16:{n:"CharCount",t:VT_I4},17:{n:"Thumbnail",t:VT_CF},18:{n:"Application",t:VT_STRING},19:{n:"DocSecurity",t:VT_I4},255:{},2147483648:{n:"Locale",t:VT_UI4},2147483651:{n:"Behavior",t:VT_UI4},1919054434:{}},CountryEnum={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},XLSFillPattern=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function rgbify(n){return n.map(function(r){return[r>>16&255,r>>8&255,r&255]})}var _XLSIcv=rgbify([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,0,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),XLSIcv=dup(_XLSIcv),BErr={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},RBErr={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},XLSLblBuiltIn=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"],ct2type={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},CT_LIST={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function new_ct(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function parse_ct(n){var r=new_ct();if(!n||!n.match)return r;var _={};if((n.match(tagregex)||[]).forEach(function(E){var S=parsexmltag(E);switch(S[0].replace(nsregex,"<")){case"<?xml":break;case"<Types":r.xmlns=S["xmlns"+(S[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":_[S.Extension.toLowerCase()]=S.ContentType;break;case"<Override":r[ct2type[S.ContentType]]!==void 0&&r[ct2type[S.ContentType]].push(S.PartName);break}}),r.xmlns!==XMLNS.CT)throw new Error("Unknown Namespace: "+r.xmlns);return r.calcchain=r.calcchains.length>0?r.calcchains[0]:"",r.sst=r.strs.length>0?r.strs[0]:"",r.style=r.styles.length>0?r.styles[0]:"",r.defaults=_,delete r.calcchains,r}function write_ct(n,r,_){var E=evert_arr(ct2type),S=[],C;_||(S[S.length]=XML_HEADER,S[S.length]=writextag("Types",null,{xmlns:XMLNS.CT,"xmlns:xsd":XMLNS.xsd,"xmlns:xsi":XMLNS.xsi}),S=S.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(O){return writextag("Default",null,{Extension:O[0],ContentType:O[1]})})));var A=function(O){n[O]&&n[O].length>0&&(C=n[O][0],S[S.length]=writextag("Override",null,{PartName:(C[0]=="/"?"":"/")+C,ContentType:CT_LIST[O][r.bookType]||CT_LIST[O].xlsx}))},I=function(O){(n[O]||[]).forEach(function(N){S[S.length]=writextag("Override",null,{PartName:(N[0]=="/"?"":"/")+N,ContentType:CT_LIST[O][r.bookType]||CT_LIST[O].xlsx})})},B=function(O){(n[O]||[]).forEach(function(N){S[S.length]=writextag("Override",null,{PartName:(N[0]=="/"?"":"/")+N,ContentType:E[O][0]})})};return A("workbooks"),I("sheets"),I("charts"),B("themes"),["strs","styles"].forEach(A),["coreprops","extprops","custprops"].forEach(B),B("vba"),B("comments"),B("threadedcomments"),B("drawings"),I("metadata"),B("people"),!_&&S.length>2&&(S[S.length]="</Types>",S[1]=S[1].replace("/>",">")),S.join("")}var RELS={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",CONN:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/connections",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function get_rels_path(n){var r=n.lastIndexOf("/");return n.slice(0,r+1)+"_rels/"+n.slice(r+1)+".rels"}function parse_rels(n,r){var _={"!id":{}};if(!n)return _;r.charAt(0)!=="/"&&(r="/"+r);var E={};return(n.match(tagregex)||[]).forEach(function(S){var C=parsexmltag(S);if(C[0]==="<Relationship"){var A={};A.Type=C.Type,A.Target=C.Target,A.Id=C.Id,C.TargetMode&&(A.TargetMode=C.TargetMode);var I=C.TargetMode==="External"?C.Target:resolve_path(C.Target,r);_[I]=A,E[C.Id]=A}}),_["!id"]=E,_}function write_rels(n){var r=[XML_HEADER,writextag("Relationships",null,{xmlns:XMLNS.RELS})];return keys(n["!id"]).forEach(function(_){r[r.length]=writextag("Relationship",null,n["!id"][_])}),r.length>2&&(r[r.length]="</Relationships>",r[1]=r[1].replace("/>",">")),r.join("")}function add_rels(n,r,_,E,S,C){if(S||(S={}),n["!id"]||(n["!id"]={}),n["!idx"]||(n["!idx"]=1),r<0)for(r=n["!idx"];n["!id"]["rId"+r];++r);if(n["!idx"]=r+1,S.Id="rId"+r,S.Type=E,S.Target=_,C?S.TargetMode=C:[RELS.HLINK,RELS.XPATH,RELS.XMISS].indexOf(S.Type)>-1&&(S.TargetMode="External"),n["!id"][S.Id])throw new Error("Cannot rewrite rId "+r);return n["!id"][S.Id]=S,n[("/"+S.Target).replace("//","/")]=S,r}var CT_ODS="application/vnd.oasis.opendocument.spreadsheet";function parse_manifest(n,r){for(var _=xlml_normalize(n),E,S;E=xlmlregex.exec(_);)switch(E[3]){case"manifest":break;case"file-entry":if(S=parsexmltag(E[0],!1),S.path=="/"&&S.type!==CT_ODS)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(r&&r.WTF)throw E}}function write_manifest(n){var r=[XML_HEADER];r.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),r.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var _=0;_<n.length;++_)r.push('  <manifest:file-entry manifest:full-path="'+n[_][0]+'" manifest:media-type="'+n[_][1]+`"/>
`);return r.push("</manifest:manifest>"),r.join("")}function write_rdf_type(n,r,_){return['  <rdf:Description rdf:about="'+n+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(_||"odf")+"#"+r+`"/>
`,`  </rdf:Description>
`].join("")}function write_rdf_has(n,r){return['  <rdf:Description rdf:about="'+n+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+r+`"/>
`,`  </rdf:Description>
`].join("")}function write_rdf(n){var r=[XML_HEADER];r.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var _=0;_!=n.length;++_)r.push(write_rdf_type(n[_][0],n[_][1])),r.push(write_rdf_has("",n[_][0]));return r.push(write_rdf_type("","Document","pkg")),r.push("</rdf:RDF>"),r.join("")}function write_meta_ods(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+XLSX.version+"</meta:generator></office:meta></office:document-meta>"}var CORE_PROPS=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],CORE_PROPS_REGEX=function(){for(var n=new Array(CORE_PROPS.length),r=0;r<CORE_PROPS.length;++r){var _=CORE_PROPS[r],E="(?:"+_[0].slice(0,_[0].indexOf(":"))+":)"+_[0].slice(_[0].indexOf(":")+1);n[r]=new RegExp("<"+E+"[^>]*>([\\s\\S]*?)</"+E+">")}return n}();function parse_core_props(n){var r={};n=utf8read(n);for(var _=0;_<CORE_PROPS.length;++_){var E=CORE_PROPS[_],S=n.match(CORE_PROPS_REGEX[_]);S!=null&&S.length>0&&(r[E[1]]=unescapexml(S[1])),E[2]==="date"&&r[E[1]]&&(r[E[1]]=parseDate(r[E[1]]))}return r}function cp_doit(n,r,_,E,S){S[n]!=null||r==null||r===""||(S[n]=r,r=escapexml(r),E[E.length]=_?writextag(n,r,_):writetag(n,r))}function write_core_props(n,r){var _=r||{},E=[XML_HEADER,writextag("cp:coreProperties",null,{"xmlns:cp":XMLNS.CORE_PROPS,"xmlns:dc":XMLNS.dc,"xmlns:dcterms":XMLNS.dcterms,"xmlns:dcmitype":XMLNS.dcmitype,"xmlns:xsi":XMLNS.xsi})],S={};if(!n&&!_.Props)return E.join("");n&&(n.CreatedDate!=null&&cp_doit("dcterms:created",typeof n.CreatedDate=="string"?n.CreatedDate:write_w3cdtf(n.CreatedDate,_.WTF),{"xsi:type":"dcterms:W3CDTF"},E,S),n.ModifiedDate!=null&&cp_doit("dcterms:modified",typeof n.ModifiedDate=="string"?n.ModifiedDate:write_w3cdtf(n.ModifiedDate,_.WTF),{"xsi:type":"dcterms:W3CDTF"},E,S));for(var C=0;C!=CORE_PROPS.length;++C){var A=CORE_PROPS[C],I=_.Props&&_.Props[A[1]]!=null?_.Props[A[1]]:n?n[A[1]]:null;I===!0?I="1":I===!1?I="0":typeof I=="number"&&(I=String(I)),I!=null&&cp_doit(A[0],I,null,E,S)}return E.length>2&&(E[E.length]="</cp:coreProperties>",E[1]=E[1].replace("/>",">")),E.join("")}var EXT_PROPS=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],PseudoPropsPairs=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function load_props_pairs(n,r,_,E){var S=[];if(typeof n=="string")S=parseVector(n,E);else for(var C=0;C<n.length;++C)S=S.concat(n[C].map(function(N){return{v:N}}));var A=typeof r=="string"?parseVector(r,E).map(function(N){return N.v}):r,I=0,B=0;if(A.length>0)for(var O=0;O!==S.length;O+=2){switch(B=+S[O+1].v,S[O].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":_.Worksheets=B,_.SheetNames=A.slice(I,I+B);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":_.NamedRanges=B,_.DefinedNames=A.slice(I,I+B);break;case"Charts":case"Diagramme":_.Chartsheets=B,_.ChartNames=A.slice(I,I+B);break}I+=B}}function parse_ext_props(n,r,_){var E={};return r||(r={}),n=utf8read(n),EXT_PROPS.forEach(function(S){var C=(n.match(matchtag(S[0]))||[])[1];switch(S[2]){case"string":C&&(r[S[1]]=unescapexml(C));break;case"bool":r[S[1]]=C==="true";break;case"raw":var A=n.match(new RegExp("<"+S[0]+"[^>]*>([\\s\\S]*?)</"+S[0]+">"));A&&A.length>0&&(E[S[1]]=A[1]);break}}),E.HeadingPairs&&E.TitlesOfParts&&load_props_pairs(E.HeadingPairs,E.TitlesOfParts,r,_),r}function write_ext_props(n){var r=[],_=writextag;return n||(n={}),n.Application="SheetJS",r[r.length]=XML_HEADER,r[r.length]=writextag("Properties",null,{xmlns:XMLNS.EXT_PROPS,"xmlns:vt":XMLNS.vt}),EXT_PROPS.forEach(function(E){if(n[E[1]]!==void 0){var S;switch(E[2]){case"string":S=escapexml(String(n[E[1]]));break;case"bool":S=n[E[1]]?"true":"false";break}S!==void 0&&(r[r.length]=_(E[0],S))}}),r[r.length]=_("HeadingPairs",_("vt:vector",_("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+_("vt:variant",_("vt:i4",String(n.Worksheets))),{size:2,baseType:"variant"})),r[r.length]=_("TitlesOfParts",_("vt:vector",n.SheetNames.map(function(E){return"<vt:lpstr>"+escapexml(E)+"</vt:lpstr>"}).join(""),{size:n.Worksheets,baseType:"lpstr"})),r.length>2&&(r[r.length]="</Properties>",r[1]=r[1].replace("/>",">")),r.join("")}var custregex=/<[^>]+>[^<]*/g;function parse_cust_props(n,r){var _={},E="",S=n.match(custregex);if(S)for(var C=0;C!=S.length;++C){var A=S[C],I=parsexmltag(A);switch(strip_ns(I[0])){case"<?xml":break;case"<Properties":break;case"<property":E=unescapexml(I.name);break;case"</property>":E=null;break;default:if(A.indexOf("<vt:")===0){var B=A.split(">"),O=B[0].slice(4),N=B[1];switch(O){case"lpstr":case"bstr":case"lpwstr":_[E]=unescapexml(N);break;case"bool":_[E]=parsexmlbool(N);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":_[E]=parseInt(N,10);break;case"r4":case"r8":case"decimal":_[E]=parseFloat(N);break;case"filetime":case"date":_[E]=parseDate(N);break;case"cy":case"error":_[E]=unescapexml(N);break;default:if(O.slice(-1)=="/")break;r.WTF&&typeof console<"u"&&console.warn("Unexpected",A,O,B)}}else if(A.slice(0,2)!=="</"){if(r.WTF)throw new Error(A)}}}return _}function write_cust_props(n){var r=[XML_HEADER,writextag("Properties",null,{xmlns:XMLNS.CUST_PROPS,"xmlns:vt":XMLNS.vt})];if(!n)return r.join("");var _=1;return keys(n).forEach(function(S){++_,r[r.length]=writextag("property",write_vt(n[S],!0),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:_,name:escapexml(S)})}),r.length>2&&(r[r.length]="</Properties>",r[1]=r[1].replace("/>",">")),r.join("")}var XLMLDocPropsMap={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},evert_XLMLDPM;function xlml_set_prop(n,r,_){evert_XLMLDPM||(evert_XLMLDPM=evert(XLMLDocPropsMap)),r=evert_XLMLDPM[r]||r,n[r]=_}function xlml_write_docprops(n,r){var _=[];return keys(XLMLDocPropsMap).map(function(E){for(var S=0;S<CORE_PROPS.length;++S)if(CORE_PROPS[S][1]==E)return CORE_PROPS[S];for(S=0;S<EXT_PROPS.length;++S)if(EXT_PROPS[S][1]==E)return EXT_PROPS[S];throw E}).forEach(function(E){if(n[E[1]]!=null){var S=r&&r.Props&&r.Props[E[1]]!=null?r.Props[E[1]]:n[E[1]];switch(E[2]){case"date":S=new Date(S).toISOString().replace(/\.\d*Z/,"Z");break}typeof S=="number"?S=String(S):S===!0||S===!1?S=S?"1":"0":S instanceof Date&&(S=new Date(S).toISOString().replace(/\.\d*Z/,"")),_.push(writetag(XLMLDocPropsMap[E[1]]||E[1],S))}}),writextag("DocumentProperties",_.join(""),{xmlns:XLMLNS.o})}function xlml_write_custprops(n,r){var _=["Worksheets","SheetNames"],E="CustomDocumentProperties",S=[];return n&&keys(n).forEach(function(C){if(Object.prototype.hasOwnProperty.call(n,C)){for(var A=0;A<CORE_PROPS.length;++A)if(C==CORE_PROPS[A][1])return;for(A=0;A<EXT_PROPS.length;++A)if(C==EXT_PROPS[A][1])return;for(A=0;A<_.length;++A)if(C==_[A])return;var I=n[C],B="string";typeof I=="number"?(B="float",I=String(I)):I===!0||I===!1?(B="boolean",I=I?"1":"0"):I=String(I),S.push(writextag(escapexmltag(C),I,{"dt:dt":B}))}}),r&&keys(r).forEach(function(C){if(Object.prototype.hasOwnProperty.call(r,C)&&!(n&&Object.prototype.hasOwnProperty.call(n,C))){var A=r[C],I="string";typeof A=="number"?(I="float",A=String(A)):A===!0||A===!1?(I="boolean",A=A?"1":"0"):A instanceof Date?(I="dateTime.tz",A=A.toISOString()):A=String(A),S.push(writextag(escapexmltag(C),A,{"dt:dt":I}))}}),"<"+E+' xmlns="'+XLMLNS.o+'">'+S.join("")+"</"+E+">"}function parse_FILETIME(n){var r=n.read_shift(4),_=n.read_shift(4);return new Date((_/1e7*Math.pow(2,32)+r/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function write_FILETIME(n){var r=typeof n=="string"?new Date(Date.parse(n)):n,_=r.getTime()/1e3+11644473600,E=_%Math.pow(2,32),S=(_-E)/Math.pow(2,32);E*=1e7,S*=1e7;var C=E/Math.pow(2,32)|0;C>0&&(E=E%Math.pow(2,32),S+=C);var A=new_buf(8);return A.write_shift(4,E),A.write_shift(4,S),A}function parse_lpstr(n,r,_){var E=n.l,S=n.read_shift(0,"lpstr-cp");if(_)for(;n.l-E&3;)++n.l;return S}function parse_lpwstr(n,r,_){var E=n.read_shift(0,"lpwstr");return _&&(n.l+=4-(E.length+1&3)&3),E}function parse_VtStringBase(n,r,_){return r===31?parse_lpwstr(n):parse_lpstr(n,r,_)}function parse_VtString(n,r,_){return parse_VtStringBase(n,r,_===!1?0:4)}function parse_VtUnalignedString(n,r){if(!r)throw new Error("VtUnalignedString must have positive length");return parse_VtStringBase(n,r,0)}function parse_VtVecLpwstrValue(n){for(var r=n.read_shift(4),_=[],E=0;E!=r;++E){var S=n.l;_[E]=n.read_shift(0,"lpwstr").replace(chr0,""),n.l-S&2&&(n.l+=2)}return _}function parse_VtVecUnalignedLpstrValue(n){for(var r=n.read_shift(4),_=[],E=0;E!=r;++E)_[E]=n.read_shift(0,"lpstr-cp").replace(chr0,"");return _}function parse_VtHeadingPair(n){var r=n.l,_=parse_TypedPropertyValue(n,VT_USTR);n[n.l]==0&&n[n.l+1]==0&&n.l-r&2&&(n.l+=2);var E=parse_TypedPropertyValue(n,VT_I4);return[_,E]}function parse_VtVecHeadingPairValue(n){for(var r=n.read_shift(4),_=[],E=0;E<r/2;++E)_.push(parse_VtHeadingPair(n));return _}function parse_dictionary(n,r){for(var _=n.read_shift(4),E={},S=0;S!=_;++S){var C=n.read_shift(4),A=n.read_shift(4);E[C]=n.read_shift(A,r===1200?"utf16le":"utf8").replace(chr0,"").replace(chr1,"!"),r===1200&&A%2&&(n.l+=2)}return n.l&3&&(n.l=n.l>>3<<2),E}function parse_BLOB(n){var r=n.read_shift(4),_=n.slice(n.l,n.l+r);return n.l+=r,(r&3)>0&&(n.l+=4-(r&3)&3),_}function parse_ClipboardData(n){var r={};return r.Size=n.read_shift(4),n.l+=r.Size+3-(r.Size-1)%4,r}function parse_TypedPropertyValue(n,r,_){var E=n.read_shift(2),S,C=_||{};if(n.l+=2,r!==VT_VARIANT&&E!==r&&VT_CUSTOM.indexOf(r)===-1&&!((r&65534)==4126&&(E&65534)==4126))throw new Error("Expected type "+r+" saw "+E);switch(r===VT_VARIANT?E:r){case 2:return S=n.read_shift(2,"i"),C.raw||(n.l+=2),S;case 3:return S=n.read_shift(4,"i"),S;case 11:return n.read_shift(4)!==0;case 19:return S=n.read_shift(4),S;case 30:return parse_lpstr(n,E,4).replace(chr0,"");case 31:return parse_lpwstr(n);case 64:return parse_FILETIME(n);case 65:return parse_BLOB(n);case 71:return parse_ClipboardData(n);case 80:return parse_VtString(n,E,!C.raw).replace(chr0,"");case 81:return parse_VtUnalignedString(n,E).replace(chr0,"");case 4108:return parse_VtVecHeadingPairValue(n);case 4126:case 4127:return E==4127?parse_VtVecLpwstrValue(n):parse_VtVecUnalignedLpstrValue(n);default:throw new Error("TypedPropertyValue unrecognized type "+r+" "+E)}}function write_TypedPropertyValue(n,r){var _=new_buf(4),E=new_buf(4);switch(_.write_shift(4,n==80?31:n),n){case 3:E.write_shift(-4,r);break;case 5:E=new_buf(8),E.write_shift(8,r,"f");break;case 11:E.write_shift(4,r?1:0);break;case 64:E=write_FILETIME(r);break;case 31:case 80:for(E=new_buf(4+2*(r.length+1)+(r.length%2?0:2)),E.write_shift(4,r.length+1),E.write_shift(0,r,"dbcs");E.l!=E.length;)E.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+n+" "+r)}return bconcat([_,E])}function parse_PropertySet(n,r){var _=n.l,E=n.read_shift(4),S=n.read_shift(4),C=[],A=0,I=0,B=-1,O={};for(A=0;A!=S;++A){var N=n.read_shift(4),U=n.read_shift(4);C[A]=[N,U+_]}C.sort(function(oe,ue){return oe[1]-ue[1]});var j={};for(A=0;A!=S;++A){if(n.l!==C[A][1]){var z=!0;if(A>0&&r)switch(r[C[A-1][0]].t){case 2:n.l+2===C[A][1]&&(n.l+=2,z=!1);break;case 80:n.l<=C[A][1]&&(n.l=C[A][1],z=!1);break;case 4108:n.l<=C[A][1]&&(n.l=C[A][1],z=!1);break}if((!r||A==0)&&n.l<=C[A][1]&&(z=!1,n.l=C[A][1]),z)throw new Error("Read Error: Expected address "+C[A][1]+" at "+n.l+" :"+A)}if(r){if(C[A][0]==0&&C.length>A+1&&C[A][1]==C[A+1][1])continue;var Z=r[C[A][0]];if(j[Z.n]=parse_TypedPropertyValue(n,Z.t,{raw:!0}),Z.p==="version"&&(j[Z.n]=String(j[Z.n]>>16)+"."+("0000"+String(j[Z.n]&65535)).slice(-4)),Z.n=="CodePage")switch(j[Z.n]){case 0:j[Z.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:set_cp(I=j[Z.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+j[Z.n])}}else if(C[A][0]===1){if(I=j.CodePage=parse_TypedPropertyValue(n,VT_I2),set_cp(I),B!==-1){var X=n.l;n.l=C[B][1],O=parse_dictionary(n,I),n.l=X}}else if(C[A][0]===0){if(I===0){B=A,n.l=C[A+1][1];continue}O=parse_dictionary(n,I)}else{var Q=O[C[A][0]],se;switch(n[n.l]){case 65:n.l+=4,se=parse_BLOB(n);break;case 30:n.l+=4,se=parse_VtString(n,n[n.l-4]).replace(/\u0000+$/,"");break;case 31:n.l+=4,se=parse_VtString(n,n[n.l-4]).replace(/\u0000+$/,"");break;case 3:n.l+=4,se=n.read_shift(4,"i");break;case 19:n.l+=4,se=n.read_shift(4);break;case 5:n.l+=4,se=n.read_shift(8,"f");break;case 11:n.l+=4,se=parsebool(n,4);break;case 64:n.l+=4,se=parseDate(parse_FILETIME(n));break;default:throw new Error("unparsed value: "+n[n.l])}j[Q]=se}}return n.l=_+E,j}var XLSPSSkip=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function guess_property_type(n){switch(typeof n){case"boolean":return 11;case"number":return(n|0)==n?3:5;case"string":return 31;case"object":if(n instanceof Date)return 64;break}return-1}function write_PropertySet(n,r,_){var E=new_buf(8),S=[],C=[],A=8,I=0,B=new_buf(8),O=new_buf(8);if(B.write_shift(4,2),B.write_shift(4,1200),O.write_shift(4,1),C.push(B),S.push(O),A+=8+B.length,!r){O=new_buf(8),O.write_shift(4,0),S.unshift(O);var N=[new_buf(4)];for(N[0].write_shift(4,n.length),I=0;I<n.length;++I){var U=n[I][0];for(B=new_buf(8+2*(U.length+1)+(U.length%2?0:2)),B.write_shift(4,I+2),B.write_shift(4,U.length+1),B.write_shift(0,U,"dbcs");B.l!=B.length;)B.write_shift(1,0);N.push(B)}B=bconcat(N),C.unshift(B),A+=8+B.length}for(I=0;I<n.length;++I)if(!(r&&!r[n[I][0]])&&!(XLSPSSkip.indexOf(n[I][0])>-1||PseudoPropsPairs.indexOf(n[I][0])>-1)&&n[I][1]!=null){var j=n[I][1],z=0;if(r){z=+r[n[I][0]];var Z=_[z];if(Z.p=="version"&&typeof j=="string"){var X=j.split(".");j=(+X[0]<<16)+(+X[1]||0)}B=write_TypedPropertyValue(Z.t,j)}else{var Q=guess_property_type(j);Q==-1&&(Q=31,j=String(j)),B=write_TypedPropertyValue(Q,j)}C.push(B),O=new_buf(8),O.write_shift(4,r?z:2+I),S.push(O),A+=8+B.length}var se=8*(C.length+1);for(I=0;I<C.length;++I)S[I].write_shift(4,se),se+=C[I].length;return E.write_shift(4,A),E.write_shift(4,C.length),bconcat([E].concat(S).concat(C))}function parse_PropertySetStream(n,r,_){var E=n.content;if(!E)return{};prep_blob(E,0);var S,C,A,I,B=0;E.chk("feff","Byte Order: "),E.read_shift(2);var O=E.read_shift(4),N=E.read_shift(16);if(N!==CFB.utils.consts.HEADER_CLSID&&N!==_)throw new Error("Bad PropertySet CLSID "+N);if(S=E.read_shift(4),S!==1&&S!==2)throw new Error("Unrecognized #Sets: "+S);if(C=E.read_shift(16),I=E.read_shift(4),S===1&&I!==E.l)throw new Error("Length mismatch: "+I+" !== "+E.l);S===2&&(A=E.read_shift(16),B=E.read_shift(4));var U=parse_PropertySet(E,r),j={SystemIdentifier:O};for(var z in U)j[z]=U[z];if(j.FMTID=C,S===1)return j;if(B-E.l==2&&(E.l+=2),E.l!==B)throw new Error("Length mismatch 2: "+E.l+" !== "+B);var Z;try{Z=parse_PropertySet(E,null)}catch{}for(z in Z)j[z]=Z[z];return j.FMTID=[C,A],j}function write_PropertySetStream(n,r,_,E,S,C){var A=new_buf(S?68:48),I=[A];A.write_shift(2,65534),A.write_shift(2,0),A.write_shift(4,842412599),A.write_shift(16,CFB.utils.consts.HEADER_CLSID,"hex"),A.write_shift(4,S?2:1),A.write_shift(16,r,"hex"),A.write_shift(4,S?68:48);var B=write_PropertySet(n,_,E);if(I.push(B),S){var O=write_PropertySet(S,null,null);A.write_shift(16,C,"hex"),A.write_shift(4,68+B.length),I.push(O)}return bconcat(I)}function parsenoop2(n,r){return n.read_shift(r),null}function writezeroes(n,r){r||(r=new_buf(n));for(var _=0;_<n;++_)r.write_shift(1,0);return r}function parslurp(n,r,_){for(var E=[],S=n.l+r;n.l<S;)E.push(_(n,S-n.l));if(S!==n.l)throw new Error("Slurp error");return E}function parsebool(n,r){return n.read_shift(r)===1}function writebool(n,r){return r||(r=new_buf(2)),r.write_shift(2,+!!n),r}function parseuint16(n){return n.read_shift(2,"u")}function writeuint16(n,r){return r||(r=new_buf(2)),r.write_shift(2,n),r}function parseuint16a(n,r){return parslurp(n,r,parseuint16)}function parse_Bes(n){var r=n.read_shift(1),_=n.read_shift(1);return _===1?r:r===1}function write_Bes(n,r,_){return _||(_=new_buf(2)),_.write_shift(1,r=="e"?+n:+!!n),_.write_shift(1,r=="e"?1:0),_}function parse_ShortXLUnicodeString(n,r,_){var E=n.read_shift(_&&_.biff>=12?2:1),S="sbcs-cont",C=current_codepage;if(_&&_.biff>=8&&(current_codepage=1200),!_||_.biff==8){var A=n.read_shift(1);A&&(S="dbcs-cont")}else _.biff==12&&(S="wstr");_.biff>=2&&_.biff<=5&&(S="cpstr");var I=E?n.read_shift(E,S):"";return current_codepage=C,I}function parse_XLUnicodeRichExtendedString(n){var r=current_codepage;current_codepage=1200;var _=n.read_shift(2),E=n.read_shift(1),S=E&4,C=E&8,A=1+(E&1),I=0,B,O={};C&&(I=n.read_shift(2)),S&&(B=n.read_shift(4));var N=A==2?"dbcs-cont":"sbcs-cont",U=_===0?"":n.read_shift(_,N);return C&&(n.l+=4*I),S&&(n.l+=B),O.t=U,C||(O.raw="<t>"+O.t+"</t>",O.r=O.t),current_codepage=r,O}function write_XLUnicodeRichExtendedString(n){var r=n.t||"",_=new_buf(3);_.write_shift(2,r.length),_.write_shift(1,1);var E=new_buf(2*r.length);E.write_shift(2*r.length,r,"utf16le");var S=[_,E];return bconcat(S)}function parse_XLUnicodeStringNoCch(n,r,_){var E;if(_){if(_.biff>=2&&_.biff<=5)return n.read_shift(r,"cpstr");if(_.biff>=12)return n.read_shift(r,"dbcs-cont")}var S=n.read_shift(1);return S===0?E=n.read_shift(r,"sbcs-cont"):E=n.read_shift(r,"dbcs-cont"),E}function parse_XLUnicodeString(n,r,_){var E=n.read_shift(_&&_.biff==2?1:2);return E===0?(n.l++,""):parse_XLUnicodeStringNoCch(n,E,_)}function parse_XLUnicodeString2(n,r,_){if(_.biff>5)return parse_XLUnicodeString(n,r,_);var E=n.read_shift(1);return E===0?(n.l++,""):n.read_shift(E,_.biff<=4||!n.lens?"cpstr":"sbcs-cont")}function write_XLUnicodeString(n,r,_){return _||(_=new_buf(3+2*n.length)),_.write_shift(2,n.length),_.write_shift(1,1),_.write_shift(31,n,"utf16le"),_}function parse_ControlInfo(n){var r=n.read_shift(1);n.l++;var _=n.read_shift(2);return n.l+=2,[r,_]}function parse_URLMoniker(n){var r=n.read_shift(4),_=n.l,E=!1;r>24&&(n.l+=r-24,n.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(E=!0),n.l=_);var S=n.read_shift((E?r-24:r)>>1,"utf16le").replace(chr0,"");return E&&(n.l+=24),S}function parse_FileMoniker(n){for(var r=n.read_shift(2),_="";r-- >0;)_+="../";var E=n.read_shift(0,"lpstr-ansi");if(n.l+=2,n.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var S=n.read_shift(4);if(S===0)return _+E.replace(/\\/g,"/");var C=n.read_shift(4);if(n.read_shift(2)!=3)throw new Error("Bad FileMoniker");var A=n.read_shift(C>>1,"utf16le").replace(chr0,"");return _+A}function parse_HyperlinkMoniker(n,r){var _=n.read_shift(16);switch(_){case"e0c9ea79f9bace118c8200aa004ba90b":return parse_URLMoniker(n);case"0303000000000000c000000000000046":return parse_FileMoniker(n);default:throw new Error("Unsupported Moniker "+_)}}function parse_HyperlinkString(n){var r=n.read_shift(4),_=r>0?n.read_shift(r,"utf16le").replace(chr0,""):"";return _}function write_HyperlinkString(n,r){r||(r=new_buf(6+n.length*2)),r.write_shift(4,1+n.length);for(var _=0;_<n.length;++_)r.write_shift(2,n.charCodeAt(_));return r.write_shift(2,0),r}function parse_Hyperlink(n,r){var _=n.l+r,E=n.read_shift(4);if(E!==2)throw new Error("Unrecognized streamVersion: "+E);var S=n.read_shift(2);n.l+=2;var C,A,I,B,O="",N,U;S&16&&(C=parse_HyperlinkString(n,_-n.l)),S&128&&(A=parse_HyperlinkString(n,_-n.l)),(S&257)===257&&(I=parse_HyperlinkString(n,_-n.l)),(S&257)===1&&(B=parse_HyperlinkMoniker(n,_-n.l)),S&8&&(O=parse_HyperlinkString(n,_-n.l)),S&32&&(N=n.read_shift(16)),S&64&&(U=parse_FILETIME(n)),n.l=_;var j=A||I||B||"";j&&O&&(j+="#"+O),j||(j="#"+O),S&2&&j.charAt(0)=="/"&&j.charAt(1)!="/"&&(j="file://"+j);var z={Target:j};return N&&(z.guid=N),U&&(z.time=U),C&&(z.Tooltip=C),z}function write_Hyperlink(n){var r=new_buf(512),_=0,E=n.Target;E.slice(0,7)=="file://"&&(E=E.slice(7));var S=E.indexOf("#"),C=S>-1?31:23;switch(E.charAt(0)){case"#":C=28;break;case".":C&=-3;break}r.write_shift(4,2),r.write_shift(4,C);var A=[8,6815827,6619237,4849780,83];for(_=0;_<A.length;++_)r.write_shift(4,A[_]);if(C==28)E=E.slice(1),write_HyperlinkString(E,r);else if(C&2){for(A="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),_=0;_<A.length;++_)r.write_shift(1,parseInt(A[_],16));var I=S>-1?E.slice(0,S):E;for(r.write_shift(4,2*(I.length+1)),_=0;_<I.length;++_)r.write_shift(2,I.charCodeAt(_));r.write_shift(2,0),C&8&&write_HyperlinkString(S>-1?E.slice(S+1):"",r)}else{for(A="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),_=0;_<A.length;++_)r.write_shift(1,parseInt(A[_],16));for(var B=0;E.slice(B*3,B*3+3)=="../"||E.slice(B*3,B*3+3)=="..\\";)++B;for(r.write_shift(2,B),r.write_shift(4,E.length-3*B+1),_=0;_<E.length-3*B;++_)r.write_shift(1,E.charCodeAt(_+3*B)&255);for(r.write_shift(1,0),r.write_shift(2,65535),r.write_shift(2,57005),_=0;_<6;++_)r.write_shift(4,0)}return r.slice(0,r.l)}function parse_LongRGBA(n){var r=n.read_shift(1),_=n.read_shift(1),E=n.read_shift(1),S=n.read_shift(1);return[r,_,E,S]}function parse_LongRGB(n,r){var _=parse_LongRGBA(n);return _[3]=0,_}function parse_XLSCell(n){var r=n.read_shift(2),_=n.read_shift(2),E=n.read_shift(2);return{r,c:_,ixfe:E}}function write_XLSCell(n,r,_,E){return E||(E=new_buf(6)),E.write_shift(2,n),E.write_shift(2,r),E.write_shift(2,_||0),E}function parse_frtHeader(n){var r=n.read_shift(2),_=n.read_shift(2);return n.l+=8,{type:r,flags:_}}function parse_OptXLUnicodeString(n,r,_){return r===0?"":parse_XLUnicodeString2(n,r,_)}function parse_XTI(n,r,_){var E=_.biff>8?4:2,S=n.read_shift(E),C=n.read_shift(E,"i"),A=n.read_shift(E,"i");return[S,C,A]}function parse_RkRec(n){var r=n.read_shift(2),_=parse_RkNumber(n);return[r,_]}function parse_AddinUdf(n,r,_){n.l+=4,r-=4;var E=n.l+r,S=parse_ShortXLUnicodeString(n,r,_),C=n.read_shift(2);if(E-=n.l,C!==E)throw new Error("Malformed AddinUdf: padding = "+E+" != "+C);return n.l+=C,S}function parse_Ref8U(n){var r=n.read_shift(2),_=n.read_shift(2),E=n.read_shift(2),S=n.read_shift(2);return{s:{c:E,r},e:{c:S,r:_}}}function write_Ref8U(n,r){return r||(r=new_buf(8)),r.write_shift(2,n.s.r),r.write_shift(2,n.e.r),r.write_shift(2,n.s.c),r.write_shift(2,n.e.c),r}function parse_RefU(n){var r=n.read_shift(2),_=n.read_shift(2),E=n.read_shift(1),S=n.read_shift(1);return{s:{c:E,r},e:{c:S,r:_}}}var parse_Ref=parse_RefU;function parse_FtCmo(n){n.l+=4;var r=n.read_shift(2),_=n.read_shift(2),E=n.read_shift(2);return n.l+=12,[_,r,E]}function parse_FtNts(n){var r={};return n.l+=4,n.l+=16,r.fSharedNote=n.read_shift(2),n.l+=4,r}function parse_FtCf(n){var r={};return n.l+=4,n.cf=n.read_shift(2),r}function parse_FtSkip(n){n.l+=2,n.l+=n.read_shift(2)}var FtTab={0:parse_FtSkip,4:parse_FtSkip,5:parse_FtSkip,6:parse_FtSkip,7:parse_FtCf,8:parse_FtSkip,9:parse_FtSkip,10:parse_FtSkip,11:parse_FtSkip,12:parse_FtSkip,13:parse_FtNts,14:parse_FtSkip,15:parse_FtSkip,16:parse_FtSkip,17:parse_FtSkip,18:parse_FtSkip,19:parse_FtSkip,20:parse_FtSkip,21:parse_FtCmo};function parse_FtArray(n,r){for(var _=n.l+r,E=[];n.l<_;){var S=n.read_shift(2);n.l-=2;try{E.push(FtTab[S](n,_-n.l))}catch{return n.l=_,E}}return n.l!=_&&(n.l=_),E}function parse_BOF(n,r){var _={BIFFVer:0,dt:0};switch(_.BIFFVer=n.read_shift(2),r-=2,r>=2&&(_.dt=n.read_shift(2),n.l-=2),_.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(r>6)throw new Error("Unexpected BIFF Ver "+_.BIFFVer)}return n.read_shift(r),_}function write_BOF(n,r,_){var E=1536,S=16;switch(_.bookType){case"biff8":break;case"biff5":E=1280,S=8;break;case"biff4":E=4,S=6;break;case"biff3":E=3,S=6;break;case"biff2":E=2,S=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var C=new_buf(S);return C.write_shift(2,E),C.write_shift(2,r),S>4&&C.write_shift(2,29282),S>6&&C.write_shift(2,1997),S>8&&(C.write_shift(2,49161),C.write_shift(2,1),C.write_shift(2,1798),C.write_shift(2,0)),C}function parse_InterfaceHdr(n,r){return r===0||n.read_shift(2),1200}function parse_WriteAccess(n,r,_){if(_.enc)return n.l+=r,"";var E=n.l,S=parse_XLUnicodeString2(n,0,_);return n.read_shift(r+E-n.l),S}function write_WriteAccess(n,r){var _=!r||r.biff==8,E=new_buf(_?112:54);for(E.write_shift(r.biff==8?2:1,7),_&&E.write_shift(1,0),E.write_shift(4,859007059),E.write_shift(4,5458548|(_?0:536870912));E.l<E.length;)E.write_shift(1,_?0:32);return E}function parse_WsBool(n,r,_){var E=_&&_.biff==8||r==2?n.read_shift(2):(n.l+=r,0);return{fDialog:E&16,fBelow:E&64,fRight:E&128}}function parse_BoundSheet8(n,r,_){var E=n.read_shift(4),S=n.read_shift(1)&3,C=n.read_shift(1);switch(C){case 0:C="Worksheet";break;case 1:C="Macrosheet";break;case 2:C="Chartsheet";break;case 6:C="VBAModule";break}var A=parse_ShortXLUnicodeString(n,0,_);return A.length===0&&(A="Sheet1"),{pos:E,hs:S,dt:C,name:A}}function write_BoundSheet8(n,r){var _=!r||r.biff>=8?2:1,E=new_buf(8+_*n.name.length);E.write_shift(4,n.pos),E.write_shift(1,n.hs||0),E.write_shift(1,n.dt),E.write_shift(1,n.name.length),r.biff>=8&&E.write_shift(1,1),E.write_shift(_*n.name.length,n.name,r.biff<8?"sbcs":"utf16le");var S=E.slice(0,E.l);return S.l=E.l,S}function parse_SST(n,r){for(var _=n.l+r,E=n.read_shift(4),S=n.read_shift(4),C=[],A=0;A!=S&&n.l<_;++A)C.push(parse_XLUnicodeRichExtendedString(n));return C.Count=E,C.Unique=S,C}function write_SST(n,r){var _=new_buf(8);_.write_shift(4,n.Count),_.write_shift(4,n.Unique);for(var E=[],S=0;S<n.length;++S)E[S]=write_XLUnicodeRichExtendedString(n[S]);var C=bconcat([_].concat(E));return C.parts=[_.length].concat(E.map(function(A){return A.length})),C}function parse_ExtSST(n,r){var _={};return _.dsst=n.read_shift(2),n.l+=r-2,_}function parse_Row(n){var r={};r.r=n.read_shift(2),r.c=n.read_shift(2),r.cnt=n.read_shift(2)-r.c;var _=n.read_shift(2);n.l+=4;var E=n.read_shift(1);return n.l+=3,E&7&&(r.level=E&7),E&32&&(r.hidden=!0),E&64&&(r.hpt=_/20),r}function parse_ForceFullCalculation(n){var r=parse_frtHeader(n);if(r.type!=2211)throw new Error("Invalid Future Record "+r.type);var _=n.read_shift(4);return _!==0}function parse_RecalcId(n){return n.read_shift(2),n.read_shift(4)}function parse_DefaultRowHeight(n,r,_){var E=0;_&&_.biff==2||(E=n.read_shift(2));var S=n.read_shift(2);_&&_.biff==2&&(E=1-(S>>15),S&=32767);var C={Unsynced:E&1,DyZero:(E&2)>>1,ExAsc:(E&4)>>2,ExDsc:(E&8)>>3};return[C,S]}function parse_Window1(n){var r=n.read_shift(2),_=n.read_shift(2),E=n.read_shift(2),S=n.read_shift(2),C=n.read_shift(2),A=n.read_shift(2),I=n.read_shift(2),B=n.read_shift(2),O=n.read_shift(2);return{Pos:[r,_],Dim:[E,S],Flags:C,CurTab:A,FirstTab:I,Selected:B,TabRatio:O}}function write_Window1(){var n=new_buf(18);return n.write_shift(2,0),n.write_shift(2,0),n.write_shift(2,29280),n.write_shift(2,17600),n.write_shift(2,56),n.write_shift(2,0),n.write_shift(2,0),n.write_shift(2,1),n.write_shift(2,500),n}function parse_Window2(n,r,_){if(_&&_.biff>=2&&_.biff<5)return{};var E=n.read_shift(2);return{RTL:E&64}}function write_Window2(n){var r=new_buf(18),_=1718;return n&&n.RTL&&(_|=64),r.write_shift(2,_),r.write_shift(4,0),r.write_shift(4,64),r.write_shift(4,0),r.write_shift(4,0),r}function parse_Pane(){}function parse_Font(n,r,_){var E={dyHeight:n.read_shift(2),fl:n.read_shift(2)};switch(_&&_.biff||8){case 2:break;case 3:case 4:n.l+=2;break;default:n.l+=10;break}return E.name=parse_ShortXLUnicodeString(n,0,_),E}function write_Font(n,r){var _=n.name||"Arial",E=r&&r.biff==5,S=E?15+_.length:16+2*_.length,C=new_buf(S);return C.write_shift(2,(n.sz||12)*20),C.write_shift(4,0),C.write_shift(2,400),C.write_shift(4,0),C.write_shift(2,0),C.write_shift(1,_.length),E||C.write_shift(1,1),C.write_shift((E?1:2)*_.length,_,E?"sbcs":"utf16le"),C}function parse_LabelSst(n){var r=parse_XLSCell(n);return r.isst=n.read_shift(4),r}function write_LabelSst(n,r,_,E){var S=new_buf(10);return write_XLSCell(n,r,E,S),S.write_shift(4,_),S}function parse_Label(n,r,_){_.biffguess&&_.biff==2&&(_.biff=5);var E=n.l+r,S=parse_XLSCell(n);_.biff==2&&n.l++;var C=parse_XLUnicodeString(n,E-n.l,_);return S.val=C,S}function write_Label(n,r,_,E,S){var C=!S||S.biff==8,A=new_buf(8+ +C+(1+C)*_.length);return write_XLSCell(n,r,E,A),A.write_shift(2,_.length),C&&A.write_shift(1,1),A.write_shift((1+C)*_.length,_,C?"utf16le":"sbcs"),A}function parse_Format(n,r,_){var E=n.read_shift(2),S=parse_XLUnicodeString2(n,0,_);return[E,S]}function write_Format(n,r,_,E){var S=_&&_.biff==5;E||(E=new_buf(S?3+r.length:5+2*r.length)),E.write_shift(2,n),E.write_shift(S?1:2,r.length),S||E.write_shift(1,1),E.write_shift((S?1:2)*r.length,r,S?"sbcs":"utf16le");var C=E.length>E.l?E.slice(0,E.l):E;return C.l==null&&(C.l=C.length),C}var parse_BIFF2Format=parse_XLUnicodeString2;function parse_Dimensions(n,r,_){var E=n.l+r,S=_.biff==8||!_.biff?4:2,C=n.read_shift(S),A=n.read_shift(S),I=n.read_shift(2),B=n.read_shift(2);return n.l=E,{s:{r:C,c:I},e:{r:A,c:B}}}function write_Dimensions(n,r){var _=r.biff==8||!r.biff?4:2,E=new_buf(2*_+6);return E.write_shift(_,n.s.r),E.write_shift(_,n.e.r+1),E.write_shift(2,n.s.c),E.write_shift(2,n.e.c+1),E.write_shift(2,0),E}function parse_RK(n){var r=n.read_shift(2),_=n.read_shift(2),E=parse_RkRec(n);return{r,c:_,ixfe:E[0],rknum:E[1]}}function parse_MulRk(n,r){for(var _=n.l+r-2,E=n.read_shift(2),S=n.read_shift(2),C=[];n.l<_;)C.push(parse_RkRec(n));if(n.l!==_)throw new Error("MulRK read error");var A=n.read_shift(2);if(C.length!=A-S+1)throw new Error("MulRK length mismatch");return{r:E,c:S,C:A,rkrec:C}}function parse_MulBlank(n,r){for(var _=n.l+r-2,E=n.read_shift(2),S=n.read_shift(2),C=[];n.l<_;)C.push(n.read_shift(2));if(n.l!==_)throw new Error("MulBlank read error");var A=n.read_shift(2);if(C.length!=A-S+1)throw new Error("MulBlank length mismatch");return{r:E,c:S,C:A,ixfe:C}}function parse_CellStyleXF(n,r,_,E){var S={},C=n.read_shift(4),A=n.read_shift(4),I=n.read_shift(4),B=n.read_shift(2);return S.patternType=XLSFillPattern[I>>26],E.cellStyles&&(S.alc=C&7,S.fWrap=C>>3&1,S.alcV=C>>4&7,S.fJustLast=C>>7&1,S.trot=C>>8&255,S.cIndent=C>>16&15,S.fShrinkToFit=C>>20&1,S.iReadOrder=C>>22&2,S.fAtrNum=C>>26&1,S.fAtrFnt=C>>27&1,S.fAtrAlc=C>>28&1,S.fAtrBdr=C>>29&1,S.fAtrPat=C>>30&1,S.fAtrProt=C>>31&1,S.dgLeft=A&15,S.dgRight=A>>4&15,S.dgTop=A>>8&15,S.dgBottom=A>>12&15,S.icvLeft=A>>16&127,S.icvRight=A>>23&127,S.grbitDiag=A>>30&3,S.icvTop=I&127,S.icvBottom=I>>7&127,S.icvDiag=I>>14&127,S.dgDiag=I>>21&15,S.icvFore=B&127,S.icvBack=B>>7&127,S.fsxButton=B>>14&1),S}function parse_XF(n,r,_){var E={};return E.ifnt=n.read_shift(2),E.numFmtId=n.read_shift(2),E.flags=n.read_shift(2),E.fStyle=E.flags>>2&1,r-=6,E.data=parse_CellStyleXF(n,r,E.fStyle,_),E}function write_XF(n,r,_,E){var S=_&&_.biff==5;E||(E=new_buf(S?16:20)),E.write_shift(2,0),n.style?(E.write_shift(2,n.numFmtId||0),E.write_shift(2,65524)):(E.write_shift(2,n.numFmtId||0),E.write_shift(2,r<<4));var C=0;return n.numFmtId>0&&S&&(C|=1024),E.write_shift(4,C),E.write_shift(4,0),S||E.write_shift(4,0),E.write_shift(2,0),E}function parse_Guts(n){n.l+=4;var r=[n.read_shift(2),n.read_shift(2)];if(r[0]!==0&&r[0]--,r[1]!==0&&r[1]--,r[0]>7||r[1]>7)throw new Error("Bad Gutters: "+r.join("|"));return r}function write_Guts(n){var r=new_buf(8);return r.write_shift(4,0),r.write_shift(2,n[0]?n[0]+1:0),r.write_shift(2,n[1]?n[1]+1:0),r}function parse_BoolErr(n,r,_){var E=parse_XLSCell(n);(_.biff==2||r==9)&&++n.l;var S=parse_Bes(n);return E.val=S,E.t=S===!0||S===!1?"b":"e",E}function write_BoolErr(n,r,_,E,S,C){var A=new_buf(8);return write_XLSCell(n,r,E,A),write_Bes(_,C,A),A}function parse_Number(n,r,_){_.biffguess&&_.biff==2&&(_.biff=5);var E=parse_XLSCell(n),S=parse_Xnum(n);return E.val=S,E}function write_Number(n,r,_,E){var S=new_buf(14);return write_XLSCell(n,r,E,S),write_Xnum(_,S),S}var parse_XLHeaderFooter=parse_OptXLUnicodeString;function parse_SupBook(n,r,_){var E=n.l+r,S=n.read_shift(2),C=n.read_shift(2);if(_.sbcch=C,C==1025||C==14849)return[C,S];if(C<1||C>255)throw new Error("Unexpected SupBook type: "+C);for(var A=parse_XLUnicodeStringNoCch(n,C),I=[];E>n.l;)I.push(parse_XLUnicodeString(n));return[C,S,A,I]}function parse_ExternName(n,r,_){var E=n.read_shift(2),S,C={fBuiltIn:E&1,fWantAdvise:E>>>1&1,fWantPict:E>>>2&1,fOle:E>>>3&1,fOleLink:E>>>4&1,cf:E>>>5&1023,fIcon:E>>>15&1};return _.sbcch===14849&&(S=parse_AddinUdf(n,r-2,_)),C.body=S||n.read_shift(r-2),typeof S=="string"&&(C.Name=S),C}function parse_Lbl(n,r,_){var E=n.l+r,S=n.read_shift(2),C=n.read_shift(1),A=n.read_shift(1),I=n.read_shift(_&&_.biff==2?1:2),B=0;(!_||_.biff>=5)&&(_.biff!=5&&(n.l+=2),B=n.read_shift(2),_.biff==5&&(n.l+=2),n.l+=4);var O=parse_XLUnicodeStringNoCch(n,A,_);S&32&&(O=XLSLblBuiltIn[O.charCodeAt(0)]);var N=E-n.l;_&&_.biff==2&&--N;var U=E==n.l||I===0||!(N>0)?[]:parse_NameParsedFormula(n,N,_,I);return{chKey:C,Name:O,itab:B,rgce:U}}function parse_ExternSheet(n,r,_){if(_.biff<8)return parse_BIFF5ExternSheet(n,r,_);for(var E=[],S=n.l+r,C=n.read_shift(_.biff>8?4:2);C--!==0;)E.push(parse_XTI(n,_.biff>8?12:6,_));if(n.l!=S)throw new Error("Bad ExternSheet: "+n.l+" != "+S);return E}function parse_BIFF5ExternSheet(n,r,_){n[n.l+1]==3&&n[n.l]++;var E=parse_ShortXLUnicodeString(n,r,_);return E.charCodeAt(0)==3?E.slice(1):E}function parse_NameCmt(n,r,_){if(_.biff<8){n.l+=r;return}var E=n.read_shift(2),S=n.read_shift(2),C=parse_XLUnicodeStringNoCch(n,E,_),A=parse_XLUnicodeStringNoCch(n,S,_);return[C,A]}function parse_ShrFmla(n,r,_){var E=parse_RefU(n);n.l++;var S=n.read_shift(1);return r-=8,[parse_SharedParsedFormula(n,r,_),S,E]}function parse_Array(n,r,_){var E=parse_Ref(n);switch(_.biff){case 2:n.l++,r-=7;break;case 3:case 4:n.l+=2,r-=8;break;default:n.l+=6,r-=12}return[E,parse_ArrayParsedFormula(n,r,_)]}function parse_MTRSettings(n){var r=n.read_shift(4)!==0,_=n.read_shift(4)!==0,E=n.read_shift(4);return[r,_,E]}function parse_NoteSh(n,r,_){if(!(_.biff<8)){var E=n.read_shift(2),S=n.read_shift(2),C=n.read_shift(2),A=n.read_shift(2),I=parse_XLUnicodeString2(n,0,_);return _.biff<8&&n.read_shift(1),[{r:E,c:S},I,A,C]}}function parse_Note(n,r,_){return parse_NoteSh(n,r,_)}function parse_MergeCells(n,r){for(var _=[],E=n.read_shift(2);E--;)_.push(parse_Ref8U(n));return _}function write_MergeCells(n){var r=new_buf(2+n.length*8);r.write_shift(2,n.length);for(var _=0;_<n.length;++_)write_Ref8U(n[_],r);return r}function parse_Obj(n,r,_){if(_&&_.biff<8)return parse_BIFF5Obj(n,r,_);var E=parse_FtCmo(n),S=parse_FtArray(n,r-22,E[1]);return{cmo:E,ft:S}}var parse_BIFF5OT={8:function(n,r){var _=n.l+r;n.l+=10;var E=n.read_shift(2);n.l+=4,n.l+=2,n.l+=2,n.l+=2,n.l+=4;var S=n.read_shift(1);return n.l+=S,n.l=_,{fmt:E}}};function parse_BIFF5Obj(n,r,_){n.l+=4;var E=n.read_shift(2),S=n.read_shift(2),C=n.read_shift(2);n.l+=2,n.l+=2,n.l+=2,n.l+=2,n.l+=2,n.l+=2,n.l+=2,n.l+=2,n.l+=2,n.l+=6,r-=36;var A=[];return A.push((parse_BIFF5OT[E]||parsenoop)(n,r,_)),{cmo:[S,E,C],ft:A}}function parse_TxO(n,r,_){var E=n.l,S="";try{n.l+=4;var C=(_.lastobj||{cmo:[0,0]}).cmo[1],A;[0,5,7,11,12,14].indexOf(C)==-1?n.l+=6:A=parse_ControlInfo(n,6,_);var I=n.read_shift(2);n.read_shift(2),parseuint16(n,2);var B=n.read_shift(2);n.l+=B;for(var O=1;O<n.lens.length-1;++O){if(n.l-E!=n.lens[O])throw new Error("TxO: bad continue record");var N=n[n.l],U=parse_XLUnicodeStringNoCch(n,n.lens[O+1]-n.lens[O]-1);if(S+=U,S.length>=(N?I:2*I))break}if(S.length!==I&&S.length!==I*2)throw new Error("cchText: "+I+" != "+S.length);return n.l=E+r,{t:S}}catch{return n.l=E+r,{t:S}}}function parse_HLink(n,r){var _=parse_Ref8U(n);n.l+=16;var E=parse_Hyperlink(n,r-24);return[_,E]}function write_HLink(n){var r=new_buf(24),_=decode_cell(n[0]);r.write_shift(2,_.r),r.write_shift(2,_.r),r.write_shift(2,_.c),r.write_shift(2,_.c);for(var E="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),S=0;S<16;++S)r.write_shift(1,parseInt(E[S],16));return bconcat([r,write_Hyperlink(n[1])])}function parse_HLinkTooltip(n,r){n.read_shift(2);var _=parse_Ref8U(n),E=n.read_shift((r-10)/2,"dbcs-cont");return E=E.replace(chr0,""),[_,E]}function write_HLinkTooltip(n){var r=n[1].Tooltip,_=new_buf(10+2*(r.length+1));_.write_shift(2,2048);var E=decode_cell(n[0]);_.write_shift(2,E.r),_.write_shift(2,E.r),_.write_shift(2,E.c),_.write_shift(2,E.c);for(var S=0;S<r.length;++S)_.write_shift(2,r.charCodeAt(S));return _.write_shift(2,0),_}function parse_Country(n){var r=[0,0],_;return _=n.read_shift(2),r[0]=CountryEnum[_]||_,_=n.read_shift(2),r[1]=CountryEnum[_]||_,r}function write_Country(n){return n||(n=new_buf(4)),n.write_shift(2,1),n.write_shift(2,1),n}function parse_ClrtClient(n){for(var r=n.read_shift(2),_=[];r-- >0;)_.push(parse_LongRGB(n));return _}function parse_Palette(n){for(var r=n.read_shift(2),_=[];r-- >0;)_.push(parse_LongRGB(n));return _}function parse_XFCRC(n){n.l+=2;var r={cxfs:0,crc:0};return r.cxfs=n.read_shift(2),r.crc=n.read_shift(4),r}function parse_ColInfo(n,r,_){if(!_.cellStyles)return parsenoop(n,r);var E=_&&_.biff>=12?4:2,S=n.read_shift(E),C=n.read_shift(E),A=n.read_shift(E),I=n.read_shift(E),B=n.read_shift(2);E==2&&(n.l+=2);var O={s:S,e:C,w:A,ixfe:I,flags:B};return(_.biff>=5||!_.biff)&&(O.level=B>>8&7),O}function write_ColInfo(n,r){var _=new_buf(12);_.write_shift(2,r),_.write_shift(2,r),_.write_shift(2,n.width*256),_.write_shift(2,0);var E=0;return n.hidden&&(E|=1),_.write_shift(1,E),E=n.level||0,_.write_shift(1,E),_.write_shift(2,0),_}function parse_Setup(n,r){var _={};return r<32||(n.l+=16,_.header=parse_Xnum(n),_.footer=parse_Xnum(n),n.l+=2),_}function parse_ShtProps(n,r,_){var E={area:!1};if(_.biff!=5)return n.l+=r,E;var S=n.read_shift(1);return n.l+=3,S&16&&(E.area=!0),E}function write_RRTabId(n){for(var r=new_buf(2*n),_=0;_<n;++_)r.write_shift(2,_+1);return r}var parse_Blank=parse_XLSCell,parse_Scl=parseuint16a,parse_String=parse_XLUnicodeString;function parse_ImData(n){var r=n.read_shift(2),_=n.read_shift(2),E=n.read_shift(4),S={fmt:r,env:_,len:E,data:n.slice(n.l,n.l+E)};return n.l+=E,S}function parse_BIFF2STR(n,r,_){_.biffguess&&_.biff==5&&(_.biff=2);var E=parse_XLSCell(n);++n.l;var S=parse_XLUnicodeString2(n,r-7,_);return E.t="str",E.val=S,E}function parse_BIFF2NUM(n){var r=parse_XLSCell(n);++n.l;var _=parse_Xnum(n);return r.t="n",r.val=_,r}function write_BIFF2NUM(n,r,_){var E=new_buf(15);return write_BIFF2Cell(E,n,r),E.write_shift(8,_,"f"),E}function parse_BIFF2INT(n){var r=parse_XLSCell(n);++n.l;var _=n.read_shift(2);return r.t="n",r.val=_,r}function write_BIFF2INT(n,r,_){var E=new_buf(9);return write_BIFF2Cell(E,n,r),E.write_shift(2,_),E}function parse_BIFF2STRING(n){var r=n.read_shift(1);return r===0?(n.l++,""):n.read_shift(r,"sbcs-cont")}function parse_BIFF2FONTXTRA(n,r){n.l+=6,n.l+=2,n.l+=1,n.l+=3,n.l+=1,n.l+=r-13}function parse_RString(n,r,_){var E=n.l+r,S=parse_XLSCell(n),C=n.read_shift(2),A=parse_XLUnicodeStringNoCch(n,C,_);return n.l=E,S.t="str",S.val=A,S}var DBF_SUPPORTED_VERSIONS=[2,3,48,49,131,139,140,245],DBF=function(){var n={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},r=evert({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function _(I,B){var O=[],N=new_raw_buf(1);switch(B.type){case"base64":N=s2a(Base64_decode(I));break;case"binary":N=s2a(I);break;case"buffer":case"array":N=I;break}prep_blob(N,0);var U=N.read_shift(1),j=!!(U&136),z=!1,Z=!1;switch(U){case 2:break;case 3:break;case 48:z=!0,j=!0;break;case 49:z=!0,j=!0;break;case 131:break;case 139:break;case 140:Z=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+U.toString(16))}var X=0,Q=521;U==2&&(X=N.read_shift(2)),N.l+=3,U!=2&&(X=N.read_shift(4)),X>1048576&&(X=1e6),U!=2&&(Q=N.read_shift(2));var se=N.read_shift(2);B.codepage,U!=2&&(N.l+=16,N.read_shift(1),N[N.l]!==0&&n[N[N.l]],N.l+=1,N.l+=2),Z&&(N.l+=36);for(var oe=[],ue={},we=Math.min(N.length,U==2?521:Q-10-(z?264:0)),Te=Z?32:11;N.l<we&&N[N.l]!=13;)switch(ue={},ue.name=a2s(N.slice(N.l,N.l+Te)).replace(/[\u0000\r\n].*$/g,""),N.l+=Te,ue.type=String.fromCharCode(N.read_shift(1)),U!=2&&!Z&&(ue.offset=N.read_shift(4)),ue.len=N.read_shift(1),U==2&&(ue.offset=N.read_shift(2)),ue.dec=N.read_shift(1),ue.name.length&&oe.push(ue),U!=2&&(N.l+=Z?13:14),ue.type){case"B":(!z||ue.len!=8)&&B.WTF&&console.log("Skipping "+ue.name+":"+ue.type);break;case"G":case"P":B.WTF&&console.log("Skipping "+ue.name+":"+ue.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+ue.type)}if(N[N.l]!==13&&(N.l=Q-1),N.read_shift(1)!==13)throw new Error("DBF Terminator not found "+N.l+" "+N[N.l]);N.l=Q;var xe=0,Re=0;for(O[0]=[],Re=0;Re!=oe.length;++Re)O[0][Re]=oe[Re].name;for(;X-- >0;){if(N[N.l]===42){N.l+=se;continue}for(++N.l,O[++xe]=[],Re=0,Re=0;Re!=oe.length;++Re){var Ne=N.slice(N.l,N.l+oe[Re].len);N.l+=oe[Re].len,prep_blob(Ne,0);var Fe=a2s(Ne);switch(oe[Re].type){case"C":Fe.trim().length&&(O[xe][Re]=Fe.replace(/\s+$/,""));break;case"D":Fe.length===8?O[xe][Re]=new Date(+Fe.slice(0,4),+Fe.slice(4,6)-1,+Fe.slice(6,8)):O[xe][Re]=Fe;break;case"F":O[xe][Re]=parseFloat(Fe.trim());break;case"+":case"I":O[xe][Re]=Z?Ne.read_shift(-4,"i")^2147483648:Ne.read_shift(4,"i");break;case"L":switch(Fe.trim().toUpperCase()){case"Y":case"T":O[xe][Re]=!0;break;case"N":case"F":O[xe][Re]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+Fe+"|")}break;case"M":if(!j)throw new Error("DBF Unexpected MEMO for type "+U.toString(16));O[xe][Re]="##MEMO##"+(Z?parseInt(Fe.trim(),10):Ne.read_shift(4));break;case"N":Fe=Fe.replace(/\u0000/g,"").trim(),Fe&&Fe!="."&&(O[xe][Re]=+Fe||0);break;case"@":O[xe][Re]=new Date(Ne.read_shift(-8,"f")-621356832e5);break;case"T":O[xe][Re]=new Date((Ne.read_shift(4)-2440588)*864e5+Ne.read_shift(4));break;case"Y":O[xe][Re]=Ne.read_shift(4,"i")/1e4+Ne.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":O[xe][Re]=-Ne.read_shift(-8,"f");break;case"B":if(z&&oe[Re].len==8){O[xe][Re]=Ne.read_shift(8,"f");break}case"G":case"P":Ne.l+=oe[Re].len;break;case"0":if(oe[Re].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+oe[Re].type)}}}if(U!=2&&N.l<N.length&&N[N.l++]!=26)throw new Error("DBF EOF Marker missing "+(N.l-1)+" of "+N.length+" "+N[N.l-1].toString(16));return B&&B.sheetRows&&(O=O.slice(0,B.sheetRows)),B.DBF=oe,O}function E(I,B){var O=B||{};O.dateNF||(O.dateNF="yyyymmdd");var N=aoa_to_sheet(_(I,O),O);return N["!cols"]=O.DBF.map(function(U){return{wch:U.len,DBF:U}}),delete O.DBF,N}function S(I,B){try{var O=sheet_to_workbook(E(I,B),B);return O.bookType="dbf",O}catch(N){if(B&&B.WTF)throw N}return{SheetNames:[],Sheets:{}}}var C={B:8,C:250,L:1,D:8,"?":0,"":0};function A(I,B){var O=B||{},N=current_codepage;if(+O.codepage>=0&&set_cp(+O.codepage),O.type=="string")throw new Error("Cannot write DBF to JS string");var U=buf_array(),j=sheet_to_json(I,{header:1,raw:!0,cellDates:!0}),z=j[0],Z=j.slice(1),X=I["!cols"]||[],Q=0,se=0,oe=0,ue=1;for(Q=0;Q<z.length;++Q){if(((X[Q]||{}).DBF||{}).name){z[Q]=X[Q].DBF.name,++oe;continue}if(z[Q]!=null){if(++oe,typeof z[Q]=="number"&&(z[Q]=z[Q].toString(10)),typeof z[Q]!="string")throw new Error("DBF Invalid column name "+z[Q]+" |"+typeof z[Q]+"|");if(z.indexOf(z[Q])!==Q){for(se=0;se<1024;++se)if(z.indexOf(z[Q]+"_"+se)==-1){z[Q]+="_"+se;break}}}}var we=safe_decode_range(I["!ref"]),Te=[],xe=[],Re=[];for(Q=0;Q<=we.e.c-we.s.c;++Q){var Ne="",Fe="",ht=0,nt=[];for(se=0;se<Z.length;++se)Z[se][Q]!=null&&nt.push(Z[se][Q]);if(nt.length==0||z[Q]==null){Te[Q]="?";continue}for(se=0;se<nt.length;++se){switch(typeof nt[se]){case"number":Fe="B";break;case"string":Fe="C";break;case"boolean":Fe="L";break;case"object":Fe=nt[se]instanceof Date?"D":"C";break;default:Fe="C"}ht=Math.max(ht,String(nt[se]).length),Ne=Ne&&Ne!=Fe?"C":Fe}ht>250&&(ht=250),Fe=((X[Q]||{}).DBF||{}).type,Fe=="C"&&X[Q].DBF.len>ht&&(ht=X[Q].DBF.len),Ne=="B"&&Fe=="N"&&(Ne="N",Re[Q]=X[Q].DBF.dec,ht=X[Q].DBF.len),xe[Q]=Ne=="C"||Fe=="N"?ht:C[Ne]||0,ue+=xe[Q],Te[Q]=Ne}var Ee=U.next(32);for(Ee.write_shift(4,318902576),Ee.write_shift(4,Z.length),Ee.write_shift(2,296+32*oe),Ee.write_shift(2,ue),Q=0;Q<4;++Q)Ee.write_shift(4,0);var Ce=+r[current_codepage]||3;for(Ee.write_shift(4,0|Ce<<8),n[Ce]!=+O.codepage&&(O.codepage&&console.error("DBF Unsupported codepage "+current_codepage+", using 1252"),current_codepage=1252),Q=0,se=0;Q<z.length;++Q)if(z[Q]!=null){var _e=U.next(32),Ie=(z[Q].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);_e.write_shift(1,Ie,"sbcs"),_e.write_shift(1,Te[Q]=="?"?"C":Te[Q],"sbcs"),_e.write_shift(4,se),_e.write_shift(1,xe[Q]||C[Te[Q]]||0),_e.write_shift(1,Re[Q]||0),_e.write_shift(1,2),_e.write_shift(4,0),_e.write_shift(1,0),_e.write_shift(4,0),_e.write_shift(4,0),se+=xe[Q]||C[Te[Q]]||0}var He=U.next(264);for(He.write_shift(4,13),Q=0;Q<65;++Q)He.write_shift(4,0);for(Q=0;Q<Z.length;++Q){var Be=U.next(ue);for(Be.write_shift(1,0),se=0;se<z.length;++se)if(z[se]!=null)switch(Te[se]){case"L":Be.write_shift(1,Z[Q][se]==null?63:Z[Q][se]?84:70);break;case"B":Be.write_shift(8,Z[Q][se]||0,"f");break;case"N":var Ge="0";for(typeof Z[Q][se]=="number"&&(Ge=Z[Q][se].toFixed(Re[se]||0)),Ge.length>xe[se]&&(Ge=Ge.slice(0,xe[se])),oe=0;oe<xe[se]-Ge.length;++oe)Be.write_shift(1,32);Be.write_shift(1,Ge,"sbcs");break;case"D":Z[Q][se]?(Be.write_shift(4,("0000"+Z[Q][se].getFullYear()).slice(-4),"sbcs"),Be.write_shift(2,("00"+(Z[Q][se].getMonth()+1)).slice(-2),"sbcs"),Be.write_shift(2,("00"+Z[Q][se].getDate()).slice(-2),"sbcs")):Be.write_shift(8,"00000000","sbcs");break;case"C":var je=Be.l,Ve=String(Z[Q][se]!=null?Z[Q][se]:"").slice(0,xe[se]);for(Be.write_shift(1,Ve,"cpstr"),je+=xe[se]-Be.l,oe=0;oe<je;++oe)Be.write_shift(1,32);break}}return current_codepage=N,U.next(1).write_shift(1,26),U.end()}return{to_workbook:S,to_sheet:E,from_sheet:A}}(),SYLK=function(){var n={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},r=new RegExp("\x1BN("+keys(n).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),_=function(U,j){var z=n[j];return typeof z=="number"?_getansi(z):z},E=function(U,j,z){var Z=j.charCodeAt(0)-32<<4|z.charCodeAt(0)-48;return Z==59?U:_getansi(Z)};n["|"]=254;function S(U,j){switch(j.type){case"base64":return C(Base64_decode(U),j);case"binary":return C(U,j);case"buffer":return C(has_buf&&Buffer.isBuffer(U)?U.toString("binary"):a2s(U),j);case"array":return C(cc2str(U),j)}throw new Error("Unrecognized type "+j.type)}function C(U,j){var z=U.split(/[\n\r]+/),Z=-1,X=-1,Q=0,se=0,oe=[],ue=[],we=null,Te={},xe=[],Re=[],Ne=[],Fe=0,ht,nt={Workbook:{WBProps:{},Names:[]}};for(+j.codepage>=0&&set_cp(+j.codepage);Q!==z.length;++Q){Fe=0;var Ee=z[Q].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,E).replace(r,_),Ce=Ee.replace(/;;/g,"\0").split(";").map(function(dt){return dt.replace(/\u0000/g,";")}),_e=Ce[0],Ie;if(Ee.length>0)switch(_e){case"ID":break;case"E":break;case"B":break;case"O":for(se=1;se<Ce.length;++se)switch(Ce[se].charAt(0)){case"V":{var He=parseInt(Ce[se].slice(1),10);He>=1&&He<=4&&(nt.Workbook.WBProps.date1904=!0)}break}break;case"W":break;case"P":switch(Ce[1].charAt(0)){case"P":ue.push(Ee.slice(3).replace(/;;/g,";"));break}break;case"NN":{var Be={Sheet:0};for(se=1;se<Ce.length;++se)switch(Ce[se].charAt(0)){case"N":Be.Name=Ce[se].slice(1);break;case"E":Be.Ref=(j&&j.sheet||"Sheet1")+"!"+rc_to_a1(Ce[se].slice(1));break}nt.Workbook.Names.push(Be)}break;case"C":var Ge=!1,je=!1,Ve=!1,Pe=!1,Me=-1,tt=-1,Ke="",mt="z";for(se=1;se<Ce.length;++se)switch(Ce[se].charAt(0)){case"A":break;case"X":X=parseInt(Ce[se].slice(1),10)-1,je=!0;break;case"Y":for(Z=parseInt(Ce[se].slice(1),10)-1,je||(X=0),ht=oe.length;ht<=Z;++ht)oe[ht]=[];break;case"K":Ie=Ce[se].slice(1),Ie.charAt(0)==='"'?(Ie=Ie.slice(1,Ie.length-1),mt="s"):Ie==="TRUE"||Ie==="FALSE"?(Ie=Ie==="TRUE",mt="b"):isNaN(fuzzynum(Ie))?isNaN(fuzzydate(Ie).getDate())||(Ie=parseDate(Ie),mt="d",j.cellDates||(mt="n",Ie=datenum(Ie,nt.Workbook.WBProps.date1904))):(Ie=fuzzynum(Ie),mt="n",we!==null&&fmt_is_date(we)&&j.cellDates&&(Ie=numdate(nt.Workbook.WBProps.date1904?Ie+1462:Ie),mt="d")),Ge=!0;break;case"E":Pe=!0,Ke=rc_to_a1(Ce[se].slice(1),{r:Z,c:X});break;case"S":Ve=!0;break;case"G":break;case"R":Me=parseInt(Ce[se].slice(1),10)-1;break;case"C":tt=parseInt(Ce[se].slice(1),10)-1;break;default:if(j&&j.WTF)throw new Error("SYLK bad record "+Ee)}if(Ge&&(oe[Z][X]?(oe[Z][X].t=mt,oe[Z][X].v=Ie):oe[Z][X]={t:mt,v:Ie},we&&(oe[Z][X].z=we),j.cellText!==!1&&we&&(oe[Z][X].w=SSF_format(oe[Z][X].z,oe[Z][X].v,{date1904:nt.Workbook.WBProps.date1904})),we=null),Ve){if(Pe)throw new Error("SYLK shared formula cannot have own formula");var ct=Me>-1&&oe[Me][tt];if(!ct||!ct[1])throw new Error("SYLK shared formula cannot find base");Ke=shift_formula_str(ct[1],{r:Z-Me,c:X-tt})}Ke&&(oe[Z][X]?oe[Z][X].f=Ke:oe[Z][X]={t:"n",f:Ke});break;case"F":var Qe=0;for(se=1;se<Ce.length;++se)switch(Ce[se].charAt(0)){case"X":X=parseInt(Ce[se].slice(1),10)-1,++Qe;break;case"Y":for(Z=parseInt(Ce[se].slice(1),10)-1,ht=oe.length;ht<=Z;++ht)oe[ht]=[];break;case"M":Fe=parseInt(Ce[se].slice(1),10)/20;break;case"F":break;case"G":break;case"P":we=ue[parseInt(Ce[se].slice(1),10)];break;case"S":break;case"D":break;case"N":break;case"W":for(Ne=Ce[se].slice(1).split(" "),ht=parseInt(Ne[0],10);ht<=parseInt(Ne[1],10);++ht)Fe=parseInt(Ne[2],10),Re[ht-1]=Fe===0?{hidden:!0}:{wch:Fe};break;case"C":X=parseInt(Ce[se].slice(1),10)-1,Re[X]||(Re[X]={});break;case"R":Z=parseInt(Ce[se].slice(1),10)-1,xe[Z]||(xe[Z]={}),Fe>0?(xe[Z].hpt=Fe,xe[Z].hpx=pt2px(Fe)):Fe===0&&(xe[Z].hidden=!0);break;default:if(j&&j.WTF)throw new Error("SYLK bad record "+Ee)}Qe<1&&(we=null);break;default:if(j&&j.WTF)throw new Error("SYLK bad record "+Ee)}}return xe.length>0&&(Te["!rows"]=xe),Re.length>0&&(Te["!cols"]=Re),Re.forEach(function(dt){process_col(dt)}),j&&j.sheetRows&&(oe=oe.slice(0,j.sheetRows)),[oe,Te,nt]}function A(U,j){var z=S(U,j),Z=z[0],X=z[1],Q=z[2],se=dup(j);se.date1904=(((Q||{}).Workbook||{}).WBProps||{}).date1904;var oe=aoa_to_sheet(Z,se);keys(X).forEach(function(we){oe[we]=X[we]});var ue=sheet_to_workbook(oe,j);return keys(Q).forEach(function(we){ue[we]=Q[we]}),ue.bookType="sylk",ue}function I(U,j,z,Z){var X="C;Y"+(z+1)+";X"+(Z+1)+";K";switch(U.t){case"n":X+=U.v||0,U.f&&!U.F&&(X+=";E"+a1_to_rc(U.f,{r:z,c:Z}));break;case"b":X+=U.v?"TRUE":"FALSE";break;case"e":X+=U.w||U.v;break;case"d":X+='"'+(U.w||U.v)+'"';break;case"s":X+='"'+(U.v==null?"":String(U.v)).replace(/"/g,"").replace(/;/g,";;")+'"';break}return X}function B(U,j){j.forEach(function(z,Z){var X="F;W"+(Z+1)+" "+(Z+1)+" ";z.hidden?X+="0":(typeof z.width=="number"&&!z.wpx&&(z.wpx=width2px(z.width)),typeof z.wpx=="number"&&!z.wch&&(z.wch=px2char(z.wpx)),typeof z.wch=="number"&&(X+=Math.round(z.wch))),X.charAt(X.length-1)!=" "&&U.push(X)})}function O(U,j){j.forEach(function(z,Z){var X="F;";z.hidden?X+="M0;":z.hpt?X+="M"+20*z.hpt+";":z.hpx&&(X+="M"+20*px2pt(z.hpx)+";"),X.length>2&&U.push(X+"R"+(Z+1))})}function N(U,j,z){var Z=["ID;PSheetJS;N;E"],X=[],Q=safe_decode_range(U["!ref"]),se,oe=U["!data"]!=null,ue=`\r
`,we=(((z||{}).Workbook||{}).WBProps||{}).date1904;Z.push("P;PGeneral"),Z.push("F;P0;DG0G8;M255"),U["!cols"]&&B(Z,U["!cols"]),U["!rows"]&&O(Z,U["!rows"]),Z.push("B;Y"+(Q.e.r-Q.s.r+1)+";X"+(Q.e.c-Q.s.c+1)+";D"+[Q.s.c,Q.s.r,Q.e.c,Q.e.r].join(" ")),Z.push("O;L;D;B"+(we?";V4":"")+";K47;G100 0.001");for(var Te=Q.s.r;Te<=Q.e.r;++Te)if(!(oe&&!U["!data"][Te])){for(var xe=[],Re=Q.s.c;Re<=Q.e.c;++Re)se=oe?U["!data"][Te][Re]:U[encode_col(Re)+encode_row(Te)],!(!se||se.v==null&&(!se.f||se.F))&&xe.push(I(se,U,Te,Re));X.push(xe.join(ue))}return Z.join(ue)+ue+X.join(ue)+ue+"E"+ue}return{to_workbook:A,from_sheet:N}}(),DIF=function(){function n(I,B){switch(B.type){case"base64":return r(Base64_decode(I),B);case"binary":return r(I,B);case"buffer":return r(has_buf&&Buffer.isBuffer(I)?I.toString("binary"):a2s(I),B);case"array":return r(cc2str(I),B)}throw new Error("Unrecognized type "+B.type)}function r(I,B){for(var O=I.split(`
`),N=-1,U=-1,j=0,z=[];j!==O.length;++j){if(O[j].trim()==="BOT"){z[++N]=[],U=0;continue}if(!(N<0)){var Z=O[j].trim().split(","),X=Z[0],Q=Z[1];++j;for(var se=O[j]||"";(se.match(/["]/g)||[]).length&1&&j<O.length-1;)se+=`
`+O[++j];switch(se=se.trim(),+X){case-1:if(se==="BOT"){z[++N]=[],U=0;continue}else if(se!=="EOD")throw new Error("Unrecognized DIF special command "+se);break;case 0:se==="TRUE"?z[N][U]=!0:se==="FALSE"?z[N][U]=!1:isNaN(fuzzynum(Q))?isNaN(fuzzydate(Q).getDate())?z[N][U]=Q:z[N][U]=parseDate(Q):z[N][U]=fuzzynum(Q),++U;break;case 1:se=se.slice(1,se.length-1),se=se.replace(/""/g,'"'),se&&se.match(/^=".*"$/)&&(se=se.slice(2,-1)),z[N][U++]=se!==""?se:null;break}if(se==="EOD")break}}return B&&B.sheetRows&&(z=z.slice(0,B.sheetRows)),z}function _(I,B){return aoa_to_sheet(n(I,B),B)}function E(I,B){var O=sheet_to_workbook(_(I,B),B);return O.bookType="dif",O}function S(I,B){return"0,"+String(I)+`\r
`+B}function C(I){return`1,0\r
"`+I.replace(/"/g,'""')+'"'}function A(I){for(var B=safe_decode_range(I["!ref"]),O=I["!data"]!=null,N=[`TABLE\r
0,1\r
"sheetjs"\r
`,`VECTORS\r
0,`+(B.e.r-B.s.r+1)+`\r
""\r
`,`TUPLES\r
0,`+(B.e.c-B.s.c+1)+`\r
""\r
`,`DATA\r
0,0\r
""\r
`],U=B.s.r;U<=B.e.r;++U){for(var j=O?I["!data"][U]:[],z=`-1,0\r
BOT\r
`,Z=B.s.c;Z<=B.e.c;++Z){var X=O?j&&j[Z]:I[encode_cell({r:U,c:Z})];if(X==null){z+=`1,0\r
""\r
`;continue}switch(X.t){case"n":X.w!=null?z+="0,"+X.w+`\r
V`:X.v!=null?z+=S(X.v,"V"):X.f!=null&&!X.F?z+=C("="+X.f):z+=`1,0\r
""`;break;case"b":z+=X.v?S(1,"TRUE"):S(0,"FALSE");break;case"s":z+=C(isNaN(+X.v)?X.v:'="'+X.v+'"');break;case"d":X.w||(X.w=SSF_format(X.z||table_fmt[14],datenum(parseDate(X.v)))),z+=S(X.w,"V");break;default:z+=`1,0\r
""`}z+=`\r
`}N.push(z)}return N.join("")+`-1,0\r
EOD`}return{to_workbook:E,to_sheet:_,from_sheet:A}}(),ETH=function(){function n(U){return U.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function r(U){return U.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function _(U,j){for(var z=U.split(`
`),Z=-1,X=-1,Q=0,se=[];Q!==z.length;++Q){var oe=z[Q].trim().split(":");if(oe[0]==="cell"){var ue=decode_cell(oe[1]);if(se.length<=ue.r)for(Z=se.length;Z<=ue.r;++Z)se[Z]||(se[Z]=[]);switch(Z=ue.r,X=ue.c,oe[2]){case"t":se[Z][X]=n(oe[3]);break;case"v":se[Z][X]=+oe[3];break;case"vtf":var we=oe[oe.length-1];case"vtc":switch(oe[3]){case"nl":se[Z][X]=!!+oe[4];break;default:se[Z][X]=+oe[4];break}oe[2]=="vtf"&&(se[Z][X]=[se[Z][X],we])}}}return j&&j.sheetRows&&(se=se.slice(0,j.sheetRows)),se}function E(U,j){return aoa_to_sheet(_(U,j),j)}function S(U,j){return sheet_to_workbook(E(U,j),j)}var C=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),A=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,I=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),B="--SocialCalcSpreadsheetControlSave--";function O(U){if(!U||!U["!ref"])return"";for(var j=[],z=[],Z,X="",Q=decode_range(U["!ref"]),se=U["!data"]!=null,oe=Q.s.r;oe<=Q.e.r;++oe)for(var ue=Q.s.c;ue<=Q.e.c;++ue)if(X=encode_cell({r:oe,c:ue}),Z=se?(U["!data"][oe]||[])[ue]:U[X],!(!Z||Z.v==null||Z.t==="z")){switch(z=["cell",X,"t"],Z.t){case"s":case"str":z.push(r(Z.v));break;case"n":Z.f?(z[2]="vtf",z[3]="n",z[4]=Z.v,z[5]=r(Z.f)):(z[2]="v",z[3]=Z.v);break;case"b":z[2]="vt"+(Z.f?"f":"c"),z[3]="nl",z[4]=Z.v?"1":"0",z[5]=r(Z.f||(Z.v?"TRUE":"FALSE"));break;case"d":var we=datenum(parseDate(Z.v));z[2]="vtc",z[3]="nd",z[4]=""+we,z[5]=Z.w||SSF_format(Z.z||table_fmt[14],we);break;case"e":continue}j.push(z.join(":"))}return j.push("sheet:c:"+(Q.e.c-Q.s.c+1)+":r:"+(Q.e.r-Q.s.r+1)+":tvf:1"),j.push("valueformat:1:text-wiki"),j.join(`
`)}function N(U){return[C,A,I,A,O(U),B].join(`
`)}return{to_workbook:S,to_sheet:E,from_sheet:N}}(),PRN=function(){function n(N,U,j,z,Z){Z.raw?U[j][z]=N:N===""||(N==="TRUE"?U[j][z]=!0:N==="FALSE"?U[j][z]=!1:isNaN(fuzzynum(N))?isNaN(fuzzydate(N).getDate())?U[j][z]=N:U[j][z]=parseDate(N):U[j][z]=fuzzynum(N))}function r(N,U){var j=U||{},z=[];if(!N||N.length===0)return z;for(var Z=N.split(/[\r\n]/),X=Z.length-1;X>=0&&Z[X].length===0;)--X;for(var Q=10,se=0,oe=0;oe<=X;++oe)se=Z[oe].indexOf(" "),se==-1?se=Z[oe].length:se++,Q=Math.max(Q,se);for(oe=0;oe<=X;++oe){z[oe]=[];var ue=0;for(n(Z[oe].slice(0,Q).trim(),z,oe,ue,j),ue=1;ue<=(Z[oe].length-Q)/10+1;++ue)n(Z[oe].slice(Q+(ue-1)*10,Q+ue*10).trim(),z,oe,ue,j)}return j.sheetRows&&(z=z.slice(0,j.sheetRows)),z}var _={44:",",9:"	",59:";",124:"|"},E={44:3,9:2,59:1,124:0};function S(N){for(var U={},j=!1,z=0,Z=0;z<N.length;++z)(Z=N.charCodeAt(z))==34?j=!j:!j&&Z in _&&(U[Z]=(U[Z]||0)+1);Z=[];for(z in U)Object.prototype.hasOwnProperty.call(U,z)&&Z.push([U[z],z]);if(!Z.length){U=E;for(z in U)Object.prototype.hasOwnProperty.call(U,z)&&Z.push([U[z],z])}return Z.sort(function(X,Q){return X[0]-Q[0]||E[X[1]]-E[Q[1]]}),_[Z.pop()[1]]||44}function C(N,U){var j=U||{},z="",Z={};j.dense&&(Z["!data"]=[]);var X={s:{c:0,r:0},e:{c:0,r:0}};N.slice(0,4)=="sep="?N.charCodeAt(5)==13&&N.charCodeAt(6)==10?(z=N.charAt(4),N=N.slice(7)):N.charCodeAt(5)==13||N.charCodeAt(5)==10?(z=N.charAt(4),N=N.slice(6)):z=S(N.slice(0,1024)):j&&j.FS?z=j.FS:z=S(N.slice(0,1024));var Q=0,se=0,oe=0,ue=0,we=0,Te=z.charCodeAt(0),xe=!1,Re=0,Ne=N.charCodeAt(0),Fe=j.dateNF!=null?dateNF_regex(j.dateNF):null;function ht(){var nt=N.slice(ue,we);nt.slice(-1)=="\r"&&(nt=nt.slice(0,-1));var Ee={};if(nt.charAt(0)=='"'&&nt.charAt(nt.length-1)=='"'&&(nt=nt.slice(1,-1).replace(/""/g,'"')),nt.length===0)Ee.t="z";else if(j.raw)Ee.t="s",Ee.v=nt;else if(nt.trim().length===0)Ee.t="s",Ee.v=nt;else if(nt.charCodeAt(0)==61)nt.charCodeAt(1)==34&&nt.charCodeAt(nt.length-1)==34?(Ee.t="s",Ee.v=nt.slice(2,-1).replace(/""/g,'"')):fuzzyfmla(nt)?(Ee.t="n",Ee.f=nt.slice(1)):(Ee.t="s",Ee.v=nt);else if(nt=="TRUE")Ee.t="b",Ee.v=!0;else if(nt=="FALSE")Ee.t="b",Ee.v=!1;else if(!isNaN(oe=fuzzynum(nt)))Ee.t="n",j.cellText!==!1&&(Ee.w=nt),Ee.v=oe;else if(!isNaN((oe=fuzzydate(nt)).getDate())||Fe&&nt.match(Fe)){Ee.z=j.dateNF||table_fmt[14];var Ce=0;Fe&&nt.match(Fe)&&(nt=dateNF_fix(nt,j.dateNF,nt.match(Fe)||[]),Ce=1,oe=parseDate(nt,Ce)),j.cellDates?(Ee.t="d",Ee.v=oe):(Ee.t="n",Ee.v=datenum(oe)),j.cellText!==!1&&(Ee.w=SSF_format(Ee.z,Ee.v instanceof Date?datenum(Ee.v):Ee.v)),j.cellNF||delete Ee.z}else Ee.t="s",Ee.v=nt;if(Ee.t=="z"||(j.dense?(Z["!data"][Q]||(Z["!data"][Q]=[]),Z["!data"][Q][se]=Ee):Z[encode_cell({c:se,r:Q})]=Ee),ue=we+1,Ne=N.charCodeAt(ue),X.e.c<se&&(X.e.c=se),X.e.r<Q&&(X.e.r=Q),Re==Te)++se;else if(se=0,++Q,j.sheetRows&&j.sheetRows<=Q)return!0}e:for(;we<N.length;++we)switch(Re=N.charCodeAt(we)){case 34:Ne===34&&(xe=!xe);break;case 13:if(xe)break;N.charCodeAt(we+1)==10&&++we;case Te:case 10:if(!xe&&ht())break e;break}return we-ue>0&&ht(),Z["!ref"]=encode_range(X),Z}function A(N,U){return!(U&&U.PRN)||U.FS||N.slice(0,4)=="sep="||N.indexOf("	")>=0||N.indexOf(",")>=0||N.indexOf(";")>=0?C(N,U):aoa_to_sheet(r(N,U),U)}function I(N,U){var j="",z=U.type=="string"?[0,0,0,0]:firstbyte(N,U);switch(U.type){case"base64":j=Base64_decode(N);break;case"binary":j=N;break;case"buffer":U.codepage==65001?j=N.toString("utf8"):U.codepage&&typeof $cptable<"u"?j=$cptable.utils.decode(U.codepage,N):j=has_buf&&Buffer.isBuffer(N)?N.toString("binary"):a2s(N);break;case"array":j=cc2str(N);break;case"string":j=N;break;default:throw new Error("Unrecognized type "+U.type)}return z[0]==239&&z[1]==187&&z[2]==191?j=utf8read(j.slice(3)):U.type!="string"&&U.type!="buffer"&&U.codepage==65001?j=utf8read(j):U.type=="binary"&&typeof $cptable<"u"&&U.codepage&&(j=$cptable.utils.decode(U.codepage,$cptable.utils.encode(28591,j))),j.slice(0,19)=="socialcalc:version:"?ETH.to_sheet(U.type=="string"?j:utf8read(j),U):A(j,U)}function B(N,U){return sheet_to_workbook(I(N,U),U)}function O(N){for(var U=[],j=safe_decode_range(N["!ref"]),z,Z=N["!data"]!=null,X=j.s.r;X<=j.e.r;++X){for(var Q=[],se=j.s.c;se<=j.e.c;++se){var oe=encode_cell({r:X,c:se});if(z=Z?(N["!data"][X]||[])[se]:N[oe],!z||z.v==null){Q.push("          ");continue}for(var ue=(z.w||(format_cell(z),z.w)||"").slice(0,10);ue.length<10;)ue+=" ";Q.push(ue+(se===0?" ":""))}U.push(Q.join(""))}return U.join(`
`)}return{to_workbook:B,to_sheet:I,from_sheet:O}}();function read_wb_ID(n,r){var _=r||{},E=!!_.WTF;_.WTF=!0;try{var S=SYLK.to_workbook(n,_);return _.WTF=E,S}catch(C){if(_.WTF=E,!C.message.match(/SYLK bad record ID/)&&E)throw C;return PRN.to_workbook(n,r)}}var WK_=function(){function n(Ke,mt,ct){if(Ke){prep_blob(Ke,Ke.l||0);for(var Qe=ct.Enum||Pe;Ke.l<Ke.length;){var dt=Ke.read_shift(2),vt=Qe[dt]||Qe[65535],At=Ke.read_shift(2),bt=Ke.l+At,ft=vt.f&&vt.f(Ke,At,ct);if(Ke.l=bt,mt(ft,vt,dt))return}}}function r(Ke,mt){switch(mt.type){case"base64":return _(s2a(Base64_decode(Ke)),mt);case"binary":return _(s2a(Ke),mt);case"buffer":case"array":return _(Ke,mt)}throw"Unsupported type "+mt.type}function _(Ke,mt){if(!Ke)return Ke;var ct=mt||{},Qe={},dt="Sheet1",vt="",At=0,bt={},ft=[],Et=[],Ye=[];ct.dense&&(Ye=Qe["!data"]=[]);var Ct={s:{r:0,c:0},e:{r:0,c:0}},Pt=ct.sheetRows||0;if(Ke[4]==81&&Ke[5]==80&&Ke[6]==87)return tt(Ke,mt);if(Ke[2]==0&&(Ke[3]==8||Ke[3]==9)&&Ke.length>=16&&Ke[14]==5&&Ke[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(Ke[2]==2)ct.Enum=Pe,n(Ke,function(Ft,qt,Mt){switch(Mt){case 0:ct.vers=Ft,Ft>=4096&&(ct.qpro=!0);break;case 255:ct.vers=Ft,ct.works=!0;break;case 6:Ct=Ft;break;case 204:Ft&&(vt=Ft);break;case 222:vt=Ft;break;case 15:case 51:(!ct.qpro&&!ct.works||Mt==51)&&Ft[1].v.charCodeAt(0)<48&&(Ft[1].v=Ft[1].v.slice(1)),(ct.works||ct.works2)&&(Ft[1].v=Ft[1].v.replace(/\r\n/g,`
`));case 13:case 14:case 16:Mt==14&&(Ft[2]&112)==112&&(Ft[2]&15)>1&&(Ft[2]&15)<15&&(Ft[1].z=ct.dateNF||table_fmt[14],ct.cellDates&&(Ft[1].t="d",Ft[1].v=numdate(Ft[1].v))),ct.qpro&&Ft[3]>At&&(Qe["!ref"]=encode_range(Ct),bt[dt]=Qe,ft.push(dt),Qe={},ct.dense&&(Ye=Qe["!data"]=[]),Ct={s:{r:0,c:0},e:{r:0,c:0}},At=Ft[3],dt=vt||"Sheet"+(At+1),vt="");var Wt=ct.dense?(Ye[Ft[0].r]||[])[Ft[0].c]:Qe[encode_cell(Ft[0])];if(Wt){Wt.t=Ft[1].t,Wt.v=Ft[1].v,Ft[1].z!=null&&(Wt.z=Ft[1].z),Ft[1].f!=null&&(Wt.f=Ft[1].f);break}ct.dense?(Ye[Ft[0].r]||(Ye[Ft[0].r]=[]),Ye[Ft[0].r][Ft[0].c]=Ft[1]):Qe[encode_cell(Ft[0])]=Ft[1];break;case 21509:ct.works2=!0;break}},ct);else if(Ke[2]==26||Ke[2]==14)ct.Enum=Me,Ke[2]==14&&(ct.qpro=!0,Ke.l=0),n(Ke,function(Ft,qt,Mt){switch(Mt){case 204:dt=Ft;break;case 22:Ft[1].v.charCodeAt(0)<48&&(Ft[1].v=Ft[1].v.slice(1)),Ft[1].v=Ft[1].v.replace(/\x0F./g,function(Wt){return String.fromCharCode(Wt.charCodeAt(1)-32)}).replace(/\r\n/g,`
`);case 23:case 24:case 25:case 37:case 39:case 40:if(Ft[3]>At&&(Qe["!ref"]=encode_range(Ct),bt[dt]=Qe,ft.push(dt),Qe={},ct.dense&&(Ye=Qe["!data"]=[]),Ct={s:{r:0,c:0},e:{r:0,c:0}},At=Ft[3],dt="Sheet"+(At+1)),Pt>0&&Ft[0].r>=Pt)break;ct.dense?(Ye[Ft[0].r]||(Ye[Ft[0].r]=[]),Ye[Ft[0].r][Ft[0].c]=Ft[1]):Qe[encode_cell(Ft[0])]=Ft[1],Ct.e.c<Ft[0].c&&(Ct.e.c=Ft[0].c),Ct.e.r<Ft[0].r&&(Ct.e.r=Ft[0].r);break;case 27:Ft[14e3]&&(Et[Ft[14e3][0]]=Ft[14e3][1]);break;case 1537:Et[Ft[0]]=Ft[1],Ft[0]==At&&(dt=Ft[1]);break}},ct);else throw new Error("Unrecognized LOTUS BOF "+Ke[2]);if(Qe["!ref"]=encode_range(Ct),bt[vt||dt]=Qe,ft.push(vt||dt),!Et.length)return{SheetNames:ft,Sheets:bt};for(var St={},$t=[],kt=0;kt<Et.length;++kt)bt[ft[kt]]?($t.push(Et[kt]||ft[kt]),St[Et[kt]]=bt[Et[kt]]||bt[ft[kt]]):($t.push(Et[kt]),St[Et[kt]]={"!ref":"A1"});return{SheetNames:$t,Sheets:St}}function E(Ke,mt){var ct=mt||{};if(+ct.codepage>=0&&set_cp(+ct.codepage),ct.type=="string")throw new Error("Cannot write WK1 to JS string");var Qe=buf_array(),dt=safe_decode_range(Ke["!ref"]),vt=Ke["!data"]!=null,At=[];write_biff_rec(Qe,0,C(1030)),write_biff_rec(Qe,6,B(dt));for(var bt=Math.min(dt.e.r,8191),ft=dt.s.c;ft<=dt.e.c;++ft)At[ft]=encode_col(ft);for(var Et=dt.s.r;Et<=bt;++Et){var Ye=encode_row(Et);for(ft=dt.s.c;ft<=dt.e.c;++ft){var Ct=vt?(Ke["!data"][Et]||[])[ft]:Ke[At[ft]+Ye];if(!(!Ct||Ct.t=="z"))if(Ct.t=="n")(Ct.v|0)==Ct.v&&Ct.v>=-32768&&Ct.v<=32767?write_biff_rec(Qe,13,Z(Et,ft,Ct.v)):write_biff_rec(Qe,14,Q(Et,ft,Ct.v));else{var Pt=format_cell(Ct);write_biff_rec(Qe,15,U(Et,ft,Pt.slice(0,239)))}}}return write_biff_rec(Qe,1),Qe.end()}function S(Ke,mt){var ct=mt||{};if(+ct.codepage>=0&&set_cp(+ct.codepage),ct.type=="string")throw new Error("Cannot write WK3 to JS string");var Qe=buf_array();write_biff_rec(Qe,0,A(Ke));for(var dt=0,vt=0;dt<Ke.SheetNames.length;++dt)(Ke.Sheets[Ke.SheetNames[dt]]||{})["!ref"]&&write_biff_rec(Qe,27,Ve(Ke.SheetNames[dt],vt++));var At=0;for(dt=0;dt<Ke.SheetNames.length;++dt){var bt=Ke.Sheets[Ke.SheetNames[dt]];if(!(!bt||!bt["!ref"])){for(var ft=safe_decode_range(bt["!ref"]),Et=bt["!data"]!=null,Ye=[],Ct=Math.min(ft.e.r,8191),Pt=ft.s.r;Pt<=Ct;++Pt)for(var St=encode_row(Pt),$t=ft.s.c;$t<=ft.e.c;++$t){Pt===ft.s.r&&(Ye[$t]=encode_col($t));var kt=Ye[$t]+St,Ft=Et?(bt["!data"][Pt]||[])[$t]:bt[kt];if(!(!Ft||Ft.t=="z"))if(Ft.t=="n")write_biff_rec(Qe,23,nt(Pt,$t,At,Ft.v));else{var qt=format_cell(Ft);write_biff_rec(Qe,22,Ne(Pt,$t,At,qt.slice(0,239)))}}++At}}return write_biff_rec(Qe,1),Qe.end()}function C(Ke){var mt=new_buf(2);return mt.write_shift(2,Ke),mt}function A(Ke){var mt=new_buf(26);mt.write_shift(2,4096),mt.write_shift(2,4),mt.write_shift(4,0);for(var ct=0,Qe=0,dt=0,vt=0;vt<Ke.SheetNames.length;++vt){var At=Ke.SheetNames[vt],bt=Ke.Sheets[At];if(!(!bt||!bt["!ref"])){++dt;var ft=decode_range(bt["!ref"]);ct<ft.e.r&&(ct=ft.e.r),Qe<ft.e.c&&(Qe=ft.e.c)}}return ct>8191&&(ct=8191),mt.write_shift(2,ct),mt.write_shift(1,dt),mt.write_shift(1,Qe),mt.write_shift(2,0),mt.write_shift(2,0),mt.write_shift(1,1),mt.write_shift(1,2),mt.write_shift(4,0),mt.write_shift(4,0),mt}function I(Ke,mt,ct){var Qe={s:{c:0,r:0},e:{c:0,r:0}};return mt==8&&ct.qpro?(Qe.s.c=Ke.read_shift(1),Ke.l++,Qe.s.r=Ke.read_shift(2),Qe.e.c=Ke.read_shift(1),Ke.l++,Qe.e.r=Ke.read_shift(2),Qe):(Qe.s.c=Ke.read_shift(2),Qe.s.r=Ke.read_shift(2),mt==12&&ct.qpro&&(Ke.l+=2),Qe.e.c=Ke.read_shift(2),Qe.e.r=Ke.read_shift(2),mt==12&&ct.qpro&&(Ke.l+=2),Qe.s.c==65535&&(Qe.s.c=Qe.e.c=Qe.s.r=Qe.e.r=0),Qe)}function B(Ke){var mt=new_buf(8);return mt.write_shift(2,Ke.s.c),mt.write_shift(2,Ke.s.r),mt.write_shift(2,Ke.e.c),mt.write_shift(2,Ke.e.r),mt}function O(Ke,mt,ct){var Qe=[{c:0,r:0},{t:"n",v:0},0,0];return ct.qpro&&ct.vers!=20768?(Qe[0].c=Ke.read_shift(1),Qe[3]=Ke.read_shift(1),Qe[0].r=Ke.read_shift(2),Ke.l+=2):ct.works?(Qe[0].c=Ke.read_shift(2),Qe[0].r=Ke.read_shift(2),Qe[2]=Ke.read_shift(2)):(Qe[2]=Ke.read_shift(1),Qe[0].c=Ke.read_shift(2),Qe[0].r=Ke.read_shift(2)),Qe}function N(Ke,mt,ct){var Qe=Ke.l+mt,dt=O(Ke,mt,ct);if(dt[1].t="s",ct.vers==20768){Ke.l++;var vt=Ke.read_shift(1);return dt[1].v=Ke.read_shift(vt,"utf8"),dt}return ct.qpro&&Ke.l++,dt[1].v=Ke.read_shift(Qe-Ke.l,"cstr"),dt}function U(Ke,mt,ct){var Qe=new_buf(7+ct.length);Qe.write_shift(1,255),Qe.write_shift(2,mt),Qe.write_shift(2,Ke),Qe.write_shift(1,39);for(var dt=0;dt<Qe.length;++dt){var vt=ct.charCodeAt(dt);Qe.write_shift(1,vt>=128?95:vt)}return Qe.write_shift(1,0),Qe}function j(Ke,mt,ct){var Qe=Ke.l+mt,dt=O(Ke,mt,ct);if(dt[1].t="s",ct.vers==20768){var vt=Ke.read_shift(1);return dt[1].v=Ke.read_shift(vt,"utf8"),dt}return dt[1].v=Ke.read_shift(Qe-Ke.l,"cstr"),dt}function z(Ke,mt,ct){var Qe=O(Ke,mt,ct);return Qe[1].v=Ke.read_shift(2,"i"),Qe}function Z(Ke,mt,ct){var Qe=new_buf(7);return Qe.write_shift(1,255),Qe.write_shift(2,mt),Qe.write_shift(2,Ke),Qe.write_shift(2,ct,"i"),Qe}function X(Ke,mt,ct){var Qe=O(Ke,mt,ct);return Qe[1].v=Ke.read_shift(8,"f"),Qe}function Q(Ke,mt,ct){var Qe=new_buf(13);return Qe.write_shift(1,255),Qe.write_shift(2,mt),Qe.write_shift(2,Ke),Qe.write_shift(8,ct,"f"),Qe}function se(Ke,mt,ct){var Qe=Ke.l+mt,dt=O(Ke,mt,ct);if(dt[1].v=Ke.read_shift(8,"f"),ct.qpro)Ke.l=Qe;else{var vt=Ke.read_shift(2);Te(Ke.slice(Ke.l,Ke.l+vt),dt),Ke.l+=vt}return dt}function oe(Ke,mt,ct){var Qe=mt&32768;return mt&=-32769,mt=(Qe?Ke:0)+(mt>=8192?mt-16384:mt),(Qe?"":"$")+(ct?encode_col(mt):encode_row(mt))}var ue={31:["NA",0],33:["ABS",1],34:["TRUNC",1],35:["SQRT",1],36:["LOG",1],37:["LN",1],38:["PI",0],39:["SIN",1],40:["COS",1],41:["TAN",1],42:["ATAN2",2],43:["ATAN",1],44:["ASIN",1],45:["ACOS",1],46:["EXP",1],47:["MOD",2],49:["ISNA",1],50:["ISERR",1],51:["FALSE",0],52:["TRUE",0],53:["RAND",0],63:["ROUND",2],68:["ISNUMBER",1],69:["ISTEXT",1],70:["LEN",1],71:["VALUE",1],73:["MID",3],74:["CHAR",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],102:["UPPER",1],103:["LOWER",1],107:["PROPER",1],109:["TRIM",1],111:["T",1]},we=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function Te(Ke,mt){prep_blob(Ke,0);for(var ct=[],Qe=0,dt="",vt="",At="",bt="";Ke.l<Ke.length;){var ft=Ke[Ke.l++];switch(ft){case 0:ct.push(Ke.read_shift(8,"f"));break;case 1:vt=oe(mt[0].c,Ke.read_shift(2),!0),dt=oe(mt[0].r,Ke.read_shift(2),!1),ct.push(vt+dt);break;case 2:{var Et=oe(mt[0].c,Ke.read_shift(2),!0),Ye=oe(mt[0].r,Ke.read_shift(2),!1);vt=oe(mt[0].c,Ke.read_shift(2),!0),dt=oe(mt[0].r,Ke.read_shift(2),!1),ct.push(Et+Ye+":"+vt+dt)}break;case 3:if(Ke.l<Ke.length){console.error("WK1 premature formula end");return}break;case 4:ct.push("("+ct.pop()+")");break;case 5:ct.push(Ke.read_shift(2));break;case 6:{for(var Ct="";ft=Ke[Ke.l++];)Ct+=String.fromCharCode(ft);ct.push('"'+Ct.replace(/"/g,'""')+'"')}break;case 8:ct.push("-"+ct.pop());break;case 23:ct.push("+"+ct.pop());break;case 22:ct.push("NOT("+ct.pop()+")");break;case 20:case 21:bt=ct.pop(),At=ct.pop(),ct.push(["AND","OR"][ft-20]+"("+At+","+bt+")");break;default:if(ft<32&&we[ft])bt=ct.pop(),At=ct.pop(),ct.push(At+we[ft]+bt);else if(ue[ft]){if(Qe=ue[ft][1],Qe==69&&(Qe=Ke[Ke.l++]),Qe>ct.length){console.error("WK1 bad formula parse 0x"+ft.toString(16)+":|"+ct.join("|")+"|");return}var Pt=ct.slice(-Qe);ct.length-=Qe,ct.push(ue[ft][0]+"("+Pt.join(",")+")")}else return ft<=7?console.error("WK1 invalid opcode "+ft.toString(16)):ft<=24?console.error("WK1 unsupported op "+ft.toString(16)):ft<=30?console.error("WK1 invalid opcode "+ft.toString(16)):ft<=115?console.error("WK1 unsupported function opcode "+ft.toString(16)):console.error("WK1 unrecognized opcode "+ft.toString(16))}}ct.length==1?mt[1].f=""+ct[0]:console.error("WK1 bad formula parse |"+ct.join("|")+"|")}function xe(Ke){var mt=[{c:0,r:0},{t:"n",v:0},0];return mt[0].r=Ke.read_shift(2),mt[3]=Ke[Ke.l++],mt[0].c=Ke[Ke.l++],mt}function Re(Ke,mt){var ct=xe(Ke);return ct[1].t="s",ct[1].v=Ke.read_shift(mt-4,"cstr"),ct}function Ne(Ke,mt,ct,Qe){var dt=new_buf(6+Qe.length);dt.write_shift(2,Ke),dt.write_shift(1,ct),dt.write_shift(1,mt),dt.write_shift(1,39);for(var vt=0;vt<Qe.length;++vt){var At=Qe.charCodeAt(vt);dt.write_shift(1,At>=128?95:At)}return dt.write_shift(1,0),dt}function Fe(Ke,mt){var ct=xe(Ke);ct[1].v=Ke.read_shift(2);var Qe=ct[1].v>>1;if(ct[1].v&1)switch(Qe&7){case 0:Qe=(Qe>>3)*5e3;break;case 1:Qe=(Qe>>3)*500;break;case 2:Qe=(Qe>>3)/20;break;case 3:Qe=(Qe>>3)/200;break;case 4:Qe=(Qe>>3)/2e3;break;case 5:Qe=(Qe>>3)/2e4;break;case 6:Qe=(Qe>>3)/16;break;case 7:Qe=(Qe>>3)/64;break}return ct[1].v=Qe,ct}function ht(Ke,mt){var ct=xe(Ke),Qe=Ke.read_shift(4),dt=Ke.read_shift(4),vt=Ke.read_shift(2);if(vt==65535)return Qe===0&&dt===3221225472?(ct[1].t="e",ct[1].v=15):Qe===0&&dt===3489660928?(ct[1].t="e",ct[1].v=42):ct[1].v=0,ct;var At=vt&32768;return vt=(vt&32767)-16446,ct[1].v=(1-At*2)*(dt*Math.pow(2,vt+32)+Qe*Math.pow(2,vt)),ct}function nt(Ke,mt,ct,Qe){var dt=new_buf(14);if(dt.write_shift(2,Ke),dt.write_shift(1,ct),dt.write_shift(1,mt),Qe==0)return dt.write_shift(4,0),dt.write_shift(4,0),dt.write_shift(2,65535),dt;var vt=0,At=0,bt=0,ft=0;return Qe<0&&(vt=1,Qe=-Qe),At=Math.log2(Qe)|0,Qe/=Math.pow(2,At-31),ft=Qe>>>0,ft&2147483648||(Qe/=2,++At,ft=Qe>>>0),Qe-=ft,ft|=2147483648,ft>>>=0,Qe*=Math.pow(2,32),bt=Qe>>>0,dt.write_shift(4,bt),dt.write_shift(4,ft),At+=16383+(vt?32768:0),dt.write_shift(2,At),dt}function Ee(Ke,mt){var ct=ht(Ke);return Ke.l+=mt-14,ct}function Ce(Ke,mt){var ct=xe(Ke),Qe=Ke.read_shift(4);return ct[1].v=Qe>>6,ct}function _e(Ke,mt){var ct=xe(Ke),Qe=Ke.read_shift(8,"f");return ct[1].v=Qe,ct}function Ie(Ke,mt){var ct=_e(Ke);return Ke.l+=mt-12,ct}function He(Ke,mt){return Ke[Ke.l+mt-1]==0?Ke.read_shift(mt,"cstr"):""}function Be(Ke,mt){var ct=Ke[Ke.l++];ct>mt-1&&(ct=mt-1);for(var Qe="";Qe.length<ct;)Qe+=String.fromCharCode(Ke[Ke.l++]);return Qe}function Ge(Ke,mt,ct){if(!(!ct.qpro||mt<21)){var Qe=Ke.read_shift(1);Ke.l+=17,Ke.l+=1,Ke.l+=2;var dt=Ke.read_shift(mt-21,"cstr");return[Qe,dt]}}function je(Ke,mt){for(var ct={},Qe=Ke.l+mt;Ke.l<Qe;){var dt=Ke.read_shift(2);if(dt==14e3){for(ct[dt]=[0,""],ct[dt][0]=Ke.read_shift(2);Ke[Ke.l];)ct[dt][1]+=String.fromCharCode(Ke[Ke.l]),Ke.l++;Ke.l++}}return ct}function Ve(Ke,mt){var ct=new_buf(5+Ke.length);ct.write_shift(2,14e3),ct.write_shift(2,mt);for(var Qe=0;Qe<Ke.length;++Qe){var dt=Ke.charCodeAt(Qe);ct[ct.l++]=dt>127?95:dt}return ct[ct.l++]=0,ct}var Pe={0:{n:"BOF",f:parseuint16},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:I},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:z},14:{n:"NUMBER",f:X},15:{n:"LABEL",f:N},16:{n:"FORMULA",f:se},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:j},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:He},222:{n:"SHEETNAMELP",f:Be},255:{n:"BOF",f:parseuint16},65535:{n:""}},Me={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:Re},23:{n:"NUMBER17",f:ht},24:{n:"NUMBER18",f:Fe},25:{n:"FORMULA19",f:Ee},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:je},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:Ce},38:{n:"??"},39:{n:"NUMBER27",f:_e},40:{n:"FORMULA28",f:Ie},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:He},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:Ge},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};function tt(Ke,mt){prep_blob(Ke,0);var ct=mt||{},Qe={};ct.dense&&(Qe["!data"]=[]);var dt=[],vt="",At={s:{r:-1,c:-1},e:{r:-1,c:-1}},bt=0,ft=0,Et=0,Ye=0,Ct={SheetNames:[],Sheets:{}};e:for(;Ke.l<Ke.length;){var Pt=Ke.read_shift(2),St=Ke.read_shift(2),$t=Ke.slice(Ke.l,Ke.l+St);switch(prep_blob($t,0),Pt){case 1:if($t.read_shift(4)!=962023505)throw"Bad QPW9 BOF!";break;case 2:break e;case 1025:break;case 1026:break;case 1031:for($t.l+=12;$t.l<$t.length;)bt=$t.read_shift(2),ft=$t.read_shift(1),dt.push($t.read_shift(bt,"cstr"));break;case 1032:break;case 1537:{var kt=$t.read_shift(2);Qe={},ct.dense&&(Qe["!data"]=[]),At.s.c=$t.read_shift(2),At.e.c=$t.read_shift(2),At.s.r=$t.read_shift(4),At.e.r=$t.read_shift(4),$t.l+=4,$t.l+2<$t.length&&(bt=$t.read_shift(2),ft=$t.read_shift(1),vt=bt==0?"":$t.read_shift(bt,"cstr")),vt||(vt=encode_col(kt))}break;case 1538:{if(At.s.c>255||At.s.r>999999)break;At.e.c<At.s.c&&(At.e.c=At.s.c),At.e.r<At.s.r&&(At.e.r=At.s.r),Qe["!ref"]=encode_range(At),book_append_sheet(Ct,Qe,vt)}break;case 2561:Et=$t.read_shift(2),At.e.c<Et&&(At.e.c=Et),At.s.c>Et&&(At.s.c=Et),Ye=$t.read_shift(4),At.s.r>Ye&&(At.s.r=Ye),Ye=$t.read_shift(4),At.e.r<Ye&&(At.e.r=Ye);break;case 3073:{Ye=$t.read_shift(4),bt=$t.read_shift(4),At.s.r>Ye&&(At.s.r=Ye),At.e.r<Ye+bt-1&&(At.e.r=Ye+bt-1);for(var Ft=encode_col(Et);$t.l<$t.length;){var qt={t:"z"},Mt=$t.read_shift(1);Mt&128&&($t.l+=2);var Wt=Mt&64?$t.read_shift(2)-1:0;switch(Mt&31){case 1:break;case 2:qt={t:"n",v:$t.read_shift(2)};break;case 3:qt={t:"n",v:$t.read_shift(2,"i")};break;case 5:qt={t:"n",v:$t.read_shift(8,"f")};break;case 7:qt={t:"s",v:dt[ft=$t.read_shift(4)-1]};break;case 8:qt={t:"n",v:$t.read_shift(8,"f")},$t.l+=2,$t.l+=4;break;default:throw"Unrecognized QPW cell type "+(Mt&31)}var Zt=0;if(Mt&32)switch(Mt&31){case 2:Zt=$t.read_shift(2);break;case 3:Zt=$t.read_shift(2,"i");break;case 7:Zt=$t.read_shift(2);break;default:throw"Unsupported delta for QPW cell type "+(Mt&31)}for(!ct.sheetStubs&&qt.t=="z"||(Qe["!data"]!=null?(Qe["!data"][Ye]||(Qe["!data"][Ye]=[]),Qe["!data"][Ye][Et]=qt):Qe[Ft+encode_row(Ye)]=qt),++Ye,--bt;Wt-- >0&&bt>=0;){if(Mt&32)switch(Mt&31){case 2:qt={t:"n",v:qt.v+Zt&65535};break;case 3:qt={t:"n",v:qt.v+Zt&65535},qt.v>32767&&(qt.v-=65536);break;case 7:qt={t:"s",v:dt[ft=ft+Zt>>>0]};break;default:throw"Cannot apply delta for QPW cell type "+(Mt&31)}else switch(Mt&31){case 1:qt={t:"z"};break;case 2:qt={t:"n",v:$t.read_shift(2)};break;case 7:qt={t:"s",v:dt[ft=$t.read_shift(4)-1]};break;default:throw"Cannot apply repeat for QPW cell type "+(Mt&31)}!ct.sheetStubs&&qt.t=="z"||(Qe["!data"]!=null?(Qe["!data"][Ye]||(Qe["!data"][Ye]=[]),Qe["!data"][Ye][Et]=qt):Qe[Ft+encode_row(Ye)]=qt),++Ye,--bt}}}break}Ke.l+=St}return Ct}return{sheet_to_wk1:E,book_to_wk3:S,to_workbook:r}}();function parse_rpr(n){var r={},_=n.match(tagregex),E=0,S=!1;if(_)for(;E!=_.length;++E){var C=parsexmltag(_[E]);switch(C[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!C.val)break;case"<shadow>":case"<shadow/>":r.shadow=1;break;case"</shadow>":break;case"<charset":if(C.val=="1")break;r.cp=CS2CP[parseInt(C.val,10)];break;case"<outline":if(!C.val)break;case"<outline>":case"<outline/>":r.outline=1;break;case"</outline>":break;case"<rFont":r.name=C.val;break;case"<sz":r.sz=C.val;break;case"<strike":if(!C.val)break;case"<strike>":case"<strike/>":r.strike=1;break;case"</strike>":break;case"<u":if(!C.val)break;switch(C.val){case"double":r.uval="double";break;case"singleAccounting":r.uval="single-accounting";break;case"doubleAccounting":r.uval="double-accounting";break}case"<u>":case"<u/>":r.u=1;break;case"</u>":break;case"<b":if(C.val=="0")break;case"<b>":case"<b/>":r.b=1;break;case"</b>":break;case"<i":if(C.val=="0")break;case"<i>":case"<i/>":r.i=1;break;case"</i>":break;case"<color":C.rgb&&(r.color=C.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":r.family=C.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":r.valign=C.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":S=!0;break;case"</ext>":S=!1;break;default:if(C[0].charCodeAt(1)!==47&&!S)throw new Error("Unrecognized rich format "+C[0])}}return r}var parse_rs=function(){var n=matchtag("t"),r=matchtag("rPr");function _(C){var A=C.match(n);if(!A)return{t:"s",v:""};var I={t:"s",v:unescapexml(A[1])},B=C.match(r);return B&&(I.s=parse_rpr(B[1])),I}var E=/<(?:\w+:)?r>/g,S=/<\/(?:\w+:)?r>/;return function(A){return A.replace(E,"").split(S).map(_).filter(function(I){return I.v})}}(),rs_to_html=function(){var r=/(\r\n|\n)/g;function _(S,C,A){var I=[];S.u&&I.push("text-decoration: underline;"),S.uval&&I.push("text-underline-style:"+S.uval+";"),S.sz&&I.push("font-size:"+S.sz+"pt;"),S.outline&&I.push("text-effect: outline;"),S.shadow&&I.push("text-shadow: auto;"),C.push('<span style="'+I.join("")+'">'),S.b&&(C.push("<b>"),A.push("</b>")),S.i&&(C.push("<i>"),A.push("</i>")),S.strike&&(C.push("<s>"),A.push("</s>"));var B=S.valign||"";return B=="superscript"||B=="super"?B="sup":B=="subscript"&&(B="sub"),B!=""&&(C.push("<"+B+">"),A.push("</"+B+">")),A.push("</span>"),S}function E(S){var C=[[],S.v,[]];return S.v?(S.s&&_(S.s,C[0],C[2]),C[0].join("")+C[1].replace(r,"<br/>")+C[2].join("")):""}return function(C){return C.map(E).join("")}}(),sitregex=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,sirregex=/<(?:\w+:)?r>/,sirphregex=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function parse_si(n,r){var _=r?r.cellHTML:!0,E={};return n?(n.match(/^\s*<(?:\w+:)?t[^>]*>/)?(E.t=unescapexml(utf8read(n.slice(n.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||""),!0),E.r=utf8read(n),_&&(E.h=escapehtml(E.t))):n.match(sirregex)&&(E.r=utf8read(n),E.t=unescapexml(utf8read((n.replace(sirphregex,"").match(sitregex)||[]).join("").replace(tagregex,"")),!0),_&&(E.h=rs_to_html(parse_rs(E.r)))),E):{t:""}}var sstr0=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,sstr1=/<(?:\w+:)?(?:si|sstItem)>/g,sstr2=/<\/(?:\w+:)?(?:si|sstItem)>/;function parse_sst_xml(n,r){var _=[],E="";if(!n)return _;var S=n.match(sstr0);if(S){E=S[2].replace(sstr1,"").split(sstr2);for(var C=0;C!=E.length;++C){var A=parse_si(E[C].trim(),r);A!=null&&(_[_.length]=A)}S=parsexmltag(S[1]),_.Count=S.count,_.Unique=S.uniqueCount}return _}var straywsregex=/^\s|\s$|[\t\n\r]/;function write_sst_xml(n,r){if(!r.bookSST)return"";var _=[XML_HEADER];_[_.length]=writextag("sst",null,{xmlns:XMLNS_main[0],count:n.Count,uniqueCount:n.Unique});for(var E=0;E!=n.length;++E)if(n[E]!=null){var S=n[E],C="<si>";S.r?C+=S.r:(C+="<t",S.t||(S.t=""),typeof S.t!="string"&&(S.t=String(S.t)),S.t.match(straywsregex)&&(C+=' xml:space="preserve"'),C+=">"+escapexml(S.t)+"</t>"),C+="</si>",_[_.length]=C}return _.length>2&&(_[_.length]="</sst>",_[1]=_[1].replace("/>",">")),_.join("")}function parse_BrtBeginSst(n){return[n.read_shift(4),n.read_shift(4)]}function parse_sst_bin(n,r){var _=[],E=!1;return recordhopper(n,function(C,A,I){switch(I){case 159:_.Count=C[0],_.Unique=C[1];break;case 19:_.push(C);break;case 160:return!0;case 35:E=!0;break;case 36:E=!1;break;default:if(A.T,!E||r.WTF)throw new Error("Unexpected record 0x"+I.toString(16))}}),_}function write_BrtBeginSst(n,r){return r||(r=new_buf(8)),r.write_shift(4,n.Count),r.write_shift(4,n.Unique),r}var write_BrtSSTItem=write_RichStr;function write_sst_bin(n){var r=buf_array();write_record(r,159,write_BrtBeginSst(n));for(var _=0;_<n.length;++_)write_record(r,19,write_BrtSSTItem(n[_]));return write_record(r,160),r.end()}function _JS2ANSI(n){for(var r=[],_=n.split(""),E=0;E<_.length;++E)r[E]=_[E].charCodeAt(0);return r}function parse_CRYPTOVersion(n,r){var _={};return _.Major=n.read_shift(2),_.Minor=n.read_shift(2),r>=4&&(n.l+=r-4),_}function parse_DataSpaceVersionInfo(n){var r={};return r.id=n.read_shift(0,"lpp4"),r.R=parse_CRYPTOVersion(n,4),r.U=parse_CRYPTOVersion(n,4),r.W=parse_CRYPTOVersion(n,4),r}function parse_DataSpaceMapEntry(n){for(var r=n.read_shift(4),_=n.l+r-4,E={},S=n.read_shift(4),C=[];S-- >0;)C.push({t:n.read_shift(4),v:n.read_shift(0,"lpp4")});if(E.name=n.read_shift(0,"lpp4"),E.comps=C,n.l!=_)throw new Error("Bad DataSpaceMapEntry: "+n.l+" != "+_);return E}function parse_DataSpaceMap(n){var r=[];n.l+=4;for(var _=n.read_shift(4);_-- >0;)r.push(parse_DataSpaceMapEntry(n));return r}function parse_DataSpaceDefinition(n){var r=[];n.l+=4;for(var _=n.read_shift(4);_-- >0;)r.push(n.read_shift(0,"lpp4"));return r}function parse_TransformInfoHeader(n){var r={};return n.read_shift(4),n.l+=4,r.id=n.read_shift(0,"lpp4"),r.name=n.read_shift(0,"lpp4"),r.R=parse_CRYPTOVersion(n,4),r.U=parse_CRYPTOVersion(n,4),r.W=parse_CRYPTOVersion(n,4),r}function parse_Primary(n){var r=parse_TransformInfoHeader(n);if(r.ename=n.read_shift(0,"8lpp4"),r.blksz=n.read_shift(4),r.cmode=n.read_shift(4),n.read_shift(4)!=4)throw new Error("Bad !Primary record");return r}function parse_EncryptionHeader(n,r){var _=n.l+r,E={};E.Flags=n.read_shift(4)&63,n.l+=4,E.AlgID=n.read_shift(4);var S=!1;switch(E.AlgID){case 26126:case 26127:case 26128:S=E.Flags==36;break;case 26625:S=E.Flags==4;break;case 0:S=E.Flags==16||E.Flags==4||E.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+E.AlgID}if(!S)throw new Error("Encryption Flags/AlgID mismatch");return E.AlgIDHash=n.read_shift(4),E.KeySize=n.read_shift(4),E.ProviderType=n.read_shift(4),n.l+=8,E.CSPName=n.read_shift(_-n.l>>1,"utf16le"),n.l=_,E}function parse_EncryptionVerifier(n,r){var _={},E=n.l+r;return n.l+=4,_.Salt=n.slice(n.l,n.l+16),n.l+=16,_.Verifier=n.slice(n.l,n.l+16),n.l+=16,n.read_shift(4),_.VerifierHash=n.slice(n.l,E),n.l=E,_}function parse_EncryptionInfo(n){var r=parse_CRYPTOVersion(n);switch(r.Minor){case 2:return[r.Minor,parse_EncInfoStd(n)];case 3:return[r.Minor,parse_EncInfoExt()];case 4:return[r.Minor,parse_EncInfoAgl(n)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+r.Minor)}function parse_EncInfoStd(n){var r=n.read_shift(4);if((r&63)!=36)throw new Error("EncryptionInfo mismatch");var _=n.read_shift(4),E=parse_EncryptionHeader(n,_),S=parse_EncryptionVerifier(n,n.length-n.l);return{t:"Std",h:E,v:S}}function parse_EncInfoExt(){throw new Error("File is password-protected: ECMA-376 Extensible")}function parse_EncInfoAgl(n){var r=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];n.l+=4;var _=n.read_shift(n.length-n.l,"utf8"),E={};return _.replace(tagregex,function(C){var A=parsexmltag(C);switch(strip_ns(A[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":r.forEach(function(I){E[I]=A[I]});break;case"<dataIntegrity":E.encryptedHmacKey=A.encryptedHmacKey,E.encryptedHmacValue=A.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":E.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":E.uri=A.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":E.encs.push(A);break;default:throw A[0]}}),E}function parse_RC4CryptoHeader(n,r){var _={},E=_.EncryptionVersionInfo=parse_CRYPTOVersion(n,4);if(r-=4,E.Minor!=2)throw new Error("unrecognized minor version code: "+E.Minor);if(E.Major>4||E.Major<2)throw new Error("unrecognized major version code: "+E.Major);_.Flags=n.read_shift(4),r-=4;var S=n.read_shift(4);return r-=4,_.EncryptionHeader=parse_EncryptionHeader(n,S),r-=S,_.EncryptionVerifier=parse_EncryptionVerifier(n,r),_}function parse_RC4Header(n){var r={},_=r.EncryptionVersionInfo=parse_CRYPTOVersion(n,4);if(_.Major!=1||_.Minor!=1)throw"unrecognized version code "+_.Major+" : "+_.Minor;return r.Salt=n.read_shift(16),r.EncryptedVerifier=n.read_shift(16),r.EncryptedVerifierHash=n.read_shift(16),r}function crypto_CreatePasswordVerifier_Method1(n){var r=0,_,E=_JS2ANSI(n),S=E.length+1,C,A,I,B,O;for(_=new_raw_buf(S),_[0]=E.length,C=1;C!=S;++C)_[C]=E[C-1];for(C=S-1;C>=0;--C)A=_[C],I=r&16384?1:0,B=r<<1&32767,O=I|B,r=O^A;return r^52811}var crypto_CreateXorArray_Method1=function(){var n=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],r=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],_=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],E=function(A){return(A/2|A*128)&255},S=function(A,I){return E(A^I)},C=function(A){for(var I=r[A.length-1],B=104,O=A.length-1;O>=0;--O)for(var N=A[O],U=0;U!=7;++U)N&64&&(I^=_[B]),N*=2,--B;return I};return function(A){for(var I=_JS2ANSI(A),B=C(I),O=I.length,N=new_raw_buf(16),U=0;U!=16;++U)N[U]=0;var j,z,Z;for((O&1)===1&&(j=B>>8,N[O]=S(n[0],j),--O,j=B&255,z=I[I.length-1],N[O]=S(z,j));O>0;)--O,j=B>>8,N[O]=S(I[O],j),--O,j=B&255,N[O]=S(I[O],j);for(O=15,Z=15-I.length;Z>0;)j=B>>8,N[O]=S(n[Z],j),--O,--Z,j=B&255,N[O]=S(I[O],j),--O,--Z;return N}}(),crypto_DecryptData_Method1=function(n,r,_,E,S){S||(S=r),E||(E=crypto_CreateXorArray_Method1(n));var C,A;for(C=0;C!=r.length;++C)A=r[C],A^=E[_],A=(A>>5|A<<3)&255,S[C]=A,++_;return[S,_,E]},crypto_MakeXorDecryptor=function(n){var r=0,_=crypto_CreateXorArray_Method1(n);return function(E){var S=crypto_DecryptData_Method1("",E,r,_);return r=S[1],S[0]}};function parse_XORObfuscation(n,r,_,E){var S={key:parseuint16(n),verificationBytes:parseuint16(n)};return _.password&&(S.verifier=crypto_CreatePasswordVerifier_Method1(_.password)),E.valid=S.verificationBytes===S.verifier,E.valid&&(E.insitu=crypto_MakeXorDecryptor(_.password)),S}function parse_FilePassHeader(n,r,_){var E=_||{};return E.Info=n.read_shift(2),n.l-=2,E.Info===1?E.Data=parse_RC4Header(n):E.Data=parse_RC4CryptoHeader(n,r),E}function parse_FilePass(n,r,_){var E={Type:_.biff>=8?n.read_shift(2):0};return E.Type?parse_FilePassHeader(n,r-2,E):parse_XORObfuscation(n,_.biff>=8?r:r-2,_,E),E}function rtf_to_sheet(n,r){switch(r.type){case"base64":return rtf_to_sheet_str(Base64_decode(n),r);case"binary":return rtf_to_sheet_str(n,r);case"buffer":return rtf_to_sheet_str(has_buf&&Buffer.isBuffer(n)?n.toString("binary"):a2s(n),r);case"array":return rtf_to_sheet_str(cc2str(n),r)}throw new Error("Unrecognized type "+r.type)}function rtf_to_sheet_str(n,r){var _=r||{},E={},S=_.dense;S&&(E["!data"]=[]);var C=n.match(/\\trowd[\s\S]*?\\row\b/g);if(!C)throw new Error("RTF missing table");var A={s:{c:0,r:0},e:{c:0,r:C.length-1}},I=[];return C.forEach(function(B,O){S&&(I=E["!data"][O]=[]);for(var N=/\\[\w\-]+\b/g,U=0,j,z=-1,Z=[];(j=N.exec(B))!=null;){var X=B.slice(U,N.lastIndex-j[0].length);switch(X.charCodeAt(0)==32&&(X=X.slice(1)),X.length&&Z.push(X),j[0]){case"\\cell":if(++z,Z.length){var Q={v:Z.join(""),t:"s"};Q.v=="TRUE"||Q.v=="FALSE"?(Q.v=Q.v=="TRUE",Q.t="b"):isNaN(fuzzynum(Q.v))||(Q.t="n",_.cellText!==!1&&(Q.w=Q.v),Q.v=fuzzynum(Q.v)),S?I[z]=Q:E[encode_cell({r:O,c:z})]=Q}Z=[];break;case"\\par":Z.push(`
`);break}U=N.lastIndex}z>A.e.c&&(A.e.c=z)}),E["!ref"]=encode_range(A),E}function rtf_to_workbook(n,r){var _=sheet_to_workbook(rtf_to_sheet(n,r),r);return _.bookType="rtf",_}function sheet_to_rtf(n,r){var _=["{\\rtf1\\ansi"];if(!n["!ref"])return _[0]+"}";for(var E=safe_decode_range(n["!ref"]),S,C=n["!data"]!=null,A=[],I=E.s.r;I<=E.e.r;++I){_.push("\\trowd\\trautofit1");for(var B=E.s.c;B<=E.e.c;++B)_.push("\\cellx"+(B+1));for(_.push("\\pard\\intbl"),C&&(A=n["!data"][I]||[]),B=E.s.c;B<=E.e.c;++B){var O=encode_cell({r:I,c:B});if(S=C?A[B]:n[O],!S||S.v==null&&(!S.f||S.F)){_.push(" \\cell");continue}_.push(" "+(S.w||(format_cell(S),S.w)||"").replace(/[\r\n]/g,"\\par ")),_.push("\\cell")}_.push("\\pard\\intbl\\row")}return _.join("")+"}"}function hex2RGB(n){var r=n.slice(n[0]==="#"?1:0).slice(0,6);return[parseInt(r.slice(0,2),16),parseInt(r.slice(2,4),16),parseInt(r.slice(4,6),16)]}function rgb2Hex(n){for(var r=0,_=1;r!=3;++r)_=_*256+(n[r]>255?255:n[r]<0?0:n[r]);return _.toString(16).toUpperCase().slice(1)}function rgb2HSL(n){var r=n[0]/255,_=n[1]/255,E=n[2]/255,S=Math.max(r,_,E),C=Math.min(r,_,E),A=S-C;if(A===0)return[0,0,r];var I=0,B=0,O=S+C;switch(B=A/(O>1?2-O:O),S){case r:I=((_-E)/A+6)%6;break;case _:I=(E-r)/A+2;break;case E:I=(r-_)/A+4;break}return[I/6,B,O/2]}function hsl2RGB(n){var r=n[0],_=n[1],E=n[2],S=_*2*(E<.5?E:1-E),C=E-S/2,A=[C,C,C],I=6*r,B;if(_!==0)switch(I|0){case 0:case 6:B=S*I,A[0]+=S,A[1]+=B;break;case 1:B=S*(2-I),A[0]+=B,A[1]+=S;break;case 2:B=S*(I-2),A[1]+=S,A[2]+=B;break;case 3:B=S*(4-I),A[1]+=B,A[2]+=S;break;case 4:B=S*(I-4),A[2]+=S,A[0]+=B;break;case 5:B=S*(6-I),A[2]+=B,A[0]+=S;break}for(var O=0;O!=3;++O)A[O]=Math.round(A[O]*255);return A}function rgb_tint(n,r){if(r===0)return n;var _=rgb2HSL(hex2RGB(n));return r<0?_[2]=_[2]*(1+r):_[2]=1-(1-_[2])*(1-r),rgb2Hex(hsl2RGB(_))}var DEF_MDW=6,MAX_MDW=15,MIN_MDW=1,MDW=DEF_MDW;function width2px(n){return Math.floor((n+Math.round(128/MDW)/256)*MDW)}function px2char(n){return Math.floor((n-5)/MDW*100+.5)/100}function char2width(n){return Math.round((n*MDW+5)/MDW*256)/256}function cycle_width(n){return char2width(px2char(width2px(n)))}function find_mdw_colw(n){var r=Math.abs(n-cycle_width(n)),_=MDW;if(r>.005)for(MDW=MIN_MDW;MDW<MAX_MDW;++MDW)Math.abs(n-cycle_width(n))<=r&&(r=Math.abs(n-cycle_width(n)),_=MDW);MDW=_}function process_col(n){n.width?(n.wpx=width2px(n.width),n.wch=px2char(n.wpx),n.MDW=MDW):n.wpx?(n.wch=px2char(n.wpx),n.width=char2width(n.wch),n.MDW=MDW):typeof n.wch=="number"&&(n.width=char2width(n.wch),n.wpx=width2px(n.width),n.MDW=MDW),n.customWidth&&delete n.customWidth}var DEF_PPI=96,PPI=DEF_PPI;function px2pt(n){return n*96/PPI}function pt2px(n){return n*PPI/96}var XLMLPatternTypeMap={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function parse_borders(n,r,_,E){r.Borders=[];var S={},C=!1;(n[0].match(tagregex)||[]).forEach(function(A){var I=parsexmltag(A);switch(strip_ns(I[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":S={},I.diagonalUp&&(S.diagonalUp=parsexmlbool(I.diagonalUp)),I.diagonalDown&&(S.diagonalDown=parsexmlbool(I.diagonalDown)),r.Borders.push(S);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":C=!0;break;case"</ext>":C=!1;break;default:if(E&&E.WTF&&!C)throw new Error("unrecognized "+I[0]+" in borders")}})}function parse_fills(n,r,_,E){r.Fills=[];var S={},C=!1;(n[0].match(tagregex)||[]).forEach(function(A){var I=parsexmltag(A);switch(strip_ns(I[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":S={},r.Fills.push(S);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":r.Fills.push(S),S={};break;case"<patternFill":case"<patternFill>":I.patternType&&(S.patternType=I.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":S.bgColor||(S.bgColor={}),I.indexed&&(S.bgColor.indexed=parseInt(I.indexed,10)),I.theme&&(S.bgColor.theme=parseInt(I.theme,10)),I.tint&&(S.bgColor.tint=parseFloat(I.tint)),I.rgb&&(S.bgColor.rgb=I.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":S.fgColor||(S.fgColor={}),I.theme&&(S.fgColor.theme=parseInt(I.theme,10)),I.tint&&(S.fgColor.tint=parseFloat(I.tint)),I.rgb!=null&&(S.fgColor.rgb=I.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":C=!0;break;case"</ext>":C=!1;break;default:if(E&&E.WTF&&!C)throw new Error("unrecognized "+I[0]+" in fills")}})}function parse_fonts(n,r,_,E){r.Fonts=[];var S={},C=!1;(n[0].match(tagregex)||[]).forEach(function(A){var I=parsexmltag(A);switch(strip_ns(I[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":r.Fonts.push(S),S={};break;case"<name":I.val&&(S.name=utf8read(I.val));break;case"<name/>":case"</name>":break;case"<b":S.bold=I.val?parsexmlbool(I.val):1;break;case"<b/>":S.bold=1;break;case"<i":S.italic=I.val?parsexmlbool(I.val):1;break;case"<i/>":S.italic=1;break;case"<u":switch(I.val){case"none":S.underline=0;break;case"single":S.underline=1;break;case"double":S.underline=2;break;case"singleAccounting":S.underline=33;break;case"doubleAccounting":S.underline=34;break}break;case"<u/>":S.underline=1;break;case"<strike":S.strike=I.val?parsexmlbool(I.val):1;break;case"<strike/>":S.strike=1;break;case"<outline":S.outline=I.val?parsexmlbool(I.val):1;break;case"<outline/>":S.outline=1;break;case"<shadow":S.shadow=I.val?parsexmlbool(I.val):1;break;case"<shadow/>":S.shadow=1;break;case"<condense":S.condense=I.val?parsexmlbool(I.val):1;break;case"<condense/>":S.condense=1;break;case"<extend":S.extend=I.val?parsexmlbool(I.val):1;break;case"<extend/>":S.extend=1;break;case"<sz":I.val&&(S.sz=+I.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":I.val&&(S.vertAlign=I.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":I.val&&(S.family=parseInt(I.val,10));break;case"<family/>":case"</family>":break;case"<scheme":I.val&&(S.scheme=I.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(I.val=="1")break;I.codepage=CS2CP[parseInt(I.val,10)];break;case"<color":if(S.color||(S.color={}),I.auto&&(S.color.auto=parsexmlbool(I.auto)),I.rgb)S.color.rgb=I.rgb.slice(-6);else if(I.indexed){S.color.index=parseInt(I.indexed,10);var B=XLSIcv[S.color.index];S.color.index==81&&(B=XLSIcv[1]),B||(B=XLSIcv[1]),S.color.rgb=B[0].toString(16)+B[1].toString(16)+B[2].toString(16)}else I.theme&&(S.color.theme=parseInt(I.theme,10),I.tint&&(S.color.tint=parseFloat(I.tint)),I.theme&&_.themeElements&&_.themeElements.clrScheme&&(S.color.rgb=rgb_tint(_.themeElements.clrScheme[S.color.theme].rgb,S.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":C=!0;break;case"</AlternateContent>":C=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":C=!0;break;case"</ext>":C=!1;break;default:if(E&&E.WTF&&!C)throw new Error("unrecognized "+I[0]+" in fonts")}})}function parse_numFmts(n,r,_){r.NumberFmt=[];for(var E=keys(table_fmt),S=0;S<E.length;++S)r.NumberFmt[E[S]]=table_fmt[E[S]];var C=n[0].match(tagregex);if(C)for(S=0;S<C.length;++S){var A=parsexmltag(C[S]);switch(strip_ns(A[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var I=unescapexml(utf8read(A.formatCode)),B=parseInt(A.numFmtId,10);if(r.NumberFmt[B]=I,B>0){if(B>392){for(B=392;B>60&&r.NumberFmt[B]!=null;--B);r.NumberFmt[B]=I}SSF__load(I,B)}}break;case"</numFmt>":break;default:if(_.WTF)throw new Error("unrecognized "+A[0]+" in numFmts")}}}function write_numFmts(n){var r=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(_){for(var E=_[0];E<=_[1];++E)n[E]!=null&&(r[r.length]=writextag("numFmt",null,{numFmtId:E,formatCode:escapexml(n[E])}))}),r.length===1?"":(r[r.length]="</numFmts>",r[0]=writextag("numFmts",null,{count:r.length-2}).replace("/>",">"),r.join(""))}var cellXF_uint=["numFmtId","fillId","fontId","borderId","xfId"],cellXF_bool=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function parse_cellXfs(n,r,_){r.CellXf=[];var E,S=!1;(n[0].match(tagregex)||[]).forEach(function(C){var A=parsexmltag(C),I=0;switch(strip_ns(A[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(E=A,delete E[0],I=0;I<cellXF_uint.length;++I)E[cellXF_uint[I]]&&(E[cellXF_uint[I]]=parseInt(E[cellXF_uint[I]],10));for(I=0;I<cellXF_bool.length;++I)E[cellXF_bool[I]]&&(E[cellXF_bool[I]]=parsexmlbool(E[cellXF_bool[I]]));if(r.NumberFmt&&E.numFmtId>392){for(I=392;I>60;--I)if(r.NumberFmt[E.numFmtId]==r.NumberFmt[I]){E.numFmtId=I;break}}r.CellXf.push(E);break;case"</xf>":break;case"<alignment":case"<alignment/>":var B={};A.vertical&&(B.vertical=A.vertical),A.horizontal&&(B.horizontal=A.horizontal),A.textRotation!=null&&(B.textRotation=A.textRotation),A.indent&&(B.indent=A.indent),A.wrapText&&(B.wrapText=parsexmlbool(A.wrapText)),E.alignment=B;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":S=!0;break;case"</AlternateContent>":S=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":S=!0;break;case"</ext>":S=!1;break;default:if(_&&_.WTF&&!S)throw new Error("unrecognized "+A[0]+" in cellXfs")}})}function write_cellXfs(n){var r=[];return r[r.length]=writextag("cellXfs",null),n.forEach(function(_){r[r.length]=writextag("xf",null,_)}),r[r.length]="</cellXfs>",r.length===2?"":(r[0]=writextag("cellXfs",null,{count:r.length-2}).replace("/>",">"),r.join(""))}var parse_sty_xml=function(){var r=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,_=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,E=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,S=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,C=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(I,B,O){var N={};if(!I)return N;I=I.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var U;return(U=I.match(r))&&parse_numFmts(U,N,O),(U=I.match(S))&&parse_fonts(U,N,B,O),(U=I.match(E))&&parse_fills(U,N,B,O),(U=I.match(C))&&parse_borders(U,N,B,O),(U=I.match(_))&&parse_cellXfs(U,N,O),N}}();function write_sty_xml(n,r){var _=[XML_HEADER,writextag("styleSheet",null,{xmlns:XMLNS_main[0],"xmlns:vt":XMLNS.vt})],E;return n.SSF&&(E=write_numFmts(n.SSF))!=null&&(_[_.length]=E),_[_.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',_[_.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',_[_.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',_[_.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(E=write_cellXfs(r.cellXfs))&&(_[_.length]=E),_[_.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',_[_.length]='<dxfs count="0"/>',_[_.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',_.length>2&&(_[_.length]="</styleSheet>",_[1]=_[1].replace("/>",">")),_.join("")}function parse_BrtFmt(n,r){var _=n.read_shift(2),E=parse_XLWideString(n);return[_,E]}function write_BrtFmt(n,r,_){_||(_=new_buf(6+4*r.length)),_.write_shift(2,n),write_XLWideString(r,_);var E=_.length>_.l?_.slice(0,_.l):_;return _.l==null&&(_.l=_.length),E}function parse_BrtFont(n,r,_){var E={};E.sz=n.read_shift(2)/20;var S=parse_FontFlags(n);S.fItalic&&(E.italic=1),S.fCondense&&(E.condense=1),S.fExtend&&(E.extend=1),S.fShadow&&(E.shadow=1),S.fOutline&&(E.outline=1),S.fStrikeout&&(E.strike=1);var C=n.read_shift(2);switch(C===700&&(E.bold=1),n.read_shift(2)){case 1:E.vertAlign="superscript";break;case 2:E.vertAlign="subscript";break}var A=n.read_shift(1);A!=0&&(E.underline=A);var I=n.read_shift(1);I>0&&(E.family=I);var B=n.read_shift(1);switch(B>0&&(E.charset=B),n.l++,E.color=parse_BrtColor(n),n.read_shift(1)){case 1:E.scheme="major";break;case 2:E.scheme="minor";break}return E.name=parse_XLWideString(n),E}function write_BrtFont(n,r){r||(r=new_buf(25+4*32)),r.write_shift(2,n.sz*20),write_FontFlags(n,r),r.write_shift(2,n.bold?700:400);var _=0;n.vertAlign=="superscript"?_=1:n.vertAlign=="subscript"&&(_=2),r.write_shift(2,_),r.write_shift(1,n.underline||0),r.write_shift(1,n.family||0),r.write_shift(1,n.charset||0),r.write_shift(1,0),write_BrtColor(n.color,r);var E=0;return n.scheme=="major"&&(E=1),n.scheme=="minor"&&(E=2),r.write_shift(1,E),write_XLWideString(n.name,r),r.length>r.l?r.slice(0,r.l):r}var XLSBFillPTNames=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],rev_XLSBFillPTNames,parse_BrtFill=parsenoop;function write_BrtFill(n,r){r||(r=new_buf(4*3+8*7+16*1)),rev_XLSBFillPTNames||(rev_XLSBFillPTNames=evert(XLSBFillPTNames));var _=rev_XLSBFillPTNames[n.patternType];_==null&&(_=40),r.write_shift(4,_);var E=0;if(_!=40)for(write_BrtColor({auto:1},r),write_BrtColor({auto:1},r);E<12;++E)r.write_shift(4,0);else{for(;E<4;++E)r.write_shift(4,0);for(;E<12;++E)r.write_shift(4,0)}return r.length>r.l?r.slice(0,r.l):r}function parse_BrtXF(n,r){var _=n.l+r,E=n.read_shift(2),S=n.read_shift(2);return n.l=_,{ixfe:E,numFmtId:S}}function write_BrtXF(n,r,_){_||(_=new_buf(16)),_.write_shift(2,r||0),_.write_shift(2,n.numFmtId||0),_.write_shift(2,0),_.write_shift(2,0),_.write_shift(2,0),_.write_shift(1,0),_.write_shift(1,0);var E=0;return _.write_shift(1,E),_.write_shift(1,0),_.write_shift(1,0),_.write_shift(1,0),_}function write_Blxf(n,r){return r||(r=new_buf(10)),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(4,0),r}var parse_BrtBorder=parsenoop;function write_BrtBorder(n,r){return r||(r=new_buf(51)),r.write_shift(1,0),write_Blxf(null,r),write_Blxf(null,r),write_Blxf(null,r),write_Blxf(null,r),write_Blxf(null,r),r.length>r.l?r.slice(0,r.l):r}function write_BrtStyle(n,r){return r||(r=new_buf(12+4*10)),r.write_shift(4,n.xfId),r.write_shift(2,1),r.write_shift(1,+n.builtinId),r.write_shift(1,0),write_XLNullableWideString(n.name||"",r),r.length>r.l?r.slice(0,r.l):r}function write_BrtBeginTableStyles(n,r,_){var E=new_buf(2052);return E.write_shift(4,n),write_XLNullableWideString(r,E),write_XLNullableWideString(_,E),E.length>E.l?E.slice(0,E.l):E}function parse_sty_bin(n,r,_){var E={};E.NumberFmt=[];for(var S in table_fmt)E.NumberFmt[S]=table_fmt[S];E.CellXf=[],E.Fonts=[];var C=[],A=!1;return recordhopper(n,function(B,O,N){switch(N){case 44:E.NumberFmt[B[0]]=B[1],SSF__load(B[1],B[0]);break;case 43:E.Fonts.push(B),B.color.theme!=null&&r&&r.themeElements&&r.themeElements.clrScheme&&(B.color.rgb=rgb_tint(r.themeElements.clrScheme[B.color.theme].rgb,B.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:C[C.length-1]==617&&E.CellXf.push(B);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:A=!0;break;case 36:A=!1;break;case 37:C.push(N),A=!0;break;case 38:C.pop(),A=!1;break;default:if(O.T>0)C.push(N);else if(O.T<0)C.pop();else if(!A||_.WTF&&C[C.length-1]!=37)throw new Error("Unexpected record 0x"+N.toString(16))}}),E}function write_FMTS_bin(n,r){if(r){var _=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(E){for(var S=E[0];S<=E[1];++S)r[S]!=null&&++_}),_!=0&&(write_record(n,615,write_UInt32LE(_)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(E){for(var S=E[0];S<=E[1];++S)r[S]!=null&&write_record(n,44,write_BrtFmt(S,r[S]))}),write_record(n,616))}}function write_FONTS_bin(n){var r=1;write_record(n,611,write_UInt32LE(r)),write_record(n,43,write_BrtFont({sz:12,color:{theme:1},name:"Calibri",family:2,scheme:"minor"})),write_record(n,612)}function write_FILLS_bin(n){var r=2;write_record(n,603,write_UInt32LE(r)),write_record(n,45,write_BrtFill({patternType:"none"})),write_record(n,45,write_BrtFill({patternType:"gray125"})),write_record(n,604)}function write_BORDERS_bin(n){var r=1;write_record(n,613,write_UInt32LE(r)),write_record(n,46,write_BrtBorder()),write_record(n,614)}function write_CELLSTYLEXFS_bin(n){var r=1;write_record(n,626,write_UInt32LE(r)),write_record(n,47,write_BrtXF({numFmtId:0,fontId:0,fillId:0,borderId:0},65535)),write_record(n,627)}function write_CELLXFS_bin(n,r){write_record(n,617,write_UInt32LE(r.length)),r.forEach(function(_){write_record(n,47,write_BrtXF(_,0))}),write_record(n,618)}function write_STYLES_bin(n){var r=1;write_record(n,619,write_UInt32LE(r)),write_record(n,48,write_BrtStyle({xfId:0,builtinId:0,name:"Normal"})),write_record(n,620)}function write_DXFS_bin(n){var r=0;write_record(n,505,write_UInt32LE(r)),write_record(n,506)}function write_TABLESTYLES_bin(n){var r=0;write_record(n,508,write_BrtBeginTableStyles(r,"TableStyleMedium9","PivotStyleMedium4")),write_record(n,509)}function write_sty_bin(n,r){var _=buf_array();return write_record(_,278),write_FMTS_bin(_,n.SSF),write_FONTS_bin(_),write_FILLS_bin(_),write_BORDERS_bin(_),write_CELLSTYLEXFS_bin(_),write_CELLXFS_bin(_,r.cellXfs),write_STYLES_bin(_),write_DXFS_bin(_),write_TABLESTYLES_bin(_),write_record(_,279),_.end()}var XLSXThemeClrScheme=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function parse_clrScheme(n,r,_){r.themeElements.clrScheme=[];var E={};(n[0].match(tagregex)||[]).forEach(function(S){var C=parsexmltag(S);switch(C[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":E.rgb=C.val;break;case"<a:sysClr":E.rgb=C.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":C[0].charAt(1)==="/"?(r.themeElements.clrScheme[XLSXThemeClrScheme.indexOf(C[0])]=E,E={}):E.name=C[0].slice(3,C[0].length-1);break;default:if(_&&_.WTF)throw new Error("Unrecognized "+C[0]+" in clrScheme")}})}function parse_fontScheme(){}function parse_fmtScheme(){}var clrsregex=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,fntsregex=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,fmtsregex=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function parse_themeElements(n,r,_){r.themeElements={};var E;[["clrScheme",clrsregex,parse_clrScheme],["fontScheme",fntsregex,parse_fontScheme],["fmtScheme",fmtsregex,parse_fmtScheme]].forEach(function(S){if(!(E=n.match(S[1])))throw new Error(S[0]+" not found in themeElements");S[2](E,r,_)})}var themeltregex=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function parse_theme_xml(n,r){(!n||n.length===0)&&(n=write_theme());var _,E={};if(!(_=n.match(themeltregex)))throw new Error("themeElements not found in theme");return parse_themeElements(_[0],E,r),E.raw=n,E}function write_theme(n,r){if(r&&r.themeXLSX)return r.themeXLSX;if(n&&typeof n.raw=="string")return n.raw;var _=[XML_HEADER];return _[_.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',_[_.length]="<a:themeElements>",_[_.length]='<a:clrScheme name="Office">',_[_.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',_[_.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',_[_.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',_[_.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',_[_.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',_[_.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',_[_.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',_[_.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',_[_.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',_[_.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',_[_.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',_[_.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',_[_.length]="</a:clrScheme>",_[_.length]='<a:fontScheme name="Office">',_[_.length]="<a:majorFont>",_[_.length]='<a:latin typeface="Cambria"/>',_[_.length]='<a:ea typeface=""/>',_[_.length]='<a:cs typeface=""/>',_[_.length]='<a:font script="Jpan" typeface=" "/>',_[_.length]='<a:font script="Hang" typeface=" "/>',_[_.length]='<a:font script="Hans" typeface=""/>',_[_.length]='<a:font script="Hant" typeface=""/>',_[_.length]='<a:font script="Arab" typeface="Times New Roman"/>',_[_.length]='<a:font script="Hebr" typeface="Times New Roman"/>',_[_.length]='<a:font script="Thai" typeface="Tahoma"/>',_[_.length]='<a:font script="Ethi" typeface="Nyala"/>',_[_.length]='<a:font script="Beng" typeface="Vrinda"/>',_[_.length]='<a:font script="Gujr" typeface="Shruti"/>',_[_.length]='<a:font script="Khmr" typeface="MoolBoran"/>',_[_.length]='<a:font script="Knda" typeface="Tunga"/>',_[_.length]='<a:font script="Guru" typeface="Raavi"/>',_[_.length]='<a:font script="Cans" typeface="Euphemia"/>',_[_.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',_[_.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',_[_.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',_[_.length]='<a:font script="Thaa" typeface="MV Boli"/>',_[_.length]='<a:font script="Deva" typeface="Mangal"/>',_[_.length]='<a:font script="Telu" typeface="Gautami"/>',_[_.length]='<a:font script="Taml" typeface="Latha"/>',_[_.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',_[_.length]='<a:font script="Orya" typeface="Kalinga"/>',_[_.length]='<a:font script="Mlym" typeface="Kartika"/>',_[_.length]='<a:font script="Laoo" typeface="DokChampa"/>',_[_.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',_[_.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',_[_.length]='<a:font script="Viet" typeface="Times New Roman"/>',_[_.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',_[_.length]='<a:font script="Geor" typeface="Sylfaen"/>',_[_.length]="</a:majorFont>",_[_.length]="<a:minorFont>",_[_.length]='<a:latin typeface="Calibri"/>',_[_.length]='<a:ea typeface=""/>',_[_.length]='<a:cs typeface=""/>',_[_.length]='<a:font script="Jpan" typeface=" "/>',_[_.length]='<a:font script="Hang" typeface=" "/>',_[_.length]='<a:font script="Hans" typeface=""/>',_[_.length]='<a:font script="Hant" typeface=""/>',_[_.length]='<a:font script="Arab" typeface="Arial"/>',_[_.length]='<a:font script="Hebr" typeface="Arial"/>',_[_.length]='<a:font script="Thai" typeface="Tahoma"/>',_[_.length]='<a:font script="Ethi" typeface="Nyala"/>',_[_.length]='<a:font script="Beng" typeface="Vrinda"/>',_[_.length]='<a:font script="Gujr" typeface="Shruti"/>',_[_.length]='<a:font script="Khmr" typeface="DaunPenh"/>',_[_.length]='<a:font script="Knda" typeface="Tunga"/>',_[_.length]='<a:font script="Guru" typeface="Raavi"/>',_[_.length]='<a:font script="Cans" typeface="Euphemia"/>',_[_.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',_[_.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',_[_.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',_[_.length]='<a:font script="Thaa" typeface="MV Boli"/>',_[_.length]='<a:font script="Deva" typeface="Mangal"/>',_[_.length]='<a:font script="Telu" typeface="Gautami"/>',_[_.length]='<a:font script="Taml" typeface="Latha"/>',_[_.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',_[_.length]='<a:font script="Orya" typeface="Kalinga"/>',_[_.length]='<a:font script="Mlym" typeface="Kartika"/>',_[_.length]='<a:font script="Laoo" typeface="DokChampa"/>',_[_.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',_[_.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',_[_.length]='<a:font script="Viet" typeface="Arial"/>',_[_.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',_[_.length]='<a:font script="Geor" typeface="Sylfaen"/>',_[_.length]="</a:minorFont>",_[_.length]="</a:fontScheme>",_[_.length]='<a:fmtScheme name="Office">',_[_.length]="<a:fillStyleLst>",_[_.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',_[_.length]='<a:gradFill rotWithShape="1">',_[_.length]="<a:gsLst>",_[_.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',_[_.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',_[_.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',_[_.length]="</a:gsLst>",_[_.length]='<a:lin ang="16200000" scaled="1"/>',_[_.length]="</a:gradFill>",_[_.length]='<a:gradFill rotWithShape="1">',_[_.length]="<a:gsLst>",_[_.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',_[_.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',_[_.length]="</a:gsLst>",_[_.length]='<a:lin ang="16200000" scaled="0"/>',_[_.length]="</a:gradFill>",_[_.length]="</a:fillStyleLst>",_[_.length]="<a:lnStyleLst>",_[_.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',_[_.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',_[_.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',_[_.length]="</a:lnStyleLst>",_[_.length]="<a:effectStyleLst>",_[_.length]="<a:effectStyle>",_[_.length]="<a:effectLst>",_[_.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',_[_.length]="</a:effectLst>",_[_.length]="</a:effectStyle>",_[_.length]="<a:effectStyle>",_[_.length]="<a:effectLst>",_[_.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',_[_.length]="</a:effectLst>",_[_.length]="</a:effectStyle>",_[_.length]="<a:effectStyle>",_[_.length]="<a:effectLst>",_[_.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',_[_.length]="</a:effectLst>",_[_.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',_[_.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',_[_.length]="</a:effectStyle>",_[_.length]="</a:effectStyleLst>",_[_.length]="<a:bgFillStyleLst>",_[_.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',_[_.length]='<a:gradFill rotWithShape="1">',_[_.length]="<a:gsLst>",_[_.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',_[_.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',_[_.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',_[_.length]="</a:gsLst>",_[_.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',_[_.length]="</a:gradFill>",_[_.length]='<a:gradFill rotWithShape="1">',_[_.length]="<a:gsLst>",_[_.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',_[_.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',_[_.length]="</a:gsLst>",_[_.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',_[_.length]="</a:gradFill>",_[_.length]="</a:bgFillStyleLst>",_[_.length]="</a:fmtScheme>",_[_.length]="</a:themeElements>",_[_.length]="<a:objectDefaults>",_[_.length]="<a:spDef>",_[_.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',_[_.length]="</a:spDef>",_[_.length]="<a:lnDef>",_[_.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',_[_.length]="</a:lnDef>",_[_.length]="</a:objectDefaults>",_[_.length]="<a:extraClrSchemeLst/>",_[_.length]="</a:theme>",_.join("")}function parse_Theme(n,r,_){var E=n.l+r,S=n.read_shift(4);if(S!==124226){if(!_.cellStyles){n.l=E;return}var C=n.slice(n.l);n.l=E;var A;try{A=zip_read(C,{type:"array"})}catch{return}var I=getzipstr(A,"theme/theme/theme1.xml",!0);if(I)return parse_theme_xml(I,_)}}function parse_ColorTheme(n){return n.read_shift(4)}function parse_FullColorExt(n){var r={};switch(r.xclrType=n.read_shift(2),r.nTintShade=n.read_shift(2),r.xclrType){case 0:n.l+=4;break;case 1:r.xclrValue=parse_IcvXF(n,4);break;case 2:r.xclrValue=parse_LongRGBA(n);break;case 3:r.xclrValue=parse_ColorTheme(n);break;case 4:n.l+=4;break}return n.l+=8,r}function parse_IcvXF(n,r){return parsenoop(n,r)}function parse_XFExtGradient(n,r){return parsenoop(n,r)}function parse_ExtProp(n){var r=n.read_shift(2),_=n.read_shift(2)-4,E=[r];switch(r){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:E[1]=parse_FullColorExt(n);break;case 6:E[1]=parse_XFExtGradient(n,_);break;case 14:case 15:E[1]=n.read_shift(_===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+r+" "+_)}return E}function parse_XFExt(n,r){var _=n.l+r;n.l+=2;var E=n.read_shift(2);n.l+=2;for(var S=n.read_shift(2),C=[];S-- >0;)C.push(parse_ExtProp(n,_-n.l));return{ixfe:E,ext:C}}function update_xfext(n,r){r.forEach(function(_){switch(_[0]){}})}function parse_BrtMdtinfo(n,r){return{flags:n.read_shift(4),version:n.read_shift(4),name:parse_XLWideString(n)}}function write_BrtMdtinfo(n){var r=new_buf(12+2*n.name.length);return r.write_shift(4,n.flags),r.write_shift(4,n.version),write_XLWideString(n.name,r),r.slice(0,r.l)}function parse_BrtMdb(n){for(var r=[],_=n.read_shift(4);_-- >0;)r.push([n.read_shift(4),n.read_shift(4)]);return r}function write_BrtMdb(n){var r=new_buf(4+8*n.length);r.write_shift(4,n.length);for(var _=0;_<n.length;++_)r.write_shift(4,n[_][0]),r.write_shift(4,n[_][1]);return r}function write_BrtBeginEsfmd(n,r){var _=new_buf(8+2*r.length);return _.write_shift(4,n),write_XLWideString(r,_),_.slice(0,_.l)}function parse_BrtBeginEsmdb(n){return n.l+=4,n.read_shift(4)!=0}function write_BrtBeginEsmdb(n,r){var _=new_buf(8);return _.write_shift(4,n),_.write_shift(4,r?1:0),_}function parse_xlmeta_bin(n,r,_){var E={Types:[],Cell:[],Value:[]},S=_||{},C=[],A=!1,I=2;return recordhopper(n,function(B,O,N){switch(N){case 335:E.Types.push({name:B.name});break;case 51:B.forEach(function(U){I==1?E.Cell.push({type:E.Types[U[0]-1].name,index:U[1]}):I==0&&E.Value.push({type:E.Types[U[0]-1].name,index:U[1]})});break;case 337:I=B?1:0;break;case 338:I=2;break;case 35:C.push(N),A=!0;break;case 36:C.pop(),A=!1;break;default:if(!O.T){if(!A||S.WTF&&C[C.length-1]!=35)throw new Error("Unexpected record 0x"+N.toString(16))}}}),E}function write_xlmeta_bin(){var n=buf_array();return write_record(n,332),write_record(n,334,write_UInt32LE(1)),write_record(n,335,write_BrtMdtinfo({name:"XLDAPR",version:12e4,flags:3496657072})),write_record(n,336),write_record(n,339,write_BrtBeginEsfmd(1,"XLDAPR")),write_record(n,52),write_record(n,35,write_UInt32LE(514)),write_record(n,4096,write_UInt32LE(0)),write_record(n,4097,writeuint16(1)),write_record(n,36),write_record(n,53),write_record(n,340),write_record(n,337,write_BrtBeginEsmdb(1,!0)),write_record(n,51,write_BrtMdb([[1,0]])),write_record(n,338),write_record(n,333),n.end()}function parse_xlmeta_xml(n,r,_){var E={Types:[],Cell:[],Value:[]};if(!n)return E;var S=!1,C=2,A;return n.replace(tagregex,function(I){var B=parsexmltag(I);switch(strip_ns(B[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":E.Types.push({name:B.name});break;case"</metadataType>":break;case"<futureMetadata":for(var O=0;O<E.Types.length;++O)E.Types[O].name==B.name&&(A=E.Types[O]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":C==1?E.Cell.push({type:E.Types[B.t-1].name,index:+B.v}):C==0&&E.Value.push({type:E.Types[B.t-1].name,index:+B.v});break;case"</rc>":break;case"<cellMetadata":C=1;break;case"</cellMetadata>":C=2;break;case"<valueMetadata":C=0;break;case"</valueMetadata>":C=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":S=!0;break;case"</ext>":S=!1;break;case"<rvb":if(!A)break;A.offsets||(A.offsets=[]),A.offsets.push(+B.i);break;default:if(!S&&_?.WTF)throw new Error("unrecognized "+B[0]+" in metadata")}return I}),E}function write_xlmeta_xml(){var n=[XML_HEADER];return n.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),n.join("")}function parse_cc_xml(n){var r=[];if(!n)return r;var _=1;return(n.match(tagregex)||[]).forEach(function(E){var S=parsexmltag(E);switch(S[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete S[0],S.i?_=S.i:S.i=_,r.push(S);break}}),r}function parse_BrtCalcChainItem$(n){var r={};r.i=n.read_shift(4);var _={};_.r=n.read_shift(4),_.c=n.read_shift(4),r.r=encode_cell(_);var E=n.read_shift(1);return E&2&&(r.l="1"),E&8&&(r.a="1"),r}function parse_cc_bin(n,r,_){var E=[];return recordhopper(n,function(C,A,I){switch(I){case 63:E.push(C);break;default:if(!A.T)throw new Error("Unexpected record 0x"+I.toString(16))}}),E}function parse_xlink_xml(){}function parse_xlink_bin(n,r,_,E){if(!n)return n;var S=E||{},C=!1;recordhopper(n,function(I,B,O){switch(O){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:C=!0;break;case 36:C=!1;break;default:if(!B.T){if(!C||S.WTF)throw new Error("Unexpected record 0x"+O.toString(16))}}},S)}function parse_drawing(n,r){if(!n)return"??";var _=(n.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return r["!id"][_].Target}function write_vml(n,r){var _=[21600,21600],E=["m0,0l0",_[1],_[0],_[1],_[0],"0xe"].join(","),S=[writextag("xml",null,{"xmlns:v":XLMLNS.v,"xmlns:o":XLMLNS.o,"xmlns:x":XLMLNS.x,"xmlns:mv":XLMLNS.mv}).replace(/\/>/,">"),writextag("o:shapelayout",writextag("o:idmap",null,{"v:ext":"edit",data:n}),{"v:ext":"edit"})],C=65536*n,A=r||[];return A.length>0&&S.push(writextag("v:shapetype",[writextag("v:stroke",null,{joinstyle:"miter"}),writextag("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202",coordsize:_.join(","),"o:spt":202,path:E})),A.forEach(function(I){++C,S.push(write_vml_comment(I,C))}),S.push("</xml>"),S.join("")}function write_vml_comment(n,r){var _=decode_cell(n[0]),E={color2:"#BEFF82",type:"gradient"};E.type=="gradient"&&(E.angle="-180");var S=E.type=="gradient"?writextag("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,C=writextag("v:fill",S,E),A={on:"t",obscured:"t"};return["<v:shape"+wxt_helper({id:"_x0000_s"+r,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(n[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",C,writextag("v:shadow",null,A),writextag("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",writetag("x:Anchor",[_.c+1,0,_.r+1,0,_.c+3,20,_.r+5,20].join(",")),writetag("x:AutoFill","False"),writetag("x:Row",String(_.r)),writetag("x:Column",String(_.c)),n[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"].join("")}function sheet_insert_comments(n,r,_,E){var S=n["!data"]!=null,C;r.forEach(function(A){var I=decode_cell(A.ref);if(S?(n["!data"][I.r]||(n["!data"][I.r]=[]),C=n["!data"][I.r][I.c]):C=n[A.ref],!C){C={t:"z"},S?n["!data"][I.r][I.c]=C:n[A.ref]=C;var B=safe_decode_range(n["!ref"]||"BDWGO1000001:A1");B.s.r>I.r&&(B.s.r=I.r),B.e.r<I.r&&(B.e.r=I.r),B.s.c>I.c&&(B.s.c=I.c),B.e.c<I.c&&(B.e.c=I.c);var O=encode_range(B);n["!ref"]=O}C.c||(C.c=[]);var N={a:A.author,t:A.t,r:A.r,T:_};A.h&&(N.h=A.h);for(var U=C.c.length-1;U>=0;--U){if(!_&&C.c[U].T)return;_&&!C.c[U].T&&C.c.splice(U,1)}if(_&&E){for(U=0;U<E.length;++U)if(N.a==E[U].id){N.a=E[U].name||N.a;break}}C.c.push(N)})}function parse_comments_xml(n,r){if(n.match(/<(?:\w+:)?comments *\/>/))return[];var _=[],E=[],S=n.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);S&&S[1]&&S[1].split(/<\/\w*:?author>/).forEach(function(A){if(!(A===""||A.trim()==="")){var I=A.match(/<(?:\w+:)?author[^>]*>(.*)/);I&&_.push(I[1])}});var C=n.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return C&&C[1]&&C[1].split(/<\/\w*:?comment>/).forEach(function(A){if(!(A===""||A.trim()==="")){var I=A.match(/<(?:\w+:)?comment[^>]*>/);if(I){var B=parsexmltag(I[0]),O={author:B.authorId&&_[B.authorId]||"sheetjsghost",ref:B.ref,guid:B.guid},N=decode_cell(B.ref);if(!(r.sheetRows&&r.sheetRows<=N.r)){var U=A.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),j=!!U&&!!U[1]&&parse_si(U[1])||{r:"",t:"",h:""};O.r=j.r,j.r=="<t></t>"&&(j.t=j.h=""),O.t=(j.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),r.cellHTML&&(O.h=j.h),E.push(O)}}}}),E}function write_comments_xml(n){var r=[XML_HEADER,writextag("comments",null,{xmlns:XMLNS_main[0]})],_=[];return r.push("<authors>"),n.forEach(function(E){E[1].forEach(function(S){var C=escapexml(S.a);_.indexOf(C)==-1&&(_.push(C),r.push("<author>"+C+"</author>")),S.T&&S.ID&&_.indexOf("tc="+S.ID)==-1&&(_.push("tc="+S.ID),r.push("<author>tc="+S.ID+"</author>"))})}),_.length==0&&(_.push("SheetJ5"),r.push("<author>SheetJ5</author>")),r.push("</authors>"),r.push("<commentList>"),n.forEach(function(E){var S=0,C=[],A=0;if(E[1][0]&&E[1][0].T&&E[1][0].ID&&(S=_.indexOf("tc="+E[1][0].ID)),E[1].forEach(function(O){O.a&&(S=_.indexOf(escapexml(O.a))),O.T&&++A,C.push(O.t==null?"":escapexml(O.t))}),A===0)E[1].forEach(function(O){r.push('<comment ref="'+E[0]+'" authorId="'+_.indexOf(escapexml(O.a))+'"><text>'),r.push(writetag("t",O.t==null?"":escapexml(O.t))),r.push("</text></comment>")});else{r.push('<comment ref="'+E[0]+'" authorId="'+S+'"><text>');for(var I=`Comment:
    `+C[0]+`
`,B=1;B<C.length;++B)I+=`Reply:
    `+C[B]+`
`;r.push(writetag("t",escapexml(I))),r.push("</text></comment>")}}),r.push("</commentList>"),r.length>2&&(r[r.length]="</comments>",r[1]=r[1].replace("/>",">")),r.join("")}function parse_tcmnt_xml(n,r){var _=[],E=!1,S={},C=0;return n.replace(tagregex,function(I,B){var O=parsexmltag(I);switch(strip_ns(O[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":S={author:O.personId,guid:O.id,ref:O.ref,T:1};break;case"</threadedComment>":S.t!=null&&_.push(S);break;case"<text>":case"<text":C=B+I.length;break;case"</text>":S.t=n.slice(C,B).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":E=!0;break;case"</mentions>":E=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":E=!0;break;case"</ext>":E=!1;break;default:if(!E&&r.WTF)throw new Error("unrecognized "+O[0]+" in threaded comments")}return I}),_}function write_tcmnt_xml(n,r,_){var E=[XML_HEADER,writextag("ThreadedComments",null,{xmlns:XMLNS.TCMNT}).replace(/[\/]>/,">")];return n.forEach(function(S){var C="";(S[1]||[]).forEach(function(A,I){if(!A.T){delete A.ID;return}A.a&&r.indexOf(A.a)==-1&&r.push(A.a);var B={ref:S[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+_.tcid++).slice(-12)+"}"};I==0?C=B.id:B.parentId=C,A.ID=B.id,A.a&&(B.personId="{54EE7950-7262-4200-6969-"+("000000000000"+r.indexOf(A.a)).slice(-12)+"}"),E.push(writextag("threadedComment",writetag("text",A.t||""),B))})}),E.push("</ThreadedComments>"),E.join("")}function parse_people_xml(n,r){var _=[],E=!1;return n.replace(tagregex,function(C){var A=parsexmltag(C);switch(strip_ns(A[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":_.push({name:A.displayname,id:A.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":E=!0;break;case"</ext>":E=!1;break;default:if(!E&&r.WTF)throw new Error("unrecognized "+A[0]+" in threaded comments")}return C}),_}function write_people_xml(n){var r=[XML_HEADER,writextag("personList",null,{xmlns:XMLNS.TCMNT,"xmlns:x":XMLNS_main[0]}).replace(/[\/]>/,">")];return n.forEach(function(_,E){r.push(writextag("person",null,{displayName:_,id:"{54EE7950-7262-4200-6969-"+("000000000000"+E).slice(-12)+"}",userId:_,providerId:"None"}))}),r.push("</personList>"),r.join("")}function parse_BrtBeginComment(n){var r={};r.iauthor=n.read_shift(4);var _=parse_UncheckedRfX(n);return r.rfx=_.s,r.ref=encode_cell(_.s),n.l+=16,r}function write_BrtBeginComment(n,r){return r==null&&(r=new_buf(36)),r.write_shift(4,n[1].iauthor),write_UncheckedRfX(n[0],r),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r}var parse_BrtCommentAuthor=parse_XLWideString;function write_BrtCommentAuthor(n){return write_XLWideString(n.slice(0,54))}function parse_comments_bin(n,r){var _=[],E=[],S={},C=!1;return recordhopper(n,function(I,B,O){switch(O){case 632:E.push(I);break;case 635:S=I;break;case 637:S.t=I.t,S.h=I.h,S.r=I.r;break;case 636:if(S.author=E[S.iauthor],delete S.iauthor,r.sheetRows&&S.rfx&&r.sheetRows<=S.rfx.r)break;S.t||(S.t=""),delete S.rfx,_.push(S);break;case 3072:break;case 35:C=!0;break;case 36:C=!1;break;case 37:break;case 38:break;default:if(!B.T){if(!C||r.WTF)throw new Error("Unexpected record 0x"+O.toString(16))}}}),_}function write_comments_bin(n){var r=buf_array(),_=[];return write_record(r,628),write_record(r,630),n.forEach(function(E){E[1].forEach(function(S){_.indexOf(S.a)>-1||(_.push(S.a.slice(0,54)),write_record(r,632,write_BrtCommentAuthor(S.a)))})}),write_record(r,631),write_record(r,633),n.forEach(function(E){E[1].forEach(function(S){S.iauthor=_.indexOf(S.a);var C={s:decode_cell(E[0]),e:decode_cell(E[0])};write_record(r,635,write_BrtBeginComment([C,S])),S.t&&S.t.length>0&&write_record(r,637,write_BrtCommentText(S)),write_record(r,636),delete S.iauthor})}),write_record(r,634),write_record(r,629),r.end()}var CT_VBA="application/vnd.ms-office.vbaProject";function make_vba_xls(n){var r=CFB.utils.cfb_new({root:"R"});return n.FullPaths.forEach(function(_,E){if(!(_.slice(-1)==="/"||!_.match(/_VBA_PROJECT_CUR/))){var S=_.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");CFB.utils.cfb_add(r,S,n.FileIndex[E].content)}}),CFB.write(r)}function fill_vba_xls(n,r){r.FullPaths.forEach(function(_,E){if(E!=0){var S=_.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");S.slice(-1)!=="/"&&CFB.utils.cfb_add(n,S,r.FileIndex[E].content)}})}var VBAFMTS=["xlsb","xlsm","xlam","biff8","xla"];function parse_ds_bin(){return{"!type":"dialog"}}function parse_ds_xml(){return{"!type":"dialog"}}function parse_ms_bin(){return{"!type":"macro"}}function parse_ms_xml(){return{"!type":"macro"}}var rc_to_a1=function(){var n=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,r={r:0,c:0};function _(E,S,C,A){var I=!1,B=!1;C.length==0?B=!0:C.charAt(0)=="["&&(B=!0,C=C.slice(1,-1)),A.length==0?I=!0:A.charAt(0)=="["&&(I=!0,A=A.slice(1,-1));var O=C.length>0?parseInt(C,10)|0:0,N=A.length>0?parseInt(A,10)|0:0;return I?N+=r.c:--N,B?O+=r.r:--O,S+(I?"":"$")+encode_col(N)+(B?"":"$")+encode_row(O)}return function(S,C){return r=C,S.replace(n,_)}}(),crefregex=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,a1_to_rc=function(){return function(r,_){return r.replace(crefregex,function(E,S,C,A,I,B){var O=decode_col(A)-(C?0:_.c),N=decode_row(B)-(I?0:_.r),U=I=="$"?N+1:N==0?"":"["+N+"]",j=C=="$"?O+1:O==0?"":"["+O+"]";return S+"R"+U+"C"+j})}}();function shift_formula_str(n,r){return n.replace(crefregex,function(_,E,S,C,A,I){return E+(S=="$"?S+C:encode_col(decode_col(C)+r.c))+(A=="$"?A+I:encode_row(decode_row(I)+r.r))})}function shift_formula_xlsx(n,r,_){var E=decode_range(r),S=E.s,C=decode_cell(_),A={r:C.r-S.r,c:C.c-S.c};return shift_formula_str(n,A)}function fuzzyfmla(n){return n.length!=1}function _xlfn(n){return n.replace(/_xlfn\./g,"")}function parseread1(n){n.l+=1}function parse_ColRelU(n,r){var _=n.read_shift(r==1?1:2);return[_&16383,_>>14&1,_>>15&1]}function parse_RgceArea(n,r,_){var E=2;if(_){if(_.biff>=2&&_.biff<=5)return parse_RgceArea_BIFF2(n);_.biff==12&&(E=4)}var S=n.read_shift(E),C=n.read_shift(E),A=parse_ColRelU(n,2),I=parse_ColRelU(n,2);return{s:{r:S,c:A[0],cRel:A[1],rRel:A[2]},e:{r:C,c:I[0],cRel:I[1],rRel:I[2]}}}function parse_RgceArea_BIFF2(n){var r=parse_ColRelU(n,2),_=parse_ColRelU(n,2),E=n.read_shift(1),S=n.read_shift(1);return{s:{r:r[0],c:E,cRel:r[1],rRel:r[2]},e:{r:_[0],c:S,cRel:_[1],rRel:_[2]}}}function parse_RgceAreaRel(n,r,_){if(_.biff<8)return parse_RgceArea_BIFF2(n);var E=n.read_shift(_.biff==12?4:2),S=n.read_shift(_.biff==12?4:2),C=parse_ColRelU(n,2),A=parse_ColRelU(n,2);return{s:{r:E,c:C[0],cRel:C[1],rRel:C[2]},e:{r:S,c:A[0],cRel:A[1],rRel:A[2]}}}function parse_RgceLoc(n,r,_){if(_&&_.biff>=2&&_.biff<=5)return parse_RgceLoc_BIFF2(n);var E=n.read_shift(_&&_.biff==12?4:2),S=parse_ColRelU(n,2);return{r:E,c:S[0],cRel:S[1],rRel:S[2]}}function parse_RgceLoc_BIFF2(n){var r=parse_ColRelU(n,2),_=n.read_shift(1);return{r:r[0],c:_,cRel:r[1],rRel:r[2]}}function parse_RgceElfLoc(n){var r=n.read_shift(2),_=n.read_shift(2);return{r,c:_&255,fQuoted:!!(_&16384),cRel:_>>15,rRel:_>>15}}function parse_RgceLocRel(n,r,_){var E=_&&_.biff?_.biff:8;if(E>=2&&E<=5)return parse_RgceLocRel_BIFF2(n);var S=n.read_shift(E>=12?4:2),C=n.read_shift(2),A=(C&16384)>>14,I=(C&32768)>>15;if(C&=16383,I==1)for(;S>524287;)S-=1048576;if(A==1)for(;C>8191;)C=C-16384;return{r:S,c:C,cRel:A,rRel:I}}function parse_RgceLocRel_BIFF2(n){var r=n.read_shift(2),_=n.read_shift(1),E=(r&32768)>>15,S=(r&16384)>>14;return r&=16383,E==1&&r>=8192&&(r=r-16384),S==1&&_>=128&&(_=_-256),{r,c:_,cRel:S,rRel:E}}function parse_PtgArea(n,r,_){var E=(n[n.l++]&96)>>5,S=parse_RgceArea(n,_.biff>=2&&_.biff<=5?6:8,_);return[E,S]}function parse_PtgArea3d(n,r,_){var E=(n[n.l++]&96)>>5,S=n.read_shift(2,"i"),C=8;if(_)switch(_.biff){case 5:n.l+=12,C=6;break;case 12:C=12;break}var A=parse_RgceArea(n,C,_);return[E,S,A]}function parse_PtgAreaErr(n,r,_){var E=(n[n.l++]&96)>>5;return n.l+=_&&_.biff>8?12:_.biff<8?6:8,[E]}function parse_PtgAreaErr3d(n,r,_){var E=(n[n.l++]&96)>>5,S=n.read_shift(2),C=8;if(_)switch(_.biff){case 5:n.l+=12,C=6;break;case 12:C=12;break}return n.l+=C,[E,S]}function parse_PtgAreaN(n,r,_){var E=(n[n.l++]&96)>>5,S=parse_RgceAreaRel(n,r-1,_);return[E,S]}function parse_PtgArray(n,r,_){var E=(n[n.l++]&96)>>5;return n.l+=_.biff==2?6:_.biff==12?14:7,[E]}function parse_PtgAttrBaxcel(n){var r=n[n.l+1]&1,_=1;return n.l+=4,[r,_]}function parse_PtgAttrChoose(n,r,_){n.l+=2;for(var E=n.read_shift(_&&_.biff==2?1:2),S=[],C=0;C<=E;++C)S.push(n.read_shift(_&&_.biff==2?1:2));return S}function parse_PtgAttrGoto(n,r,_){var E=n[n.l+1]&255?1:0;return n.l+=2,[E,n.read_shift(_&&_.biff==2?1:2)]}function parse_PtgAttrIf(n,r,_){var E=n[n.l+1]&255?1:0;return n.l+=2,[E,n.read_shift(_&&_.biff==2?1:2)]}function parse_PtgAttrIfError(n){var r=n[n.l+1]&255?1:0;return n.l+=2,[r,n.read_shift(2)]}function parse_PtgAttrSemi(n,r,_){var E=n[n.l+1]&255?1:0;return n.l+=_&&_.biff==2?3:4,[E]}function parse_PtgAttrSpaceType(n){var r=n.read_shift(1),_=n.read_shift(1);return[r,_]}function parse_PtgAttrSpace(n){return n.read_shift(2),parse_PtgAttrSpaceType(n)}function parse_PtgAttrSpaceSemi(n){return n.read_shift(2),parse_PtgAttrSpaceType(n)}function parse_PtgRef(n,r,_){var E=(n[n.l]&96)>>5;n.l+=1;var S=parse_RgceLoc(n,0,_);return[E,S]}function parse_PtgRefN(n,r,_){var E=(n[n.l]&96)>>5;n.l+=1;var S=parse_RgceLocRel(n,0,_);return[E,S]}function parse_PtgRef3d(n,r,_){var E=(n[n.l]&96)>>5;n.l+=1;var S=n.read_shift(2);_&&_.biff==5&&(n.l+=12);var C=parse_RgceLoc(n,0,_);return[E,S,C]}function parse_PtgFunc(n,r,_){var E=(n[n.l]&96)>>5;n.l+=1;var S=n.read_shift(_&&_.biff<=3?1:2);return[FtabArgc[S],Ftab[S],E]}function parse_PtgFuncVar(n,r,_){var E=n[n.l++],S=n.read_shift(1),C=_&&_.biff<=3?[E==88?-1:0,n.read_shift(1)]:parsetab(n);return[S,(C[0]===0?Ftab:Cetab)[C[1]]]}function parsetab(n){return[n[n.l+1]>>7,n.read_shift(2)&32767]}function parse_PtgAttrSum(n,r,_){n.l+=_&&_.biff==2?3:4}function parse_PtgExp(n,r,_){if(n.l++,_&&_.biff==12)return[n.read_shift(4,"i"),0];var E=n.read_shift(2),S=n.read_shift(_&&_.biff==2?1:2);return[E,S]}function parse_PtgErr(n){return n.l++,BErr[n.read_shift(1)]}function parse_PtgInt(n){return n.l++,n.read_shift(2)}function parse_PtgBool(n){return n.l++,n.read_shift(1)!==0}function parse_PtgNum(n){return n.l++,parse_Xnum(n)}function parse_PtgStr(n,r,_){return n.l++,parse_ShortXLUnicodeString(n,r-1,_)}function parse_SerAr(n,r){var _=[n.read_shift(1)];if(r==12)switch(_[0]){case 2:_[0]=4;break;case 4:_[0]=16;break;case 0:_[0]=1;break;case 1:_[0]=2;break}switch(_[0]){case 4:_[1]=parsebool(n,1)?"TRUE":"FALSE",r!=12&&(n.l+=7);break;case 37:case 16:_[1]=BErr[n[n.l]],n.l+=r==12?4:8;break;case 0:n.l+=8;break;case 1:_[1]=parse_Xnum(n);break;case 2:_[1]=parse_XLUnicodeString2(n,0,{biff:r>0&&r<8?2:r});break;default:throw new Error("Bad SerAr: "+_[0])}return _}function parse_PtgExtraMem(n,r,_){for(var E=n.read_shift(_.biff==12?4:2),S=[],C=0;C!=E;++C)S.push((_.biff==12?parse_UncheckedRfX:parse_Ref8U)(n));return S}function parse_PtgExtraArray(n,r,_){var E=0,S=0;_.biff==12?(E=n.read_shift(4),S=n.read_shift(4)):(S=1+n.read_shift(1),E=1+n.read_shift(2)),_.biff>=2&&_.biff<8&&(--E,--S==0&&(S=256));for(var C=0,A=[];C!=E&&(A[C]=[]);++C)for(var I=0;I!=S;++I)A[C][I]=parse_SerAr(n,_.biff);return A}function parse_PtgName(n,r,_){var E=n.read_shift(1)>>>5&3,S=!_||_.biff>=8?4:2,C=n.read_shift(S);switch(_.biff){case 2:n.l+=5;break;case 3:case 4:n.l+=8;break;case 5:n.l+=12;break}return[E,0,C]}function parse_PtgNameX(n,r,_){if(_.biff==5)return parse_PtgNameX_BIFF5(n);var E=n.read_shift(1)>>>5&3,S=n.read_shift(2),C=n.read_shift(4);return[E,S,C]}function parse_PtgNameX_BIFF5(n){var r=n.read_shift(1)>>>5&3,_=n.read_shift(2,"i");n.l+=8;var E=n.read_shift(2);return n.l+=12,[r,_,E]}function parse_PtgMemArea(n,r,_){var E=n.read_shift(1)>>>5&3;n.l+=_&&_.biff==2?3:4;var S=n.read_shift(_&&_.biff==2?1:2);return[E,S]}function parse_PtgMemFunc(n,r,_){var E=n.read_shift(1)>>>5&3,S=n.read_shift(_&&_.biff==2?1:2);return[E,S]}function parse_PtgRefErr(n,r,_){var E=n.read_shift(1)>>>5&3;return n.l+=4,_.biff<8&&n.l--,_.biff==12&&(n.l+=2),[E]}function parse_PtgRefErr3d(n,r,_){var E=(n[n.l++]&96)>>5,S=n.read_shift(2),C=4;if(_)switch(_.biff){case 5:C=15;break;case 12:C=6;break}return n.l+=C,[E,S]}var parse_PtgMemErr=parsenoop,parse_PtgMemNoMem=parsenoop,parse_PtgTbl=parsenoop;function parse_PtgElfLoc(n,r,_){return n.l+=2,[parse_RgceElfLoc(n)]}function parse_PtgElfNoop(n){return n.l+=6,[]}var parse_PtgElfCol=parse_PtgElfLoc,parse_PtgElfColS=parse_PtgElfNoop,parse_PtgElfColSV=parse_PtgElfNoop,parse_PtgElfColV=parse_PtgElfLoc;function parse_PtgElfLel(n){return n.l+=2,[parseuint16(n),n.read_shift(2)&1]}var parse_PtgElfRadical=parse_PtgElfLoc,parse_PtgElfRadicalLel=parse_PtgElfLel,parse_PtgElfRadicalS=parse_PtgElfNoop,parse_PtgElfRw=parse_PtgElfLoc,parse_PtgElfRwV=parse_PtgElfLoc,PtgListRT=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function parse_PtgList(n){n.l+=2;var r=n.read_shift(2),_=n.read_shift(2),E=n.read_shift(4),S=n.read_shift(2),C=n.read_shift(2),A=PtgListRT[_>>2&31];return{ixti:r,coltype:_&3,rt:A,idx:E,c:S,C}}function parse_PtgSxName(n){return n.l+=2,[n.read_shift(4)]}function parse_PtgSheet(n,r,_){return n.l+=5,n.l+=2,n.l+=_.biff==2?1:4,["PTGSHEET"]}function parse_PtgEndSheet(n,r,_){return n.l+=_.biff==2?4:5,["PTGENDSHEET"]}function parse_PtgMemAreaN(n){var r=n.read_shift(1)>>>5&3,_=n.read_shift(2);return[r,_]}function parse_PtgMemNoMemN(n){var r=n.read_shift(1)>>>5&3,_=n.read_shift(2);return[r,_]}function parse_PtgAttrNoop(n){return n.l+=4,[0,0]}var PtgTypes={1:{n:"PtgExp",f:parse_PtgExp},2:{n:"PtgTbl",f:parse_PtgTbl},3:{n:"PtgAdd",f:parseread1},4:{n:"PtgSub",f:parseread1},5:{n:"PtgMul",f:parseread1},6:{n:"PtgDiv",f:parseread1},7:{n:"PtgPower",f:parseread1},8:{n:"PtgConcat",f:parseread1},9:{n:"PtgLt",f:parseread1},10:{n:"PtgLe",f:parseread1},11:{n:"PtgEq",f:parseread1},12:{n:"PtgGe",f:parseread1},13:{n:"PtgGt",f:parseread1},14:{n:"PtgNe",f:parseread1},15:{n:"PtgIsect",f:parseread1},16:{n:"PtgUnion",f:parseread1},17:{n:"PtgRange",f:parseread1},18:{n:"PtgUplus",f:parseread1},19:{n:"PtgUminus",f:parseread1},20:{n:"PtgPercent",f:parseread1},21:{n:"PtgParen",f:parseread1},22:{n:"PtgMissArg",f:parseread1},23:{n:"PtgStr",f:parse_PtgStr},26:{n:"PtgSheet",f:parse_PtgSheet},27:{n:"PtgEndSheet",f:parse_PtgEndSheet},28:{n:"PtgErr",f:parse_PtgErr},29:{n:"PtgBool",f:parse_PtgBool},30:{n:"PtgInt",f:parse_PtgInt},31:{n:"PtgNum",f:parse_PtgNum},32:{n:"PtgArray",f:parse_PtgArray},33:{n:"PtgFunc",f:parse_PtgFunc},34:{n:"PtgFuncVar",f:parse_PtgFuncVar},35:{n:"PtgName",f:parse_PtgName},36:{n:"PtgRef",f:parse_PtgRef},37:{n:"PtgArea",f:parse_PtgArea},38:{n:"PtgMemArea",f:parse_PtgMemArea},39:{n:"PtgMemErr",f:parse_PtgMemErr},40:{n:"PtgMemNoMem",f:parse_PtgMemNoMem},41:{n:"PtgMemFunc",f:parse_PtgMemFunc},42:{n:"PtgRefErr",f:parse_PtgRefErr},43:{n:"PtgAreaErr",f:parse_PtgAreaErr},44:{n:"PtgRefN",f:parse_PtgRefN},45:{n:"PtgAreaN",f:parse_PtgAreaN},46:{n:"PtgMemAreaN",f:parse_PtgMemAreaN},47:{n:"PtgMemNoMemN",f:parse_PtgMemNoMemN},57:{n:"PtgNameX",f:parse_PtgNameX},58:{n:"PtgRef3d",f:parse_PtgRef3d},59:{n:"PtgArea3d",f:parse_PtgArea3d},60:{n:"PtgRefErr3d",f:parse_PtgRefErr3d},61:{n:"PtgAreaErr3d",f:parse_PtgAreaErr3d},255:{}},PtgDupes={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},Ptg18={1:{n:"PtgElfLel",f:parse_PtgElfLel},2:{n:"PtgElfRw",f:parse_PtgElfRw},3:{n:"PtgElfCol",f:parse_PtgElfCol},6:{n:"PtgElfRwV",f:parse_PtgElfRwV},7:{n:"PtgElfColV",f:parse_PtgElfColV},10:{n:"PtgElfRadical",f:parse_PtgElfRadical},11:{n:"PtgElfRadicalS",f:parse_PtgElfRadicalS},13:{n:"PtgElfColS",f:parse_PtgElfColS},15:{n:"PtgElfColSV",f:parse_PtgElfColSV},16:{n:"PtgElfRadicalLel",f:parse_PtgElfRadicalLel},25:{n:"PtgList",f:parse_PtgList},29:{n:"PtgSxName",f:parse_PtgSxName},255:{}},Ptg19={0:{n:"PtgAttrNoop",f:parse_PtgAttrNoop},1:{n:"PtgAttrSemi",f:parse_PtgAttrSemi},2:{n:"PtgAttrIf",f:parse_PtgAttrIf},4:{n:"PtgAttrChoose",f:parse_PtgAttrChoose},8:{n:"PtgAttrGoto",f:parse_PtgAttrGoto},16:{n:"PtgAttrSum",f:parse_PtgAttrSum},32:{n:"PtgAttrBaxcel",f:parse_PtgAttrBaxcel},33:{n:"PtgAttrBaxcel",f:parse_PtgAttrBaxcel},64:{n:"PtgAttrSpace",f:parse_PtgAttrSpace},65:{n:"PtgAttrSpaceSemi",f:parse_PtgAttrSpaceSemi},128:{n:"PtgAttrIfError",f:parse_PtgAttrIfError},255:{}};function parse_RgbExtra(n,r,_,E){if(E.biff<8)return parsenoop(n,r);for(var S=n.l+r,C=[],A=0;A!==_.length;++A)switch(_[A][0]){case"PtgArray":_[A][1]=parse_PtgExtraArray(n,0,E),C.push(_[A][1]);break;case"PtgMemArea":_[A][2]=parse_PtgExtraMem(n,_[A][1],E),C.push(_[A][2]);break;case"PtgExp":E&&E.biff==12&&(_[A][1][1]=n.read_shift(4),C.push(_[A][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+_[A][0]}return r=S-n.l,r!==0&&C.push(parsenoop(n,r)),C}function parse_Rgce(n,r,_){for(var E=n.l+r,S,C,A=[];E!=n.l;)r=E-n.l,C=n[n.l],S=PtgTypes[C]||PtgTypes[PtgDupes[C]],(C===24||C===25)&&(S=(C===24?Ptg18:Ptg19)[n[n.l+1]]),!S||!S.f?parsenoop(n,r):A.push([S.n,S.f(n,r,_)]);return A}function stringify_array(n){for(var r=[],_=0;_<n.length;++_){for(var E=n[_],S=[],C=0;C<E.length;++C){var A=E[C];if(A)switch(A[0]){case 2:S.push('"'+A[1].replace(/"/g,'""')+'"');break;default:S.push(A[1])}else S.push("")}r.push(S.join(","))}return r.join(";")}var PtgBinOp={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function make_3d_range(n,r){var _=n.lastIndexOf("!"),E=r.lastIndexOf("!");return _==-1&&E==-1?n+":"+r:_>0&&E>0&&n.slice(0,_).toLowerCase()==r.slice(0,E).toLowerCase()?n+":"+r.slice(E+1):(console.error("Cannot hydrate range",n,r),n+":"+r)}function get_ixti_raw(n,r,_){if(!n)return"SH33TJSERR0";if(_.biff>8&&(!n.XTI||!n.XTI[r]))return n.SheetNames[r];if(!n.XTI)return"SH33TJSERR6";var E=n.XTI[r];if(_.biff<8)return r>1e4&&(r-=65536),r<0&&(r=-r),r==0?"":n.XTI[r-1];if(!E)return"SH33TJSERR1";var S="";if(_.biff>8)switch(n[E[0]][0]){case 357:return S=E[1]==-1?"#REF":n.SheetNames[E[1]],E[1]==E[2]?S:S+":"+n.SheetNames[E[2]];case 358:return _.SID!=null?n.SheetNames[_.SID]:"SH33TJSSAME"+n[E[0]][0];case 355:default:return"SH33TJSSRC"+n[E[0]][0]}switch(n[E[0]][0][0]){case 1025:return S=E[1]==-1?"#REF":n.SheetNames[E[1]]||"SH33TJSERR3",E[1]==E[2]?S:S+":"+n.SheetNames[E[2]];case 14849:return n[E[0]].slice(1).map(function(C){return C.Name}).join(";;");default:return n[E[0]][0][3]?(S=E[1]==-1?"#REF":n[E[0]][0][3][E[1]]||"SH33TJSERR4",E[1]==E[2]?S:S+":"+n[E[0]][0][3][E[2]]):"SH33TJSERR2"}}function get_ixti(n,r,_){var E=get_ixti_raw(n,r,_);return E=="#REF"?E:formula_quote_sheet_name(E,_)}function stringify_formula(n,r,_,E,S){var C=S&&S.biff||8,A={s:{c:0,r:0},e:{c:0,r:0}},I=[],B,O,N,U=0,j=0,z,Z="";if(!n[0]||!n[0][0])return"";for(var X=-1,Q="",se=0,oe=n[0].length;se<oe;++se){var ue=n[0][se];switch(ue[0]){case"PtgUminus":I.push("-"+I.pop());break;case"PtgUplus":I.push("+"+I.pop());break;case"PtgPercent":I.push(I.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(B=I.pop(),O=I.pop(),X>=0){switch(n[0][X][1][0]){case 0:Q=fill(" ",n[0][X][1][1]);break;case 1:Q=fill("\r",n[0][X][1][1]);break;default:if(Q="",S.WTF)throw new Error("Unexpected PtgAttrSpaceType "+n[0][X][1][0])}O=O+Q,X=-1}I.push(O+PtgBinOp[ue[0]]+B);break;case"PtgIsect":B=I.pop(),O=I.pop(),I.push(O+" "+B);break;case"PtgUnion":B=I.pop(),O=I.pop(),I.push(O+","+B);break;case"PtgRange":B=I.pop(),O=I.pop(),I.push(make_3d_range(O,B));break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":N=shift_cell_xls(ue[1][1],A,S),I.push(encode_cell_xls(N,C));break;case"PtgRefN":N=_?shift_cell_xls(ue[1][1],_,S):ue[1][1],I.push(encode_cell_xls(N,C));break;case"PtgRef3d":U=ue[1][1],N=shift_cell_xls(ue[1][2],A,S),Z=get_ixti(E,U,S),I.push(Z+"!"+encode_cell_xls(N,C));break;case"PtgFunc":case"PtgFuncVar":var we=ue[1][0],Te=ue[1][1];we||(we=0),we&=127;var xe=we==0?[]:I.slice(-we);I.length-=we,Te==="User"&&(Te=xe.shift()),I.push(Te+"("+xe.join(",")+")");break;case"PtgBool":I.push(ue[1]?"TRUE":"FALSE");break;case"PtgInt":I.push(ue[1]);break;case"PtgNum":I.push(String(ue[1]));break;case"PtgStr":I.push('"'+ue[1].replace(/"/g,'""')+'"');break;case"PtgErr":I.push(ue[1]);break;case"PtgAreaN":z=shift_range_xls(ue[1][1],_?{s:_}:A,S),I.push(encode_range_xls(z,S));break;case"PtgArea":z=shift_range_xls(ue[1][1],A,S),I.push(encode_range_xls(z,S));break;case"PtgArea3d":U=ue[1][1],z=ue[1][2],Z=get_ixti(E,U,S),I.push(Z+"!"+encode_range_xls(z,S));break;case"PtgAttrSum":I.push("SUM("+I.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":j=ue[1][2];var Re=(E.names||[])[j-1]||(E[0]||[])[j],Ne=Re?Re.Name:"SH33TJSNAME"+String(j);Ne&&Ne.slice(0,6)=="_xlfn."&&!S.xlfn&&(Ne=Ne.slice(6)),I.push(Ne);break;case"PtgNameX":var Fe=ue[1][1];j=ue[1][2];var ht;if(S.biff<=5)Fe<0&&(Fe=-Fe),E[Fe]&&(ht=E[Fe][j]);else{var nt="";if(((E[Fe]||[])[0]||[])[0]==14849||(((E[Fe]||[])[0]||[])[0]==1025?E[Fe][j]&&E[Fe][j].itab>0&&(nt=E.SheetNames[E[Fe][j].itab-1]+"!"):nt=E.SheetNames[j-1]+"!"),E[Fe]&&E[Fe][j])nt+=E[Fe][j].Name;else if(E[0]&&E[0][j])nt+=E[0][j].Name;else{var Ee=(get_ixti_raw(E,Fe,S)||"").split(";;");Ee[j-1]?nt=Ee[j-1]:nt+="SH33TJSERRX"}I.push(nt);break}ht||(ht={Name:"SH33TJSERRY"}),I.push(ht.Name);break;case"PtgParen":var Ce="(",_e=")";if(X>=0){switch(Q="",n[0][X][1][0]){case 2:Ce=fill(" ",n[0][X][1][1])+Ce;break;case 3:Ce=fill("\r",n[0][X][1][1])+Ce;break;case 4:_e=fill(" ",n[0][X][1][1])+_e;break;case 5:_e=fill("\r",n[0][X][1][1])+_e;break;default:if(S.WTF)throw new Error("Unexpected PtgAttrSpaceType "+n[0][X][1][0])}X=-1}I.push(Ce+I.pop()+_e);break;case"PtgRefErr":I.push("#REF!");break;case"PtgRefErr3d":I.push("#REF!");break;case"PtgExp":N={c:ue[1][1],r:ue[1][0]};var Ie={c:_.c,r:_.r};if(E.sharedf[encode_cell(N)]){var He=E.sharedf[encode_cell(N)];I.push(stringify_formula(He,A,Ie,E,S))}else{var Be=!1;for(B=0;B!=E.arrayf.length;++B)if(O=E.arrayf[B],!(N.c<O[0].s.c||N.c>O[0].e.c)&&!(N.r<O[0].s.r||N.r>O[0].e.r)){I.push(stringify_formula(O[1],A,Ie,E,S)),Be=!0;break}Be||I.push(ue[1])}break;case"PtgArray":I.push("{"+stringify_array(ue[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":X=se;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":I.push("");break;case"PtgAreaErr":I.push("#REF!");break;case"PtgAreaErr3d":I.push("#REF!");break;case"PtgList":I.push("Table"+ue[1].idx+"[#"+ue[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(ue));default:throw new Error("Unrecognized Formula Token: "+String(ue))}var Ge=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(S.biff!=3&&X>=0&&Ge.indexOf(n[0][se][0])==-1){ue=n[0][X];var je=!0;switch(ue[1][0]){case 4:je=!1;case 0:Q=fill(" ",ue[1][1]);break;case 5:je=!1;case 1:Q=fill("\r",ue[1][1]);break;default:if(Q="",S.WTF)throw new Error("Unexpected PtgAttrSpaceType "+ue[1][0])}I.push((je?Q:"")+I.pop()+(je?"":Q)),X=-1}}if(I.length>1&&S.WTF)throw new Error("bad formula stack");return I[0]=="TRUE"?!0:I[0]=="FALSE"?!1:I[0]}function parse_ArrayParsedFormula(n,r,_){var E=n.l+r,S=_.biff==2?1:2,C,A=n.read_shift(S);if(A==65535)return[[],parsenoop(n,r-2)];var I=parse_Rgce(n,A,_);return r!==A+S&&(C=parse_RgbExtra(n,r-A-S,I,_)),n.l=E,[I,C]}function parse_XLSCellParsedFormula(n,r,_){var E=n.l+r,S=_.biff==2?1:2,C,A=n.read_shift(S);if(A==65535)return[[],parsenoop(n,r-2)];var I=parse_Rgce(n,A,_);return r!==A+S&&(C=parse_RgbExtra(n,r-A-S,I,_)),n.l=E,[I,C]}function parse_NameParsedFormula(n,r,_,E){var S=n.l+r,C=parse_Rgce(n,E,_),A;return S!==n.l&&(A=parse_RgbExtra(n,S-n.l,C,_)),[C,A]}function parse_SharedParsedFormula(n,r,_){var E=n.l+r,S,C=n.read_shift(2),A=parse_Rgce(n,C,_);return C==65535?[[],parsenoop(n,r-2)]:(r!==C+2&&(S=parse_RgbExtra(n,E-C-2,A,_)),[A,S])}function parse_FormulaValue(n){var r;if(__readUInt16LE(n,n.l+6)!==65535)return[parse_Xnum(n),"n"];switch(n[n.l]){case 0:return n.l+=8,["String","s"];case 1:return r=n[n.l+2]===1,n.l+=8,[r,"b"];case 2:return r=n[n.l+2],n.l+=8,[r,"e"];case 3:return n.l+=8,["","s"]}return[]}function write_FormulaValue(n){if(n==null){var r=new_buf(8);return r.write_shift(1,3),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,65535),r}else if(typeof n=="number")return write_Xnum(n);return write_Xnum(0)}function parse_Formula(n,r,_){var E=n.l+r,S=parse_XLSCell(n);_.biff==2&&++n.l;var C=parse_FormulaValue(n),A=n.read_shift(1);_.biff!=2&&(n.read_shift(1),_.biff>=5&&n.read_shift(4));var I=parse_XLSCellParsedFormula(n,E-n.l,_);return{cell:S,val:C[0],formula:I,shared:A>>3&1,tt:C[1]}}function write_Formula(n,r,_,E,S){var C=write_XLSCell(r,_,S),A=write_FormulaValue(n.v),I=new_buf(6),B=33;I.write_shift(2,B),I.write_shift(4,0);for(var O=new_buf(n.bf.length),N=0;N<n.bf.length;++N)O[N]=n.bf[N];var U=bconcat([C,A,I,O]);return U}function parse_XLSBParsedFormula(n,r,_){var E=n.read_shift(4),S=parse_Rgce(n,E,_),C=n.read_shift(4),A=C>0?parse_RgbExtra(n,C,S,_):null;return[S,A]}var parse_XLSBArrayParsedFormula=parse_XLSBParsedFormula,parse_XLSBCellParsedFormula=parse_XLSBParsedFormula,parse_XLSBNameParsedFormula=parse_XLSBParsedFormula,parse_XLSBSharedParsedFormula=parse_XLSBParsedFormula;function write_XLSBFormulaNum(n){if((n|0)==n&&n<Math.pow(2,16)&&n>=0){var r=new_buf(11);return r.write_shift(4,3),r.write_shift(1,30),r.write_shift(2,n),r.write_shift(4,0),r}var _=new_buf(17);return _.write_shift(4,11),_.write_shift(1,31),_.write_shift(8,n),_.write_shift(4,0),_}function write_XLSBFormulaErr(n){var r=new_buf(10);return r.write_shift(4,2),r.write_shift(1,28),r.write_shift(1,n),r.write_shift(4,0),r}function write_XLSBFormulaBool(n){var r=new_buf(10);return r.write_shift(4,2),r.write_shift(1,29),r.write_shift(1,n?1:0),r.write_shift(4,0),r}function write_XLSBFormulaStr(n){var r=new_buf(7);r.write_shift(4,3+2*n.length),r.write_shift(1,23),r.write_shift(2,n.length);var _=new_buf(2*n.length);_.write_shift(2*n.length,n,"utf16le");var E=new_buf(4);return E.write_shift(4,0),bconcat([r,_,E])}function write_XLSBFormulaRef(n){var r=decode_cell(n),_=new_buf(15);return _.write_shift(4,7),_.write_shift(1,36),_.write_shift(4,r.r),_.write_shift(2,r.c|(n.charAt(0)=="$"?0:1)<<14|(n.match(/\$\d/)?0:1)<<15),_.write_shift(4,0),_}function write_XLSBFormulaRef3D(n,r){var _=n.lastIndexOf("!"),E=n.slice(0,_);n=n.slice(_+1);var S=decode_cell(n);E.charAt(0)=="'"&&(E=E.slice(1,-1).replace(/''/g,"'"));var C=new_buf(17);return C.write_shift(4,9),C.write_shift(1,58),C.write_shift(2,2+r.SheetNames.map(function(A){return A.toLowerCase()}).indexOf(E.toLowerCase())),C.write_shift(4,S.r),C.write_shift(2,S.c|(n.charAt(0)=="$"?0:1)<<14|(n.match(/\$\d/)?0:1)<<15),C.write_shift(4,0),C}function write_XLSBFormulaRefErr3D(n,r){var _=n.lastIndexOf("!"),E=n.slice(0,_);n=n.slice(_+1),E.charAt(0)=="'"&&(E=E.slice(1,-1).replace(/''/g,"'"));var S=new_buf(17);return S.write_shift(4,9),S.write_shift(1,60),S.write_shift(2,2+r.SheetNames.map(function(C){return C.toLowerCase()}).indexOf(E.toLowerCase())),S.write_shift(4,0),S.write_shift(2,0),S.write_shift(4,0),S}function write_XLSBFormulaRange(n){var r=n.split(":"),_=r[0],E=new_buf(23);E.write_shift(4,15),_=r[0];var S=decode_cell(_);return E.write_shift(1,36),E.write_shift(4,S.r),E.write_shift(2,S.c|(_.charAt(0)=="$"?0:1)<<14|(_.match(/\$\d/)?0:1)<<15),E.write_shift(4,0),_=r[1],S=decode_cell(_),E.write_shift(1,36),E.write_shift(4,S.r),E.write_shift(2,S.c|(_.charAt(0)=="$"?0:1)<<14|(_.match(/\$\d/)?0:1)<<15),E.write_shift(4,0),E.write_shift(1,17),E.write_shift(4,0),E}function write_XLSBFormulaRangeWS(n,r){var _=n.lastIndexOf("!"),E=n.slice(0,_);n=n.slice(_+1),E.charAt(0)=="'"&&(E=E.slice(1,-1).replace(/''/g,"'"));var S=n.split(":");A=S[0];var C=new_buf(27);C.write_shift(4,19);var A=S[0],I=decode_cell(A);return C.write_shift(1,58),C.write_shift(2,2+r.SheetNames.map(function(B){return B.toLowerCase()}).indexOf(E.toLowerCase())),C.write_shift(4,I.r),C.write_shift(2,I.c|(A.charAt(0)=="$"?0:1)<<14|(A.match(/\$\d/)?0:1)<<15),A=S[1],I=decode_cell(A),C.write_shift(1,58),C.write_shift(2,2+r.SheetNames.map(function(B){return B.toLowerCase()}).indexOf(E.toLowerCase())),C.write_shift(4,I.r),C.write_shift(2,I.c|(A.charAt(0)=="$"?0:1)<<14|(A.match(/\$\d/)?0:1)<<15),C.write_shift(1,17),C.write_shift(4,0),C}function write_XLSBFormulaArea3D(n,r){var _=n.lastIndexOf("!"),E=n.slice(0,_);n=n.slice(_+1),E.charAt(0)=="'"&&(E=E.slice(1,-1).replace(/''/g,"'"));var S=decode_range(n),C=new_buf(23);return C.write_shift(4,15),C.write_shift(1,59),C.write_shift(2,2+r.SheetNames.map(function(A){return A.toLowerCase()}).indexOf(E.toLowerCase())),C.write_shift(4,S.s.r),C.write_shift(4,S.e.r),C.write_shift(2,S.s.c),C.write_shift(2,S.e.c),C.write_shift(4,0),C}function write_XLSBFormula(n,r){if(typeof n=="number")return write_XLSBFormulaNum(n);if(typeof n=="boolean")return write_XLSBFormulaBool(n);if(/^#(DIV\/0!|GETTING_DATA|N\/A|NAME\?|NULL!|NUM!|REF!|VALUE!)$/.test(n))return write_XLSBFormulaErr(+RBErr[n]);if(n.match(/^\$?(?:[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D]|[A-Z]{1,2})\$?(?:10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})$/))return write_XLSBFormulaRef(n);if(n.match(/^\$?(?:[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D]|[A-Z]{1,2})\$?(?:10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5}):\$?(?:[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D]|[A-Z]{1,2})\$?(?:10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})$/))return write_XLSBFormulaRange(n);if(n.match(/^#REF!\$?(?:[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D]|[A-Z]{1,2})\$?(?:10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5}):\$?(?:[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D]|[A-Z]{1,2})\$?(?:10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})$/))return write_XLSBFormulaArea3D(n,r);if(n.match(/^(?:'[^\\\/?*\[\]:]*'|[^'][^\\\/?*\[\]:'`~!@#$%^()\-=+{}|;,<.>]*)!\$?(?:[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D]|[A-Z]{1,2})\$?(?:10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})$/))return write_XLSBFormulaRef3D(n,r);if(n.match(/^(?:'[^\\\/?*\[\]:]*'|[^'][^\\\/?*\[\]:'`~!@#$%^()\-=+{}|;,<.>]*)!\$?(?:[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D]|[A-Z]{1,2})\$?(?:10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5}):\$?(?:[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D]|[A-Z]{1,2})\$?(?:10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})$/))return write_XLSBFormulaRangeWS(n,r);if(/^(?:'[^\\\/?*\[\]:]*'|[^'][^\\\/?*\[\]:'`~!@#$%^()\-=+{}|;,<.>]*)!#REF!$/.test(n))return write_XLSBFormulaRefErr3D(n,r);if(/^".*"$/.test(n))return write_XLSBFormulaStr(n);if(/^[+-]\d+$/.test(n))return write_XLSBFormulaNum(parseInt(n,10));throw"Formula |"+n+"| not supported for XLSB"}var write_XLSBNameParsedFormula=write_XLSBFormula,Cetab={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},Ftab={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},FtabArgc={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function ods_to_csf_formula(n){return n.slice(0,3)=="of:"&&(n=n.slice(3)),n.charCodeAt(0)==61&&(n=n.slice(1),n.charCodeAt(0)==61&&(n=n.slice(1))),n=n.replace(/COM\.MICROSOFT\./g,""),n=n.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(r,_){return _.replace(/\./g,"")}),n=n.replace(/\$'([^']|'')+'/g,function(r){return r.slice(1)}),n=n.replace(/\$([^\]\. #$]+)/g,function(r,_){return _.match(/^([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])?(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})?$/)?r:_}),n=n.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),n.replace(/[;~]/g,",").replace(/\|/g,";")}function csf_to_ods_formula(n){var r="of:="+n.replace(crefregex,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return r.replace(/;/g,"|").replace(/,/g,";")}function ods_to_csf_3D(n){n=n.replace(/\$'([^']|'')+'/g,function(E){return E.slice(1)}),n=n.replace(/\$([^\]\. #$]+)/g,function(E,S){return S.match(/^([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])?(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})?$/)?E:S});var r=n.split(":"),_=r[0].split(".")[0];return[_,r[0].split(".")[1]+(r.length>1?":"+(r[1].split(".")[1]||r[1].split(".")[0]):"")]}function csf_to_ods_3D(n){return n.replace(/!/,".")}var strs={},_ssfopts={},browser_has_Map=typeof Map<"u";function get_sst_id(n,r,_){var E=0,S=n.length;if(_){if(browser_has_Map?_.has(r):Object.prototype.hasOwnProperty.call(_,r)){for(var C=browser_has_Map?_.get(r):_[r];E<C.length;++E)if(n[C[E]].t===r)return n.Count++,C[E]}}else for(;E<S;++E)if(n[E].t===r)return n.Count++,E;return n[S]={t:r},n.Count++,n.Unique++,_&&(browser_has_Map?(_.has(r)||_.set(r,[]),_.get(r).push(S)):(Object.prototype.hasOwnProperty.call(_,r)||(_[r]=[]),_[r].push(S))),S}function col_obj_w(n,r){var _={min:n+1,max:n+1},E=-1;return r.MDW&&(MDW=r.MDW),r.width!=null?_.customWidth=1:r.wpx!=null?E=px2char(r.wpx):r.wch!=null&&(E=r.wch),E>-1?(_.width=char2width(E),_.customWidth=1):r.width!=null&&(_.width=r.width),r.hidden&&(_.hidden=!0),r.level!=null&&(_.outlineLevel=_.level=r.level),_}function default_margins(n,r){if(n){var _=[.7,.7,.75,.75,.3,.3];r=="xlml"&&(_=[1,1,1,1,.5,.5]),n.left==null&&(n.left=_[0]),n.right==null&&(n.right=_[1]),n.top==null&&(n.top=_[2]),n.bottom==null&&(n.bottom=_[3]),n.header==null&&(n.header=_[4]),n.footer==null&&(n.footer=_[5])}}function get_cell_style(n,r,_){var E=_.revssf[r.z!=null?r.z:"General"],S=60,C=n.length;if(E==null&&_.ssf){for(;S<392;++S)if(_.ssf[S]==null){SSF__load(r.z,S),_.ssf[S]=r.z,_.revssf[r.z]=E=S;break}}for(S=0;S!=C;++S)if(n[S].numFmtId===E)return S;return n[C]={numFmtId:E,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},C}function safe_format(n,r,_,E,S,C){try{E.cellNF&&(n.z=table_fmt[r])}catch(I){if(E.WTF)throw I}if(!(n.t==="z"&&!E.cellStyles)){if(n.t==="d"&&typeof n.v=="string"&&(n.v=parseDate(n.v)),(!E||E.cellText!==!1)&&n.t!=="z")try{if(table_fmt[r]==null&&SSF__load(SSFImplicit[r]||"General",r),n.t==="e")n.w=n.w||BErr[n.v];else if(r===0)if(n.t==="n")(n.v|0)===n.v?n.w=n.v.toString(10):n.w=SSF_general_num(n.v);else if(n.t==="d"){var A=datenum(n.v);(A|0)===A?n.w=A.toString(10):n.w=SSF_general_num(A)}else{if(n.v===void 0)return"";n.w=SSF_general(n.v,_ssfopts)}else n.t==="d"?n.w=SSF_format(r,datenum(n.v),_ssfopts):n.w=SSF_format(r,n.v,_ssfopts)}catch(I){if(E.WTF)throw I}if(E.cellStyles&&_!=null)try{n.s=C.Fills[_],n.s.fgColor&&n.s.fgColor.theme&&!n.s.fgColor.rgb&&(n.s.fgColor.rgb=rgb_tint(S.themeElements.clrScheme[n.s.fgColor.theme].rgb,n.s.fgColor.tint||0),E.WTF&&(n.s.fgColor.raw_rgb=S.themeElements.clrScheme[n.s.fgColor.theme].rgb)),n.s.bgColor&&n.s.bgColor.theme&&(n.s.bgColor.rgb=rgb_tint(S.themeElements.clrScheme[n.s.bgColor.theme].rgb,n.s.bgColor.tint||0),E.WTF&&(n.s.bgColor.raw_rgb=S.themeElements.clrScheme[n.s.bgColor.theme].rgb))}catch(I){if(E.WTF&&C.Fills)throw I}}}function check_ws(n,r,_){if(n&&n["!ref"]){var E=safe_decode_range(n["!ref"]);if(E.e.c<E.s.c||E.e.r<E.s.r)throw new Error("Bad range ("+_+"): "+n["!ref"])}}function parse_ws_xml_dim(n,r){var _=safe_decode_range(r);_.s.r<=_.e.r&&_.s.c<=_.e.c&&_.s.r>=0&&_.s.c>=0&&(n["!ref"]=encode_range(_))}var mergecregex=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,sheetdataregex=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,hlinkregex=/<(?:\w:)?hyperlink [^>]*>/mg,dimregex=/"(\w*:\w*)"/,colregex=/<(?:\w:)?col\b[^>]*[\/]?>/g,afregex=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,marginregex=/<(?:\w:)?pageMargins[^>]*\/>/g,sheetprregex=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,sheetprregex2=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,svsregex=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function parse_ws_xml(n,r,_,E,S,C,A){if(!n)return n;E||(E={"!id":{}});var I={};r.dense&&(I["!data"]=[]);var B={s:{r:2e6,c:2e6},e:{r:0,c:0}},O="",N="",U=n.match(sheetdataregex);U?(O=n.slice(0,U.index),N=n.slice(U.index+U[0].length)):O=N=n;var j=O.match(sheetprregex);j?parse_ws_xml_sheetpr(j[0],I,S,_):(j=O.match(sheetprregex2))&&parse_ws_xml_sheetpr2(j[0],j[1]||"",I,S,_);var z=(O.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(z>0){var Z=O.slice(z,z+50).match(dimregex);Z&&!(r&&r.nodim)&&parse_ws_xml_dim(I,Z[1])}var X=O.match(svsregex);X&&X[1]&&parse_ws_xml_sheetviews(X[1],S);var Q=[];if(r.cellStyles){var se=O.match(colregex);se&&parse_ws_xml_cols(Q,se)}U&&parse_ws_xml_data(U[1],I,r,B,C,A);var oe=N.match(afregex);oe&&(I["!autofilter"]=parse_ws_xml_autofilter(oe[0]));var ue=[],we=N.match(mergecregex);if(we)for(z=0;z!=we.length;++z)ue[z]=safe_decode_range(we[z].slice(we[z].indexOf('"')+1));var Te=N.match(hlinkregex);Te&&parse_ws_xml_hlinks(I,Te,E);var xe=N.match(marginregex);if(xe&&(I["!margins"]=parse_ws_xml_margins(parsexmltag(xe[0]))),r&&r.nodim&&(B.s.c=B.s.r=0),!I["!ref"]&&B.e.c>=B.s.c&&B.e.r>=B.s.r&&(I["!ref"]=encode_range(B)),r.sheetRows>0&&I["!ref"]){var Re=safe_decode_range(I["!ref"]);r.sheetRows<=+Re.e.r&&(Re.e.r=r.sheetRows-1,Re.e.r>B.e.r&&(Re.e.r=B.e.r),Re.e.r<Re.s.r&&(Re.s.r=Re.e.r),Re.e.c>B.e.c&&(Re.e.c=B.e.c),Re.e.c<Re.s.c&&(Re.s.c=Re.e.c),I["!fullref"]=I["!ref"],I["!ref"]=encode_range(Re))}return Q.length>0&&(I["!cols"]=Q),ue.length>0&&(I["!merges"]=ue),I}function write_ws_xml_merges(n){if(n.length===0)return"";for(var r='<mergeCells count="'+n.length+'">',_=0;_!=n.length;++_)r+='<mergeCell ref="'+encode_range(n[_])+'"/>';return r+"</mergeCells>"}function parse_ws_xml_sheetpr(n,r,_,E){var S=parsexmltag(n);_.Sheets[E]||(_.Sheets[E]={}),S.codeName&&(_.Sheets[E].CodeName=unescapexml(utf8read(S.codeName)))}function parse_ws_xml_sheetpr2(n,r,_,E,S){parse_ws_xml_sheetpr(n.slice(0,n.indexOf(">")),_,E,S)}function write_ws_xml_sheetpr(n,r,_,E,S){var C=!1,A={},I=null;if(E.bookType!=="xlsx"&&r.vbaraw){var B=r.SheetNames[_];try{r.Workbook&&(B=r.Workbook.Sheets[_].CodeName||B)}catch{}C=!0,A.codeName=utf8write(escapexml(B))}if(n&&n["!outline"]){var O={summaryBelow:1,summaryRight:1};n["!outline"].above&&(O.summaryBelow=0),n["!outline"].left&&(O.summaryRight=0),I=(I||"")+writextag("outlinePr",null,O)}!C&&!I||(S[S.length]=writextag("sheetPr",I,A))}var sheetprot_deffalse=["objects","scenarios","selectLockedCells","selectUnlockedCells"],sheetprot_deftrue=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function write_ws_xml_protection(n){var r={sheet:1};return sheetprot_deffalse.forEach(function(_){n[_]!=null&&n[_]&&(r[_]="1")}),sheetprot_deftrue.forEach(function(_){n[_]!=null&&!n[_]&&(r[_]="0")}),n.password&&(r.password=crypto_CreatePasswordVerifier_Method1(n.password).toString(16).toUpperCase()),writextag("sheetProtection",null,r)}function parse_ws_xml_hlinks(n,r,_){for(var E=n["!data"]!=null,S=0;S!=r.length;++S){var C=parsexmltag(utf8read(r[S]),!0);if(!C.ref)return;var A=((_||{})["!id"]||[])[C.id];A?(C.Target=A.Target,C.location&&(C.Target+="#"+unescapexml(C.location))):(C.Target="#"+unescapexml(C.location),A={Target:C.Target,TargetMode:"Internal"}),C.Rel=A,C.tooltip&&(C.Tooltip=C.tooltip,delete C.tooltip);for(var I=safe_decode_range(C.ref),B=I.s.r;B<=I.e.r;++B)for(var O=I.s.c;O<=I.e.c;++O){var N=encode_col(O)+encode_row(B);E?(n["!data"][B]||(n["!data"][B]=[]),n["!data"][B][O]||(n["!data"][B][O]={t:"z",v:void 0}),n["!data"][B][O].l=C):(n[N]||(n[N]={t:"z",v:void 0}),n[N].l=C)}}}function parse_ws_xml_margins(n){var r={};return["left","right","top","bottom","header","footer"].forEach(function(_){n[_]&&(r[_]=parseFloat(n[_]))}),r}function write_ws_xml_margins(n){return default_margins(n),writextag("pageMargins",null,n)}function parse_ws_xml_cols(n,r){for(var _=!1,E=0;E!=r.length;++E){var S=parsexmltag(r[E],!0);S.hidden&&(S.hidden=parsexmlbool(S.hidden));var C=parseInt(S.min,10)-1,A=parseInt(S.max,10)-1;for(S.outlineLevel&&(S.level=+S.outlineLevel||0),delete S.min,delete S.max,S.width=+S.width,!_&&S.width&&(_=!0,find_mdw_colw(S.width)),process_col(S);C<=A;)n[C++]=dup(S)}}function write_ws_xml_cols(n,r){for(var _=["<cols>"],E,S=0;S!=r.length;++S)(E=r[S])&&(_[_.length]=writextag("col",null,col_obj_w(S,E)));return _[_.length]="</cols>",_.join("")}function parse_ws_xml_autofilter(n){var r={ref:(n.match(/ref="([^"]*)"/)||[])[1]};return r}function write_ws_xml_autofilter(n,r,_,E){var S=typeof n.ref=="string"?n.ref:encode_range(n.ref);_.Workbook||(_.Workbook={Sheets:[]}),_.Workbook.Names||(_.Workbook.Names=[]);var C=_.Workbook.Names,A=decode_range(S);A.s.r==A.e.r&&(A.e.r=decode_range(r["!ref"]).e.r,S=encode_range(A));for(var I=0;I<C.length;++I){var B=C[I];if(B.Name=="_xlnm._FilterDatabase"&&B.Sheet==E){B.Ref=formula_quote_sheet_name(_.SheetNames[E])+"!"+fix_range(S);break}}return I==C.length&&C.push({Name:"_xlnm._FilterDatabase",Sheet:E,Ref:"'"+_.SheetNames[E]+"'!"+S}),writextag("autoFilter",null,{ref:S})}var sviewregex=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/g;function parse_ws_xml_sheetviews(n,r){r.Views||(r.Views=[{}]),(n.match(sviewregex)||[]).forEach(function(_,E){var S=parsexmltag(_);r.Views[E]||(r.Views[E]={}),+S.zoomScale&&(r.Views[E].zoom=+S.zoomScale),S.rightToLeft&&parsexmlbool(S.rightToLeft)&&(r.Views[E].RTL=!0)})}function write_ws_xml_sheetviews(n,r,_,E){var S={workbookViewId:"0"};return(((E||{}).Workbook||{}).Views||[])[0]&&(S.rightToLeft=E.Workbook.Views[0].RTL?"1":"0"),writextag("sheetViews",writextag("sheetView",null,S),{})}function write_ws_xml_cell(n,r,_,E){if(n.c&&_["!comments"].push([r,n.c]),(n.v===void 0||n.t==="z"&&!(E||{}).sheetStubs)&&typeof n.f!="string"&&typeof n.z>"u")return"";var S="",C=n.t,A=n.v;if(n.t!=="z")switch(n.t){case"b":S=n.v?"1":"0";break;case"n":S=""+n.v;break;case"e":S=BErr[n.v];break;case"d":E&&E.cellDates?S=parseDate(n.v,-1).toISOString():(n=dup(n),n.t="n",S=""+(n.v=datenum(parseDate(n.v)))),typeof n.z>"u"&&(n.z=table_fmt[14]);break;default:S=n.v;break}var I=n.t=="z"||n.v==null?"":writetag("v",escapexml(S)),B={r},O=get_cell_style(E.cellXfs,n,E);switch(O!==0&&(B.s=O),n.t){case"n":break;case"d":B.t="d";break;case"b":B.t="b";break;case"e":B.t="e";break;case"z":break;default:if(n.v==null){delete n.t;break}if(n.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(E&&E.bookSST){I=writetag("v",""+get_sst_id(E.Strings,n.v,E.revStrings)),B.t="s";break}else B.t="str";break}if(n.t!=C&&(n.t=C,n.v=A),typeof n.f=="string"&&n.f){var N=n.F&&n.F.slice(0,r.length)==r?{t:"array",ref:n.F}:null;I=writextag("f",escapexml(n.f),N)+(n.v!=null?I:"")}return n.l&&(n.l.display=escapexml(S),_["!links"].push([r,n.l])),n.D&&(B.cm=1),writextag("c",I,B)}var parse_ws_xml_data=function(){var n=/<(?:\w+:)?c[ \/>]/,r=/<\/(?:\w+:)?row>/,_=/r=["']([^"']*)["']/,E=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,S=/ref=["']([^"']*)["']/,C=matchtag("v"),A=matchtag("f");return function(B,O,N,U,j,z){for(var Z=0,X="",Q=[],se=[],oe=0,ue=0,we=0,Te="",xe,Re,Ne=0,Fe=0,ht,nt,Ee=0,Ce=0,_e=Array.isArray(z.CellXf),Ie,He=[],Be=[],Ge=O["!data"]!=null,je=[],Ve={},Pe=!1,Me=!!N.sheetStubs,tt=B.split(r),Ke=0,mt=tt.length;Ke!=mt;++Ke){X=tt[Ke].trim();var ct=X.length;if(ct!==0){var Qe=0;e:for(Z=0;Z<ct;++Z)switch(X[Z]){case">":if(X[Z-1]!="/"){++Z;break e}if(N&&N.cellStyles){if(Re=parsexmltag(X.slice(Qe,Z),!0),Ne=Re.r!=null?parseInt(Re.r,10):Ne+1,Fe=-1,N.sheetRows&&N.sheetRows<Ne)continue;Ve={},Pe=!1,Re.ht&&(Pe=!0,Ve.hpt=parseFloat(Re.ht),Ve.hpx=pt2px(Ve.hpt)),Re.hidden&&parsexmlbool(Re.hidden)&&(Pe=!0,Ve.hidden=!0),Re.outlineLevel!=null&&(Pe=!0,Ve.level=+Re.outlineLevel),Pe&&(je[Ne-1]=Ve)}break;case"<":Qe=Z;break}if(Qe>=Z)break;if(Re=parsexmltag(X.slice(Qe,Z),!0),Ne=Re.r!=null?parseInt(Re.r,10):Ne+1,Fe=-1,!(N.sheetRows&&N.sheetRows<Ne)){N.nodim||(U.s.r>Ne-1&&(U.s.r=Ne-1),U.e.r<Ne-1&&(U.e.r=Ne-1)),N&&N.cellStyles&&(Ve={},Pe=!1,Re.ht&&(Pe=!0,Ve.hpt=parseFloat(Re.ht),Ve.hpx=pt2px(Ve.hpt)),Re.hidden&&parsexmlbool(Re.hidden)&&(Pe=!0,Ve.hidden=!0),Re.outlineLevel!=null&&(Pe=!0,Ve.level=+Re.outlineLevel),Pe&&(je[Ne-1]=Ve)),Q=X.slice(Z).split(n);for(var dt=0;dt!=Q.length&&Q[dt].trim().charAt(0)=="<";++dt);for(Q=Q.slice(dt),Z=0;Z!=Q.length;++Z)if(X=Q[Z].trim(),X.length!==0){if(se=X.match(_),oe=Z,ue=0,we=0,X="<c "+(X.slice(0,1)=="<"?">":"")+X,se!=null&&se.length===2){for(oe=0,Te=se[1],ue=0;ue!=Te.length&&!((we=Te.charCodeAt(ue)-64)<1||we>26);++ue)oe=26*oe+we;--oe,Fe=oe}else++Fe;for(ue=0;ue!=X.length&&X.charCodeAt(ue)!==62;++ue);if(++ue,Re=parsexmltag(X.slice(0,ue),!0),Re.r||(Re.r=encode_cell({r:Ne-1,c:Fe})),Te=X.slice(ue),xe={t:""},(se=Te.match(C))!=null&&se[1]!==""&&(xe.v=unescapexml(se[1])),N.cellFormula){if((se=Te.match(A))!=null&&se[1]!==""){if(xe.f=unescapexml(utf8read(se[1]),!0),N.xlfn||(xe.f=_xlfn(xe.f)),se[0].indexOf('t="array"')>-1)xe.F=(Te.match(S)||[])[1],xe.F.indexOf(":")>-1&&He.push([safe_decode_range(xe.F),xe.F]);else if(se[0].indexOf('t="shared"')>-1){nt=parsexmltag(se[0]);var vt=unescapexml(utf8read(se[1]));N.xlfn||(vt=_xlfn(vt)),Be[parseInt(nt.si,10)]=[nt,vt,Re.r]}}else(se=Te.match(/<f[^>]*\/>/))&&(nt=parsexmltag(se[0]),Be[nt.si]&&(xe.f=shift_formula_xlsx(Be[nt.si][1],Be[nt.si][2],Re.r)));var At=decode_cell(Re.r);for(ue=0;ue<He.length;++ue)At.r>=He[ue][0].s.r&&At.r<=He[ue][0].e.r&&At.c>=He[ue][0].s.c&&At.c<=He[ue][0].e.c&&(xe.F=He[ue][1])}if(Re.t==null&&xe.v===void 0)if(xe.f||xe.F)xe.v=0,xe.t="n";else if(Me)xe.t="z";else continue;else xe.t=Re.t||"n";switch(U.s.c>Fe&&(U.s.c=Fe),U.e.c<Fe&&(U.e.c=Fe),xe.t){case"n":if(xe.v==""||xe.v==null){if(!Me)continue;xe.t="z"}else xe.v=parseFloat(xe.v);break;case"s":if(typeof xe.v>"u"){if(!Me)continue;xe.t="z"}else ht=strs[parseInt(xe.v,10)],xe.v=ht.t,xe.r=ht.r,N.cellHTML&&(xe.h=ht.h);break;case"str":xe.t="s",xe.v=xe.v!=null?unescapexml(utf8read(xe.v),!0):"",N.cellHTML&&(xe.h=escapehtml(xe.v));break;case"inlineStr":se=Te.match(E),xe.t="s",se!=null&&(ht=parse_si(se[1]))?(xe.v=ht.t,N.cellHTML&&(xe.h=ht.h)):xe.v="";break;case"b":xe.v=parsexmlbool(xe.v);break;case"d":N.cellDates?xe.v=parseDate(xe.v,1):(xe.v=datenum(parseDate(xe.v,1)),xe.t="n");break;case"e":(!N||N.cellText!==!1)&&(xe.w=xe.v),xe.v=RBErr[xe.v];break}if(Ee=Ce=0,Ie=null,_e&&Re.s!==void 0&&(Ie=z.CellXf[Re.s],Ie!=null&&(Ie.numFmtId!=null&&(Ee=Ie.numFmtId),N.cellStyles&&Ie.fillId!=null&&(Ce=Ie.fillId))),safe_format(xe,Ee,Ce,N,j,z),N.cellDates&&_e&&xe.t=="n"&&fmt_is_date(table_fmt[Ee])&&(xe.t="d",xe.v=numdate(xe.v)),Re.cm&&N.xlmeta){var bt=(N.xlmeta.Cell||[])[+Re.cm-1];bt&&bt.type=="XLDAPR"&&(xe.D=!0)}var ft;N.nodim&&(ft=decode_cell(Re.r),U.s.r>ft.r&&(U.s.r=ft.r),U.e.r<ft.r&&(U.e.r=ft.r)),Ge?(ft=decode_cell(Re.r),O["!data"][ft.r]||(O["!data"][ft.r]=[]),O["!data"][ft.r][ft.c]=xe):O[Re.r]=xe}}}}je.length>0&&(O["!rows"]=je)}}();function write_ws_xml_data(n,r,_,E){var S=[],C=[],A=safe_decode_range(n["!ref"]),I="",B,O="",N=[],U=0,j=0,z=n["!rows"],Z=n["!data"]!=null,X={r:O},Q,se=-1;for(j=A.s.c;j<=A.e.c;++j)N[j]=encode_col(j);for(U=A.s.r;U<=A.e.r;++U){for(C=[],O=encode_row(U),j=A.s.c;j<=A.e.c;++j){B=N[j]+O;var oe=Z?(n["!data"][U]||[])[j]:n[B];oe!==void 0&&(I=write_ws_xml_cell(oe,B,n,r))!=null&&C.push(I)}(C.length>0||z&&z[U])&&(X={r:O},z&&z[U]&&(Q=z[U],Q.hidden&&(X.hidden=1),se=-1,Q.hpx?se=px2pt(Q.hpx):Q.hpt&&(se=Q.hpt),se>-1&&(X.ht=se,X.customHeight=1),Q.level&&(X.outlineLevel=Q.level)),S[S.length]=writextag("row",C.join(""),X))}if(z)for(;U<z.length;++U)z&&z[U]&&(X={r:U+1},Q=z[U],Q.hidden&&(X.hidden=1),se=-1,Q.hpx?se=px2pt(Q.hpx):Q.hpt&&(se=Q.hpt),se>-1&&(X.ht=se,X.customHeight=1),Q.level&&(X.outlineLevel=Q.level),S[S.length]=writextag("row","",X));return S.join("")}function write_ws_xml(n,r,_,E){var S=[XML_HEADER,writextag("worksheet",null,{xmlns:XMLNS_main[0],"xmlns:r":XMLNS.r})],C=_.SheetNames[n],A=0,I="",B=_.Sheets[C];B==null&&(B={});var O=B["!ref"]||"A1",N=safe_decode_range(O);if(N.e.c>16383||N.e.r>1048575){if(r.WTF)throw new Error("Range "+O+" exceeds format limit A1:XFD1048576");N.e.c=Math.min(N.e.c,16383),N.e.r=Math.min(N.e.c,1048575),O=encode_range(N)}E||(E={}),B["!comments"]=[];var U=[];write_ws_xml_sheetpr(B,_,n,r,S),S[S.length]=writextag("dimension",null,{ref:O}),S[S.length]=write_ws_xml_sheetviews(B,r,n,_),r.sheetFormat&&(S[S.length]=writextag("sheetFormatPr",null,{defaultRowHeight:r.sheetFormat.defaultRowHeight||"16",baseColWidth:r.sheetFormat.baseColWidth||"10",outlineLevelRow:r.sheetFormat.outlineLevelRow||"7"})),B["!cols"]!=null&&B["!cols"].length>0&&(S[S.length]=write_ws_xml_cols(B,B["!cols"])),S[A=S.length]="<sheetData/>",B["!links"]=[],B["!ref"]!=null&&(I=write_ws_xml_data(B,r),I.length>0&&(S[S.length]=I)),S.length>A+1&&(S[S.length]="</sheetData>",S[A]=S[A].replace("/>",">")),B["!protect"]&&(S[S.length]=write_ws_xml_protection(B["!protect"])),B["!autofilter"]!=null&&(S[S.length]=write_ws_xml_autofilter(B["!autofilter"],B,_,n)),B["!merges"]!=null&&B["!merges"].length>0&&(S[S.length]=write_ws_xml_merges(B["!merges"]));var j=-1,z,Z=-1;return B["!links"].length>0&&(S[S.length]="<hyperlinks>",B["!links"].forEach(function(X){X[1].Target&&(z={ref:X[0]},X[1].Target.charAt(0)!="#"&&(Z=add_rels(E,-1,escapexml(X[1].Target).replace(/#.*$/,""),RELS.HLINK),z["r:id"]="rId"+Z),(j=X[1].Target.indexOf("#"))>-1&&(z.location=escapexml(X[1].Target.slice(j+1))),X[1].Tooltip&&(z.tooltip=escapexml(X[1].Tooltip)),z.display=X[1].display,S[S.length]=writextag("hyperlink",null,z))}),S[S.length]="</hyperlinks>"),delete B["!links"],B["!margins"]!=null&&(S[S.length]=write_ws_xml_margins(B["!margins"])),(!r||r.ignoreEC||r.ignoreEC==null)&&(S[S.length]=writetag("ignoredErrors",writextag("ignoredError",null,{numberStoredAsText:1,sqref:O}))),U.length>0&&(Z=add_rels(E,-1,"../drawings/drawing"+(n+1)+".xml",RELS.DRAW),S[S.length]=writextag("drawing",null,{"r:id":"rId"+Z}),B["!drawing"]=U),B["!comments"].length>0&&(Z=add_rels(E,-1,"../drawings/vmlDrawing"+(n+1)+".vml",RELS.VML),S[S.length]=writextag("legacyDrawing",null,{"r:id":"rId"+Z}),B["!legacy"]=Z),S.length>1&&(S[S.length]="</worksheet>",S[1]=S[1].replace("/>",">")),S.join("")}function parse_BrtRowHdr(n,r){var _={},E=n.l+r;_.r=n.read_shift(4),n.l+=4;var S=n.read_shift(2);n.l+=1;var C=n.read_shift(1);return n.l=E,C&7&&(_.level=C&7),C&16&&(_.hidden=!0),C&32&&(_.hpt=S/20),_}function write_BrtRowHdr(n,r,_){var E=new_buf(145),S=(_["!rows"]||[])[n]||{};E.write_shift(4,n),E.write_shift(4,0);var C=320;S.hpx?C=px2pt(S.hpx)*20:S.hpt&&(C=S.hpt*20),E.write_shift(2,C),E.write_shift(1,0);var A=0;S.level&&(A|=S.level),S.hidden&&(A|=16),(S.hpx||S.hpt)&&(A|=32),E.write_shift(1,A),E.write_shift(1,0);var I=0,B=E.l;E.l+=4;for(var O={r:n,c:0},N=_["!data"]!=null,U=0;U<16;++U)if(!(r.s.c>U+1<<10||r.e.c<U<<10)){for(var j=-1,z=-1,Z=U<<10;Z<U+1<<10;++Z){O.c=Z;var X=N?(_["!data"][O.r]||[])[O.c]:_[encode_cell(O)];X&&(j<0&&(j=Z),z=Z)}j<0||(++I,E.write_shift(4,j),E.write_shift(4,z))}var Q=E.l;return E.l=B,E.write_shift(4,I),E.l=Q,E.length>E.l?E.slice(0,E.l):E}function write_row_header(n,r,_,E){var S=write_BrtRowHdr(E,_,r);(S.length>17||(r["!rows"]||[])[E])&&write_record(n,0,S)}var parse_BrtWsDim=parse_UncheckedRfX,write_BrtWsDim=write_UncheckedRfX;function parse_BrtWsFmtInfo(){}function parse_BrtWsProp(n,r){var _={},E=n[n.l];return++n.l,_.above=!(E&64),_.left=!(E&128),n.l+=18,_.name=parse_XLSBCodeName(n),_}function write_BrtWsProp(n,r,_){_==null&&(_=new_buf(84+4*n.length));var E=192;r&&(r.above&&(E&=-65),r.left&&(E&=-129)),_.write_shift(1,E);for(var S=1;S<3;++S)_.write_shift(1,0);return write_BrtColor({auto:1},_),_.write_shift(-4,-1),_.write_shift(-4,-1),write_XLSBCodeName(n,_),_.slice(0,_.l)}function parse_BrtCellBlank(n){var r=parse_XLSBCell(n);return[r]}function write_BrtCellBlank(n,r,_){return _==null&&(_=new_buf(8)),write_XLSBCell(r,_)}function parse_BrtShortBlank(n){var r=parse_XLSBShortCell(n);return[r]}function write_BrtShortBlank(n,r,_){return _==null&&(_=new_buf(4)),write_XLSBShortCell(r,_)}function parse_BrtCellBool(n){var r=parse_XLSBCell(n),_=n.read_shift(1);return[r,_,"b"]}function write_BrtCellBool(n,r,_){return _==null&&(_=new_buf(9)),write_XLSBCell(r,_),_.write_shift(1,n.v?1:0),_}function parse_BrtShortBool(n){var r=parse_XLSBShortCell(n),_=n.read_shift(1);return[r,_,"b"]}function write_BrtShortBool(n,r,_){return _==null&&(_=new_buf(5)),write_XLSBShortCell(r,_),_.write_shift(1,n.v?1:0),_}function parse_BrtCellError(n){var r=parse_XLSBCell(n),_=n.read_shift(1);return[r,_,"e"]}function write_BrtCellError(n,r,_){return _==null&&(_=new_buf(9)),write_XLSBCell(r,_),_.write_shift(1,n.v),_}function parse_BrtShortError(n){var r=parse_XLSBShortCell(n),_=n.read_shift(1);return[r,_,"e"]}function write_BrtShortError(n,r,_){return _==null&&(_=new_buf(8)),write_XLSBShortCell(r,_),_.write_shift(1,n.v),_.write_shift(2,0),_.write_shift(1,0),_}function parse_BrtCellIsst(n){var r=parse_XLSBCell(n),_=n.read_shift(4);return[r,_,"s"]}function write_BrtCellIsst(n,r,_){return _==null&&(_=new_buf(12)),write_XLSBCell(r,_),_.write_shift(4,r.v),_}function parse_BrtShortIsst(n){var r=parse_XLSBShortCell(n),_=n.read_shift(4);return[r,_,"s"]}function write_BrtShortIsst(n,r,_){return _==null&&(_=new_buf(8)),write_XLSBShortCell(r,_),_.write_shift(4,r.v),_}function parse_BrtCellReal(n){var r=parse_XLSBCell(n),_=parse_Xnum(n);return[r,_,"n"]}function write_BrtCellReal(n,r,_){return _==null&&(_=new_buf(16)),write_XLSBCell(r,_),write_Xnum(n.v,_),_}function parse_BrtShortReal(n){var r=parse_XLSBShortCell(n),_=parse_Xnum(n);return[r,_,"n"]}function write_BrtShortReal(n,r,_){return _==null&&(_=new_buf(12)),write_XLSBShortCell(r,_),write_Xnum(n.v,_),_}function parse_BrtCellRk(n){var r=parse_XLSBCell(n),_=parse_RkNumber(n);return[r,_,"n"]}function write_BrtCellRk(n,r,_){return _==null&&(_=new_buf(12)),write_XLSBCell(r,_),write_RkNumber(n.v,_),_}function parse_BrtShortRk(n){var r=parse_XLSBShortCell(n),_=parse_RkNumber(n);return[r,_,"n"]}function write_BrtShortRk(n,r,_){return _==null&&(_=new_buf(8)),write_XLSBShortCell(r,_),write_RkNumber(n.v,_),_}function parse_BrtCellRString(n){var r=parse_XLSBCell(n),_=parse_RichStr(n);return[r,_,"is"]}function parse_BrtCellSt(n){var r=parse_XLSBCell(n),_=parse_XLWideString(n);return[r,_,"str"]}function write_BrtCellSt(n,r,_){var E=n.v==null?"":String(n.v);return _==null&&(_=new_buf(12+4*n.v.length)),write_XLSBCell(r,_),write_XLWideString(E,_),_.length>_.l?_.slice(0,_.l):_}function parse_BrtShortSt(n){var r=parse_XLSBShortCell(n),_=parse_XLWideString(n);return[r,_,"str"]}function write_BrtShortSt(n,r,_){var E=n.v==null?"":String(n.v);return _==null&&(_=new_buf(8+4*E.length)),write_XLSBShortCell(r,_),write_XLWideString(E,_),_.length>_.l?_.slice(0,_.l):_}function parse_BrtFmlaBool(n,r,_){var E=n.l+r,S=parse_XLSBCell(n);S.r=_["!row"];var C=n.read_shift(1),A=[S,C,"b"];if(_.cellFormula){n.l+=2;var I=parse_XLSBCellParsedFormula(n,E-n.l,_);A[3]=stringify_formula(I,null,S,_.supbooks,_)}else n.l=E;return A}function parse_BrtFmlaError(n,r,_){var E=n.l+r,S=parse_XLSBCell(n);S.r=_["!row"];var C=n.read_shift(1),A=[S,C,"e"];if(_.cellFormula){n.l+=2;var I=parse_XLSBCellParsedFormula(n,E-n.l,_);A[3]=stringify_formula(I,null,S,_.supbooks,_)}else n.l=E;return A}function parse_BrtFmlaNum(n,r,_){var E=n.l+r,S=parse_XLSBCell(n);S.r=_["!row"];var C=parse_Xnum(n),A=[S,C,"n"];if(_.cellFormula){n.l+=2;var I=parse_XLSBCellParsedFormula(n,E-n.l,_);A[3]=stringify_formula(I,null,S,_.supbooks,_)}else n.l=E;return A}function parse_BrtFmlaString(n,r,_){var E=n.l+r,S=parse_XLSBCell(n);S.r=_["!row"];var C=parse_XLWideString(n),A=[S,C,"str"];if(_.cellFormula){n.l+=2;var I=parse_XLSBCellParsedFormula(n,E-n.l,_);A[3]=stringify_formula(I,null,S,_.supbooks,_)}else n.l=E;return A}var parse_BrtMergeCell=parse_UncheckedRfX,write_BrtMergeCell=write_UncheckedRfX;function write_BrtBeginMergeCells(n,r){return r==null&&(r=new_buf(4)),r.write_shift(4,n),r}function parse_BrtHLink(n,r){var _=n.l+r,E=parse_UncheckedRfX(n),S=parse_XLNullableWideString(n),C=parse_XLWideString(n),A=parse_XLWideString(n),I=parse_XLWideString(n);n.l=_;var B={rfx:E,relId:S,loc:C,display:I};return A&&(B.Tooltip=A),B}function write_BrtHLink(n,r){var _=new_buf(50+4*(n[1].Target.length+(n[1].Tooltip||"").length));write_UncheckedRfX({s:decode_cell(n[0]),e:decode_cell(n[0])},_),write_RelID("rId"+r,_);var E=n[1].Target.indexOf("#"),S=E==-1?"":n[1].Target.slice(E+1);return write_XLWideString(S||"",_),write_XLWideString(n[1].Tooltip||"",_),write_XLWideString("",_),_.slice(0,_.l)}function parse_BrtPane(){}function parse_BrtArrFmla(n,r,_){var E=n.l+r,S=parse_RfX(n),C=n.read_shift(1),A=[S];if(A[2]=C,_.cellFormula){var I=parse_XLSBArrayParsedFormula(n,E-n.l,_);A[1]=I}else n.l=E;return A}function parse_BrtShrFmla(n,r,_){var E=n.l+r,S=parse_UncheckedRfX(n),C=[S];if(_.cellFormula){var A=parse_XLSBSharedParsedFormula(n,E-n.l,_);C[1]=A,n.l=E}else n.l=E;return C}function write_BrtColInfo(n,r,_){_==null&&(_=new_buf(18));var E=col_obj_w(n,r);_.write_shift(-4,n),_.write_shift(-4,n),_.write_shift(4,(E.width||10)*256),_.write_shift(4,0);var S=0;return r.hidden&&(S|=1),typeof E.width=="number"&&(S|=2),r.level&&(S|=r.level<<8),_.write_shift(2,S),_}var BrtMarginKeys=["left","right","top","bottom","header","footer"];function parse_BrtMargins(n){var r={};return BrtMarginKeys.forEach(function(_){r[_]=parse_Xnum(n)}),r}function write_BrtMargins(n,r){return r==null&&(r=new_buf(6*8)),default_margins(n),BrtMarginKeys.forEach(function(_){write_Xnum(n[_],r)}),r}function parse_BrtBeginWsView(n){var r=n.read_shift(2);return n.l+=28,{RTL:r&32}}function write_BrtBeginWsView(n,r,_){_==null&&(_=new_buf(30));var E=924;return(((r||{}).Views||[])[0]||{}).RTL&&(E|=32),_.write_shift(2,E),_.write_shift(4,0),_.write_shift(4,0),_.write_shift(4,0),_.write_shift(1,0),_.write_shift(1,0),_.write_shift(2,0),_.write_shift(2,100),_.write_shift(2,0),_.write_shift(2,0),_.write_shift(2,0),_.write_shift(4,0),_}function write_BrtCellIgnoreEC(n){var r=new_buf(24);return r.write_shift(4,4),r.write_shift(4,1),write_UncheckedRfX(n,r),r}function write_BrtSheetProtection(n,r){return r==null&&(r=new_buf(16*4+2)),r.write_shift(2,n.password?crypto_CreatePasswordVerifier_Method1(n.password):0),r.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(_){_[1]?r.write_shift(4,n[_[0]]!=null&&!n[_[0]]?1:0):r.write_shift(4,n[_[0]]!=null&&n[_[0]]?0:1)}),r}function parse_BrtDVal(){}function parse_BrtDVal14(){}function parse_ws_bin(n,r,_,E,S,C,A){if(!n)return n;var I=r||{};E||(E={"!id":{}});var B={};I.dense&&(B["!data"]=[]);var O,N={s:{r:2e6,c:2e6},e:{r:0,c:0}},U=!1,j=!1,z,Z,X,Q,se,oe,ue,we,Te,xe=[];I.biff=12,I["!row"]=0;var Re=0,Ne=!1,Fe=[],ht={},nt=I.supbooks||S.supbooks||[[]];if(nt.sharedf=ht,nt.arrayf=Fe,nt.SheetNames=S.SheetNames||S.Sheets.map(function(Ge){return Ge.name}),!I.supbooks&&(I.supbooks=nt,S.Names))for(var Ee=0;Ee<S.Names.length;++Ee)nt[0][Ee+1]=S.Names[Ee];var Ce=[],_e=[],Ie=!1;XLSBRecordEnum[16]={n:"BrtShortReal",f:parse_BrtShortReal};var He;if(recordhopper(n,function(je,Ve,Pe){if(!j)switch(Pe){case 148:O=je;break;case 0:z=je,I.sheetRows&&I.sheetRows<=z.r&&(j=!0),we=encode_row(Q=z.r),I["!row"]=z.r,(je.hidden||je.hpt||je.level!=null)&&(je.hpt&&(je.hpx=pt2px(je.hpt)),_e[je.r]=je);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(Z={t:je[2]},je[2]){case"n":Z.v=je[1];break;case"s":ue=strs[je[1]],Z.v=ue.t,Z.r=ue.r;break;case"b":Z.v=!!je[1];break;case"e":Z.v=je[1],I.cellText!==!1&&(Z.w=BErr[Z.v]);break;case"str":Z.t="s",Z.v=je[1];break;case"is":Z.t="s",Z.v=je[1].t;break}if((X=A.CellXf[je[0].iStyleRef])&&safe_format(Z,X.numFmtId,null,I,C,A),se=je[0].c==-1?se+1:je[0].c,I.dense?(B["!data"][Q]||(B["!data"][Q]=[]),B["!data"][Q][se]=Z):B[encode_col(se)+we]=Z,I.cellFormula){for(Ne=!1,Re=0;Re<Fe.length;++Re){var Me=Fe[Re];z.r>=Me[0].s.r&&z.r<=Me[0].e.r&&se>=Me[0].s.c&&se<=Me[0].e.c&&(Z.F=encode_range(Me[0]),Ne=!0)}!Ne&&je.length>3&&(Z.f=je[3])}if(N.s.r>z.r&&(N.s.r=z.r),N.s.c>se&&(N.s.c=se),N.e.r<z.r&&(N.e.r=z.r),N.e.c<se&&(N.e.c=se),I.cellDates&&X&&Z.t=="n"&&fmt_is_date(table_fmt[X.numFmtId])){var tt=SSF_parse_date_code(Z.v);tt&&(Z.t="d",Z.v=new Date(tt.y,tt.m-1,tt.d,tt.H,tt.M,tt.S,tt.u))}He&&(He.type=="XLDAPR"&&(Z.D=!0),He=void 0);break;case 1:case 12:if(!I.sheetStubs||U)break;Z={t:"z",v:void 0},se=je[0].c==-1?se+1:je[0].c,I.dense?(B["!data"][Q]||(B["!data"][Q]=[]),B["!data"][Q][se]=Z):B[encode_col(se)+we]=Z,N.s.r>z.r&&(N.s.r=z.r),N.s.c>se&&(N.s.c=se),N.e.r<z.r&&(N.e.r=z.r),N.e.c<se&&(N.e.c=se),He&&(He.type=="XLDAPR"&&(Z.D=!0),He=void 0);break;case 176:xe.push(je);break;case 49:He=((I.xlmeta||{}).Cell||[])[je-1];break;case 494:var Ke=E["!id"][je.relId];for(Ke?(je.Target=Ke.Target,je.loc&&(je.Target+="#"+je.loc),je.Rel=Ke):je.relId==""&&(je.Target="#"+je.loc),Q=je.rfx.s.r;Q<=je.rfx.e.r;++Q)for(se=je.rfx.s.c;se<=je.rfx.e.c;++se)I.dense?(B["!data"][Q]||(B["!data"][Q]=[]),B["!data"][Q][se]||(B["!data"][Q][se]={t:"z",v:void 0}),B["!data"][Q][se].l=je):(oe=encode_col(se)+encode_row(Q),B[oe]||(B[oe]={t:"z",v:void 0}),B[oe].l=je);break;case 426:if(!I.cellFormula)break;Fe.push(je),Te=I.dense?B["!data"][Q][se]:B[encode_col(se)+we],Te.f=stringify_formula(je[1],N,{r:z.r,c:se},nt,I),Te.F=encode_range(je[0]);break;case 427:if(!I.cellFormula)break;ht[encode_cell(je[0].s)]=je[1],Te=I.dense?B["!data"][Q][se]:B[encode_col(se)+we],Te.f=stringify_formula(je[1],N,{r:z.r,c:se},nt,I);break;case 60:if(!I.cellStyles)break;for(;je.e>=je.s;)Ce[je.e--]={width:je.w/256,hidden:!!(je.flags&1),level:je.level},Ie||(Ie=!0,find_mdw_colw(je.w/256)),process_col(Ce[je.e+1]);break;case 161:B["!autofilter"]={ref:encode_range(je)};break;case 476:B["!margins"]=je;break;case 147:S.Sheets[_]||(S.Sheets[_]={}),je.name&&(S.Sheets[_].CodeName=je.name),(je.above||je.left)&&(B["!outline"]={above:je.above,left:je.left});break;case 137:S.Views||(S.Views=[{}]),S.Views[0]||(S.Views[0]={}),je.RTL&&(S.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:U=!0;break;case 36:U=!1;break;case 37:U=!0;break;case 38:U=!1;break;default:if(!Ve.T){if(!U||I.WTF)throw new Error("Unexpected record 0x"+Pe.toString(16))}}},I),delete I.supbooks,delete I["!row"],!B["!ref"]&&(N.s.r<2e6||O&&(O.e.r>0||O.e.c>0||O.s.r>0||O.s.c>0))&&(B["!ref"]=encode_range(O||N)),I.sheetRows&&B["!ref"]){var Be=safe_decode_range(B["!ref"]);I.sheetRows<=+Be.e.r&&(Be.e.r=I.sheetRows-1,Be.e.r>N.e.r&&(Be.e.r=N.e.r),Be.e.r<Be.s.r&&(Be.s.r=Be.e.r),Be.e.c>N.e.c&&(Be.e.c=N.e.c),Be.e.c<Be.s.c&&(Be.s.c=Be.e.c),B["!fullref"]=B["!ref"],B["!ref"]=encode_range(Be))}return xe.length>0&&(B["!merges"]=xe),Ce.length>0&&(B["!cols"]=Ce),_e.length>0&&(B["!rows"]=_e),B}function write_ws_bin_cell(n,r,_,E,S,C,A){var I={r:_,c:E};if(r.c&&C["!comments"].push([encode_cell(I),r.c]),r.v===void 0)return!1;var B="";switch(r.t){case"b":B=r.v?"1":"0";break;case"d":r=dup(r),r.z=r.z||table_fmt[14],r.v=datenum(parseDate(r.v)),r.t="n";break;case"n":case"e":B=""+r.v;break;default:B=r.v;break}switch(I.s=get_cell_style(S.cellXfs,r,S),r.l&&C["!links"].push([encode_cell(I),r.l]),r.t){case"s":case"str":return S.bookSST?(B=get_sst_id(S.Strings,r.v==null?"":String(r.v),S.revStrings),I.t="s",I.v=B,A?write_record(n,18,write_BrtShortIsst(r,I)):write_record(n,7,write_BrtCellIsst(r,I))):(I.t="str",A?write_record(n,17,write_BrtShortSt(r,I)):write_record(n,6,write_BrtCellSt(r,I))),!0;case"n":return r.v==(r.v|0)&&r.v>-1e3&&r.v<1e3?A?write_record(n,13,write_BrtShortRk(r,I)):write_record(n,2,write_BrtCellRk(r,I)):A?write_record(n,16,write_BrtShortReal(r,I)):write_record(n,5,write_BrtCellReal(r,I)),!0;case"b":return I.t="b",A?write_record(n,15,write_BrtShortBool(r,I)):write_record(n,4,write_BrtCellBool(r,I)),!0;case"e":return I.t="e",A?write_record(n,14,write_BrtShortError(r,I)):write_record(n,3,write_BrtCellError(r,I)),!0}return A?write_record(n,12,write_BrtShortBlank(r,I)):write_record(n,1,write_BrtCellBlank(r,I)),!0}function write_CELLTABLE(n,r,_,E){var S=safe_decode_range(r["!ref"]||"A1"),C,A="",I=[];write_record(n,145);var B=r["!data"]!=null,O=S.e.r;r["!rows"]&&(O=Math.max(S.e.r,r["!rows"].length-1));for(var N=S.s.r;N<=O;++N){A=encode_row(N),write_row_header(n,r,S,N);var U=!1;if(N<=S.e.r)for(var j=S.s.c;j<=S.e.c;++j){N===S.s.r&&(I[j]=encode_col(j)),C=I[j]+A;var z=B?(r["!data"][N]||[])[j]:r[C];if(!z){U=!1;continue}U=write_ws_bin_cell(n,z,N,j,E,r,U)}}write_record(n,146)}function write_MERGECELLS(n,r){!r||!r["!merges"]||(write_record(n,177,write_BrtBeginMergeCells(r["!merges"].length)),r["!merges"].forEach(function(_){write_record(n,176,write_BrtMergeCell(_))}),write_record(n,178))}function write_COLINFOS(n,r){!r||!r["!cols"]||(write_record(n,390),r["!cols"].forEach(function(_,E){_&&write_record(n,60,write_BrtColInfo(E,_))}),write_record(n,391))}function write_IGNOREECS(n,r){!r||!r["!ref"]||(write_record(n,648),write_record(n,649,write_BrtCellIgnoreEC(safe_decode_range(r["!ref"]))),write_record(n,650))}function write_HLINKS(n,r,_){r["!links"].forEach(function(E){if(E[1].Target){var S=add_rels(_,-1,E[1].Target.replace(/#.*$/,""),RELS.HLINK);write_record(n,494,write_BrtHLink(E,S))}}),delete r["!links"]}function write_LEGACYDRAWING(n,r,_,E){if(r["!comments"].length>0){var S=add_rels(E,-1,"../drawings/vmlDrawing"+(_+1)+".vml",RELS.VML);write_record(n,551,write_RelID("rId"+S)),r["!legacy"]=S}}function write_AUTOFILTER(n,r,_,E){if(r["!autofilter"]){var S=r["!autofilter"],C=typeof S.ref=="string"?S.ref:encode_range(S.ref);_.Workbook||(_.Workbook={Sheets:[]}),_.Workbook.Names||(_.Workbook.Names=[]);var A=_.Workbook.Names,I=decode_range(C);I.s.r==I.e.r&&(I.e.r=decode_range(r["!ref"]).e.r,C=encode_range(I));for(var B=0;B<A.length;++B){var O=A[B];if(O.Name=="_xlnm._FilterDatabase"&&O.Sheet==E){O.Ref=formula_quote_sheet_name(_.SheetNames[E])+"!"+fix_range(C);break}}B==A.length&&A.push({Name:"_xlnm._FilterDatabase",Sheet:E,Ref:formula_quote_sheet_name(_.SheetNames[E])+"!"+fix_range(C)}),write_record(n,161,write_UncheckedRfX(safe_decode_range(C))),write_record(n,162)}}function write_WSVIEWS2(n,r,_){write_record(n,133),write_record(n,137,write_BrtBeginWsView(r,_)),write_record(n,138),write_record(n,134)}function write_SHEETPROTECT(n,r){r["!protect"]&&write_record(n,535,write_BrtSheetProtection(r["!protect"]))}function write_ws_bin(n,r,_,E){var S=buf_array(),C=_.SheetNames[n],A=_.Sheets[C]||{},I=C;try{_&&_.Workbook&&(I=_.Workbook.Sheets[n].CodeName||I)}catch{}var B=safe_decode_range(A["!ref"]||"A1");if(B.e.c>16383||B.e.r>1048575){if(r.WTF)throw new Error("Range "+(A["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");B.e.c=Math.min(B.e.c,16383),B.e.r=Math.min(B.e.c,1048575)}return A["!links"]=[],A["!comments"]=[],write_record(S,129),(_.vbaraw||A["!outline"])&&write_record(S,147,write_BrtWsProp(I,A["!outline"])),write_record(S,148,write_BrtWsDim(B)),write_WSVIEWS2(S,A,_.Workbook),write_COLINFOS(S,A),write_CELLTABLE(S,A,n,r),write_SHEETPROTECT(S,A),write_AUTOFILTER(S,A,_,n),write_MERGECELLS(S,A),write_HLINKS(S,A,E),A["!margins"]&&write_record(S,476,write_BrtMargins(A["!margins"])),(!r||r.ignoreEC||r.ignoreEC==null)&&write_IGNOREECS(S,A),write_LEGACYDRAWING(S,A,n,E),write_record(S,130),S.end()}function parse_Cache(n){var r=[],_=n.match(/^<c:numCache>/),E;(n.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(C){var A=C.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);A&&(r[+A[1]]=_?+A[2]:A[2])});var S=unescapexml((n.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(n.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(C){E=C.replace(/<.*?>/g,"")}),[r,S,E]}function parse_chart(n,r,_,E,S,C){var A=C||{"!type":"chart"};if(!n)return C;var I=0,B=0,O="A",N={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(n.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(U){var j=parse_Cache(U);N.s.r=N.s.c=0,N.e.c=I,O=encode_col(I),j[0].forEach(function(z,Z){A["!data"]?(A["!data"][Z]||(A["!data"][Z]=[]),A["!data"][Z][I]={t:"n",v:z,z:j[1]}):A[O+encode_row(Z)]={t:"n",v:z,z:j[1]},B=Z}),N.e.r<B&&(N.e.r=B),++I}),I>0&&(A["!ref"]=encode_range(N)),A}function parse_cs_xml(n,r,_,E,S){if(!n)return n;E||(E={"!id":{}});var C={"!type":"chart","!drawel":null,"!rel":""},A,I=n.match(sheetprregex);return I&&parse_ws_xml_sheetpr(I[0],C,S,_),(A=n.match(/drawing r:id="(.*?)"/))&&(C["!rel"]=A[1]),E["!id"][C["!rel"]]&&(C["!drawel"]=E["!id"][C["!rel"]]),C}function parse_BrtCsProp(n,r){n.l+=10;var _=parse_XLWideString(n);return{name:_}}function parse_cs_bin(n,r,_,E,S){if(!n)return n;E||(E={"!id":{}});var C={"!type":"chart","!drawel":null,"!rel":""},A=!1;return recordhopper(n,function(B,O,N){switch(N){case 550:C["!rel"]=B;break;case 651:S.Sheets[_]||(S.Sheets[_]={}),B.name&&(S.Sheets[_].CodeName=B.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:A=!0;break;case 36:A=!1;break;case 37:break;case 38:break;default:if(!(O.T>0)){if(!(O.T<0)){if(!A||r.WTF)throw new Error("Unexpected record 0x"+N.toString(16))}}}},r),E["!id"][C["!rel"]]&&(C["!drawel"]=E["!id"][C["!rel"]]),C}var WBPropsDef=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],WBViewDef=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],SheetDef=[],CalcPrDef=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function push_defaults_array(n,r){for(var _=0;_!=n.length;++_)for(var E=n[_],S=0;S!=r.length;++S){var C=r[S];if(E[C[0]]==null)E[C[0]]=C[1];else switch(C[2]){case"bool":typeof E[C[0]]=="string"&&(E[C[0]]=parsexmlbool(E[C[0]]));break;case"int":typeof E[C[0]]=="string"&&(E[C[0]]=parseInt(E[C[0]],10));break}}}function push_defaults(n,r){for(var _=0;_!=r.length;++_){var E=r[_];if(n[E[0]]==null)n[E[0]]=E[1];else switch(E[2]){case"bool":typeof n[E[0]]=="string"&&(n[E[0]]=parsexmlbool(n[E[0]]));break;case"int":typeof n[E[0]]=="string"&&(n[E[0]]=parseInt(n[E[0]],10));break}}}function parse_wb_defaults(n){push_defaults(n.WBProps,WBPropsDef),push_defaults(n.CalcPr,CalcPrDef),push_defaults_array(n.WBView,WBViewDef),push_defaults_array(n.Sheets,SheetDef),_ssfopts.date1904=parsexmlbool(n.WBProps.date1904)}function safe1904(n){return!n.Workbook||!n.Workbook.WBProps?"false":parsexmlbool(n.Workbook.WBProps.date1904)?"true":"false"}var badchars=":][*?/\\".split("");function check_ws_name(n,r){if(n.length>31){if(r)return!1;throw new Error("Sheet names cannot exceed 31 chars")}var _=!0;return badchars.forEach(function(E){if(n.indexOf(E)!=-1){if(!r)throw new Error("Sheet name cannot contain : \\ / ? * [ ]");_=!1}}),_}function check_wb_names(n,r,_){n.forEach(function(E,S){check_ws_name(E);for(var C=0;C<S;++C)if(E==n[C])throw new Error("Duplicate Sheet Name: "+E);if(_){var A=r&&r[S]&&r[S].CodeName||E;if(A.charCodeAt(0)==95&&A.length>22)throw new Error("Bad Code Name: Worksheet"+A)}})}function check_wb(n){if(!n||!n.SheetNames||!n.Sheets)throw new Error("Invalid Workbook");if(!n.SheetNames.length)throw new Error("Workbook is empty");var r=n.Workbook&&n.Workbook.Sheets||[];check_wb_names(n.SheetNames,r,!!n.vbaraw);for(var _=0;_<n.SheetNames.length;++_)check_ws(n.Sheets[n.SheetNames[_]],n.SheetNames[_],_);n.SheetNames.forEach(function(E,S){var C=n.Sheets[E];if(!(!C||!C["!autofilter"])){var A;n.Workbook||(n.Workbook={}),n.Workbook.Names||(n.Workbook.Names=[]),n.Workbook.Names.forEach(function(B){B.Name=="_xlnm._FilterDatabase"&&B.Sheet==S&&(A=B)});var I=formula_quote_sheet_name(E)+"!"+fix_range(C["!autofilter"].ref);A?A.Ref=I:n.Workbook.Names.push({Name:"_xlnm._FilterDatabase",Sheet:S,Ref:I})}})}var wbnsregex=/<\w+:workbook/;function parse_wb_xml(n,r){if(!n)throw new Error("Could not find file");var _={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},E=!1,S="xmlns",C={},A=0;if(n.replace(tagregex,function(B,O){var N=parsexmltag(B);switch(strip_ns(N[0])){case"<?xml":break;case"<workbook":B.match(wbnsregex)&&(S="xmlns"+B.match(/<(\w+):/)[1]),_.xmlns=N[S];break;case"</workbook>":break;case"<fileVersion":delete N[0],_.AppVersion=N;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":WBPropsDef.forEach(function(U){if(N[U[0]]!=null)switch(U[2]){case"bool":_.WBProps[U[0]]=parsexmlbool(N[U[0]]);break;case"int":_.WBProps[U[0]]=parseInt(N[U[0]],10);break;default:_.WBProps[U[0]]=N[U[0]]}}),N.codeName&&(_.WBProps.CodeName=utf8read(N.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete N[0],_.WBView.push(N);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(N.state){case"hidden":N.Hidden=1;break;case"veryHidden":N.Hidden=2;break;default:N.Hidden=0}delete N.state,N.name=unescapexml(utf8read(N.name)),delete N[0],_.Sheets.push(N);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":E=!0;break;case"</definedNames>":E=!1;break;case"<definedName":C={},C.Name=utf8read(N.name),N.comment&&(C.Comment=N.comment),N.localSheetId&&(C.Sheet=+N.localSheetId),parsexmlbool(N.hidden||"0")&&(C.Hidden=!0),A=O+B.length;break;case"</definedName>":C.Ref=unescapexml(utf8read(n.slice(A,O))),_.Names.push(C);break;case"<definedName/>":break;case"<calcPr":delete N[0],_.CalcPr=N;break;case"<calcPr/>":delete N[0],_.CalcPr=N;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":E=!0;break;case"</ext>":E=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":E=!0;break;case"</AlternateContent>":E=!1;break;case"<revisionPtr":break;default:if(!E&&r.WTF)throw new Error("unrecognized "+N[0]+" in workbook")}return B}),XMLNS_main.indexOf(_.xmlns)===-1)throw new Error("Unknown Namespace: "+_.xmlns);return parse_wb_defaults(_),_}function write_wb_xml(n){var r=[XML_HEADER];r[r.length]=writextag("workbook",null,{xmlns:XMLNS_main[0],"xmlns:r":XMLNS.r});var _=n.Workbook&&(n.Workbook.Names||[]).length>0,E={codeName:"ThisWorkbook"};n.Workbook&&n.Workbook.WBProps&&(WBPropsDef.forEach(function(I){n.Workbook.WBProps[I[0]]!=null&&n.Workbook.WBProps[I[0]]!=I[1]&&(E[I[0]]=n.Workbook.WBProps[I[0]])}),n.Workbook.WBProps.CodeName&&(E.codeName=n.Workbook.WBProps.CodeName,delete E.CodeName)),r[r.length]=writextag("workbookPr",null,E);var S=n.Workbook&&n.Workbook.Sheets||[],C=0;if(S&&S[0]&&S[0].Hidden){for(r[r.length]="<bookViews>",C=0;C!=n.SheetNames.length&&!(!S[C]||!S[C].Hidden);++C);C==n.SheetNames.length&&(C=0),r[r.length]='<workbookView firstSheet="'+C+'" activeTab="'+C+'"/>',r[r.length]="</bookViews>"}for(r[r.length]="<sheets>",C=0;C!=n.SheetNames.length;++C){var A={name:escapexml(n.SheetNames[C].slice(0,31))};if(A.sheetId=""+(C+1),A["r:id"]="rId"+(C+1),S[C])switch(S[C].Hidden){case 1:A.state="hidden";break;case 2:A.state="veryHidden";break}r[r.length]=writextag("sheet",null,A)}return r[r.length]="</sheets>",_&&(r[r.length]="<definedNames>",n.Workbook&&n.Workbook.Names&&n.Workbook.Names.forEach(function(I){var B={name:I.Name};I.Comment&&(B.comment=I.Comment),I.Sheet!=null&&(B.localSheetId=""+I.Sheet),I.Hidden&&(B.hidden="1"),I.Ref&&(r[r.length]=writextag("definedName",escapexml(I.Ref),B))}),r[r.length]="</definedNames>"),r.length>2&&(r[r.length]="</workbook>",r[1]=r[1].replace("/>",">")),r.join("")}function parse_BrtBundleSh(n,r){var _={};return _.Hidden=n.read_shift(4),_.iTabID=n.read_shift(4),_.strRelID=parse_RelID(n),_.name=parse_XLWideString(n),_}function write_BrtBundleSh(n,r){return r||(r=new_buf(127)),r.write_shift(4,n.Hidden),r.write_shift(4,n.iTabID),write_RelID(n.strRelID,r),write_XLWideString(n.name.slice(0,31),r),r.length>r.l?r.slice(0,r.l):r}function parse_BrtWbProp(n,r){var _={},E=n.read_shift(4);_.defaultThemeVersion=n.read_shift(4);var S=r>8?parse_XLWideString(n):"";return S.length>0&&(_.CodeName=S),_.autoCompressPictures=!!(E&65536),_.backupFile=!!(E&64),_.checkCompatibility=!!(E&4096),_.date1904=!!(E&1),_.filterPrivacy=!!(E&8),_.hidePivotFieldList=!!(E&1024),_.promptedSolutions=!!(E&16),_.publishItems=!!(E&2048),_.refreshAllConnections=!!(E&262144),_.saveExternalLinkValues=!!(E&128),_.showBorderUnselectedTables=!!(E&4),_.showInkAnnotation=!!(E&32),_.showObjects=["all","placeholders","none"][E>>13&3],_.showPivotChartFilter=!!(E&32768),_.updateLinks=["userSet","never","always"][E>>8&3],_}function write_BrtWbProp(n,r){r||(r=new_buf(72));var _=0;return n&&(n.date1904&&(_|=1),n.filterPrivacy&&(_|=8)),r.write_shift(4,_),r.write_shift(4,0),write_XLSBCodeName(n&&n.CodeName||"ThisWorkbook",r),r.slice(0,r.l)}function parse_BrtFRTArchID$(n,r){var _={};return n.read_shift(4),_.ArchID=n.read_shift(4),n.l+=r-8,_}function parse_BrtName(n,r,_){var E=n.l+r,S=n.read_shift(4);n.l+=1;var C=n.read_shift(4),A=parse_XLNameWideString(n),I=parse_XLSBNameParsedFormula(n,0,_),B=parse_XLNullableWideString(n);S&32&&(A="_xlnm."+A),n.l=E;var O={Name:A,Ptg:I,Flags:S};return C<268435455&&(O.Sheet=C),B&&(O.Comment=B),O}function write_BrtName(n,r){var _=new_buf(9),E=0,S=n.Name;XLSLblBuiltIn.indexOf(S)>-1&&(E|=32,S=S.slice(6)),_.write_shift(4,E),_.write_shift(1,0),_.write_shift(4,n.Sheet==null?4294967295:n.Sheet);var C=[_,write_XLWideString(S),write_XLSBNameParsedFormula(n.Ref,r)];if(n.Comment)C.push(write_XLNullableWideString(n.Comment));else{var A=new_buf(4);A.write_shift(4,4294967295),C.push(A)}return bconcat(C)}function parse_wb_bin(n,r){var _={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},E=[],S=!1;r||(r={}),r.biff=12;var C=[],A=[[]];return A.SheetNames=[],A.XTI=[],XLSBRecordEnum[16]={n:"BrtFRTArchID$",f:parse_BrtFRTArchID$},recordhopper(n,function(B,O,N){switch(N){case 156:A.SheetNames.push(B.name),_.Sheets.push(B);break;case 153:_.WBProps=B;break;case 39:B.Sheet!=null&&(r.SID=B.Sheet),B.Ref=stringify_formula(B.Ptg,null,null,A,r),delete r.SID,delete B.Ptg,C.push(B);break;case 1036:break;case 357:case 358:case 355:case 667:A[0].length?A.push([N,B]):A[0]=[N,B],A[A.length-1].XTI=[];break;case 362:A.length===0&&(A[0]=[],A[0].XTI=[]),A[A.length-1].XTI=A[A.length-1].XTI.concat(B),A.XTI=A.XTI.concat(B);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:E.push(N),S=!0;break;case 36:E.pop(),S=!1;break;case 37:E.push(N),S=!0;break;case 38:E.pop(),S=!1;break;case 16:break;default:if(!O.T){if(!S||r.WTF&&E[E.length-1]!=37&&E[E.length-1]!=35)throw new Error("Unexpected record 0x"+N.toString(16))}}},r),parse_wb_defaults(_),_.Names=C,_.supbooks=A,_}function write_BUNDLESHS(n,r){write_record(n,143);for(var _=0;_!=r.SheetNames.length;++_){var E=r.Workbook&&r.Workbook.Sheets&&r.Workbook.Sheets[_]&&r.Workbook.Sheets[_].Hidden||0,S={Hidden:E,iTabID:_+1,strRelID:"rId"+(_+1),name:r.SheetNames[_]};write_record(n,156,write_BrtBundleSh(S))}write_record(n,144)}function write_BrtFileVersion(n,r){r||(r=new_buf(127));for(var _=0;_!=4;++_)r.write_shift(4,0);return write_XLWideString("SheetJS",r),write_XLWideString(XLSX.version,r),write_XLWideString(XLSX.version,r),write_XLWideString("7262",r),r.length>r.l?r.slice(0,r.l):r}function write_BrtBookView(n,r){r||(r=new_buf(29)),r.write_shift(-4,0),r.write_shift(-4,460),r.write_shift(4,28800),r.write_shift(4,17600),r.write_shift(4,500),r.write_shift(4,n),r.write_shift(4,n);var _=120;return r.write_shift(1,_),r.length>r.l?r.slice(0,r.l):r}function write_BOOKVIEWS(n,r){if(!(!r.Workbook||!r.Workbook.Sheets)){for(var _=r.Workbook.Sheets,E=0,S=-1,C=-1;E<_.length;++E)!_[E]||!_[E].Hidden&&S==-1?S=E:_[E].Hidden==1&&C==-1&&(C=E);C>S||(write_record(n,135),write_record(n,158,write_BrtBookView(S)),write_record(n,136))}}function write_BRTNAMES(n,r){!r.Workbook||!r.Workbook.Names||r.Workbook.Names.forEach(function(_){try{if(_.Flags&14)return;write_record(n,39,write_BrtName(_,r))}catch{console.error("Could not serialize defined name "+JSON.stringify(_))}})}function write_SELF_EXTERNS_xlsb(n){var r=n.SheetNames.length,_=new_buf(12*r+28);_.write_shift(4,r+2),_.write_shift(4,0),_.write_shift(4,-2),_.write_shift(4,-2),_.write_shift(4,0),_.write_shift(4,-1),_.write_shift(4,-1);for(var E=0;E<r;++E)_.write_shift(4,0),_.write_shift(4,E),_.write_shift(4,E);return _}function write_EXTERNALS_xlsb(n,r){write_record(n,353),write_record(n,357),write_record(n,362,write_SELF_EXTERNS_xlsb(r)),write_record(n,354)}function write_wb_bin(n,r){var _=buf_array();return write_record(_,131),write_record(_,128,write_BrtFileVersion()),write_record(_,153,write_BrtWbProp(n.Workbook&&n.Workbook.WBProps||null)),write_BOOKVIEWS(_,n),write_BUNDLESHS(_,n),write_EXTERNALS_xlsb(_,n),(n.Workbook||{}).Names&&write_BRTNAMES(_,n),write_record(_,132),_.end()}function parse_wb(n,r,_){return r.slice(-4)===".bin"?parse_wb_bin(n,_):parse_wb_xml(n,_)}function parse_ws(n,r,_,E,S,C,A,I){return r.slice(-4)===".bin"?parse_ws_bin(n,E,_,S,C,A,I):parse_ws_xml(n,E,_,S,C,A,I)}function parse_cs(n,r,_,E,S,C,A,I){return r.slice(-4)===".bin"?parse_cs_bin(n,E,_,S,C):parse_cs_xml(n,E,_,S,C)}function parse_ms(n,r,_,E,S,C,A,I){return r.slice(-4)===".bin"?parse_ms_bin():parse_ms_xml()}function parse_ds(n,r,_,E,S,C,A,I){return r.slice(-4)===".bin"?parse_ds_bin():parse_ds_xml()}function parse_sty(n,r,_,E){return r.slice(-4)===".bin"?parse_sty_bin(n,_,E):parse_sty_xml(n,_,E)}function parse_sst(n,r,_){return r.slice(-4)===".bin"?parse_sst_bin(n,_):parse_sst_xml(n,_)}function parse_cmnt(n,r,_){return r.slice(-4)===".bin"?parse_comments_bin(n,_):parse_comments_xml(n,_)}function parse_cc(n,r,_){return r.slice(-4)===".bin"?parse_cc_bin(n):parse_cc_xml(n)}function parse_xlink(n,r,_,E){return _.slice(-4)===".bin"?parse_xlink_bin(n,r,_,E):void 0}function parse_xlmeta(n,r,_){return r.slice(-4)===".bin"?parse_xlmeta_bin(n,r,_):parse_xlmeta_xml(n,r,_)}var attregexg2=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,attregex2=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function xlml_parsexmltag(n,r){var _=n.split(/\s+/),E=[];if(r||(E[0]=_[0]),_.length===1)return E;var S=n.match(attregexg2),C,A,I,B;if(S)for(B=0;B!=S.length;++B)C=S[B].match(attregex2),(A=C[1].indexOf(":"))===-1?E[C[1]]=C[2].slice(1,C[2].length-1):(C[1].slice(0,6)==="xmlns:"?I="xmlns"+C[1].slice(6):I=C[1].slice(A+1),E[I]=C[2].slice(1,C[2].length-1));return E}function xlml_parsexmltagobj(n){var r=n.split(/\s+/),_={};if(r.length===1)return _;var E=n.match(attregexg2),S,C,A,I;if(E)for(I=0;I!=E.length;++I)S=E[I].match(attregex2),(C=S[1].indexOf(":"))===-1?_[S[1]]=S[2].slice(1,S[2].length-1):(S[1].slice(0,6)==="xmlns:"?A="xmlns"+S[1].slice(6):A=S[1].slice(C+1),_[A]=S[2].slice(1,S[2].length-1));return _}var XLMLFormatMap;function xlml_format(n,r){var _=XLMLFormatMap[n]||unescapexml(n);return _==="General"?SSF_general(r):SSF_format(_,r)}function xlml_set_custprop(n,r,_,E){var S=E;switch((_[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":S=parsexmlbool(E);break;case"i2":case"int":S=parseInt(E,10);break;case"r4":case"float":S=parseFloat(E);break;case"date":case"dateTime.tz":S=parseDate(E);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+_[0])}n[unescapexml(r)]=S}function safe_format_xlml(n,r,_){if(n.t!=="z"){if(!_||_.cellText!==!1)try{n.t==="e"?n.w=n.w||BErr[n.v]:r==="General"?n.t==="n"?(n.v|0)===n.v?n.w=n.v.toString(10):n.w=SSF_general_num(n.v):n.w=SSF_general(n.v):n.w=xlml_format(r||"General",n.v)}catch(C){if(_.WTF)throw C}try{var E=XLMLFormatMap[r]||r||"General";if(_.cellNF&&(n.z=E),_.cellDates&&n.t=="n"&&fmt_is_date(E)){var S=SSF_parse_date_code(n.v);S&&(n.t="d",n.v=new Date(S.y,S.m-1,S.d,S.H,S.M,S.S,S.u))}}catch(C){if(_.WTF)throw C}}}function process_style_xlml(n,r,_){if(_.cellStyles&&r.Interior){var E=r.Interior;E.Pattern&&(E.patternType=XLMLPatternTypeMap[E.Pattern]||E.Pattern)}n[r.ID]=r}function parse_xlml_data(n,r,_,E,S,C,A,I,B,O){var N="General",U=E.StyleID,j={};O=O||{};var z=[],Z=0;for(U===void 0&&I&&(U=I.StyleID),U===void 0&&A&&(U=A.StyleID);C[U]!==void 0&&(C[U].nf&&(N=C[U].nf),C[U].Interior&&z.push(C[U].Interior),!!C[U].Parent);)U=C[U].Parent;switch(_.Type){case"Boolean":E.t="b",E.v=parsexmlbool(n);break;case"String":E.t="s",E.r=xlml_fixstr(unescapexml(n)),E.v=n.indexOf("<")>-1?unescapexml(r||n).replace(/<.*?>/g,""):E.r;break;case"DateTime":n.slice(-1)!="Z"&&(n+="Z"),E.v=(parseDate(n)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),E.v!==E.v?E.v=unescapexml(n):E.v<60&&(E.v=E.v-1),(!N||N=="General")&&(N="yyyy-mm-dd");case"Number":E.v===void 0&&(E.v=+n),E.t||(E.t="n");break;case"Error":E.t="e",E.v=RBErr[n],O.cellText!==!1&&(E.w=n);break;default:n==""&&r==""?E.t="z":(E.t="s",E.v=xlml_fixstr(r||n));break}if(safe_format_xlml(E,N,O),O.cellFormula!==!1)if(E.Formula){var X=unescapexml(E.Formula);X.charCodeAt(0)==61&&(X=X.slice(1)),E.f=rc_to_a1(X,S),delete E.Formula,E.ArrayRange=="RC"?E.F=rc_to_a1("RC:RC",S):E.ArrayRange&&(E.F=rc_to_a1(E.ArrayRange,S),B.push([safe_decode_range(E.F),E.F]))}else for(Z=0;Z<B.length;++Z)S.r>=B[Z][0].s.r&&S.r<=B[Z][0].e.r&&S.c>=B[Z][0].s.c&&S.c<=B[Z][0].e.c&&(E.F=B[Z][1]);O.cellStyles&&(z.forEach(function(Q){!j.patternType&&Q.patternType&&(j.patternType=Q.patternType)}),E.s=j),E.StyleID!==void 0&&(E.ixfe=E.StyleID)}function xlml_prefix_dname(n){return XLSLblBuiltIn.indexOf("_xlnm."+n)>-1?"_xlnm."+n:n}function xlml_clean_comment(n){n.t=n.v||"",n.t=n.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),n.v=n.w=n.ixfe=void 0}function parse_xlml_xml(n,r){var _=r||{};make_ssf();var E=debom(xlml_normalize(n));(_.type=="binary"||_.type=="array"||_.type=="base64")&&(E=utf8read(E));var S=E.slice(0,1024).toLowerCase(),C=!1;if(S=S.replace(/".*?"/g,""),(S.indexOf(">")&1023)>Math.min(S.indexOf(",")&1023,S.indexOf(";")&1023)){var A=dup(_);return A.type="string",PRN.to_workbook(E,A)}if(S.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function($t){S.indexOf("<"+$t)>=0&&(C=!0)}),C)return html_to_workbook(E,_);XLMLFormatMap={"General Number":"General","General Date":table_fmt[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":table_fmt[15],"Short Date":table_fmt[14],"Long Time":table_fmt[19],"Medium Time":table_fmt[18],"Short Time":table_fmt[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:table_fmt[2],Standard:table_fmt[4],Percent:table_fmt[10],Scientific:table_fmt[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var I,B=[],O,N={},U=[],j={},z="";_.dense&&(j["!data"]=[]);var Z={},X={},Q=xlml_parsexmltag('<Data ss:Type="String">'),se=0,oe=0,ue=0,we={s:{r:2e6,c:2e6},e:{r:0,c:0}},Te={},xe={},Re="",Ne=0,Fe=[],ht={},nt={},Ee=0,Ce=[],_e=[],Ie={},He=[],Be,Ge=!1,je=[],Ve=[],Pe={},Me=0,tt=0,Ke={Sheets:[],WBProps:{date1904:!1}},mt={};xlmlregex.lastIndex=0,E=E.replace(/<!--([\s\S]*?)-->/mg,"");for(var ct="";I=xlmlregex.exec(E);)switch(I[3]=(ct=I[3]).toLowerCase()){case"data":if(ct=="data"){if(I[1]==="/"){if((O=B.pop())[0]!==I[3])throw new Error("Bad state: "+O.join("|"))}else I[0].charAt(I[0].length-2)!=="/"&&B.push([I[3],!0]);break}if(B[B.length-1][1])break;I[1]==="/"?parse_xlml_data(E.slice(se,I.index),Re,Q,B[B.length-1][0]=="comment"?Ie:Z,{c:oe,r:ue},Te,He[oe],X,je,_):(Re="",Q=xlml_parsexmltag(I[0]),se=I.index+I[0].length);break;case"cell":if(I[1]==="/")if(_e.length>0&&(Z.c=_e),(!_.sheetRows||_.sheetRows>ue)&&Z.v!==void 0&&(_.dense?(j["!data"][ue]||(j["!data"][ue]=[]),j["!data"][ue][oe]=Z):j[encode_col(oe)+encode_row(ue)]=Z),Z.HRef&&(Z.l={Target:unescapexml(Z.HRef)},Z.HRefScreenTip&&(Z.l.Tooltip=Z.HRefScreenTip),delete Z.HRef,delete Z.HRefScreenTip),(Z.MergeAcross||Z.MergeDown)&&(Me=oe+(parseInt(Z.MergeAcross,10)|0),tt=ue+(parseInt(Z.MergeDown,10)|0),(Me>oe||tt>ue)&&Fe.push({s:{c:oe,r:ue},e:{c:Me,r:tt}})),!_.sheetStubs)Z.MergeAcross?oe=Me+1:++oe;else if(Z.MergeAcross||Z.MergeDown){for(var Qe=oe;Qe<=Me;++Qe)for(var dt=ue;dt<=tt;++dt)(Qe>oe||dt>ue)&&(_.dense?(j["!data"][dt]||(j["!data"][dt]=[]),j["!data"][dt][Qe]={t:"z"}):j[encode_col(Qe)+encode_row(dt)]={t:"z"});oe=Me+1}else++oe;else Z=xlml_parsexmltagobj(I[0]),Z.Index&&(oe=+Z.Index-1),oe<we.s.c&&(we.s.c=oe),oe>we.e.c&&(we.e.c=oe),I[0].slice(-2)==="/>"&&++oe,_e=[];break;case"row":I[1]==="/"||I[0].slice(-2)==="/>"?(ue<we.s.r&&(we.s.r=ue),ue>we.e.r&&(we.e.r=ue),I[0].slice(-2)==="/>"&&(X=xlml_parsexmltag(I[0]),X.Index&&(ue=+X.Index-1)),oe=0,++ue):(X=xlml_parsexmltag(I[0]),X.Index&&(ue=+X.Index-1),Pe={},(X.AutoFitHeight=="0"||X.Height)&&(Pe.hpx=parseInt(X.Height,10),Pe.hpt=px2pt(Pe.hpx),Ve[ue]=Pe),X.Hidden=="1"&&(Pe.hidden=!0,Ve[ue]=Pe));break;case"worksheet":if(I[1]==="/"){if((O=B.pop())[0]!==I[3])throw new Error("Bad state: "+O.join("|"));U.push(z),we.s.r<=we.e.r&&we.s.c<=we.e.c&&(j["!ref"]=encode_range(we),_.sheetRows&&_.sheetRows<=we.e.r&&(j["!fullref"]=j["!ref"],we.e.r=_.sheetRows-1,j["!ref"]=encode_range(we))),Fe.length&&(j["!merges"]=Fe),He.length>0&&(j["!cols"]=He),Ve.length>0&&(j["!rows"]=Ve),N[z]=j}else we={s:{r:2e6,c:2e6},e:{r:0,c:0}},ue=oe=0,B.push([I[3],!1]),O=xlml_parsexmltag(I[0]),z=unescapexml(O.Name),j={},_.dense&&(j["!data"]=[]),Fe=[],je=[],Ve=[],mt={name:z,Hidden:0},Ke.Sheets.push(mt);break;case"table":if(I[1]==="/"){if((O=B.pop())[0]!==I[3])throw new Error("Bad state: "+O.join("|"))}else{if(I[0].slice(-2)=="/>")break;B.push([I[3],!1]),He=[],Ge=!1}break;case"style":I[1]==="/"?process_style_xlml(Te,xe,_):xe=xlml_parsexmltag(I[0]);break;case"numberformat":xe.nf=unescapexml(xlml_parsexmltag(I[0]).Format||"General"),XLMLFormatMap[xe.nf]&&(xe.nf=XLMLFormatMap[xe.nf]);for(var vt=0;vt!=392&&table_fmt[vt]!=xe.nf;++vt);if(vt==392){for(vt=57;vt!=392;++vt)if(table_fmt[vt]==null){SSF__load(xe.nf,vt);break}}break;case"column":if(B[B.length-1][0]!=="table"||I[1]==="/")break;if(Be=xlml_parsexmltag(I[0]),Be.Hidden&&(Be.hidden=!0,delete Be.Hidden),Be.Width&&(Be.wpx=parseInt(Be.Width,10)),!Ge&&Be.wpx>10){Ge=!0,MDW=DEF_MDW;for(var At=0;At<He.length;++At)He[At]&&process_col(He[At])}Ge&&process_col(Be),He[Be.Index-1||He.length]=Be;for(var bt=0;bt<+Be.Span;++bt)He[He.length]=dup(Be);break;case"namedrange":if(I[1]==="/")break;Ke.Names||(Ke.Names=[]);var ft=parsexmltag(I[0]),Et={Name:xlml_prefix_dname(ft.Name),Ref:rc_to_a1(ft.RefersTo.slice(1),{r:0,c:0})};Ke.Sheets.length>0&&(Et.Sheet=Ke.Sheets.length-1),Ke.Names.push(Et);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(I[0].slice(-2)==="/>")break;I[1]==="/"?Re+=E.slice(Ne,I.index):Ne=I.index+I[0].length;break;case"interior":if(!_.cellStyles)break;xe.Interior=xlml_parsexmltag(I[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(I[0].slice(-2)==="/>")break;I[1]==="/"?xlml_set_prop(ht,ct,E.slice(Ee,I.index)):Ee=I.index+I[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(I[1]==="/"){if((O=B.pop())[0]!==I[3])throw new Error("Bad state: "+O.join("|"))}else B.push([I[3],!1]);break;case"comment":if(I[1]==="/"){if((O=B.pop())[0]!==I[3])throw new Error("Bad state: "+O.join("|"));xlml_clean_comment(Ie),_e.push(Ie)}else B.push([I[3],!1]),O=xlml_parsexmltag(I[0]),Ie={a:O.Author};break;case"autofilter":if(I[1]==="/"){if((O=B.pop())[0]!==I[3])throw new Error("Bad state: "+O.join("|"))}else if(I[0].charAt(I[0].length-2)!=="/"){var Ye=xlml_parsexmltag(I[0]);j["!autofilter"]={ref:rc_to_a1(Ye.Range).replace(/\$/g,"")},B.push([I[3],!0])}break;case"name":break;case"datavalidation":if(I[1]==="/"){if((O=B.pop())[0]!==I[3])throw new Error("Bad state: "+O.join("|"))}else I[0].charAt(I[0].length-2)!=="/"&&B.push([I[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(I[1]==="/"){if((O=B.pop())[0]!==I[3])throw new Error("Bad state: "+O.join("|"))}else I[0].charAt(I[0].length-2)!=="/"&&B.push([I[3],!0]);break;case"null":break;default:if(B.length==0&&I[3]=="document"||B.length==0&&I[3]=="uof")return parse_fods(E,_);var Ct=!0;switch(B[B.length-1][0]){case"officedocumentsettings":switch(I[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:Ct=!1}break;case"componentoptions":switch(I[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:Ct=!1}break;case"excelworkbook":switch(I[3]){case"date1904":Ke.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:Ct=!1}break;case"workbookoptions":switch(I[3]){case"owcversion":break;case"height":break;case"width":break;default:Ct=!1}break;case"worksheetoptions":switch(I[3]){case"visible":if(I[0].slice(-2)!=="/>")if(I[1]==="/")switch(E.slice(Ee,I.index)){case"SheetHidden":mt.Hidden=1;break;case"SheetVeryHidden":mt.Hidden=2;break}else Ee=I.index+I[0].length;break;case"header":j["!margins"]||default_margins(j["!margins"]={},"xlml"),isNaN(+parsexmltag(I[0]).Margin)||(j["!margins"].header=+parsexmltag(I[0]).Margin);break;case"footer":j["!margins"]||default_margins(j["!margins"]={},"xlml"),isNaN(+parsexmltag(I[0]).Margin)||(j["!margins"].footer=+parsexmltag(I[0]).Margin);break;case"pagemargins":var Pt=parsexmltag(I[0]);j["!margins"]||default_margins(j["!margins"]={},"xlml"),isNaN(+Pt.Top)||(j["!margins"].top=+Pt.Top),isNaN(+Pt.Left)||(j["!margins"].left=+Pt.Left),isNaN(+Pt.Right)||(j["!margins"].right=+Pt.Right),isNaN(+Pt.Bottom)||(j["!margins"].bottom=+Pt.Bottom);break;case"displayrighttoleft":Ke.Views||(Ke.Views=[]),Ke.Views[0]||(Ke.Views[0]={}),Ke.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":j["!outline"]||(j["!outline"]={}),j["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":j["!outline"]||(j["!outline"]={}),j["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:Ct=!1}break;case"pivottable":case"pivotcache":switch(I[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:Ct=!1}break;case"pagebreaks":switch(I[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:Ct=!1}break;case"autofilter":switch(I[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:Ct=!1}break;case"querytable":switch(I[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:Ct=!1}break;case"datavalidation":switch(I[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:Ct=!1}break;case"sorting":case"conditionalformatting":switch(I[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:Ct=!1}break;case"mapinfo":case"schema":case"data":switch(I[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:Ct=!1}break;case"smarttags":break;default:Ct=!1;break}if(Ct||I[3].match(/!\[CDATA/))break;if(!B[B.length-1][1])throw"Unrecognized tag: "+I[3]+"|"+B.join("|");if(B[B.length-1][0]==="customdocumentproperties"){if(I[0].slice(-2)==="/>")break;I[1]==="/"?xlml_set_custprop(nt,ct,Ce,E.slice(Ee,I.index)):(Ce=I,Ee=I.index+I[0].length);break}if(_.WTF)throw"Unrecognized tag: "+I[3]+"|"+B.join("|")}var St={};return!_.bookSheets&&!_.bookProps&&(St.Sheets=N),St.SheetNames=U,St.Workbook=Ke,St.SSF=dup(table_fmt),St.Props=ht,St.Custprops=nt,St.bookType="xlml",St}function parse_xlml(n,r){switch(fix_read_opts(r=r||{}),r.type||"base64"){case"base64":return parse_xlml_xml(Base64_decode(n),r);case"binary":case"buffer":case"file":return parse_xlml_xml(n,r);case"array":return parse_xlml_xml(a2s(n),r)}}function write_props_xlml(n,r){var _=[];return n.Props&&_.push(xlml_write_docprops(n.Props,r)),n.Custprops&&_.push(xlml_write_custprops(n.Props,n.Custprops)),_.join("")}function write_wb_xlml(n){return(((n||{}).Workbook||{}).WBProps||{}).date1904?'<ExcelWorkbook xmlns="urn:schemas-microsoft-com:office:excel"><Date1904/></ExcelWorkbook>':""}function write_sty_xlml(n,r){var _=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return r.cellXfs.forEach(function(E,S){var C=[];C.push(writextag("NumberFormat",null,{"ss:Format":escapexml(table_fmt[E.numFmtId])}));var A={"ss:ID":"s"+(21+S)};_.push(writextag("Style",C.join(""),A))}),writextag("Styles",_.join(""))}function write_name_xlml(n){return writextag("NamedRange",null,{"ss:Name":n.Name.slice(0,6)=="_xlnm."?n.Name.slice(6):n.Name,"ss:RefersTo":"="+a1_to_rc(n.Ref,{r:0,c:0})})}function write_names_xlml(n){if(!((n||{}).Workbook||{}).Names)return"";for(var r=n.Workbook.Names,_=[],E=0;E<r.length;++E){var S=r[E];S.Sheet==null&&(S.Name.match(/^_xlfn\./)||_.push(write_name_xlml(S)))}return writextag("Names",_.join(""))}function write_ws_xlml_names(n,r,_,E){if(!n||!((E||{}).Workbook||{}).Names)return"";for(var S=E.Workbook.Names,C=[],A=0;A<S.length;++A){var I=S[A];I.Sheet==_&&(I.Name.match(/^_xlfn\./)||C.push(write_name_xlml(I)))}return C.join("")}function write_ws_xlml_wsopts(n,r,_,E){if(!n)return"";var S=[];if(n["!margins"]&&(S.push("<PageSetup>"),n["!margins"].header&&S.push(writextag("Header",null,{"x:Margin":n["!margins"].header})),n["!margins"].footer&&S.push(writextag("Footer",null,{"x:Margin":n["!margins"].footer})),S.push(writextag("PageMargins",null,{"x:Bottom":n["!margins"].bottom||"0.75","x:Left":n["!margins"].left||"0.7","x:Right":n["!margins"].right||"0.7","x:Top":n["!margins"].top||"0.75"})),S.push("</PageSetup>")),E&&E.Workbook&&E.Workbook.Sheets&&E.Workbook.Sheets[_])if(E.Workbook.Sheets[_].Hidden)S.push(writextag("Visible",E.Workbook.Sheets[_].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var C=0;C<_&&!(E.Workbook.Sheets[C]&&!E.Workbook.Sheets[C].Hidden);++C);C==_&&S.push("<Selected/>")}return((((E||{}).Workbook||{}).Views||[])[0]||{}).RTL&&S.push("<DisplayRightToLeft/>"),n["!protect"]&&(S.push(writetag("ProtectContents","True")),n["!protect"].objects&&S.push(writetag("ProtectObjects","True")),n["!protect"].scenarios&&S.push(writetag("ProtectScenarios","True")),n["!protect"].selectLockedCells!=null&&!n["!protect"].selectLockedCells?S.push(writetag("EnableSelection","NoSelection")):n["!protect"].selectUnlockedCells!=null&&!n["!protect"].selectUnlockedCells&&S.push(writetag("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(A){n["!protect"][A[0]]&&S.push("<"+A[1]+"/>")})),S.length==0?"":writextag("WorksheetOptions",S.join(""),{xmlns:XLMLNS.x})}function write_ws_xlml_comment(n){return n.map(function(r){var _=xlml_unfixstr(r.t||""),E=writextag("ss:Data",_,{xmlns:"http://www.w3.org/TR/REC-html40"});return writextag("Comment",E,{"ss:Author":r.a})}).join("")}function write_ws_xlml_cell(n,r,_,E,S,C,A){if(!n||n.v==null&&n.f==null)return"";var I={};if(n.f&&(I["ss:Formula"]="="+escapexml(a1_to_rc(n.f,A))),n.F&&n.F.slice(0,r.length)==r){var B=decode_cell(n.F.slice(r.length+1));I["ss:ArrayRange"]="RC:R"+(B.r==A.r?"":"["+(B.r-A.r)+"]")+"C"+(B.c==A.c?"":"["+(B.c-A.c)+"]")}if(n.l&&n.l.Target&&(I["ss:HRef"]=escapexml(n.l.Target),n.l.Tooltip&&(I["x:HRefScreenTip"]=escapexml(n.l.Tooltip))),_["!merges"])for(var O=_["!merges"],N=0;N!=O.length;++N)O[N].s.c!=A.c||O[N].s.r!=A.r||(O[N].e.c>O[N].s.c&&(I["ss:MergeAcross"]=O[N].e.c-O[N].s.c),O[N].e.r>O[N].s.r&&(I["ss:MergeDown"]=O[N].e.r-O[N].s.r));var U="",j="";switch(n.t){case"z":if(!E.sheetStubs)return"";break;case"n":U="Number",j=String(n.v);break;case"b":U="Boolean",j=n.v?"1":"0";break;case"e":U="Error",j=BErr[n.v];break;case"d":U="DateTime",j=new Date(n.v).toISOString(),n.z==null&&(n.z=n.z||table_fmt[14]);break;case"s":U="String",j=escapexlml(n.v||"");break}var z=get_cell_style(E.cellXfs,n,E);I["ss:StyleID"]="s"+(21+z),I["ss:Index"]=A.c+1;var Z=n.v!=null?j:"",X=n.t=="z"?"":'<Data ss:Type="'+U+'">'+Z+"</Data>";return(n.c||[]).length>0&&(X+=write_ws_xlml_comment(n.c)),writextag("Cell",X,I)}function write_ws_xlml_row(n,r){var _='<Row ss:Index="'+(n+1)+'"';return r&&(r.hpt&&!r.hpx&&(r.hpx=pt2px(r.hpt)),r.hpx&&(_+=' ss:AutoFitHeight="0" ss:Height="'+r.hpx+'"'),r.hidden&&(_+=' ss:Hidden="1"')),_+">"}function write_ws_xlml_table(n,r,_,E){if(!n["!ref"])return"";var S=safe_decode_range(n["!ref"]),C=n["!merges"]||[],A=0,I=[];n["!cols"]&&n["!cols"].forEach(function(Q,se){process_col(Q);var oe=!!Q.width,ue=col_obj_w(se,Q),we={"ss:Index":se+1};oe&&(we["ss:Width"]=width2px(ue.width)),Q.hidden&&(we["ss:Hidden"]="1"),I.push(writextag("Column",null,we))});for(var B=n["!data"]!=null,O=S.s.r;O<=S.e.r;++O){for(var N=[write_ws_xlml_row(O,(n["!rows"]||[])[O])],U=S.s.c;U<=S.e.c;++U){var j=!1;for(A=0;A!=C.length;++A)if(!(C[A].s.c>U)&&!(C[A].s.r>O)&&!(C[A].e.c<U)&&!(C[A].e.r<O)){(C[A].s.c!=U||C[A].s.r!=O)&&(j=!0);break}if(!j){var z={r:O,c:U},Z=encode_col(U)+encode_row(O),X=B?(n["!data"][O]||[])[U]:n[Z];N.push(write_ws_xlml_cell(X,Z,n,r,_,E,z))}}N.push("</Row>"),N.length>2&&I.push(N.join(""))}return I.join("")}function write_ws_xlml(n,r,_){var E=[],S=_.SheetNames[n],C=_.Sheets[S],A=C?write_ws_xlml_names(C,r,n,_):"";return A.length>0&&E.push("<Names>"+A+"</Names>"),A=C?write_ws_xlml_table(C,r,n,_):"",A.length>0&&E.push("<Table>"+A+"</Table>"),E.push(write_ws_xlml_wsopts(C,r,n,_)),C["!autofilter"]&&E.push('<AutoFilter x:Range="'+a1_to_rc(fix_range(C["!autofilter"].ref),{r:0,c:0})+'" xmlns="urn:schemas-microsoft-com:office:excel"></AutoFilter>'),E.join("")}function write_xlml(n,r){r||(r={}),n.SSF||(n.SSF=dup(table_fmt)),n.SSF&&(make_ssf(),SSF_load_table(n.SSF),r.revssf=evert_num(n.SSF),r.revssf[n.SSF[65535]]=0,r.ssf=n.SSF,r.cellXfs=[],get_cell_style(r.cellXfs,{},{revssf:{General:0}}));var _=[];_.push(write_props_xlml(n,r)),_.push(write_wb_xlml(n)),_.push(""),_.push("");for(var E=0;E<n.SheetNames.length;++E)_.push(writextag("Worksheet",write_ws_xlml(E,r,n),{"ss:Name":escapexml(n.SheetNames[E])}));return _[2]=write_sty_xlml(n,r),_[3]=write_names_xlml(n),XML_HEADER+writextag("Workbook",_.join(""),{xmlns:XLMLNS.ss,"xmlns:o":XLMLNS.o,"xmlns:x":XLMLNS.x,"xmlns:ss":XLMLNS.ss,"xmlns:dt":XLMLNS.dt,"xmlns:html":XLMLNS.html})}function parse_compobj(n){var r={},_=n.content;if(_.l=28,r.AnsiUserType=_.read_shift(0,"lpstr-ansi"),r.AnsiClipboardFormat=parse_ClipboardFormatOrAnsiString(_),_.length-_.l<=4)return r;var E=_.read_shift(4);if(E==0||E>40||(_.l-=4,r.Reserved1=_.read_shift(0,"lpstr-ansi"),_.length-_.l<=4)||(E=_.read_shift(4),E!==1907505652)||(r.UnicodeClipboardFormat=parse_ClipboardFormatOrUnicodeString(_),E=_.read_shift(4),E==0||E>40))return r;_.l-=4,r.Reserved2=_.read_shift(0,"lpwstr")}var CONTINUE_RT=[60,1084,2066,2165,2175];function slurp(n,r,_,E,S){var C=E,A=[],I=_.slice(_.l,_.l+C);if(S&&S.enc&&S.enc.insitu&&I.length>0)switch(n){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:S.enc.insitu(I)}A.push(I),_.l+=C;for(var B=__readUInt16LE(_,_.l),O=XLSRecordEnum[B],N=0;O!=null&&CONTINUE_RT.indexOf(B)>-1;)C=__readUInt16LE(_,_.l+2),N=_.l+4,B==2066?N+=4:(B==2165||B==2175)&&(N+=12),I=_.slice(N,_.l+4+C),A.push(I),_.l+=4+C,O=XLSRecordEnum[B=__readUInt16LE(_,_.l)];var U=bconcat(A);prep_blob(U,0);var j=0;U.lens=[];for(var z=0;z<A.length;++z)U.lens.push(j),j+=A[z].length;if(U.length<E)throw"XLS Record 0x"+n.toString(16)+" Truncated: "+U.length+" < "+E;return r.f(U,U.length,S)}function safe_format_xf(n,r,_){if(n.t!=="z"&&n.XF){var E=0;try{E=n.z||n.XF.numFmtId||0,r.cellNF&&(n.z=table_fmt[E])}catch(C){if(r.WTF)throw C}if(!r||r.cellText!==!1)try{n.t==="e"?n.w=n.w||BErr[n.v]:E===0||E=="General"?n.t==="n"?(n.v|0)===n.v?n.w=n.v.toString(10):n.w=SSF_general_num(n.v):n.w=SSF_general(n.v):n.w=SSF_format(E,n.v,{date1904:!!_,dateNF:r&&r.dateNF})}catch(C){if(r.WTF)throw C}if(r.cellDates&&E&&n.t=="n"&&fmt_is_date(table_fmt[E]||String(E))){var S=SSF_parse_date_code(n.v);S&&(n.t="d",n.v=new Date(S.y,S.m-1,S.d,S.H,S.M,S.S,S.u))}}}function make_cell(n,r,_){return{v:n,ixfe:r,t:_}}function parse_workbook(n,r){var _={opts:{}},E={},S={};r.dense&&(S["!data"]=[]);var C={},A={},I=null,B=[],O="",N={},U,j="",z,Z,X,Q,se={},oe=[],ue,we,Te=[],xe=[],Re={Sheets:[],WBProps:{date1904:!1},Views:[{}]},Ne={},Fe=function(Bt){return Bt<8?XLSIcv[Bt]:Bt<64&&xe[Bt-8]||XLSIcv[Bt]},ht=function(Bt,Ht,nr){var Qt=Ht.XF.data;if(!(!Qt||!Qt.patternType||!nr||!nr.cellStyles)){Ht.s={},Ht.s.patternType=Qt.patternType;var xr;(xr=rgb2Hex(Fe(Qt.icvFore)))&&(Ht.s.fgColor={rgb:xr}),(xr=rgb2Hex(Fe(Qt.icvBack)))&&(Ht.s.bgColor={rgb:xr})}},nt=function(Bt,Ht,nr){if(!(Pe>1)&&!(nr.sheetRows&&Bt.r>=nr.sheetRows)){if(nr.cellStyles&&Ht.XF&&Ht.XF.data&&ht(Bt,Ht,nr),delete Ht.ixfe,delete Ht.XF,U=Bt,j=encode_cell(Bt),(!A||!A.s||!A.e)&&(A={s:{r:0,c:0},e:{r:0,c:0}}),Bt.r<A.s.r&&(A.s.r=Bt.r),Bt.c<A.s.c&&(A.s.c=Bt.c),Bt.r+1>A.e.r&&(A.e.r=Bt.r+1),Bt.c+1>A.e.c&&(A.e.c=Bt.c+1),nr.cellFormula&&Ht.f){for(var Qt=0;Qt<oe.length;++Qt)if(!(oe[Qt][0].s.c>Bt.c||oe[Qt][0].s.r>Bt.r)&&!(oe[Qt][0].e.c<Bt.c||oe[Qt][0].e.r<Bt.r)){Ht.F=encode_range(oe[Qt][0]),(oe[Qt][0].s.c!=Bt.c||oe[Qt][0].s.r!=Bt.r)&&delete Ht.f,Ht.f&&(Ht.f=""+stringify_formula(oe[Qt][1],A,Bt,je,Ee));break}}nr.dense?(S["!data"][Bt.r]||(S["!data"][Bt.r]=[]),S["!data"][Bt.r][Bt.c]=Ht):S[j]=Ht}},Ee={enc:!1,sbcch:0,snames:[],sharedf:se,arrayf:oe,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!r&&!!r.cellStyles,WTF:!!r&&!!r.wtf};r.password&&(Ee.password=r.password);var Ce,_e=[],Ie=[],He=[],Be=[],Ge=!1,je=[];je.SheetNames=Ee.snames,je.sharedf=Ee.sharedf,je.arrayf=Ee.arrayf,je.names=[],je.XTI=[];var Ve=0,Pe=0,Me=0,tt=[],Ke=[],mt;Ee.codepage=1200,set_cp(1200);for(var ct=!1;n.l<n.length-1;){var Qe=n.l,dt=n.read_shift(2);if(dt===0&&Ve===10)break;var vt=n.l===n.length?0:n.read_shift(2),At=XLSRecordEnum[dt];if(Pe==0&&[9,521,1033,2057].indexOf(dt)==-1)break;if(At&&At.f){if(r.bookSheets&&Ve===133&&dt!==133)break;if(Ve=dt,At.r===2||At.r==12){var bt=n.read_shift(2);if(vt-=2,!Ee.enc&&bt!==dt&&((bt&255)<<8|bt>>8)!==dt)throw new Error("rt mismatch: "+bt+"!="+dt);At.r==12&&(n.l+=10,vt-=10)}var ft={};if(dt===10?ft=At.f(n,vt,Ee):ft=slurp(dt,At,n,vt,Ee),Pe==0&&[9,521,1033,2057].indexOf(Ve)===-1)continue;switch(dt){case 34:_.opts.Date1904=Re.WBProps.date1904=ft;break;case 134:_.opts.WriteProtect=!0;break;case 47:if(Ee.enc||(n.l=0),Ee.enc=ft,!r.password)throw new Error("File is password-protected");if(ft.valid==null)throw new Error("Encryption scheme unsupported");if(!ft.valid)throw new Error("Password is incorrect");break;case 92:Ee.lastuser=ft;break;case 66:var Et=Number(ft);switch(Et){case 21010:Et=1200;break;case 32768:Et=1e4;break;case 32769:Et=1252;break}set_cp(Ee.codepage=Et),ct=!0;break;case 317:Ee.rrtabid=ft;break;case 25:Ee.winlocked=ft;break;case 439:_.opts.RefreshAll=ft;break;case 12:_.opts.CalcCount=ft;break;case 16:_.opts.CalcDelta=ft;break;case 17:_.opts.CalcIter=ft;break;case 13:_.opts.CalcMode=ft;break;case 14:_.opts.CalcPrecision=ft;break;case 95:_.opts.CalcSaveRecalc=ft;break;case 15:Ee.CalcRefMode=ft;break;case 2211:_.opts.FullCalc=ft;break;case 129:ft.fDialog&&(S["!type"]="dialog"),ft.fBelow||((S["!outline"]||(S["!outline"]={})).above=!0),ft.fRight||((S["!outline"]||(S["!outline"]={})).left=!0);break;case 224:Te.push(ft);break;case 430:je.push([ft]),je[je.length-1].XTI=[];break;case 35:case 547:je[je.length-1].push(ft);break;case 24:case 536:mt={Name:ft.Name,Ref:stringify_formula(ft.rgce,A,null,je,Ee)},ft.itab>0&&(mt.Sheet=ft.itab-1),je.names.push(mt),je[0]||(je[0]=[],je[0].XTI=[]),je[je.length-1].push(ft),ft.Name=="_xlnm._FilterDatabase"&&ft.itab>0&&ft.rgce&&ft.rgce[0]&&ft.rgce[0][0]&&ft.rgce[0][0][0]=="PtgArea3d"&&(Ke[ft.itab-1]={ref:encode_range(ft.rgce[0][0][1][2])});break;case 22:Ee.ExternCount=ft;break;case 23:je.length==0&&(je[0]=[],je[0].XTI=[]),je[je.length-1].XTI=je[je.length-1].XTI.concat(ft),je.XTI=je.XTI.concat(ft);break;case 2196:if(Ee.biff<8)break;mt!=null&&(mt.Comment=ft[1]);break;case 18:S["!protect"]=ft;break;case 19:ft!==0&&Ee.WTF&&console.error("Password verifier: "+ft);break;case 133:C[ft.pos]=ft,Ee.snames.push(ft.name);break;case 10:{if(--Pe)break;if(A.e){if(A.e.r>0&&A.e.c>0){if(A.e.r--,A.e.c--,S["!ref"]=encode_range(A),r.sheetRows&&r.sheetRows<=A.e.r){var Ye=A.e.r;A.e.r=r.sheetRows-1,S["!fullref"]=S["!ref"],S["!ref"]=encode_range(A),A.e.r=Ye}A.e.r++,A.e.c++}_e.length>0&&(S["!merges"]=_e),Ie.length>0&&(S["!objects"]=Ie),He.length>0&&(S["!cols"]=He),Be.length>0&&(S["!rows"]=Be),Re.Sheets.push(Ne)}O===""?N=S:E[O]=S,S={},r.dense&&(S["!data"]=[])}break;case 9:case 521:case 1033:case 2057:{if(Ee.biff===8&&(Ee.biff={9:2,521:3,1033:4}[dt]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[ft.BIFFVer]||8),Ee.biffguess=ft.BIFFVer==0,ft.BIFFVer==0&&ft.dt==4096&&(Ee.biff=5,ct=!0,set_cp(Ee.codepage=28591)),Ee.biff==8&&ft.BIFFVer==0&&ft.dt==16&&(Ee.biff=2),Pe++)break;if(S={},r.dense&&(S["!data"]=[]),Ee.biff<8&&!ct&&(ct=!0,set_cp(Ee.codepage=r.codepage||1252)),Ee.biff<5||ft.BIFFVer==0&&ft.dt==4096){O===""&&(O="Sheet1"),A={s:{r:0,c:0},e:{r:0,c:0}};var Ct={pos:n.l-vt,name:O};C[Ct.pos]=Ct,Ee.snames.push(O)}else O=(C[Qe]||{name:""}).name;ft.dt==32&&(S["!type"]="chart"),ft.dt==64&&(S["!type"]="macro"),_e=[],Ie=[],Ee.arrayf=oe=[],He=[],Be=[],Ge=!1,Ne={Hidden:(C[Qe]||{hs:0}).hs,name:O}}break;case 515:case 3:case 2:S["!type"]=="chart"&&(r.dense?(S["!data"][ft.r]||[])[ft.c]:S[encode_col(ft.c)+encode_row(ft.r)])&&++ft.c,ue={ixfe:ft.ixfe,XF:Te[ft.ixfe]||{},v:ft.val,t:"n"},Me>0&&(ue.z=tt[ue.ixfe>>8&63]),safe_format_xf(ue,r,_.opts.Date1904),nt({c:ft.c,r:ft.r},ue,r);break;case 5:case 517:ue={ixfe:ft.ixfe,XF:Te[ft.ixfe],v:ft.val,t:ft.t},Me>0&&(ue.z=tt[ue.ixfe>>8&63]),safe_format_xf(ue,r,_.opts.Date1904),nt({c:ft.c,r:ft.r},ue,r);break;case 638:ue={ixfe:ft.ixfe,XF:Te[ft.ixfe],v:ft.rknum,t:"n"},Me>0&&(ue.z=tt[ue.ixfe>>8&63]),safe_format_xf(ue,r,_.opts.Date1904),nt({c:ft.c,r:ft.r},ue,r);break;case 189:for(var Pt=ft.c;Pt<=ft.C;++Pt){var St=ft.rkrec[Pt-ft.c][0];ue={ixfe:St,XF:Te[St],v:ft.rkrec[Pt-ft.c][1],t:"n"},Me>0&&(ue.z=tt[ue.ixfe>>8&63]),safe_format_xf(ue,r,_.opts.Date1904),nt({c:Pt,r:ft.r},ue,r)}break;case 6:case 518:case 1030:{if(ft.val=="String"){I=ft;break}if(ue=make_cell(ft.val,ft.cell.ixfe,ft.tt),ue.XF=Te[ue.ixfe],r.cellFormula){var $t=ft.formula;if($t&&$t[0]&&$t[0][0]&&$t[0][0][0]=="PtgExp"){var kt=$t[0][0][1][0],Ft=$t[0][0][1][1],qt=encode_cell({r:kt,c:Ft});se[qt]?ue.f=""+stringify_formula(ft.formula,A,ft.cell,je,Ee):ue.F=((r.dense?(S["!data"][kt]||[])[Ft]:S[qt])||{}).F}else ue.f=""+stringify_formula(ft.formula,A,ft.cell,je,Ee)}Me>0&&(ue.z=tt[ue.ixfe>>8&63]),safe_format_xf(ue,r,_.opts.Date1904),nt(ft.cell,ue,r),I=ft}break;case 7:case 519:if(I)I.val=ft,ue=make_cell(ft,I.cell.ixfe,"s"),ue.XF=Te[ue.ixfe],r.cellFormula&&(ue.f=""+stringify_formula(I.formula,A,I.cell,je,Ee)),Me>0&&(ue.z=tt[ue.ixfe>>8&63]),safe_format_xf(ue,r,_.opts.Date1904),nt(I.cell,ue,r),I=null;else throw new Error("String record expects Formula");break;case 33:case 545:{oe.push(ft);var Mt=encode_cell(ft[0].s);if(z=r.dense?(S["!data"][ft[0].s.r]||[])[ft[0].s.c]:S[Mt],r.cellFormula&&z){if(!I||!Mt||!z)break;z.f=""+stringify_formula(ft[1],A,ft[0],je,Ee),z.F=encode_range(ft[0])}}break;case 1212:{if(!r.cellFormula)break;if(j){if(!I)break;se[encode_cell(I.cell)]=ft[0],z=r.dense?(S["!data"][I.cell.r]||[])[I.cell.c]:S[encode_cell(I.cell)],(z||{}).f=""+stringify_formula(ft[0],A,U,je,Ee)}}break;case 253:ue=make_cell(B[ft.isst].t,ft.ixfe,"s"),B[ft.isst].h&&(ue.h=B[ft.isst].h),ue.XF=Te[ue.ixfe],Me>0&&(ue.z=tt[ue.ixfe>>8&63]),safe_format_xf(ue,r,_.opts.Date1904),nt({c:ft.c,r:ft.r},ue,r);break;case 513:r.sheetStubs&&(ue={ixfe:ft.ixfe,XF:Te[ft.ixfe],t:"z"},Me>0&&(ue.z=tt[ue.ixfe>>8&63]),safe_format_xf(ue,r,_.opts.Date1904),nt({c:ft.c,r:ft.r},ue,r));break;case 190:if(r.sheetStubs)for(var Wt=ft.c;Wt<=ft.C;++Wt){var Zt=ft.ixfe[Wt-ft.c];ue={ixfe:Zt,XF:Te[Zt],t:"z"},Me>0&&(ue.z=tt[ue.ixfe>>8&63]),safe_format_xf(ue,r,_.opts.Date1904),nt({c:Wt,r:ft.r},ue,r)}break;case 214:case 516:case 4:ue=make_cell(ft.val,ft.ixfe,"s"),ue.XF=Te[ue.ixfe],Me>0&&(ue.z=tt[ue.ixfe>>8&63]),safe_format_xf(ue,r,_.opts.Date1904),nt({c:ft.c,r:ft.r},ue,r);break;case 0:case 512:Pe===1&&(A=ft);break;case 252:B=ft;break;case 1054:if(Ee.biff==4){tt[Me++]=ft[1];for(var Yt=0;Yt<Me+163&&table_fmt[Yt]!=ft[1];++Yt);Yt>=163&&SSF__load(ft[1],Me+163)}else SSF__load(ft[1],ft[0]);break;case 30:{tt[Me++]=ft;for(var ur=0;ur<Me+163&&table_fmt[ur]!=ft;++ur);ur>=163&&SSF__load(ft,Me+163)}break;case 229:_e=_e.concat(ft);break;case 93:Ie[ft.cmo[0]]=Ee.lastobj=ft;break;case 438:Ee.lastobj.TxO=ft;break;case 127:Ee.lastobj.ImData=ft;break;case 440:for(Q=ft[0].s.r;Q<=ft[0].e.r;++Q)for(X=ft[0].s.c;X<=ft[0].e.c;++X)z=r.dense?(S["!data"][Q]||[])[X]:S[encode_cell({c:X,r:Q})],z&&(z.l=ft[1]);break;case 2048:for(Q=ft[0].s.r;Q<=ft[0].e.r;++Q)for(X=ft[0].s.c;X<=ft[0].e.c;++X)z=r.dense?(S["!data"][Q]||[])[X]:S[encode_cell({c:X,r:Q})],z&&z.l&&(z.l.Tooltip=ft[1]);break;case 28:{if(Ee.biff<=5&&Ee.biff>=2)break;z=r.dense?(S["!data"][ft[0].r]||[])[ft[0].c]:S[encode_cell(ft[0])];var xt=Ie[ft[2]];z||(r.dense?(S["!data"][ft[0].r]||(S["!data"][ft[0].r]=[]),z=S["!data"][ft[0].r][ft[0].c]={t:"z"}):z=S[encode_cell(ft[0])]={t:"z"},A.e.r=Math.max(A.e.r,ft[0].r),A.s.r=Math.min(A.s.r,ft[0].r),A.e.c=Math.max(A.e.c,ft[0].c),A.s.c=Math.min(A.s.c,ft[0].c)),z.c||(z.c=[]),Z={a:ft[1],t:xt.TxO.t},z.c.push(Z)}break;case 2173:update_xfext(Te[ft.ixfe],ft.ext);break;case 125:{if(!Ee.cellStyles)break;for(;ft.e>=ft.s;)He[ft.e--]={width:ft.w/256,level:ft.level||0,hidden:!!(ft.flags&1)},Ge||(Ge=!0,find_mdw_colw(ft.w/256)),process_col(He[ft.e+1])}break;case 520:{var pt={};ft.level!=null&&(Be[ft.r]=pt,pt.level=ft.level),ft.hidden&&(Be[ft.r]=pt,pt.hidden=!0),ft.hpt&&(Be[ft.r]=pt,pt.hpt=ft.hpt,pt.hpx=pt2px(ft.hpt))}break;case 38:case 39:case 40:case 41:S["!margins"]||default_margins(S["!margins"]={}),S["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[dt]]=ft;break;case 161:S["!margins"]||default_margins(S["!margins"]={}),S["!margins"].header=ft.header,S["!margins"].footer=ft.footer;break;case 574:ft.RTL&&(Re.Views[0].RTL=!0);break;case 146:xe=ft;break;case 2198:Ce=ft;break;case 140:we=ft;break;case 442:O?Ne.CodeName=ft||Ne.name:Re.WBProps.CodeName=ft||"ThisWorkbook";break}}else At||console.error("Missing Info for XLS Record 0x"+dt.toString(16)),n.l+=vt}return _.SheetNames=keys(C).sort(function(yt,Bt){return Number(yt)-Number(Bt)}).map(function(yt){return C[yt].name}),r.bookSheets||(_.Sheets=E),!_.SheetNames.length&&N["!ref"]?(_.SheetNames.push("Sheet1"),_.Sheets&&(_.Sheets.Sheet1=N)):_.Preamble=N,_.Sheets&&Ke.forEach(function(yt,Bt){_.Sheets[_.SheetNames[Bt]]["!autofilter"]=yt}),_.Strings=B,_.SSF=dup(table_fmt),Ee.enc&&(_.Encryption=Ee.enc),Ce&&(_.Themes=Ce),_.Metadata={},we!==void 0&&(_.Metadata.Country=we),je.names.length>0&&(Re.Names=je.names),_.Workbook=Re,_}var PSCLSID={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function parse_xls_props(n,r,_){var E=CFB.find(n,"/!DocumentSummaryInformation");if(E&&E.size>0)try{var S=parse_PropertySetStream(E,DocSummaryPIDDSI,PSCLSID.DSI);for(var C in S)r[C]=S[C]}catch(O){if(_.WTF)throw O}var A=CFB.find(n,"/!SummaryInformation");if(A&&A.size>0)try{var I=parse_PropertySetStream(A,SummaryPIDSI,PSCLSID.SI);for(var B in I)r[B]==null&&(r[B]=I[B])}catch(O){if(_.WTF)throw O}r.HeadingPairs&&r.TitlesOfParts&&(load_props_pairs(r.HeadingPairs,r.TitlesOfParts,r,_),delete r.HeadingPairs,delete r.TitlesOfParts)}function write_xls_props(n,r){var _=[],E=[],S=[],C=0,A,I=evert_key(DocSummaryPIDDSI,"n"),B=evert_key(SummaryPIDSI,"n");if(n.Props)for(A=keys(n.Props),C=0;C<A.length;++C)(Object.prototype.hasOwnProperty.call(I,A[C])?_:Object.prototype.hasOwnProperty.call(B,A[C])?E:S).push([A[C],n.Props[A[C]]]);if(n.Custprops)for(A=keys(n.Custprops),C=0;C<A.length;++C)Object.prototype.hasOwnProperty.call(n.Props||{},A[C])||(Object.prototype.hasOwnProperty.call(I,A[C])?_:Object.prototype.hasOwnProperty.call(B,A[C])?E:S).push([A[C],n.Custprops[A[C]]]);var O=[];for(C=0;C<S.length;++C)XLSPSSkip.indexOf(S[C][0])>-1||PseudoPropsPairs.indexOf(S[C][0])>-1||S[C][1]!=null&&O.push(S[C]);E.length&&CFB.utils.cfb_add(r,"/SummaryInformation",write_PropertySetStream(E,PSCLSID.SI,B,SummaryPIDSI)),(_.length||O.length)&&CFB.utils.cfb_add(r,"/DocumentSummaryInformation",write_PropertySetStream(_,PSCLSID.DSI,I,DocSummaryPIDDSI,O.length?O:null,PSCLSID.UDI))}function parse_xlscfb(n,r){r||(r={}),fix_read_opts(r),reset_cp(),r.codepage&&set_ansi(r.codepage);var _,E;if(n.FullPaths){if(CFB.find(n,"/encryption"))throw new Error("File is password-protected");_=CFB.find(n,"!CompObj"),E=CFB.find(n,"/Workbook")||CFB.find(n,"/Book")}else{switch(r.type){case"base64":n=s2a(Base64_decode(n));break;case"binary":n=s2a(n);break;case"buffer":break;case"array":Array.isArray(n)||(n=Array.prototype.slice.call(n));break}prep_blob(n,0),E={content:n}}var S,C;if(_&&parse_compobj(_),r.bookProps&&!r.bookSheets)S={};else{var A=has_buf?"buffer":"array";if(E&&E.content)S=parse_workbook(E.content,r);else if((C=CFB.find(n,"PerfectOffice_MAIN"))&&C.content)S=WK_.to_workbook(C.content,(r.type=A,r));else if((C=CFB.find(n,"NativeContent_MAIN"))&&C.content)S=WK_.to_workbook(C.content,(r.type=A,r));else throw(C=CFB.find(n,"MN0"))&&C.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");r.bookVBA&&n.FullPaths&&CFB.find(n,"/_VBA_PROJECT_CUR/VBA/dir")&&(S.vbaraw=make_vba_xls(n))}var I={};return n.FullPaths&&parse_xls_props(n,I,r),S.Props=S.Custprops=I,r.bookFiles&&(S.cfb=n),S}function write_xlscfb(n,r){var _=r||{},E=CFB.utils.cfb_new({root:"R"}),S="/Workbook";switch(_.bookType||"xls"){case"xls":_.bookType="biff8";case"xla":_.bookType||(_.bookType="xla");case"biff8":S="/Workbook",_.biff=8;break;case"biff5":S="/Book",_.biff=5;break;default:throw new Error("invalid type "+_.bookType+" for XLS CFB")}return CFB.utils.cfb_add(E,S,write_biff_buf(n,_)),_.biff==8&&(n.Props||n.Custprops)&&write_xls_props(n,E),_.biff==8&&n.vbaraw&&fill_vba_xls(E,CFB.read(n.vbaraw,{type:typeof n.vbaraw=="string"?"binary":"buffer"})),E}var XLSBRecordEnum={0:{f:parse_BrtRowHdr},1:{f:parse_BrtCellBlank},2:{f:parse_BrtCellRk},3:{f:parse_BrtCellError},4:{f:parse_BrtCellBool},5:{f:parse_BrtCellReal},6:{f:parse_BrtCellSt},7:{f:parse_BrtCellIsst},8:{f:parse_BrtFmlaString},9:{f:parse_BrtFmlaNum},10:{f:parse_BrtFmlaBool},11:{f:parse_BrtFmlaError},12:{f:parse_BrtShortBlank},13:{f:parse_BrtShortRk},14:{f:parse_BrtShortError},15:{f:parse_BrtShortBool},16:{f:parse_BrtShortReal},17:{f:parse_BrtShortSt},18:{f:parse_BrtShortIsst},19:{f:parse_RichStr},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:parse_BrtName},40:{},42:{},43:{f:parse_BrtFont},44:{f:parse_BrtFmt},45:{f:parse_BrtFill},46:{f:parse_BrtBorder},47:{f:parse_BrtXF},48:{},49:{f:parse_Int32LE},50:{},51:{f:parse_BrtMdb},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:parse_ColInfo},62:{f:parse_BrtCellRString},63:{f:parse_BrtCalcChainItem$},64:{f:parse_BrtDVal},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:parsenoop,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:parse_BrtBeginWsView},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:parse_BrtWsProp},148:{f:parse_BrtWsDim,p:16},151:{f:parse_BrtPane},152:{},153:{f:parse_BrtWbProp},154:{},155:{},156:{f:parse_BrtBundleSh},157:{},158:{},159:{T:1,f:parse_BrtBeginSst},160:{T:-1},161:{T:1,f:parse_UncheckedRfX},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:parse_BrtMergeCell},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:parse_BrtMdtinfo},336:{T:-1},337:{f:parse_BrtBeginEsmdb,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:parse_RelID},357:{},358:{},359:{},360:{T:1},361:{},362:{f:parse_ExternSheet},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:parse_BrtArrFmla},427:{f:parse_BrtShrFmla},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:parse_BrtMargins},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:parse_BrtWsFmtInfo},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:parse_BrtHLink},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:parse_RelID},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:parse_BrtCommentAuthor},633:{T:1},634:{T:-1},635:{T:1,f:parse_BrtBeginComment},636:{T:-1},637:{f:parse_BrtCommentText},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:parse_BrtCsProp},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:parse_BrtDVal14},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},XLSRecordEnum={6:{f:parse_Formula},10:{f:parsenoop2},12:{f:parseuint16},13:{f:parseuint16},14:{f:parsebool},15:{f:parsebool},16:{f:parse_Xnum},17:{f:parsebool},18:{f:parsebool},19:{f:parseuint16},20:{f:parse_XLHeaderFooter},21:{f:parse_XLHeaderFooter},23:{f:parse_ExternSheet},24:{f:parse_Lbl},25:{f:parsebool},26:{},27:{},28:{f:parse_Note},29:{},34:{f:parsebool},35:{f:parse_ExternName},38:{f:parse_Xnum},39:{f:parse_Xnum},40:{f:parse_Xnum},41:{f:parse_Xnum},42:{f:parsebool},43:{f:parsebool},47:{f:parse_FilePass},49:{f:parse_Font},51:{f:parseuint16},60:{},61:{f:parse_Window1},64:{f:parsebool},65:{f:parse_Pane},66:{f:parseuint16},77:{},80:{},81:{},82:{},85:{f:parseuint16},89:{},90:{},91:{},92:{f:parse_WriteAccess},93:{f:parse_Obj},94:{},95:{f:parsebool},96:{},97:{},99:{f:parsebool},125:{f:parse_ColInfo},128:{f:parse_Guts},129:{f:parse_WsBool},130:{f:parseuint16},131:{f:parsebool},132:{f:parsebool},133:{f:parse_BoundSheet8},134:{},140:{f:parse_Country},141:{f:parseuint16},144:{},146:{f:parse_Palette},151:{},152:{},153:{},154:{},155:{},156:{f:parseuint16},157:{},158:{},160:{f:parse_Scl},161:{f:parse_Setup},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:parse_MulRk},190:{f:parse_MulBlank},193:{f:parsenoop2},197:{},198:{},199:{},200:{},201:{},202:{f:parsebool},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:parseuint16},220:{},221:{f:parsebool},222:{},224:{f:parse_XF},225:{f:parse_InterfaceHdr},226:{f:parsenoop2},227:{},229:{f:parse_MergeCells},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:parse_SST},253:{f:parse_LabelSst},255:{f:parse_ExtSST},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:parseuint16a},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:parsebool},353:{f:parsenoop2},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:parse_SupBook},431:{f:parsebool},432:{},433:{},434:{},437:{},438:{f:parse_TxO},439:{f:parsebool},440:{f:parse_HLink},441:{},442:{f:parse_XLUnicodeString},443:{},444:{f:parseuint16},445:{},446:{},448:{f:parsenoop2},449:{f:parse_RecalcId,r:2},450:{f:parsenoop2},512:{f:parse_Dimensions},513:{f:parse_Blank},515:{f:parse_Number},516:{f:parse_Label},517:{f:parse_BoolErr},519:{f:parse_String},520:{f:parse_Row},523:{},545:{f:parse_Array},549:{f:parse_DefaultRowHeight},566:{},574:{f:parse_Window2},638:{f:parse_RK},659:{},1048:{},1054:{f:parse_Format},1084:{},1212:{f:parse_ShrFmla},2048:{f:parse_HLinkTooltip},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:parse_BOF},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:parsenoop2},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:parse_XFCRC,r:12},2173:{f:parse_XFExt,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:parsebool,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:parse_NameCmt,r:12},2197:{},2198:{f:parse_Theme,r:12},2199:{},2200:{},2201:{},2202:{f:parse_MTRSettings,r:12},2203:{f:parsenoop2},2204:{},2205:{},2206:{},2207:{},2211:{f:parse_ForceFullCalculation},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:parseuint16},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:parse_ShtProps},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:parse_ClrtClient},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:parse_Dimensions},1:{},2:{f:parse_BIFF2INT},3:{f:parse_BIFF2NUM},4:{f:parse_BIFF2STR},5:{f:parse_BoolErr},7:{f:parse_BIFF2STRING},8:{},9:{f:parse_BOF},11:{},22:{f:parseuint16},30:{f:parse_BIFF2Format},31:{},32:{},33:{f:parse_Array},36:{},37:{f:parse_DefaultRowHeight},50:{f:parse_BIFF2FONTXTRA},62:{},52:{},67:{},68:{f:parseuint16},69:{},86:{},126:{},127:{f:parse_ImData},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:parse_RString},223:{},234:{},354:{},421:{},518:{f:parse_Formula},521:{f:parse_BOF},536:{f:parse_Lbl},547:{f:parse_ExternName},561:{},579:{},1030:{f:parse_Formula},1033:{f:parse_BOF},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},101:{},102:{},105:{},106:{},107:{},109:{},112:{},114:{},29282:{}};function write_biff_rec(n,r,_,E){var S=r;if(!isNaN(S)){var C=E||(_||[]).length||0,A=n.next(4);A.write_shift(2,S),A.write_shift(2,C),C>0&&is_buf(_)&&n.push(_)}}function write_biff_continue(n,r,_,E){var S=E||(_||[]).length||0;if(S<=8224)return write_biff_rec(n,r,_,S);var C=r;if(!isNaN(C)){for(var A=_.parts||[],I=0,B=0,O=0;O+(A[I]||8224)<=8224;)O+=A[I]||8224,I++;var N=n.next(4);for(N.write_shift(2,C),N.write_shift(2,O),n.push(_.slice(B,B+O)),B+=O;B<S;){for(N=n.next(4),N.write_shift(2,60),O=0;O+(A[I]||8224)<=8224;)O+=A[I]||8224,I++;N.write_shift(2,O),n.push(_.slice(B,B+O)),B+=O}}}function write_BIFF2Cell(n,r,_){return n||(n=new_buf(7)),n.write_shift(2,r),n.write_shift(2,_),n.write_shift(2,0),n.write_shift(1,0),n}function write_BIFF2BERR(n,r,_,E){var S=new_buf(9);return write_BIFF2Cell(S,n,r),write_Bes(_,E||"b",S),S}function write_BIFF2LABEL(n,r,_){var E=new_buf(8+2*_.length);return write_BIFF2Cell(E,n,r),E.write_shift(1,_.length),E.write_shift(_.length,_,"sbcs"),E.l<E.length?E.slice(0,E.l):E}function write_ws_biff2_cell(n,r,_,E){if(r.v!=null)switch(r.t){case"d":case"n":var S=r.t=="d"?datenum(parseDate(r.v)):r.v;S==(S|0)&&S>=0&&S<65536?write_biff_rec(n,2,write_BIFF2INT(_,E,S)):write_biff_rec(n,3,write_BIFF2NUM(_,E,S));return;case"b":case"e":write_biff_rec(n,5,write_BIFF2BERR(_,E,r.v,r.t));return;case"s":case"str":write_biff_rec(n,4,write_BIFF2LABEL(_,E,r.v==null?"":String(r.v).slice(0,255)));return}write_biff_rec(n,1,write_BIFF2Cell(null,_,E))}function write_ws_biff2(n,r,_,E){var S=r["!data"]!=null,C=safe_decode_range(r["!ref"]||"A1"),A="",I=[];if(C.e.c>255||C.e.r>16383){if(E.WTF)throw new Error("Range "+(r["!ref"]||"A1")+" exceeds format limit A1:IV16384");C.e.c=Math.min(C.e.c,255),C.e.r=Math.min(C.e.c,16383)}for(var B=[],O=C.s.c;O<=C.e.c;++O)I[O]=encode_col(O);for(var N=C.s.r;N<=C.e.r;++N)for(S&&(B=r["!data"][N]||[]),A=encode_row(N),O=C.s.c;O<=C.e.c;++O){var U=S?B[O]:r[I[O]+A];U&&write_ws_biff2_cell(n,U,N,O)}}function write_biff2_buf(n,r){for(var _=r||{},E=buf_array(),S=0,C=0;C<n.SheetNames.length;++C)n.SheetNames[C]==_.sheet&&(S=C);if(S==0&&_.sheet&&n.SheetNames[0]!=_.sheet)throw new Error("Sheet not found: "+_.sheet);return write_biff_rec(E,_.biff==4?1033:_.biff==3?521:9,write_BOF(n,16,_)),write_ws_biff2(E,n.Sheets[n.SheetNames[S]],S,_),write_biff_rec(E,10),E.end()}function write_FONTS_biff8(n,r,_){write_biff_rec(n,49,write_Font({sz:12,color:{theme:1},name:"Arial",family:2,scheme:"minor"},_))}function write_FMTS_biff8(n,r,_){r&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(E){for(var S=E[0];S<=E[1];++S)r[S]!=null&&write_biff_rec(n,1054,write_Format(S,r[S],_))})}function write_FEAT(n,r){var _=new_buf(19);_.write_shift(4,2151),_.write_shift(4,0),_.write_shift(4,0),_.write_shift(2,3),_.write_shift(1,1),_.write_shift(4,0),write_biff_rec(n,2151,_),_=new_buf(39),_.write_shift(4,2152),_.write_shift(4,0),_.write_shift(4,0),_.write_shift(2,3),_.write_shift(1,0),_.write_shift(4,0),_.write_shift(2,1),_.write_shift(4,4),_.write_shift(2,0),write_Ref8U(safe_decode_range(r["!ref"]||"A1"),_),_.write_shift(4,4),write_biff_rec(n,2152,_)}function write_CELLXFS_biff8(n,r){for(var _=0;_<16;++_)write_biff_rec(n,224,write_XF({numFmtId:0,style:!0},0,r));r.cellXfs.forEach(function(E){write_biff_rec(n,224,write_XF(E,0,r))})}function write_ws_biff8_hlinks(n,r){for(var _=0;_<r["!links"].length;++_){var E=r["!links"][_];write_biff_rec(n,440,write_HLink(E)),E[1].Tooltip&&write_biff_rec(n,2048,write_HLinkTooltip(E))}delete r["!links"]}function write_ws_cols_biff8(n,r){if(r){var _=0;r.forEach(function(E,S){++_<=256&&E&&write_biff_rec(n,125,write_ColInfo(col_obj_w(S,E),S))})}}function write_ws_biff8_cell(n,r,_,E,S){var C=16+get_cell_style(S.cellXfs,r,S);if(r.v==null&&!r.bf){write_biff_rec(n,513,write_XLSCell(_,E,C));return}if(r.bf)write_biff_rec(n,6,write_Formula(r,_,E,S,C));else switch(r.t){case"d":case"n":var A=r.t=="d"?datenum(parseDate(r.v)):r.v;write_biff_rec(n,515,write_Number(_,E,A,C));break;case"b":case"e":write_biff_rec(n,517,write_BoolErr(_,E,r.v,C,S,r.t));break;case"s":case"str":if(S.bookSST){var I=get_sst_id(S.Strings,r.v==null?"":String(r.v),S.revStrings);write_biff_rec(n,253,write_LabelSst(_,E,I,C))}else write_biff_rec(n,516,write_Label(_,E,(r.v==null?"":String(r.v)).slice(0,255),C,S));break;default:write_biff_rec(n,513,write_XLSCell(_,E,C))}}function write_ws_biff8(n,r,_){var E=buf_array(),S=_.SheetNames[n],C=_.Sheets[S]||{},A=(_||{}).Workbook||{},I=(A.Sheets||[])[n]||{},B=C["!data"]!=null,O=r.biff==8,N,U="",j=[],z=safe_decode_range(C["!ref"]||"A1"),Z=O?65536:16384;if(z.e.c>255||z.e.r>=Z){if(r.WTF)throw new Error("Range "+(C["!ref"]||"A1")+" exceeds format limit A1:IV16384");z.e.c=Math.min(z.e.c,255),z.e.r=Math.min(z.e.c,Z-1)}write_biff_rec(E,2057,write_BOF(_,16,r)),write_biff_rec(E,13,writeuint16(1)),write_biff_rec(E,12,writeuint16(100)),write_biff_rec(E,15,writebool(!0)),write_biff_rec(E,17,writebool(!1)),write_biff_rec(E,16,write_Xnum(.001)),write_biff_rec(E,95,writebool(!0)),write_biff_rec(E,42,writebool(!1)),write_biff_rec(E,43,writebool(!1)),write_biff_rec(E,130,writeuint16(1)),write_biff_rec(E,128,write_Guts([0,0])),write_biff_rec(E,131,writebool(!1)),write_biff_rec(E,132,writebool(!1)),O&&write_ws_cols_biff8(E,C["!cols"]),write_biff_rec(E,512,write_Dimensions(z,r)),O&&(C["!links"]=[]);for(var X=[],Q=[],se=z.s.c;se<=z.e.c;++se)j[se]=encode_col(se);for(var oe=z.s.r;oe<=z.e.r;++oe)for(B&&(Q=C["!data"][oe]||[]),U=encode_row(oe),se=z.s.c;se<=z.e.c;++se){N=j[se]+U;var ue=B?Q[se]:C[N];ue&&(write_ws_biff8_cell(E,ue,oe,se,r),O&&ue.l&&C["!links"].push([N,ue.l]),O&&ue.c&&X.push([N,ue.c]))}var we=I.CodeName||I.name||S;return O&&write_biff_rec(E,574,write_Window2((A.Views||[])[0])),O&&(C["!merges"]||[]).length&&write_biff_rec(E,229,write_MergeCells(C["!merges"])),O&&write_ws_biff8_hlinks(E,C),write_biff_rec(E,442,write_XLUnicodeString(we)),O&&write_FEAT(E,C),write_biff_rec(E,10),E.end()}function write_biff8_global(n,r,_){var E=buf_array(),S=(n||{}).Workbook||{},C=S.Sheets||[],A=S.WBProps||{},I=_.biff==8,B=_.biff==5;if(write_biff_rec(E,2057,write_BOF(n,5,_)),_.bookType=="xla"&&write_biff_rec(E,135),write_biff_rec(E,225,I?writeuint16(1200):null),write_biff_rec(E,193,writezeroes(2)),B&&write_biff_rec(E,191),B&&write_biff_rec(E,192),write_biff_rec(E,226),write_biff_rec(E,92,write_WriteAccess("SheetJS",_)),write_biff_rec(E,66,writeuint16(I?1200:1252)),I&&write_biff_rec(E,353,writeuint16(0)),I&&write_biff_rec(E,448),write_biff_rec(E,317,write_RRTabId(n.SheetNames.length)),I&&n.vbaraw&&write_biff_rec(E,211),I&&n.vbaraw){var O=A.CodeName||"ThisWorkbook";write_biff_rec(E,442,write_XLUnicodeString(O))}write_biff_rec(E,156,writeuint16(17)),write_biff_rec(E,25,writebool(!1)),write_biff_rec(E,18,writebool(!1)),write_biff_rec(E,19,writeuint16(0)),I&&write_biff_rec(E,431,writebool(!1)),I&&write_biff_rec(E,444,writeuint16(0)),write_biff_rec(E,61,write_Window1()),write_biff_rec(E,64,writebool(!1)),write_biff_rec(E,141,writeuint16(0)),write_biff_rec(E,34,writebool(safe1904(n)=="true")),write_biff_rec(E,14,writebool(!0)),I&&write_biff_rec(E,439,writebool(!1)),write_biff_rec(E,218,writeuint16(0)),write_FONTS_biff8(E,n,_),write_FMTS_biff8(E,n.SSF,_),write_CELLXFS_biff8(E,_),I&&write_biff_rec(E,352,writebool(!1));var N=E.end(),U=buf_array();I&&write_biff_rec(U,140,write_Country()),I&&_.Strings&&write_biff_continue(U,252,write_SST(_.Strings)),write_biff_rec(U,10);var j=U.end(),z=buf_array(),Z=0,X=0;for(X=0;X<n.SheetNames.length;++X)Z+=(I?12:11)+(I?2:1)*n.SheetNames[X].length;var Q=N.length+Z+j.length;for(X=0;X<n.SheetNames.length;++X){var se=C[X]||{};write_biff_rec(z,133,write_BoundSheet8({pos:Q,hs:se.Hidden||0,dt:0,name:n.SheetNames[X]},_)),Q+=r[X].length}var oe=z.end();if(Z!=oe.length)throw new Error("BS8 "+Z+" != "+oe.length);var ue=[];return N.length&&ue.push(N),oe.length&&ue.push(oe),j.length&&ue.push(j),bconcat(ue)}function write_biff8_buf(n,r){var _=r||{},E=[];n&&!n.SSF&&(n.SSF=dup(table_fmt)),n&&n.SSF&&(make_ssf(),SSF_load_table(n.SSF),_.revssf=evert_num(n.SSF),_.revssf[n.SSF[65535]]=0,_.ssf=n.SSF),_.Strings=[],_.Strings.Count=0,_.Strings.Unique=0,fix_write_opts(_),_.cellXfs=[],get_cell_style(_.cellXfs,{},{revssf:{General:0}}),n.Props||(n.Props={});for(var S=0;S<n.SheetNames.length;++S)E[E.length]=write_ws_biff8(S,_,n);return E.unshift(write_biff8_global(n,E,_)),bconcat(E)}function write_biff_buf(n,r){for(var _=0;_<=n.SheetNames.length;++_){var E=n.Sheets[n.SheetNames[_]];if(!(!E||!E["!ref"])){var S=decode_range(E["!ref"]);S.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+n.SheetNames[_]+"' extends beyond column IV (255).  Data may be lost.")}}var C=r||{};switch(C.biff||2){case 8:case 5:return write_biff8_buf(n,r);case 4:case 3:case 2:return write_biff2_buf(n,r)}throw new Error("invalid type "+C.bookType+" for BIFF")}function html_to_sheet(n,r){var _=r||{},E=_.dense!=null?_.dense:DENSE,S={};E&&(S["!data"]=[]),n=n.replace(/<!--.*?-->/g,"");var C=n.match(/<table/i);if(!C)throw new Error("Invalid HTML: could not find <table>");var A=n.match(/<\/table/i),I=C.index,B=A&&A.index||n.length,O=split_regex(n.slice(I,B),/(:?<tr[^>]*>)/i,"<tr>"),N=-1,U=0,j=0,z=0,Z={s:{r:1e7,c:1e7},e:{r:0,c:0}},X=[];for(I=0;I<O.length;++I){var Q=O[I].trim(),se=Q.slice(0,3).toLowerCase();if(se=="<tr"){if(++N,_.sheetRows&&_.sheetRows<=N){--N;break}U=0;continue}if(!(se!="<td"&&se!="<th")){var oe=Q.split(/<\/t[dh]>/i);for(B=0;B<oe.length;++B){var ue=oe[B].trim();if(ue.match(/<t[dh]/i)){for(var we=ue,Te=0;we.charAt(0)=="<"&&(Te=we.indexOf(">"))>-1;)we=we.slice(Te+1);for(var xe=0;xe<X.length;++xe){var Re=X[xe];Re.s.c==U&&Re.s.r<N&&N<=Re.e.r&&(U=Re.e.c+1,xe=-1)}var Ne=parsexmltag(ue.slice(0,ue.indexOf(">")));z=Ne.colspan?+Ne.colspan:1,((j=+Ne.rowspan)>1||z>1)&&X.push({s:{r:N,c:U},e:{r:N+(j||1)-1,c:U+z-1}});var Fe=Ne.t||Ne["data-t"]||"";if(!we.length){U+=z;continue}if(we=htmldecode(we),Z.s.r>N&&(Z.s.r=N),Z.e.r<N&&(Z.e.r=N),Z.s.c>U&&(Z.s.c=U),Z.e.c<U&&(Z.e.c=U),!we.length){U+=z;continue}var ht={t:"s",v:we};_.raw||!we.trim().length||Fe=="s"||(we==="TRUE"?ht={t:"b",v:!0}:we==="FALSE"?ht={t:"b",v:!1}:isNaN(fuzzynum(we))?isNaN(fuzzydate(we).getDate())||(ht={t:"d",v:parseDate(we)},_.cellDates||(ht={t:"n",v:datenum(ht.v)}),ht.z=_.dateNF||table_fmt[14]):ht={t:"n",v:fuzzynum(we)}),E?(S["!data"][N]||(S["!data"][N]=[]),S["!data"][N][U]=ht):S[encode_cell({r:N,c:U})]=ht,U+=z}}}}return S["!ref"]=encode_range(Z),X.length&&(S["!merges"]=X),S}function make_html_row(n,r,_,E){for(var S=n["!merges"]||[],C=[],A={},I=n["!data"]!=null,B=r.s.c;B<=r.e.c;++B){for(var O=0,N=0,U=0;U<S.length;++U)if(!(S[U].s.r>_||S[U].s.c>B)&&!(S[U].e.r<_||S[U].e.c<B)){if(S[U].s.r<_||S[U].s.c<B){O=-1;break}O=S[U].e.r-S[U].s.r+1,N=S[U].e.c-S[U].s.c+1;break}if(!(O<0)){var j=encode_col(B)+encode_row(_),z=I?(n["!data"][_]||[])[B]:n[j],Z=z&&z.v!=null&&(z.h||escapehtml(z.w||(format_cell(z),z.w)||""))||"";A={},O>1&&(A.rowspan=O),N>1&&(A.colspan=N),E.editable?Z='<span contenteditable="true">'+Z+"</span>":z&&(A["data-t"]=z&&z.t||"z",z.v!=null&&(A["data-v"]=z.v),z.z!=null&&(A["data-z"]=z.z),z.l&&(z.l.Target||"#").charAt(0)!="#"&&(Z='<a href="'+z.l.Target+'">'+Z+"</a>")),A.id=(E.id||"sjs")+"-"+j,C.push(writextag("td",Z,A))}}var X="<tr>";return X+C.join("")+"</tr>"}var HTML_BEGIN='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',HTML_END="</body></html>";function html_to_workbook(n,r){var _=n.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!_||_.length==0)throw new Error("Invalid HTML: could not find <table>");if(_.length==1){var E=sheet_to_workbook(html_to_sheet(_[0],r),r);return E.bookType="html",E}var S=book_new();return _.forEach(function(C,A){book_append_sheet(S,html_to_sheet(C,r),"Sheet"+(A+1))}),S.bookType="html",S}function make_html_preamble(n,r,_){var E=[];return E.join("")+"<table"+(_&&_.id?' id="'+_.id+'"':"")+">"}function sheet_to_html(n,r){var _=r||{},E=_.header!=null?_.header:HTML_BEGIN,S=_.footer!=null?_.footer:HTML_END,C=[E],A=decode_range(n["!ref"]);C.push(make_html_preamble(n,A,_));for(var I=A.s.r;I<=A.e.r;++I)C.push(make_html_row(n,A,I,_));return C.push("</table>"+S),C.join("")}function sheet_add_dom(n,r,_){var E=r.rows;if(!E)throw"Unsupported origin when "+r.tagName+" is not a TABLE";var S=_||{},C=n["!data"]!=null,A=0,I=0;if(S.origin!=null)if(typeof S.origin=="number")A=S.origin;else{var B=typeof S.origin=="string"?decode_cell(S.origin):S.origin;A=B.r,I=B.c}var O=Math.min(S.sheetRows||1e7,E.length),N={s:{r:0,c:0},e:{r:A,c:I}};if(n["!ref"]){var U=decode_range(n["!ref"]);N.s.r=Math.min(N.s.r,U.s.r),N.s.c=Math.min(N.s.c,U.s.c),N.e.r=Math.max(N.e.r,U.e.r),N.e.c=Math.max(N.e.c,U.e.c),A==-1&&(N.e.r=A=U.e.r+1)}var j=[],z=0,Z=n["!rows"]||(n["!rows"]=[]),X=0,Q=0,se=0,oe=0,ue=0,we=0;for(n["!cols"]||(n["!cols"]=[]);X<E.length&&Q<O;++X){var Te=E[X];if(is_dom_element_hidden(Te)){if(S.display)continue;Z[Q]={hidden:!0}}var xe=Te.cells;for(se=oe=0;se<xe.length;++se){var Re=xe[se];if(!(S.display&&is_dom_element_hidden(Re))){var Ne=Re.hasAttribute("data-v")?Re.getAttribute("data-v"):Re.hasAttribute("v")?Re.getAttribute("v"):htmldecode(Re.innerHTML),Fe=Re.getAttribute("data-z")||Re.getAttribute("z");for(z=0;z<j.length;++z){var ht=j[z];ht.s.c==oe+I&&ht.s.r<Q+A&&Q+A<=ht.e.r&&(oe=ht.e.c+1-I,z=-1)}we=+Re.getAttribute("colspan")||1,((ue=+Re.getAttribute("rowspan")||1)>1||we>1)&&j.push({s:{r:Q+A,c:oe+I},e:{r:Q+A+(ue||1)-1,c:oe+I+(we||1)-1}});var nt={t:"s",v:Ne},Ee=Re.getAttribute("data-t")||Re.getAttribute("t")||"";Ne!=null&&(Ne.length==0?nt.t=Ee||"z":S.raw||Ne.trim().length==0||Ee=="s"||(Ne==="TRUE"?nt={t:"b",v:!0}:Ne==="FALSE"?nt={t:"b",v:!1}:isNaN(fuzzynum(Ne))?isNaN(fuzzydate(Ne).getDate())||(nt={t:"d",v:parseDate(Ne)},S.cellDates||(nt={t:"n",v:datenum(nt.v)}),nt.z=S.dateNF||table_fmt[14]):nt={t:"n",v:fuzzynum(Ne)})),nt.z===void 0&&Fe!=null&&(nt.z=Fe);var Ce="",_e=Re.getElementsByTagName("A");if(_e&&_e.length)for(var Ie=0;Ie<_e.length&&!(_e[Ie].hasAttribute("href")&&(Ce=_e[Ie].getAttribute("href"),Ce.charAt(0)!="#"));++Ie);Ce&&Ce.charAt(0)!="#"&&Ce.slice(0,11).toLowerCase()!="javascript:"&&(nt.l={Target:Ce}),C?(n["!data"][Q+A]||(n["!data"][Q+A]=[]),n["!data"][Q+A][oe+I]=nt):n[encode_cell({c:oe+I,r:Q+A})]=nt,N.e.c<oe+I&&(N.e.c=oe+I),oe+=we}}++Q}return j.length&&(n["!merges"]=(n["!merges"]||[]).concat(j)),N.e.r=Math.max(N.e.r,Q-1+A),n["!ref"]=encode_range(N),Q>=O&&(n["!fullref"]=encode_range((N.e.r=E.length-X+Q-1+A,N))),n}function parse_dom_table(n,r){var _=r||{},E={};return _.dense&&(E["!data"]=[]),sheet_add_dom(E,n,r)}function table_to_book(n,r){var _=sheet_to_workbook(parse_dom_table(n,r),r);return _}function is_dom_element_hidden(n){var r="",_=get_get_computed_style_function(n);return _&&(r=_(n).getPropertyValue("display")),r||(r=n.style&&n.style.display),r==="none"}function get_get_computed_style_function(n){return n.ownerDocument.defaultView&&typeof n.ownerDocument.defaultView.getComputedStyle=="function"?n.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function parse_text_p(n){var r=n.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(E,S){return Array(parseInt(S,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),_=unescapexml(r.replace(/<[^>]*>/g,""));return[_]}function parse_ods_styles(n,r,_){var E=_||{},S=xlml_normalize(n);xlmlregex.lastIndex=0,S=S.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");for(var C,A,I="",B="",O,N=0,U=-1,j="";C=xlmlregex.exec(S);)switch(C[3]=C[3].replace(/_.*$/,"")){case"number-style":case"currency-style":case"percentage-style":case"date-style":case"time-style":case"text-style":C[1]==="/"?(A["truncate-on-overflow"]=="false"&&(I.match(/h/)?I=I.replace(/h+/,"[$&]"):I.match(/m/)?I=I.replace(/m+/,"[$&]"):I.match(/s/)&&(I=I.replace(/s+/,"[$&]"))),E[A.name]=I,I=""):C[0].charAt(C[0].length-2)!=="/"&&(I="",A=parsexmltag(C[0],!1));break;case"boolean-style":C[1]==="/"?(E[A.name]="General",I=""):C[0].charAt(C[0].length-2)!=="/"&&(I="",A=parsexmltag(C[0],!1));break;case"boolean":I+="General";break;case"text":C[1]==="/"?(j=S.slice(U,xlmlregex.lastIndex-C[0].length),j=="%"&&A[0]=="<number:percentage-style"?I+="%":I+='"'+j.replace(/"/g,'""')+'"'):C[0].charAt(C[0].length-2)!=="/"&&(U=xlmlregex.lastIndex);break;case"day":switch(O=parsexmltag(C[0],!1),O.style){case"short":I+="d";break;case"long":I+="dd";break;default:I+="dd";break}break;case"day-of-week":switch(O=parsexmltag(C[0],!1),O.style){case"short":I+="ddd";break;case"long":I+="dddd";break;default:I+="ddd";break}break;case"era":switch(O=parsexmltag(C[0],!1),O.style){case"short":I+="ee";break;case"long":I+="eeee";break;default:I+="eeee";break}break;case"hours":switch(O=parsexmltag(C[0],!1),O.style){case"short":I+="h";break;case"long":I+="hh";break;default:I+="hh";break}break;case"minutes":switch(O=parsexmltag(C[0],!1),O.style){case"short":I+="m";break;case"long":I+="mm";break;default:I+="mm";break}break;case"month":switch(O=parsexmltag(C[0],!1),O.textual&&(I+="mm"),O.style){case"short":I+="m";break;case"long":I+="mm";break;default:I+="m";break}break;case"seconds":{switch(O=parsexmltag(C[0],!1),O.style){case"short":I+="s";break;case"long":I+="ss";break;default:I+="ss";break}O["decimal-places"]&&(I+="."+fill("0",+O["decimal-places"]))}break;case"year":switch(O=parsexmltag(C[0],!1),O.style){case"short":I+="yy";break;case"long":I+="yyyy";break;default:I+="yy";break}break;case"am-pm":I+="AM/PM";break;case"week-of-year":case"quarter":console.error("Excel does not support ODS format token "+C[3]);break;case"fill-character":C[1]==="/"?(j=S.slice(U,xlmlregex.lastIndex-C[0].length),I+='"'+j.replace(/"/g,'""')+'"*'):C[0].charAt(C[0].length-2)!=="/"&&(U=xlmlregex.lastIndex);break;case"scientific-number":O=parsexmltag(C[0],!1),I+="0."+fill("0",+O["min-decimal-places"]||+O["decimal-places"]||2)+fill("?",+O["decimal-places"]-+O["min-decimal-places"]||0)+"E"+(parsexmlbool(O["forced-exponent-sign"])?"+":"")+fill("0",+O["min-exponent-digits"]||2);break;case"fraction":O=parsexmltag(C[0],!1),+O["min-integer-digits"]?I+=fill("0",+O["min-integer-digits"]):I+="#",I+=" ",I+=fill("?",+O["min-numerator-digits"]||1),I+="/",+O["denominator-value"]?I+=O["denominator-value"]:I+=fill("?",+O["min-denominator-digits"]||1);break;case"currency-symbol":C[1]==="/"?I+='"'+S.slice(U,xlmlregex.lastIndex-C[0].length).replace(/"/g,'""')+'"':C[0].charAt(C[0].length-2)!=="/"?U=xlmlregex.lastIndex:I+="$";break;case"text-properties":switch(O=parsexmltag(C[0],!1),(O.color||"").toLowerCase().replace("#","")){case"ff0000":case"red":I="[Red]"+I;break}break;case"text-content":I+="@";break;case"map":O=parsexmltag(C[0],!1),unescapexml(O.condition)=="value()>=0"?I=E[O["apply-style-name"]]+";"+I:console.error("ODS number format may be incorrect: "+O.condition);break;case"number":if(C[1]==="/")break;O=parsexmltag(C[0],!1),B="",B+=fill("0",+O["min-integer-digits"]||1),parsexmlbool(O.grouping)&&(B=commaify(fill("#",Math.max(0,4-B.length))+B)),(+O["min-decimal-places"]||+O["decimal-places"])&&(B+="."),+O["min-decimal-places"]&&(B+=fill("0",+O["min-decimal-places"]||1)),+O["decimal-places"]-(+O["min-decimal-places"]||0)&&(B+=fill("0",+O["decimal-places"]-(+O["min-decimal-places"]||0))),I+=B;break;case"embedded-text":C[1]==="/"?N==0?I+='"'+S.slice(U,xlmlregex.lastIndex-C[0].length).replace(/"/g,'""')+'"':I=I.slice(0,N)+'"'+S.slice(U,xlmlregex.lastIndex-C[0].length).replace(/"/g,'""')+'"'+I.slice(N):C[0].charAt(C[0].length-2)!=="/"&&(U=xlmlregex.lastIndex,N=-+parsexmltag(C[0],!1).position||0);break}return E}function parse_content_xml(n,r,_){var E=r||{},S=xlml_normalize(n),C=[],A,I,B,O="",N=0,U,j,z={},Z=[],X={};E.dense&&(X["!data"]=[]);var Q,se,oe={value:""},ue="",we=0,Te=[],xe=-1,Re=-1,Ne={s:{r:1e6,c:1e7},e:{r:0,c:0}},Fe=0,ht=_||{},nt={},Ee=[],Ce={},_e=0,Ie=0,He=[],Be=1,Ge=1,je=[],Ve={Names:[],WBProps:{}},Pe={},Me=["",""],tt=[],Ke={},mt="",ct=0,Qe=!1,dt=!1,vt=0,At=0;for(xlmlregex.lastIndex=0,S=S.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");Q=xlmlregex.exec(S);)switch(Q[3]=Q[3].replace(/_.*$/,"")){case"table":case"":Q[1]==="/"?(Ne.e.c>=Ne.s.c&&Ne.e.r>=Ne.s.r?X["!ref"]=encode_range(Ne):X["!ref"]="A1:A1",E.sheetRows>0&&E.sheetRows<=Ne.e.r&&(X["!fullref"]=X["!ref"],Ne.e.r=E.sheetRows-1,X["!ref"]=encode_range(Ne)),Ee.length&&(X["!merges"]=Ee),He.length&&(X["!rows"]=He),U.name=U.||U.name,typeof JSON<"u"&&JSON.stringify(U),Z.push(U.name),z[U.name]=X,dt=!1):Q[0].charAt(Q[0].length-2)!=="/"&&(U=parsexmltag(Q[0],!1),xe=Re=-1,Ne.s.r=Ne.s.c=1e7,Ne.e.r=Ne.e.c=0,X={},E.dense&&(X["!data"]=[]),Ee=[],He=[],dt=!0);break;case"table-row-group":Q[1]==="/"?--Fe:++Fe;break;case"table-row":case"":if(Q[1]==="/"){xe+=Be,Be=1;break}if(j=parsexmltag(Q[0],!1),j.?xe=j.-1:xe==-1&&(xe=0),Be=+j["number-rows-repeated"]||1,Be<10)for(vt=0;vt<Be;++vt)Fe>0&&(He[xe+vt]={level:Fe});Re=-1;break;case"covered-table-cell":Q[1]!=="/"&&++Re,E.sheetStubs&&(E.dense?(X["!data"][xe]||(X["!data"][xe]=[]),X["!data"][xe][Re]={t:"z"}):X[encode_cell({r:xe,c:Re})]={t:"z"}),ue="",Te=[];break;case"table-cell":case"":if(Q[0].charAt(Q[0].length-2)==="/")++Re,oe=parsexmltag(Q[0],!1),Ge=parseInt(oe["number-columns-repeated"]||"1",10),se={t:"z",v:null},oe.formula&&E.cellFormula!=!1&&(se.f=ods_to_csf_formula(unescapexml(oe.formula))),oe["style-name"]&&nt[oe["style-name"]]&&(se.z=nt[oe["style-name"]]),(oe.||oe["value-type"])=="string"&&(se.t="s",se.v=unescapexml(oe["string-value"]||""),E.dense?(X["!data"][xe]||(X["!data"][xe]=[]),X["!data"][xe][Re]=se):X[encode_col(Re)+encode_row(xe)]=se),Re+=Ge-1;else if(Q[1]!=="/"){++Re,ue="",we=0,Te=[],Ge=1;var bt=Be?xe+Be-1:xe;if(Re>Ne.e.c&&(Ne.e.c=Re),Re<Ne.s.c&&(Ne.s.c=Re),xe<Ne.s.r&&(Ne.s.r=xe),bt>Ne.e.r&&(Ne.e.r=bt),oe=parsexmltag(Q[0],!1),tt=[],Ke={},se={t:oe.||oe["value-type"],v:null},oe["style-name"]&&nt[oe["style-name"]]&&(se.z=nt[oe["style-name"]]),E.cellFormula)if(oe.formula&&(oe.formula=unescapexml(oe.formula)),oe["number-matrix-columns-spanned"]&&oe["number-matrix-rows-spanned"]&&(_e=parseInt(oe["number-matrix-rows-spanned"],10)||0,Ie=parseInt(oe["number-matrix-columns-spanned"],10)||0,Ce={s:{r:xe,c:Re},e:{r:xe+_e-1,c:Re+Ie-1}},se.F=encode_range(Ce),je.push([Ce,se.F])),oe.formula)se.f=ods_to_csf_formula(oe.formula);else for(vt=0;vt<je.length;++vt)xe>=je[vt][0].s.r&&xe<=je[vt][0].e.r&&Re>=je[vt][0].s.c&&Re<=je[vt][0].e.c&&(se.F=je[vt][1]);switch((oe["number-columns-spanned"]||oe["number-rows-spanned"])&&(_e=parseInt(oe["number-rows-spanned"],10)||0,Ie=parseInt(oe["number-columns-spanned"],10)||0,Ce={s:{r:xe,c:Re},e:{r:xe+_e-1,c:Re+Ie-1}},Ee.push(Ce)),oe["number-columns-repeated"]&&(Ge=parseInt(oe["number-columns-repeated"],10)),se.t){case"boolean":se.t="b",se.v=parsexmlbool(oe["boolean-value"])||+oe["boolean-value"]>=1;break;case"float":se.t="n",se.v=parseFloat(oe.value);break;case"percentage":se.t="n",se.v=parseFloat(oe.value);break;case"currency":se.t="n",se.v=parseFloat(oe.value);break;case"date":se.t="d",se.v=parseDate(oe["date-value"]),E.cellDates||(se.t="n",se.v=datenum(se.v,Ve.WBProps.date1904)-At),se.z||(se.z="m/d/yy");break;case"time":se.t="n",se.v=parse_isodur(oe["time-value"])/86400,E.cellDates&&(se.t="d",se.v=numdate(se.v)),se.z||(se.z="HH:MM:SS");break;case"number":se.t="n",se.v=parseFloat(oe.);break;default:if(se.t==="string"||se.t==="text"||!se.t)se.t="s",oe["string-value"]!=null&&(ue=unescapexml(oe["string-value"]),Te=[]);else throw new Error("Unsupported value type "+se.t)}}else{if(Qe=!1,se.t==="s"&&(se.v=ue||"",Te.length&&(se.R=Te),Qe=we==0),Pe.Target&&(se.l=Pe),tt.length>0&&(se.c=tt,tt=[]),ue&&E.cellText!==!1&&(se.w=ue),Qe&&(se.t="z",delete se.v),(!Qe||E.sheetStubs)&&!(E.sheetRows&&E.sheetRows<=xe))for(var ft=0;ft<Be;++ft){if(Ge=parseInt(oe["number-columns-repeated"]||"1",10),E.dense)for(X["!data"][xe+ft]||(X["!data"][xe+ft]=[]),X["!data"][xe+ft][Re]=ft==0?se:dup(se);--Ge>0;)X["!data"][xe+ft][Re+Ge]=dup(se);else for(X[encode_cell({r:xe+ft,c:Re})]=se;--Ge>0;)X[encode_cell({r:xe+ft,c:Re+Ge})]=dup(se);Ne.e.c<=Re&&(Ne.e.c=Re)}Ge=parseInt(oe["number-columns-repeated"]||"1",10),Re+=Ge-1,Ge=0,se={},ue="",Te=[]}Pe={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(Q[1]==="/"){if((A=C.pop())[0]!==Q[3])throw"Bad state: "+A}else Q[0].charAt(Q[0].length-2)!=="/"&&C.push([Q[3],!0]);break;case"annotation":if(Q[1]==="/"){if((A=C.pop())[0]!==Q[3])throw"Bad state: "+A;Ke.t=ue,Te.length&&(Ke.R=Te),Ke.a=mt,tt.push(Ke)}else Q[0].charAt(Q[0].length-2)!=="/"&&C.push([Q[3],!1]);mt="",ct=0,ue="",we=0,Te=[];break;case"creator":Q[1]==="/"?mt=S.slice(ct,Q.index):ct=Q.index+Q[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(Q[1]==="/"){if((A=C.pop())[0]!==Q[3])throw"Bad state: "+A}else Q[0].charAt(Q[0].length-2)!=="/"&&C.push([Q[3],!1]);ue="",we=0,Te=[];break;case"scientific-number":case"currency-symbol":case"fill-character":break;case"text-style":case"boolean-style":case"number-style":case"currency-style":case"percentage-style":case"date-style":case"time-style":if(Q[1]==="/"){var Et=xlmlregex.lastIndex;parse_ods_styles(S.slice(B,xlmlregex.lastIndex),r,ht),xlmlregex.lastIndex=Et}else Q[0].charAt(Q[0].length-2)!=="/"&&(B=xlmlregex.lastIndex-Q[0].length);break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":{var Ye=parsexmltag(Q[0],!1);Ye.family=="table-cell"&&ht[Ye["data-style-name"]]&&(nt[Ye.name]=ht[Ye["data-style-name"]])}break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":break;case"boolean":break;case"text":if(Q[0].slice(-2)==="/>")break;if(Q[1]==="/")switch(C[C.length-1][0]){case"number-style":case"date-style":case"time-style":O+=S.slice(N,Q.index);break}else N=Q.index+Q[0].length;break;case"named-range":I=parsexmltag(Q[0],!1),Me=ods_to_csf_3D(I["cell-range-address"]);var Ct={Name:I.name,Ref:Me[0]+"!"+Me[1]};dt&&(Ct.Sheet=Z.length),Ve.Names.push(Ct);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":switch(I=parsexmltag(Q[0],!1),I["date-value"]){case"1904-01-01":Ve.WBProps.date1904=!0;case"1900-01-01":At=0}break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(C[C.length-1][0])>-1)break;if(Q[1]==="/"&&(!oe||!oe["string-value"])){var Pt=parse_text_p(S.slice(we,Q.index));ue=(ue.length>0?ue+`
`:"")+Pt[0]}else parsexmltag(Q[0],!1),we=Q.index+Q[0].length;break;case"s":break;case"database-range":if(Q[1]==="/")break;try{Me=ods_to_csf_3D(parsexmltag(Q[0])["target-range-address"]),z[Me[0]]["!autofilter"]={ref:Me[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(Q[1]!=="/"){if(Pe=parsexmltag(Q[0],!1),!Pe.href)break;Pe.Target=unescapexml(Pe.href),delete Pe.href,Pe.Target.charAt(0)=="#"&&Pe.Target.indexOf(".")>-1?(Me=ods_to_csf_3D(Pe.Target.slice(1)),Pe.Target="#"+Me[0]+"!"+Me[1]):Pe.Target.match(/^\.\.[\\\/]/)&&(Pe.Target=Pe.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(Q[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(E.WTF)throw new Error(Q)}}var St={Sheets:z,SheetNames:Z,Workbook:Ve};return E.bookSheets&&delete St.Sheets,St}function parse_ods(n,r){r=r||{},safegetzipfile(n,"META-INF/manifest.xml")&&parse_manifest(getzipdata(n,"META-INF/manifest.xml"),r);var _=getzipstr(n,"styles.xml"),E=_&&parse_ods_styles(utf8read(_)),S=getzipstr(n,"content.xml");if(!S)throw new Error("Missing content.xml in ODS / UOF file");var C=parse_content_xml(utf8read(S),r,E);return safegetzipfile(n,"meta.xml")&&(C.Props=parse_core_props(getzipdata(n,"meta.xml"))),C.bookType="ods",C}function parse_fods(n,r){var _=parse_content_xml(n,r);return _.bookType="fods",_}var write_styles_ods=function(){var n=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),r="<office:document-styles "+wxt_helper({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+n+"</office:document-styles>";return function(){return XML_HEADER+r}}();function write_number_format_ods(n,r){var _="number",E="",S={"style:name":r},C="",A=0;n=n.replace(/"[$]"/g,"$");e:{if(n.indexOf(";")>-1&&(console.error("Unsupported ODS Style Map exported.  Using first branch of "+n),n=n.slice(0,n.indexOf(";"))),n=="@"){_="text",E="<number:text-content/>";break e}if(n.indexOf(/\$/)>-1&&(_="currency"),n[A]=='"'){for(C="";n[++A]!='"'||n[++A]=='"';)C+=n[A];--A,n[A+1]=="*"?(A++,E+="<number:fill-character>"+escapexml(C.replace(/""/g,'"'))+"</number:fill-character>"):E+="<number:text>"+escapexml(C.replace(/""/g,'"'))+"</number:text>",n=n.slice(A+1),A=0}var I=n.match(/# (\?+)\/(\?+)/);if(I){E+=writextag("number:fraction",null,{"number:min-integer-digits":0,"number:min-numerator-digits":I[1].length,"number:max-denominator-value":Math.max(+I[1].replace(/./g,"9"),+I[2].replace(/./g,"9"))});break e}if(I=n.match(/# (\?+)\/(\d+)/)){E+=writextag("number:fraction",null,{"number:min-integer-digits":0,"number:min-numerator-digits":I[1].length,"number:denominator-value":+I[2]});break e}if(I=n.match(/(\d+)(|\.\d+)%/)){_="percentage",E+=writextag("number:number",null,{"number:decimal-places":I[2]&&I.length-1||0,"number:min-decimal-places":I[2]&&I.length-1||0,"number:min-integer-digits":I[1].length})+"<number:text>%</number:text>";break e}var B=!1;if(["y","m","d"].indexOf(n[0])>-1){_="date";t:for(;A<n.length;++A)switch(C=n[A].toLowerCase()){case"h":case"s":B=!0,--A;break t;case"m":r:for(var O=A+1;O<n.length;++O)switch(n[O]){case"y":case"d":break r;case"h":case"s":B=!0,--A;break t}case"y":case"d":for(;(n[++A]||"").toLowerCase()==C[0];)C+=C[0];switch(--A,C){case"y":case"yy":E+="<number:year/>";break;case"yyy":case"yyyy":E+='<number:year number:style="long"/>';break;case"mmmmm":console.error("ODS has no equivalent of format |mmmmm|");case"m":case"mm":case"mmm":case"mmmm":E+='<number:month number:style="'+(C.length%2?"short":"long")+'" number:textual="'+(C.length>=3?"true":"false")+'"/>';break;case"d":case"dd":E+='<number:day number:style="'+(C.length%2?"short":"long")+'"/>';break;case"ddd":case"dddd":E+='<number:day-of-week number:style="'+(C.length%2?"short":"long")+'"/>';break}break;case'"':for(;n[++A]!='"'||n[++A]=='"';)C+=n[A];--A,E+="<number:text>"+escapexml(C.slice(1).replace(/""/g,'"'))+"</number:text>";break;case"/":E+="<number:text>"+escapexml(C)+"</number:text>";break;default:console.error("unrecognized character "+C+" in ODF format "+n)}if(!B)break e;n=n.slice(A+1),A=0}if(n.match(/^\[?[hms]/)){for(_=="number"&&(_="time"),n.match(/\[/)&&(n=n.replace(/[\[\]]/g,""),S["number:truncate-on-overflow"]="false");A<n.length;++A)switch(C=n[A].toLowerCase()){case"h":case"m":case"s":for(;(n[++A]||"").toLowerCase()==C[0];)C+=C[0];switch(--A,C){case"h":case"hh":E+='<number:hours number:style="'+(C.length%2?"short":"long")+'"/>';break;case"m":case"mm":E+='<number:minutes number:style="'+(C.length%2?"short":"long")+'"/>';break;case"s":case"ss":if(n[A+1]==".")do C+=n[A+1],++A;while(n[A+1]=="0");E+='<number:seconds number:style="'+(C.match("ss")?"long":"short")+'"'+(C.match(/\./)?' number:decimal-places="'+(C.match(/0+/)||[""])[0].length+'"':"")+"/>";break}break;case'"':for(;n[++A]!='"'||n[++A]=='"';)C+=n[A];--A,E+="<number:text>"+escapexml(C.slice(1).replace(/""/g,'"'))+"</number:text>";break;case"/":E+="<number:text>"+escapexml(C)+"</number:text>";break;case"a":if(n.slice(A,A+3).toLowerCase()=="a/p"){E+="<number:am-pm/>",A+=2;break}if(n.slice(A,A+5).toLowerCase()=="am/pm"){E+="<number:am-pm/>",A+=4;break}default:console.error("unrecognized character "+C+" in ODF format "+n)}break e}if(n.indexOf(/\$/)>-1&&(_="currency"),n[0]=="$"&&(E+='<number:currency-symbol number:language="en" number:country="US">$</number:currency-symbol>',n=n.slice(1),A=0),A=0,n[A]=='"'){for(;n[++A]!='"'||n[++A]=='"';)C+=n[A];--A,n[A+1]=="*"?(A++,E+="<number:fill-character>"+escapexml(C.replace(/""/g,'"'))+"</number:fill-character>"):E+="<number:text>"+escapexml(C.replace(/""/g,'"'))+"</number:text>",n=n.slice(A+1),A=0}var N=n.match(/([#0][0#,]*)(\.[0#]*|)(E[+]?0*|)/i);if(!N||!N[0])console.error("Could not find numeric part of "+n);else{var U=N[1].replace(/,/g,"");E+="<number:"+(N[3]?"scientific-":"")+'number number:min-integer-digits="'+(U.indexOf("0")==-1?"0":U.length-U.indexOf("0"))+'"'+(N[0].indexOf(",")>-1?' number:grouping="true"':"")+(N[2]&&' number:decimal-places="'+(N[2].length-1)+'"'||' number:decimal-places="0"')+(N[3]&&N[3].indexOf("+")>-1?' number:forced-exponent-sign="true"':"")+(N[3]?' number:min-exponent-digits="'+N[3].match(/0+/)[0].length+'"':"")+"></number:"+(N[3]?"scientific-":"")+"number>",A=N.index+N[0].length}if(n[A]=='"'){for(C="";n[++A]!='"'||n[++A]=='"';)C+=n[A];--A,E+="<number:text>"+escapexml(C.replace(/""/g,'"'))+"</number:text>"}}return E?writextag("number:"+_+"-style",E,S):(console.error("Could not generate ODS number format for |"+n+"|"),"")}function write_names_ods(n,r,_){var E=n.filter(function(S){return S.Sheet==(_==-1?null:_)});return E.length?`      <table:named-expressions>
`+E.map(function(S){var C=csf_to_ods_3D(S.Ref);return"        "+writextag("table:named-range",null,{"table:name":S.Name,"table:cell-range-address":C,"table:base-cell-address":C.replace(/[\.]?[^\.]*$/,".$A$1")})}).join(`
`)+`
      </table:named-expressions>
`:""}var write_content_ods=function(){var n=function(C){return escapexml(C).replace(/  +/g,function(A){return'<text:s text:c="'+A.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},r=`          <table:table-cell />
`,_=`          <table:covered-table-cell/>
`,E=function(C,A,I,B,O){var N=[];N.push('      <table:table table:name="'+escapexml(A.SheetNames[I])+`" table:style-name="ta1">
`);var U=0,j=0,z=decode_range(C["!ref"]||"A1"),Z=C["!merges"]||[],X=0,Q=C["!data"]!=null;if(C["!cols"])for(j=0;j<=z.e.c;++j)N.push("        <table:table-column"+(C["!cols"][j]?' table:style-name="co'+C["!cols"][j].ods+'"':"")+`></table:table-column>
`);var se="",oe=C["!rows"]||[];for(U=0;U<z.s.r;++U)se=oe[U]?' table:style-name="ro'+oe[U].ods+'"':"",N.push("        <table:table-row"+se+`></table:table-row>
`);for(;U<=z.e.r;++U){for(se=oe[U]?' table:style-name="ro'+oe[U].ods+'"':"",N.push("        <table:table-row"+se+`>
`),j=0;j<z.s.c;++j)N.push(r);for(;j<=z.e.c;++j){var ue=!1,we={},Te="";for(X=0;X!=Z.length;++X)if(!(Z[X].s.c>j)&&!(Z[X].s.r>U)&&!(Z[X].e.c<j)&&!(Z[X].e.r<U)){(Z[X].s.c!=j||Z[X].s.r!=U)&&(ue=!0),we["table:number-columns-spanned"]=Z[X].e.c-Z[X].s.c+1,we["table:number-rows-spanned"]=Z[X].e.r-Z[X].s.r+1;break}if(ue){N.push(_);continue}var xe=encode_cell({r:U,c:j}),Re=Q?(C["!data"][U]||[])[j]:C[xe];if(Re&&Re.f&&(we["table:formula"]=escapexml(csf_to_ods_formula(Re.f)),Re.F&&Re.F.slice(0,xe.length)==xe)){var Ne=decode_range(Re.F);we["table:number-matrix-columns-spanned"]=Ne.e.c-Ne.s.c+1,we["table:number-matrix-rows-spanned"]=Ne.e.r-Ne.s.r+1}if(!Re){N.push(r);continue}switch(Re.t){case"b":Te=Re.v?"TRUE":"FALSE",we["office:value-type"]="boolean",we["office:boolean-value"]=Re.v?"true":"false";break;case"n":Te=Re.w||String(Re.v||0),we["office:value-type"]="float",we["office:value"]=Re.v||0;break;case"s":case"str":Te=Re.v==null?"":Re.v,we["office:value-type"]="string";break;case"d":Te=Re.w||parseDate(Re.v).toISOString(),we["office:value-type"]="date",we["office:date-value"]=parseDate(Re.v).toISOString(),we["table:style-name"]="ce1";break;default:N.push(r);continue}var Fe=n(Te);if(Re.l&&Re.l.Target){var ht=Re.l.Target;ht=ht.charAt(0)=="#"?"#"+csf_to_ods_3D(ht.slice(1)):ht,ht.charAt(0)!="#"&&!ht.match(/^\w+:/)&&(ht="../"+ht),Fe=writextag("text:a",Fe,{"xlink:href":ht.replace(/&/g,"&amp;")})}O[Re.z]&&(we["table:style-name"]="ce"+O[Re.z].slice(1)),N.push("          "+writextag("table:table-cell",writextag("text:p",Fe,{}),we)+`
`)}N.push(`        </table:table-row>
`)}return(A.Workbook||{}).Names&&N.push(write_names_ods(A.Workbook.Names,A.SheetNames,I)),N.push(`      </table:table>
`),N.join("")},S=function(C,A){C.push(` <office:automatic-styles>
`);var I=0;A.SheetNames.map(function(U){return A.Sheets[U]}).forEach(function(U){if(U&&U["!cols"]){for(var j=0;j<U["!cols"].length;++j)if(U["!cols"][j]){var z=U["!cols"][j];if(z.width==null&&z.wpx==null&&z.wch==null)continue;process_col(z),z.ods=I;var Z=U["!cols"][j].wpx+"px";C.push('  <style:style style:name="co'+I+`" style:family="table-column">
`),C.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+Z+`"/>
`),C.push(`  </style:style>
`),++I}}});var B=0;A.SheetNames.map(function(U){return A.Sheets[U]}).forEach(function(U){if(U&&U["!rows"]){for(var j=0;j<U["!rows"].length;++j)if(U["!rows"][j]){U["!rows"][j].ods=B;var z=U["!rows"][j].hpx+"px";C.push('  <style:style style:name="ro'+B+`" style:family="table-row">
`),C.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+z+`"/>
`),C.push(`  </style:style>
`),++B}}}),C.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),C.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),C.push(`  </style:style>
`),C.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),C.push(`   <number:month number:style="long"/>
`),C.push(`   <number:text>/</number:text>
`),C.push(`   <number:day number:style="long"/>
`),C.push(`   <number:text>/</number:text>
`),C.push(`   <number:year/>
`),C.push(`  </number:date-style>
`);var O={},N=69;return A.SheetNames.map(function(U){return A.Sheets[U]}).forEach(function(U){if(U)for(var j=U["!data"]!=null,z=decode_range(U["!ref"]),Z=0;Z<=z.e.r;++Z)for(var X=0;X<=z.e.c;++X){var Q=j?(U["!data"][Z]||[])[X]:U[encode_cell({r:Z,c:X})];if(!(!Q||!Q.z||Q.z.toLowerCase()=="general")&&!O[Q.z]){var se=write_number_format_ods(Q.z,"N"+N);se&&(O[Q.z]="N"+N,++N,C.push(se+`
`))}}}),C.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),keys(O).forEach(function(U){C.push('<style:style style:name="ce'+O[U].slice(1)+'" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="'+O[U]+`"/>
`)}),C.push(` </office:automatic-styles>
`),O};return function(A,I){var B=[XML_HEADER],O=wxt_helper({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),N=wxt_helper({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});I.bookType=="fods"?(B.push("<office:document"+O+N+`>
`),B.push(write_meta_ods().replace(/<office:document-meta.*?>/,"").replace(/<\/office:document-meta>/,"")+`
`)):B.push("<office:document-content"+O+`>
`);var U=S(B,A);B.push(`  <office:body>
`),B.push(`    <office:spreadsheet>
`),((A.Workbook||{}).WBProps||{}).date1904&&B.push(`      <table:calculation-settings table:case-sensitive="false" table:search-criteria-must-apply-to-whole-cell="true" table:use-wildcards="true" table:use-regular-expressions="false" table:automatic-find-labels="false">
        <table:null-date table:date-value="1904-01-01"/>
      </table:calculation-settings>
`);for(var j=0;j!=A.SheetNames.length;++j)B.push(E(A.Sheets[A.SheetNames[j]],A,j,I,U));return(A.Workbook||{}).Names&&B.push(write_names_ods(A.Workbook.Names,A.SheetNames,-1)),B.push(`    </office:spreadsheet>
`),B.push(`  </office:body>
`),I.bookType=="fods"?B.push("</office:document>"):B.push("</office:document-content>"),B.join("")}}();function write_ods(n,r){if(r.bookType=="fods")return write_content_ods(n,r);var _=zip_new(),E="",S=[],C=[];return E="mimetype",zip_add_file(_,E,"application/vnd.oasis.opendocument.spreadsheet"),E="content.xml",zip_add_file(_,E,write_content_ods(n,r)),S.push([E,"text/xml"]),C.push([E,"ContentFile"]),E="styles.xml",zip_add_file(_,E,write_styles_ods(n,r)),S.push([E,"text/xml"]),C.push([E,"StylesFile"]),E="meta.xml",zip_add_file(_,E,XML_HEADER+write_meta_ods()),S.push([E,"text/xml"]),C.push([E,"MetadataFile"]),E="manifest.rdf",zip_add_file(_,E,write_rdf(C)),S.push([E,"application/rdf+xml"]),E="META-INF/manifest.xml",zip_add_file(_,E,write_manifest(S)),_}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */var subarray=function(){try{return typeof Uint8Array>"u"||typeof Uint8Array.prototype.subarray>"u"?"slice":typeof Buffer<"u"?typeof Buffer.prototype.subarray>"u"?"slice":(typeof Buffer.from=="function"?Buffer.from([72,62]):new Buffer([72,62]))instanceof Uint8Array?"subarray":"slice":"subarray"}catch{return"slice"}}();function u8_to_dataview(n){return new DataView(n.buffer,n.byteOffset,n.byteLength)}function u8str(n){return typeof TextDecoder<"u"?new TextDecoder().decode(n):utf8read(a2s(n))}function stru8(n){return typeof TextEncoder<"u"?new TextEncoder().encode(n):s2a(utf8write(n))}function u8concat(n){for(var r=0,_=0;_<n.length;++_)r+=n[_].length;var E=new Uint8Array(r),S=0;for(_=0;_<n.length;++_){var C=n[_],A=C.length;if(A<250)for(var I=0;I<A;++I)E[S++]=C[I];else E.set(C,S),S+=A}return E}function popcnt(n){return n-=n>>1&1431655765,n=(n&858993459)+(n>>2&858993459),(n+(n>>4)&252645135)*16843009>>>24}function readDecimal128LE(n,r){for(var _=(n[r+15]&127)<<7|n[r+14]>>1,E=n[r+14]&1,S=r+13;S>=r;--S)E=E*256+n[S];return(n[r+15]&128?-E:E)*Math.pow(10,_-6176)}function writeDecimal128LE(n,r,_){var E=Math.floor(_==0?0:Math.LOG10E*Math.log(Math.abs(_)))+6176-16,S=_/Math.pow(10,E-6176);n[r+15]|=E>>7,n[r+14]|=(E&127)<<1;for(var C=0;S>=1;++C,S/=256)n[r+C]=S&255;n[r+15]|=_>=0?0:128}function parse_varint49(n,r){var _=r.l,E=n[_]&127;e:if(n[_++]>=128&&(E|=(n[_]&127)<<7,n[_++]<128||(E|=(n[_]&127)<<14,n[_++]<128)||(E|=(n[_]&127)<<21,n[_++]<128)||(E+=(n[_]&127)*Math.pow(2,28),++_,n[_++]<128)||(E+=(n[_]&127)*Math.pow(2,35),++_,n[_++]<128)||(E+=(n[_]&127)*Math.pow(2,42),++_,n[_++]<128)))break e;return r.l=_,E}function write_varint49(n){var r=new Uint8Array(7);r[0]=n&127;var _=1;e:if(n>127){if(r[_-1]|=128,r[_]=n>>7&127,++_,n<=16383||(r[_-1]|=128,r[_]=n>>14&127,++_,n<=2097151)||(r[_-1]|=128,r[_]=n>>21&127,++_,n<=268435455)||(r[_-1]|=128,r[_]=n/256>>>21&127,++_,n<=34359738367)||(r[_-1]|=128,r[_]=n/65536>>>21&127,++_,n<=4398046511103))break e;r[_-1]|=128,r[_]=n/16777216>>>21&127,++_}return r[subarray](0,_)}function parse_packed_varints(n){for(var r={l:0},_=[];r.l<n.length;)_.push(parse_varint49(n,r));return _}function write_packed_varints(n){return u8concat(n.map(function(r){return write_varint49(r)}))}function varint_to_i32(n){var r=0,_=n[r]&127;e:if(n[r++]>=128){if(_|=(n[r]&127)<<7,n[r++]<128||(_|=(n[r]&127)<<14,n[r++]<128)||(_|=(n[r]&127)<<21,n[r++]<128))break e;_|=(n[r]&127)<<28}return _}function parse_shallow(n){for(var r=[],_={l:0};_.l<n.length;){var E=_.l,S=parse_varint49(n,_),C=S&7;S=S/8|0;var A,I=_.l;switch(C){case 0:{for(;n[I++]>=128;);A=n[subarray](_.l,I),_.l=I}break;case 1:A=n[subarray](I,I+8),_.l=I+8;break;case 2:{var B=parse_varint49(n,_);A=n[subarray](_.l,_.l+B),_.l+=B}break;case 5:A=n[subarray](I,I+4),_.l=I+4;break;default:throw new Error("PB Type ".concat(C," for Field ").concat(S," at offset ").concat(E))}var O={data:A,type:C};r[S]==null&&(r[S]=[]),r[S].push(O)}return r}function write_shallow(n){var r=[];return n.forEach(function(_,E){E!=0&&_.forEach(function(S){S.data&&(r.push(write_varint49(E*8+S.type)),S.type==2&&r.push(write_varint49(S.data.length)),r.push(S.data))})}),u8concat(r)}function mappa(n,r){return n?.map(function(_){return r(_.data)})||[]}function parse_iwa_file(n){for(var r,_=[],E={l:0};E.l<n.length;){var S=parse_varint49(n,E),C=parse_shallow(n[subarray](E.l,E.l+S));E.l+=S;var A={id:varint_to_i32(C[1][0].data),messages:[]};C[2].forEach(function(I){var B=parse_shallow(I.data),O=varint_to_i32(B[3][0].data);A.messages.push({meta:B,data:n[subarray](E.l,E.l+O)}),E.l+=O}),(r=C[3])!=null&&r[0]&&(A.merge=varint_to_i32(C[3][0].data)>>>0>0),_.push(A)}return _}function write_iwa_file(n){var r=[];return n.forEach(function(_){var E=[[],[{data:write_varint49(_.id),type:0}],[]];_.merge!=null&&(E[3]=[{data:write_varint49(+!!_.merge),type:0}]);var S=[];_.messages.forEach(function(A){S.push(A.data),A.meta[3]=[{type:0,data:write_varint49(A.data.length)}],E[2].push({data:write_shallow(A.meta),type:2})});var C=write_shallow(E);r.push(write_varint49(C.length)),r.push(C),S.forEach(function(A){return r.push(A)})}),u8concat(r)}function parse_snappy_chunk(n,r){if(n!=0)throw new Error("Unexpected Snappy chunk type ".concat(n));for(var _={l:0},E=parse_varint49(r,_),S=[],C=_.l;C<r.length;){var A=r[C]&3;if(A==0){var I=r[C++]>>2;if(I<60)++I;else{var B=I-59;I=r[C],B>1&&(I|=r[C+1]<<8),B>2&&(I|=r[C+2]<<16),B>3&&(I|=r[C+3]<<24),I>>>=0,I++,C+=B}S.push(r[subarray](C,C+I)),C+=I;continue}else{var O=0,N=0;if(A==1?(N=(r[C]>>2&7)+4,O=(r[C++]&224)<<3,O|=r[C++]):(N=(r[C++]>>2)+1,A==2?(O=r[C]|r[C+1]<<8,C+=2):(O=(r[C]|r[C+1]<<8|r[C+2]<<16|r[C+3]<<24)>>>0,C+=4)),O==0)throw new Error("Invalid offset 0");for(var U=S.length-1,j=O;U>=0&&j>=S[U].length;)j-=S[U].length,--U;if(U<0)if(j==0)j=S[U=0].length;else throw new Error("Invalid offset beyond length");if(N<j)S.push(S[U][subarray](S[U].length-j,S[U].length-j+N));else{for(j>0&&(S.push(S[U][subarray](S[U].length-j)),N-=j),++U;N>=S[U].length;)S.push(S[U]),N-=S[U].length,++U;N&&S.push(S[U][subarray](0,N))}S.length>25&&(S=[u8concat(S)])}}for(var z=0,Z=0;Z<S.length;++Z)z+=S[Z].length;if(z!=E)throw new Error("Unexpected length: ".concat(z," != ").concat(E));return S}function decompress_iwa_file(n){Array.isArray(n)&&(n=new Uint8Array(n));for(var r=[],_=0;_<n.length;){var E=n[_++],S=n[_]|n[_+1]<<8|n[_+2]<<16;_+=3,r.push.apply(r,parse_snappy_chunk(E,n[subarray](_,_+S))),_+=S}if(_!==n.length)throw new Error("data is not a valid framed stream!");return r.length==1?r[0]:u8concat(r)}function compress_iwa_file(n){for(var r=[],_=0;_<n.length;){var E=Math.min(n.length-_,268435455),S=new Uint8Array(4);r.push(S);var C=write_varint49(E),A=C.length;r.push(C),E<=60?(A++,r.push(new Uint8Array([E-1<<2]))):E<=256?(A+=2,r.push(new Uint8Array([240,E-1&255]))):E<=65536?(A+=3,r.push(new Uint8Array([244,E-1&255,E-1>>8&255]))):E<=16777216?(A+=4,r.push(new Uint8Array([248,E-1&255,E-1>>8&255,E-1>>16&255]))):E<=4294967296&&(A+=5,r.push(new Uint8Array([252,E-1&255,E-1>>8&255,E-1>>16&255,E-1>>>24&255]))),r.push(n[subarray](_,_+E)),A+=E,S[0]=0,S[1]=A&255,S[2]=A>>8&255,S[3]=A>>16&255,_+=E}return u8concat(r)}var numbers_lut_new=function(){return{sst:[],rsst:[],ofmt:[],nfmt:[]}};function numbers_format_cell(n,r,_,E,S){var C,A,I,B,O=r&255,N=r>>8,U=N>=5?S:E;e:if(_&(N>4?8:4)&&n.t=="n"&&O==7){var j=(C=U[7])!=null&&C[0]?varint_to_i32(U[7][0].data):-1;if(j==-1)break e;var z=(A=U[15])!=null&&A[0]?varint_to_i32(U[15][0].data):-1,Z=(I=U[16])!=null&&I[0]?varint_to_i32(U[16][0].data):-1,X=(B=U[40])!=null&&B[0]?varint_to_i32(U[40][0].data):-1,Q=n.v,se=Q;t:if(X){if(Q==0){z=Z=2;break t}Q>=604800?z=1:Q>=86400?z=2:Q>=3600?z=4:Q>=60?z=8:Q>=1?z=16:z=32,Math.floor(Q)!=Q?Z=32:Q%60?Z=16:Q%3600?Z=8:Q%86400?Z=4:Q%604800&&(Z=2),Z<z&&(Z=z)}if(z==-1||Z==-1)break e;var oe=[],ue=[];z==1&&(se=Q/604800,Z==1?ue.push('d"d"'):(se|=0,Q-=604800*se),oe.push(se+(j==2?" week"+(se==1?"":"s"):j==1?"w":""))),z<=2&&Z>=2&&(se=Q/86400,Z>2&&(se|=0,Q-=86400*se),ue.push('d"d"'),oe.push(se+(j==2?" day"+(se==1?"":"s"):j==1?"d":""))),z<=4&&Z>=4&&(se=Q/3600,Z>4&&(se|=0,Q-=3600*se),ue.push((z>=4?"[h]":"h")+'"h"'),oe.push(se+(j==2?" hour"+(se==1?"":"s"):j==1?"h":""))),z<=8&&Z>=8&&(se=Q/60,Z>8&&(se|=0,Q-=60*se),ue.push((z>=8?"[m]":"m")+'"m"'),j==0?oe.push((z==8&&Z==8||se>=10?"":"0")+se):oe.push(se+(j==2?" minute"+(se==1?"":"s"):j==1?"m":""))),z<=16&&Z>=16&&(se=Q,Z>16&&(se|=0,Q-=se),ue.push((z>=16?"[s]":"s")+'"s"'),j==0?oe.push((Z==16&&z==16||se>=10?"":"0")+se):oe.push(se+(j==2?" second"+(se==1?"":"s"):j==1?"s":""))),Z>=32&&(se=Math.round(1e3*Q),z<32&&ue.push('.000"ms"'),j==0?oe.push((se>=100?"":se>=10?"0":"00")+se):oe.push(se+(j==2?" millisecond"+(se==1?"":"s"):j==1?"ms":""))),n.w=oe.join(j==0?":":" "),n.z=ue.join(j==0?'":"':" "),j==0&&(n.w=n.w.replace(/:(\d\d\d)$/,".$1"))}}function parse_old_storage(n,r,_){var E=u8_to_dataview(n),S=E.getUint32(4,!0),C=-1,A=-1,I=-1,B=NaN,O=new Date(2001,0,1),N=_>1?12:8;S&2&&(I=E.getUint32(N,!0),N+=4),N+=popcnt(S&(_>1?3468:396))*4,S&512&&(C=E.getUint32(N,!0),N+=4),N+=popcnt(S&(_>1?12288:4096))*4,S&16&&(A=E.getUint32(N,!0),N+=4),S&32&&(B=E.getFloat64(N,!0),N+=8),S&64&&(O.setTime(O.getTime()+E.getFloat64(N,!0)*1e3),N+=8),_>1&&(S=E.getUint32(8,!0)>>>16,S&255&&(I==-1&&(I=E.getUint32(N,!0)),N+=4));var U,j=n[_>=4?1:2];switch(j){case 0:return;case 2:U={t:"n",v:B};break;case 3:U={t:"s",v:r.sst[A]};break;case 5:U={t:"d",v:O};break;case 6:U={t:"b",v:B>0};break;case 7:U={t:"n",v:B};break;case 8:U={t:"e",v:0};break;case 9:if(C>-1)U={t:"s",v:r.rsst[C]};else throw new Error("Unsupported cell type ".concat(n[subarray](0,4)));break;default:throw new Error("Unsupported cell type ".concat(n[subarray](0,4)))}return I>-1&&numbers_format_cell(U,j|_<<8,S,r.ofmt[I],r.nfmt[I]),j==7&&(U.v/=86400),U}function parse_new_storage(n,r){var _=u8_to_dataview(n);_.getUint32(4,!0);var E=_.getUint32(8,!0),S=12,C=-1,A=-1,I=-1,B=NaN,O=NaN,N=new Date(2001,0,1);E&1&&(B=readDecimal128LE(n,S),S+=16),E&2&&(O=_.getFloat64(S,!0),S+=8),E&4&&(N.setTime(N.getTime()+_.getFloat64(S,!0)*1e3),S+=8),E&8&&(A=_.getUint32(S,!0),S+=4),E&16&&(C=_.getUint32(S,!0),S+=4);var U,j=n[1];switch(j){case 0:return;case 2:U={t:"n",v:B};break;case 3:U={t:"s",v:r.sst[A]};break;case 5:U={t:"d",v:N};break;case 6:U={t:"b",v:O>0};break;case 7:U={t:"n",v:O};break;case 8:U={t:"e",v:0};break;case 9:U={t:"s",v:r.rsst[C]};break;case 10:U={t:"n",v:B};break;default:throw new Error("Unsupported cell type ".concat(n[1]," : ").concat(E&31," : ").concat(n[subarray](0,4)))}return S+=popcnt(E&8160)*4,E&516096&&(I==-1&&(I=_.getUint32(S,!0)),S+=4),I>-1&&numbers_format_cell(U,j|1280,E>>13,r.ofmt[I],r.nfmt[I]),j==7&&(U.v/=86400),U}function write_new_storage(n,r){var _=new Uint8Array(32),E=u8_to_dataview(_),S=12,C=0;switch(_[0]=5,n.t){case"n":_[1]=2,writeDecimal128LE(_,S,n.v),C|=1,S+=16;break;case"b":_[1]=6,E.setFloat64(S,n.v?1:0,!0),C|=2,S+=8;break;case"s":var A=n.v==null?"":String(n.v),I=r.indexOf(A);I==-1&&(r[I=r.length]=A),_[1]=3,E.setUint32(S,I,!0),C|=8,S+=4;break;default:throw"unsupported cell type "+n.t}return E.setUint32(8,C,!0),_[subarray](0,S)}function write_old_storage(n,r){var _=new Uint8Array(32),E=u8_to_dataview(_),S=12,C=0;switch(_[0]=4,n.t){case"n":_[2]=2,E.setFloat64(S,n.v,!0),C|=32,S+=8;break;case"b":_[2]=6,E.setFloat64(S,n.v?1:0,!0),C|=32,S+=8;break;case"s":var A=n.v==null?"":String(n.v),I=r.indexOf(A);I==-1&&(r[I=r.length]=A),_[2]=3,E.setUint32(S,I,!0),C|=16,S+=4;break;default:throw"unsupported cell type "+n.t}return E.setUint32(8,C,!0),_[subarray](0,S)}function parse_cell_storage(n,r){switch(n[0]){case 0:case 1:case 2:case 3:case 4:return parse_old_storage(n,r,n[0]);case 5:return parse_new_storage(n,r);default:throw new Error("Unsupported payload version ".concat(n[0]))}}function parse_TSP_Reference(n){var r=parse_shallow(n);return varint_to_i32(r[1][0].data)}function write_TSP_Reference(n){return write_shallow([[],[{type:0,data:write_varint49(n)}]])}function numbers_add_oref(n,r){var _,E=(_=n.messages[0].meta[5])!=null&&_[0]?parse_packed_varints(n.messages[0].meta[5][0].data):[],S=E.indexOf(r);S==-1&&(E.push(r),n.messages[0].meta[5]=[{type:2,data:write_packed_varints(E)}])}function numbers_del_oref(n,r){var _,E=(_=n.messages[0].meta[5])!=null&&_[0]?parse_packed_varints(n.messages[0].meta[5][0].data):[];n.messages[0].meta[5]=[{type:2,data:write_packed_varints(E.filter(function(S){return S!=r}))}]}function parse_TST_TableDataList(n,r){var _=parse_shallow(r.data),E=varint_to_i32(_[1][0].data),S=_[3],C=[];return(S||[]).forEach(function(A){var I=parse_shallow(A.data);if(I[1]){var B=varint_to_i32(I[1][0].data)>>>0;switch(E){case 1:C[B]=u8str(I[3][0].data);break;case 8:{var O=n[parse_TSP_Reference(I[9][0].data)][0],N=parse_shallow(O.data),U=n[parse_TSP_Reference(N[1][0].data)][0],j=varint_to_i32(U.meta[1][0].data);if(j!=2001)throw new Error("2000 unexpected reference to ".concat(j));var z=parse_shallow(U.data);C[B]=z[3].map(function(Z){return u8str(Z.data)}).join("")}break;case 2:C[B]=parse_shallow(I[6][0].data);break;default:throw E}}}),C}function parse_TST_TileRowInfo(n,r){var _,E,S,C,A,I,B,O,N,U,j,z,Z,X,Q=parse_shallow(n),se=varint_to_i32(Q[1][0].data)>>>0,oe=varint_to_i32(Q[2][0].data)>>>0,ue=((E=(_=Q[8])==null?void 0:_[0])==null?void 0:E.data)&&varint_to_i32(Q[8][0].data)>0||!1,we,Te;if((C=(S=Q[7])==null?void 0:S[0])!=null&&C.data&&r!=0)we=(I=(A=Q[7])==null?void 0:A[0])==null?void 0:I.data,Te=(O=(B=Q[6])==null?void 0:B[0])==null?void 0:O.data;else if((U=(N=Q[4])==null?void 0:N[0])!=null&&U.data&&r!=1)we=(z=(j=Q[4])==null?void 0:j[0])==null?void 0:z.data,Te=(X=(Z=Q[3])==null?void 0:Z[0])==null?void 0:X.data;else throw"NUMBERS Tile missing ".concat(r," cell storage");for(var xe=ue?4:1,Re=u8_to_dataview(we),Ne=[],Fe=0;Fe<we.length/2;++Fe){var ht=Re.getUint16(Fe*2,!0);ht<65535&&Ne.push([Fe,ht])}if(Ne.length!=oe)throw"Expected ".concat(oe," cells, found ").concat(Ne.length);var nt=[];for(Fe=0;Fe<Ne.length-1;++Fe)nt[Ne[Fe][0]]=Te[subarray](Ne[Fe][1]*xe,Ne[Fe+1][1]*xe);return Ne.length>=1&&(nt[Ne[Ne.length-1][0]]=Te[subarray](Ne[Ne.length-1][1]*xe)),{R:se,cells:nt}}function parse_TST_Tile(n,r){var _,E=parse_shallow(r.data),S=-1;(_=E?.[7])!=null&&_[0]&&(varint_to_i32(E[7][0].data)>>>0?S=1:S=0);var C=mappa(E[5],function(A){return parse_TST_TileRowInfo(A,S)});return{nrows:varint_to_i32(E[4][0].data)>>>0,data:C.reduce(function(A,I){return A[I.R]||(A[I.R]=[]),I.cells.forEach(function(B,O){if(A[I.R][O])throw new Error("Duplicate cell r=".concat(I.R," c=").concat(O));A[I.R][O]=B}),A},[])}}function parse_TST_TableModelArchive(n,r,_){var E,S,C,A,I,B,O=parse_shallow(r.data),N={s:{r:0,c:0},e:{r:0,c:0}};if(N.e.r=(varint_to_i32(O[6][0].data)>>>0)-1,N.e.r<0)throw new Error("Invalid row varint ".concat(O[6][0].data));if(N.e.c=(varint_to_i32(O[7][0].data)>>>0)-1,N.e.c<0)throw new Error("Invalid col varint ".concat(O[7][0].data));_["!ref"]=encode_range(N);var U=_["!data"]!=null,j=_,z=parse_shallow(O[4][0].data),Z=numbers_lut_new();(E=z[4])!=null&&E[0]&&(Z.sst=parse_TST_TableDataList(n,n[parse_TSP_Reference(z[4][0].data)][0])),(S=z[11])!=null&&S[0]&&(Z.ofmt=parse_TST_TableDataList(n,n[parse_TSP_Reference(z[11][0].data)][0])),(C=z[17])!=null&&C[0]&&(Z.rsst=parse_TST_TableDataList(n,n[parse_TSP_Reference(z[17][0].data)][0])),(A=z[22])!=null&&A[0]&&(Z.nfmt=parse_TST_TableDataList(n,n[parse_TSP_Reference(z[22][0].data)][0]));var X=parse_shallow(z[3][0].data),Q=0;if(X[1].forEach(function(ue){var we=parse_shallow(ue.data),Te=n[parse_TSP_Reference(we[2][0].data)][0],xe=varint_to_i32(Te.meta[1][0].data);if(xe!=6002)throw new Error("6001 unexpected reference to ".concat(xe));var Re=parse_TST_Tile(n,Te);Re.data.forEach(function(Ne,Fe){Ne.forEach(function(ht,nt){var Ee=parse_cell_storage(ht,Z);Ee&&(U?(j["!data"][Q+Fe]||(j["!data"][Q+Fe]=[]),j["!data"][Q+Fe][nt]=Ee):_[encode_col(nt)+encode_row(Q+Fe)]=Ee)})}),Q+=Re.nrows}),(I=z[13])!=null&&I[0]){var se=n[parse_TSP_Reference(z[13][0].data)][0],oe=varint_to_i32(se.meta[1][0].data);if(oe!=6144)throw new Error("Expected merge type 6144, found ".concat(oe));_["!merges"]=(B=parse_shallow(se.data))==null?void 0:B[1].map(function(ue){var we=parse_shallow(ue.data),Te=u8_to_dataview(parse_shallow(we[1][0].data)[1][0].data),xe=u8_to_dataview(parse_shallow(we[2][0].data)[1][0].data);return{s:{r:Te.getUint16(0,!0),c:Te.getUint16(2,!0)},e:{r:Te.getUint16(0,!0)+xe.getUint16(0,!0)-1,c:Te.getUint16(2,!0)+xe.getUint16(2,!0)-1}}})}}function parse_TST_TableInfoArchive(n,r,_){var E=parse_shallow(r.data),S={"!ref":"A1"};_?.dense&&(S["!data"]=[]);var C=n[parse_TSP_Reference(E[2][0].data)],A=varint_to_i32(C[0].meta[1][0].data);if(A!=6001)throw new Error("6000 unexpected reference to ".concat(A));return parse_TST_TableModelArchive(n,C[0],S),S}function parse_TN_SheetArchive(n,r,_){var E,S=parse_shallow(r.data),C={name:(E=S[1])!=null&&E[0]?u8str(S[1][0].data):"",sheets:[]},A=mappa(S[2],parse_TSP_Reference);return A.forEach(function(I){n[I].forEach(function(B){var O=varint_to_i32(B.meta[1][0].data);O==6e3&&C.sheets.push(parse_TST_TableInfoArchive(n,B,_))})}),C}function parse_TN_DocumentArchive(n,r,_){var E,S=book_new(),C=parse_shallow(r.data);if((E=C[2])!=null&&E[0])throw new Error("Keynote presentations are not supported");var A=mappa(C[1],parse_TSP_Reference);if(A.forEach(function(I){n[I].forEach(function(B){var O=varint_to_i32(B.meta[1][0].data);if(O==2){var N=parse_TN_SheetArchive(n,B,_);N.sheets.forEach(function(U,j){book_append_sheet(S,U,j==0?N.name:N.name+"_"+j,!0)})}})}),S.SheetNames.length==0)throw new Error("Empty NUMBERS file");return S.bookType="numbers",S}function parse_numbers_iwa(n,r){var _,E,S,C,A,I,B,O={},N=[];if(n.FullPaths.forEach(function(j){if(j.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),n.FileIndex.forEach(function(j){if(j.name.match(/\.iwa$/)&&j.content[0]==0){var z;try{z=decompress_iwa_file(j.content)}catch(X){return console.log("?? "+j.content.length+" "+(X.message||X))}var Z;try{Z=parse_iwa_file(z)}catch(X){return console.log("## "+(X.message||X))}Z.forEach(function(X){O[X.id]=X.messages,N.push(X.id)})}}),!N.length)throw new Error("File has no messages");if((S=(E=(_=O?.[1])==null?void 0:_[0].meta)==null?void 0:E[1])!=null&&S[0].data&&varint_to_i32(O[1][0].meta[1][0].data)==1e4)throw new Error("Pages documents are not supported");var U=((B=(I=(A=(C=O?.[1])==null?void 0:C[0])==null?void 0:A.meta)==null?void 0:I[1])==null?void 0:B[0].data)&&varint_to_i32(O[1][0].meta[1][0].data)==1&&O[1][0];if(U||N.forEach(function(j){O[j].forEach(function(z){var Z=varint_to_i32(z.meta[1][0].data)>>>0;if(Z==1)if(!U)U=z;else throw new Error("Document has multiple roots")})}),!U)throw new Error("Cannot find Document root");return parse_TN_DocumentArchive(O,U,r)}function write_TST_TileRowInfo(n,r,_){var E,S,C=[[],[{type:0,data:write_varint49(0)}],[{type:0,data:write_varint49(0)}],[{type:2,data:new Uint8Array([])}],[{type:2,data:new Uint8Array(Array.from({length:510},function(){return 255}))}],[{type:0,data:write_varint49(5)}],[{type:2,data:new Uint8Array([])}],[{type:2,data:new Uint8Array(Array.from({length:510},function(){return 255}))}],[{type:0,data:write_varint49(1)}]];if(!((E=C[6])!=null&&E[0])||!((S=C[7])!=null&&S[0]))throw"Mutation only works on post-BNC storages!";var A=0;if(C[7][0].data.length<2*n.length){var I=new Uint8Array(2*n.length);I.set(C[7][0].data),C[7][0].data=I}if(C[4][0].data.length<2*n.length){var B=new Uint8Array(2*n.length);B.set(C[4][0].data),C[4][0].data=B}for(var O=u8_to_dataview(C[7][0].data),N=0,U=[],j=u8_to_dataview(C[4][0].data),z=0,Z=[],X=_?4:1,Q=0;Q<n.length;++Q){if(n[Q]==null){O.setUint16(Q*2,65535,!0),j.setUint16(Q*2,65535);continue}O.setUint16(Q*2,N/X,!0),j.setUint16(Q*2,z/X,!0);var se,oe;switch(typeof n[Q]){case"string":se=write_new_storage({t:"s",v:n[Q]},r),oe=write_old_storage({t:"s",v:n[Q]},r);break;case"number":se=write_new_storage({t:"n",v:n[Q]},r),oe=write_old_storage({t:"n",v:n[Q]},r);break;case"boolean":se=write_new_storage({t:"b",v:n[Q]},r),oe=write_old_storage({t:"b",v:n[Q]},r);break;default:if(n[Q]instanceof Date){se=write_new_storage({t:"s",v:n[Q].toISOString()},r),oe=write_old_storage({t:"s",v:n[Q].toISOString()},r);break}throw new Error("Unsupported value "+n[Q])}U.push(se),N+=se.length,Z.push(oe),z+=oe.length,++A}for(C[2][0].data=write_varint49(A),C[5][0].data=write_varint49(5);Q<C[7][0].data.length/2;++Q)O.setUint16(Q*2,65535,!0),j.setUint16(Q*2,65535,!0);return C[6][0].data=u8concat(U),C[3][0].data=u8concat(Z),C[8]=[{type:0,data:write_varint49(_?1:0)}],C}function write_iwam(n,r){return{meta:[[],[{type:0,data:write_varint49(n)}]],data:r}}function get_unique_msgid(n,r){r.last||(r.last=927262);for(var _=r.last;_<2e6;++_)if(!r[_])return r[r.last=_]=n,_;throw new Error("Too many messages")}function build_numbers_deps(n){var r={},_=[];return n.FileIndex.map(function(E,S){return[E,n.FullPaths[S]]}).forEach(function(E){var S=E[0],C=E[1];S.type==2&&S.name.match(/\.iwa/)&&S.content[0]==0&&parse_iwa_file(decompress_iwa_file(S.content)).forEach(function(A){_.push(A.id),r[A.id]={deps:[],location:C,type:varint_to_i32(A.messages[0].meta[1][0].data)}})}),n.FileIndex.forEach(function(E){E.name.match(/\.iwa/)&&E.content[0]==0&&parse_iwa_file(decompress_iwa_file(E.content)).forEach(function(S){S.messages.forEach(function(C){[5,6].forEach(function(A){C.meta[A]&&C.meta[A].forEach(function(I){r[S.id].deps.push(varint_to_i32(I.data))})})})})}),r}function write_numbers_iwa(n,r){if(!r||!r.numbers)throw new Error("Must pass a `numbers` option -- check the README");var _=CFB.read(r.numbers,{type:"base64"}),E=build_numbers_deps(_),S=numbers_iwa_find(_,E,1);if(S==null)throw"Could not find message ".concat(1," in Numbers template");var C=mappa(parse_shallow(S.messages[0].data)[1],parse_TSP_Reference);if(C.length>1)throw new Error("Template NUMBERS file must have exactly one sheet");return n.SheetNames.forEach(function(A,I){I>=1&&(numbers_add_ws(_,E,I+1),S=numbers_iwa_find(_,E,1),C=mappa(parse_shallow(S.messages[0].data)[1],parse_TSP_Reference)),write_numbers_ws(_,E,n.Sheets[A],A,I,C[I])}),_}function numbers_iwa_doit(n,r,_,E){var S=CFB.find(n,r[_].location);if(!S)throw"Could not find ".concat(r[_].location," in Numbers template");var C=parse_iwa_file(decompress_iwa_file(S.content)),A=C.find(function(I){return I.id==_});E(A,C),S.content=compress_iwa_file(write_iwa_file(C)),S.size=S.content.length}function numbers_iwa_find(n,r,_){var E=CFB.find(n,r[_].location);if(!E)throw"Could not find ".concat(r[_].location," in Numbers template");var S=parse_iwa_file(decompress_iwa_file(E.content)),C=S.find(function(A){return A.id==_});return C}function numbers_add_ws(n,r,_){var E=-1,S=-1,C={};numbers_iwa_doit(n,r,1,function(O,N){var U=parse_shallow(O.messages[0].data);E=parse_TSP_Reference(parse_shallow(O.messages[0].data)[1][0].data),S=get_unique_msgid({deps:[1],location:r[E].location,type:2},r),C[E]=S,numbers_add_oref(O,S),U[1].push({type:2,data:write_TSP_Reference(S)});var j=numbers_iwa_find(n,r,E);j.id=S,r[1].location==r[S].location?N.push(j):numbers_iwa_doit(n,r,S,function(z,Z){return Z.push(j)}),O.messages[0].data=write_shallow(U)});var A=-1;numbers_iwa_doit(n,r,S,function(O,N){for(var U=parse_shallow(O.messages[0].data),j=3;j<=69;++j)delete U[j];var z=mappa(U[2],parse_TSP_Reference);z.forEach(function(Q){return numbers_del_oref(O,Q)}),A=get_unique_msgid({deps:[S],location:r[z[0]].location,type:r[z[0]].type},r),numbers_add_oref(O,A),C[z[0]]=A,U[2]=[{type:2,data:write_TSP_Reference(A)}];var Z=numbers_iwa_find(n,r,z[0]);if(Z.id=A,r[z[0]].location==r[S].location)N.push(Z);else{var X=r[S].location;X=X.replace(/^Root Entry\//,""),X=X.replace(/^Index\//,"").replace(/\.iwa$/,""),numbers_iwa_doit(n,r,2,function(Q){var se=parse_shallow(Q.messages[0].data),oe=se[3].findIndex(function(we){var Te,xe,Re=parse_shallow(we.data);return(Te=Re[3])!=null&&Te[0]?u8str(Re[3][0].data)==X:!!((xe=Re[2])!=null&&xe[0]&&u8str(Re[2][0].data)==X)}),ue=parse_shallow(se[3][oe].data);ue[6]||(ue[6]=[]),ue[6].push({type:2,data:write_shallow([[],[{type:0,data:write_varint49(A)}]])}),se[3][oe].data=write_shallow(ue),Q.messages[0].data=write_shallow(se)}),numbers_iwa_doit(n,r,A,function(Q,se){return se.push(Z)})}O.messages[0].data=write_shallow(U)});var I=-1;numbers_iwa_doit(n,r,A,function(O,N){for(var U=parse_shallow(O.messages[0].data),j=parse_shallow(U[1][0].data),z=3;z<=69;++z)delete j[z];var Z=parse_TSP_Reference(j[2][0].data);j[2][0].data=write_TSP_Reference(C[Z]),U[1][0].data=write_shallow(j);var X=parse_TSP_Reference(U[2][0].data);numbers_del_oref(O,X),I=get_unique_msgid({deps:[A],location:r[X].location,type:r[X].type},r),numbers_add_oref(O,I),C[X]=I,U[2][0].data=write_TSP_Reference(I);var Q=numbers_iwa_find(n,r,X);Q.id=I,r[A].location==r[I].location?N.push(Q):numbers_iwa_doit(n,r,I,function(se,oe){return oe.push(Q)}),O.messages[0].data=write_shallow(U)});var B=r[I].location;B=B.replace(/^Root Entry\//,""),B=B.replace(/^Index\//,"").replace(/\.iwa$/,""),numbers_iwa_doit(n,r,I,function(O,N){var U,j,z=parse_shallow(O.messages[0].data),Z=u8str(z[1][0].data),X=Z.replace(/-[A-Z0-9]*/,"-".concat(_.toString(16).padStart(4,"0")));if(z[1][0].data=stru8(X),[12,13,29,31,32,33,39,44,47,81,82,84].forEach(function(xe){return delete z[xe]}),z[45]){var Q=parse_shallow(z[45][0].data),se=parse_TSP_Reference(Q[1][0].data);numbers_del_oref(O,se),delete z[45]}if(z[70]){var oe=parse_shallow(z[70][0].data);(U=oe[2])==null||U.forEach(function(xe){var Re=parse_shallow(xe.data);[2,3].map(function(Ne){return Re[Ne][0]}).forEach(function(Ne){var Fe=parse_shallow(Ne.data);if(Fe[8]){var ht=parse_TSP_Reference(Fe[8][0].data);numbers_del_oref(O,ht)}})}),delete z[70]}[46,30,34,35,36,38,48,49,60,61,62,63,64,71,72,73,74,75,85,86,87,88,89].forEach(function(xe){if(z[xe]){var Re=parse_TSP_Reference(z[xe][0].data);delete z[xe],numbers_del_oref(O,Re)}});var ue=parse_shallow(z[4][0].data);{[2,4,5,6,11,12,13,15,16,17,18,19,20,21,22].forEach(function(xe){var Re;if((Re=ue[xe])!=null&&Re[0]){var Ne=parse_TSP_Reference(ue[xe][0].data),Fe=get_unique_msgid({deps:[I],location:r[Ne].location,type:r[Ne].type},r);numbers_del_oref(O,Ne),numbers_add_oref(O,Fe),C[Ne]=Fe;var ht=numbers_iwa_find(n,r,Ne);if(ht.id=Fe,r[Ne].location==r[I].location)N.push(ht);else{r[Fe].location=r[Ne].location.replace(Ne.toString(),Fe.toString()),r[Fe].location==r[Ne].location&&(r[Fe].location=r[Fe].location.replace(/\.iwa/,"-".concat(Fe,".iwa"))),CFB.utils.cfb_add(n,r[Fe].location,compress_iwa_file(write_iwa_file([ht])));var nt=r[Fe].location;nt=nt.replace(/^Root Entry\//,""),nt=nt.replace(/^Index\//,"").replace(/\.iwa$/,""),numbers_iwa_doit(n,r,2,function(Ee){var Ce=parse_shallow(Ee.messages[0].data);Ce[3].push({type:2,data:write_shallow([[],[{type:0,data:write_varint49(Fe)}],[{type:2,data:stru8(nt.replace(/-.*$/,""))}],[{type:2,data:stru8(nt)}],[{type:2,data:new Uint8Array([2,0,0])}],[{type:2,data:new Uint8Array([2,0,0])}],[],[],[],[],[{type:0,data:write_varint49(0)}],[],[{type:0,data:write_varint49(0)}]])}),Ce[1]=[{type:0,data:write_varint49(Math.max(Fe+1,varint_to_i32(Ce[1][0].data)))}];var _e=Ce[3].findIndex(function(He){var Be,Ge,je=parse_shallow(He.data);return(Be=je[3])!=null&&Be[0]?u8str(je[3][0].data)==B:!!((Ge=je[2])!=null&&Ge[0]&&u8str(je[2][0].data)==B)}),Ie=parse_shallow(Ce[3][_e].data);Ie[6]||(Ie[6]=[]),Ie[6].push({type:2,data:write_shallow([[],[{type:0,data:write_varint49(Fe)}]])}),Ce[3][_e].data=write_shallow(Ie),Ee.messages[0].data=write_shallow(Ce)})}ue[xe][0].data=write_TSP_Reference(Fe)}});var we=parse_shallow(ue[1][0].data);(j=we[2])==null||j.forEach(function(xe){var Re=parse_TSP_Reference(xe.data),Ne=get_unique_msgid({deps:[I],location:r[Re].location,type:r[Re].type},r);numbers_del_oref(O,Re),numbers_add_oref(O,Ne),C[Re]=Ne;var Fe=numbers_iwa_find(n,r,Re);if(Fe.id=Ne,r[Re].location==r[I].location)N.push(Fe);else{r[Ne].location=r[Re].location.replace(Re.toString(),Ne.toString()),r[Ne].location==r[Re].location&&(r[Ne].location=r[Ne].location.replace(/\.iwa/,"-".concat(Ne,".iwa"))),CFB.utils.cfb_add(n,r[Ne].location,compress_iwa_file(write_iwa_file([Fe])));var ht=r[Ne].location;ht=ht.replace(/^Root Entry\//,""),ht=ht.replace(/^Index\//,"").replace(/\.iwa$/,""),numbers_iwa_doit(n,r,2,function(nt){var Ee=parse_shallow(nt.messages[0].data);Ee[3].push({type:2,data:write_shallow([[],[{type:0,data:write_varint49(Ne)}],[{type:2,data:stru8(ht.replace(/-.*$/,""))}],[{type:2,data:stru8(ht)}],[{type:2,data:new Uint8Array([2,0,0])}],[{type:2,data:new Uint8Array([2,0,0])}],[],[],[],[],[{type:0,data:write_varint49(0)}],[],[{type:0,data:write_varint49(0)}]])}),Ee[1]=[{type:0,data:write_varint49(Math.max(Ne+1,varint_to_i32(Ee[1][0].data)))}];var Ce=Ee[3].findIndex(function(Ie){var He,Be,Ge=parse_shallow(Ie.data);return(He=Ge[3])!=null&&He[0]?u8str(Ge[3][0].data)==B:!!((Be=Ge[2])!=null&&Be[0]&&u8str(Ge[2][0].data)==B)}),_e=parse_shallow(Ee[3][Ce].data);_e[6]||(_e[6]=[]),_e[6].push({type:2,data:write_shallow([[],[{type:0,data:write_varint49(Ne)}]])}),Ee[3][Ce].data=write_shallow(_e),nt.messages[0].data=write_shallow(Ee)})}xe.data=write_TSP_Reference(Ne)}),ue[1][0].data=write_shallow(we);var Te=parse_shallow(ue[3][0].data);Te[1].forEach(function(xe){var Re=parse_shallow(xe.data),Ne=parse_TSP_Reference(Re[2][0].data),Fe=C[Ne];if(!C[Ne]){Fe=get_unique_msgid({deps:[I],location:"",type:r[Ne].type},r),r[Fe].location="Root Entry/Index/Tables/Tile-".concat(Fe,".iwa"),C[Ne]=Fe;var ht=numbers_iwa_find(n,r,Ne);ht.id=Fe,numbers_del_oref(O,Ne),numbers_add_oref(O,Fe),CFB.utils.cfb_add(n,"/Index/Tables/Tile-".concat(Fe,".iwa"),compress_iwa_file(write_iwa_file([ht]))),numbers_iwa_doit(n,r,2,function(nt){var Ee=parse_shallow(nt.messages[0].data);Ee[3].push({type:2,data:write_shallow([[],[{type:0,data:write_varint49(Fe)}],[{type:2,data:stru8("Tables/Tile")}],[{type:2,data:stru8("Tables/Tile-".concat(Fe))}],[{type:2,data:new Uint8Array([2,0,0])}],[{type:2,data:new Uint8Array([2,0,0])}],[],[],[],[],[{type:0,data:write_varint49(0)}],[],[{type:0,data:write_varint49(0)}]])}),Ee[1]=[{type:0,data:write_varint49(Math.max(Fe+1,varint_to_i32(Ee[1][0].data)))}];var Ce=Ee[3].findIndex(function(Ie){var He,Be,Ge=parse_shallow(Ie.data);return(He=Ge[3])!=null&&He[0]?u8str(Ge[3][0].data)==B:!!((Be=Ge[2])!=null&&Be[0]&&u8str(Ge[2][0].data)==B)}),_e=parse_shallow(Ee[3][Ce].data);_e[6]||(_e[6]=[]),_e[6].push({type:2,data:write_shallow([[],[{type:0,data:write_varint49(Fe)}]])}),Ee[3][Ce].data=write_shallow(_e),nt.messages[0].data=write_shallow(Ee)})}Re[2][0].data=write_TSP_Reference(Fe),xe.data=write_shallow(Re)}),ue[3][0].data=write_shallow(Te)}z[4][0].data=write_shallow(ue),O.messages[0].data=write_shallow(z)})}function write_numbers_ws(n,r,_,E,S,C){var A=[];numbers_iwa_doit(n,r,C,function(O){var N=parse_shallow(O.messages[0].data);N[1]=[{type:2,data:stru8(E)}],A=mappa(N[2],parse_TSP_Reference),O.messages[0].data=write_shallow(N)});var I=numbers_iwa_find(n,r,A[0]),B=parse_TSP_Reference(parse_shallow(I.messages[0].data)[2][0].data);numbers_iwa_doit(n,r,B,function(O,N){return write_numbers_tma(n,r,_,O,N,B)})}var USE_WIDE_ROWS=!0;function write_numbers_tma(n,r,_,E,S,C){var A=decode_range(_["!ref"]);A.s.r=A.s.c=0;var I=!1;A.e.c>999&&(I=!0,A.e.c=999),A.e.r>999999&&(I=!0,A.e.r=999999),I&&console.error("Truncating to ".concat(encode_range(A)));var B=sheet_to_json(_,{range:A,header:1}),O=["~Sh33tJ5~"],N=r[C].location;N=N.replace(/^Root Entry\//,""),N=N.replace(/^Index\//,"").replace(/\.iwa$/,"");var U=parse_shallow(E.messages[0].data);{U[6][0].data=write_varint49(A.e.r+1),U[7][0].data=write_varint49(A.e.c+1),delete U[46];var j=parse_shallow(U[4][0].data);{var z=parse_TSP_Reference(parse_shallow(j[1][0].data)[2][0].data);numbers_iwa_doit(n,r,z,function(_e,Ie){var He,Be=parse_shallow(_e.messages[0].data);if((He=Be?.[2])!=null&&He[0])for(var Ge=0;Ge<B.length;++Ge){var je=parse_shallow(Be[2][0].data);je[1][0].data=write_varint49(Ge),je[4][0].data=write_varint49(B[Ge].length),Be[2][Ge]={type:Be[2][0].type,data:write_shallow(je)}}_e.messages[0].data=write_shallow(Be)});var Z=parse_TSP_Reference(j[2][0].data);numbers_iwa_doit(n,r,Z,function(_e,Ie){for(var He=parse_shallow(_e.messages[0].data),Be=0;Be<=A.e.c;++Be){var Ge=parse_shallow(He[2][0].data);Ge[1][0].data=write_varint49(Be),Ge[4][0].data=write_varint49(A.e.r+1),He[2][Be]={type:He[2][0].type,data:write_shallow(Ge)}}_e.messages[0].data=write_shallow(He)});var X=parse_shallow(j[9][0].data);X[1]=[];var Q=parse_shallow(j[3][0].data);{var se=256;Q[2]=[{type:0,data:write_varint49(se)}];var oe=parse_TSP_Reference(parse_shallow(Q[1][0].data)[2][0].data),ue=function(){var _e=numbers_iwa_find(n,r,2),Ie=parse_shallow(_e.messages[0].data),He=Ie[3].filter(function(Be){return varint_to_i32(parse_shallow(Be.data)[1][0].data)==oe});return He?.length?varint_to_i32(parse_shallow(He[0].data)[12][0].data):0}();CFB.utils.cfb_del(n,r[oe].location),numbers_iwa_doit(n,r,2,function(_e){var Ie=parse_shallow(_e.messages[0].data);Ie[3]=Ie[3].filter(function(Ge){return varint_to_i32(parse_shallow(Ge.data)[1][0].data)!=oe});var He=Ie[3].findIndex(function(Ge){var je,Ve,Pe=parse_shallow(Ge.data);return(je=Pe[3])!=null&&je[0]?u8str(Pe[3][0].data)==N:!!((Ve=Pe[2])!=null&&Ve[0]&&u8str(Pe[2][0].data)==N)}),Be=parse_shallow(Ie[3][He].data);Be[6]||(Be[6]=[]),Be[6]=Be[6].filter(function(Ge){return varint_to_i32(parse_shallow(Ge.data)[1][0].data)!=oe}),Ie[3][He].data=write_shallow(Be),_e.messages[0].data=write_shallow(Ie)}),numbers_del_oref(E,oe),Q[1]=[];for(var we=Math.ceil((A.e.r+1)/se),Te=0;Te<we;++Te){var xe=get_unique_msgid({deps:[],location:"",type:6002},r);r[xe].location="Root Entry/Index/Tables/Tile-".concat(xe,".iwa");for(var Re=[[],[{type:0,data:write_varint49(0)}],[{type:0,data:write_varint49(Math.min(A.e.r+1,(Te+1)*se))}],[{type:0,data:write_varint49(0)}],[{type:0,data:write_varint49(Math.min((Te+1)*se,A.e.r+1)-Te*se)}],[],[{type:0,data:write_varint49(5)}],[{type:0,data:write_varint49(1)}],[{type:0,data:write_varint49(1)}]],Ne=Te*se;Ne<=Math.min(A.e.r,(Te+1)*se-1);++Ne){var Fe=write_TST_TileRowInfo(B[Ne],O,USE_WIDE_ROWS);Fe[1][0].data=write_varint49(Ne-Te*se),Re[5].push({data:write_shallow(Fe),type:2})}Q[1].push({type:2,data:write_shallow([[],[{type:0,data:write_varint49(Te)}],[{type:2,data:write_TSP_Reference(xe)}]])});var ht={id:xe,messages:[write_iwam(6002,write_shallow(Re))]},nt=compress_iwa_file(write_iwa_file([ht]));CFB.utils.cfb_add(n,"/Index/Tables/Tile-".concat(xe,".iwa"),nt),numbers_iwa_doit(n,r,2,function(_e){var Ie=parse_shallow(_e.messages[0].data);Ie[3].push({type:2,data:write_shallow([[],[{type:0,data:write_varint49(xe)}],[{type:2,data:stru8("Tables/Tile")}],[{type:2,data:stru8("Tables/Tile-".concat(xe))}],[{type:2,data:new Uint8Array([2,0,0])}],[{type:2,data:new Uint8Array([2,0,0])}],[],[],[],[],[{type:0,data:write_varint49(0)}],[],[{type:0,data:write_varint49(ue)}]])}),Ie[1]=[{type:0,data:write_varint49(Math.max(xe+1,varint_to_i32(Ie[1][0].data)))}];var He=Ie[3].findIndex(function(Ge){var je,Ve,Pe=parse_shallow(Ge.data);return(je=Pe[3])!=null&&je[0]?u8str(Pe[3][0].data)==N:!!((Ve=Pe[2])!=null&&Ve[0]&&u8str(Pe[2][0].data)==N)}),Be=parse_shallow(Ie[3][He].data);Be[6]||(Be[6]=[]),Be[6].push({type:2,data:write_shallow([[],[{type:0,data:write_varint49(xe)}]])}),Ie[3][He].data=write_shallow(Be),_e.messages[0].data=write_shallow(Ie)}),numbers_add_oref(E,xe),X[1].push({type:2,data:write_shallow([[],[{type:0,data:write_varint49(Te*se)}],[{type:0,data:write_varint49(Te)}]])})}}if(j[3][0].data=write_shallow(Q),j[9][0].data=write_shallow(X),j[10]=[{type:2,data:new Uint8Array([])}],_["!merges"]){var Ee=get_unique_msgid({type:6144,deps:[C],location:r[C].location},r);S.push({id:Ee,messages:[write_iwam(6144,write_shallow([[],_["!merges"].map(function(_e){return{type:2,data:write_shallow([[],[{type:2,data:write_shallow([[],[{type:5,data:new Uint8Array(new Uint16Array([_e.s.r,_e.s.c]).buffer)}]])}],[{type:2,data:write_shallow([[],[{type:5,data:new Uint8Array(new Uint16Array([_e.e.r-_e.s.r+1,_e.e.c-_e.s.c+1]).buffer)}]])}]])}})]))]}),j[13]=[{type:2,data:write_TSP_Reference(Ee)}],numbers_iwa_doit(n,r,2,function(_e){var Ie=parse_shallow(_e.messages[0].data),He=Ie[3].findIndex(function(Ge){var je,Ve,Pe=parse_shallow(Ge.data);return(je=Pe[3])!=null&&je[0]?u8str(Pe[3][0].data)==N:!!((Ve=Pe[2])!=null&&Ve[0]&&u8str(Pe[2][0].data)==N)}),Be=parse_shallow(Ie[3][He].data);Be[6]||(Be[6]=[]),Be[6].push({type:2,data:write_shallow([[],[{type:0,data:write_varint49(Ee)}]])}),Ie[3][He].data=write_shallow(Be),_e.messages[0].data=write_shallow(Ie)}),numbers_add_oref(E,Ee)}else delete j[13];var Ce=parse_TSP_Reference(j[4][0].data);numbers_iwa_doit(n,r,Ce,function(_e){var Ie=parse_shallow(_e.messages[0].data);Ie[3]=[],O.forEach(function(He,Be){Be!=0&&Ie[3].push({type:2,data:write_shallow([[],[{type:0,data:write_varint49(Be)}],[{type:0,data:write_varint49(1)}],[{type:2,data:stru8(He)}]])})}),_e.messages[0].data=write_shallow(Ie)})}U[4][0].data=write_shallow(j)}E.messages[0].data=write_shallow(U)}function fix_opts_func(n){return function(_){for(var E=0;E!=n.length;++E){var S=n[E];_[S[0]]===void 0&&(_[S[0]]=S[1]),S[2]==="n"&&(_[S[0]]=Number(_[S[0]]))}}}function fix_read_opts(n){fix_opts_func([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(n)}function fix_write_opts(n){fix_opts_func([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(n)}function get_sheet_type(n){return RELS.WS.indexOf(n)>-1?"sheet":n==RELS.CS?"chart":n==RELS.DS?"dialog":n==RELS.MS?"macro":n&&n.length?n:"sheet"}function safe_parse_wbrels(n,r){if(!n)return 0;try{n=r.map(function(E){return E.id||(E.id=E.strRelID),[E.name,n["!id"][E.id].Target,get_sheet_type(n["!id"][E.id].Type)]})}catch{return null}return!n||n.length===0?null:n}function safe_parse_sheet(n,r,_,E,S,C,A,I,B,O,N,U){try{C[E]=parse_rels(getzipstr(n,_,!0),r);var j=getzipdata(n,r),z;switch(I){case"sheet":z=parse_ws(j,r,S,B,C[E],O,N,U);break;case"chart":if(z=parse_cs(j,r,S,B,C[E],O,N,U),!z||!z["!drawel"])break;var Z=resolve_path(z["!drawel"].Target,r),X=get_rels_path(Z),Q=parse_drawing(getzipstr(n,Z,!0),parse_rels(getzipstr(n,X,!0),Z)),se=resolve_path(Q,Z),oe=get_rels_path(se);z=parse_chart(getzipstr(n,se,!0),se,B,parse_rels(getzipstr(n,oe,!0),se),O,z);break;case"macro":z=parse_ms(j,r,S,B,C[E],O,N,U);break;case"dialog":z=parse_ds(j,r,S,B,C[E],O,N,U);break;default:throw new Error("Unrecognized sheet type "+I)}A[E]=z;var ue=[],we=[];C&&C[E]&&keys(C[E]).forEach(function(Te){var xe="";if(C[E][Te].Type==RELS.CMNT){if(xe=resolve_path(C[E][Te].Target,r),ue=parse_cmnt(getzipdata(n,xe,!0),xe,B),!ue||!ue.length)return;sheet_insert_comments(z,ue,!1)}C[E][Te].Type==RELS.TCMNT&&(xe=resolve_path(C[E][Te].Target,r),we=we.concat(parse_tcmnt_xml(getzipdata(n,xe,!0),B)))}),we&&we.length&&sheet_insert_comments(z,we,!0,B.people||[])}catch(Te){if(B.WTF)throw Te}}function strip_front_slash(n){return n.charAt(0)=="/"?n.slice(1):n}function parse_zip(n,r){if(make_ssf(),r=r||{},fix_read_opts(r),safegetzipfile(n,"META-INF/manifest.xml")||safegetzipfile(n,"objectdata.xml"))return parse_ods(n,r);if(safegetzipfile(n,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof parse_numbers_iwa<"u"){if(n.FileIndex)return parse_numbers_iwa(n,r);var _=CFB.utils.cfb_new();return zipentries(n).forEach(function(Ie){zip_add_file(_,Ie,getzipbin(n,Ie))}),parse_numbers_iwa(_,r)}throw new Error("Unsupported NUMBERS file")}if(!safegetzipfile(n,"[Content_Types].xml")){if(safegetzipfile(n,"index.xml.gz"))throw new Error("Unsupported NUMBERS 08 file");if(safegetzipfile(n,"index.xml"))throw new Error("Unsupported NUMBERS 09 file");var E=CFB.find(n,"Index.zip");if(E)return r=dup(r),delete r.type,typeof E.content=="string"&&(r.type="binary"),typeof Bun<"u"&&Buffer.isBuffer(E.content)?readSync(new Uint8Array(E.content),r):readSync(E.content,r);throw new Error("Unsupported ZIP file")}var S=zipentries(n),C=parse_ct(getzipstr(n,"[Content_Types].xml")),A=!1,I,B;if(C.workbooks.length===0&&(B="xl/workbook.xml",getzipdata(n,B,!0)&&C.workbooks.push(B)),C.workbooks.length===0){if(B="xl/workbook.bin",!getzipdata(n,B,!0))throw new Error("Could not find workbook");C.workbooks.push(B),A=!0}C.workbooks[0].slice(-3)=="bin"&&(A=!0);var O={},N={};if(!r.bookSheets&&!r.bookProps){if(strs=[],C.sst)try{strs=parse_sst(getzipdata(n,strip_front_slash(C.sst)),C.sst,r)}catch(Ie){if(r.WTF)throw Ie}r.cellStyles&&C.themes.length&&(O=parse_theme_xml(getzipstr(n,C.themes[0].replace(/^\//,""),!0)||"",r)),C.style&&(N=parse_sty(getzipdata(n,strip_front_slash(C.style)),C.style,O,r))}C.links.map(function(Ie){try{var He=parse_rels(getzipstr(n,get_rels_path(strip_front_slash(Ie))),Ie);return parse_xlink(getzipdata(n,strip_front_slash(Ie)),He,Ie,r)}catch{}});var U=parse_wb(getzipdata(n,strip_front_slash(C.workbooks[0])),C.workbooks[0],r),j={},z="";C.coreprops.length&&(z=getzipdata(n,strip_front_slash(C.coreprops[0]),!0),z&&(j=parse_core_props(z)),C.extprops.length!==0&&(z=getzipdata(n,strip_front_slash(C.extprops[0]),!0),z&&parse_ext_props(z,j,r)));var Z={};(!r.bookSheets||r.bookProps)&&C.custprops.length!==0&&(z=getzipstr(n,strip_front_slash(C.custprops[0]),!0),z&&(Z=parse_cust_props(z,r)));var X={};if((r.bookSheets||r.bookProps)&&(U.Sheets?I=U.Sheets.map(function(He){return He.name}):j.Worksheets&&j.SheetNames.length>0&&(I=j.SheetNames),r.bookProps&&(X.Props=j,X.Custprops=Z),r.bookSheets&&typeof I<"u"&&(X.SheetNames=I),r.bookSheets?X.SheetNames:r.bookProps))return X;I={};var Q={};r.bookDeps&&C.calcchain&&(Q=parse_cc(getzipdata(n,strip_front_slash(C.calcchain)),C.calcchain));var se=0,oe={},ue,we;{var Te=U.Sheets;j.Worksheets=Te.length,j.SheetNames=[];for(var xe=0;xe!=Te.length;++xe)j.SheetNames[xe]=Te[xe].name}var Re=A?"bin":"xml",Ne=C.workbooks[0].lastIndexOf("/"),Fe=(C.workbooks[0].slice(0,Ne+1)+"_rels/"+C.workbooks[0].slice(Ne+1)+".rels").replace(/^\//,"");safegetzipfile(n,Fe)||(Fe="xl/_rels/workbook."+Re+".rels");var ht=parse_rels(getzipstr(n,Fe,!0),Fe.replace(/_rels.*/,"s5s"));(C.metadata||[]).length>=1&&(r.xlmeta=parse_xlmeta(getzipdata(n,strip_front_slash(C.metadata[0])),C.metadata[0],r)),(C.people||[]).length>=1&&(r.people=parse_people_xml(getzipdata(n,strip_front_slash(C.people[0])),r)),ht&&(ht=safe_parse_wbrels(ht,U.Sheets));var nt=getzipdata(n,"xl/worksheets/sheet.xml",!0)?1:0;e:for(se=0;se!=j.Worksheets;++se){var Ee="sheet";if(ht&&ht[se]?(ue="xl/"+ht[se][1].replace(/[\/]?xl\//,""),safegetzipfile(n,ue)||(ue=ht[se][1]),safegetzipfile(n,ue)||(ue=Fe.replace(/_rels\/.*$/,"")+ht[se][1]),Ee=ht[se][2]):(ue="xl/worksheets/sheet"+(se+1-nt)+"."+Re,ue=ue.replace(/sheet0\./,"sheet.")),we=ue.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),r&&r.sheets!=null)switch(typeof r.sheets){case"number":if(se!=r.sheets)continue e;break;case"string":if(j.SheetNames[se].toLowerCase()!=r.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(r.sheets)){for(var Ce=!1,_e=0;_e!=r.sheets.length;++_e)typeof r.sheets[_e]=="number"&&r.sheets[_e]==se&&(Ce=1),typeof r.sheets[_e]=="string"&&r.sheets[_e].toLowerCase()==j.SheetNames[se].toLowerCase()&&(Ce=1);if(!Ce)continue e}}safe_parse_sheet(n,ue,we,j.SheetNames[se],se,oe,I,Ee,r,U,O,N)}return X={Directory:C,Workbook:U,Props:j,Custprops:Z,Deps:Q,Sheets:I,SheetNames:j.SheetNames,Strings:strs,Styles:N,Themes:O,SSF:dup(table_fmt)},r&&r.bookFiles&&(n.files?(X.keys=S,X.files=n.files):(X.keys=[],X.files={},n.FullPaths.forEach(function(Ie,He){Ie=Ie.replace(/^Root Entry[\/]/,""),X.keys.push(Ie),X.files[Ie]=n.FileIndex[He]}))),r&&r.bookVBA&&(C.vba.length>0?X.vbaraw=getzipdata(n,strip_front_slash(C.vba[0]),!0):C.defaults&&C.defaults.bin===CT_VBA&&(X.vbaraw=getzipdata(n,"xl/vbaProject.bin",!0))),X.bookType=A?"xlsb":"xlsx",X}function parse_xlsxcfb(n,r){var _=r||{},E="Workbook",S=CFB.find(n,E);try{if(E="/!DataSpaces/Version",S=CFB.find(n,E),!S||!S.content)throw new Error("ECMA-376 Encrypted file missing "+E);if(parse_DataSpaceVersionInfo(S.content),E="/!DataSpaces/DataSpaceMap",S=CFB.find(n,E),!S||!S.content)throw new Error("ECMA-376 Encrypted file missing "+E);var C=parse_DataSpaceMap(S.content);if(C.length!==1||C[0].comps.length!==1||C[0].comps[0].t!==0||C[0].name!=="StrongEncryptionDataSpace"||C[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+E);if(E="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",S=CFB.find(n,E),!S||!S.content)throw new Error("ECMA-376 Encrypted file missing "+E);var A=parse_DataSpaceDefinition(S.content);if(A.length!=1||A[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+E);if(E="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",S=CFB.find(n,E),!S||!S.content)throw new Error("ECMA-376 Encrypted file missing "+E);parse_Primary(S.content)}catch{}if(E="/EncryptionInfo",S=CFB.find(n,E),!S||!S.content)throw new Error("ECMA-376 Encrypted file missing "+E);var I=parse_EncryptionInfo(S.content);if(E="/EncryptedPackage",S=CFB.find(n,E),!S||!S.content)throw new Error("ECMA-376 Encrypted file missing "+E);if(I[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(I[1],S.content,_.password||"",_);if(I[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(I[1],S.content,_.password||"",_);throw new Error("File is password-protected")}function write_zip_xlsb(n,r){n&&!n.SSF&&(n.SSF=dup(table_fmt)),n&&n.SSF&&(make_ssf(),SSF_load_table(n.SSF),r.revssf=evert_num(n.SSF),r.revssf[n.SSF[65535]]=0,r.ssf=n.SSF),r.rels={},r.wbrels={},r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,browser_has_Map?r.revStrings=new Map:(r.revStrings={},r.revStrings.foo=[],delete r.revStrings.foo);var _="bin",E=!0,S=new_ct();fix_write_opts(r=r||{});var C=zip_new(),A="",I=0;if(r.cellXfs=[],get_cell_style(r.cellXfs,{},{revssf:{General:0}}),n.Props||(n.Props={}),A="docProps/core.xml",zip_add_file(C,A,write_core_props(n.Props,r)),S.coreprops.push(A),add_rels(r.rels,2,A,RELS.CORE_PROPS),A="docProps/app.xml",!(n.Props&&n.Props.SheetNames))if(!n.Workbook||!n.Workbook.Sheets)n.Props.SheetNames=n.SheetNames;else{for(var B=[],O=0;O<n.SheetNames.length;++O)(n.Workbook.Sheets[O]||{}).Hidden!=2&&B.push(n.SheetNames[O]);n.Props.SheetNames=B}for(n.Props.Worksheets=n.Props.SheetNames.length,zip_add_file(C,A,write_ext_props(n.Props)),S.extprops.push(A),add_rels(r.rels,3,A,RELS.EXT_PROPS),n.Custprops!==n.Props&&keys(n.Custprops||{}).length>0&&(A="docProps/custom.xml",zip_add_file(C,A,write_cust_props(n.Custprops)),S.custprops.push(A),add_rels(r.rels,4,A,RELS.CUST_PROPS)),I=1;I<=n.SheetNames.length;++I){var N={"!id":{}},U=n.Sheets[n.SheetNames[I-1]],j=(U||{})["!type"]||"sheet";switch(j){case"chart":default:A="xl/worksheets/sheet"+I+"."+_,zip_add_file(C,A,write_ws_bin(I-1,r,n,N)),S.sheets.push(A),add_rels(r.wbrels,-1,"worksheets/sheet"+I+"."+_,RELS.WS[0])}if(U){var z=U["!comments"],Z=!1,X="";z&&z.length>0&&(X="xl/comments"+I+"."+_,zip_add_file(C,X,write_comments_bin(z)),S.comments.push(X),add_rels(N,-1,"../comments"+I+"."+_,RELS.CMNT),Z=!0),U["!legacy"]&&Z&&zip_add_file(C,"xl/drawings/vmlDrawing"+I+".vml",write_vml(I,U["!comments"])),delete U["!comments"],delete U["!legacy"]}N["!id"].rId1&&zip_add_file(C,get_rels_path(A),write_rels(N))}r.Strings!=null&&r.Strings.length>0&&(A="xl/sharedStrings."+_,zip_add_file(C,A,write_sst_bin(r.Strings)),S.strs.push(A),add_rels(r.wbrels,-1,"sharedStrings."+_,RELS.SST)),A="xl/workbook."+_,zip_add_file(C,A,write_wb_bin(n)),S.workbooks.push(A),add_rels(r.rels,1,A,RELS.WB),A="xl/theme/theme1.xml";var Q=write_theme(n.Themes,r);return zip_add_file(C,A,Q),S.themes.push(A),add_rels(r.wbrels,-1,"theme/theme1.xml",RELS.THEME),A="xl/styles."+_,zip_add_file(C,A,write_sty_bin(n,r)),S.styles.push(A),add_rels(r.wbrels,-1,"styles."+_,RELS.STY),n.vbaraw&&E&&(A="xl/vbaProject.bin",zip_add_file(C,A,n.vbaraw),S.vba.push(A),add_rels(r.wbrels,-1,"vbaProject.bin",RELS.VBA)),A="xl/metadata."+_,zip_add_file(C,A,write_xlmeta_bin()),S.metadata.push(A),add_rels(r.wbrels,-1,"metadata."+_,RELS.XLMETA),zip_add_file(C,"[Content_Types].xml",write_ct(S,r)),zip_add_file(C,"_rels/.rels",write_rels(r.rels)),zip_add_file(C,"xl/_rels/workbook."+_+".rels",write_rels(r.wbrels)),delete r.revssf,delete r.ssf,C}function write_zip_xlsx(n,r){n&&!n.SSF&&(n.SSF=dup(table_fmt)),n&&n.SSF&&(make_ssf(),SSF_load_table(n.SSF),r.revssf=evert_num(n.SSF),r.revssf[n.SSF[65535]]=0,r.ssf=n.SSF),r.rels={},r.wbrels={},r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,browser_has_Map?r.revStrings=new Map:(r.revStrings={},r.revStrings.foo=[],delete r.revStrings.foo);var _="xml",E=VBAFMTS.indexOf(r.bookType)>-1,S=new_ct();fix_write_opts(r=r||{});var C=zip_new(),A="",I=0;if(r.cellXfs=[],get_cell_style(r.cellXfs,{},{revssf:{General:0}}),n.Props||(n.Props={}),A="docProps/core.xml",zip_add_file(C,A,write_core_props(n.Props,r)),S.coreprops.push(A),add_rels(r.rels,2,A,RELS.CORE_PROPS),A="docProps/app.xml",!(n.Props&&n.Props.SheetNames))if(!n.Workbook||!n.Workbook.Sheets)n.Props.SheetNames=n.SheetNames;else{for(var B=[],O=0;O<n.SheetNames.length;++O)(n.Workbook.Sheets[O]||{}).Hidden!=2&&B.push(n.SheetNames[O]);n.Props.SheetNames=B}n.Props.Worksheets=n.Props.SheetNames.length,zip_add_file(C,A,write_ext_props(n.Props)),S.extprops.push(A),add_rels(r.rels,3,A,RELS.EXT_PROPS),n.Custprops!==n.Props&&keys(n.Custprops||{}).length>0&&(A="docProps/custom.xml",zip_add_file(C,A,write_cust_props(n.Custprops)),S.custprops.push(A),add_rels(r.rels,4,A,RELS.CUST_PROPS));var N=["SheetJ5"];for(r.tcid=0,I=1;I<=n.SheetNames.length;++I){var U={"!id":{}},j=n.Sheets[n.SheetNames[I-1]],z=(j||{})["!type"]||"sheet";switch(z){case"chart":default:A="xl/worksheets/sheet"+I+"."+_,zip_add_file(C,A,write_ws_xml(I-1,r,n,U)),S.sheets.push(A),add_rels(r.wbrels,-1,"worksheets/sheet"+I+"."+_,RELS.WS[0])}if(j){var Z=j["!comments"],X=!1,Q="";if(Z&&Z.length>0){var se=!1;Z.forEach(function(oe){oe[1].forEach(function(ue){ue.T==!0&&(se=!0)})}),se&&(Q="xl/threadedComments/threadedComment"+I+".xml",zip_add_file(C,Q,write_tcmnt_xml(Z,N,r)),S.threadedcomments.push(Q),add_rels(U,-1,"../threadedComments/threadedComment"+I+".xml",RELS.TCMNT)),Q="xl/comments"+I+"."+_,zip_add_file(C,Q,write_comments_xml(Z)),S.comments.push(Q),add_rels(U,-1,"../comments"+I+"."+_,RELS.CMNT),X=!0}j["!legacy"]&&X&&zip_add_file(C,"xl/drawings/vmlDrawing"+I+".vml",write_vml(I,j["!comments"])),delete j["!comments"],delete j["!legacy"]}U["!id"].rId1&&zip_add_file(C,get_rels_path(A),write_rels(U))}return r.Strings!=null&&r.Strings.length>0&&(A="xl/sharedStrings."+_,zip_add_file(C,A,write_sst_xml(r.Strings,r)),S.strs.push(A),add_rels(r.wbrels,-1,"sharedStrings."+_,RELS.SST)),A="xl/workbook."+_,zip_add_file(C,A,write_wb_xml(n)),S.workbooks.push(A),add_rels(r.rels,1,A,RELS.WB),A="xl/theme/theme1.xml",zip_add_file(C,A,write_theme(n.Themes,r)),S.themes.push(A),add_rels(r.wbrels,-1,"theme/theme1.xml",RELS.THEME),A="xl/styles."+_,zip_add_file(C,A,write_sty_xml(n,r)),S.styles.push(A),add_rels(r.wbrels,-1,"styles."+_,RELS.STY),n.vbaraw&&E&&(A="xl/vbaProject.bin",zip_add_file(C,A,n.vbaraw),S.vba.push(A),add_rels(r.wbrels,-1,"vbaProject.bin",RELS.VBA)),A="xl/metadata."+_,zip_add_file(C,A,write_xlmeta_xml()),S.metadata.push(A),add_rels(r.wbrels,-1,"metadata."+_,RELS.XLMETA),N.length>1&&(A="xl/persons/person.xml",zip_add_file(C,A,write_people_xml(N)),S.people.push(A),add_rels(r.wbrels,-1,"persons/person.xml",RELS.PEOPLE)),zip_add_file(C,"[Content_Types].xml",write_ct(S,r)),zip_add_file(C,"_rels/.rels",write_rels(r.rels)),zip_add_file(C,"xl/_rels/workbook."+_+".rels",write_rels(r.wbrels)),delete r.revssf,delete r.ssf,C}function firstbyte(n,r){var _="";switch((r||{}).type||"base64"){case"buffer":return[n[0],n[1],n[2],n[3],n[4],n[5],n[6],n[7]];case"base64":_=Base64_decode(n.slice(0,12));break;case"binary":_=n;break;case"array":return[n[0],n[1],n[2],n[3],n[4],n[5],n[6],n[7]];default:throw new Error("Unrecognized type "+(r&&r.type||"undefined"))}return[_.charCodeAt(0),_.charCodeAt(1),_.charCodeAt(2),_.charCodeAt(3),_.charCodeAt(4),_.charCodeAt(5),_.charCodeAt(6),_.charCodeAt(7)]}function read_cfb(n,r){return CFB.find(n,"EncryptedPackage")?parse_xlsxcfb(n,r):parse_xlscfb(n,r)}function read_zip(n,r){var _,E=n,S=r||{};return S.type||(S.type=has_buf&&Buffer.isBuffer(n)?"buffer":"base64"),_=zip_read(E,S),parse_zip(_,S)}function read_plaintext(n,r){var _=0;e:for(;_<n.length;)switch(n.charCodeAt(_)){case 10:case 13:case 32:++_;break;case 60:return parse_xlml(n.slice(_),r);default:break e}return PRN.to_workbook(n,r)}function read_plaintext_raw(n,r){var _="",E=firstbyte(n,r);switch(r.type){case"base64":_=Base64_decode(n);break;case"binary":_=n;break;case"buffer":_=n.toString("binary");break;case"array":_=cc2str(n);break;default:throw new Error("Unrecognized type "+r.type)}return E[0]==239&&E[1]==187&&E[2]==191&&(_=utf8read(_)),r.type="binary",read_plaintext(_,r)}function read_utf16(n,r){var _=n;return r.type=="base64"&&(_=Base64_decode(_)),_=utf16leread(_.slice(2)),r.type="binary",read_plaintext(_,r)}function bstrify(n){return n.match(/[^\x00-\x7F]/)?utf8write(n):n}function read_prn(n,r,_,E){return E?(_.type="string",PRN.to_workbook(n,_)):PRN.to_workbook(r,_)}function readSync(n,r){reset_cp();var _=r||{};if(_.codepage&&typeof $cptable>"u"&&console.error("Codepage tables are not loaded.  Non-ASCII characters may not give expected results"),typeof ArrayBuffer<"u"&&n instanceof ArrayBuffer)return readSync(new Uint8Array(n),(_=dup(_),_.type="array",_));typeof Uint8Array<"u"&&n instanceof Uint8Array&&!_.type&&(_.type=typeof Deno<"u"?"buffer":"array");var E=n,S=[0,0,0,0],C=!1;if(_.cellStyles&&(_.cellNF=!0,_.sheetStubs=!0),_ssfopts={},_.dateNF&&(_ssfopts.dateNF=_.dateNF),_.type||(_.type=has_buf&&Buffer.isBuffer(n)?"buffer":"base64"),_.type=="file"&&(_.type=has_buf?"buffer":"binary",E=read_binary(n),typeof Uint8Array<"u"&&!has_buf&&(_.type="array")),_.type=="string"&&(C=!0,_.type="binary",_.codepage=65001,E=bstrify(n)),_.type=="array"&&typeof Uint8Array<"u"&&n instanceof Uint8Array&&typeof ArrayBuffer<"u"){var A=new ArrayBuffer(3),I=new Uint8Array(A);if(I.foo="bar",!I.foo)return _=dup(_),_.type="array",readSync(ab2a(E),_)}switch((S=firstbyte(E,_))[0]){case 208:if(S[1]===207&&S[2]===17&&S[3]===224&&S[4]===161&&S[5]===177&&S[6]===26&&S[7]===225)return read_cfb(CFB.read(E,_),_);break;case 9:if(S[1]<=8)return parse_xlscfb(E,_);break;case 60:return parse_xlml(E,_);case 73:if(S[1]===73&&S[2]===42&&S[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(S[1]===68)return read_wb_ID(E,_);break;case 84:if(S[1]===65&&S[2]===66&&S[3]===76)return DIF.to_workbook(E,_);break;case 80:return S[1]===75&&S[2]<9&&S[3]<9?read_zip(E,_):read_prn(n,E,_,C);case 239:return S[3]===60?parse_xlml(E,_):read_prn(n,E,_,C);case 255:if(S[1]===254)return read_utf16(E,_);if(S[1]===0&&S[2]===2&&S[3]===0)return WK_.to_workbook(E,_);break;case 0:if(S[1]===0&&(S[2]>=2&&S[3]===0||S[2]===0&&(S[3]===8||S[3]===9)))return WK_.to_workbook(E,_);break;case 3:case 131:case 139:case 140:return DBF.to_workbook(E,_);case 123:if(S[1]===92&&S[2]===114&&S[3]===116)return rtf_to_workbook(E,_);break;case 10:case 13:case 32:return read_plaintext_raw(E,_);case 137:if(S[1]===80&&S[2]===78&&S[3]===71)throw new Error("PNG Image File is not a spreadsheet");break;case 8:if(S[1]===231)throw new Error("Unsupported Multiplan 1.x file!");break;case 12:if(S[1]===236)throw new Error("Unsupported Multiplan 2.x file!");if(S[1]===237)throw new Error("Unsupported Multiplan 3.x file!");break}return DBF_SUPPORTED_VERSIONS.indexOf(S[0])>-1&&S[2]<=12&&S[3]<=31?DBF.to_workbook(E,_):read_prn(n,E,_,C)}function readFileSync(n,r){var _=r||{};return _.type="file",readSync(n,_)}function write_cfb_ctr(n,r){switch(r.type){case"base64":case"binary":break;case"buffer":case"array":r.type="";break;case"file":return write_dl(r.file,CFB.write(n,{type:has_buf?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+r.bookType+"' files");default:throw new Error("Unrecognized type "+r.type)}return CFB.write(n,r)}function write_zip(n,r){switch(r.bookType){case"ods":return write_ods(n,r);case"numbers":return write_numbers_iwa(n,r);case"xlsb":return write_zip_xlsb(n,r);default:return write_zip_xlsx(n,r)}}function write_zip_type(n,r){var _=dup(r||{}),E=write_zip(n,_);return write_zip_denouement(E,_)}function write_zip_denouement(n,r){var _={},E=has_buf?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(r.compression&&(_.compression="DEFLATE"),r.password)_.type=E;else switch(r.type){case"base64":_.type="base64";break;case"binary":_.type="string";break;case"string":throw new Error("'string' output type invalid for '"+r.bookType+"' files");case"buffer":case"file":_.type=E;break;default:throw new Error("Unrecognized type "+r.type)}var S=n.FullPaths?CFB.write(n,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[_.type]||_.type,compression:!!r.compression}):n.generate(_);if(typeof Deno<"u"&&typeof S=="string"){if(r.type=="binary"||r.type=="base64")return S;S=new Uint8Array(s2ab(S))}return r.password&&typeof encrypt_agile<"u"?write_cfb_ctr(encrypt_agile(S,r.password),r):r.type==="file"?write_dl(r.file,S):r.type=="string"?utf8read(S):S}function write_cfb_type(n,r){var _=r||{},E=write_xlscfb(n,_);return write_cfb_ctr(E,_)}function write_string_type(n,r,_){_||(_="");var E=_+n;switch(r.type){case"base64":return Base64_encode(utf8write(E));case"binary":return utf8write(E);case"string":return n;case"file":return write_dl(r.file,E,"utf8");case"buffer":return has_buf?Buffer_from(E,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(E):write_string_type(E,{type:"binary"}).split("").map(function(S){return S.charCodeAt(0)})}throw new Error("Unrecognized type "+r.type)}function write_stxt_type(n,r){switch(r.type){case"base64":return Base64_encode_pass(n);case"binary":return n;case"string":return n;case"file":return write_dl(r.file,n,"binary");case"buffer":return has_buf?Buffer_from(n,"binary"):n.split("").map(function(_){return _.charCodeAt(0)})}throw new Error("Unrecognized type "+r.type)}function write_binary_type(n,r){switch(r.type){case"string":case"base64":case"binary":for(var _="",E=0;E<n.length;++E)_+=String.fromCharCode(n[E]);return r.type=="base64"?Base64_encode(_):r.type=="string"?utf8read(_):_;case"file":return write_dl(r.file,n);case"buffer":return n;default:throw new Error("Unrecognized type "+r.type)}}function writeSync(n,r){reset_cp(),check_wb(n);var _=dup(r||{});if(_.cellStyles&&(_.cellNF=!0,_.sheetStubs=!0),_.type=="array"){_.type="binary";var E=writeSync(n,_);return _.type="array",s2ab(E)}var S=0;if(_.sheet&&(typeof _.sheet=="number"?S=_.sheet:S=n.SheetNames.indexOf(_.sheet),!n.SheetNames[S]))throw new Error("Sheet not found: "+_.sheet+" : "+typeof _.sheet);switch(_.bookType||"xlsb"){case"xml":case"xlml":return write_string_type(write_xlml(n,_),_);case"slk":case"sylk":return write_string_type(SYLK.from_sheet(n.Sheets[n.SheetNames[S]],_,n),_);case"htm":case"html":return write_string_type(sheet_to_html(n.Sheets[n.SheetNames[S]],_),_);case"txt":return write_stxt_type(sheet_to_txt(n.Sheets[n.SheetNames[S]],_),_);case"csv":return write_string_type(sheet_to_csv(n.Sheets[n.SheetNames[S]],_),_,"\uFEFF");case"dif":return write_string_type(DIF.from_sheet(n.Sheets[n.SheetNames[S]],_),_);case"dbf":return write_binary_type(DBF.from_sheet(n.Sheets[n.SheetNames[S]],_),_);case"prn":return write_string_type(PRN.from_sheet(n.Sheets[n.SheetNames[S]],_),_);case"rtf":return write_string_type(sheet_to_rtf(n.Sheets[n.SheetNames[S]]),_);case"eth":return write_string_type(ETH.from_sheet(n.Sheets[n.SheetNames[S]],_),_);case"fods":return write_string_type(write_ods(n,_),_);case"wk1":return write_binary_type(WK_.sheet_to_wk1(n.Sheets[n.SheetNames[S]],_),_);case"wk3":return write_binary_type(WK_.book_to_wk3(n,_),_);case"biff2":_.biff||(_.biff=2);case"biff3":_.biff||(_.biff=3);case"biff4":return _.biff||(_.biff=4),write_binary_type(write_biff_buf(n,_),_);case"biff5":_.biff||(_.biff=5);case"biff8":case"xla":case"xls":return _.biff||(_.biff=8),write_cfb_type(n,_);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return write_zip_type(n,_);default:throw new Error("Unrecognized bookType |"+_.bookType+"|")}}function resolve_book_type(n){if(!n.bookType){var r={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},_=n.file.slice(n.file.lastIndexOf(".")).toLowerCase();_.match(/^\.[a-z]+$/)&&(n.bookType=_.slice(1)),n.bookType=r[n.bookType]||n.bookType}}function writeFileSync(n,r,_){var E=_||{};return E.type="file",E.file=r,resolve_book_type(E),writeSync(n,E)}function make_json_row(n,r,_,E,S,C,A){var I=encode_row(_),B=A.defval,O=A.raw||!Object.prototype.hasOwnProperty.call(A,"raw"),N=!0,U=n["!data"]!=null,j=S===1?[]:{};if(S!==1)if(Object.defineProperty)try{Object.defineProperty(j,"__rowNum__",{value:_,enumerable:!1})}catch{j.__rowNum__=_}else j.__rowNum__=_;if(!U||n["!data"][_])for(var z=r.s.c;z<=r.e.c;++z){var Z=U?(n["!data"][_]||[])[z]:n[E[z]+I];if(Z===void 0||Z.t===void 0){if(B===void 0)continue;C[z]!=null&&(j[C[z]]=B);continue}var X=Z.v;switch(Z.t){case"z":if(X==null)break;continue;case"e":X=X==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+Z.t)}if(C[z]!=null){if(X==null)if(Z.t=="e"&&X===null)j[C[z]]=null;else if(B!==void 0)j[C[z]]=B;else if(O&&X===null)j[C[z]]=null;else continue;else j[C[z]]=O&&(Z.t!=="n"||Z.t==="n"&&A.rawNumbers!==!1)?X:format_cell(Z,X,A);X!=null&&(N=!1)}}return{row:j,isempty:N}}function sheet_to_json(n,r){if(n==null||n["!ref"]==null)return[];var _={t:"n",v:0},E=0,S=1,C=[],A=0,I="",B={s:{r:0,c:0},e:{r:0,c:0}},O=r||{},N=O.range!=null?O.range:n["!ref"];switch(O.header===1?E=1:O.header==="A"?E=2:Array.isArray(O.header)?E=3:O.header==null&&(E=0),typeof N){case"string":B=safe_decode_range(N);break;case"number":B=safe_decode_range(n["!ref"]),B.s.r=N;break;default:B=N}E>0&&(S=0);var U=encode_row(B.s.r),j=[],z=[],Z=0,X=0,Q=n["!data"]!=null,se=B.s.r,oe=0,ue={};Q&&!n["!data"][se]&&(n["!data"][se]=[]);var we=O.skipHidden&&n["!cols"]||[],Te=O.skipHidden&&n["!rows"]||[];for(oe=B.s.c;oe<=B.e.c;++oe)if(!(we[oe]||{}).hidden)switch(j[oe]=encode_col(oe),_=Q?n["!data"][se][oe]:n[j[oe]+U],E){case 1:C[oe]=oe-B.s.c;break;case 2:C[oe]=j[oe];break;case 3:C[oe]=O.header[oe-B.s.c];break;default:if(_==null&&(_={w:"__EMPTY",t:"s"}),I=A=format_cell(_,null,O),X=ue[A]||0,!X)ue[A]=1;else{do I=A+"_"+X++;while(ue[I]);ue[A]=X,ue[I]=1}C[oe]=I}for(se=B.s.r+S;se<=B.e.r;++se)if(!(Te[se]||{}).hidden){var xe=make_json_row(n,B,se,j,E,C,O);(xe.isempty===!1||(E===1?O.blankrows!==!1:O.blankrows))&&(z[Z++]=xe.row)}return z.length=Z,z}var qreg=/"/g;function make_csv_row(n,r,_,E,S,C,A,I){for(var B=!0,O=[],N="",U=encode_row(_),j=n["!data"]!=null,z=j&&n["!data"][_]||[],Z=r.s.c;Z<=r.e.c;++Z)if(E[Z]){var X=j?z[Z]:n[E[Z]+U];if(X==null)N="";else if(X.v!=null){B=!1,N=""+(I.rawNumbers&&X.t=="n"?X.v:format_cell(X,null,I));for(var Q=0,se=0;Q!==N.length;++Q)if((se=N.charCodeAt(Q))===S||se===C||se===34||I.forceQuotes){N='"'+N.replace(qreg,'""')+'"';break}N=="ID"&&(N='"ID"')}else X.f!=null&&!X.F?(B=!1,N="="+X.f,N.indexOf(",")>=0&&(N='"'+N.replace(qreg,'""')+'"')):N="";O.push(N)}return I.blankrows===!1&&B?null:O.join(A)}function sheet_to_csv(n,r){var _=[],E=r??{};if(n==null||n["!ref"]==null)return"";for(var S=safe_decode_range(n["!ref"]),C=E.FS!==void 0?E.FS:",",A=C.charCodeAt(0),I=E.RS!==void 0?E.RS:`
`,B=I.charCodeAt(0),O=new RegExp((C=="|"?"\\|":C)+"+$"),N="",U=[],j=E.skipHidden&&n["!cols"]||[],z=E.skipHidden&&n["!rows"]||[],Z=S.s.c;Z<=S.e.c;++Z)(j[Z]||{}).hidden||(U[Z]=encode_col(Z));for(var X=0,Q=S.s.r;Q<=S.e.r;++Q)(z[Q]||{}).hidden||(N=make_csv_row(n,S,Q,U,A,B,C,E),N!=null&&(E.strip&&(N=N.replace(O,"")),(N||E.blankrows!==!1)&&_.push((X++?I:"")+N)));return _.join("")}function sheet_to_txt(n,r){r||(r={}),r.FS="	",r.RS=`
`;var _=sheet_to_csv(n,r);return _}function sheet_to_formulae(n){var r="",_,E="";if(n==null||n["!ref"]==null)return[];var S=safe_decode_range(n["!ref"]),C="",A=[],I,B=[],O=n["!data"]!=null;for(I=S.s.c;I<=S.e.c;++I)A[I]=encode_col(I);for(var N=S.s.r;N<=S.e.r;++N)for(C=encode_row(N),I=S.s.c;I<=S.e.c;++I)if(r=A[I]+C,_=O?(n["!data"][N]||[])[I]:n[r],E="",_!==void 0){if(_.F!=null){if(r=_.F,!_.f)continue;E=_.f,r.indexOf(":")==-1&&(r=r+":"+r)}if(_.f!=null)E=_.f;else{if(_.t=="z")continue;if(_.t=="n"&&_.v!=null)E=""+_.v;else if(_.t=="b")E=_.v?"TRUE":"FALSE";else if(_.w!==void 0)E="'"+_.w;else{if(_.v===void 0)continue;_.t=="s"?E="'"+_.v:E=""+_.v}}B[B.length]=r+"="+E}return B}function sheet_add_json(n,r,_){var E=_||{},S=n?n["!data"]!=null:E.dense,C=+!E.skipHeader,A=n||{};!n&&S&&(A["!data"]=[]);var I=0,B=0;if(A&&E.origin!=null)if(typeof E.origin=="number")I=E.origin;else{var O=typeof E.origin=="string"?decode_cell(E.origin):E.origin;I=O.r,B=O.c}var N={s:{c:0,r:0},e:{c:B,r:I+r.length-1+C}};if(A["!ref"]){var U=safe_decode_range(A["!ref"]);N.e.c=Math.max(N.e.c,U.e.c),N.e.r=Math.max(N.e.r,U.e.r),I==-1&&(I=U.e.r+1,N.e.r=I+r.length-1+C)}else I==-1&&(I=0,N.e.r=r.length-1+C);var j=E.header||[],z=0,Z=[];r.forEach(function(Q,se){S&&!A["!data"][I+se+C]&&(A["!data"][I+se+C]=[]),S&&(Z=A["!data"][I+se+C]),keys(Q).forEach(function(oe){(z=j.indexOf(oe))==-1&&(j[z=j.length]=oe);var ue=Q[oe],we="z",Te="",xe=S?"":encode_col(B+z)+encode_row(I+se+C),Re=S?Z[B+z]:A[xe];ue&&typeof ue=="object"&&!(ue instanceof Date)?S?Z[B+z]=ue:A[xe]=ue:(typeof ue=="number"?we="n":typeof ue=="boolean"?we="b":typeof ue=="string"?we="s":ue instanceof Date?(we="d",E.cellDates||(we="n",ue=datenum(ue)),Te=Re!=null&&Re.z&&fmt_is_date(Re.z)?Re.z:E.dateNF||table_fmt[14]):ue===null&&E.nullError&&(we="e",ue=0),Re?(Re.t=we,Re.v=ue,delete Re.w,delete Re.R,Te&&(Re.z=Te)):S?Z[B+z]=Re={t:we,v:ue}:A[xe]=Re={t:we,v:ue},Te&&(Re.z=Te))})}),N.e.c=Math.max(N.e.c,B+j.length-1);var X=encode_row(I);if(S&&!A["!data"][I]&&(A["!data"][I]=[]),C)for(z=0;z<j.length;++z)S?A["!data"][I][z+B]={t:"s",v:j[z]}:A[encode_col(z+B)+X]={t:"s",v:j[z]};return A["!ref"]=encode_range(N),A}function json_to_sheet(n,r){return sheet_add_json(null,n,r)}function ws_get_cell_stub(n,r,_){if(typeof r=="string"){if(n["!data"]!=null){var E=decode_cell(r);return n["!data"][E.r]||(n["!data"][E.r]=[]),n["!data"][E.r][E.c]||(n["!data"][E.r][E.c]={t:"z"})}return n[r]||(n[r]={t:"z"})}return typeof r!="number"?ws_get_cell_stub(n,encode_cell(r)):ws_get_cell_stub(n,encode_col(_||0)+encode_row(r))}function wb_sheet_idx(n,r){if(typeof r=="number"){if(r>=0&&n.SheetNames.length>r)return r;throw new Error("Cannot find sheet # "+r)}else if(typeof r=="string"){var _=n.SheetNames.indexOf(r);if(_>-1)return _;throw new Error("Cannot find sheet name |"+r+"|")}else throw new Error("Cannot find sheet |"+r+"|")}function book_new(){return{SheetNames:[],Sheets:{}}}function book_append_sheet(n,r,_,E){var S=1;if(!_)for(;S<=65535&&n.SheetNames.indexOf(_="Sheet"+S)!=-1;++S,_=void 0);if(!_||n.SheetNames.length>=65535)throw new Error("Too many worksheets");if(E&&n.SheetNames.indexOf(_)>=0){var C=_.match(/(^.*?)(\d+)$/);S=C&&+C[2]||0;var A=C&&C[1]||_;for(++S;S<=65535&&n.SheetNames.indexOf(_=A+S)!=-1;++S);}if(check_ws_name(_),n.SheetNames.indexOf(_)>=0)throw new Error("Worksheet with name |"+_+"| already exists!");return n.SheetNames.push(_),n.Sheets[_]=r,_}function book_set_sheet_visibility(n,r,_){n.Workbook||(n.Workbook={}),n.Workbook.Sheets||(n.Workbook.Sheets=[]);var E=wb_sheet_idx(n,r);switch(n.Workbook.Sheets[E]||(n.Workbook.Sheets[E]={}),_){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+_)}n.Workbook.Sheets[E].Hidden=_}function cell_set_number_format(n,r){return n.z=r,n}function cell_set_hyperlink(n,r,_){return r?(n.l={Target:r},_&&(n.l.Tooltip=_)):delete n.l,n}function cell_set_internal_link(n,r,_){return cell_set_hyperlink(n,"#"+r,_)}function cell_add_comment(n,r,_){n.c||(n.c=[]),n.c.push({t:r,a:_||"SheetJS"})}function sheet_set_array_formula(n,r,_,E){for(var S=typeof r!="string"?r:safe_decode_range(r),C=typeof r=="string"?r:encode_range(r),A=S.s.r;A<=S.e.r;++A)for(var I=S.s.c;I<=S.e.c;++I){var B=ws_get_cell_stub(n,A,I);B.t="n",B.F=C,delete B.v,A==S.s.r&&I==S.s.c&&(B.f=_,E&&(B.D=!0))}var O=decode_range(n["!ref"]);return O.s.r>S.s.r&&(O.s.r=S.s.r),O.s.c>S.s.c&&(O.s.c=S.s.c),O.e.r<S.e.r&&(O.e.r=S.e.r),O.e.c<S.e.c&&(O.e.c=S.e.c),n["!ref"]=encode_range(O),n}var utils={encode_col,encode_row,encode_cell,encode_range,decode_col,decode_row,split_cell,decode_cell,decode_range,format_cell,sheet_add_aoa,sheet_add_json,sheet_add_dom,aoa_to_sheet,json_to_sheet,table_to_sheet:parse_dom_table,table_to_book,sheet_to_csv,sheet_to_txt,sheet_to_json,sheet_to_html,sheet_to_formulae,sheet_to_row_object_array:sheet_to_json,sheet_get_cell:ws_get_cell_stub,book_new,book_append_sheet,book_set_sheet_visibility,cell_set_number_format,cell_set_hyperlink,cell_set_internal_link,cell_add_comment,sheet_set_array_formula,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}},_Readable;function set_readable(n){_Readable=n}function write_csv_stream(n,r){var _=_Readable(),E=r??{};if(n==null||n["!ref"]==null)return _.push(null),_;for(var S=safe_decode_range(n["!ref"]),C=E.FS!==void 0?E.FS:",",A=C.charCodeAt(0),I=E.RS!==void 0?E.RS:`
`,B=I.charCodeAt(0),O=new RegExp((C=="|"?"\\|":C)+"+$"),N="",U=[],j=E.skipHidden&&n["!cols"]||[],z=E.skipHidden&&n["!rows"]||[],Z=S.s.c;Z<=S.e.c;++Z)(j[Z]||{}).hidden||(U[Z]=encode_col(Z));var X=S.s.r,Q=!1,se=0;return _._read=function(){if(!Q)return Q=!0,_.push("\uFEFF");for(;X<=S.e.r;)if(++X,!(z[X-1]||{}).hidden&&(N=make_csv_row(n,S,X-1,U,A,B,C,E),N!=null&&(E.strip&&(N=N.replace(O,"")),N||E.blankrows!==!1)))return _.push((se++?I:"")+N);return _.push(null)},_}function write_html_stream(n,r){var _=_Readable(),E=r||{},S=E.header!=null?E.header:HTML_BEGIN,C=E.footer!=null?E.footer:HTML_END;_.push(S);var A=decode_range(n["!ref"]);_.push(make_html_preamble(n,A,E));var I=A.s.r,B=!1;return _._read=function(){if(I>A.e.r)return B||(B=!0,_.push("</table>"+C)),_.push(null);for(;I<=A.e.r;){_.push(make_html_row(n,A,I,E)),++I;break}},_}function write_json_stream(n,r){var _=_Readable({objectMode:!0});if(n==null||n["!ref"]==null)return _.push(null),_;var E={t:"n",v:0},S=0,C=1,A=[],I=0,B="",O={s:{r:0,c:0},e:{r:0,c:0}},N=r||{},U=N.range!=null?N.range:n["!ref"];switch(N.header===1?S=1:N.header==="A"?S=2:Array.isArray(N.header)&&(S=3),typeof U){case"string":O=safe_decode_range(U);break;case"number":O=safe_decode_range(n["!ref"]),O.s.r=U;break;default:O=U}S>0&&(C=0);var j=encode_row(O.s.r),z=[],Z=0,X=n["!data"]!=null,Q=O.s.r,se=0,oe={};X&&!n["!data"][Q]&&(n["!data"][Q]=[]);var ue=N.skipHidden&&n["!cols"]||[],we=N.skipHidden&&n["!rows"]||[];for(se=O.s.c;se<=O.e.c;++se)if(!(ue[se]||{}).hidden)switch(z[se]=encode_col(se),E=X?n["!data"][Q][se]:n[z[se]+j],S){case 1:A[se]=se-O.s.c;break;case 2:A[se]=z[se];break;case 3:A[se]=N.header[se-O.s.c];break;default:if(E==null&&(E={w:"__EMPTY",t:"s"}),B=I=format_cell(E,null,N),Z=oe[I]||0,!Z)oe[I]=1;else{do B=I+"_"+Z++;while(oe[B]);oe[I]=Z,oe[B]=1}A[se]=B}return Q=O.s.r+C,_._read=function(){for(;Q<=O.e.r;)if(!(we[Q-1]||{}).hidden){var Te=make_json_row(n,O,Q,z,S,A,N);if(++Q,Te.isempty===!1||(S===1?N.blankrows!==!1:N.blankrows)){_.push(Te.row);return}}return _.push(null)},_}var __stream={to_json:write_json_stream,to_html:write_html_stream,to_csv:write_csv_stream,set_readable};async function importerJSONdURL(n){return await(await axios.get(n)).data}async function importerFeuilleCalculDURL(n,r){const E=(await axios.get(n,{responseType:"arraybuffer"})).data,C=Object.assign({type:"buffer",cellDates:!0},r||{});return readSync(E,C)}class Callable extends Function{constructor(){return Object.setPrototypeOf(function(){},new.target.prototype)}}class ClientMandatairifiable extends Callable{vnements;tches;erreurs;constructor(){super(),this.vnements=new eventsExports.EventEmitter,this.tches={},this.erreurs=[],this.vnements.on("message",r=>{const{type:_}=r;switch(_){case"suivre":{const{id:E,donnes:S}=r;if(!this.tches[E])return;const{fSuivre:C}=this.tches[E];C(S);break}case"suivrePrt":{const{id:E,fonctions:S}=r;this.vnements.emit(E,{fonctions:S});break}case"action":{const{id:E,rsultat:S}=r;this.vnements.emit(E,{rsultat:S});break}case"erreur":{const{erreur:E,id:S}=r;S?this.vnements.emit(S,{erreur:E}):this.erreur({erreur:E,id:S});break}default:this.erreur({erreur:`Type inconnu ${_} dans message ${r}.`,id:r.id})}})}__call__(r,_={}){typeof _!="object"&&this.erreur({erreur:`La fonction ${r.join(".")} fut appele avec arguments ${_}. 
      Toute fonction mandataire Constellation doit tre appele avec un seul argument en format d'objet (dictionnaire).`});const E=v4(),S=Object.entries(_).find(C=>typeof C[1]=="function")?.[0];return S?this.appelerFonctionSuivre(E,r,_,S):this.appelerFonctionAction(E,r,_)}async appelerFonctionSuivre(r,_,E,S){const C=E[S],A=Object.fromEntries(Object.entries(E).filter(z=>typeof z[1]!="function"));C===void 0&&this.erreur({erreur:"Aucun argument de nom "+S+" n'a t donne pour "+_.join(".")}),Object.keys(E).length>Object.keys(A).length+1?this.erreur({erreur:"Plus d'un argument pour "+_.join(".")+" est une fonction : "+JSON.stringify(E),id:r}):typeof C!="function"&&this.erreur({erreur:"Argument "+S+"n'est pas une fonction : ",id:r});const I={type:"suivre",id:r,fonction:_,args:A,nomArgFonction:S},O={id:r,fSuivre:C,fRetour:async(z,Z)=>{const X={type:"retour",id:r,fonction:z,args:Z};this.envoyerMessage(X)}};this.tches[r]=O;const N=async()=>{await this.oublierTche(r)};this.envoyerMessage(I);const{fonctions:U,erreur:j}=(await once_1(this.vnements,r))[0];if(j&&this.erreur({erreur:j,id:r}),U&&U[0]){const z={fOublier:N};for(const Z of U)z[Z]=async(...X)=>{await this.tches[r]?.fRetour(Z,X)};return z}else return N}async appelerFonctionAction(r,_,E){const S={type:"action",id:r,fonction:_,args:E},C=new Promise((A,I)=>{once_1(this.vnements,r).then(B=>{const{rsultat:O,erreur:N}=B[0];N?I(new Error(N)):A(O)})});return this.envoyerMessage(S),C}erreur({erreur:r,id:_}){const E={erreur:r,id:_};throw this.vnements.emit("erreur",{nouvelle:E,toutes:this.erreurs}),new Error(JSON.stringify(E))}async oublierTche(r){const _=this.tches[r];_&&await _.fRetour("fOublier"),delete this.tches[r]}}class Handler{listeAtributs;constructor(r){this.listeAtributs=r||[]}get(r,_){if(["vnements","erreurs"].includes(_))return r[_];{const S=[...this.listeAtributs,_],C=new Handler(S);return new Proxy(r,C)}}apply(r,_,E){return r.__call__(this.listeAtributs,E[0])}}const gnrerMandataire=n=>{const r=new Handler;return new Proxy(n,r)};function __decorate(n,r,_,E){var S=arguments.length,C=S<3?r:E===null?E=Object.getOwnPropertyDescriptor(r,_):E,A;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")C=Reflect.decorate(n,r,_,E);else for(var I=n.length-1;I>=0;I--)(A=n[I])&&(C=(S<3?A(C):S>3?A(r,_,C):A(r,_))||C);return S>3&&C&&Object.defineProperty(r,_,C),C}typeof SuppressedError=="function"&&SuppressedError;function assign(n,r){for(const _ in r)Object.defineProperty(n,_,{value:r[_],enumerable:!0,configurable:!0});return n}function createError(n,r,_){if(!n||typeof n=="string")throw new TypeError("Please pass an Error to err-code");_||(_={}),typeof r=="object"&&(_=r,r=""),r&&(_.code=r);try{return assign(n,_)}catch{_.message=n.message,_.stack=n.stack;const S=function(){};return S.prototype=Object.create(Object.getPrototypeOf(n)),assign(new S,_)}}var errCode=createError;const errCode$1=getDefaultExportFromCjs(errCode);function isAsyncIterable$d(n){return n[Symbol.asyncIterator]!=null}function first(n){if(isAsyncIterable$d(n))return(async()=>{for await(const r of n)return r})();for(const r of n)return r}function isAsyncIterable$c(n){return n[Symbol.asyncIterator]!=null}function batch(n,r=1){return r=Number(r),isAsyncIterable$c(n)?async function*(){let _=[];if(r<1&&(r=1),r!==Math.round(r))throw new Error("Batch size must be an integer");for await(const E of n)for(_.push(E);_.length>=r;)yield _.slice(0,r),_=_.slice(r);for(;_.length>0;)yield _.slice(0,r),_=_.slice(r)}():function*(){let _=[];if(r<1&&(r=1),r!==Math.round(r))throw new Error("Batch size must be an integer");for(const E of n)for(_.push(E);_.length>=r;)yield _.slice(0,r),_=_.slice(r);for(;_.length>0;)yield _.slice(0,r),_=_.slice(r)}()}async function*parallelBatch(n,r=1){for await(const _ of batch(n,r)){const E=_.map(async S=>S().then(C=>({ok:!0,value:C}),C=>({ok:!1,err:C})));for(let S=0;S<E.length;S++){const C=await E[S];if(C.ok)yield C.value;else throw C.err}}}const symbol$2=Symbol.for("@achingbrain/uint8arraylist");function findBufAndOffset(n,r){if(r==null||r<0)throw new RangeError("index is out of bounds");let _=0;for(const E of n){const S=_+E.byteLength;if(r<S)return{buf:E,index:r-_};_=S}throw new RangeError("index is out of bounds")}function isUint8ArrayList(n){return!!n?.[symbol$2]}class Uint8ArrayList{bufs;length;[symbol$2]=!0;constructor(...r){this.bufs=[],this.length=0,r.length>0&&this.appendAll(r)}*[Symbol.iterator](){yield*this.bufs}get byteLength(){return this.length}append(...r){this.appendAll(r)}appendAll(r){let _=0;for(const E of r)if(E instanceof Uint8Array)_+=E.byteLength,this.bufs.push(E);else if(isUint8ArrayList(E))_+=E.byteLength,this.bufs.push(...E.bufs);else throw new Error("Could not append value, must be an Uint8Array or a Uint8ArrayList");this.length+=_}prepend(...r){this.prependAll(r)}prependAll(r){let _=0;for(const E of r.reverse())if(E instanceof Uint8Array)_+=E.byteLength,this.bufs.unshift(E);else if(isUint8ArrayList(E))_+=E.byteLength,this.bufs.unshift(...E.bufs);else throw new Error("Could not prepend value, must be an Uint8Array or a Uint8ArrayList");this.length+=_}get(r){const _=findBufAndOffset(this.bufs,r);return _.buf[_.index]}set(r,_){const E=findBufAndOffset(this.bufs,r);E.buf[E.index]=_}write(r,_=0){if(r instanceof Uint8Array)for(let E=0;E<r.length;E++)this.set(_+E,r[E]);else if(isUint8ArrayList(r))for(let E=0;E<r.length;E++)this.set(_+E,r.get(E));else throw new Error("Could not write value, must be an Uint8Array or a Uint8ArrayList")}consume(r){if(r=Math.trunc(r),!(Number.isNaN(r)||r<=0)){if(r===this.byteLength){this.bufs=[],this.length=0;return}for(;this.bufs.length>0;)if(r>=this.bufs[0].byteLength)r-=this.bufs[0].byteLength,this.length-=this.bufs[0].byteLength,this.bufs.shift();else{this.bufs[0]=this.bufs[0].subarray(r),this.length-=r;break}}}slice(r,_){const{bufs:E,length:S}=this._subList(r,_);return concat$4(E,S)}subarray(r,_){const{bufs:E,length:S}=this._subList(r,_);return E.length===1?E[0]:concat$4(E,S)}sublist(r,_){const{bufs:E,length:S}=this._subList(r,_),C=new Uint8ArrayList;return C.length=S,C.bufs=[...E],C}_subList(r,_){if(r=r??0,_=_??this.length,r<0&&(r=this.length+r),_<0&&(_=this.length+_),r<0||_>this.length)throw new RangeError("index is out of bounds");if(r===_)return{bufs:[],length:0};if(r===0&&_===this.length)return{bufs:this.bufs,length:this.length};const E=[];let S=0;for(let C=0;C<this.bufs.length;C++){const A=this.bufs[C],I=S,B=I+A.byteLength;if(S=B,r>=B)continue;const O=r>=I&&r<B,N=_>I&&_<=B;if(O&&N){if(r===I&&_===B){E.push(A);break}const U=r-I;E.push(A.subarray(U,U+(_-r)));break}if(O){if(r===0){E.push(A);continue}E.push(A.subarray(r-I));continue}if(N){if(_===B){E.push(A);break}E.push(A.subarray(0,_-I));break}E.push(A)}return{bufs:E,length:_-r}}indexOf(r,_=0){if(!isUint8ArrayList(r)&&!(r instanceof Uint8Array))throw new TypeError('The "value" argument must be a Uint8ArrayList or Uint8Array');const E=r instanceof Uint8Array?r:r.subarray();if(_=Number(_??0),isNaN(_)&&(_=0),_<0&&(_=this.length+_),_<0&&(_=0),r.length===0)return _>this.length?this.length:_;const S=E.byteLength;if(S===0)throw new TypeError("search must be at least 1 byte long");const C=256,A=new Int32Array(C);for(let U=0;U<C;U++)A[U]=-1;for(let U=0;U<S;U++)A[E[U]]=U;const I=A,B=this.byteLength-E.byteLength,O=E.byteLength-1;let N;for(let U=_;U<=B;U+=N){N=0;for(let j=O;j>=0;j--){const z=this.get(U+j);if(E[j]!==z){N=Math.max(1,j-I[z]);break}}if(N===0)return U}return-1}getInt8(r){const _=this.subarray(r,r+1);return new DataView(_.buffer,_.byteOffset,_.byteLength).getInt8(0)}setInt8(r,_){const E=allocUnsafe$1(1);new DataView(E.buffer,E.byteOffset,E.byteLength).setInt8(0,_),this.write(E,r)}getInt16(r,_){const E=this.subarray(r,r+2);return new DataView(E.buffer,E.byteOffset,E.byteLength).getInt16(0,_)}setInt16(r,_,E){const S=alloc$1(2);new DataView(S.buffer,S.byteOffset,S.byteLength).setInt16(0,_,E),this.write(S,r)}getInt32(r,_){const E=this.subarray(r,r+4);return new DataView(E.buffer,E.byteOffset,E.byteLength).getInt32(0,_)}setInt32(r,_,E){const S=alloc$1(4);new DataView(S.buffer,S.byteOffset,S.byteLength).setInt32(0,_,E),this.write(S,r)}getBigInt64(r,_){const E=this.subarray(r,r+8);return new DataView(E.buffer,E.byteOffset,E.byteLength).getBigInt64(0,_)}setBigInt64(r,_,E){const S=alloc$1(8);new DataView(S.buffer,S.byteOffset,S.byteLength).setBigInt64(0,_,E),this.write(S,r)}getUint8(r){const _=this.subarray(r,r+1);return new DataView(_.buffer,_.byteOffset,_.byteLength).getUint8(0)}setUint8(r,_){const E=allocUnsafe$1(1);new DataView(E.buffer,E.byteOffset,E.byteLength).setUint8(0,_),this.write(E,r)}getUint16(r,_){const E=this.subarray(r,r+2);return new DataView(E.buffer,E.byteOffset,E.byteLength).getUint16(0,_)}setUint16(r,_,E){const S=alloc$1(2);new DataView(S.buffer,S.byteOffset,S.byteLength).setUint16(0,_,E),this.write(S,r)}getUint32(r,_){const E=this.subarray(r,r+4);return new DataView(E.buffer,E.byteOffset,E.byteLength).getUint32(0,_)}setUint32(r,_,E){const S=alloc$1(4);new DataView(S.buffer,S.byteOffset,S.byteLength).setUint32(0,_,E),this.write(S,r)}getBigUint64(r,_){const E=this.subarray(r,r+8);return new DataView(E.buffer,E.byteOffset,E.byteLength).getBigUint64(0,_)}setBigUint64(r,_,E){const S=alloc$1(8);new DataView(S.buffer,S.byteOffset,S.byteLength).setBigUint64(0,_,E),this.write(S,r)}getFloat32(r,_){const E=this.subarray(r,r+4);return new DataView(E.buffer,E.byteOffset,E.byteLength).getFloat32(0,_)}setFloat32(r,_,E){const S=alloc$1(4);new DataView(S.buffer,S.byteOffset,S.byteLength).setFloat32(0,_,E),this.write(S,r)}getFloat64(r,_){const E=this.subarray(r,r+8);return new DataView(E.buffer,E.byteOffset,E.byteLength).getFloat64(0,_)}setFloat64(r,_,E){const S=alloc$1(8);new DataView(S.buffer,S.byteOffset,S.byteLength).setFloat64(0,_,E),this.write(S,r)}equals(r){if(r==null||!(r instanceof Uint8ArrayList)||r.bufs.length!==this.bufs.length)return!1;for(let _=0;_<this.bufs.length;_++)if(!equals$1(this.bufs[_],r.bufs[_]))return!1;return!0}static fromUint8Arrays(r,_){const E=new Uint8ArrayList;return E.bufs=r,_==null&&(_=r.reduce((S,C)=>S+C.byteLength,0)),E.length=_,E}}const DEFAULT_CHUNK_SIZE=262144,fixedSize=(n={})=>{const r=n.chunkSize??DEFAULT_CHUNK_SIZE;return async function*(E){let S=new Uint8ArrayList,C=0,A=!1;for await(const I of E)for(S.append(I),C+=I.length;C>=r;)if(yield S.slice(0,r),A=!0,r===S.length)S=new Uint8ArrayList,C=0;else{const B=new Uint8ArrayList;B.append(S.sublist(r)),S=B,C-=r}(!A||C>0)&&(yield S.subarray(0,C))}},textDecoder$1=new TextDecoder;function decodeVarint(n,r){let _=0;for(let E=0;;E+=7){if(E>=64)throw new Error("protobuf: varint overflow");if(r>=n.length)throw new Error("protobuf: unexpected end of data");const S=n[r++];if(_+=E<28?(S&127)<<E:(S&127)*2**E,S<128)break}return[_,r]}function decodeBytes(n,r){let _;[_,r]=decodeVarint(n,r);const E=r+_;if(_<0||E<0)throw new Error("protobuf: invalid length");if(E>n.length)throw new Error("protobuf: unexpected end of data");return[n.subarray(r,E),E]}function decodeKey(n,r){let _;return[_,r]=decodeVarint(n,r),[_&7,_>>3,r]}function decodeLink(n){const r={},_=n.length;let E=0;for(;E<_;){let S,C;if([S,C,E]=decodeKey(n,E),C===1){if(r.Hash)throw new Error("protobuf: (PBLink) duplicate Hash section");if(S!==2)throw new Error(`protobuf: (PBLink) wrong wireType (${S}) for Hash`);if(r.Name!==void 0)throw new Error("protobuf: (PBLink) invalid order, found Name before Hash");if(r.Tsize!==void 0)throw new Error("protobuf: (PBLink) invalid order, found Tsize before Hash");[r.Hash,E]=decodeBytes(n,E)}else if(C===2){if(r.Name!==void 0)throw new Error("protobuf: (PBLink) duplicate Name section");if(S!==2)throw new Error(`protobuf: (PBLink) wrong wireType (${S}) for Name`);if(r.Tsize!==void 0)throw new Error("protobuf: (PBLink) invalid order, found Tsize before Name");let A;[A,E]=decodeBytes(n,E),r.Name=textDecoder$1.decode(A)}else if(C===3){if(r.Tsize!==void 0)throw new Error("protobuf: (PBLink) duplicate Tsize section");if(S!==0)throw new Error(`protobuf: (PBLink) wrong wireType (${S}) for Tsize`);[r.Tsize,E]=decodeVarint(n,E)}else throw new Error(`protobuf: (PBLink) invalid fieldNumber, expected 1, 2 or 3, got ${C}`)}if(E>_)throw new Error("protobuf: (PBLink) unexpected end of data");return r}function decodeNode(n){const r=n.length;let _=0,E,S=!1,C;for(;_<r;){let I,B;if([I,B,_]=decodeKey(n,_),I!==2)throw new Error(`protobuf: (PBNode) invalid wireType, expected 2, got ${I}`);if(B===1){if(C)throw new Error("protobuf: (PBNode) duplicate Data section");[C,_]=decodeBytes(n,_),E&&(S=!0)}else if(B===2){if(S)throw new Error("protobuf: (PBNode) duplicate Links section");E||(E=[]);let O;[O,_]=decodeBytes(n,_),E.push(decodeLink(O))}else throw new Error(`protobuf: (PBNode) invalid fieldNumber, expected 1 or 2, got ${B}`)}if(_>r)throw new Error("protobuf: (PBNode) unexpected end of data");const A={};return C&&(A.Data=C),A.Links=E||[],A}const textEncoder$2=new TextEncoder,maxInt32=2**32,maxUInt32=2**31;function encodeLink(n,r){let _=r.length;if(typeof n.Tsize=="number"){if(n.Tsize<0)throw new Error("Tsize cannot be negative");if(!Number.isSafeInteger(n.Tsize))throw new Error("Tsize too large for encoding");_=encodeVarint(r,_,n.Tsize)-1,r[_]=24}if(typeof n.Name=="string"){const E=textEncoder$2.encode(n.Name);_-=E.length,r.set(E,_),_=encodeVarint(r,_,E.length)-1,r[_]=18}return n.Hash&&(_-=n.Hash.length,r.set(n.Hash,_),_=encodeVarint(r,_,n.Hash.length)-1,r[_]=10),r.length-_}function encodeNode(n){const r=sizeNode(n),_=new Uint8Array(r);let E=r;if(n.Data&&(E-=n.Data.length,_.set(n.Data,E),E=encodeVarint(_,E,n.Data.length)-1,_[E]=10),n.Links)for(let S=n.Links.length-1;S>=0;S--){const C=encodeLink(n.Links[S],_.subarray(0,E));E-=C,E=encodeVarint(_,E,C)-1,_[E]=18}return _}function sizeLink(n){let r=0;if(n.Hash){const _=n.Hash.length;r+=1+_+sov(_)}if(typeof n.Name=="string"){const _=textEncoder$2.encode(n.Name).length;r+=1+_+sov(_)}return typeof n.Tsize=="number"&&(r+=1+sov(n.Tsize)),r}function sizeNode(n){let r=0;if(n.Data){const _=n.Data.length;r+=1+_+sov(_)}if(n.Links)for(const _ of n.Links){const E=sizeLink(_);r+=1+E+sov(E)}return r}function encodeVarint(n,r,_){r-=sov(_);const E=r;for(;_>=maxUInt32;)n[r++]=_&127|128,_/=128;for(;_>=128;)n[r++]=_&127|128,_>>>=7;return n[r]=_,E}function sov(n){return n%2===0&&n++,Math.floor((len64(n)+6)/7)}function len64(n){let r=0;return n>=maxInt32&&(n=Math.floor(n/maxInt32),r=32),n>=65536&&(n>>>=16,r+=16),n>=256&&(n>>>=8,r+=8),r+len8tab[n]}const len8tab=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8],pbNodeProperties=["Data","Links"],pbLinkProperties=["Hash","Name","Tsize"],textEncoder$1=new TextEncoder;function linkComparator(n,r){if(n===r)return 0;const _=n.Name?textEncoder$1.encode(n.Name):[],E=r.Name?textEncoder$1.encode(r.Name):[];let S=_.length,C=E.length;for(let A=0,I=Math.min(S,C);A<I;++A)if(_[A]!==E[A]){S=_[A],C=E[A];break}return S<C?-1:C<S?1:0}function hasOnlyProperties(n,r){return!Object.keys(n).some(_=>!r.includes(_))}function asLink(n){if(typeof n.asCID=="object"){const _=CID.asCID(n);if(!_)throw new TypeError("Invalid DAG-PB form");return{Hash:_}}if(typeof n!="object"||Array.isArray(n))throw new TypeError("Invalid DAG-PB form");const r={};if(n.Hash){let _=CID.asCID(n.Hash);try{_||(typeof n.Hash=="string"?_=CID.parse(n.Hash):n.Hash instanceof Uint8Array&&(_=CID.decode(n.Hash)))}catch(E){throw new TypeError(`Invalid DAG-PB form: ${E.message}`)}_&&(r.Hash=_)}if(!r.Hash)throw new TypeError("Invalid DAG-PB form");return typeof n.Name=="string"&&(r.Name=n.Name),typeof n.Tsize=="number"&&(r.Tsize=n.Tsize),r}function prepare(n){if((n instanceof Uint8Array||typeof n=="string")&&(n={Data:n}),typeof n!="object"||Array.isArray(n))throw new TypeError("Invalid DAG-PB form");const r={};if(n.Data!==void 0)if(typeof n.Data=="string")r.Data=textEncoder$1.encode(n.Data);else if(n.Data instanceof Uint8Array)r.Data=n.Data;else throw new TypeError("Invalid DAG-PB form");if(n.Links!==void 0)if(Array.isArray(n.Links))r.Links=n.Links.map(asLink),r.Links.sort(linkComparator);else throw new TypeError("Invalid DAG-PB form");else r.Links=[];return r}function validate$3(n){if(!n||typeof n!="object"||Array.isArray(n)||n instanceof Uint8Array||n["/"]&&n["/"]===n.bytes)throw new TypeError("Invalid DAG-PB form");if(!hasOnlyProperties(n,pbNodeProperties))throw new TypeError("Invalid DAG-PB form (extraneous properties)");if(n.Data!==void 0&&!(n.Data instanceof Uint8Array))throw new TypeError("Invalid DAG-PB form (Data must be bytes)");if(!Array.isArray(n.Links))throw new TypeError("Invalid DAG-PB form (Links must be a list)");for(let r=0;r<n.Links.length;r++){const _=n.Links[r];if(!_||typeof _!="object"||Array.isArray(_)||_ instanceof Uint8Array||_["/"]&&_["/"]===_.bytes)throw new TypeError("Invalid DAG-PB form (bad link)");if(!hasOnlyProperties(_,pbLinkProperties))throw new TypeError("Invalid DAG-PB form (extraneous properties on link)");if(_.Hash===void 0)throw new TypeError("Invalid DAG-PB form (link must have a Hash)");if(_.Hash==null||!_.Hash["/"]||_.Hash["/"]!==_.Hash.bytes)throw new TypeError("Invalid DAG-PB form (link Hash must be a CID)");if(_.Name!==void 0&&typeof _.Name!="string")throw new TypeError("Invalid DAG-PB form (link Name must be a string)");if(_.Tsize!==void 0){if(typeof _.Tsize!="number"||_.Tsize%1!==0)throw new TypeError("Invalid DAG-PB form (link Tsize must be an integer)");if(_.Tsize<0)throw new TypeError("Invalid DAG-PB form (link Tsize cannot be negative)")}if(r>0&&linkComparator(_,n.Links[r-1])===-1)throw new TypeError("Invalid DAG-PB form (links must be sorted by Name bytes)")}}function createNode$1(n,r=[]){return prepare({Data:n,Links:r})}function createLink(n,r,_){return asLink({Hash:_,Name:n,Tsize:r})}function toByteView$1(n){return n instanceof ArrayBuffer?new Uint8Array(n,0,n.byteLength):n}const name$3="dag-pb",code$2=112;function encode$9(n){validate$3(n);const r={};return n.Links&&(r.Links=n.Links.map(_=>{const E={};return _.Hash&&(E.Hash=_.Hash.bytes),_.Name!==void 0&&(E.Name=_.Name),_.Tsize!==void 0&&(E.Tsize=_.Tsize),E})),n.Data&&(r.Data=n.Data),encodeNode(r)}function decode$9(n){const r=toByteView$1(n),_=decodeNode(r),E={};return _.Data&&(E.Data=_.Data),_.Links&&(E.Links=_.Links.map(S=>{const C={};try{C.Hash=CID.decode(S.Hash)}catch{}if(!C.Hash)throw new Error("Invalid Hash field found in link, expected CID");return S.Name!==void 0&&(C.Name=S.Name),S.Tsize!==void 0&&(C.Tsize=S.Tsize),C})),E}const dagPB=Object.freeze(Object.defineProperty({__proto__:null,code:code$2,createLink,createNode:createNode$1,decode:decode$9,encode:encode$9,name:name$3,prepare,validate:validate$3},Symbol.toStringTag,{value:"Module"}));var Data;(function(n){(function(E){E.Raw="Raw",E.Directory="Directory",E.File="File",E.Metadata="Metadata",E.Symlink="Symlink",E.HAMTShard="HAMTShard"})(n.DataType||(n.DataType={}));let r;(function(E){E[E.Raw=0]="Raw",E[E.Directory=1]="Directory",E[E.File=2]="File",E[E.Metadata=3]="Metadata",E[E.Symlink=4]="Symlink",E[E.HAMTShard=5]="HAMTShard"})(r||(r={})),function(E){E.codec=()=>enumeration(r)}(n.DataType||(n.DataType={}));let _;n.codec=()=>(_==null&&(_=message((E,S,C={})=>{if(C.lengthDelimited!==!1&&S.fork(),E.Type!=null&&(S.uint32(8),n.DataType.codec().encode(E.Type,S)),E.Data!=null&&(S.uint32(18),S.bytes(E.Data)),E.filesize!=null&&(S.uint32(24),S.uint64(E.filesize)),E.blocksizes!=null)for(const A of E.blocksizes)S.uint32(32),S.uint64(A);E.hashType!=null&&(S.uint32(40),S.uint64(E.hashType)),E.fanout!=null&&(S.uint32(48),S.uint64(E.fanout)),E.mode!=null&&(S.uint32(56),S.uint32(E.mode)),E.mtime!=null&&(S.uint32(66),UnixTime.codec().encode(E.mtime,S)),C.lengthDelimited!==!1&&S.ldelim()},(E,S)=>{const C={blocksizes:[]},A=S==null?E.len:E.pos+S;for(;E.pos<A;){const I=E.uint32();switch(I>>>3){case 1:C.Type=n.DataType.codec().decode(E);break;case 2:C.Data=E.bytes();break;case 3:C.filesize=E.uint64();break;case 4:C.blocksizes.push(E.uint64());break;case 5:C.hashType=E.uint64();break;case 6:C.fanout=E.uint64();break;case 7:C.mode=E.uint32();break;case 8:C.mtime=UnixTime.codec().decode(E,E.uint32());break;default:E.skipType(I&7);break}}return C})),_),n.encode=E=>encodeMessage(E,n.codec()),n.decode=E=>decodeMessage$1(E,n.codec())})(Data||(Data={}));var UnixTime;(function(n){let r;n.codec=()=>(r==null&&(r=message((_,E,S={})=>{S.lengthDelimited!==!1&&E.fork(),_.Seconds!=null&&(E.uint32(8),E.int64(_.Seconds)),_.FractionalNanoseconds!=null&&(E.uint32(21),E.fixed32(_.FractionalNanoseconds)),S.lengthDelimited!==!1&&E.ldelim()},(_,E)=>{const S={},C=E==null?_.len:_.pos+E;for(;_.pos<C;){const A=_.uint32();switch(A>>>3){case 1:S.Seconds=_.int64();break;case 2:S.FractionalNanoseconds=_.fixed32();break;default:_.skipType(A&7);break}}return S})),r),n.encode=_=>encodeMessage(_,n.codec()),n.decode=_=>decodeMessage$1(_,n.codec())})(UnixTime||(UnixTime={}));var Metadata;(function(n){let r;n.codec=()=>(r==null&&(r=message((_,E,S={})=>{S.lengthDelimited!==!1&&E.fork(),_.MimeType!=null&&(E.uint32(10),E.string(_.MimeType)),S.lengthDelimited!==!1&&E.ldelim()},(_,E)=>{const S={},C=E==null?_.len:_.pos+E;for(;_.pos<C;){const A=_.uint32();switch(A>>>3){case 1:S.MimeType=_.string();break;default:_.skipType(A&7);break}}return S})),r),n.encode=_=>encodeMessage(_,n.codec()),n.decode=_=>decodeMessage$1(_,n.codec())})(Metadata||(Metadata={}));const types={Raw:"raw",Directory:"directory",File:"file",Metadata:"metadata",Symlink:"symlink",HAMTShard:"hamt-sharded-directory"},dirTypes=["directory","hamt-sharded-directory"],DEFAULT_FILE_MODE=parseInt("0644",8),DEFAULT_DIRECTORY_MODE=parseInt("0755",8);class UnixFS{static unmarshal(r){const _=Data.decode(r),E=new UnixFS({type:types[_.Type!=null?_.Type.toString():"File"],data:_.Data,blockSizes:_.blocksizes,mode:_.mode,mtime:_.mtime!=null?{secs:_.mtime.Seconds??0n,nsecs:_.mtime.FractionalNanoseconds}:void 0,fanout:_.fanout});return E._originalMode=_.mode??0,E}type;data;blockSizes;hashType;fanout;mtime;_mode;_originalMode;constructor(r={type:"file"}){const{type:_,data:E,blockSizes:S,hashType:C,fanout:A,mtime:I,mode:B}=r;if(_!=null&&!Object.values(types).includes(_))throw errCode$1(new Error("Type: "+_+" is not valid"),"ERR_INVALID_TYPE");this.type=_??"file",this.data=E,this.hashType=C,this.fanout=A,this.blockSizes=S??[],this._originalMode=0,this.mode=B,this.mtime=I}set mode(r){r==null?this._mode=this.isDirectory()?DEFAULT_DIRECTORY_MODE:DEFAULT_FILE_MODE:this._mode=r&4095}get mode(){return this._mode}isDirectory(){return dirTypes.includes(this.type)}addBlockSize(r){this.blockSizes.push(r)}removeBlockSize(r){this.blockSizes.splice(r,1)}fileSize(){if(this.isDirectory())return 0n;let r=0n;return this.blockSizes.forEach(_=>{r+=_}),this.data!=null&&(r+=BigInt(this.data.length)),r}marshal(){let r;switch(this.type){case"raw":r=Data.DataType.Raw;break;case"directory":r=Data.DataType.Directory;break;case"file":r=Data.DataType.File;break;case"metadata":r=Data.DataType.Metadata;break;case"symlink":r=Data.DataType.Symlink;break;case"hamt-sharded-directory":r=Data.DataType.HAMTShard;break;default:throw errCode$1(new Error(`Type: ${r} is not valid`),"ERR_INVALID_TYPE")}let _=this.data;(this.data==null||this.data.length===0)&&(_=void 0);let E;this.mode!=null&&(E=this._originalMode&4294963200|(this.mode??0),E===DEFAULT_FILE_MODE&&!this.isDirectory()&&(E=void 0),E===DEFAULT_DIRECTORY_MODE&&this.isDirectory()&&(E=void 0));let S;return this.mtime!=null&&(S={Seconds:this.mtime.secs,FractionalNanoseconds:this.mtime.nsecs}),Data.encode({Type:r,Data:_,filesize:this.isDirectory()?void 0:this.fileSize(),blocksizes:this.blockSizes,hashType:this.hashType,fanout:this.fanout,mode:E,mtime:S})}}class CustomProgressEvent extends Event{constructor(r,_){super(r),this.detail=_}}const persist$1=async(n,r,_)=>{_.codec==null&&(_.codec=dagPB);const E=await sha256$6.digest(n),S=CID.create(_.cidVersion,_.codec.code,E);return await r.put(S,n,_),S};function defaultBufferImporter(n){return async function*(_,E){let S=0n;for await(let C of _.content)yield async()=>{let A;const I={codec:dagPB,cidVersion:n.cidVersion,onProgress:n.onProgress};n.rawLeaves?(I.codec=raw,I.cidVersion=1):(A=new UnixFS({type:n.leafType,data:C}),C=encode$9({Data:A.marshal(),Links:[]}));const B=await persist$1(C,E,I);return S+=BigInt(C.byteLength),n.onProgress?.(new CustomProgressEvent("unixfs:importer:progress:file:write",{bytesWritten:S,cid:B,path:_.path})),{cid:B,unixfs:A,size:BigInt(C.length),block:C}}}}const dirBuilder=async(n,r,_)=>{const E=new UnixFS({type:"directory",mtime:n.mtime,mode:n.mode}),S=encode$9(prepare({Data:E.marshal()})),C=await persist$1(S,r,_),A=n.path;return{cid:C,path:A,unixfs:E,size:BigInt(S.length),originalPath:n.originalPath,block:S}};async function*buildFileBatch(n,r,_){let E=-1,S;for await(const C of parallelBatch(_.bufferImporter(n,r),_.blockWriteConcurrency)){if(E++,E===0){S={...C,single:!0};continue}else E===1&&S!=null&&(yield{...S,block:void 0,single:void 0},S=void 0);yield{...C,block:void 0}}S!=null&&(yield S)}function isSingleBlockImport(n){return n.single===!0}const reduce=(n,r,_)=>async function(S){if(S.length===1&&isSingleBlockImport(S[0])&&_.reduceSingleLeafToSelf){const N=S[0];let U=N.block;return isSingleBlockImport(N)&&(n.mtime!==void 0||n.mode!==void 0)&&(N.unixfs=new UnixFS({type:"file",mtime:n.mtime,mode:n.mode,data:N.block}),U={Data:N.unixfs.marshal(),Links:[]},N.block=encode$9(prepare(U)),N.cid=await persist$1(N.block,r,{..._,cidVersion:_.cidVersion}),N.size=BigInt(N.block.length)),_.onProgress?.(new CustomProgressEvent("unixfs:importer:progress:file:layout",{cid:N.cid,path:N.originalPath})),{cid:N.cid,path:n.path,unixfs:N.unixfs,size:N.size,originalPath:N.originalPath}}const C=new UnixFS({type:"file",mtime:n.mtime,mode:n.mode}),A=S.filter(N=>N.cid.code===code$6&&N.size>0||N.unixfs!=null&&N.unixfs.data==null&&N.unixfs.fileSize()>0n?!0:!!N.unixfs?.data?.length).map(N=>N.cid.code===code$6?(C.addBlockSize(N.size),{Name:"",Tsize:Number(N.size),Hash:N.cid}):(N.unixfs==null||N.unixfs.data==null?C.addBlockSize(N.unixfs?.fileSize()??0n):C.addBlockSize(BigInt(N.unixfs.data.length)),{Name:"",Tsize:Number(N.size),Hash:N.cid})),I={Data:C.marshal(),Links:A},B=encode$9(prepare(I)),O=await persist$1(B,r,_);return _.onProgress?.(new CustomProgressEvent("unixfs:importer:progress:file:layout",{cid:O,path:n.originalPath})),{cid:O,path:n.path,unixfs:C,size:BigInt(B.length+I.Links.reduce((N,U)=>N+(U.Tsize??0),0)),originalPath:n.originalPath,block:B}},fileBuilder=async(n,r,_)=>_.layout(buildFileBatch(n,r,_),reduce(n,r,_));function isIterable(n){return Symbol.iterator in n}function isAsyncIterable$b(n){return Symbol.asyncIterator in n}function contentAsAsyncIterable(n){try{if(n instanceof Uint8Array)return async function*(){yield n}();if(isIterable(n))return async function*(){yield*n}();if(isAsyncIterable$b(n))return n}catch{throw errCode$1(new Error("Content was invalid"),"ERR_INVALID_CONTENT")}throw errCode$1(new Error("Content was invalid"),"ERR_INVALID_CONTENT")}function defaultDagBuilder(n){return async function*(_,E){for await(const S of _){let C;if(S.path!=null&&(C=S.path,S.path=S.path.split("/").filter(A=>A!=null&&A!==".").join("/")),isFileCandidate(S)){const A={path:S.path,mtime:S.mtime,mode:S.mode,content:async function*(){let I=0n;for await(const B of n.chunker(n.chunkValidator(contentAsAsyncIterable(S.content)))){const O=BigInt(B.byteLength);I+=O,n.onProgress?.(new CustomProgressEvent("unixfs:importer:progress:file:read",{bytesRead:I,chunkSize:O,path:S.path})),yield B}}(),originalPath:C};yield async()=>fileBuilder(A,E,n)}else if(S.path!=null){const A={path:S.path,mtime:S.mtime,mode:S.mode,originalPath:C};yield async()=>dirBuilder(A,E,n)}else throw new Error("Import candidate must have content or path or both")}}}function isFileCandidate(n){return n.content!=null}const defaultChunkValidator=()=>async function*(r){for await(const _ of r){if(_.length===void 0)throw errCode$1(new Error("Content was invalid"),"ERR_INVALID_CONTENT");if(typeof _=="string"||_ instanceof String)yield fromString$3(_.toString());else if(Array.isArray(_))yield Uint8Array.from(_);else if(_ instanceof Uint8Array)yield _;else throw errCode$1(new Error("Content was invalid"),"ERR_INVALID_CONTENT")}},DEFAULT_MAX_CHILDREN_PER_NODE=174;function balanced(n){const r=n?.maxChildrenPerNode??DEFAULT_MAX_CHILDREN_PER_NODE;return async function _(E,S){const C=[];for await(const A of batch(E,r))C.push(await S(A));return C.length>1?_(C,S):C[0]}}function isAsyncIterable$a(n){return n[Symbol.asyncIterator]!=null}function all$1(n){if(isAsyncIterable$a(n))return(async()=>{const _=[];for await(const E of n)_.push(E);return _})();const r=[];for(const _ of n)r.push(_);return r}let Dir$1=class{options;root;dir;path;dirty;flat;parent;parentKey;unixfs;mode;mtime;cid;size;nodeSize;constructor(r,_){this.options=_??{},this.root=r.root,this.dir=r.dir,this.path=r.path,this.dirty=r.dirty,this.flat=r.flat,this.parent=r.parent,this.parentKey=r.parentKey,this.unixfs=r.unixfs,this.mode=r.mode,this.mtime=r.mtime}};const CID_V0$1=CID.parse("QmUNLLsPACCz1vLxQVkXqqLX5R1X345qqfHbsf67hvA3Nn"),CID_V1$1=CID.parse("zdj7WbTaiJT1fgatdet9Ei9iDB5hdCxkbVyhyh8YTUnXMiwYi");class DirFlat extends Dir$1{_children;constructor(r,_){super(r,_),this._children=new Map}async put(r,_){this.cid=void 0,this.size=void 0,this.nodeSize=void 0,this._children.set(r,_)}async get(r){return Promise.resolve(this._children.get(r))}childCount(){return this._children.size}directChildrenCount(){return this.childCount()}onlyChild(){return this._children.values().next().value}async*eachChildSeries(){for(const[r,_]of this._children.entries())yield{key:r,child:_}}estimateNodeSize(){if(this.nodeSize!==void 0)return this.nodeSize;this.nodeSize=0;for(const[r,_]of this._children.entries())_.size!=null&&_.cid!=null&&(this.nodeSize+=r.length+(this.options.cidVersion===1?CID_V1$1.bytes.byteLength:CID_V0$1.bytes.byteLength));return this.nodeSize}async*flush(r){const _=[];for(const[B,O]of this._children.entries()){let N=O;if(O instanceof Dir$1)for await(const U of O.flush(r))N=U,yield U;N.size!=null&&N.cid!=null&&_.push({Name:B,Tsize:Number(N.size),Hash:N.cid})}const E=new UnixFS({type:"directory",mtime:this.mtime,mode:this.mode}),S={Data:E.marshal(),Links:_},C=encode$9(prepare(S)),A=await persist$1(C,r,this.options),I=C.length+S.Links.reduce((B,O)=>B+(O.Tsize==null?0:O.Tsize),0);this.cid=A,this.size=I,yield{cid:A,unixfs:E,path:this.path,size:BigInt(I)}}}var murmurHash3js={exports:{}};(function(n,r){(function(_,E){var S={version:"3.0.0",x86:{},x64:{},inputValidation:!0};function C(X){if(!Array.isArray(X)&&!ArrayBuffer.isView(X))return!1;for(var Q=0;Q<X.length;Q++)if(!Number.isInteger(X[Q])||X[Q]<0||X[Q]>255)return!1;return!0}function A(X,Q){return(X&65535)*Q+(((X>>>16)*Q&65535)<<16)}function I(X,Q){return X<<Q|X>>>32-Q}function B(X){return X^=X>>>16,X=A(X,2246822507),X^=X>>>13,X=A(X,3266489909),X^=X>>>16,X}function O(X,Q){X=[X[0]>>>16,X[0]&65535,X[1]>>>16,X[1]&65535],Q=[Q[0]>>>16,Q[0]&65535,Q[1]>>>16,Q[1]&65535];var se=[0,0,0,0];return se[3]+=X[3]+Q[3],se[2]+=se[3]>>>16,se[3]&=65535,se[2]+=X[2]+Q[2],se[1]+=se[2]>>>16,se[2]&=65535,se[1]+=X[1]+Q[1],se[0]+=se[1]>>>16,se[1]&=65535,se[0]+=X[0]+Q[0],se[0]&=65535,[se[0]<<16|se[1],se[2]<<16|se[3]]}function N(X,Q){X=[X[0]>>>16,X[0]&65535,X[1]>>>16,X[1]&65535],Q=[Q[0]>>>16,Q[0]&65535,Q[1]>>>16,Q[1]&65535];var se=[0,0,0,0];return se[3]+=X[3]*Q[3],se[2]+=se[3]>>>16,se[3]&=65535,se[2]+=X[2]*Q[3],se[1]+=se[2]>>>16,se[2]&=65535,se[2]+=X[3]*Q[2],se[1]+=se[2]>>>16,se[2]&=65535,se[1]+=X[1]*Q[3],se[0]+=se[1]>>>16,se[1]&=65535,se[1]+=X[2]*Q[2],se[0]+=se[1]>>>16,se[1]&=65535,se[1]+=X[3]*Q[1],se[0]+=se[1]>>>16,se[1]&=65535,se[0]+=X[0]*Q[3]+X[1]*Q[2]+X[2]*Q[1]+X[3]*Q[0],se[0]&=65535,[se[0]<<16|se[1],se[2]<<16|se[3]]}function U(X,Q){return Q%=64,Q===32?[X[1],X[0]]:Q<32?[X[0]<<Q|X[1]>>>32-Q,X[1]<<Q|X[0]>>>32-Q]:(Q-=32,[X[1]<<Q|X[0]>>>32-Q,X[0]<<Q|X[1]>>>32-Q])}function j(X,Q){return Q%=64,Q===0?X:Q<32?[X[0]<<Q|X[1]>>>32-Q,X[1]<<Q]:[X[1]<<Q-32,0]}function z(X,Q){return[X[0]^Q[0],X[1]^Q[1]]}function Z(X){return X=z(X,[0,X[0]>>>1]),X=N(X,[4283543511,3981806797]),X=z(X,[0,X[0]>>>1]),X=N(X,[3301882366,444984403]),X=z(X,[0,X[0]>>>1]),X}S.x86.hash32=function(X,Q){if(S.inputValidation&&!C(X))return E;Q=Q||0;for(var se=X.length%4,oe=X.length-se,ue=Q,we=0,Te=3432918353,xe=461845907,Re=0;Re<oe;Re=Re+4)we=X[Re]|X[Re+1]<<8|X[Re+2]<<16|X[Re+3]<<24,we=A(we,Te),we=I(we,15),we=A(we,xe),ue^=we,ue=I(ue,13),ue=A(ue,5)+3864292196;switch(we=0,se){case 3:we^=X[Re+2]<<16;case 2:we^=X[Re+1]<<8;case 1:we^=X[Re],we=A(we,Te),we=I(we,15),we=A(we,xe),ue^=we}return ue^=X.length,ue=B(ue),ue>>>0},S.x86.hash128=function(X,Q){if(S.inputValidation&&!C(X))return E;Q=Q||0;for(var se=X.length%16,oe=X.length-se,ue=Q,we=Q,Te=Q,xe=Q,Re=0,Ne=0,Fe=0,ht=0,nt=597399067,Ee=2869860233,Ce=951274213,_e=2716044179,Ie=0;Ie<oe;Ie=Ie+16)Re=X[Ie]|X[Ie+1]<<8|X[Ie+2]<<16|X[Ie+3]<<24,Ne=X[Ie+4]|X[Ie+5]<<8|X[Ie+6]<<16|X[Ie+7]<<24,Fe=X[Ie+8]|X[Ie+9]<<8|X[Ie+10]<<16|X[Ie+11]<<24,ht=X[Ie+12]|X[Ie+13]<<8|X[Ie+14]<<16|X[Ie+15]<<24,Re=A(Re,nt),Re=I(Re,15),Re=A(Re,Ee),ue^=Re,ue=I(ue,19),ue+=we,ue=A(ue,5)+1444728091,Ne=A(Ne,Ee),Ne=I(Ne,16),Ne=A(Ne,Ce),we^=Ne,we=I(we,17),we+=Te,we=A(we,5)+197830471,Fe=A(Fe,Ce),Fe=I(Fe,17),Fe=A(Fe,_e),Te^=Fe,Te=I(Te,15),Te+=xe,Te=A(Te,5)+2530024501,ht=A(ht,_e),ht=I(ht,18),ht=A(ht,nt),xe^=ht,xe=I(xe,13),xe+=ue,xe=A(xe,5)+850148119;switch(Re=0,Ne=0,Fe=0,ht=0,se){case 15:ht^=X[Ie+14]<<16;case 14:ht^=X[Ie+13]<<8;case 13:ht^=X[Ie+12],ht=A(ht,_e),ht=I(ht,18),ht=A(ht,nt),xe^=ht;case 12:Fe^=X[Ie+11]<<24;case 11:Fe^=X[Ie+10]<<16;case 10:Fe^=X[Ie+9]<<8;case 9:Fe^=X[Ie+8],Fe=A(Fe,Ce),Fe=I(Fe,17),Fe=A(Fe,_e),Te^=Fe;case 8:Ne^=X[Ie+7]<<24;case 7:Ne^=X[Ie+6]<<16;case 6:Ne^=X[Ie+5]<<8;case 5:Ne^=X[Ie+4],Ne=A(Ne,Ee),Ne=I(Ne,16),Ne=A(Ne,Ce),we^=Ne;case 4:Re^=X[Ie+3]<<24;case 3:Re^=X[Ie+2]<<16;case 2:Re^=X[Ie+1]<<8;case 1:Re^=X[Ie],Re=A(Re,nt),Re=I(Re,15),Re=A(Re,Ee),ue^=Re}return ue^=X.length,we^=X.length,Te^=X.length,xe^=X.length,ue+=we,ue+=Te,ue+=xe,we+=ue,Te+=ue,xe+=ue,ue=B(ue),we=B(we),Te=B(Te),xe=B(xe),ue+=we,ue+=Te,ue+=xe,we+=ue,Te+=ue,xe+=ue,("00000000"+(ue>>>0).toString(16)).slice(-8)+("00000000"+(we>>>0).toString(16)).slice(-8)+("00000000"+(Te>>>0).toString(16)).slice(-8)+("00000000"+(xe>>>0).toString(16)).slice(-8)},S.x64.hash128=function(X,Q){if(S.inputValidation&&!C(X))return E;Q=Q||0;for(var se=X.length%16,oe=X.length-se,ue=[0,Q],we=[0,Q],Te=[0,0],xe=[0,0],Re=[2277735313,289559509],Ne=[1291169091,658871167],Fe=0;Fe<oe;Fe=Fe+16)Te=[X[Fe+4]|X[Fe+5]<<8|X[Fe+6]<<16|X[Fe+7]<<24,X[Fe]|X[Fe+1]<<8|X[Fe+2]<<16|X[Fe+3]<<24],xe=[X[Fe+12]|X[Fe+13]<<8|X[Fe+14]<<16|X[Fe+15]<<24,X[Fe+8]|X[Fe+9]<<8|X[Fe+10]<<16|X[Fe+11]<<24],Te=N(Te,Re),Te=U(Te,31),Te=N(Te,Ne),ue=z(ue,Te),ue=U(ue,27),ue=O(ue,we),ue=O(N(ue,[0,5]),[0,1390208809]),xe=N(xe,Ne),xe=U(xe,33),xe=N(xe,Re),we=z(we,xe),we=U(we,31),we=O(we,ue),we=O(N(we,[0,5]),[0,944331445]);switch(Te=[0,0],xe=[0,0],se){case 15:xe=z(xe,j([0,X[Fe+14]],48));case 14:xe=z(xe,j([0,X[Fe+13]],40));case 13:xe=z(xe,j([0,X[Fe+12]],32));case 12:xe=z(xe,j([0,X[Fe+11]],24));case 11:xe=z(xe,j([0,X[Fe+10]],16));case 10:xe=z(xe,j([0,X[Fe+9]],8));case 9:xe=z(xe,[0,X[Fe+8]]),xe=N(xe,Ne),xe=U(xe,33),xe=N(xe,Re),we=z(we,xe);case 8:Te=z(Te,j([0,X[Fe+7]],56));case 7:Te=z(Te,j([0,X[Fe+6]],48));case 6:Te=z(Te,j([0,X[Fe+5]],40));case 5:Te=z(Te,j([0,X[Fe+4]],32));case 4:Te=z(Te,j([0,X[Fe+3]],24));case 3:Te=z(Te,j([0,X[Fe+2]],16));case 2:Te=z(Te,j([0,X[Fe+1]],8));case 1:Te=z(Te,[0,X[Fe]]),Te=N(Te,Re),Te=U(Te,31),Te=N(Te,Ne),ue=z(ue,Te)}return ue=z(ue,[0,X.length]),we=z(we,[0,X.length]),ue=O(ue,we),we=O(we,ue),ue=Z(ue),we=Z(we),ue=O(ue,we),we=O(we,ue),("00000000"+(ue[0]>>>0).toString(16)).slice(-8)+("00000000"+(ue[1]>>>0).toString(16)).slice(-8)+("00000000"+(we[0]>>>0).toString(16)).slice(-8)+("00000000"+(we[1]>>>0).toString(16)).slice(-8)},n.exports&&(r=n.exports=S),r.murmurHash3=S})()})(murmurHash3js,murmurHash3js.exports);var murmurHash3jsExports=murmurHash3js.exports,murmurhash3jsRevisited=murmurHash3jsExports;const mur=getDefaultExportFromCjs(murmurhash3jsRevisited),murmur3128=from({name:"murmur3-128",code:34,encode:n=>fromHex(mur.x64.hash128(n))}),BITS_PER_BYTE=7;var sparseArray=class{constructor(){this._bitArrays=[],this._data=[],this._length=0,this._changedLength=!1,this._changedData=!1}set(r,_){let E=this._internalPositionFor(r,!1);if(_===void 0)E!==-1&&(this._unsetInternalPos(E),this._unsetBit(r),this._changedLength=!0,this._changedData=!0);else{let S=!1;E===-1?(E=this._data.length,this._setBit(r),this._changedData=!0):S=!0,this._setInternalPos(E,r,_,S),this._changedLength=!0}}unset(r){this.set(r,void 0)}get(r){this._sortData();const _=this._internalPositionFor(r,!0);if(_!==-1)return this._data[_][1]}push(r){return this.set(this.length,r),this.length}get length(){if(this._sortData(),this._changedLength){const r=this._data[this._data.length-1];this._length=r?r[0]+1:0,this._changedLength=!1}return this._length}forEach(r){let _=0;for(;_<this.length;)r(this.get(_),_,this),_++}map(r){let _=0,E=new Array(this.length);for(;_<this.length;)E[_]=r(this.get(_),_,this),_++;return E}reduce(r,_){let E=0,S=_;for(;E<this.length;){const C=this.get(E);S=r(S,C,E),E++}return S}find(r){let _=0,E,S;for(;_<this.length&&!E;)S=this.get(_),E=r(S),_++;return E?S:void 0}_internalPositionFor(r,_){const E=this._bytePosFor(r,_);if(E>=this._bitArrays.length)return-1;const S=this._bitArrays[E],C=r-E*BITS_PER_BYTE;if(!((S&1<<C)>0))return-1;const I=this._bitArrays.slice(0,E).reduce(popCountReduce,0),B=~(4294967295<<C+1),O=popCount(S&B);return I+O-1}_bytePosFor(r,_){const E=Math.floor(r/BITS_PER_BYTE),S=E+1;for(;!_&&this._bitArrays.length<S;)this._bitArrays.push(0);return E}_setBit(r){const _=this._bytePosFor(r,!1);this._bitArrays[_]|=1<<r-_*BITS_PER_BYTE}_unsetBit(r){const _=this._bytePosFor(r,!1);this._bitArrays[_]&=~(1<<r-_*BITS_PER_BYTE)}_setInternalPos(r,_,E,S){const C=this._data,A=[_,E];if(S)this._sortData(),C[r]=A;else{if(C.length)if(C[C.length-1][0]>=_)C.push(A);else if(C[0][0]<=_)C.unshift(A);else{const I=Math.round(C.length/2);this._data=C.slice(0,I).concat(A).concat(C.slice(I))}else this._data.push(A);this._changedData=!0,this._changedLength=!0}}_unsetInternalPos(r){this._data.splice(r,1)}_sortData(){this._changedData&&this._data.sort(sortInternal),this._changedData=!1}bitField(){const r=[];let _=8,E=0,S=0,C;const A=this._bitArrays.slice();for(;A.length||E;){E===0&&(C=A.shift(),E=7);const B=Math.min(E,_),O=~(255<<B),N=C&O;S|=N<<8-_,C=C>>>B,E-=B,_-=B,(!_||!E&&!A.length)&&(r.push(S),S=0,_=8)}for(var I=r.length-1;I>0&&r[I]===0;I--)r.pop();return r}compactArray(){return this._sortData(),this._data.map(valueOnly)}};function popCountReduce(n,r){return n+popCount(r)}function popCount(n){let r=n;return r=r-(r>>1&1431655765),r=(r&858993459)+(r>>2&858993459),(r+(r>>4)&252645135)*16843009>>24}function sortInternal(n,r){return n[0]-r[0]}function valueOnly(n){return n[1]}const SparseArray=getDefaultExportFromCjs(sparseArray);class Bucket{_options;_popCount;_parent;_posAtParent;_children;key;constructor(r,_,E=0){this._options=r,this._popCount=0,this._parent=_,this._posAtParent=E,this._children=new SparseArray,this.key=null}async put(r,_){const E=await this._findNewBucketAndPos(r);E.bucket._putAt(E,r,_)}async get(r){const _=await this._findChild(r);if(_!=null)return _.value}async del(r){const _=await this._findPlace(r),E=_.bucket._at(_.pos);E!=null&&E.key===r&&_.bucket._delAt(_.pos)}leafCount(){return this._children.compactArray().reduce((_,E)=>E instanceof Bucket?_+E.leafCount():_+1,0)}childrenCount(){return this._children.length}onlyChild(){return this._children.get(0)}*eachLeafSeries(){const r=this._children.compactArray();for(const _ of r)_ instanceof Bucket?yield*_.eachLeafSeries():yield _}serialize(r,_){const E=[];return _(this._children.reduce((S,C,A)=>(C!=null&&(C instanceof Bucket?S.push(C.serialize(r,_)):S.push(r(C,A))),S),E))}async asyncTransform(r,_){return asyncTransformBucket(this,r,_)}toJSON(){return this.serialize(mapNode,reduceNodes)}prettyPrint(){return JSON.stringify(this.toJSON(),null,"  ")}tableSize(){return Math.pow(2,this._options.bits)}async _findChild(r){const _=await this._findPlace(r),E=_.bucket._at(_.pos);if(!(E instanceof Bucket)&&E!=null&&E.key===r)return E}async _findPlace(r){const _=this._options.hash(typeof r=="string"?fromString$3(r):r),E=await _.take(this._options.bits),S=this._children.get(E);return S instanceof Bucket?S._findPlace(_):{bucket:this,pos:E,hash:_,existingChild:S}}async _findNewBucketAndPos(r){const _=await this._findPlace(r);if(_.existingChild!=null&&_.existingChild.key!==r){const E=new Bucket(this._options,_.bucket,_.pos);_.bucket._putObjectAt(_.pos,E);const S=await E._findPlace(_.existingChild.hash);return S.bucket._putAt(S,_.existingChild.key,_.existingChild.value),E._findNewBucketAndPos(_.hash)}return _}_putAt(r,_,E){this._putObjectAt(r.pos,{key:_,value:E,hash:r.hash})}_putObjectAt(r,_){this._children.get(r)==null&&this._popCount++,this._children.set(r,_)}_delAt(r){if(r===-1)throw new Error("Invalid position");this._children.get(r)!=null&&this._popCount--,this._children.unset(r),this._level()}_level(){if(this._parent!=null&&this._popCount<=1)if(this._popCount===1){const r=this._children.find(exists$1);if(r!=null&&!(r instanceof Bucket)){const _=r.hash;_.untake(this._options.bits);const E={pos:this._posAtParent,hash:_,bucket:this._parent};this._parent._putAt(E,r.key,r.value)}}else this._parent._delAt(this._posAtParent)}_at(r){return this._children.get(r)}}function exists$1(n){return!!n}function mapNode(n,r){return n.key}function reduceNodes(n){return n}async function asyncTransformBucket(n,r,_){const E=[];for(const S of n._children.compactArray())if(S instanceof Bucket)await asyncTransformBucket(S,r,_);else{const C=await r(S);E.push({bitField:n._children.bitField(),children:C})}return _(E)}const START_MASKS$1=[255,254,252,248,240,224,192,128],STOP_MASKS$1=[1,3,7,15,31,63,127,255];let ConsumableBuffer$1=class{_value;_currentBytePos;_currentBitPos;constructor(r){this._value=r,this._currentBytePos=r.length-1,this._currentBitPos=7}availableBits(){return this._currentBitPos+1+this._currentBytePos*8}totalBits(){return this._value.length*8}take(r){let _=r,E=0;for(;_>0&&this._haveBits();){const S=this._value[this._currentBytePos],C=this._currentBitPos+1,A=Math.min(C,_),I=byteBitsToInt$1(S,C-A,A);E=(E<<A)+I,_-=A,this._currentBitPos-=A,this._currentBitPos<0&&(this._currentBitPos=7,this._currentBytePos--)}return E}untake(r){for(this._currentBitPos+=r;this._currentBitPos>7;)this._currentBitPos-=8,this._currentBytePos+=1}_haveBits(){return this._currentBytePos>=0}};function byteBitsToInt$1(n,r,_){const E=maskFor$1(r,_);return(n&E)>>>r}function maskFor$1(n,r){return START_MASKS$1[n]&STOP_MASKS$1[Math.min(r+n-1,7)]}function wrapHash$1(n){function r(_){return _ instanceof InfiniteHash$1?_:new InfiniteHash$1(_,n)}return r}let InfiniteHash$1=class{_value;_hashFn;_depth;_availableBits;_currentBufferIndex;_buffers;constructor(r,_){if(!(r instanceof Uint8Array))throw new Error("can only hash Uint8Arrays");this._value=r,this._hashFn=_,this._depth=-1,this._availableBits=0,this._currentBufferIndex=0,this._buffers=[]}async take(r){let _=r;for(;this._availableBits<_;)await this._produceMoreBits();let E=0;for(;_>0;){const S=this._buffers[this._currentBufferIndex],C=Math.min(S.availableBits(),_),A=S.take(C);E=(E<<C)+A,_-=C,this._availableBits-=C,S.availableBits()===0&&this._currentBufferIndex++}return E}untake(r){let _=r;for(;_>0;){const E=this._buffers[this._currentBufferIndex],S=Math.min(E.totalBits()-E.availableBits(),_);E.untake(S),_-=S,this._availableBits+=S,this._currentBufferIndex>0&&E.totalBits()===E.availableBits()&&(this._depth--,this._currentBufferIndex--)}}async _produceMoreBits(){this._depth++;const r=this._depth>0?concat$4([this._value,Uint8Array.from([this._depth])]):this._value,_=await this._hashFn(r),E=new ConsumableBuffer$1(_);this._buffers.push(E),this._availableBits+=E.availableBits()}};function createHAMT(n){if(n==null||n.hashFn==null)throw new Error("please define an options.hashFn");const r={bits:n.bits??8,hash:wrapHash$1(n.hashFn)};return new Bucket(r)}async function hamtHashFn$1(n){return(await murmur3128.encode(n)).slice(0,8).reverse()}const HAMT_HASH_CODE=BigInt(34),DEFAULT_FANOUT_BITS=8;let DirSharded$1=class extends Dir$1{_bucket;constructor(r,_){super(r,_),this._bucket=createHAMT({hashFn:hamtHashFn$1,bits:_.shardFanoutBits??DEFAULT_FANOUT_BITS})}async put(r,_){this.cid=void 0,this.size=void 0,this.nodeSize=void 0,await this._bucket.put(r,_)}async get(r){return this._bucket.get(r)}childCount(){return this._bucket.leafCount()}directChildrenCount(){return this._bucket.childrenCount()}onlyChild(){return this._bucket.onlyChild()}async*eachChildSeries(){for await(const{key:r,value:_}of this._bucket.eachLeafSeries())yield{key:r,child:_}}estimateNodeSize(){return this.nodeSize!==void 0?this.nodeSize:(this.nodeSize=calculateSize$1(this._bucket,this,this.options),this.nodeSize)}async*flush(r){for await(const _ of flush$1(this._bucket,r,this,this.options))yield{..._,path:this.path}}};async function*flush$1(n,r,_,E){const S=n._children,C=(n.tableSize()-1).toString(16).length,A=[];let I=0n;for(let Z=0;Z<S.length;Z++){const X=S.get(Z);if(X==null)continue;const Q=Z.toString(16).toUpperCase().padStart(C,"0");if(X instanceof Bucket){let se;for await(const oe of flush$1(X,r,null,E))se=oe;if(se==null)throw new Error("Could not flush sharded directory, no subshard found");A.push({Name:Q,Tsize:Number(se.size),Hash:se.cid}),I+=se.size}else if(isDir$1(X.value)){const se=X.value;let oe;for await(const we of se.flush(r))oe=we,yield oe;if(oe==null)throw new Error("Did not flush dir");const ue=Q+X.key;A.push({Name:ue,Tsize:Number(oe.size),Hash:oe.cid}),I+=oe.size}else{const se=X.value;if(se.cid==null)continue;const oe=Q+X.key,ue=se.size;A.push({Name:oe,Tsize:Number(ue),Hash:se.cid}),I+=BigInt(ue??0)}}const B=Uint8Array.from(S.bitField().reverse()),O=new UnixFS({type:"hamt-sharded-directory",data:B,fanout:BigInt(n.tableSize()),hashType:HAMT_HASH_CODE,mtime:_?.mtime,mode:_?.mode}),N={Data:O.marshal(),Links:A},U=encode$9(prepare(N)),j=await persist$1(U,r,E),z=BigInt(U.byteLength)+I;yield{cid:j,unixfs:O,size:z}}function isDir$1(n){return typeof n.flush=="function"}function calculateSize$1(n,r,_){const E=n._children,S=(n.tableSize()-1).toString(16).length,C=[];for(let O=0;O<E.length;O++){const N=E.get(O);if(N==null)continue;const U=O.toString(16).toUpperCase().padStart(S,"0");if(N instanceof Bucket){const j=calculateSize$1(N,null,_);C.push({Name:U,Tsize:Number(j),Hash:_.cidVersion===0?CID_V0$1:CID_V1$1})}else if(typeof N.value.flush=="function"){const z=N.value.nodeSize();C.push({Name:U+N.key,Tsize:Number(z),Hash:_.cidVersion===0?CID_V0$1:CID_V1$1})}else{const j=N.value;if(j.cid==null)continue;const z=U+N.key,Z=j.size;C.push({Name:z,Tsize:Number(Z),Hash:j.cid})}}const A=Uint8Array.from(E.bitField().reverse()),I=new UnixFS({type:"hamt-sharded-directory",data:A,fanout:BigInt(n.tableSize()),hashType:HAMT_HASH_CODE,mtime:r?.mtime,mode:r?.mode});return encode$9(prepare({Data:I.marshal(),Links:C})).length}async function flatToShard(n,r,_,E){let S=r;r instanceof DirFlat&&r.estimateNodeSize()>_&&(S=await convertToShard(r,E));const C=S.parent;if(C!=null){if(S!==r){if(n!=null&&(n.parent=S),S.parentKey==null)throw new Error("No parent key found");await C.put(S.parentKey,S)}return flatToShard(S,C,_,E)}return S}async function convertToShard(n,r){const _=new DirSharded$1({root:n.root,dir:!0,parent:n.parent,parentKey:n.parentKey,path:n.path,dirty:n.dirty,flat:!1,mtime:n.mtime,mode:n.mode},r);for await(const{key:E,child:S}of n.eachChildSeries())await _.put(E,S);return _}const toPathComponents$1=(n="")=>n.split(/(?<!\\)\//).filter(Boolean);async function addToTree(n,r,_){const E=toPathComponents$1(n.path??""),S=E.length-1;let C=r,A="";for(let I=0;I<E.length;I++){const B=E[I];A+=`${A!==""?"/":""}${B}`;const O=I===S;if(C.dirty=!0,C.cid=void 0,C.size=void 0,O)await C.put(B,n),r=await flatToShard(null,C,_.shardSplitThresholdBytes,_);else{let N=await C.get(B);(N==null||!(N instanceof Dir$1))&&(N=new DirFlat({root:!1,dir:!0,parent:C,parentKey:B,path:A,dirty:!0,flat:!0,mtime:N?.unixfs?.mtime,mode:N?.unixfs?.mode},_)),await C.put(B,N),C=N}}return r}async function*flushAndYield(n,r){if(!(n instanceof Dir$1)){n.unixfs?.isDirectory()===!0&&(yield n);return}yield*n.flush(r)}function defaultTreeBuilder(n){return async function*(_,E){let S=new DirFlat({root:!0,dir:!0,path:"",dirty:!0,flat:!0},n),C,A=!1;for await(const I of _){if(I==null)continue;const B=`${I.originalPath??""}`.split("/")[0];B!=null&&B!==""&&(C==null?(C=B,A=!0):C!==B&&(A=!1)),S=await addToTree(I,S,n),(I.unixfs==null||!I.unixfs.isDirectory())&&(yield I)}if(n.wrapWithDirectory||A&&S.childCount()>1)yield*flushAndYield(S,E);else for await(const I of S.eachChildSeries())I!=null&&(yield*flushAndYield(I.child,E))}}async function*importer$1(n,r,_={}){let E;Symbol.asyncIterator in n||Symbol.iterator in n?E=n:E=[n];const S=_.wrapWithDirectory??!1,C=_.shardSplitThresholdBytes??262144,A=_.shardFanoutBits??8,I=_.cidVersion??1,B=_.rawLeaves??!0,O=_.leafType??"file",N=_.fileImportConcurrency??50,U=_.blockWriteConcurrency??10,j=_.reduceSingleLeafToSelf??!0,z=_.chunker??fixedSize(),Z=_.chunkValidator??defaultChunkValidator(),X=_.dagBuilder??defaultDagBuilder({chunker:z,chunkValidator:Z,wrapWithDirectory:S,layout:_.layout??balanced(),bufferImporter:_.bufferImporter??defaultBufferImporter({cidVersion:I,rawLeaves:B,leafType:O,onProgress:_.onProgress}),blockWriteConcurrency:U,reduceSingleLeafToSelf:j,cidVersion:I,onProgress:_.onProgress}),Q=_.treeBuilder??defaultTreeBuilder({wrapWithDirectory:S,shardSplitThresholdBytes:C,shardFanoutBits:A,cidVersion:I,onProgress:_.onProgress});for await(const se of Q(parallelBatch(X(E,r),N),r))yield{cid:se.cid,path:se.path,unixfs:se.unixfs,size:se.size}}async function importFile(n,r,_={}){const E=await first(importer$1([n],r,_));if(E==null)throw errCode$1(new Error("Nothing imported"),"ERR_INVALID_PARAMS");return E}async function importDirectory(n,r,_={}){const E=await first(importer$1([n],r,_));if(E==null)throw errCode$1(new Error("Nothing imported"),"ERR_INVALID_PARAMS");return E}async function importBytes(n,r,_={}){return importFile({content:n},r,_)}async function importByteStream(n,r,_={}){return importFile({content:n},r,_)}var loader={};const ID_OFFSET=-8,SIZE_OFFSET=-4,ARRAYBUFFER_ID=0,STRING_ID=1,ARRAYBUFFERVIEW=1,ARRAY=2,VAL_ALIGN_OFFSET=5,VAL_SIGNED=1024,VAL_FLOAT=2048,VAL_MANAGED=8192,ARRAYBUFFERVIEW_BUFFER_OFFSET=0,ARRAYBUFFERVIEW_DATASTART_OFFSET=4,ARRAYBUFFERVIEW_DATALENGTH_OFFSET=8,ARRAYBUFFERVIEW_SIZE=12,ARRAY_LENGTH_OFFSET=12,ARRAY_SIZE=16,BIGINT=typeof BigUint64Array<"u",THIS=Symbol(),CHUNKSIZE=1024;function getStringImpl(n,r){const _=new Uint32Array(n),E=new Uint16Array(n);var S=_[r+SIZE_OFFSET>>>2]>>>1,C=r>>>1;if(S<=CHUNKSIZE)return String.fromCharCode.apply(String,E.subarray(C,C+S));const A=[];do{const I=E[C+CHUNKSIZE-1],B=I>=55296&&I<56320?CHUNKSIZE-1:CHUNKSIZE;A.push(String.fromCharCode.apply(String,E.subarray(C,C+=B))),S-=B}while(S>CHUNKSIZE);return A.join("")+String.fromCharCode.apply(String,E.subarray(C,C+S))}function preInstantiate(n){const r={};function _(S,C){return S?getStringImpl(S.buffer,C):"<yet unknown>"}const E=n.env=n.env||{};return E.abort=E.abort||function(C,A,I,B){const O=r.memory||E.memory;throw Error("abort: "+_(O,C)+" at "+_(O,A)+":"+I+":"+B)},E.trace=E.trace||function(C,A){const I=r.memory||E.memory;console.log("trace: "+_(I,C)+(A?" ":"")+Array.prototype.slice.call(arguments,2,2+A).join(", "))},n.Math=n.Math||Math,n.Date=n.Date||Date,r}function postInstantiate(n,r){const _=r.exports,E=_.memory,S=_.table,C=_.__alloc,A=_.__retain,I=_.__rtti_base||-1;function B(Te){const xe=new Uint32Array(E.buffer),Re=xe[I>>>2];if((Te>>>=0)>=Re)throw Error("invalid id: "+Te);return xe[(I+4>>>2)+Te*2]}function O(Te){const xe=new Uint32Array(E.buffer),Re=xe[I>>>2];if((Te>>>=0)>=Re)throw Error("invalid id: "+Te);return xe[(I+4>>>2)+Te*2+1]}function N(Te){return 31-Math.clz32(Te>>>VAL_ALIGN_OFFSET&31)}function U(Te){const xe=Te.length,Re=C(xe<<1,STRING_ID),Ne=new Uint16Array(E.buffer);for(var Fe=0,ht=Re>>>1;Fe<xe;++Fe)Ne[ht+Fe]=Te.charCodeAt(Fe);return Re}n.__allocString=U;function j(Te){const xe=E.buffer;if(new Uint32Array(xe)[Te+ID_OFFSET>>>2]!==STRING_ID)throw Error("not a string: "+Te);return getStringImpl(xe,Te)}n.__getString=j;function z(Te,xe,Re){const Ne=E.buffer;if(Re)switch(Te){case 2:return new Float32Array(Ne);case 3:return new Float64Array(Ne)}else switch(Te){case 0:return new(xe?Int8Array:Uint8Array)(Ne);case 1:return new(xe?Int16Array:Uint16Array)(Ne);case 2:return new(xe?Int32Array:Uint32Array)(Ne);case 3:return new(xe?BigInt64Array:BigUint64Array)(Ne)}throw Error("unsupported align: "+Te)}function Z(Te,xe){const Re=B(Te);if(!(Re&(ARRAYBUFFERVIEW|ARRAY)))throw Error("not an array: "+Te+" @ "+Re);const Ne=N(Re),Fe=xe.length,ht=C(Fe<<Ne,ARRAYBUFFER_ID),nt=C(Re&ARRAY?ARRAY_SIZE:ARRAYBUFFERVIEW_SIZE,Te),Ee=new Uint32Array(E.buffer);Ee[nt+ARRAYBUFFERVIEW_BUFFER_OFFSET>>>2]=A(ht),Ee[nt+ARRAYBUFFERVIEW_DATASTART_OFFSET>>>2]=ht,Ee[nt+ARRAYBUFFERVIEW_DATALENGTH_OFFSET>>>2]=Fe<<Ne,Re&ARRAY&&(Ee[nt+ARRAY_LENGTH_OFFSET>>>2]=Fe);const Ce=z(Ne,Re&VAL_SIGNED,Re&VAL_FLOAT);if(Re&VAL_MANAGED)for(let _e=0;_e<Fe;++_e)Ce[(ht>>>Ne)+_e]=A(xe[_e]);else Ce.set(xe,ht>>>Ne);return nt}n.__allocArray=Z;function X(Te){const xe=new Uint32Array(E.buffer),Re=xe[Te+ID_OFFSET>>>2],Ne=B(Re);if(!(Ne&ARRAYBUFFERVIEW))throw Error("not an array: "+Re);const Fe=N(Ne);var ht=xe[Te+ARRAYBUFFERVIEW_DATASTART_OFFSET>>>2];const nt=Ne&ARRAY?xe[Te+ARRAY_LENGTH_OFFSET>>>2]:xe[ht+SIZE_OFFSET>>>2]>>>Fe;return z(Fe,Ne&VAL_SIGNED,Ne&VAL_FLOAT).subarray(ht>>>=Fe,ht+nt)}n.__getArrayView=X;function Q(Te){const xe=X(Te),Re=xe.length,Ne=new Array(Re);for(let Fe=0;Fe<Re;Fe++)Ne[Fe]=xe[Fe];return Ne}n.__getArray=Q;function se(Te){const xe=E.buffer,Re=new Uint32Array(xe)[Te+SIZE_OFFSET>>>2];return xe.slice(Te,Te+Re)}n.__getArrayBuffer=se;function oe(Te,xe,Re){return new Te(ue(Te,xe,Re))}function ue(Te,xe,Re){const Ne=E.buffer,Fe=new Uint32Array(Ne),ht=Fe[Re+ARRAYBUFFERVIEW_DATASTART_OFFSET>>>2];return new Te(Ne,ht,Fe[ht+SIZE_OFFSET>>>2]>>>xe)}n.__getInt8Array=oe.bind(null,Int8Array,0),n.__getInt8ArrayView=ue.bind(null,Int8Array,0),n.__getUint8Array=oe.bind(null,Uint8Array,0),n.__getUint8ArrayView=ue.bind(null,Uint8Array,0),n.__getUint8ClampedArray=oe.bind(null,Uint8ClampedArray,0),n.__getUint8ClampedArrayView=ue.bind(null,Uint8ClampedArray,0),n.__getInt16Array=oe.bind(null,Int16Array,1),n.__getInt16ArrayView=ue.bind(null,Int16Array,1),n.__getUint16Array=oe.bind(null,Uint16Array,1),n.__getUint16ArrayView=ue.bind(null,Uint16Array,1),n.__getInt32Array=oe.bind(null,Int32Array,2),n.__getInt32ArrayView=ue.bind(null,Int32Array,2),n.__getUint32Array=oe.bind(null,Uint32Array,2),n.__getUint32ArrayView=ue.bind(null,Uint32Array,2),BIGINT&&(n.__getInt64Array=oe.bind(null,BigInt64Array,3),n.__getInt64ArrayView=ue.bind(null,BigInt64Array,3),n.__getUint64Array=oe.bind(null,BigUint64Array,3),n.__getUint64ArrayView=ue.bind(null,BigUint64Array,3)),n.__getFloat32Array=oe.bind(null,Float32Array,2),n.__getFloat32ArrayView=ue.bind(null,Float32Array,2),n.__getFloat64Array=oe.bind(null,Float64Array,3),n.__getFloat64ArrayView=ue.bind(null,Float64Array,3);function we(Te,xe){const Re=new Uint32Array(E.buffer);var Ne=Re[Te+ID_OFFSET>>>2];if(Ne<=Re[I>>>2])do if(Ne==xe)return!0;while(Ne=O(Ne));return!1}return n.__instanceof=we,n.memory=n.memory||E,n.table=n.table||S,demangle(_,n)}function isResponse(n){return typeof Response<"u"&&n instanceof Response}async function instantiate$1(n,r){return isResponse(n=await n)?instantiateStreaming(n,r):postInstantiate(preInstantiate(r||(r={})),await WebAssembly.instantiate(n instanceof WebAssembly.Module?n:await WebAssembly.compile(n),r))}loader.instantiate=instantiate$1;function instantiateSync(n,r){return postInstantiate(preInstantiate(r||(r={})),new WebAssembly.Instance(n instanceof WebAssembly.Module?n:new WebAssembly.Module(n),r))}loader.instantiateSync=instantiateSync;async function instantiateStreaming(n,r){return WebAssembly.instantiateStreaming?postInstantiate(preInstantiate(r||(r={})),(await WebAssembly.instantiateStreaming(n,r)).instance):instantiate$1(isResponse(n=await n)?n.arrayBuffer():n,r)}loader.instantiateStreaming=instantiateStreaming;function demangle(n,r){var _=r?Object.create(r):{},E=n.__argumentsLength?function(S){n.__argumentsLength.value=S}:n.__setArgumentsLength||n.__setargc||function(){};for(let S in n){if(!Object.prototype.hasOwnProperty.call(n,S))continue;const C=n[S];let A=S.split("."),I=_;for(;A.length>1;){let N=A.shift();Object.prototype.hasOwnProperty.call(I,N)||(I[N]={}),I=I[N]}let B=A[0],O=B.indexOf("#");if(O>=0){let N=B.substring(0,O),U=I[N];if(typeof U>"u"||!U.prototype){let j=function(...z){return j.wrap(j.prototype.constructor(0,...z))};j.prototype={valueOf:function(){return this[THIS]}},j.wrap=function(z){return Object.create(j.prototype,{[THIS]:{value:z,writable:!1}})},U&&Object.getOwnPropertyNames(U).forEach(z=>Object.defineProperty(j,z,Object.getOwnPropertyDescriptor(U,z))),I[N]=j}if(B=B.substring(O+1),I=I[N].prototype,/^(get|set):/.test(B)){if(!Object.prototype.hasOwnProperty.call(I,B=B.substring(4))){let j=n[S.replace("set:","get:")],z=n[S.replace("get:","set:")];Object.defineProperty(I,B,{get:function(){return j(this[THIS])},set:function(Z){z(this[THIS],Z)},enumerable:!0})}}else B==="constructor"?(I[B]=(...j)=>(E(j.length),C(...j))).original=C:(I[B]=function(...j){return E(j.length),C(this[THIS],...j)}).original=C}else/^(get|set):/.test(B)?Object.prototype.hasOwnProperty.call(I,B=B.substring(4))||Object.defineProperty(I,B,{get:n[S.replace("set:","get:")],set:n[S.replace("get:","set:")],enumerable:!0}):typeof C=="function"&&C!==E?(I[B]=(...N)=>(E(N.length),C(...N))).original=C:I[B]=C}return _}loader.demangle=demangle;const{instantiate}=loader;loadWebAssembly.supported=typeof WebAssembly<"u";function loadWebAssembly(n={}){if(!loadWebAssembly.supported)return null;var r=new Uint8Array([0,97,115,109,1,0,0,0,1,78,14,96,2,127,126,0,96,1,127,1,126,96,2,127,127,0,96,1,127,1,127,96,1,127,0,96,2,127,127,1,127,96,3,127,127,127,1,127,96,0,0,96,3,127,127,127,0,96,0,1,127,96,4,127,127,127,127,0,96,5,127,127,127,127,127,1,127,96,1,126,1,127,96,2,126,126,1,126,2,13,1,3,101,110,118,5,97,98,111,114,116,0,10,3,54,53,2,2,8,9,3,5,2,8,6,5,3,4,2,6,9,12,13,2,5,11,3,2,3,2,3,2,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0,6,7,7,4,4,5,3,1,0,1,6,47,9,127,1,65,0,11,127,1,65,0,11,127,0,65,3,11,127,0,65,4,11,127,1,65,0,11,127,1,65,0,11,127,1,65,0,11,127,0,65,240,2,11,127,0,65,6,11,7,240,5,41,6,109,101,109,111,114,121,2,0,7,95,95,97,108,108,111,99,0,10,8,95,95,114,101,116,97,105,110,0,11,9,95,95,114,101,108,101,97,115,101,0,12,9,95,95,99,111,108,108,101,99,116,0,51,11,95,95,114,116,116,105,95,98,97,115,101,3,7,13,73,110,116,51,50,65,114,114,97,121,95,73,68,3,2,13,85,105,110,116,56,65,114,114,97,121,95,73,68,3,3,6,100,101,103,114,101,101,0,16,3,109,111,100,0,17,5,82,97,98,105,110,3,8,16,82,97,98,105,110,35,103,101,116,58,119,105,110,100,111,119,0,21,16,82,97,98,105,110,35,115,101,116,58,119,105,110,100,111,119,0,22,21,82,97,98,105,110,35,103,101,116,58,119,105,110,100,111,119,95,115,105,122,101,0,23,21,82,97,98,105,110,35,115,101,116,58,119,105,110,100,111,119,95,115,105,122,101,0,24,14,82,97,98,105,110,35,103,101,116,58,119,112,111,115,0,25,14,82,97,98,105,110,35,115,101,116,58,119,112,111,115,0,26,15,82,97,98,105,110,35,103,101,116,58,99,111,117,110,116,0,27,15,82,97,98,105,110,35,115,101,116,58,99,111,117,110,116,0,28,13,82,97,98,105,110,35,103,101,116,58,112,111,115,0,29,13,82,97,98,105,110,35,115,101,116,58,112,111,115,0,30,15,82,97,98,105,110,35,103,101,116,58,115,116,97,114,116,0,31,15,82,97,98,105,110,35,115,101,116,58,115,116,97,114,116,0,32,16,82,97,98,105,110,35,103,101,116,58,100,105,103,101,115,116,0,33,16,82,97,98,105,110,35,115,101,116,58,100,105,103,101,115,116,0,34,21,82,97,98,105,110,35,103,101,116,58,99,104,117,110,107,95,115,116,97,114,116,0,35,21,82,97,98,105,110,35,115,101,116,58,99,104,117,110,107,95,115,116,97,114,116,0,36,22,82,97,98,105,110,35,103,101,116,58,99,104,117,110,107,95,108,101,110,103,116,104,0,37,22,82,97,98,105,110,35,115,101,116,58,99,104,117,110,107,95,108,101,110,103,116,104,0,38,31,82,97,98,105,110,35,103,101,116,58,99,104,117,110,107,95,99,117,116,95,102,105,110,103,101,114,112,114,105,110,116,0,39,31,82,97,98,105,110,35,115,101,116,58,99,104,117,110,107,95,99,117,116,95,102,105,110,103,101,114,112,114,105,110,116,0,40,20,82,97,98,105,110,35,103,101,116,58,112,111,108,121,110,111,109,105,97,108,0,41,20,82,97,98,105,110,35,115,101,116,58,112,111,108,121,110,111,109,105,97,108,0,42,17,82,97,98,105,110,35,103,101,116,58,109,105,110,115,105,122,101,0,43,17,82,97,98,105,110,35,115,101,116,58,109,105,110,115,105,122,101,0,44,17,82,97,98,105,110,35,103,101,116,58,109,97,120,115,105,122,101,0,45,17,82,97,98,105,110,35,115,101,116,58,109,97,120,115,105,122,101,0,46,14,82,97,98,105,110,35,103,101,116,58,109,97,115,107,0,47,14,82,97,98,105,110,35,115,101,116,58,109,97,115,107,0,48,17,82,97,98,105,110,35,99,111,110,115,116,114,117,99,116,111,114,0,20,17,82,97,98,105,110,35,102,105,110,103,101,114,112,114,105,110,116,0,49,8,1,50,10,165,31,53,199,1,1,4,127,32,1,40,2,0,65,124,113,34,2,65,128,2,73,4,127,32,2,65,4,118,33,4,65,0,5,32,2,65,31,32,2,103,107,34,3,65,4,107,118,65,16,115,33,4,32,3,65,7,107,11,33,3,32,1,40,2,20,33,2,32,1,40,2,16,34,5,4,64,32,5,32,2,54,2,20,11,32,2,4,64,32,2,32,5,54,2,16,11,32,1,32,0,32,4,32,3,65,4,116,106,65,2,116,106,40,2,96,70,4,64,32,0,32,4,32,3,65,4,116,106,65,2,116,106,32,2,54,2,96,32,2,69,4,64,32,0,32,3,65,2,116,106,32,0,32,3,65,2,116,106,40,2,4,65,1,32,4,116,65,127,115,113,34,1,54,2,4,32,1,69,4,64,32,0,32,0,40,2,0,65,1,32,3,116,65,127,115,113,54,2,0,11,11,11,11,226,2,1,6,127,32,1,40,2,0,33,3,32,1,65,16,106,32,1,40,2,0,65,124,113,106,34,4,40,2,0,34,5,65,1,113,4,64,32,3,65,124,113,65,16,106,32,5,65,124,113,106,34,2,65,240,255,255,255,3,73,4,64,32,0,32,4,16,1,32,1,32,2,32,3,65,3,113,114,34,3,54,2,0,32,1,65,16,106,32,1,40,2,0,65,124,113,106,34,4,40,2,0,33,5,11,11,32,3,65,2,113,4,64,32,1,65,4,107,40,2,0,34,2,40,2,0,34,6,65,124,113,65,16,106,32,3,65,124,113,106,34,7,65,240,255,255,255,3,73,4,64,32,0,32,2,16,1,32,2,32,7,32,6,65,3,113,114,34,3,54,2,0,32,2,33,1,11,11,32,4,32,5,65,2,114,54,2,0,32,4,65,4,107,32,1,54,2,0,32,0,32,3,65,124,113,34,2,65,128,2,73,4,127,32,2,65,4,118,33,4,65,0,5,32,2,65,31,32,2,103,107,34,2,65,4,107,118,65,16,115,33,4,32,2,65,7,107,11,34,3,65,4,116,32,4,106,65,2,116,106,40,2,96,33,2,32,1,65,0,54,2,16,32,1,32,2,54,2,20,32,2,4,64,32,2,32,1,54,2,16,11,32,0,32,4,32,3,65,4,116,106,65,2,116,106,32,1,54,2,96,32,0,32,0,40,2,0,65,1,32,3,116,114,54,2,0,32,0,32,3,65,2,116,106,32,0,32,3,65,2,116,106,40,2,4,65,1,32,4,116,114,54,2,4,11,119,1,1,127,32,2,2,127,32,0,40,2,160,12,34,2,4,64,32,2,32,1,65,16,107,70,4,64,32,2,40,2,0,33,3,32,1,65,16,107,33,1,11,11,32,1,11,107,34,2,65,48,73,4,64,15,11,32,1,32,3,65,2,113,32,2,65,32,107,65,1,114,114,54,2,0,32,1,65,0,54,2,16,32,1,65,0,54,2,20,32,1,32,2,106,65,16,107,34,2,65,2,54,2,0,32,0,32,2,54,2,160,12,32,0,32,1,16,2,11,155,1,1,3,127,35,0,34,0,69,4,64,65,1,63,0,34,0,74,4,127,65,1,32,0,107,64,0,65,0,72,5,65,0,11,4,64,0,11,65,176,3,34,0,65,0,54,2,0,65,208,15,65,0,54,2,0,3,64,32,1,65,23,73,4,64,32,1,65,2,116,65,176,3,106,65,0,54,2,4,65,0,33,2,3,64,32,2,65,16,73,4,64,32,1,65,4,116,32,2,106,65,2,116,65,176,3,106,65,0,54,2,96,32,2,65,1,106,33,2,12,1,11,11,32,1,65,1,106,33,1,12,1,11,11,65,176,3,65,224,15,63,0,65,16,116,16,3,65,176,3,36,0,11,32,0,11,45,0,32,0,65,240,255,255,255,3,79,4,64,65,32,65,224,0,65,201,3,65,29,16,0,0,11,32,0,65,15,106,65,112,113,34,0,65,16,32,0,65,16,75,27,11,169,1,1,1,127,32,0,32,1,65,128,2,73,4,127,32,1,65,4,118,33,1,65,0,5,32,1,65,248,255,255,255,1,73,4,64,32,1,65,1,65,27,32,1,103,107,116,106,65,1,107,33,1,11,32,1,65,31,32,1,103,107,34,2,65,4,107,118,65,16,115,33,1,32,2,65,7,107,11,34,2,65,2,116,106,40,2,4,65,127,32,1,116,113,34,1,4,127,32,0,32,1,104,32,2,65,4,116,106,65,2,116,106,40,2,96,5,32,0,40,2,0,65,127,32,2,65,1,106,116,113,34,1,4,127,32,0,32,0,32,1,104,34,0,65,2,116,106,40,2,4,104,32,0,65,4,116,106,65,2,116,106,40,2,96,5,65,0,11,11,11,111,1,1,127,63,0,34,2,32,1,65,248,255,255,255,1,73,4,127,32,1,65,1,65,27,32,1,103,107,116,65,1,107,106,5,32,1,11,65,16,32,0,40,2,160,12,32,2,65,16,116,65,16,107,71,116,106,65,255,255,3,106,65,128,128,124,113,65,16,118,34,1,32,2,32,1,74,27,64,0,65,0,72,4,64,32,1,64,0,65,0,72,4,64,0,11,11,32,0,32,2,65,16,116,63,0,65,16,116,16,3,11,113,1,2,127,32,1,40,2,0,34,3,65,124,113,32,2,107,34,4,65,32,79,4,64,32,1,32,2,32,3,65,2,113,114,54,2,0,32,2,32,1,65,16,106,106,34,1,32,4,65,16,107,65,1,114,54,2,0,32,0,32,1,16,2,5,32,1,32,3,65,126,113,54,2,0,32,1,65,16,106,32,1,40,2,0,65,124,113,106,32,1,65,16,106,32,1,40,2,0,65,124,113,106,40,2,0,65,125,113,54,2,0,11,11,91,1,2,127,32,0,32,1,16,5,34,4,16,6,34,3,69,4,64,65,1,36,1,65,0,36,1,32,0,32,4,16,6,34,3,69,4,64,32,0,32,4,16,7,32,0,32,4,16,6,33,3,11,11,32,3,65,0,54,2,4,32,3,32,2,54,2,8,32,3,32,1,54,2,12,32,0,32,3,16,1,32,0,32,3,32,4,16,8,32,3,11,13,0,16,4,32,0,32,1,16,9,65,16,106,11,33,1,1,127,32,0,65,172,3,75,4,64,32,0,65,16,107,34,1,32,1,40,2,4,65,1,106,54,2,4,11,32,0,11,18,0,32,0,65,172,3,75,4,64,32,0,65,16,107,16,52,11,11,140,3,1,1,127,2,64,32,1,69,13,0,32,0,65,0,58,0,0,32,0,32,1,106,65,1,107,65,0,58,0,0,32,1,65,2,77,13,0,32,0,65,1,106,65,0,58,0,0,32,0,65,2,106,65,0,58,0,0,32,0,32,1,106,34,2,65,2,107,65,0,58,0,0,32,2,65,3,107,65,0,58,0,0,32,1,65,6,77,13,0,32,0,65,3,106,65,0,58,0,0,32,0,32,1,106,65,4,107,65,0,58,0,0,32,1,65,8,77,13,0,32,1,65,0,32,0,107,65,3,113,34,1,107,33,2,32,0,32,1,106,34,0,65,0,54,2,0,32,0,32,2,65,124,113,34,1,106,65,4,107,65,0,54,2,0,32,1,65,8,77,13,0,32,0,65,4,106,65,0,54,2,0,32,0,65,8,106,65,0,54,2,0,32,0,32,1,106,34,2,65,12,107,65,0,54,2,0,32,2,65,8,107,65,0,54,2,0,32,1,65,24,77,13,0,32,0,65,12,106,65,0,54,2,0,32,0,65,16,106,65,0,54,2,0,32,0,65,20,106,65,0,54,2,0,32,0,65,24,106,65,0,54,2,0,32,0,32,1,106,34,2,65,28,107,65,0,54,2,0,32,2,65,24,107,65,0,54,2,0,32,2,65,20,107,65,0,54,2,0,32,2,65,16,107,65,0,54,2,0,32,0,32,0,65,4,113,65,24,106,34,2,106,33,0,32,1,32,2,107,33,1,3,64,32,1,65,32,79,4,64,32,0,66,0,55,3,0,32,0,65,8,106,66,0,55,3,0,32,0,65,16,106,66,0,55,3,0,32,0,65,24,106,66,0,55,3,0,32,1,65,32,107,33,1,32,0,65,32,106,33,0,12,1,11,11,11,11,178,1,1,3,127,32,1,65,240,255,255,255,3,32,2,118,75,4,64,65,144,1,65,192,1,65,23,65,56,16,0,0,11,32,1,32,2,116,34,3,65,0,16,10,34,2,32,3,16,13,32,0,69,4,64,65,12,65,2,16,10,34,0,65,172,3,75,4,64,32,0,65,16,107,34,1,32,1,40,2,4,65,1,106,54,2,4,11,11,32,0,65,0,54,2,0,32,0,65,0,54,2,4,32,0,65,0,54,2,8,32,2,34,1,32,0,40,2,0,34,4,71,4,64,32,1,65,172,3,75,4,64,32,1,65,16,107,34,5,32,5,40,2,4,65,1,106,54,2,4,11,32,4,16,12,11,32,0,32,1,54,2,0,32,0,32,2,54,2,4,32,0,32,3,54,2,8,32,0,11,46,1,2,127,65,12,65,5,16,10,34,0,65,172,3,75,4,64,32,0,65,16,107,34,1,32,1,40,2,4,65,1,106,54,2,4,11,32,0,65,128,2,65,3,16,14,11,9,0,65,63,32,0,121,167,107,11,49,1,2,127,65,63,32,1,121,167,107,33,2,3,64,65,63,32,0,121,167,107,32,2,107,34,3,65,0,78,4,64,32,0,32,1,32,3,172,134,133,33,0,12,1,11,11,32,0,11,40,0,32,1,32,0,40,2,8,79,4,64,65,128,2,65,192,2,65,163,1,65,44,16,0,0,11,32,1,32,0,40,2,4,106,65,0,58,0,0,11,38,0,32,1,32,0,40,2,8,79,4,64,65,128,2,65,192,2,65,152,1,65,44,16,0,0,11,32,1,32,0,40,2,4,106,45,0,0,11,254,5,2,1,127,4,126,32,0,69,4,64,65,232,0,65,6,16,10,34,0,65,172,3,75,4,64,32,0,65,16,107,34,5,32,5,40,2,4,65,1,106,54,2,4,11,11,32,0,65,0,54,2,0,32,0,65,0,54,2,4,32,0,65,0,54,2,8,32,0,66,0,55,3,16,32,0,66,0,55,3,24,32,0,66,0,55,3,32,32,0,66,0,55,3,40,32,0,66,0,55,3,48,32,0,66,0,55,3,56,32,0,66,0,55,3,64,32,0,66,0,55,3,72,32,0,66,0,55,3,80,32,0,66,0,55,3,88,32,0,66,0,55,3,96,32,0,32,2,173,55,3,80,32,0,32,3,173,55,3,88,65,12,65,4,16,10,34,2,65,172,3,75,4,64,32,2,65,16,107,34,3,32,3,40,2,4,65,1,106,54,2,4,11,32,2,32,4,65,0,16,14,33,2,32,0,40,2,0,16,12,32,0,32,2,54,2,0,32,0,32,4,54,2,4,32,0,66,1,32,1,173,134,66,1,125,55,3,96,32,0,66,243,130,183,218,216,230,232,30,55,3,72,35,4,69,4,64,65,0,33,2,3,64,32,2,65,128,2,72,4,64,32,2,65,255,1,113,173,33,6,32,0,41,3,72,34,7,33,8,65,63,32,7,121,167,107,33,1,3,64,65,63,32,6,121,167,107,32,1,107,34,3,65,0,78,4,64,32,6,32,8,32,3,172,134,133,33,6,12,1,11,11,65,0,33,4,3,64,32,4,32,0,40,2,4,65,1,107,72,4,64,32,6,66,8,134,33,6,32,0,41,3,72,34,7,33,8,65,63,32,7,121,167,107,33,1,3,64,65,63,32,6,121,167,107,32,1,107,34,3,65,0,78,4,64,32,6,32,8,32,3,172,134,133,33,6,12,1,11,11,32,4,65,1,106,33,4,12,1,11,11,35,6,40,2,4,32,2,65,3,116,106,32,6,55,3,0,32,2,65,1,106,33,2,12,1,11,11,65,63,32,0,41,3,72,121,167,107,172,33,7,65,0,33,2,3,64,32,2,65,128,2,72,4,64,35,5,33,1,32,2,172,32,7,134,34,8,33,6,65,63,32,0,41,3,72,34,9,121,167,107,33,3,3,64,65,63,32,6,121,167,107,32,3,107,34,4,65,0,78,4,64,32,6,32,9,32,4,172,134,133,33,6,12,1,11,11,32,1,40,2,4,32,2,65,3,116,106,32,6,32,8,132,55,3,0,32,2,65,1,106,33,2,12,1,11,11,65,1,36,4,11,32,0,66,0,55,3,24,32,0,66,0,55,3,32,65,0,33,2,3,64,32,2,32,0,40,2,4,72,4,64,32,0,40,2,0,32,2,16,18,32,2,65,1,106,33,2,12,1,11,11,32,0,66,0,55,3,40,32,0,65,0,54,2,8,32,0,66,0,55,3,16,32,0,66,0,55,3,40,32,0,40,2,0,32,0,40,2,8,16,19,33,1,32,0,40,2,8,32,0,40,2,0,40,2,4,106,65,1,58,0,0,32,0,32,0,41,3,40,35,6,40,2,4,32,1,65,3,116,106,41,3,0,133,55,3,40,32,0,32,0,40,2,8,65,1,106,32,0,40,2,4,111,54,2,8,32,0,35,5,40,2,4,32,0,41,3,40,34,6,66,45,136,167,65,3,116,106,41,3,0,32,6,66,8,134,66,1,132,133,55,3,40,32,0,11,38,1,1,127,32,0,40,2,0,34,0,65,172,3,75,4,64,32,0,65,16,107,34,1,32,1,40,2,4,65,1,106,54,2,4,11,32,0,11,55,1,2,127,32,1,32,0,40,2,0,34,2,71,4,64,32,1,65,172,3,75,4,64,32,1,65,16,107,34,3,32,3,40,2,4,65,1,106,54,2,4,11,32,2,16,12,11,32,0,32,1,54,2,0,11,7,0,32,0,40,2,4,11,9,0,32,0,32,1,54,2,4,11,7,0,32,0,40,2,8,11,9,0,32,0,32,1,54,2,8,11,7,0,32,0,41,3,16,11,9,0,32,0,32,1,55,3,16,11,7,0,32,0,41,3,24,11,9,0,32,0,32,1,55,3,24,11,7,0,32,0,41,3,32,11,9,0,32,0,32,1,55,3,32,11,7,0,32,0,41,3,40,11,9,0,32,0,32,1,55,3,40,11,7,0,32,0,41,3,48,11,9,0,32,0,32,1,55,3,48,11,7,0,32,0,41,3,56,11,9,0,32,0,32,1,55,3,56,11,7,0,32,0,41,3,64,11,9,0,32,0,32,1,55,3,64,11,7,0,32,0,41,3,72,11,9,0,32,0,32,1,55,3,72,11,7,0,32,0,41,3,80,11,9,0,32,0,32,1,55,3,80,11,7,0,32,0,41,3,88,11,9,0,32,0,32,1,55,3,88,11,7,0,32,0,41,3,96,11,9,0,32,0,32,1,55,3,96,11,172,4,2,5,127,1,126,32,2,65,172,3,75,4,64,32,2,65,16,107,34,4,32,4,40,2,4,65,1,106,54,2,4,11,32,2,33,4,65,0,33,2,32,1,40,2,8,33,5,32,1,40,2,4,33,6,3,64,2,127,65,0,33,3,3,64,32,3,32,5,72,4,64,32,3,32,6,106,45,0,0,33,1,32,0,40,2,0,32,0,40,2,8,16,19,33,7,32,0,40,2,8,32,0,40,2,0,40,2,4,106,32,1,58,0,0,32,0,32,0,41,3,40,35,6,40,2,4,32,7,65,3,116,106,41,3,0,133,55,3,40,32,0,32,0,40,2,8,65,1,106,32,0,40,2,4,111,54,2,8,32,0,35,5,40,2,4,32,0,41,3,40,34,8,66,45,136,167,65,3,116,106,41,3,0,32,1,173,32,8,66,8,134,132,133,55,3,40,32,0,32,0,41,3,16,66,1,124,55,3,16,32,0,32,0,41,3,24,66,1,124,55,3,24,32,0,41,3,16,32,0,41,3,80,90,4,127,32,0,41,3,40,32,0,41,3,96,131,80,5,65,0,11,4,127,65,1,5,32,0,41,3,16,32,0,41,3,88,90,11,4,64,32,0,32,0,41,3,32,55,3,48,32,0,32,0,41,3,16,55,3,56,32,0,32,0,41,3,40,55,3,64,65,0,33,1,3,64,32,1,32,0,40,2,4,72,4,64,32,0,40,2,0,32,1,16,18,32,1,65,1,106,33,1,12,1,11,11,32,0,66,0,55,3,40,32,0,65,0,54,2,8,32,0,66,0,55,3,16,32,0,66,0,55,3,40,32,0,40,2,0,32,0,40,2,8,16,19,33,1,32,0,40,2,8,32,0,40,2,0,40,2,4,106,65,1,58,0,0,32,0,32,0,41,3,40,35,6,40,2,4,32,1,65,3,116,106,41,3,0,133,55,3,40,32,0,32,0,40,2,8,65,1,106,32,0,40,2,4,111,54,2,8,32,0,35,5,40,2,4,32,0,41,3,40,34,8,66,45,136,167,65,3,116,106,41,3,0,32,8,66,8,134,66,1,132,133,55,3,40,32,3,65,1,106,12,3,11,32,3,65,1,106,33,3,12,1,11,11,65,127,11,34,1,65,0,78,4,64,32,5,32,1,107,33,5,32,1,32,6,106,33,6,32,2,34,1,65,1,106,33,2,32,4,40,2,4,32,1,65,2,116,106,32,0,41,3,56,62,2,0,12,1,11,11,32,4,11,10,0,16,15,36,5,16,15,36,6,11,3,0,1,11,73,1,2,127,32,0,40,2,4,34,1,65,255,255,255,255,0,113,34,2,65,1,70,4,64,32,0,65,16,106,16,53,32,0,32,0,40,2,0,65,1,114,54,2,0,35,0,32,0,16,2,5,32,0,32,2,65,1,107,32,1,65,128,128,128,128,127,113,114,54,2,4,11,11,58,0,2,64,2,64,2,64,32,0,65,8,107,40,2,0,14,7,0,0,1,1,1,1,1,2,11,15,11,32,0,40,2,0,34,0,4,64,32,0,65,172,3,79,4,64,32,0,65,16,107,16,52,11,11,15,11,0,11,11,137,3,7,0,65,16,11,55,40,0,0,0,1,0,0,0,1,0,0,0,40,0,0,0,97,0,108,0,108,0,111,0,99,0,97,0,116,0,105,0,111,0,110,0,32,0,116,0,111,0,111,0,32,0,108,0,97,0,114,0,103,0,101,0,65,208,0,11,45,30,0,0,0,1,0,0,0,1,0,0,0,30,0,0,0,126,0,108,0,105,0,98,0,47,0,114,0,116,0,47,0,116,0,108,0,115,0,102,0,46,0,116,0,115,0,65,128,1,11,43,28,0,0,0,1,0,0,0,1,0,0,0,28,0,0,0,73,0,110,0,118,0,97,0,108,0,105,0,100,0,32,0,108,0,101,0,110,0,103,0,116,0,104,0,65,176,1,11,53,38,0,0,0,1,0,0,0,1,0,0,0,38,0,0,0,126,0,108,0,105,0,98,0,47,0,97,0,114,0,114,0,97,0,121,0,98,0,117,0,102,0,102,0,101,0,114,0,46,0,116,0,115,0,65,240,1,11,51,36,0,0,0,1,0,0,0,1,0,0,0,36,0,0,0,73,0,110,0,100,0,101,0,120,0,32,0,111,0,117,0,116,0,32,0,111,0,102,0,32,0,114,0,97,0,110,0,103,0,101,0,65,176,2,11,51,36,0,0,0,1,0,0,0,1,0,0,0,36,0,0,0,126,0,108,0,105,0,98,0,47,0,116,0,121,0,112,0,101,0,100,0,97,0,114,0,114,0,97,0,121,0,46,0,116,0,115,0,65,240,2,11,53,7,0,0,0,16,0,0,0,0,0,0,0,16,0,0,0,0,0,0,0,16,0,0,0,0,0,0,0,145,4,0,0,2,0,0,0,49,0,0,0,2,0,0,0,17,1,0,0,2,0,0,0,16,0,34,16,115,111,117,114,99,101,77,97,112,112,105,110,103,85,82,76,16,46,47,114,97,98,105,110,46,119,97,115,109,46,109,97,112]);return instantiate(new Response(new Blob([r],{type:"application/wasm"})),n)}const defaultImporterSettings={cidVersion:1,rawLeaves:!0,layout:balanced({maxChildrenPerNode:1024}),chunker:fixedSize({chunkSize:1048576})};async function*addAll(n,r,_={}){yield*importer$1(n,r,{...defaultImporterSettings,..._})}async function addBytes(n,r,_={}){const{cid:E}=await importBytes(n,r,{...defaultImporterSettings,..._});return E}async function addByteStream(n,r,_={}){const{cid:E}=await importByteStream(n,r,{...defaultImporterSettings,..._});return E}async function addFile(n,r,_={}){const{cid:E}=await importFile(n,r,{...defaultImporterSettings,..._});return E}async function addDirectory(n,r,_={}){const{cid:E}=await importDirectory({...n,path:n.path??"-"},r,{...defaultImporterSettings,..._});return E}function isAsyncIterable$9(n){return n[Symbol.asyncIterator]!=null}function last(n){if(isAsyncIterable$9(n))return(async()=>{let _;for await(const E of n)_=E;return _})();let r;for(const _ of n)r=_;return r}class JSONEncoder extends Array{constructor(){super(),this.inRecursive=[]}prefix(r){const _=this.inRecursive[this.inRecursive.length-1];_&&(_.type===Type.array&&(_.elements++,_.elements!==1&&r.push([44])),_.type===Type.map&&(_.elements++,_.elements!==1&&(_.elements%2===1?r.push([44]):r.push([58]))))}[Type.uint.major](r,_){this.prefix(r);const E=String(_.value),S=[];for(let C=0;C<E.length;C++)S[C]=E.charCodeAt(C);r.push(S)}[Type.negint.major](r,_){this[Type.uint.major](r,_)}[Type.bytes.major](r,_){throw new Error(`${encodeErrPrefix} unsupported type: Uint8Array`)}[Type.string.major](r,_){this.prefix(r);const E=fromString$5(JSON.stringify(_.value));r.push(E.length>32?asU8A(E):E)}[Type.array.major](r,_){this.prefix(r),this.inRecursive.push({type:Type.array,elements:0}),r.push([91])}[Type.map.major](r,_){this.prefix(r),this.inRecursive.push({type:Type.map,elements:0}),r.push([123])}[Type.tag.major](r,_){}[Type.float.major](r,_){if(_.type.name==="break"){const A=this.inRecursive.pop();if(A){if(A.type===Type.array)r.push([93]);else if(A.type===Type.map)r.push([125]);else throw new Error("Unexpected recursive type; this should not happen!");return}throw new Error("Unexpected break; this should not happen!")}if(_.value===void 0)throw new Error(`${encodeErrPrefix} unsupported type: undefined`);if(this.prefix(r),_.type.name==="true"){r.push([116,114,117,101]);return}else if(_.type.name==="false"){r.push([102,97,108,115,101]);return}else if(_.type.name==="null"){r.push([110,117,108,108]);return}const E=String(_.value),S=[];let C=!1;for(let A=0;A<E.length;A++)S[A]=E.charCodeAt(A),!C&&(S[A]===46||S[A]===101||S[A]===69)&&(C=!0);C||(S.push(46),S.push(48)),r.push(S)}}class Tokenizer{constructor(r,_={}){this._pos=0,this.data=r,this.options=_,this.modeStack=["value"],this.lastToken=""}pos(){return this._pos}done(){return this._pos>=this.data.length}ch(){return this.data[this._pos]}currentMode(){return this.modeStack[this.modeStack.length-1]}skipWhitespace(){let r=this.ch();for(;r===32||r===9||r===13||r===10;)r=this.data[++this._pos]}expect(r){if(this.data.length-this._pos<r.length)throw new Error(`${decodeErrPrefix} unexpected end of input at position ${this._pos}`);for(let _=0;_<r.length;_++)if(this.data[this._pos++]!==r[_])throw new Error(`${decodeErrPrefix} unexpected token at position ${this._pos}, expected to find '${String.fromCharCode(...r)}'`)}parseNumber(){const r=this._pos;let _=!1,E=!1;const S=I=>{for(;!this.done();){const B=this.ch();if(I.includes(B))this._pos++;else break}};if(this.ch()===45&&(_=!0,this._pos++),this.ch()===48)if(this._pos++,this.ch()===46)this._pos++,E=!0;else return new Token(Type.uint,0,this._pos-r);if(S([48,49,50,51,52,53,54,55,56,57]),_&&this._pos===r+1)throw new Error(`${decodeErrPrefix} unexpected token at position ${this._pos}`);if(!this.done()&&this.ch()===46){if(E)throw new Error(`${decodeErrPrefix} unexpected token at position ${this._pos}`);E=!0,this._pos++,S([48,49,50,51,52,53,54,55,56,57])}!this.done()&&(this.ch()===101||this.ch()===69)&&(E=!0,this._pos++,!this.done()&&(this.ch()===43||this.ch()===45)&&this._pos++,S([48,49,50,51,52,53,54,55,56,57]));const C=String.fromCharCode.apply(null,this.data.subarray(r,this._pos)),A=parseFloat(C);return E?new Token(Type.float,A,this._pos-r):this.options.allowBigInt!==!0||Number.isSafeInteger(A)?new Token(A>=0?Type.uint:Type.negint,A,this._pos-r):new Token(A>=0?Type.uint:Type.negint,BigInt(C),this._pos-r)}parseString(){if(this.ch()!==34)throw new Error(`${decodeErrPrefix} unexpected character at position ${this._pos}; this shouldn't happen`);this._pos++;for(let C=this._pos,A=0;C<this.data.length&&A<65536;C++,A++){const I=this.data[C];if(I===92||I<32||I>=128)break;if(I===34){const B=String.fromCharCode.apply(null,this.data.subarray(this._pos,C));return this._pos=C+1,new Token(Type.string,B,A)}}const r=this._pos,_=[],E=()=>{if(this._pos+4>=this.data.length)throw new Error(`${decodeErrPrefix} unexpected end of unicode escape sequence at position ${this._pos}`);let C=0;for(let A=0;A<4;A++){let I=this.ch();if(I>=48&&I<=57)I-=48;else if(I>=97&&I<=102)I=I-97+10;else if(I>=65&&I<=70)I=I-65+10;else throw new Error(`${decodeErrPrefix} unexpected unicode escape character at position ${this._pos}`);C=C*16+I,this._pos++}return C},S=()=>{const C=this.ch();let A=null,I=C>239?4:C>223?3:C>191?2:1;if(this._pos+I>this.data.length)throw new Error(`${decodeErrPrefix} unexpected unicode sequence at position ${this._pos}`);let B,O,N,U;switch(I){case 1:C<128&&(A=C);break;case 2:B=this.data[this._pos+1],(B&192)===128&&(U=(C&31)<<6|B&63,U>127&&(A=U));break;case 3:B=this.data[this._pos+1],O=this.data[this._pos+2],(B&192)===128&&(O&192)===128&&(U=(C&15)<<12|(B&63)<<6|O&63,U>2047&&(U<55296||U>57343)&&(A=U));break;case 4:B=this.data[this._pos+1],O=this.data[this._pos+2],N=this.data[this._pos+3],(B&192)===128&&(O&192)===128&&(N&192)===128&&(U=(C&15)<<18|(B&63)<<12|(O&63)<<6|N&63,U>65535&&U<1114112&&(A=U))}A===null?(A=65533,I=1):A>65535&&(A-=65536,_.push(A>>>10&1023|55296),A=56320|A&1023),_.push(A),this._pos+=I};for(;!this.done();){const C=this.ch();let A;switch(C){case 92:if(this._pos++,this.done())throw new Error(`${decodeErrPrefix} unexpected string termination at position ${this._pos}`);switch(A=this.ch(),this._pos++,A){case 34:case 39:case 92:case 47:_.push(A);break;case 98:_.push(8);break;case 116:_.push(9);break;case 110:_.push(10);break;case 102:_.push(12);break;case 114:_.push(13);break;case 117:_.push(E());break;default:throw new Error(`${decodeErrPrefix} unexpected string escape character at position ${this._pos}`)}break;case 34:return this._pos++,new Token(Type.string,decodeCodePointsArray(_),this._pos-r);default:if(C<32)throw new Error(`${decodeErrPrefix} invalid control character at position ${this._pos}`);C<128?(_.push(C),this._pos++):S()}}throw new Error(`${decodeErrPrefix} unexpected end of string at position ${this._pos}`)}parseValue(){switch(this.ch()){case 123:return this.modeStack.push("obj-start"),this._pos++,new Token(Type.map,1/0,1);case 91:return this.modeStack.push("array-start"),this._pos++,new Token(Type.array,1/0,1);case 34:return this.parseString();case 110:return this.expect([110,117,108,108]),new Token(Type.null,null,4);case 102:return this.expect([102,97,108,115,101]),new Token(Type.false,!1,5);case 116:return this.expect([116,114,117,101]),new Token(Type.true,!0,4);case 45:case 48:case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:return this.parseNumber();default:throw new Error(`${decodeErrPrefix} unexpected character at position ${this._pos}`)}}next(){switch(this.skipWhitespace(),this.currentMode()){case"value":return this.modeStack.pop(),this.parseValue();case"array-value":{if(this.modeStack.pop(),this.ch()===93)return this._pos++,this.skipWhitespace(),new Token(Type.break,void 0,1);if(this.ch()!==44)throw new Error(`${decodeErrPrefix} unexpected character at position ${this._pos}, was expecting array delimiter but found '${String.fromCharCode(this.ch())}'`);return this._pos++,this.modeStack.push("array-value"),this.skipWhitespace(),this.parseValue()}case"array-start":return this.modeStack.pop(),this.ch()===93?(this._pos++,this.skipWhitespace(),new Token(Type.break,void 0,1)):(this.modeStack.push("array-value"),this.skipWhitespace(),this.parseValue());case"obj-key":if(this.ch()===125)return this.modeStack.pop(),this._pos++,this.skipWhitespace(),new Token(Type.break,void 0,1);if(this.ch()!==44)throw new Error(`${decodeErrPrefix} unexpected character at position ${this._pos}, was expecting object delimiter but found '${String.fromCharCode(this.ch())}'`);this._pos++,this.skipWhitespace();case"obj-start":{if(this.modeStack.pop(),this.ch()===125)return this._pos++,this.skipWhitespace(),new Token(Type.break,void 0,1);const r=this.parseString();if(this.skipWhitespace(),this.ch()!==58)throw new Error(`${decodeErrPrefix} unexpected character at position ${this._pos}, was expecting key/value delimiter ':' but found '${String.fromCharCode(this.ch())}'`);return this._pos++,this.modeStack.push("obj-value"),r}case"obj-value":return this.modeStack.pop(),this.modeStack.push("obj-key"),this.skipWhitespace(),this.parseValue();default:throw new Error(`${decodeErrPrefix} unexpected parse state at position ${this._pos}; this shouldn't happen`)}}}function decode$8(n,r){return r=Object.assign({tokenizer:new Tokenizer(n,r)},r),decode$l(n,r)}function toByteView(n){return n instanceof ArrayBuffer?new Uint8Array(n,0,n.byteLength):n}let DagJsonTokenizer$1=class extends Tokenizer{constructor(r,_){super(r,_),this.tokenBuffer=[]}done(){return this.tokenBuffer.length===0&&super.done()}_next(){return this.tokenBuffer.length>0?this.tokenBuffer.pop():super.next()}next(){const r=this._next();if(r.type===Type.map){const _=this._next();if(_.type===Type.string&&_.value==="/"){const E=this._next();if(E.type===Type.string){if(this._next().type!==Type.break)throw new Error("Invalid encoded CID form");return this.tokenBuffer.push(E),new Token(Type.tag,42,0)}if(E.type===Type.map){const S=this._next();if(S.type===Type.string&&S.value==="bytes"){const C=this._next();if(C.type===Type.string){for(let I=0;I<2;I++)if(this._next().type!==Type.break)throw new Error("Invalid encoded Bytes form");const A=base64$5.decode(`m${C.value}`);return new Token(Type.bytes,A,C.value.length)}this.tokenBuffer.push(C)}this.tokenBuffer.push(S)}this.tokenBuffer.push(E)}this.tokenBuffer.push(_)}return r}};const decodeOptions={allowIndefinite:!1,allowUndefined:!1,allowNaN:!1,allowInfinity:!1,allowBigInt:!0,strict:!0,useMaps:!1,rejectDuplicateMapKeys:!0,tags:[]};decodeOptions.tags[42]=CID.parse;const code$1=297,decode$7=n=>{const r=toByteView(n),_=Object.assign(decodeOptions,{tokenizer:new DagJsonTokenizer$1(r,decodeOptions)});return decode$8(r,_)};new TextDecoder;new TextEncoder;function resolveObjectPath(n,r,_,E,S,C,A){let I=n,B=S;for(;C.length>0;){const O=C[0];if(O in I){C.shift(),B=`${B}/${O}`;const N=CID.asCID(I[O]);if(N!=null)return{entry:{type:"object",name:E,path:S,cid:_,node:r,depth:A,size:BigInt(r.length),content:async function*(){yield n}},next:{cid:N,name:O,path:B,toResolve:C}};I=I[O]}else throw errCode$1(new Error(`No property named ${O} found in node ${_}`),"ERR_NO_PROP")}return{entry:{type:"object",name:E,path:S,cid:_,node:r,depth:A,size:BigInt(r.length),content:async function*(){yield n}}}}const resolve$6=async(n,r,_,E,S,C,A,I)=>{const B=await A.get(n,I),O=decode$g(B);return resolveObjectPath(O,B,n,r,_,E,C)},resolve$5=async(n,r,_,E,S,C,A,I)=>{const B=await A.get(n,I),O=decode$7(B);return resolveObjectPath(O,B,n,r,_,E,C)};function extractDataFromBlock(n,r,_,E){const S=BigInt(n.length),C=BigInt(r+S);return _>=C||E<r?new Uint8Array(0):(E>=r&&E<C&&(n=n.subarray(0,Number(E-r))),_>=r&&_<C&&(n=n.subarray(Number(_-r))),n)}const validateOffsetAndLength=(n,r=0,_=n)=>{const E=BigInt(n),S=BigInt(r??0);let C=BigInt(_);if(C!==E&&(C=S+C),C>E&&(C=E),S<0n)throw errCode$1(new Error("Offset must be greater than or equal to 0"),"ERR_INVALID_PARAMS");if(S>E)throw errCode$1(new Error("Offset must be less than the file size"),"ERR_INVALID_PARAMS");if(C<0n)throw errCode$1(new Error("Length must be greater than or equal to 0"),"ERR_INVALID_PARAMS");if(C>E)throw errCode$1(new Error("Length must be less than the file size"),"ERR_INVALID_PARAMS");return{start:S,end:C}},rawContent$1=n=>{async function*r(_={}){const{start:E,end:S}=validateOffsetAndLength(n.length,_.offset,_.length),C=extractDataFromBlock(n,0n,E,S);_.onProgress?.(new CustomProgressEvent("unixfs:exporter:progress:identity",{bytesRead:BigInt(C.byteLength),totalBytes:S-E,fileSize:BigInt(n.byteLength)})),yield C}return r},resolve$4=async(n,r,_,E,S,C,A,I)=>{if(E.length>0)throw errCode$1(new Error(`No link named ${_} found in raw node ${n}`),"ERR_NOT_FOUND");const B=decode$h(n.multihash.bytes);return{entry:{type:"identity",name:r,path:_,cid:n,content:rawContent$1(B.digest),depth:C,size:BigInt(B.digest.length),node:B.digest}}},resolve$3=async(n,r,_,E,S,C,A,I)=>{const B=await A.get(n,I),O=decode$d(B);return resolveObjectPath(O,B,n,r,_,E,C)},rawContent=n=>{async function*r(_={}){const{start:E,end:S}=validateOffsetAndLength(n.length,_.offset,_.length),C=extractDataFromBlock(n,0n,E,S);_.onProgress?.(new CustomProgressEvent("unixfs:exporter:progress:raw",{bytesRead:BigInt(C.byteLength),totalBytes:S-E,fileSize:BigInt(n.byteLength)})),yield C}return r},resolve$2=async(n,r,_,E,S,C,A,I)=>{if(E.length>0)throw errCode$1(new Error(`No link named ${_} found in raw node ${n}`),"ERR_NOT_FOUND");const B=await A.get(n,I);return{entry:{type:"raw",name:r,path:_,cid:n,content:rawContent(B),depth:C,size:BigInt(B.length),node:B}}},hashFn=async function(n){return(await murmur3128.encode(n)).slice(0,8).reverse()},addLinksToHamtBucket=async(n,r,_)=>{const E=(r.tableSize()-1).toString(16).length;await Promise.all(n.map(async S=>{if(S.Name==null)throw new Error("Unexpected Link without a Name");if(S.Name.length===E){const C=parseInt(S.Name,16);r._putObjectAt(C,new Bucket({hash:_._options.hash,bits:_._options.bits},r,C));return}await _.put(S.Name.substring(2),!0)}))},toPrefix$1=(n,r)=>n.toString(16).toUpperCase().padStart(r,"0").substring(0,r),toBucketPath=n=>{let r=n.bucket;const _=[];for(;r._parent!=null;)_.push(r),r=r._parent;return _.push(r),_.reverse()},findShardCid=async(n,r,_,E,S)=>{if(E==null){if(n.Data==null)throw errCode$1(new Error("no data in PBNode"),"ERR_NOT_UNIXFS");let U;try{U=UnixFS.unmarshal(n.Data)}catch(z){throw errCode$1(z,"ERR_NOT_UNIXFS")}if(U.type!=="hamt-sharded-directory")throw errCode$1(new Error("not a HAMT"),"ERR_NOT_UNIXFS");if(U.fanout==null)throw errCode$1(new Error("missing fanout"),"ERR_NOT_UNIXFS");const j=createHAMT({hashFn,bits:Math.log2(Number(U.fanout))});E={rootBucket:j,hamtDepth:1,lastBucket:j}}const C=(E.lastBucket.tableSize()-1).toString(16).length;await addLinksToHamtBucket(n.Links,E.lastBucket,E.rootBucket);const A=await E.rootBucket._findNewBucketAndPos(r);let I=toPrefix$1(A.pos,C);const B=toBucketPath(A);B.length>E.hamtDepth&&(E.lastBucket=B[E.hamtDepth],I=toPrefix$1(E.lastBucket._posAtParent,C));const O=n.Links.find(U=>{if(U.Name==null)return!1;const j=U.Name.substring(0,C),z=U.Name.substring(C);return!(j!==I||z!==""&&z!==r)});if(O==null)return;if(O.Name!=null&&O.Name.substring(C)===r)return O.Hash;E.hamtDepth++;const N=await _.get(O.Hash,S);return n=decode$9(N),findShardCid(n,r,_,E,S)};function peekable(n){const[r,_]=n[Symbol.asyncIterator]!=null?[n[Symbol.asyncIterator](),Symbol.asyncIterator]:[n[Symbol.iterator](),Symbol.iterator],E=[];return{peek:()=>r.next(),push:S=>{E.push(S)},next:()=>E.length>0?{done:!1,value:E.shift()}:r.next(),[_](){return this}}}function isAsyncIterable$8(n){return n[Symbol.asyncIterator]!=null}function filter(n,r){if(isAsyncIterable$8(n))return async function*(){for await(const I of n)await r(I)&&(yield I)}();const _=peekable(n),{value:E,done:S}=_.next();if(S===!0)return function*(){}();const C=r(E);if(typeof C.then=="function")return async function*(){await C&&(yield E);for await(const I of _)await r(I)&&(yield I)}();const A=r;return function*(){C===!0&&(yield E);for(const I of _)A(I)&&(yield I)}()}function isAsyncIterable$7(n){return n[Symbol.asyncIterator]!=null}function map$1(n,r){if(isAsyncIterable$7(n))return async function*(){for await(const I of n)yield r(I)}();const _=peekable(n),{value:E,done:S}=_.next();if(S===!0)return function*(){}();const C=r(E);if(typeof C.then=="function")return async function*(){yield await C;for await(const I of _)yield r(I)}();const A=r;return function*(){yield C;for(const I of _)yield A(I)}()}const CustomEvent=globalThis.CustomEvent??Event;async function*parallel(n,r={}){let _=r.concurrency??1/0;_<1&&(_=1/0);const E=r.ordered==null?!1:r.ordered,S=new EventTarget,C=[];let A=pDefer(),I=pDefer(),B=!1,O,N=!1;S.addEventListener("task-complete",()=>{I.resolve()}),Promise.resolve().then(async()=>{try{for await(const Z of n){if(C.length===_&&(A=pDefer(),await A.promise),N)break;const X={done:!1};C.push(X),Z().then(Q=>{X.done=!0,X.ok=!0,X.value=Q,S.dispatchEvent(new CustomEvent("task-complete"))},Q=>{X.done=!0,X.err=Q,S.dispatchEvent(new CustomEvent("task-complete"))})}B=!0,S.dispatchEvent(new CustomEvent("task-complete"))}catch(Z){O=Z,S.dispatchEvent(new CustomEvent("task-complete"))}});function U(){return E?C[0]?.done:!!C.find(Z=>Z.done)}function*j(){for(;C.length>0&&C[0].done;){const Z=C[0];if(C.shift(),Z.ok)yield Z.value;else throw N=!0,A.resolve(),Z.err;A.resolve()}}function*z(){for(;U();)for(let Z=0;Z<C.length;Z++)if(C[Z].done){const X=C[Z];if(C.splice(Z,1),Z--,X.ok)yield X.value;else throw N=!0,A.resolve(),X.err;A.resolve()}}for(;;){if(U()||(I=pDefer(),await I.promise),O!=null)throw O;if(E?yield*j():yield*z(),B&&C.length===0)break}}const directoryContent=(n,r,_,E,S,C,A)=>{async function*I(B={}){const O=B.offset??0,N=B.length??r.Links.length,U=r.Links.slice(O,N);B.onProgress?.(new CustomProgressEvent("unixfs:exporter:walk:directory",{cid:n})),yield*pipe(U,j=>map$1(j,z=>async()=>{const Z=z.Name??"",X=`${E}/${Z}`;return(await S(z.Hash,Z,X,[],C+1,A,B)).entry}),j=>parallel(j,{ordered:!0,concurrency:B.blockReadConcurrency}),j=>filter(j,z=>z!=null))}return I};async function walkDAG(n,r,_,E,S,C,A){if(r instanceof Uint8Array){const O=extractDataFromBlock(r,E,S,C);_.push(O);return}if(r.Data==null)throw errCode$1(new Error("no data in PBNode"),"ERR_NOT_UNIXFS");let I;try{I=UnixFS.unmarshal(r.Data)}catch(O){throw errCode$1(O,"ERR_NOT_UNIXFS")}if(I.data!=null){const O=I.data,N=extractDataFromBlock(O,E,S,C);_.push(N),E+=BigInt(N.byteLength)}const B=[];if(r.Links.length!==I.blockSizes.length)throw errCode$1(new Error("Inconsistent block sizes and dag links"),"ERR_NOT_UNIXFS");for(let O=0;O<r.Links.length;O++){const N=r.Links[O],U=E,j=U+I.blockSizes[O];if((S>=U&&S<j||C>=U&&C<=j||S<U&&C>j)&&B.push({link:N,blockStart:E}),E=j,E>C)break}await pipe(B,O=>map$1(O,N=>async()=>{const U=await n.get(N.link.Hash,A);return{...N,block:U}}),O=>parallel(O,{ordered:!0,concurrency:A.blockReadConcurrency}),async O=>{for await(const{link:N,block:U,blockStart:j}of O){let z;switch(N.Hash.code){case code$2:z=decode$9(U);break;case code$6:z=U;break;default:_.end(errCode$1(new Error(`Unsupported codec: ${N.Hash.code}`),"ERR_NOT_UNIXFS"));return}const Z=new PQueue$1({concurrency:1});Z.on("error",X=>{_.end(X)}),Z.add(async()=>{A.onProgress?.(new CustomProgressEvent("unixfs:exporter:walk:file",{cid:N.Hash})),await walkDAG(n,z,_,j,S,C,A)}),await Z.onIdle()}}),E>=C&&_.end()}const fileContent=(n,r,_,E,S,C,A)=>{async function*I(B={}){const O=_.fileSize();if(O===void 0)throw new Error("File was a directory");const{start:N,end:U}=validateOffsetAndLength(O,B.offset,B.length);if(U===0n)return;let j=0n;const z=U-N,Z=pushable$1();B.onProgress?.(new CustomProgressEvent("unixfs:exporter:walk:file",{cid:n})),walkDAG(A,r,Z,0n,N,U,B).catch(X=>{Z.end(X)});for await(const X of Z)if(X!=null){if(j+=BigInt(X.byteLength),j>z)throw Z.end(),errCode$1(new Error("Read too many bytes - the file size reported by the UnixFS data in the root node may be incorrect"),"ERR_OVER_READ");j===z&&Z.end(),B.onProgress?.(new CustomProgressEvent("unixfs:exporter:progress:unixfs:file",{bytesRead:j,totalBytes:z,fileSize:O})),yield X}if(j<z)throw errCode$1(new Error("Traversed entire DAG but did not read enough bytes"),"ERR_UNDER_READ")}return I},hamtShardedDirectoryContent=(n,r,_,E,S,C,A)=>{function I(B={}){return B.onProgress?.(new CustomProgressEvent("unixfs:exporter:walk:hamt-sharded-directory",{cid:n})),listDirectory(r,E,S,C,A,B)}return I};async function*listDirectory(n,r,_,E,S,C){const A=n.Links;if(n.Data==null)throw errCode$1(new Error("no data in PBNode"),"ERR_NOT_UNIXFS");let I;try{I=UnixFS.unmarshal(n.Data)}catch(N){throw errCode$1(N,"ERR_NOT_UNIXFS")}if(I.fanout==null)throw errCode$1(new Error("missing fanout"),"ERR_NOT_UNIXFS");const B=(I.fanout-1n).toString(16).length,O=pipe(A,N=>map$1(N,U=>async()=>{const j=U.Name!=null?U.Name.substring(B):null;if(j!=null&&j!==""){const z=await _(U.Hash,j,`${r}/${j}`,[],E+1,S,C);return{entries:z.entry==null?[]:[z.entry]}}else{const z=await S.get(U.Hash,C);return n=decode$9(z),C.onProgress?.(new CustomProgressEvent("unixfs:exporter:walk:hamt-sharded-directory",{cid:U.Hash})),{entries:listDirectory(n,r,_,E,S,C)}}}),N=>parallel(N,{ordered:!0,concurrency:C.blockReadConcurrency}));for await(const{entries:N}of O)yield*N}const findLinkCid=(n,r)=>n.Links.find(E=>E.Name===r)?.Hash,contentExporters={raw:fileContent,file:fileContent,directory:directoryContent,"hamt-sharded-directory":hamtShardedDirectoryContent,metadata:(n,r,_,E,S,C,A)=>()=>[],symlink:(n,r,_,E,S,C,A)=>()=>[]},unixFsResolver=async(n,r,_,E,S,C,A,I)=>{const B=await A.get(n,I),O=decode$9(B);let N,U;if(r==null&&(r=n.toString()),O.Data==null)throw errCode$1(new Error("no data in PBNode"),"ERR_NOT_UNIXFS");try{N=UnixFS.unmarshal(O.Data)}catch(z){throw errCode$1(z,"ERR_NOT_UNIXFS")}if(_==null&&(_=r),E.length>0){let z;if(N?.type==="hamt-sharded-directory"?z=await findShardCid(O,E[0],A):z=findLinkCid(O,E[0]),z==null)throw errCode$1(new Error("file does not exist"),"ERR_NOT_FOUND");const Z=E.shift(),X=`${_}/${Z}`;U={cid:z,toResolve:E,name:Z??"",path:X}}const j=contentExporters[N.type](n,O,N,_,S,C,A);if(j==null)throw errCode$1(new Error("could not find content exporter"),"ERR_NOT_FOUND");return N.isDirectory()?{entry:{type:"directory",name:r,path:_,cid:n,content:j,unixfs:N,depth:C,node:O,size:N.fileSize()},next:U}:{entry:{type:"file",name:r,path:_,cid:n,content:j,unixfs:N,depth:C,node:O,size:N.fileSize()},next:U}},resolvers$1={[code$2]:unixFsResolver,[code$6]:resolve$2,[code$8]:resolve$6,[code$1]:resolve$5,[identity$6.code]:resolve$4,[code$7]:resolve$3},resolve$1=async(n,r,_,E,S,C,A)=>{const I=resolvers$1[n.code];if(I==null)throw errCode$1(new Error(`No resolver for code ${n.code}`),"ERR_NO_RESOLVER");return I(n,r,_,E,resolve$1,S,C,A)},toPathComponents=(n="")=>(n.trim().match(/([^\\^/]|\\\/)+/g)??[]).filter(Boolean),cidAndRest=n=>{if(n instanceof Uint8Array)return{cid:CID.decode(n),toResolve:[]};const r=CID.asCID(n);if(r!=null)return{cid:r,toResolve:[]};if(typeof n=="string"){n.indexOf("/ipfs/")===0&&(n=n.substring(6));const _=toPathComponents(n);return{cid:CID.parse(_[0]),toResolve:_.slice(1)}}throw errCode$1(new Error(`Unknown path type ${n}`),"ERR_BAD_PATH")};async function*walkPath(n,r,_={}){let{cid:E,toResolve:S}=cidAndRest(n),C=E.toString(),A=C;const I=S.length;for(;;){const B=await resolve$1(E,C,A,S,I,r,_);if(B.entry==null&&B.next==null)throw errCode$1(new Error(`Could not resolve ${n}`),"ERR_NOT_FOUND");if(B.entry!=null&&(yield B.entry),B.next==null)return;S=B.next.toResolve,E=B.next.cid,C=B.next.name,A=B.next.path}}async function exporter$2(n,r,_={}){const E=await last(walkPath(n,r,_));if(E==null)throw errCode$1(new Error(`Could not resolve ${n}`),"ERR_NOT_FOUND");return E}async function*recursive(n,r,_={}){const E=await exporter$2(n,r,_);if(E==null)return;if(yield E,E.type==="directory")for await(const C of S(E,_))yield C;async function*S(C,A){for await(const I of C.content(A))yield I,!(I instanceof Uint8Array)&&I.type==="directory"&&(yield*S(I,A))}}var isPlainObj=n=>{if(Object.prototype.toString.call(n)!=="[object Object]")return!1;const r=Object.getPrototypeOf(n);return r===null||r===Object.prototype};const isOptionObject=isPlainObj,{hasOwnProperty}=Object.prototype,{propertyIsEnumerable}=Object,defineProperty=(n,r,_)=>Object.defineProperty(n,r,{value:_,writable:!0,enumerable:!0,configurable:!0}),globalThis$1=commonjsGlobal,defaultMergeOptions={concatArrays:!1,ignoreUndefined:!1},getEnumerableOwnPropertyKeys=n=>{const r=[];for(const _ in n)hasOwnProperty.call(n,_)&&r.push(_);if(Object.getOwnPropertySymbols){const _=Object.getOwnPropertySymbols(n);for(const E of _)propertyIsEnumerable.call(n,E)&&r.push(E)}return r};function clone(n){return Array.isArray(n)?cloneArray(n):isOptionObject(n)?cloneOptionObject(n):n}function cloneArray(n){const r=n.slice(0,0);return getEnumerableOwnPropertyKeys(n).forEach(_=>{defineProperty(r,_,clone(n[_]))}),r}function cloneOptionObject(n){const r=Object.getPrototypeOf(n)===null?Object.create(null):{};return getEnumerableOwnPropertyKeys(n).forEach(_=>{defineProperty(r,_,clone(n[_]))}),r}const mergeKeys=(n,r,_,E)=>(_.forEach(S=>{typeof r[S]>"u"&&E.ignoreUndefined||(S in n&&n[S]!==Object.getPrototypeOf(n)?defineProperty(n,S,merge(n[S],r[S],E)):defineProperty(n,S,clone(r[S])))}),n),concatArrays=(n,r,_)=>{let E=n.slice(0,0),S=0;return[n,r].forEach(C=>{const A=[];for(let I=0;I<C.length;I++)hasOwnProperty.call(C,I)&&(A.push(String(I)),C===n?defineProperty(E,S++,C[I]):defineProperty(E,S++,clone(C[I])));E=mergeKeys(E,C,getEnumerableOwnPropertyKeys(C).filter(I=>!A.includes(I)),_)}),E};function merge(n,r,_){return _.concatArrays&&Array.isArray(n)&&Array.isArray(r)?concatArrays(n,r,_):!isOptionObject(r)||!isOptionObject(n)?clone(r):mergeKeys(n,r,getEnumerableOwnPropertyKeys(r),_)}var mergeOptions$8=function(...n){const r=merge(clone(defaultMergeOptions),this!==globalThis$1&&this||{},defaultMergeOptions);let _={_:{}};for(const E of n)if(E!==void 0){if(!isOptionObject(E))throw new TypeError("`"+E+"` is not an Option Object");_=merge(_,{_:E},r)}return _._};const mergeOptions$9=getDefaultExportFromCjs(mergeOptions$8);class UnixFSError extends Error{name;code;constructor(r,_,E){super(r),this.name=_,this.code=E}}class NotUnixFSError extends UnixFSError{constructor(r="not a Unixfs node"){super(r,"NotUnixFSError","ERR_NOT_UNIXFS")}}class InvalidPBNodeError extends UnixFSError{constructor(r="invalid PBNode"){super(r,"InvalidPBNodeError","ERR_INVALID_PBNODE")}}class UnknownError extends UnixFSError{constructor(r="unknown error"){super(r,"InvalidPBNodeError","ERR_UNKNOWN_ERROR")}}class AlreadyExistsError extends UnixFSError{constructor(r="path already exists"){super(r,"AlreadyExistsError","ERR_ALREADY_EXISTS")}}class DoesNotExistError extends UnixFSError{constructor(r="path does not exist"){super(r,"DoesNotExistError","ERR_DOES_NOT_EXIST")}}class NoContentError extends UnixFSError{constructor(r="no content"){super(r,"NoContentError","ERR_NO_CONTENT")}}class NotAFileError extends UnixFSError{constructor(r="not a file"){super(r,"NotAFileError","ERR_NOT_A_FILE")}}class NotADirectoryError extends UnixFSError{constructor(r="not a directory"){super(r,"NotADirectoryError","ERR_NOT_A_DIRECTORY")}}class InvalidParametersError extends UnixFSError{constructor(r="invalid parameters"){super(r,"InvalidParametersError","ERR_INVALID_PARAMETERS")}}var browser$3={exports:{}},ms,hasRequiredMs;function requireMs(){if(hasRequiredMs)return ms;hasRequiredMs=1;var n=1e3,r=n*60,_=r*60,E=_*24,S=E*7,C=E*365.25;ms=function(N,U){U=U||{};var j=typeof N;if(j==="string"&&N.length>0)return A(N);if(j==="number"&&isFinite(N))return U.long?B(N):I(N);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(N))};function A(N){if(N=String(N),!(N.length>100)){var U=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(N);if(U){var j=parseFloat(U[1]),z=(U[2]||"ms").toLowerCase();switch(z){case"years":case"year":case"yrs":case"yr":case"y":return j*C;case"weeks":case"week":case"w":return j*S;case"days":case"day":case"d":return j*E;case"hours":case"hour":case"hrs":case"hr":case"h":return j*_;case"minutes":case"minute":case"mins":case"min":case"m":return j*r;case"seconds":case"second":case"secs":case"sec":case"s":return j*n;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return j;default:return}}}}function I(N){var U=Math.abs(N);return U>=E?Math.round(N/E)+"d":U>=_?Math.round(N/_)+"h":U>=r?Math.round(N/r)+"m":U>=n?Math.round(N/n)+"s":N+"ms"}function B(N){var U=Math.abs(N);return U>=E?O(N,U,E,"day"):U>=_?O(N,U,_,"hour"):U>=r?O(N,U,r,"minute"):U>=n?O(N,U,n,"second"):N+" ms"}function O(N,U,j,z){var Z=U>=j*1.5;return Math.round(N/j)+" "+z+(Z?"s":"")}return ms}function setup(n){_.debug=_,_.default=_,_.coerce=B,_.disable=C,_.enable=S,_.enabled=A,_.humanize=requireMs(),_.destroy=O,Object.keys(n).forEach(N=>{_[N]=n[N]}),_.names=[],_.skips=[],_.formatters={};function r(N){let U=0;for(let j=0;j<N.length;j++)U=(U<<5)-U+N.charCodeAt(j),U|=0;return _.colors[Math.abs(U)%_.colors.length]}_.selectColor=r;function _(N){let U,j=null,z,Z;function X(...Q){if(!X.enabled)return;const se=X,oe=Number(new Date),ue=oe-(U||oe);se.diff=ue,se.prev=U,se.curr=oe,U=oe,Q[0]=_.coerce(Q[0]),typeof Q[0]!="string"&&Q.unshift("%O");let we=0;Q[0]=Q[0].replace(/%([a-zA-Z%])/g,(xe,Re)=>{if(xe==="%%")return"%";we++;const Ne=_.formatters[Re];if(typeof Ne=="function"){const Fe=Q[we];xe=Ne.call(se,Fe),Q.splice(we,1),we--}return xe}),_.formatArgs.call(se,Q),(se.log||_.log).apply(se,Q)}return X.namespace=N,X.useColors=_.useColors(),X.color=_.selectColor(N),X.extend=E,X.destroy=_.destroy,Object.defineProperty(X,"enabled",{enumerable:!0,configurable:!1,get:()=>j!==null?j:(z!==_.namespaces&&(z=_.namespaces,Z=_.enabled(N)),Z),set:Q=>{j=Q}}),typeof _.init=="function"&&_.init(X),X}function E(N,U){const j=_(this.namespace+(typeof U>"u"?":":U)+N);return j.log=this.log,j}function S(N){_.save(N),_.namespaces=N,_.names=[],_.skips=[];let U;const j=(typeof N=="string"?N:"").split(/[\s,]+/),z=j.length;for(U=0;U<z;U++)j[U]&&(N=j[U].replace(/\*/g,".*?"),N[0]==="-"?_.skips.push(new RegExp("^"+N.slice(1)+"$")):_.names.push(new RegExp("^"+N+"$")))}function C(){const N=[..._.names.map(I),..._.skips.map(I).map(U=>"-"+U)].join(",");return _.enable(""),N}function A(N){if(N[N.length-1]==="*")return!0;let U,j;for(U=0,j=_.skips.length;U<j;U++)if(_.skips[U].test(N))return!1;for(U=0,j=_.names.length;U<j;U++)if(_.names[U].test(N))return!0;return!1}function I(N){return N.toString().substring(2,N.toString().length-2).replace(/\.\*\?$/,"*")}function B(N){return N instanceof Error?N.stack||N.message:N}function O(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return _.enable(_.load()),_}var common=setup;(function(n,r){var _={};r.formatArgs=S,r.save=C,r.load=A,r.useColors=E,r.storage=I(),r.destroy=(()=>{let O=!1;return()=>{O||(O=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),r.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function E(){return typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs)?!0:typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/)?!1:typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function S(O){if(O[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+O[0]+(this.useColors?"%c ":" ")+"+"+n.exports.humanize(this.diff),!this.useColors)return;const N="color: "+this.color;O.splice(1,0,N,"color: inherit");let U=0,j=0;O[0].replace(/%[a-zA-Z%]/g,z=>{z!=="%%"&&(U++,z==="%c"&&(j=U))}),O.splice(j,0,N)}r.log=console.debug||console.log||(()=>{});function C(O){try{O?r.storage.setItem("debug",O):r.storage.removeItem("debug")}catch{}}function A(){let O;try{O=r.storage.getItem("debug")}catch{}return!O&&typeof browser$1$1<"u"&&"env"in browser$1$1&&(O=_.DEBUG),O}function I(){try{return localStorage}catch{}}n.exports=common(r);const{formatters:B}=n.exports;B.j=function(O){try{return JSON.stringify(O)}catch(N){return"[UnexpectedJSONParseError]: "+N.message}}})(browser$3,browser$3.exports);var browserExports=browser$3.exports;const _debug=getDefaultExportFromCjs(browserExports);_debug.formatters.b=n=>n==null?"undefined":base58btc.baseEncode(n);_debug.formatters.t=n=>n==null?"undefined":base32.baseEncode(n);_debug.formatters.m=n=>n==null?"undefined":base64$5.baseEncode(n);_debug.formatters.p=n=>n==null?"undefined":n.toString();_debug.formatters.c=n=>n==null?"undefined":n.toString();_debug.formatters.k=n=>n==null?"undefined":n.toString();_debug.formatters.a=n=>n==null?"undefined":n.toString();function createDisabledLogger$1(n){const r=()=>{};return r.enabled=!1,r.color="",r.diff=0,r.log=()=>{},r.namespace=n,r.destroy=()=>!0,r.extend=()=>r,r}function defaultLogger(){return{forComponent(n){return logger$2(n)}}}function logger$2(n){let r=createDisabledLogger$1(`${n}:trace`);return _debug.enabled(`${n}:trace`)&&_debug.names.map(_=>_.toString()).find(_=>_.includes(":trace"))!=null&&(r=_debug(`${n}:trace`)),Object.assign(_debug(n),{error:_debug(`${n}:error`),trace:r})}function wrapHash(n){function r(_){return _ instanceof InfiniteHash?_:new InfiniteHash(_,n)}return r}class InfiniteHash{_value;_hashFn;_depth;_availableBits;_currentBufferIndex;_buffers;constructor(r,_){if(!(r instanceof Uint8Array))throw new Error("can only hash Uint8Arrays");this._value=r,this._hashFn=_,this._depth=-1,this._availableBits=0,this._currentBufferIndex=0,this._buffers=[]}async take(r){let _=r;for(;this._availableBits<_;)await this._produceMoreBits();let E=0;for(;_>0;){const S=this._buffers[this._currentBufferIndex],C=Math.min(S.availableBits(),_),A=S.take(C);E=(E<<C)+A,_-=C,this._availableBits-=C,S.availableBits()===0&&this._currentBufferIndex++}return E}untake(r){let _=r;for(;_>0;){const E=this._buffers[this._currentBufferIndex],S=Math.min(E.totalBits()-E.availableBits(),_);E.untake(S),_-=S,this._availableBits+=S,this._currentBufferIndex>0&&E.totalBits()===E.availableBits()&&(this._depth--,this._currentBufferIndex--)}}async _produceMoreBits(){this._depth++;const r=this._depth>0?concat$4([this._value,Uint8Array.from([this._depth])]):this._value,_=await this._hashFn(r),E=new ConsumableBuffer(_);this._buffers.push(E),this._availableBits+=E.availableBits()}}const START_MASKS=[255,254,252,248,240,224,192,128],STOP_MASKS=[1,3,7,15,31,63,127,255];class ConsumableBuffer{_value;_currentBytePos;_currentBitPos;constructor(r){this._value=r,this._currentBytePos=r.length-1,this._currentBitPos=7}availableBits(){return this._currentBitPos+1+this._currentBytePos*8}totalBits(){return this._value.length*8}take(r){let _=r,E=0;for(;_>0&&this._haveBits();){const S=this._value[this._currentBytePos],C=this._currentBitPos+1,A=Math.min(C,_),I=byteBitsToInt(S,C-A,A);E=(E<<A)+I,_-=A,this._currentBitPos-=A,this._currentBitPos<0&&(this._currentBitPos=7,this._currentBytePos--)}return E}untake(r){for(this._currentBitPos+=r;this._currentBitPos>7;)this._currentBitPos-=8,this._currentBytePos+=1}_haveBits(){return this._currentBytePos>=0}}function byteBitsToInt(n,r,_){const E=maskFor(r,_);return(n&E)>>>r}function maskFor(n,r){return START_MASKS[n]&STOP_MASKS[Math.min(r+n-1,7)]}const hamtHashCode=BigInt(murmur3128.code),hamtBucketBits=8;async function hamtHashFn(n){return(await murmur3128.encode(n)).subarray(0,8).reverse()}const persist=async(n,r,_)=>{_.codec==null&&(_.codec=dagPB);const E=await sha256$6.digest(n),S=CID.create(_.cidVersion,_.codec.code,E);return await r.put(S,n,{..._,signal:_.signal}),S};class Dir{options;root;dir;path;dirty;flat;parent;parentKey;unixfs;mode;mtime;cid;size;nodeSize;constructor(r,_){this.options=_??{},this.root=r.root,this.dir=r.dir,this.path=r.path,this.dirty=r.dirty,this.flat=r.flat,this.parent=r.parent,this.parentKey=r.parentKey,this.unixfs=r.unixfs,this.mode=r.mode,this.mtime=r.mtime}}class DirSharded extends Dir{_bucket;constructor(r,_){super(r,_),this._bucket=createHAMT({hashFn:hamtHashFn,bits:8})}async put(r,_){this.cid=void 0,this.size=void 0,this.nodeSize=void 0,await this._bucket.put(r,_)}async get(r){return this._bucket.get(r)}childCount(){return this._bucket.leafCount()}directChildrenCount(){return this._bucket.childrenCount()}onlyChild(){return this._bucket.onlyChild()}async*eachChildSeries(){for await(const{key:r,value:_}of this._bucket.eachLeafSeries())yield{key:r,child:_}}estimateNodeSize(){return this.nodeSize!==void 0?this.nodeSize:(this.nodeSize=calculateSize(this._bucket,this,this.options),this.nodeSize)}async*flush(r){for await(const _ of flush(this._bucket,r,this,this.options))yield{..._,path:this.path}}}async function*flush(n,r,_,E){const S=n._children,C=[];let A=0n;for(let z=0;z<S.length;z++){const Z=S.get(z);if(Z==null)continue;const X=z.toString(16).toUpperCase().padStart(2,"0");if(Z instanceof Bucket){let Q;for await(const se of flush(Z,r,null,E))Q=se;if(Q==null)throw new Error("Could not flush sharded directory, no subshard found");C.push({Name:X,Tsize:Number(Q.size),Hash:Q.cid}),A+=Q.size}else if(isDir(Z.value)){const Q=Z.value;let se;for await(const ue of Q.flush(r))se=ue,yield se;if(se==null)throw new Error("Did not flush dir");const oe=X+Z.key;C.push({Name:oe,Tsize:Number(se.size),Hash:se.cid}),A+=se.size}else{const Q=Z.value;if(Q.cid==null)continue;const se=X+Z.key,oe=Q.size;C.push({Name:se,Tsize:Number(oe),Hash:Q.cid}),A+=BigInt(oe??0)}}const I=Uint8Array.from(S.bitField().reverse()),B=new UnixFS({type:"hamt-sharded-directory",data:I,fanout:BigInt(n.tableSize()),hashType:hamtHashCode,mtime:_?.mtime,mode:_?.mode}),O={Data:B.marshal(),Links:C},N=encode$9(prepare(O)),U=await persist(N,r,E),j=BigInt(N.byteLength)+A;yield{cid:U,unixfs:B,size:j}}function isDir(n){return typeof n.flush=="function"}function calculateSize(n,r,_){const E=n._children,S=[];for(let B=0;B<E.length;B++){const O=E.get(B);if(O==null)continue;const N=B.toString(16).toUpperCase().padStart(2,"0");if(O instanceof Bucket){const U=calculateSize(O,null,_);S.push({Name:N,Tsize:Number(U),Hash:_.cidVersion===0?CID_V0:CID_V1})}else if(typeof O.value.flush=="function"){const j=O.value.nodeSize();S.push({Name:N+O.key,Tsize:Number(j),Hash:_.cidVersion===0?CID_V0:CID_V1})}else{const U=O.value;if(U.cid==null)continue;const j=N+O.key,z=U.size;S.push({Name:j,Tsize:Number(z),Hash:U.cid})}}const C=Uint8Array.from(E.bitField().reverse()),A=new UnixFS({type:"hamt-sharded-directory",data:C,fanout:BigInt(n.tableSize()),hashType:hamtHashCode,mtime:r?.mtime,mode:r?.mode});return encode$9(prepare({Data:A.marshal(),Links:S})).length}const CID_V0=CID.parse("QmUNLLsPACCz1vLxQVkXqqLX5R1X345qqfHbsf67hvA3Nn"),CID_V1=CID.parse("zdj7WbTaiJT1fgatdet9Ei9iDB5hdCxkbVyhyh8YTUnXMiwYi"),log$e=logger$2("helia:unixfs:commands:utils:hamt-utils"),toPrefix=n=>n.toString(16).toUpperCase().padStart(2,"0").substring(0,2),createShard=async(n,r,_)=>{const E=new DirSharded({root:!0,dir:!0,parent:void 0,parentKey:void 0,path:"",dirty:!0,flat:!1,mtime:_.mtime,mode:_.mode},_);for(let C=0;C<r.length;C++)await E._bucket.put(r[C].name,{size:r[C].size,cid:r[C].cid});const S=await last(E.flush(n));if(S==null)throw new Error("Flushing shard yielded no result");return S},updateShardedDirectory=async(n,r,_)=>{const E=UnixFS.unmarshal(n[0].node.Data??new Uint8Array(0)),S=BigInt(Math.pow(2,hamtBucketBits));n.reverse();let C,A;for(let I=0;I<n.length;I++){const B=I===n.length-1,O=n[I],N=Uint8Array.from(O.children.bitField().reverse()),U=new UnixFS({type:"hamt-sharded-directory",data:N,fanout:S,hashType:hamtHashCode});B&&(U.mtime=E.mtime,U.mode=E.mode),A={Data:U.marshal(),Links:O.node.Links};const j=encode$9(prepare(A));if(C=await persist(j,r,_),!B){const z=n[I+1];if(z==null)throw new Error("Was not operating on shard root but also had no parent?");log$e("updating link in parent sub-shard with prefix %s",z.prefix),z.node.Links=z.node.Links.filter(Z=>Z.Name!==z.prefix),z.node.Links.push({Name:z.prefix,Hash:C,Tsize:O.node.Links.reduce((Z,X)=>Z+(X.Tsize??0),j.byteLength)})}}if(C==null||A==null)throw new Error("Noting persisted");return{cid:C,node:A}},recreateShardedDirectory=async(n,r,_,E)=>{const C=wrapHash(hamtHashFn)(fromString$3(r)),A=[];for(;;){const I=await _.get(n,E),B=decode$9(I),O=new SparseArray,N=await C.take(hamtBucketBits),U=toPrefix(N);A.push({prefix:U,children:O,node:B});let j;for(const Z of B.Links){const X=Z.Name??"";if(X.length<2)throw new Error("Invalid HAMT - link name was too short");const Q=parseInt(X.substring(0,2),16);O.set(Q,!0),X.startsWith(U)&&(j=Z)}if(j==null){log$e("no link found with prefix %s for %s",U,r);break}const z=j.Name??"";if(z.length<2)throw new Error("Invalid HAMT - link name was too short");if(z.length===2){n=j.Hash,log$e("descend into sub-shard with prefix %s",z);continue}break}return{path:A,hash:C}};async function isOverShardThreshold(n,r,_,E){if(n.Data==null)throw new Error("DagPB node had no data");const S=UnixFS.unmarshal(n.Data);let C;if(S.type==="directory")C=estimateNodeSize(n);else if(S.type==="hamt-sharded-directory")C=await estimateShardSize(n,0,_,r,E);else throw new Error("Can only estimate the size of directories or shards");return C>_}function estimateNodeSize(n){let r=0;for(const _ of n.Links)r+=(_.Name??"").length,r+=_.Hash.version===1?CID_V1.bytes.byteLength:CID_V0.bytes.byteLength;return r}async function estimateShardSize(n,r,_,E,S){if(r>_)return _;if(n.Data==null||!UnixFS.unmarshal(n.Data).isDirectory())return r;for(const A of n.Links){let I=A.Name??"";if(I=I.substring(2),r+=I.length,r+=A.Hash.bytes.byteLength,A.Hash.code===code$2){const B=await E.get(A.Hash,S),O=decode$9(B);r+=await estimateShardSize(O,r,_,E,S)}}return r}const log$d=logger$2("helia:unixfs:components:utils:add-link");async function addLink(n,r,_,E){if(n.node.Data==null)throw new InvalidParametersError("Invalid parent passed to addLink");if(UnixFS.unmarshal(n.node.Data).type==="hamt-sharded-directory")return log$d("adding link to sharded directory"),addToShardedDirectory(n,r,_,E);log$d(`adding ${r.Name} (${r.Hash}) to regular directory`);const C=await addToDirectory(n,r,_,E);if(await isOverShardThreshold(C.node,_,E.shardSplitThresholdBytes,E)){log$d("converting directory to sharded directory");const A=await convertToShardedDirectory(C,_);C.cid=A.cid,C.node=decode$9(await _.get(A.cid,E))}return C}const convertToShardedDirectory=async(n,r)=>{if(n.node.Data==null)throw new InvalidParametersError("Invalid parent passed to convertToShardedDirectory");const _=UnixFS.unmarshal(n.node.Data),E=await createShard(r,n.node.Links.map(S=>({name:S.Name??"",size:BigInt(S.Tsize??0),cid:S.Hash})),{mode:_.mode,mtime:_.mtime,cidVersion:n.cid.version});return log$d(`converted directory to sharded directory ${E.cid}`),E},addToDirectory=async(n,r,_,E)=>{const S=n.node.Links.filter(N=>{const U=N.Name===r.Name;if(U&&!E.allowOverwriting)throw new AlreadyExistsError;return!U});if(S.push(r),n.node.Data==null)throw new InvalidPBNodeError("Parent node with no data passed to addToDirectory");const C=UnixFS.unmarshal(n.node.Data);let A;if(C.mtime!=null){const N=Date.now(),U=Math.floor(N/1e3);C.mtime={secs:BigInt(U),nsecs:(N-U*1e3)*1e3},A=C.marshal()}else A=n.node.Data;n.node=prepare({Data:A,Links:S});const I=encode$9(n.node),B=await sha256$6.digest(I),O=CID.create(n.cid.version,code$2,B);return await _.put(O,I),{node:n.node,cid:O}},addToShardedDirectory=async(n,r,_,E)=>{const{path:S,hash:C}=await recreateShardedDirectory(n.cid,r.Name,_,E),A=S[S.length-1];if(A==null)throw new Error("Invalid HAMT, could not generate path");const I=A.prefix,B=parseInt(I,16);log$d("next prefix for %s is %s",r.Name,I);const O=`${I}${r.Name}`,N=A.node.Links.find(U=>(U.Name??"").startsWith(I));if(N!=null)if(log$d("link %s was present in shard",O),N.Name===O){if(!E.allowOverwriting)throw new AlreadyExistsError;log$d("overwriting %s in subshard",r.Name),A.node.Links=A.node.Links.filter(U=>U.Name!==O),A.node.Links.push({Name:O,Hash:r.Hash,Tsize:r.Tsize})}else{if(N.Name?.length===2)throw new Error("Existing link was subshard?!");{log$d("prefix %s already exists, creating new subshard",I);const U=A.node.Links.findIndex(Q=>Q.Name?.startsWith(I)),j=A.node.Links.splice(U,1)[0],z=(j.Name??"").substring(2),X=wrapHash(hamtHashFn)(fromString$3(z));for(let Q=0;Q<S.length;Q++)await X.take(hamtBucketBits);for(;;){const Q=await X.take(hamtBucketBits),se=toPrefix(Q);j.Name=`${se}${z}`;const oe=await C.take(hamtBucketBits),ue=toPrefix(oe);if(se===ue){const Te=new SparseArray;Te.set(oe,!0),S.push({prefix:ue,children:Te,node:{Links:[]}});continue}const we=new SparseArray;we.set(oe,!0),we.set(Q,!0),S.push({prefix:I,children:we,node:{Links:[j,{Name:`${ue}${r.Name}`,Hash:r.Hash,Tsize:r.Tsize}]}});break}}}else log$d("link %s was not present in sub-shard",O),r.Name=O,A.node.Links.push(r),A.children.set(B,!0),log$d("adding %s to existing sub-shard",O);return updateShardedDirectory(S,_,E)};async function cidToDirectory(n,r,_={}){const E=await exporter$2(n,r,_);if(E.type!=="directory")throw new NotADirectoryError(`${n.toString()} was not a UnixFS directory`);return{cid:n,node:E.node}}async function cidToPBLink(n,r,_,E){const S=await exporter$2(n,_,E);if(S.type!=="directory"&&S.type!=="file"&&S.type!=="raw")throw new NotUnixFSError(`${n.toString()} was not a UnixFS node`);return{Name:r,Tsize:S.node instanceof Uint8Array?S.node.byteLength:dagNodeTsize(S.node),Hash:n}}function dagNodeTsize(n){const r=n.Links.reduce((_,E)=>_+(E.Tsize??0),0);return encode$9(n).byteLength+r}const log$c=logger$2("helia:unixfs:components:utils:resolve");async function resolve(n,r,_,E){if(r==null||r==="")return{cid:n};const S=`/ipfs/${n}${r==null?"":`/${r}`}`,C=await all$1(walkPath(S,_,E));if(C.length===0)throw new DoesNotExistError("Could not find path in directory");return log$c("resolved %s to %c",r,n),{cid:C[C.length-1].cid,path:r,segments:C}}async function updatePathCids(n,r,_,E){if(r.segments==null||r.segments.length===0)return n;let S=r.segments.pop();if(S==null)throw new Error("Insufficient segments");S.cid=n,r.segments.reverse();for(const C of r.segments){const[A,I]=await Promise.all([cidToDirectory(C.cid,_,E),cidToPBLink(S.cid,S.name,_,E)]);n=(await addLink(A,I,_,{...E,allowOverwriting:!0,cidVersion:n.version})).cid,C.cid=n,S=C}return n}const mergeOptions$7=mergeOptions$9.bind({ignoreUndefined:!0}),defaultOptions$g={};async function*cat(n,r,_={}){const E=mergeOptions$7(defaultOptions$g,_),S=await resolve(n,E.path,r,E),C=await exporter$2(S.cid,r,E);if(C.type!=="file"&&C.type!=="raw")throw new NotAFileError;if(C.content==null)throw new NoContentError;yield*C.content(E)}const SHARD_SPLIT_THRESHOLD_BYTES=262144,mergeOptions$6=mergeOptions$9.bind({ignoreUndefined:!0}),log$b=logger$2("helia:unixfs:chmod"),defaultOptions$f={recursive:!1,shardSplitThresholdBytes:SHARD_SPLIT_THRESHOLD_BYTES};async function chmod(n,r,_,E={}){const S=mergeOptions$6(defaultOptions$f,E),C=await resolve(n,S.path,_,E);if(log$b("chmod %c %d",C.cid,r),S.recursive){const j=await pipe(async function*(){for await(const z of recursive(C.cid,_,E)){let Z,X=[];if(z.type==="raw")Z=new UnixFS({type:"file",data:z.node});else if(z.type==="file"||z.type==="directory")Z=z.unixfs,X=z.node.Links;else throw new NotUnixFSError;Z.mode=r;const Q={Data:Z.marshal(),Links:X};yield{path:z.path,content:Q}}},z=>importer$1(z,_,{...S,dagBuilder:async function*(Z,X){for await(const Q of Z)yield async function(){const se=Q.content,oe=encode$9(se),ue=await persist(oe,X,{...S,cidVersion:n.version});if(se.Data==null)throw new InvalidPBNodeError(`${ue} had no data`);const we=UnixFS.unmarshal(se.Data);return{cid:ue,size:BigInt(oe.length),path:Q.path,unixfs:we}}}}),async z=>last(z));if(j==null)throw new UnknownError(`Could not chmod ${C.cid.toString()}`);return updatePathCids(j.cid,C,_,S)}const A=await _.get(C.cid,E);let I,B=[];if(C.cid.code===code$6)I=new UnixFS({type:"file",data:A});else{const j=decode$9(A);if(j.Data==null)throw new InvalidPBNodeError(`${C.cid.toString()} had no data`);B=j.Links,I=UnixFS.unmarshal(j.Data)}I.mode=r;const O=encode$9({Data:I.marshal(),Links:B}),N=await sha256$6.digest(O),U=CID.create(C.cid.version,code$2,N);return await _.put(U,O),updatePathCids(U,C,_,S)}const mergeOptions$5=mergeOptions$9.bind({ignoreUndefined:!0}),log$a=logger$2("helia:unixfs:cp"),defaultOptions$e={force:!1,shardSplitThresholdBytes:SHARD_SPLIT_THRESHOLD_BYTES};async function cp(n,r,_,E,S={}){const C=mergeOptions$5(defaultOptions$e,S);if(_.includes("/"))throw new InvalidParametersError("Name must not have slashes");const[A,I]=await Promise.all([cidToDirectory(r,E,C),cidToPBLink(n,_,E,C)]);return log$a('Adding %c as "%s" to %c',n,_,r),(await addLink(A,I,E,{allowOverwriting:C.force,cidVersion:r.version,...C})).cid}const mergeOptions$4=mergeOptions$9.bind({ignoreUndefined:!0}),defaultOptions$d={};async function*ls(n,r,_={}){const E=mergeOptions$4(defaultOptions$d,_),S=await resolve(n,E.path,r,E),C=await exporter$2(S.cid,r);if(C.type==="file"||C.type==="raw"){yield C;return}if(C.content==null)throw new NoContentError;if(C.type!=="directory")throw new NotADirectoryError;yield*C.content({offset:_.offset,length:_.length})}const mergeOptions$3=mergeOptions$9.bind({ignoreUndefined:!0}),log$9=logger$2("helia:unixfs:mkdir"),defaultOptions$c={cidVersion:1,force:!1,shardSplitThresholdBytes:SHARD_SPLIT_THRESHOLD_BYTES};async function mkdir(n,r,_,E={}){const S=mergeOptions$3(defaultOptions$c,E);if(r.includes("/"))throw new InvalidParametersError("Path must not have slashes");if((await exporter$2(n,_,E)).type!=="directory")throw new NotADirectoryError(`${n.toString()} was not a UnixFS directory`);log$9("creating %s",r);const I={Data:new UnixFS({type:"directory",mode:S.mode,mtime:S.mtime}).marshal(),Links:[]},B=encode$9(I),O=await sha256$6.digest(B),N=CID.create(S.cidVersion,code$2,O);await _.put(N,B);const[U,j]=await Promise.all([cidToDirectory(n,_,S),cidToPBLink(N,r,_,S)]);return log$9("adding empty dir called %s to %c",r,n),(await addLink(U,j,_,{...S,allowOverwriting:S.force})).cid}const log$8=logger$2("helia:unixfs:utils:remove-link");async function removeLink(n,r,_,E){if(n.node.Data==null)throw new InvalidPBNodeError("Parent node had no data");if(UnixFS.unmarshal(n.node.Data).type==="hamt-sharded-directory"){log$8(`removing ${r} from sharded directory`);const C=await removeFromShardedDirectory(n,r,_,E);return await isOverShardThreshold(C.node,_,E.shardSplitThresholdBytes,E)?C:(log$8("converting shard to flat directory %c",n.cid),convertToFlatDirectory(C,_,E))}return log$8(`removing link ${r} regular directory`),removeFromDirectory(n,r,_,E)}const removeFromDirectory=async(n,r,_,E)=>{n.node.Links=n.node.Links.filter(A=>A.Name!==r);const S=encode$9(n.node),C=await persist(S,_,{...E,cidVersion:n.cid.version});return log$8(`Updated regular directory ${C}`),{node:n.node,cid:C}},removeFromShardedDirectory=async(n,r,_,E)=>{const{path:S}=await recreateShardedDirectory(n.cid,r,_,E),C=S[S.length-1];if(C==null)throw new Error("Invalid HAMT, could not generate path");const A=C.node.Links.filter(O=>(O.Name??"").substring(2)===r).map(O=>O.Name).pop();if(A==null)throw new Error("File not found");const I=A.substring(0,2),B=parseInt(I,16);if(C.node.Links=C.node.Links.filter(O=>O.Name!==A),C.children.unset(B),C.node.Links.length===1)for(;S.length!==1;){const O=S[S.length-1];if(O==null||O.node.Links.length>1)break;S.pop();const N=S[S.length-1];if(N==null)break;const U=O.node.Links[0];N.node.Links=N.node.Links.filter(j=>!(j.Name??"").startsWith(N.prefix)),N.node.Links.push({Hash:U.Hash,Name:`${N.prefix}${(U.Name??"").substring(2)}`,Tsize:U.Tsize})}return updateShardedDirectory(S,_,E)},convertToFlatDirectory=async(n,r,_)=>{if(n.node.Data==null)throw new InvalidParametersError("Invalid parent passed to convertToFlatDirectory");const E={Links:[]},S=await exporter$2(n.cid,r);if(S.type!=="directory")throw new Error("Unexpected node type");for await(const B of S.content()){let O=0;B.node instanceof Uint8Array?O=B.node.byteLength:O=encode$9(B.node).length,E.Links.push({Hash:B.cid,Name:B.name,Tsize:O})}const C=UnixFS.unmarshal(n.node.Data);E.Data=new UnixFS({type:"directory",mode:C.mode,mtime:C.mtime}).marshal();const A=encode$9(prepare(E));return{cid:await persist(A,r,{codec:dagPB,cidVersion:n.cid.version,signal:_.signal}),node:E}},mergeOptions$2=mergeOptions$9.bind({ignoreUndefined:!0}),log$7=logger$2("helia:unixfs:rm"),defaultOptions$b={shardSplitThresholdBytes:SHARD_SPLIT_THRESHOLD_BYTES};async function rm(n,r,_,E={}){const S=mergeOptions$2(defaultOptions$b,E);if(r.includes("/"))throw new InvalidParametersError("Name must not have slashes");const C=await cidToDirectory(n,_,S);return log$7("Removing %s from %c",r,n),(await removeLink(C,r,_,{...S,cidVersion:n.version})).cid}const mergeOptions$1=mergeOptions$9.bind({ignoreUndefined:!0}),log$6=logger$2("helia:unixfs:stat"),defaultOptions$a={};async function stat(n,r,_={}){const E=mergeOptions$1(defaultOptions$a,_),S=await resolve(n,_.path,r,E);log$6("stat %c",S.cid);const C=await exporter$2(S.cid,r,E);if(C.type!=="file"&&C.type!=="directory"&&C.type!=="raw")throw new NotUnixFSError;let A=0n,I=0n,B=0n,O=0n,N=0,U,j;const z=C.type;let Z;if(C.type==="raw"&&(A=BigInt(C.node.byteLength),I=BigInt(C.node.byteLength),B=BigInt(C.node.byteLength),O=BigInt(C.node.byteLength),N=1),C.type==="directory"&&(A=0n,I=BigInt(C.unixfs.marshal().byteLength),B=0n,O=I,N=1,U=C.unixfs.mode,j=C.unixfs.mtime,Z=C.unixfs),C.type==="file"){const X=await inspectDag(S.cid,r,E);A=C.unixfs.fileSize(),I=BigInt((C.node.Data?.byteLength??0)+C.node.Links.reduce((Q,se)=>Q+(se.Tsize??0),0)),B=BigInt(X.localFileSize),O=BigInt(X.localDagSize),N=X.blocks,U=C.unixfs.mode,j=C.unixfs.mtime,Z=C.unixfs}return{cid:S.cid,mode:U,mtime:j,fileSize:A,dagSize:I,localFileSize:B,localDagSize:O,blocks:N,type:z,unixfs:Z}}async function inspectDag(n,r,_){const E={localFileSize:0,localDagSize:0,blocks:0};if(await r.has(n,_)){const S=await r.get(n,_);if(E.blocks++,E.localDagSize+=S.byteLength,n.code===code$6)E.localFileSize+=S.byteLength;else if(n.code===code$2){const C=decode$9(S);if(C.Links.length>0)for(const A of C.Links){const I=await inspectDag(A.Hash,r,_);E.localFileSize+=I.localFileSize,E.localDagSize+=I.localDagSize,E.blocks+=I.blocks}else{if(C.Data==null)throw new InvalidPBNodeError(`PBNode ${n.toString()} had no data`);const A=UnixFS.unmarshal(C.Data);if(A.data==null)throw new InvalidPBNodeError(`UnixFS node ${n.toString()} had no data`);E.localFileSize+=A.data.byteLength??0}}else throw new UnknownError(`${n.toString()} was neither DAG_PB nor RAW`)}return E}const mergeOptions=mergeOptions$9.bind({ignoreUndefined:!0}),log$5=logger$2("helia:unixfs:touch"),defaultOptions$9={recursive:!1,shardSplitThresholdBytes:SHARD_SPLIT_THRESHOLD_BYTES};async function touch(n,r,_={}){const E=mergeOptions(defaultOptions$9,_),S=await resolve(n,E.path,r,E),C=E.mtime??{secs:BigInt(Math.round(Date.now()/1e3)),nsecs:0};if(log$5("touch %c %o",S.cid,C),E.recursive){const j=await pipe(async function*(){for await(const z of recursive(S.cid,r)){let Z,X;if(z.type==="raw")Z=new UnixFS({data:z.node}),X=[];else if(z.type==="file"||z.type==="directory")Z=z.unixfs,X=z.node.Links;else throw new NotUnixFSError;Z.mtime=C;const Q={Data:Z.marshal(),Links:X};yield{path:z.path,content:Q}}},z=>importer$1(z,r,{...E,dagBuilder:async function*(Z,X){for await(const Q of Z)yield async function(){const se=Q.content,oe=encode$9(se),ue=await persist(oe,X,{...E,cidVersion:n.version});if(se.Data==null)throw new InvalidPBNodeError(`${ue} had no data`);const we=UnixFS.unmarshal(se.Data);return{cid:ue,size:BigInt(oe.length),path:Q.path,unixfs:we}}}}),async z=>last(z));if(j==null)throw new UnknownError(`Could not chmod ${S.cid.toString()}`);return updatePathCids(j.cid,S,r,E)}const A=await r.get(S.cid,_);let I,B=[];if(S.cid.code===code$6)I=new UnixFS({data:A});else{const j=decode$9(A);if(B=j.Links,j.Data==null)throw new InvalidPBNodeError(`${S.cid.toString()} had no data`);I=UnixFS.unmarshal(j.Data)}I.mtime=C;const O=encode$9({Data:I.marshal(),Links:B}),N=await sha256$6.digest(O),U=CID.create(S.cid.version,code$2,N);return await r.put(U,O),updatePathCids(U,S,r,E)}class DefaultUnixFS{components;constructor(r){this.components=r}async*addAll(r,_={}){yield*addAll(r,this.components.blockstore,_)}async addBytes(r,_={}){return addBytes(r,this.components.blockstore,_)}async addByteStream(r,_={}){return addByteStream(r,this.components.blockstore,_)}async addFile(r,_={}){return addFile(r,this.components.blockstore,_)}async addDirectory(r={},_={}){return addDirectory(r,this.components.blockstore,_)}async*cat(r,_={}){yield*cat(r,this.components.blockstore,_)}async chmod(r,_,E={}){return chmod(r,_,this.components.blockstore,E)}async cp(r,_,E,S={}){return cp(r,_,E,this.components.blockstore,S)}async*ls(r,_={}){yield*ls(r,this.components.blockstore,_)}async mkdir(r,_,E={}){return mkdir(r,_,this.components.blockstore,E)}async rm(r,_,E={}){return rm(r,_,this.components.blockstore,E)}async stat(r,_={}){return stat(r,this.components.blockstore,_)}async touch(r,_={}){return touch(r,this.components.blockstore,_)}}function unixfs(n){return new DefaultUnixFS(n)}var lib={},indexedDbReadStream={},__extends$1=commonjsGlobal&&commonjsGlobal.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,_){r.__proto__=_}||function(r,_){for(var E in _)_.hasOwnProperty(E)&&(r[E]=_[E])};return function(r,_){n(r,_);function E(){this.constructor=r}r.prototype=_===null?Object.create(_):(E.prototype=_.prototype,new E)}}();Object.defineProperty(indexedDbReadStream,"__esModule",{value:!0});var stream_1$1=require$$0$1,IndexedDbReadStream=function(n){__extends$1(r,n);function r(_){var E=n.call(this,{objectMode:!0})||this,S=indexedDB.open(_.databaseName,_.databaseVersion);return S.addEventListener("success",function(C){var A;try{var I=C.target.result.transaction([_.objectStoreName]).objectStore(_.objectStoreName);_.indexName&&(I=I.index(_.indexName)),A=I.openCursor(_.range,_.cursorDirection)}catch(B){return E.emit("error",B)}A.addEventListener("success",function(B){if(B.target.result)return E.push(B.target.result.value),B.target.result.continue();E.push(null)}),A.addEventListener("error",function(B){E.emit("error",B.target.result)})}),S.addEventListener("error",function(C){E.emit("error",C.target.result)}),E}return r.prototype._read=function(){},r}(stream_1$1.Readable);indexedDbReadStream.IndexedDbReadStream=IndexedDbReadStream;var indexedDbWriteStream={},__extends=commonjsGlobal&&commonjsGlobal.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,_){r.__proto__=_}||function(r,_){for(var E in _)_.hasOwnProperty(E)&&(r[E]=_[E])};return function(r,_){n(r,_);function E(){this.constructor=r}r.prototype=_===null?Object.create(_):(E.prototype=_.prototype,new E)}}();Object.defineProperty(indexedDbWriteStream,"__esModule",{value:!0});var stream_1=require$$0$1,IndexedDbWriteStream=function(n){__extends(r,n);function r(_){var E=n.call(this,{objectMode:!0})||this;return E.options=_,E}return r.prototype._write=function(_,E,S){var C=this,A=indexedDB.open(this.options.databaseName,this.options.databaseVersion);A.addEventListener("success",function(I){var B;try{B=I.target.result.transaction([C.options.objectStoreName],"readwrite").objectStore(C.options.objectStoreName).add(_)}catch(O){C.emit("error",O);return}B.addEventListener("success",function(){S()}),B.addEventListener("error",function(O){C.emit("error",O.target.error)})}),A.addEventListener("error",function(I){C.emit("error",I.target.error)})},r}(stream_1.Writable);indexedDbWriteStream.IndexedDbWriteStream=IndexedDbWriteStream;(function(n){function r(_){for(var E in _)n.hasOwnProperty(E)||(n[E]=_[E])}Object.defineProperty(n,"__esModule",{value:!0}),r(indexedDbReadStream),r(indexedDbWriteStream)})(lib);const indexedDbStream=getDefaultExportFromCjs(lib);var md5$1={exports:{}},core={exports:{}},hasRequiredCore;function requireCore(){return hasRequiredCore||(hasRequiredCore=1,function(n,r){(function(_,E){n.exports=E()})(commonjsGlobal,function(){var _=_||function(E,S){var C;if(typeof window<"u"&&window.crypto&&(C=window.crypto),typeof self<"u"&&self.crypto&&(C=self.crypto),typeof globalThis<"u"&&globalThis.crypto&&(C=globalThis.crypto),!C&&typeof window<"u"&&window.msCrypto&&(C=window.msCrypto),!C&&typeof commonjsGlobal<"u"&&commonjsGlobal.crypto&&(C=commonjsGlobal.crypto),!C&&typeof commonjsRequire=="function")try{C=requireCryptoBrowserify()}catch{}var A=function(){if(C){if(typeof C.getRandomValues=="function")try{return C.getRandomValues(new Uint32Array(1))[0]}catch{}if(typeof C.randomBytes=="function")try{return C.randomBytes(4).readInt32LE()}catch{}}throw new Error("Native crypto module could not be used to get secure random number.")},I=Object.create||function(){function oe(){}return function(ue){var we;return oe.prototype=ue,we=new oe,oe.prototype=null,we}}(),B={},O=B.lib={},N=O.Base=function(){return{extend:function(oe){var ue=I(this);return oe&&ue.mixIn(oe),(!ue.hasOwnProperty("init")||this.init===ue.init)&&(ue.init=function(){ue.$super.init.apply(this,arguments)}),ue.init.prototype=ue,ue.$super=this,ue},create:function(){var oe=this.extend();return oe.init.apply(oe,arguments),oe},init:function(){},mixIn:function(oe){for(var ue in oe)oe.hasOwnProperty(ue)&&(this[ue]=oe[ue]);oe.hasOwnProperty("toString")&&(this.toString=oe.toString)},clone:function(){return this.init.prototype.extend(this)}}}(),U=O.WordArray=N.extend({init:function(oe,ue){oe=this.words=oe||[],ue!=S?this.sigBytes=ue:this.sigBytes=oe.length*4},toString:function(oe){return(oe||z).stringify(this)},concat:function(oe){var ue=this.words,we=oe.words,Te=this.sigBytes,xe=oe.sigBytes;if(this.clamp(),Te%4)for(var Re=0;Re<xe;Re++){var Ne=we[Re>>>2]>>>24-Re%4*8&255;ue[Te+Re>>>2]|=Ne<<24-(Te+Re)%4*8}else for(var Fe=0;Fe<xe;Fe+=4)ue[Te+Fe>>>2]=we[Fe>>>2];return this.sigBytes+=xe,this},clamp:function(){var oe=this.words,ue=this.sigBytes;oe[ue>>>2]&=4294967295<<32-ue%4*8,oe.length=E.ceil(ue/4)},clone:function(){var oe=N.clone.call(this);return oe.words=this.words.slice(0),oe},random:function(oe){for(var ue=[],we=0;we<oe;we+=4)ue.push(A());return new U.init(ue,oe)}}),j=B.enc={},z=j.Hex={stringify:function(oe){for(var ue=oe.words,we=oe.sigBytes,Te=[],xe=0;xe<we;xe++){var Re=ue[xe>>>2]>>>24-xe%4*8&255;Te.push((Re>>>4).toString(16)),Te.push((Re&15).toString(16))}return Te.join("")},parse:function(oe){for(var ue=oe.length,we=[],Te=0;Te<ue;Te+=2)we[Te>>>3]|=parseInt(oe.substr(Te,2),16)<<24-Te%8*4;return new U.init(we,ue/2)}},Z=j.Latin1={stringify:function(oe){for(var ue=oe.words,we=oe.sigBytes,Te=[],xe=0;xe<we;xe++){var Re=ue[xe>>>2]>>>24-xe%4*8&255;Te.push(String.fromCharCode(Re))}return Te.join("")},parse:function(oe){for(var ue=oe.length,we=[],Te=0;Te<ue;Te++)we[Te>>>2]|=(oe.charCodeAt(Te)&255)<<24-Te%4*8;return new U.init(we,ue)}},X=j.Utf8={stringify:function(oe){try{return decodeURIComponent(escape(Z.stringify(oe)))}catch{throw new Error("Malformed UTF-8 data")}},parse:function(oe){return Z.parse(unescape(encodeURIComponent(oe)))}},Q=O.BufferedBlockAlgorithm=N.extend({reset:function(){this._data=new U.init,this._nDataBytes=0},_append:function(oe){typeof oe=="string"&&(oe=X.parse(oe)),this._data.concat(oe),this._nDataBytes+=oe.sigBytes},_process:function(oe){var ue,we=this._data,Te=we.words,xe=we.sigBytes,Re=this.blockSize,Ne=Re*4,Fe=xe/Ne;oe?Fe=E.ceil(Fe):Fe=E.max((Fe|0)-this._minBufferSize,0);var ht=Fe*Re,nt=E.min(ht*4,xe);if(ht){for(var Ee=0;Ee<ht;Ee+=Re)this._doProcessBlock(Te,Ee);ue=Te.splice(0,ht),we.sigBytes-=nt}return new U.init(ue,nt)},clone:function(){var oe=N.clone.call(this);return oe._data=this._data.clone(),oe},_minBufferSize:0});O.Hasher=Q.extend({cfg:N.extend(),init:function(oe){this.cfg=this.cfg.extend(oe),this.reset()},reset:function(){Q.reset.call(this),this._doReset()},update:function(oe){return this._append(oe),this._process(),this},finalize:function(oe){oe&&this._append(oe);var ue=this._doFinalize();return ue},blockSize:16,_createHelper:function(oe){return function(ue,we){return new oe.init(we).finalize(ue)}},_createHmacHelper:function(oe){return function(ue,we){return new se.HMAC.init(oe,we).finalize(ue)}}});var se=B.algo={};return B}(Math);return _})}(core)),core.exports}(function(n,r){(function(_,E){n.exports=E(requireCore())})(commonjsGlobal,function(_){return function(E){var S=_,C=S.lib,A=C.WordArray,I=C.Hasher,B=S.algo,O=[];(function(){for(var X=0;X<64;X++)O[X]=E.abs(E.sin(X+1))*4294967296|0})();var N=B.MD5=I.extend({_doReset:function(){this._hash=new A.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(X,Q){for(var se=0;se<16;se++){var oe=Q+se,ue=X[oe];X[oe]=(ue<<8|ue>>>24)&16711935|(ue<<24|ue>>>8)&4278255360}var we=this._hash.words,Te=X[Q+0],xe=X[Q+1],Re=X[Q+2],Ne=X[Q+3],Fe=X[Q+4],ht=X[Q+5],nt=X[Q+6],Ee=X[Q+7],Ce=X[Q+8],_e=X[Q+9],Ie=X[Q+10],He=X[Q+11],Be=X[Q+12],Ge=X[Q+13],je=X[Q+14],Ve=X[Q+15],Pe=we[0],Me=we[1],tt=we[2],Ke=we[3];Pe=U(Pe,Me,tt,Ke,Te,7,O[0]),Ke=U(Ke,Pe,Me,tt,xe,12,O[1]),tt=U(tt,Ke,Pe,Me,Re,17,O[2]),Me=U(Me,tt,Ke,Pe,Ne,22,O[3]),Pe=U(Pe,Me,tt,Ke,Fe,7,O[4]),Ke=U(Ke,Pe,Me,tt,ht,12,O[5]),tt=U(tt,Ke,Pe,Me,nt,17,O[6]),Me=U(Me,tt,Ke,Pe,Ee,22,O[7]),Pe=U(Pe,Me,tt,Ke,Ce,7,O[8]),Ke=U(Ke,Pe,Me,tt,_e,12,O[9]),tt=U(tt,Ke,Pe,Me,Ie,17,O[10]),Me=U(Me,tt,Ke,Pe,He,22,O[11]),Pe=U(Pe,Me,tt,Ke,Be,7,O[12]),Ke=U(Ke,Pe,Me,tt,Ge,12,O[13]),tt=U(tt,Ke,Pe,Me,je,17,O[14]),Me=U(Me,tt,Ke,Pe,Ve,22,O[15]),Pe=j(Pe,Me,tt,Ke,xe,5,O[16]),Ke=j(Ke,Pe,Me,tt,nt,9,O[17]),tt=j(tt,Ke,Pe,Me,He,14,O[18]),Me=j(Me,tt,Ke,Pe,Te,20,O[19]),Pe=j(Pe,Me,tt,Ke,ht,5,O[20]),Ke=j(Ke,Pe,Me,tt,Ie,9,O[21]),tt=j(tt,Ke,Pe,Me,Ve,14,O[22]),Me=j(Me,tt,Ke,Pe,Fe,20,O[23]),Pe=j(Pe,Me,tt,Ke,_e,5,O[24]),Ke=j(Ke,Pe,Me,tt,je,9,O[25]),tt=j(tt,Ke,Pe,Me,Ne,14,O[26]),Me=j(Me,tt,Ke,Pe,Ce,20,O[27]),Pe=j(Pe,Me,tt,Ke,Ge,5,O[28]),Ke=j(Ke,Pe,Me,tt,Re,9,O[29]),tt=j(tt,Ke,Pe,Me,Ee,14,O[30]),Me=j(Me,tt,Ke,Pe,Be,20,O[31]),Pe=z(Pe,Me,tt,Ke,ht,4,O[32]),Ke=z(Ke,Pe,Me,tt,Ce,11,O[33]),tt=z(tt,Ke,Pe,Me,He,16,O[34]),Me=z(Me,tt,Ke,Pe,je,23,O[35]),Pe=z(Pe,Me,tt,Ke,xe,4,O[36]),Ke=z(Ke,Pe,Me,tt,Fe,11,O[37]),tt=z(tt,Ke,Pe,Me,Ee,16,O[38]),Me=z(Me,tt,Ke,Pe,Ie,23,O[39]),Pe=z(Pe,Me,tt,Ke,Ge,4,O[40]),Ke=z(Ke,Pe,Me,tt,Te,11,O[41]),tt=z(tt,Ke,Pe,Me,Ne,16,O[42]),Me=z(Me,tt,Ke,Pe,nt,23,O[43]),Pe=z(Pe,Me,tt,Ke,_e,4,O[44]),Ke=z(Ke,Pe,Me,tt,Be,11,O[45]),tt=z(tt,Ke,Pe,Me,Ve,16,O[46]),Me=z(Me,tt,Ke,Pe,Re,23,O[47]),Pe=Z(Pe,Me,tt,Ke,Te,6,O[48]),Ke=Z(Ke,Pe,Me,tt,Ee,10,O[49]),tt=Z(tt,Ke,Pe,Me,je,15,O[50]),Me=Z(Me,tt,Ke,Pe,ht,21,O[51]),Pe=Z(Pe,Me,tt,Ke,Be,6,O[52]),Ke=Z(Ke,Pe,Me,tt,Ne,10,O[53]),tt=Z(tt,Ke,Pe,Me,Ie,15,O[54]),Me=Z(Me,tt,Ke,Pe,xe,21,O[55]),Pe=Z(Pe,Me,tt,Ke,Ce,6,O[56]),Ke=Z(Ke,Pe,Me,tt,Ve,10,O[57]),tt=Z(tt,Ke,Pe,Me,nt,15,O[58]),Me=Z(Me,tt,Ke,Pe,Ge,21,O[59]),Pe=Z(Pe,Me,tt,Ke,Fe,6,O[60]),Ke=Z(Ke,Pe,Me,tt,He,10,O[61]),tt=Z(tt,Ke,Pe,Me,Re,15,O[62]),Me=Z(Me,tt,Ke,Pe,_e,21,O[63]),we[0]=we[0]+Pe|0,we[1]=we[1]+Me|0,we[2]=we[2]+tt|0,we[3]=we[3]+Ke|0},_doFinalize:function(){var X=this._data,Q=X.words,se=this._nDataBytes*8,oe=X.sigBytes*8;Q[oe>>>5]|=128<<24-oe%32;var ue=E.floor(se/4294967296),we=se;Q[(oe+64>>>9<<4)+15]=(ue<<8|ue>>>24)&16711935|(ue<<24|ue>>>8)&4278255360,Q[(oe+64>>>9<<4)+14]=(we<<8|we>>>24)&16711935|(we<<24|we>>>8)&4278255360,X.sigBytes=(Q.length+1)*4,this._process();for(var Te=this._hash,xe=Te.words,Re=0;Re<4;Re++){var Ne=xe[Re];xe[Re]=(Ne<<8|Ne>>>24)&16711935|(Ne<<24|Ne>>>8)&4278255360}return Te},clone:function(){var X=I.clone.call(this);return X._hash=this._hash.clone(),X}});function U(X,Q,se,oe,ue,we,Te){var xe=X+(Q&se|~Q&oe)+ue+Te;return(xe<<we|xe>>>32-we)+Q}function j(X,Q,se,oe,ue,we,Te){var xe=X+(Q&oe|se&~oe)+ue+Te;return(xe<<we|xe>>>32-we)+Q}function z(X,Q,se,oe,ue,we,Te){var xe=X+(Q^se^oe)+ue+Te;return(xe<<we|xe>>>32-we)+Q}function Z(X,Q,se,oe,ue,we,Te){var xe=X+(se^(Q|~oe))+ue+Te;return(xe<<we|xe>>>32-we)+Q}S.MD5=I._createHelper(N),S.HmacMD5=I._createHmacHelper(N)}(Math),_.MD5})})(md5$1);var md5Exports=md5$1.exports;const md5=getDefaultExportFromCjs(md5Exports);var encBase64={exports:{}};(function(n,r){(function(_,E){n.exports=E(requireCore())})(commonjsGlobal,function(_){return function(){var E=_,S=E.lib,C=S.WordArray,A=E.enc;A.Base64={stringify:function(B){var O=B.words,N=B.sigBytes,U=this._map;B.clamp();for(var j=[],z=0;z<N;z+=3)for(var Z=O[z>>>2]>>>24-z%4*8&255,X=O[z+1>>>2]>>>24-(z+1)%4*8&255,Q=O[z+2>>>2]>>>24-(z+2)%4*8&255,se=Z<<16|X<<8|Q,oe=0;oe<4&&z+oe*.75<N;oe++)j.push(U.charAt(se>>>6*(3-oe)&63));var ue=U.charAt(64);if(ue)for(;j.length%4;)j.push(ue);return j.join("")},parse:function(B){var O=B.length,N=this._map,U=this._reverseMap;if(!U){U=this._reverseMap=[];for(var j=0;j<N.length;j++)U[N.charCodeAt(j)]=j}var z=N.charAt(64);if(z){var Z=B.indexOf(z);Z!==-1&&(O=Z)}return I(B,O,U)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="};function I(B,O,N){for(var U=[],j=0,z=0;z<O;z++)if(z%4){var Z=N[B.charCodeAt(z-1)]<<z%4*2,X=N[B.charCodeAt(z)]>>>6-z%4*2,Q=Z|X;U[j>>>2]|=Q<<24-j%4*8,j++}return C.create(U,j)}}(),_.enc.Base64})})(encBase64);var encBase64Exports=encBase64.exports;const Base64=getDefaultExportFromCjs(encBase64Exports);class CacheSuivi{verrou;_cacheSuivi;_cacheRecherche;constructor(){this.verrou=new s$1,this._cacheSuivi={},this._cacheRecherche={}}async suivre({adresseFonction:r,idClient:_,fOriginale:E,args:S,ceciOriginal:C}){const A=Object.entries(S).find(j=>typeof j[1]=="function")?.[0];if(!A)throw new Error("Aucun argument n'est une fonction.");const I=S[A],B=Object.fromEntries(Object.entries(S).filter(j=>typeof j[1]!="function"));if(Object.keys(S).length!==Object.keys(B).length+1)throw new Error("Plus d'un argument pour "+r+" est une fonction : "+JSON.stringify(S));const O=this.gnrerCodeCache({adresseFonction:r,idClient:_,argsClefs:B}),N=v4();if(await this.verrou.acquire(O),this._cacheSuivi[O])this.verrou.release(O),this._cacheSuivi[O].requtes[N]=I,Object.keys(this._cacheSuivi[O]).includes("val")&&await I(this._cacheSuivi[O].val);else{this._cacheSuivi[O]={requtes:{[N]:I}};const j=async X=>{if(!this._cacheSuivi[O]||Object.keys(this._cacheSuivi[O]).includes("val")&&deepEqual$1(this._cacheSuivi[O].val,X,{strict:!0}))return;this._cacheSuivi[O].val=X;const Q=Object.values(this._cacheSuivi[O].requtes);await Promise.all(Q.map(se=>se(X)))},z={...B,[A]:j},Z=await E.apply(C,[z]);this._cacheSuivi[O].fOublier=Z,this.verrou.release(O)}return async()=>{await this.oublierSuivi({codeCache:O,idRequte:N})}}async suivreRecherche({adresseFonction:r,nomArgTaille:_,idClient:E,fOriginale:S,args:C,ceciOriginal:A,par:I}){const B=Object.entries(C).find(oe=>typeof oe[1]=="function")?.[0];if(!B)throw new Error("Aucun argument n'est une fonction.");const O=C[B],N=Object.fromEntries(Object.entries(C).filter(oe=>typeof oe[1]!="function"));if(Object.keys(C).length!==Object.keys(N).length+1)throw new Error("Plus d'un argument pour "+r+" est une fonction : "+JSON.stringify(C));const U=Object.fromEntries(Object.entries(C).filter(oe=>oe[0]!==_));let j=C[_];if(j===void 0&&(j=1/0),typeof j!="number")throw new Error(`Argument ${_} n'est pas un nombre dans la fonction ${r}.`);const z=this.gnrerCodeCache({adresseFonction:r,idClient:E,argsClefs:U}),Z=v4();await this.verrou.acquire(z);const X=oe=>{if(!this._cacheRecherche[z])return;this._cacheRecherche[z].val=oe;const ue=Object.values(this._cacheRecherche[z].requtes);I==="profondeur"?ue.forEach(we=>we.f(oe.filter(Te=>Te.profondeur<=we.taille))):ue.forEach(we=>we.f(oe.slice(0,we.taille)))};if(this._cacheRecherche[z]){if(this._cacheRecherche[z].requtes[Z]={f:O,taille:j},Object.keys(this._cacheRecherche[z]).includes("val")){const{val:oe}=this._cacheRecherche[z];oe&&X(oe)}}else{this._cacheRecherche[z]={requtes:{[Z]:{f:O,taille:j}},taillePrsente:j};const oe={...U,[B]:X,[_]:j};if(I==="profondeur"){const{fOublier:ue,fChangerProfondeur:we}=await S.apply(A,[oe]);this._cacheRecherche[z].fs={fOublier:ue,fChangerTaille:we}}else{const{fOublier:ue,fChangerN:we}=await S.apply(A,[oe]);this._cacheRecherche[z].fs={fOublier:ue,fChangerTaille:we}}}const Q=async()=>{await this.oublierRecherche({codeCache:z,idRequte:Z})},se=oe=>{const ue=this._cacheRecherche[z].requtes[Z].taille;if(oe===ue)return;this._cacheRecherche[z].requtes[Z].taille=oe;const{val:we}=this._cacheRecherche[z];we&&X(we);const Te=Math.max(...Object.values(this._cacheRecherche[z].requtes).map(Ne=>Ne.taille)),{taillePrsente:xe}=this._cacheRecherche[z],{fChangerTaille:Re}=this._cacheRecherche[z].fs;Te!==xe&&(this._cacheRecherche[z].taillePrsente=Te,Re(Te))};return this.verrou.release(z),{fOublier:Q,[I==="profondeur"?"fChangerProfondeur":"fChangerN"]:se}}async oublierSuivi({codeCache:r,idRequte:_}){if(await this.verrou.acquire(r),this._cacheSuivi[r]===void 0)return;const{requtes:E,fOublier:S}=this._cacheSuivi[r];delete E[_],Object.keys(E).length||(S&&await S(),delete this._cacheSuivi[r]),this.verrou.release(r)}async oublierRecherche({codeCache:r,idRequte:_}){if(await this.verrou.acquire(r),this._cacheRecherche[r]===void 0)return;const{requtes:E,fs:S}=this._cacheRecherche[r];delete E[_],Object.keys(E).length||(S&&await S.fOublier(),delete this._cacheRecherche[r]),this.verrou.release(r)}gnrerCodeCache({adresseFonction:r,idClient:_,argsClefs:E}){const S=r+"-"+_+"-"+JSON.stringify(E);return Base64.stringify(md5(S))}}const cacheSuivi=(n,r,_)=>envelopper({nom:r,descripteur:_}),cacheRechercheParNRsultats=(n,r,_)=>envelopper({nom:r,descripteur:_,recherche:"nRsultats"}),cacheRechercheParProfondeur=(n,r,_)=>envelopper({nom:r,descripteur:_,recherche:"profondeur"}),envelopper=({nom:n,descripteur:r,recherche:_,nomArgTaille:E})=>{const S=r.value;if(typeof S=="function")r.value=function(...C){if(C.length>1)throw new Error("Args trop longs");const A=this.client?this.client:this;try{return _?(E=E||(_==="profondeur"?"profondeur":"nRsultatsDsirs"),cache$1.suivreRecherche({adresseFonction:this.constructor.name+"."+n,idClient:A.idCompte,fOriginale:S,args:C[0],ceciOriginal:this,par:_,nomArgTaille:E})):cache$1.suivre({adresseFonction:this.constructor.name+"."+n,idClient:A.idCompte,fOriginale:S,args:C[0],ceciOriginal:this})}catch(I){throw console.error(`Erreur: ${I}`),I}};else throw new Error("L'objet dcor n'est pas une fonction");return r},cache$1=new CacheSuivi;var conditions;(function(n){n.ATTR="attribution",n.GAL="partagegal",n.INCL="inclureDroitDauteur",n.CHNG="indiquerChangements",n.SRCE="partagerCodeSource",n.USGR="usagereseau"})(conditions||(conditions={}));var droits;(function(n){n.PRTG="partager",n.ADPT="adapter",n.CMRC="usageComercial",n.PRV="usagePriv",n.BREV="usageBrevets"})(droits||(droits={}));var limitations;(function(n){n.RSP="aucuneResponsabilit",n.GRNT="aucuneGarantie",n.MRCM="marqueCommerce",n.BREV="brevetExclu",n.SOUS="sousLicence"})(limitations||(limitations={}));var catgories;(function(n){n.BD="basesDeDonnes",n.ART="artistique",n.CODE="codeInformatique",n.AUTRE="autre"})(catgories||(catgories={}));const infoLicences={"ODbl-1_0":{droits:[droits.CMRC,droits.PRTG,droits.PRV,droits.ADPT],conditions:[conditions.ATTR,conditions.GAL,conditions.INCL],limitations:[limitations.RSP,limitations.BREV,limitations.MRCM,limitations.GRNT],catgorie:catgories.BD},"ODC-BY-1_0":{droits:[droits.CMRC,droits.PRTG,droits.PRV,droits.ADPT],conditions:[conditions.ATTR,conditions.INCL],limitations:[limitations.RSP,limitations.GRNT,limitations.MRCM,limitations.BREV],catgorie:catgories.BD},PDDL:{droits:[droits.CMRC,droits.PRTG,droits.ADPT,droits.PRV],conditions:[],limitations:[limitations.RSP,limitations.GRNT,limitations.MRCM,limitations.BREV],catgorie:catgories.BD},"rvca-open":{droits:[droits.PRV,droits.CMRC,droits.ADPT,droits.PRTG],conditions:[conditions.INCL,conditions.ATTR],limitations:[limitations.SOUS,limitations.RSP],catgorie:catgories.BD,spcialise:!0},"CC-BY-SA-4_0":{droits:[droits.PRTG,droits.ADPT,droits.CMRC,droits.PRV],conditions:[conditions.INCL,conditions.CHNG,conditions.GAL],limitations:[limitations.RSP,limitations.MRCM,limitations.BREV,limitations.GRNT],catgorie:catgories.ART},"CC-BY-4_0":{droits:[droits.CMRC,droits.PRTG,droits.ADPT,droits.PRV],conditions:[conditions.ATTR,conditions.CHNG],limitations:[limitations.RSP,limitations.MRCM,limitations.BREV,limitations.GRNT],catgorie:catgories.ART},"CC-0-1_0":{droits:[droits.PRTG,droits.ADPT,droits.CMRC,droits.PRV],conditions:[],limitations:[limitations.RSP,limitations.MRCM,limitations.BREV,limitations.GRNT],catgorie:catgories.ART},"0bsd":{droits:[droits.CMRC,droits.PRTG,droits.ADPT,droits.PRV],conditions:[],limitations:[],catgorie:catgories.CODE},"afl-3_0":{droits:[droits.CMRC,droits.PRTG,droits.ADPT,droits.PRV,droits.BREV],conditions:[conditions.INCL,conditions.CHNG],limitations:[limitations.MRCM,limitations.RSP,limitations.GRNT],catgorie:catgories.CODE},"agpl-3_0":{droits:[droits.CMRC,droits.ADPT,droits.PRTG,droits.BREV,droits.PRV],conditions:[conditions.INCL,conditions.CHNG,conditions.SRCE,conditions.USGR,conditions.GAL],limitations:[limitations.RSP,limitations.GRNT],catgorie:catgories.CODE},"apache-2_0":{droits:[droits.CMRC,droits.ADPT,droits.PRTG,droits.BREV,droits.PRV],conditions:[conditions.INCL,conditions.CHNG],limitations:[limitations.MRCM,limitations.RSP,limitations.GRNT],catgorie:catgories.CODE},"artistic-2_0":{droits:[droits.CMRC,droits.ADPT,droits.PRTG,droits.BREV,droits.PRV],conditions:[conditions.INCL,conditions.CHNG],limitations:[limitations.RSP,limitations.MRCM,limitations.GRNT],catgorie:catgories.CODE},"bsd-2-clause":{droits:[droits.CMRC,droits.ADPT,droits.PRTG,droits.PRV],conditions:[conditions.INCL],limitations:[limitations.RSP,limitations.GRNT],catgorie:catgories.CODE},"bsd-3-clause-clear":{droits:[droits.CMRC,droits.ADPT,droits.PRTG,droits.PRV],conditions:[conditions.INCL],limitations:[limitations.RSP,limitations.BREV,limitations.GRNT],catgorie:catgories.CODE},"bsd-3-clause":{droits:[droits.CMRC,droits.ADPT,droits.PRTG,droits.PRV],conditions:[conditions.INCL],limitations:[limitations.RSP,limitations.GRNT],catgorie:catgories.CODE},"bsd-4-clause":{droits:[droits.CMRC,droits.ADPT,droits.PRTG,droits.PRV],conditions:[conditions.INCL],limitations:[limitations.RSP,limitations.GRNT],catgorie:catgories.CODE},"bsl-1_0":{droits:[droits.CMRC,droits.ADPT,droits.PRTG,droits.PRV],conditions:[conditions.INCL],limitations:[limitations.RSP,limitations.GRNT],catgorie:catgories.CODE},"cecill-2_1":{droits:[droits.CMRC,droits.ADPT,droits.PRTG,droits.PRV,droits.BREV],conditions:[conditions.INCL,conditions.SRCE,conditions.GAL],limitations:[limitations.RSP,limitations.GRNT],catgorie:catgories.CODE},"ecl-2_0":{droits:[droits.CMRC,droits.ADPT,droits.PRTG,droits.BREV,droits.PRV],conditions:[conditions.INCL,conditions.CHNG],limitations:[limitations.BREV,limitations.RSP,limitations.GRNT],catgorie:catgories.CODE},"epl-1_0":{droits:[droits.CMRC,droits.PRTG,droits.ADPT,droits.BREV,droits.PRV],conditions:[conditions.SRCE,conditions.INCL,conditions.GAL],limitations:[limitations.RSP,limitations.GRNT],catgorie:catgories.CODE},"epl-2_0":{droits:[droits.CMRC,droits.PRTG,droits.ADPT,droits.BREV,droits.PRV],conditions:[conditions.SRCE,conditions.INCL,conditions.GAL],limitations:[limitations.RSP,limitations.GRNT],catgorie:catgories.CODE},"eupl-1_0":{droits:[droits.CMRC,droits.ADPT,droits.PRTG,droits.BREV,droits.PRV],conditions:[conditions.INCL,conditions.SRCE,conditions.CHNG,conditions.USGR,conditions.GAL],limitations:[limitations.RSP,limitations.MRCM,limitations.GRNT],catgorie:catgories.CODE},"eupl-1_2":{droits:[droits.CMRC,droits.ADPT,droits.PRTG,droits.BREV,droits.PRV],conditions:[conditions.INCL,conditions.SRCE,conditions.CHNG,conditions.USGR,conditions.GAL],limitations:[limitations.RSP,limitations.MRCM,limitations.GRNT],catgorie:catgories.CODE},"gpl-2_0":{droits:[droits.CMRC,droits.ADPT,droits.PRTG,droits.PRV],conditions:[conditions.INCL,conditions.CHNG,conditions.SRCE,conditions.GAL],limitations:[limitations.RSP,limitations.GRNT],catgorie:catgories.CODE},"gpl-3_0":{droits:[droits.CMRC,droits.ADPT,droits.PRV,droits.BREV,droits.PRV],conditions:[conditions.INCL,conditions.CHNG,conditions.SRCE,conditions.GAL],limitations:[limitations.RSP,limitations.GRNT],catgorie:catgories.CODE},isc:{droits:[droits.CMRC,droits.PRTG,droits.ADPT,droits.PRV],conditions:[conditions.INCL],limitations:[limitations.RSP,limitations.GRNT],catgorie:catgories.CODE},"lgpl-2_1":{droits:[droits.CMRC,droits.ADPT,droits.PRTG,droits.PRV],conditions:[conditions.INCL,conditions.SRCE,conditions.CHNG,conditions.GAL],limitations:[limitations.RSP,limitations.GRNT],catgorie:catgories.CODE},"lgpl-3_0":{droits:[droits.CMRC,droits.ADPT,droits.PRTG,droits.BREV,droits.PRV],conditions:[conditions.INCL,conditions.SRCE,conditions.CHNG,conditions.GAL],limitations:[limitations.RSP,limitations.GRNT],catgorie:catgories.CODE},"lppl-1_3c":{droits:[droits.CMRC,droits.ADPT,droits.PRTG,droits.PRV],conditions:[conditions.INCL,conditions.CHNG,conditions.SRCE],limitations:[limitations.RSP,limitations.GRNT],catgorie:catgories.CODE},"mit-0":{droits:[droits.CMRC,droits.ADPT,droits.PRTG,droits.PRV],conditions:[],limitations:[limitations.RSP,limitations.GRNT],catgorie:catgories.CODE},mit:{droits:[droits.CMRC,droits.ADPT,droits.PRTG,droits.PRV],conditions:[conditions.INCL],limitations:[limitations.RSP,limitations.GRNT],catgorie:catgories.CODE},"mpl-2_0":{droits:[droits.CMRC,droits.ADPT,droits.PRTG,droits.BREV,droits.PRV],conditions:[conditions.SRCE,conditions.INCL,conditions.GAL],limitations:[limitations.RSP,limitations.MRCM,limitations.GRNT],catgorie:catgories.CODE},"ms-pl":{droits:[droits.CMRC,droits.ADPT,droits.PRTG,droits.BREV,droits.PRV],conditions:[conditions.INCL],limitations:[limitations.GRNT,limitations.MRCM],catgorie:catgories.CODE},"ms-rl":{droits:[droits.CMRC,droits.ADPT,droits.PRTG,droits.BREV,droits.PRV],conditions:[conditions.SRCE,conditions.INCL,conditions.GAL],limitations:[limitations.GRNT,limitations.MRCM],catgorie:catgories.CODE},"mulanpsl-2_0":{droits:[droits.CMRC,droits.ADPT,droits.PRTG,droits.BREV,droits.PRV],conditions:[conditions.INCL],limitations:[limitations.RSP,limitations.MRCM,limitations.GRNT],catgorie:catgories.CODE},ncsa:{droits:[droits.CMRC,droits.ADPT,droits.PRTG,droits.PRV],conditions:[conditions.INCL],limitations:[limitations.RSP,limitations.GRNT],catgorie:catgories.CODE},"osl-3_0":{droits:[droits.CMRC,droits.PRTG,droits.ADPT,droits.BREV,droits.PRV],conditions:[conditions.INCL,conditions.SRCE,conditions.CHNG,conditions.USGR,conditions.GAL],limitations:[limitations.MRCM,limitations.RSP,limitations.GRNT],catgorie:catgories.CODE},postgresql:{droits:[droits.CMRC,droits.ADPT,droits.PRTG,droits.PRV],conditions:[conditions.INCL],limitations:[limitations.RSP,limitations.GRNT],catgorie:catgories.CODE},unlicence:{droits:[droits.PRV,droits.CMRC,droits.ADPT,droits.PRTG],conditions:[],limitations:[limitations.RSP,limitations.GRNT],catgorie:catgories.CODE},"upl-1_0":{droits:[droits.CMRC,droits.ADPT,droits.PRTG,droits.BREV,droits.PRV],conditions:[conditions.INCL],limitations:[limitations.RSP,limitations.GRNT],catgorie:catgories.CODE},vim:{droits:[droits.CMRC,droits.ADPT,droits.PRTG,droits.PRV],conditions:[conditions.INCL,conditions.CHNG,conditions.SRCE,conditions.GAL],limitations:[],catgorie:catgories.CODE},wtfpl:{droits:[droits.CMRC,droits.ADPT,droits.PRTG,droits.PRV],conditions:[],limitations:[],catgorie:catgories.CODE},zlib:{droits:[droits.CMRC,droits.ADPT,droits.PRTG,droits.PRV],conditions:[conditions.INCL,conditions.CHNG],limitations:[limitations.RSP,limitations.GRNT],catgorie:catgories.CODE},"ofl-1_1":{droits:[droits.PRV,droits.CMRC,droits.ADPT,droits.PRTG],conditions:[conditions.INCL,conditions.GAL],limitations:[limitations.RSP,limitations.GRNT],catgorie:catgories.AUTRE}};class Licences{client;vnements;prt;perroquet;constructor({client:r}){this.client=r,this.prt=!1,this.vnements=new EventEmitter$3,this.initialiser()}async initialiser(){this.prt=!0,this.vnements.emit("prt")}async attendrePrt(){if(!this.prt)return new Promise(r=>{const _=()=>{r(),this.vnements.off("prt",_)};this.vnements.on("prt",_)})}async suivreLicences({f:r}){if(await r(infoLicences),await this.attendrePrt(),this.perroquet){const _=async E=>await r(Object.fromEntries(E.map(S=>[S.code,S])));return await this.perroquet._({:_,:""})}return faisRien}async suggrerLicence({code:r,infoLicence:_}){await this.attendrePrt(),this.perroquet&&await this.perroquet.({:{code:r,..._}})}async effacerSuggestionLicence({idlment:r}){await this.attendrePrt(),this.perroquet&&await this.perroquet._({:r})}async suivreSuggestionsLicences({f:r}){return await this.attendrePrt(),this.perroquet?await this.perroquet._({:r}):{fOublier:faisRien,fChangerProfondeur:faisRien}}async approuverLicence({suggestion:r}){await this.attendrePrt(),this.perroquet&&await this.perroquet.({:r})}}__decorate([cacheSuivi],Licences.prototype,"suivreLicences",null);const cidEtFichierValide=n=>{let r,_;try{[r,_]=n.split("/")}catch{return!1}return!_||!cidValide(r)?!1:{cid:r,fichier:_}};class pingles{client;requtes;fsOublier;vnements;constructor({client:r}){this.client=r,this.requtes=[],this.fsOublier={},this.vnements=new eventsExports.EventEmitter}async pinglerBd({id:r,rcursif:_=!1,fichiers:E=!0}){await this.directementpingle({id:r})||await this._pingler({id:r,rcursif:_,fichiers:E})}async dspinglerBd({id:r}){await Promise.all(this.requtes.filter(E=>E.id===r).map(async E=>await E.fOublier()));const _=this.requtes.filter(E=>E.parent===r);this.requtes=this.requtes.filter(E=>E.id!==r),this.requtes=this.requtes.filter(E=>E.parent!==r),await Promise.all(_.map(async E=>{this.requtes.filter(S=>S.id===E.id&&S.parent!==r).length||await this.dspinglerBd({id:E.id})})),this.vnements.emit("changement pingles")}async pingle({id:r}){return this.requtes.some(_=>_.id===r)}async pingleParParent({id:r,parent:_}){return this.requtes.some(E=>E.id===r&&E.parent===_)}async directementpingle({id:r}){return await this.pingleParParent({id:r})}async pingles(){return new Set(this.requtes.map(r=>r.id))}async suivrepingles({f:r}){const _=async()=>{const E=await this.pingles();return await r(E)};return this.vnements.on("changement pingles",_),async()=>{this.vnements.off("changement pingles",_)}}async _pingler({id:r,rcursif:_,fichiers:E,parent:S}){if(await this.pingleParParent({id:r,parent:S}))return;const{bd:C,fOublier:A}=await this.client.ouvrirBd({id:r});if(this.requtes.push({id:r,parent:S,fOublier:A}),this.vnements.emit("changement pingles"),_){const I=async B=>{let O=[];typeof B=="object"?(O=Object.values(B).filter(U=>typeof U=="string"),O.push(...Object.keys(B).filter(U=>typeof U=="string"))):Array.isArray(B)?O=B:typeof B=="string"&&(O=[B]);const N=O.filter(U=>isValidAddress(U));if(E){const U=O.filter(z=>cidEtFichierValide(z)&&!N.includes(z)),{sfip:j}=await this.client.attendreSfipEtOrbite();U.forEach(async z=>{for await(const X of j.pins.add(CID.parse(z.split("/")[0])));const Z=async()=>{try{await j.pins.rm(CID.parse(z))}catch{}};this.requtes.push({id:z,parent:r,fOublier:Z}),this.vnements.emit("changement pingles")})}await Promise.all(N.map(async U=>await this._pingler({id:U,rcursif:_,fichiers:E,parent:r})))};if(C.type==="keyvalue"){const B=await this.client.suivreBdDic({id:r,f:I});this.fsOublier[r]=B}else if(C.type==="ordered-keyvalue"){const B=await this.client.suivreBdDicOrdonne({id:r,f:I});this.fsOublier[r]=B}else if(C.type==="set"){const B=await this.client.suivreBdListe({id:r,f:I});this.fsOublier[r]=B}}}async toutDspingler(){const r=await this.pingles();await Promise.all([...r].map(async _=>{await this.dspinglerBd({id:_})}))}async fermer(){await Promise.all(Object.values(this.fsOublier).map(r=>r()))}}const schmaStructureBdNoms={type:"object",additionalProperties:{type:"string"},required:[]},schmaStructureBdMtadonnes={type:"object",additionalProperties:!0,required:[]};class ComposanteClient{client;clef;typeBd;constructor({client:r,clef:_,typeBd:E}){this.client=r,this.clef=_,this.typeBd=E}async obtIdBd(){const{idCompte:r}=await this.client.attendreInitialise(),_=await this.client.obtIdBd({nom:this.clef,racine:r,type:this.typeBd});if(!_)throw new Error("Mal initialis");return _}}class ComposanteClientDic extends ComposanteClient{schmaBdPrincipale;constructor({client:r,clef:_,schmaBdPrincipale:E}){super({client:r,clef:_,typeBd:"keyvalue"}),this.schmaBdPrincipale=E}async obtBd(){const r=await this.obtIdBd();return await this.client.ouvrirBdType({id:r,type:"keyvalue",schma:this.schmaBdPrincipale})}async suivreBdPrincipale({idCompte:r,f:_}){return await suivreBdDeFonction({fRacine:async({fSuivreRacine:E})=>await this.suivreIdBd({f:E,idCompte:r}),f:ignorerNonDfinis(_),fSuivre:async({id:E,fSuivreBd:S})=>await this.client.suivreBdDic({id:E,schma:this.schmaBdPrincipale,f:S})})}async suivreSousBdDic({idCompte:r,clef:_,schma:E,f:S}){return await suivreBdDeFonction({fRacine:async({fSuivreRacine:C})=>await this.suivreIdBd({f:C,idCompte:r}),f:ignorerNonDfinis(S),fSuivre:async({id:C,fSuivreBd:A})=>await this.client.suivreBdDicDeClef({id:C,clef:_,schma:E,f:A})})}async suivreSousBdListe({idCompte:r,clef:_,schma:E,f:S}){return await suivreBdDeFonction({fRacine:async({fSuivreRacine:C})=>await this.suivreIdBd({f:C,idCompte:r}),f:ignorerNonDfinis(S),fSuivre:async({id:C,fSuivreBd:A})=>await this.client.suivreBdListeDeClef({id:C,clef:_,f:A,schma:E,renvoyerValeur:!0})})}async suivreIdBd({f:r,idCompte:_}){return await suivreBdDeFonction({fRacine:async({fSuivreRacine:E})=>_?(await E(_),faisRien):await this.client.suivreIdCompte({f:E}),f:ignorerNonDfinis(r),fSuivre:async({id:E,fSuivreBd:S})=>await this.client.suivreBd({id:E,type:"keyvalue",f:async C=>{const A=await this.client.obtIdBd({nom:this.clef,racine:C,type:"keyvalue"});return await S(A)}})})}}__decorate([cacheSuivi],ComposanteClientDic.prototype,"suivreBdPrincipale",null);__decorate([cacheSuivi],ComposanteClientDic.prototype,"suivreSousBdDic",null);__decorate([cacheSuivi],ComposanteClientDic.prototype,"suivreSousBdListe",null);__decorate([cacheSuivi],ComposanteClientDic.prototype,"suivreIdBd",null);class ComposanteClientListe extends ComposanteClient{schmaBdPrincipale;constructor({client:r,clef:_,schmaBdPrincipale:E}){super({client:r,clef:_,typeBd:"set"}),this.schmaBdPrincipale=E}async obtBd(){const r=await this.obtIdBd();return await this.client.ouvrirBdType({id:r,type:"set",schma:this.schmaBdPrincipale})}async suivreBdPrincipale({idCompte:r,f:_}){return await suivreBdDeFonction({fRacine:async({fSuivreRacine:E})=>await this.suivreIdBd({f:E,idCompte:r}),f:ignorerNonDfinis(_),fSuivre:async({id:E,fSuivreBd:S})=>await this.client.suivreBdListe({id:E,f:S,schma:this.schmaBdPrincipale,renvoyerValeur:!0})})}async suivreIdBd({f:r,idCompte:_}){return await suivreBdDeFonction({fRacine:async({fSuivreRacine:E})=>_?(await E(_),faisRien):await this.client.suivreIdCompte({f:E}),f:ignorerNonDfinis(r),fSuivre:async({id:E,fSuivreBd:S})=>await this.client.suivreBd({id:E,type:"keyvalue",schma:schmaStructureBdCompte,f:async()=>{const C=await this.client.obtIdBd({nom:this.clef,racine:E,type:"set"});return await S(C)}})})}}__decorate([cacheSuivi],ComposanteClientListe.prototype,"suivreBdPrincipale",null);__decorate([cacheSuivi],ComposanteClientListe.prototype,"suivreIdBd",null);const MAX_TAILLE_IMAGE$3=500*1e3,MAX_TAILLE_IMAGE_VIS$3=1500*1e3,schmaStructureBdProfil={type:"object",properties:{initialis:{type:"boolean",nullable:!0},image:{type:"string",nullable:!0},contacts:{type:"string",nullable:!0},noms:{type:"string",nullable:!0}},required:[]},schmaContactProfil={type:"object",properties:{type:{type:"string"},contact:{type:"string"}},required:["contact","type"]};class Profil extends ComposanteClientDic{constructor({client:r}){super({client:r,clef:"profil",schmaBdPrincipale:schmaStructureBdProfil})}async pingler(){const r=await this.obtIdBd();await this.client.pingles.pinglerBd({id:r,rcursif:!0,fichiers:!0})}async initialiser(){const r=await this.obtIdBd(),{bd:_,fOublier:E}=await this.client.ouvrirBdType({id:r,type:"keyvalue",schma:schmaStructureBdProfil});await _.set("initialis",!0),await E()}async suivreInitialis({f:r,idCompte:_}){return await this.suivreBdPrincipale({idCompte:_,f:async E=>await r(!!E.initialis)})}async suivreCourriel({f:r,idCompte:_}){return await this.suivreContacts({idCompte:_,f:async E=>await r(E.find(S=>S.type=="courriel")?.contact||null)})}async sauvegarderCourriel({courriel:r}){await this.sauvegarderContact({type:"courriel",contact:r})}async effacerCourriel(){await this.effacerContact({type:"courriel"})}async suivreContacts({f:r,idCompte:_}){return await this.suivreSousBdListe({idCompte:_,clef:"contacts",schma:schmaContactProfil,f:r})}async sauvegarderContact({type:r,contact:_}){const E=await this.obtIdBd(),S=await this.client.obtIdBd({nom:"contacts",racine:E,type:"set"});if(!S)throw new Error(`Permission de modification refuse pour BD ${E}.`);const{bd:C,fOublier:A}=await this.client.ouvrirBdType({id:S,type:"set",schma:schmaContactProfil});await C.add({type:r,contact:_}),await A()}async effacerContact({type:r,contact:_}){const E=await this.obtIdBd(),S=await this.client.obtIdBd({nom:"contacts",racine:E,type:"set"});if(!S)throw new Error(`Permission de modification refuse pour BD ${E}.`);const{bd:C,fOublier:A}=await this.client.ouvrirBdType({id:S,type:"set",schma:schmaContactProfil}),B=(await C.all()).filter(O=>O.value.type===r&&(_===void 0||O.value.contact===_));await Promise.all(B.map(async O=>await C.del(O.value))),await A()}async suivreNoms({f:r,idCompte:_}){return await this.suivreSousBdDic({idCompte:_,clef:"noms",schma:schmaStructureBdNoms,f:r})}async sauvegarderNom({langue:r,nom:_}){return await this.sauvegarderNoms({noms:{[r]:_}})}async sauvegarderNoms({noms:r}){const _=await this.obtIdBd(),E=await this.client.obtIdBd({nom:"noms",racine:_,type:"keyvalue"});if(!E)throw new Error(`Permission de modification refuse pour BD ${_}.`);const{bd:S,fOublier:C}=await this.client.ouvrirBdType({id:E,type:"keyvalue",schma:schmaStructureBdNoms});for(const[A,I]of Object.entries(r))await S.set(A,I);await C()}async effacerNom({langue:r}){const _=await this.obtIdBd(),E=await this.client.obtIdBd({nom:"noms",racine:_,type:"keyvalue"});if(!E)throw new Error(`Permission de modification refuse pour BD ${_}.`);const{bd:S,fOublier:C}=await this.client.ouvrirBdType({id:E,type:"keyvalue",schma:schmaStructureBdNoms});await S.del(r),await C()}async sauvegarderImage({image:r}){if(r.contenu.byteLength>MAX_TAILLE_IMAGE$3)throw new Error("Taille maximale excde");const _=await this.client.ajouterSFIP(r),{bd:E,fOublier:S}=await this.obtBd();await E.set("image",_),await S()}async effacerImage(){const{bd:r,fOublier:_}=await this.obtBd();await r.del("image"),await _()}async suivreImage({f:r,idCompte:_}){return await suivreBdDeFonction({fRacine:async({fSuivreRacine:E})=>await this.suivreIdBd({f:E,idCompte:_}),f:ignorerNonDfinis(r),fSuivre:async({id:E,fSuivreBd:S})=>await this.client.suivreBd({id:E,type:"keyvalue",schma:schmaStructureBdProfil,f:async C=>{const A=await C.get("image");if(A){const I=await this.client.obtFichierSFIP({id:A,max:MAX_TAILLE_IMAGE_VIS$3});return await S(I)}else return await S(null)}})})}}__decorate([cacheSuivi],Profil.prototype,"suivreCourriel",null);__decorate([cacheSuivi],Profil.prototype,"suivreContacts",null);__decorate([cacheSuivi],Profil.prototype,"suivreNoms",null);__decorate([cacheSuivi],Profil.prototype,"suivreImage",null);function isAsyncIterable$6(n){return n[Symbol.asyncIterator]!=null}function toBuffer(n){if(isAsyncIterable$6(n))return(async()=>{let E=new Uint8Array(0);for await(const S of n)E=concat$4([E,S],E.length+S.length);return E})();const r=[];let _=0;for(const E of n)r.push(E),_+=E.byteLength;return concat$4(r,_)}const schmaStructureBdBd={type:"object",properties:{type:{type:"string"},mtadonnes:{type:"string",nullable:!0},licence:{type:"string"},licenceContenu:{type:"string",nullable:!0},image:{type:"string",nullable:!0},noms:{type:"string"},descriptions:{type:"string"},tableaux:{type:"string"},motsClefs:{type:"string"},nues:{type:"string"},statut:{type:"object",properties:{statut:{type:"string"},idNouvelle:{type:"string",nullable:!0}},required:["statut"]},copiDe:{type:"object",properties:{id:{type:"string"}},required:["id"]}},required:["type","licence","noms","descriptions","tableaux","motsClefs","nues","statut","copiDe"]},schmaInfoTableau={type:"object",properties:{clef:{type:"string"}},required:["clef"]},schmaBdTableauxDeBd={type:"object",additionalProperties:schmaInfoTableau,required:[]},schmaBdPrincipale$4={type:"string"},schmaStructureBdMotsClefs={type:"string"},schmaStructureBdNues={type:"string"},MAX_TAILLE_IMAGE$2=500*1e3,MAX_TAILLE_IMAGE_VIS$2=1500*1e3;class BDs extends ComposanteClientListe{verrouBdUnique;constructor({client:r}){super({client:r,clef:"bds",schmaBdPrincipale:schmaBdPrincipale$4}),this.verrouBdUnique=new s$1}async pingler(){await this.client.pingles.pinglerBd({id:await this.obtIdBd(),rcursif:!1,fichiers:!1})}async suivreBds({f:r,idCompte:_}){return await this.suivreBdPrincipale({idCompte:_,f:r})}async crerBd({licence:r,licenceContenu:_,ajouter:E=!0}){const S=await this.client.crerBdIndpendante({type:"keyvalue",optionsAccs:{address:void 0,write:await this.client.obtIdCompte()}}),{bd:C,fOublier:A}=await this.client.ouvrirBdType({id:S,type:"keyvalue",schma:schmaStructureBdBd});await C.set("type","bd"),await C.set("licence",r),_&&await C.set("licenceContenu",_);const B={address:C.access.address},O=await this.client.crerBdIndpendante({type:"keyvalue",optionsAccs:B});await C.set("mtadonnes",O);const N=await this.client.crerBdIndpendante({type:"keyvalue",optionsAccs:B});await C.set("noms",N);const U=await this.client.crerBdIndpendante({type:"keyvalue",optionsAccs:B});await C.set("descriptions",U);const j=await this.client.crerBdIndpendante({type:"ordered-keyvalue",optionsAccs:B});await C.set("tableaux",j);const z=await this.client.crerBdIndpendante({type:"set",optionsAccs:B});await C.set("motsClefs",z);const Z=await this.client.crerBdIndpendante({type:"set",optionsAccs:B});if(await C.set("nues",Z),await C.set("statut",{statut:"active"}),E){const{bd:X,fOublier:Q}=await this.client.ouvrirBdType({id:await this.obtIdBd(),type:"set",schma:schmaBdPrincipale$4});await X.add(S),Q()}return await A(),S}async ajouterMesBds({idBd:r}){const{bd:_,fOublier:E}=await this.client.ouvrirBdType({id:await this.obtIdBd(),type:"set",schma:schmaBdPrincipale$4});await _.add(r),await E()}async enleverDeMesBds({idBd:r}){const{bd:_,fOublier:E}=await this.client.ouvrirBdType({id:await this.obtIdBd(),type:"set",schma:schmaBdPrincipale$4});await _.del(r),await E()}async copierBd({idBd:r,ajouterMesBds:_=!0,copierDonnes:E=!0}){const{bd:S,fOublier:C}=await this.client.ouvrirBdType({id:r,type:"keyvalue",schma:schmaStructureBdBd}),A=await S.get("licence"),I=await S.get("licenceContenu");if(!A)throw new Error(`Aucune licence trouve sur la BD source ${r}.`);const B=await this.crerBd({licence:A,licenceContenu:I,ajouter:_}),{bd:O,fOublier:N}=await this.client.ouvrirBdType({id:B,type:"keyvalue",schma:schmaStructureBdBd}),U=await S.get("mtadonnes");if(U){const{bd:xe,fOublier:Re}=await this.client.ouvrirBdType({id:U,type:"keyvalue",schma:schmaStructureBdMtadonnes}),Ne=await xe.allAsJSON();await Re(),await this.sauvegarderMtadonnesBd({idBd:B,mtadonnes:Ne})}const j=await S.get("noms");if(j){const{bd:xe,fOublier:Re}=await this.client.ouvrirBdType({id:j,type:"keyvalue",schma:schmaStructureBdNoms}),Ne=await xe.allAsJSON();await Re(),await this.sauvegarderNomsBd({idBd:B,noms:Ne})}const z=await S.get("descriptions");if(z){const{bd:xe,fOublier:Re}=await this.client.ouvrirBdType({id:z,type:"keyvalue",schma:schmaStructureBdNoms}),Ne=await xe.allAsJSON();await Re(),await this.sauvegarderDescriptionsBd({idBd:B,descriptions:Ne})}const Z=await S.get("motsClefs");if(Z){const{bd:xe,fOublier:Re}=await this.client.ouvrirBdType({id:Z,type:"set",schma:schmaStructureBdMotsClefs}),Ne=(await xe.all()).map(Fe=>Fe.value);await Re(),await this.ajouterMotsClefsBd({idBd:B,idsMotsClefs:Ne})}const X=await S.get("nues");if(X){const{bd:xe,fOublier:Re}=await this.client.ouvrirBdType({id:X,type:"set",schma:schmaStructureBdNues}),Ne=(await xe.all()).map(Fe=>Fe.value);await Re(),await this.rejoindreNues({idBd:B,idsNues:Ne})}const Q=await S.get("tableaux"),se=await O.get("tableaux");if(!se)throw new Error("Erreur d'initialisation.");const{bd:oe,fOublier:ue}=await this.client.ouvrirBdType({id:se,type:"ordered-keyvalue",schma:schmaBdTableauxDeBd});if(Q){const{bd:xe,fOublier:Re}=await this.client.ouvrirBdType({id:Q,type:"ordered-keyvalue",schma:schmaBdTableauxDeBd}),Ne=await xe.all();await Re();for(const{key:Fe,value:ht}of Ne){const nt=await this.client.tableaux.copierTableau({id:Fe,idBd:B,copierDonnes:E});await oe.set(nt,ht)}}const we=await S.get("statut")||{statut:"active"};await O.set("statut",we);const Te=await S.get("image");return Te&&await O.set("image",Te),await O.set("copiDe",{id:r}),await Promise.all([C(),ue(),N()]),B}async crerBdDeSchma({schma:r,ajouter:_=!0}){const{tableaux:E,motsClefs:S,nues:C,licence:A,licenceContenu:I,statut:B}=r,O=await this.crerBd({licence:A,licenceContenu:I,ajouter:!1});S&&await this.ajouterMotsClefsBd({idBd:O,idsMotsClefs:S}),C&&await this.rejoindreNues({idBd:O,idsNues:C}),B&&await this.changerStatutBd({idBd:O,statut:B});for(const N of E){const{cols:U,clef:j}=N,z=await this.ajouterTableauBd({idBd:O,clefTableau:j});for(const Z of U){const{idColonne:X,idVariable:Q,index:se,optionnelle:oe}=Z;if(await this.client.tableaux.ajouterColonneTableau({idTableau:z,idVariable:Q,idColonne:X}),se&&await this.client.tableaux.changerColIndex({idTableau:z,idColonne:X,val:!0}),!oe){const ue={typeRgle:"existe",dtails:{}};await this.client.tableaux.ajouterRgleTableau({idTableau:z,idColonne:X,rgle:ue})}}}return _&&await this.ajouterMesBds({idBd:O}),O}async suivreParent({idBd:r,f:_}){return await this.client.suivreBd({id:r,f:async E=>{const S=await E.get("copiDe");await _(S)},type:"keyvalue",schma:schmaStructureBdBd})}async suivreNuesBd({idBd:r,f:_}){return await suivreBdsDeFonctionListe({fListe:async E=>await this.client.suivreBdListeDeClef({id:r,clef:"nues",schma:{type:"string"},f:E}),f:_,fBranche:async(E,S,C)=>(await this.client.nues.rechercherNuesDscendantes({idNue:E,f:async A=>S([...A,C])})).fOublier})}async rechercherBdsParMotsClefs({motsClefs:r,f:_,idCompte:E}){const S=async A=>await this.suivreBds({f:A,idCompte:E}),C=async(A,I)=>{const B=O=>{const N=r.every(U=>O.includes(U));I(N)};return await this.suivreMotsClefsBd({idBd:A,f:B})};return await this.client.suivreBdsSelonCondition({fListe:S,fCondition:C,f:_})}async rechercherBdsParNue({idNue:r,f:_,idCompte:E}){const S=async A=>await this.suivreBds({f:A,idCompte:E}),C=async(A,I)=>{const B=async O=>{I(!!O&&O.includes(r))};return await this.suivreNuesBd({idBd:A,f:B})};return await this.client.suivreBdsSelonCondition({fListe:S,fCondition:C,f:_})}async combinerBds({idBdBase:r,idBd2:_}){const E=async A=>await uneFois(async I=>await this.suivreTableauxBd({idBd:A,f:I})),S=await E(r),C=await E(_);for(const A of C){const{id:I,clef:B}=A;if(B){const O=S.find(N=>N.clef===B)?.id;O&&await this.client.tableaux.combinerDonnes({idTableauBase:O,idTableau2:I})}}}async suivreIdTableauParClef({idBd:r,clef:_,f:E}){const S=async C=>{const A=C.find(I=>I.clef===_);await E(A?.id)};return await this.suivreTableauxBd({idBd:r,f:S})}async suivreBdUnique({schma:r,idNueUnique:_,f:E}){const S="bdUnique: "+_,C=new Set,A=async B=>{let O;await this.verrouBdUnique.acquire(_);const N=await this.client.obtDeStockageLocal({clef:S});switch(B.length){case 0:{N?O=N:(O=await this.crerBdDeSchma({schma:r}),await this.client.sauvegarderAuStockageLocal({clef:S,val:O}));break}case 1:{O=B[0],await this.client.sauvegarderAuStockageLocal({clef:S,val:O}),N&&O!==N&&(await this.combinerBds({idBdBase:O,idBd2:N}),await this.effacerBd({idBd:N}));break}default:{N&&(B=[...new Set([...B,N])]),O=B.sort()[0],await this.client.sauvegarderAuStockageLocal({clef:S,val:O});for(const U of B.slice(1))C.has(U)||(C.add(U),await this.combinerBds({idBdBase:O,idBd2:U}),await this.effacerBd({idBd:U}));break}}this.verrouBdUnique.release(_),await E(O)};return await this.rechercherBdsParNue({idNue:_,f:A})}async suivreIdTableauParClefDeBdUnique({schmaBd:r,idNueUnique:_,clefTableau:E,f:S}){return await suivreBdDeFonction({fRacine:async({fSuivreRacine:I})=>await this.suivreBdUnique({schma:r,idNueUnique:_,f:I}),f:S,fSuivre:async({id:I,fSuivreBd:B})=>await this.suivreIdTableauParClef({idBd:I,clef:E,f:B})})}async suivreDonnesDeTableauUnique({schmaBd:r,idNueUnique:_,clefTableau:E,f:S}){return await suivreBdDeFonction({fRacine:async({fSuivreRacine:B})=>await this.suivreIdTableauParClefDeBdUnique({schmaBd:r,idNueUnique:_,clefTableau:E,f:async O=>{O&&await B(O)}}),f:async B=>await S(B||[]),fSuivre:async({id:B,fSuivreBd:O})=>await this.client.tableaux.suivreDonnes({idTableau:B,f:O})})}async ajouterlmentTableauUnique({schmaBd:r,idNueUnique:_,clefTableau:E,vals:S}){const C=await uneFois(async A=>await this.suivreIdTableauParClefDeBdUnique({schmaBd:r,idNueUnique:_,clefTableau:E,f:ignorerNonDfinis(A)}));return await this.client.tableaux.ajouterlment({idTableau:C,vals:S})}async modifierlmentDeTableauUnique({vals:r,schmaBd:_,idNueUnique:E,clefTableau:S,idlment:C}){const A=await uneFois(async I=>await this.suivreIdTableauParClefDeBdUnique({schmaBd:_,idNueUnique:E,clefTableau:S,f:B=>{B&&I(B)}}),I=>!!I);return await this.client.tableaux.modifierlment({idTableau:A,vals:r,idlment:C})}async effacerlmentDeTableauUnique({schmaBd:r,idNueUnique:_,clefTableau:E,idlment:S}){const C=await uneFois(async A=>await this.suivreIdTableauParClefDeBdUnique({schmaBd:r,idNueUnique:_,clefTableau:E,f:I=>{I&&A(I)}}),A=>!!A);return await this.client.tableaux.effacerlment({idTableau:C,idlment:S})}async suivreDonnesDeTableauParClef({idBd:r,clefTableau:_,f:E}){const S=await uneFois(async C=>await this.suivreIdTableauParClef({idBd:r,clef:_,f:ignorerNonDfinis(C)}),C=>!!C);return await this.client.tableaux.suivreDonnes({idTableau:S,f:E})}async ajouterlmentTableauParClef({idBd:r,clefTableau:_,vals:E}){const S=await uneFois(async C=>await this.suivreIdTableauParClef({idBd:r,clef:_,f:ignorerNonDfinis(C)}));return await this.client.tableaux.ajouterlment({idTableau:S,vals:E})}async modifierlmentDeTableauParClef({idBd:r,clefTableau:_,idlment:E,vals:S}){const C=await uneFois(async A=>await this.suivreIdTableauParClef({idBd:r,clef:_,f:ignorerNonDfinis(A)}));return await this.client.tableaux.modifierlment({idTableau:C,vals:S,idlment:E})}async effacerlmentDeTableauParClef({idBd:r,clefTableau:_,idlment:E}){const S=await uneFois(async C=>await this.suivreIdTableauParClef({idBd:r,clef:_,f:ignorerNonDfinis(C)}));this.client.tableaux.effacerlment({idTableau:S,idlment:E})}async sauvegarderMtadonnesBd({idBd:r,mtadonnes:_}){const E=await this.client.obtIdBd({nom:"mtadonnes",racine:r,type:"keyvalue"});if(!E)throw new Error(`Permission de modification refuse pour BD ${r}.`);const{bd:S,fOublier:C}=await this.client.ouvrirBdType({id:E,type:"keyvalue",schma:schmaStructureBdMtadonnes});for(const A in _)await S.set(A,_[A]);await C()}async sauvegarderMtadonneBd({idBd:r,clef:_,mtadonne:E}){const S=await this.client.obtIdBd({nom:"mtadonnes",racine:r,type:"keyvalue"});if(!S)throw new Error(`Permission de modification refuse pour BD ${r}.`);const{bd:C,fOublier:A}=await this.client.ouvrirBdType({id:S,type:"keyvalue",schma:schmaStructureBdMtadonnes});await C.set(_,E),await A()}async effacerMtadonneBd({idBd:r,clef:_}){const E=await this.client.obtIdBd({nom:"mtadonnes",racine:r,type:"keyvalue"});if(!E)throw new Error(`Permission de modification refuse pour BD ${r}.`);const{bd:S,fOublier:C}=await this.client.ouvrirBdType({id:E,type:"keyvalue",schma:schmaStructureBdMtadonnes});await S.del(_),await C()}async suivreMtadonnesBd({idBd:r,f:_}){return await this.client.suivreBdDicDeClef({id:r,clef:"mtadonnes",schma:schmaStructureBdMtadonnes,f:_})}async sauvegarderNomsBd({idBd:r,noms:_}){const E=await this.client.obtIdBd({nom:"noms",racine:r,type:"keyvalue"});if(!E)throw new Error(`Permission de modification refuse pour BD ${r}.`);const{bd:S,fOublier:C}=await this.client.ouvrirBdType({id:E,type:"keyvalue",schma:schmaStructureBdNoms});for(const A in _)await S.set(A,_[A]);await C()}async sauvegarderNomBd({idBd:r,langue:_,nom:E}){const S=await this.client.obtIdBd({nom:"noms",racine:r,type:"keyvalue"});if(!S)throw new Error(`Permission de modification refuse pour BD ${r}.`);const{bd:C,fOublier:A}=await this.client.ouvrirBdType({id:S,type:"keyvalue",schma:schmaStructureBdNoms});await C.set(_,E),await A()}async effacerNomBd({idBd:r,langue:_}){const E=await this.client.obtIdBd({nom:"noms",racine:r,type:"keyvalue"});if(!E)throw new Error(`Permission de modification refuse pour BD ${r}.`);const{bd:S,fOublier:C}=await this.client.ouvrirBdType({id:E,type:"keyvalue",schma:schmaStructureBdNoms});await S.del(_),await C()}async sauvegarderDescriptionsBd({idBd:r,descriptions:_}){const E=await this.client.obtIdBd({nom:"descriptions",racine:r,type:"keyvalue"});if(!E)throw new Error(`Permission de modification refuse pour BD ${r}.`);const{bd:S,fOublier:C}=await this.client.ouvrirBdType({id:E,type:"keyvalue",schma:schmaStructureBdNoms});for(const A in _)await S.set(A,_[A]);await C()}async sauvegarderDescriptionBd({idBd:r,langue:_,description:E}){const S=await this.client.obtIdBd({nom:"descriptions",racine:r,type:"keyvalue"});if(!S)throw new Error(`Permission de modification refuse pour BD ${r}.`);const{bd:C,fOublier:A}=await this.client.ouvrirBdType({id:S,type:"keyvalue",schma:schmaStructureBdNoms});await C.set(_,E),await A()}async effacerDescriptionBd({idBd:r,langue:_}){const E=await this.client.obtIdBd({nom:"descriptions",racine:r,type:"keyvalue"});if(!E)throw new Error(`Permission de modification refuse pour BD ${r}.`);const{bd:S,fOublier:C}=await this.client.ouvrirBdType({id:E,type:"keyvalue",schma:schmaStructureBdNoms});await S.del(_),await C()}async changerLicenceBd({idBd:r,licence:_}){const{bd:E,fOublier:S}=await this.client.ouvrirBdType({id:r,type:"keyvalue",schma:schmaStructureBdBd});await E.set("licence",_),await S()}async changerLicenceContenuBd({idBd:r,licenceContenu:_}){const{bd:E,fOublier:S}=await this.client.ouvrirBdType({id:r,type:"keyvalue",schma:schmaStructureBdBd});_?await E.set("licenceContenu",_):await E.del("licenceContenu"),await S()}async ajouterMotsClefsBd({idBd:r,idsMotsClefs:_}){Array.isArray(_)||(_=[_]);const E=await this.client.obtIdBd({nom:"motsClefs",racine:r,type:"set"});if(!E)throw new Error(`Permission de modification refuse pour BD ${r}.`);const{bd:S,fOublier:C}=await this.client.ouvrirBdType({id:E,type:"set",schma:schmaStructureBdMotsClefs});for(const A of _)(await S.all()).map(B=>B.value).includes(A)||await S.add(A);await C()}async effacerMotClefBd({idBd:r,idMotClef:_}){const E=await this.client.obtIdBd({nom:"motsClefs",racine:r,type:"set"});if(!E)throw new Error(`Permission de modification refuse pour BD ${r}.`);const{bd:S,fOublier:C}=await this.client.ouvrirBdType({id:E,type:"set",schma:schmaStructureBdMotsClefs});await S.del(_),await C()}async rejoindreNues({idBd:r,idsNues:_}){Array.isArray(_)||(_=[_]);const E=await this.client.obtIdBd({nom:"nues",racine:r,type:"set"});if(!E)throw new Error(`Permission de modification refuse pour BD ${r}.`);const{bd:S,fOublier:C}=await this.client.ouvrirBdType({id:E,type:"set",schma:schmaStructureBdNues});for(const A of _)(await S.all()).map(B=>B.value).includes(A)||await S.add(A);await C()}async quitterNue({idBd:r,idNue:_}){const E=await this.client.obtIdBd({nom:"nue",racine:r,type:"set"});if(!E)throw new Error(`Permission de modification refuse pour BD ${r}.`);const{bd:S,fOublier:C}=await this.client.ouvrirBdType({id:E,type:"set",schma:schmaStructureBdNues});await S.del(_),await C()}async ajouterTableauBd({idBd:r,clefTableau:_}){const E=await this.client.obtIdBd({nom:"tableaux",racine:r,type:"ordered-keyvalue"});if(!E)throw new Error(`Permission de modification refuse pour BD ${r}.`);const{bd:S,fOublier:C}=await this.client.ouvrirBdType({id:E,type:"ordered-keyvalue",schma:schmaBdTableauxDeBd});_=_||v4();const A=await this.client.tableaux.crerTableau({idBd:r});return await S.set(A,{clef:_}),await C(),A}async effacerTableauBd({idBd:r,idTableau:_}){const E=await this.client.obtIdBd({nom:"tableaux",racine:r,type:"ordered-keyvalue"});if(!E)throw new Error(`Permission de modification refuse pour BD ${r}.`);const{bd:S,fOublier:C}=await this.client.ouvrirBdType({id:E,type:"ordered-keyvalue",schma:schmaBdTableauxDeBd});await S.del(_),await C(),await this.client.tableaux.effacerTableau({idTableau:_})}async spcifierClefTableau({idBd:r,idTableau:_,clef:E}){const S=await this.client.obtIdBd({nom:"tableaux",racine:r,type:"ordered-keyvalue"});if(!S)throw new Error("Id Bd Tableau non obtenable.");const{bd:C,fOublier:A}=await this.client.ouvrirBdType({id:S,type:"ordered-keyvalue",schma:schmaBdTableauxDeBd}),I=await C.get(_);I&&(I.value.clef=E,C.set(_,I.value)),await A()}async changerStatutBd({idBd:r,statut:_}){const{bd:E,fOublier:S}=await this.client.ouvrirBdType({id:r,type:"keyvalue",schma:schmaStructureBdBd});E.set("statut",_),await S()}async suivreStatutBd({idBd:r,f:_}){return await this.client.suivreBdDic({id:r,schma:schmaStructureBdBd,f:async E=>{if(E.statut)return await _(E.statut)}})}async marquerObsolte({idBd:r,idNouvelle:_}){const{bd:E,fOublier:S}=await this.client.ouvrirBdType({id:r,type:"keyvalue",schma:schmaStructureBdBd});E.set("statut",{statut:"obsolte",idNouvelle:_}),await S()}async marquerActive({idBd:r}){const{bd:_,fOublier:E}=await this.client.ouvrirBdType({id:r,type:"keyvalue",schma:schmaStructureBdBd});_.set("statut",{statut:"active"}),await E()}async marquerJouet({idBd:r}){const{bd:_,fOublier:E}=await this.client.ouvrirBdType({id:r,type:"keyvalue",schma:schmaStructureBdBd});_.set("statut",{statut:"jouet"}),await E()}async marquerInterne({idBd:r}){const{bd:_,fOublier:E}=await this.client.ouvrirBdType({id:r,type:"keyvalue",schma:schmaStructureBdBd});_.set("statut",{statut:"interne"}),await E()}async suivreLicenceBd({idBd:r,f:_}){return await this.client.suivreBd({id:r,type:"keyvalue",schma:schmaStructureBdBd,f:async E=>{const S=await E.get("licence");S&&await _(S)}})}async suivreLicenceContenuBd({idBd:r,f:_}){return await this.client.suivreBd({id:r,type:"keyvalue",schma:schmaStructureBdBd,f:async E=>{const S=await E.get("licenceContenu");await _(S)}})}async inviterAuteur({idBd:r,idCompteAuteur:_,rle:E}){await this.client.donnerAccs({idBd:r,identit:_,rle:E})}async sauvegarderImage({idBd:r,image:_}){if(_.contenu.byteLength>MAX_TAILLE_IMAGE$2)throw new Error("Taille maximale excde");const E=await this.client.ajouterSFIP(_),{bd:S,fOublier:C}=await this.client.ouvrirBdType({id:r,type:"keyvalue",schma:schmaStructureBdBd});await S.set("image",E),await C()}async effacerImage({idBd:r}){const{bd:_,fOublier:E}=await this.client.ouvrirBdType({id:r,type:"keyvalue",schma:schmaStructureBdBd});await _.del("image"),await E()}async suivreImage({idBd:r,f:_}){return await this.client.suivreBd({id:r,type:"keyvalue",schma:schmaStructureBdBd,f:async E=>{const S=await E.get("image");if(!S)await _(null);else{const C=await this.client.obtFichierSFIP({id:S,max:MAX_TAILLE_IMAGE_VIS$2});await _(C)}}})}async suivreNomsBd({idBd:r,f:_}){return await this.client.suivreBdDicDeClef({id:r,clef:"noms",schma:schmaStructureBdNoms,f:_})}async suivreDescriptionsBd({idBd:r,f:_}){return await this.client.suivreBdDicDeClef({id:r,clef:"descriptions",schma:schmaStructureBdNoms,f:_})}async suivreMotsClefsBd({idBd:r,f:_}){return await this.client.suivreBdListeDeClef({id:r,clef:"motsClefs",schma:{type:"string"},f:_})}async suivreTableauxBd({idBd:r,f:_}){const E=async S=>{const C=S.map(A=>({id:A.key,...A.value}));await _(C)};return await this.client.suivreBdDicOrdonneDeClef({id:r,clef:"tableaux",schma:schmaBdTableauxDeBd,f:E})}async suivreScoreAccsBd({idBd:r,f:_}){return _(Number.parseInt(r)),faisRien}async suivreScoreCouvertureBd({idBd:r,f:_}){return await suivreBdsDeFonctionListe({fListe:async A=>await this.suivreTableauxBd({idBd:r,f:I=>A(I.map(B=>B.id))}),f:async A=>{const I=A.reduce((O,N)=>O+N.numrateur,0),B=A.reduce((O,N)=>O+N.dnominateur,0);await _(B===0?void 0:I/B)},fBranche:async(A,I)=>{const B={},O=async()=>{const{cols:j,rgles:z}=B;if(j!==void 0&&z!==void 0){const Z=j.filter(se=>se.catgorie&&["numrique","catgorique"].includes(se.catgorie.catgorie)),X=Z.length,Q=Z.filter(se=>z.some(oe=>oe.rgle.rgle.typeRgle!=="catgorie"&&oe.colonne===se.id)).length;await I({numrateur:Q,dnominateur:X})}},N=await this.client.tableaux.suivreColonnesTableau({idTableau:A,f:async j=>{B.cols=j,await O()},catgories:!0}),U=await this.client.tableaux.suivreRgles({idTableau:A,f:async j=>{B.rgles=j,await O()}});return async()=>{await N(),await U()}}})}async suivreScoreValideBd({idBd:r,f:_}){return await suivreBdsDeFonctionListe({fListe:async A=>await this.suivreTableauxBd({idBd:r,f:I=>A(I.map(B=>B.id))}),f:async A=>{const I=A.reduce((O,N)=>O+N.numrateur,0),B=A.reduce((O,N)=>O+N.dnominateur,0);await _(B===0?void 0:I/B)},fBranche:async(A,I)=>{const B={},O=()=>{const{donnes:z,erreurs:Z,cols:X}=B;if(z!==void 0&&Z!==void 0&&X!==void 0){const Q=X.filter(Te=>Te.catgorie&&["numrique","catgorique"].includes(Te.catgorie.catgorie)),se=[],oe=Z.map(Te=>({id:Te.id,idColonne:Te.erreur.rgle.colonne})).filter(Te=>se.find(Re=>Re.id===Te.id&&Re.idColonne===Te.idColonne)?!1:(se.push(Te),!0)).length,ue=z.map(Te=>Q.filter(xe=>Te.donnes[xe.id]!==void 0).length).reduce((Te,xe)=>Te+xe,0),we=ue-oe;I({numrateur:we,dnominateur:ue})}},N=await this.client.tableaux.suivreDonnes({idTableau:A,f:z=>{B.donnes=z,O()}}),U=await this.client.tableaux.suivreValidDonnes({idTableau:A,f:z=>{B.erreurs=z,O()}}),j=await this.client.tableaux.suivreColonnesTableau({idTableau:A,f:z=>{B.cols=z,O()},catgories:!0});return async()=>{await N(),await U(),await j()}}})}async suivreQualitBd({idBd:r,f:_}){const E={},S=async()=>{const{accs:O,couverture:N,valide:U,licence:j}=E,z={total:j?((O||0)+(N||0)+(U||0))/3:0,accs:O,couverture:N,valide:U,licence:j};await _(z)},C=await this.suivreScoreAccsBd({idBd:r,f:async O=>{E.accs=O,await S()}}),A=await this.suivreScoreCouvertureBd({idBd:r,f:async O=>{E.couverture=O,await S()}}),I=await this.suivreScoreValideBd({idBd:r,f:async O=>{E.valide=O,await S()}}),B=await this.suivreLicenceBd({idBd:r,f:async O=>{E.licence=O?1:0,await S()}});return async()=>{await Promise.all([C,A,I,B])}}async suivreVariablesBd({idBd:r,f:_}){return await suivreBdsDeFonctionListe({fListe:async A=>await this.suivreTableauxBd({idBd:r,f:I=>A(I.map(B=>B.id))}),f:async A=>await _(A||[]),fBranche:async(A,I)=>await this.client.tableaux.suivreVariables({idTableau:A,f:I})})}async suivreDonnesExportation({idBd:r,langues:_,f:E}){const S={},C=[],A=async()=>{const{nomsBd:B,donnes:O}=S;if(!O)return;const N=r.split("/").pop(),U=B&&_&&traduire(B,_)||N;await E({nomBd:U,tableaux:O})},I=await suivreBdsDeFonctionListe({fListe:async B=>await this.suivreTableauxBd({idBd:r,f:B}),f:async B=>{S.donnes=B,await A()},fBranche:async(B,O)=>await this.client.tableaux.suivreDonnesExportation({idTableau:B,langues:_,f:async N=>await O(N)}),fIdBdDeBranche:B=>B.id,fCode:B=>B.id});if(C.push(I),_){const B=await this.suivreNomsBd({idBd:r,f:async O=>{S.nomsBd=O,await A()}});C.push(B)}return async()=>{await Promise.all(C.map(B=>B()))}}async exporterDonnes({idBd:r,langues:_,nomFichier:E,patience:S=500}){const C=utils.book_new(),A=await uneFois(async B=>await this.suivreDonnesExportation({idBd:r,langues:_,f:B}),attendreStabilit(S));E=E||A.nomBd;const I=new Set;for(const B of A.tableaux){B.fichiersSFIP.forEach(N=>I.add(N));const O=utils.json_to_sheet(B.donnes);utils.book_append_sheet(C,O,B.nomTableau.slice(0,30))}return{doc:C,fichiersSFIP:I,nomFichier:E}}async exporterDocumentDonnes({donnes:r,formatDoc:_,dossier:E="",inclureFichiersSFIP:S=!0}){const{doc:C,fichiersSFIP:A,nomFichier:I}=r,O={xls:"biff8"}[_]||_;if(!(isBrowser||isWebWorker)){const N=await __vitePreload(()=>Promise.resolve().then(()=>__viteBrowserExternal),void 0);N.existsSync(E)||N.mkdirSync(E,{recursive:!0})}if(S){const N={octets:writeSync(C,{bookType:O,type:"buffer"}),nom:`${I}.${_}`},U=await Promise.all([...A].map(async j=>({nom:j.replace("/","-"),octets:await toBuffer(await this.client.obtItrableAsyncSFIP({id:j}))})));return await zipper([N],U,path.join(E,I)),path.join(E,`${I}.zip`)}else return writeFileSync(C,path.join(E,`${I}.${_}`),{bookType:O}),path.join(E,`${I}.${_}`)}async effacerBd({idBd:r}){const{bd:_,fOublier:E}=await this.client.ouvrirBdType({id:await this.obtIdBd(),type:"set",schma:schmaBdPrincipale$4});await _.del(r),await E();for(const C of["noms","descriptions","motsClefs"]){const A=await this.client.obtIdBd({nom:C,racine:r});A&&await this.client.effacerBd({id:A})}const S=await this.client.obtIdBd({nom:"tableaux",racine:r,type:"ordered-keyvalue"});if(S){const{bd:C,fOublier:A}=await this.client.ouvrirBdType({id:S,type:"ordered-keyvalue",schma:schmaBdTableauxDeBd}),I=Object.keys(C.all);for(const B of I)await this.client.tableaux.effacerTableau({idTableau:B});A(),await this.client.effacerBd({id:S})}await this.enleverDeMesBds({idBd:r}),await this.client.effacerBd({id:r})}}__decorate([cacheSuivi],BDs.prototype,"suivreBds",null);__decorate([cacheSuivi],BDs.prototype,"suivreParent",null);__decorate([cacheSuivi],BDs.prototype,"suivreNuesBd",null);__decorate([cacheSuivi],BDs.prototype,"rechercherBdsParMotsClefs",null);__decorate([cacheSuivi],BDs.prototype,"rechercherBdsParNue",null);__decorate([cacheSuivi],BDs.prototype,"suivreIdTableauParClef",null);__decorate([cacheSuivi],BDs.prototype,"suivreBdUnique",null);__decorate([cacheSuivi],BDs.prototype,"suivreIdTableauParClefDeBdUnique",null);__decorate([cacheSuivi],BDs.prototype,"suivreDonnesDeTableauUnique",null);__decorate([cacheSuivi],BDs.prototype,"suivreDonnesDeTableauParClef",null);__decorate([cacheSuivi],BDs.prototype,"suivreMtadonnesBd",null);__decorate([cacheSuivi],BDs.prototype,"suivreLicenceBd",null);__decorate([cacheSuivi],BDs.prototype,"suivreLicenceContenuBd",null);__decorate([cacheSuivi],BDs.prototype,"suivreImage",null);__decorate([cacheSuivi],BDs.prototype,"suivreNomsBd",null);__decorate([cacheSuivi],BDs.prototype,"suivreDescriptionsBd",null);__decorate([cacheSuivi],BDs.prototype,"suivreMotsClefsBd",null);__decorate([cacheSuivi],BDs.prototype,"suivreTableauxBd",null);__decorate([cacheSuivi],BDs.prototype,"suivreScoreAccsBd",null);__decorate([cacheSuivi],BDs.prototype,"suivreScoreCouvertureBd",null);__decorate([cacheSuivi],BDs.prototype,"suivreScoreValideBd",null);__decorate([cacheSuivi],BDs.prototype,"suivreQualitBd",null);__decorate([cacheSuivi],BDs.prototype,"suivreVariablesBd",null);var geojsonValidation={};(function(n){const r={};function _(N){return typeof N=="function"}function E(N){return N===Object(N)}function S(N,U){let j=!1;return typeof U=="string"?U=[U]:Object.prototype.toString.call(U)==="[object Array]"?U.length===0&&(j=!0):j=!0,N?U:j}function C(N,U){let j;if(_(r[N])){try{j=r[N](U)}catch(z){j=["Problem with custom definition for "+N+": "+z]}if(typeof result=="string"&&(j=[j]),Object.prototype.toString.call(j)==="[object Array]")return j}return[]}n.define=(N,U)=>N in O&&_(U)?(r[N]=U,!0):!1,n.isPosition=(N,U=!1)=>{let j=[];return Array.isArray(N)?(N.length<=1&&j.push("Position must be at least two elements"),N.forEach((z,Z)=>{typeof z!="number"&&j.push("Position must only contain numbers. Item "+z+" at index "+Z+" is invalid.")})):j.push("Position must be an array"),j=j.concat(C("Position",N)),S(U,j)},n.isGeoJSONObject=n.valid=(N,U=!1)=>{if(E(N)){let j=[];if("type"in N){if(I[N.type])return I[N.type](N,U);if(B[N.type])return B[N.type](N,U);j.push('type must be one of: "Point", "MultiPoint", "LineString", "MultiLineString", "Polygon", "MultiPolygon", "GeometryCollection", "Feature", or "FeatureCollection"')}else j.push('must have a member with the name "type"');return j=j.concat(C("GeoJSONObject",N)),S(U,j)}else return S(U,["must be a JSON Object"])},n.isGeometryObject=(N,U=!1)=>{if(!E(N))return S(U,["must be a JSON Object"]);let j=[];if("type"in N){if(B[N.type])return B[N.type](N,U);j.push('type must be one of: "Point", "MultiPoint", "LineString", "MultiLineString", "Polygon", "MultiPolygon" or "GeometryCollection"')}else j.push('must have a member with the name "type"');return j=j.concat(C("GeometryObject",N)),S(U,j)},n.isPoint=(N,U=!1)=>{if(!E(N))return S(U,["must be a JSON Object"]);let j=[];if("bbox"in N){const z=n.isBbox(N.bbox,!0);z.length&&(j=j.concat(z))}if("type"in N?N.type!=="Point"&&j.push('type must be "Point"'):j.push('must have a member with the name "type"'),"coordinates"in N){const z=n.isPosition(N.coordinates,!0);z.length&&(j=j.concat(z))}else j.push('must have a member with the name "coordinates"');return j=j.concat(C("Point",N)),S(U,j)},n.isMultiPointCoor=(N,U=!1)=>{let j=[];return Array.isArray(N)?N.forEach((z,Z)=>{const X=n.isPosition(z,!0);X.length&&(X[0]="at "+Z+": ".concat(X[0]),j=j.concat(X))}):j.push("coordinates must be an array"),S(U,j)},n.isMultiPoint=(N,U=!1)=>{if(!E(N))return S(U,["must be a JSON Object"]);let j=[];if("bbox"in N){const z=n.isBbox(N.bbox,!0);z.length&&(j=j.concat(z))}if("type"in N?N.type!=="MultiPoint"&&j.push('type must be "MultiPoint"'):j.push('must have a member with the name "type"'),"coordinates"in N){const z=n.isMultiPointCoor(N.coordinates,!0);z.length&&(j=j.concat(z))}else j.push('must have a member with the name "coordinates"');return j=j.concat(C("MultiPoint",N)),S(U,j)},n.isLineStringCoor=(N,U=!1)=>{let j=[];return Array.isArray(N)?N.length>1?N.forEach((z,Z)=>{const X=n.isPosition(z,!0);X.length&&(X[0]="at "+Z+": ".concat(X[0]),j=j.concat(X))}):j.push("coordinates must have at least two elements"):j.push("coordinates must be an array"),S(U,j)},n.isLineString=(N,U=!1)=>{if(!E(N))return S(U,["must be a JSON Object"]);let j=[];if("bbox"in N){const z=n.isBbox(N.bbox,!0);z.length&&(j=j.concat(z))}if("type"in N?N.type!=="LineString"&&j.push('type must be "LineString"'):j.push('must have a member with the name "type"'),"coordinates"in N){const z=n.isLineStringCoor(N.coordinates,!0);z.length&&(j=j.concat(z))}else j.push('must have a member with the name "coordinates"');return j=j.concat(C("LineString",N)),S(U,j)},n.isMultiLineStringCoor=(N,U=!1)=>{let j=[];return Array.isArray(N)?N.forEach((z,Z)=>{const X=n.isLineStringCoor(z,!0);X.length&&(X[0]="at "+Z+": ".concat(X[0]),j=j.concat(X))}):j.push("coordinates must be an array"),S(U,j)},n.isMultiLineString=(N,U=!1)=>{if(!E(N))return S(U,["must be a JSON Object"]);let j=[];if("bbox"in N){const z=n.isBbox(N.bbox,!0);z.length&&(j=j.concat(z))}if("type"in N?N.type!=="MultiLineString"&&j.push('type must be "MultiLineString"'):j.push('must have a member with the name "type"'),"coordinates"in N){const z=n.isMultiLineStringCoor(N.coordinates,!0);z.length&&(j=j.concat(z))}else j.push('must have a member with the name "coordinates"');return j=j.concat(C("MultiPoint",N)),S(U,j)};function A(N,U){let j=[];return Array.isArray(N)?(N.forEach((z,Z)=>{const X=n.isPosition(z,!0);X.length&&(X[0]="at "+Z+": ".concat(X[0]),j=j.concat(X))}),N[0].toString()!==N[N.length-1].toString()&&j.push("The first and last positions must be equivalent"),N.length<4&&j.push("coordinates must have at least four positions")):j.push("coordinates must be an array"),S(U,j)}n.isPolygonCoor=(N,U=!1)=>{let j=[];return Array.isArray(N)?N.forEach((z,Z)=>{const X=A(z,!0);X.length&&(X[0]="at "+Z+": ".concat(X[0]),j=j.concat(X))}):j.push("coordinates must be an array"),S(U,j)},n.isPolygon=(N,U=!1)=>{if(!E(N))return S(U,["must be a JSON Object"]);let j=[];if("bbox"in N){const z=n.isBbox(N.bbox,!0);z.length&&(j=j.concat(z))}if("type"in N?N.type!=="Polygon"&&j.push('type must be "Polygon"'):j.push('must have a member with the name "type"'),"coordinates"in N){const z=n.isPolygonCoor(N.coordinates,!0);z.length&&(j=j.concat(z))}else j.push('must have a member with the name "coordinates"');return j=j.concat(C("Polygon",N)),S(U,j)},n.isMultiPolygonCoor=(N,U=!1)=>{let j=[];return Array.isArray(N)?N.forEach((z,Z)=>{const X=n.isPolygonCoor(z,!0);X.length&&(X[0]="at "+Z+": ".concat(X[0]),j=j.concat(X))}):j.push("coordinates must be an array"),S(U,j)},n.isMultiPolygon=(N,U=!1)=>{if(!E(N))return S(U,["must be a JSON Object"]);let j=[];if("bbox"in N){const z=n.isBbox(N.bbox,!0);z.length&&(j=j.concat(z))}if("type"in N?N.type!=="MultiPolygon"&&j.push('type must be "MultiPolygon"'):j.push('must have a member with the name "type"'),"coordinates"in N){const z=n.isMultiPolygonCoor(N.coordinates,!0);z.length&&(j=j.concat(z))}else j.push('must have a member with the name "coordinates"');return j=j.concat(C("MultiPolygon",N)),S(U,j)},n.isGeometryCollection=(N,U=!1)=>{if(!E(N))return S(U,["must be a JSON Object"]);let j=[];if("bbox"in N){const z=n.isBbox(N.bbox,!0);z.length&&(j=j.concat(z))}return"type"in N?N.type!=="GeometryCollection"&&j.push('type must be "GeometryCollection"'):j.push('must have a member with the name "type"'),"geometries"in N?Array.isArray(N.geometries)?N.geometries.forEach((z,Z)=>{const X=n.isGeometryObject(z,!0);X.length&&(X[0]="at "+Z+": ".concat(X[0]),j=j.concat(X))}):j.push('"geometries" must be an array'):j.push('must have a member with the name "geometries"'),j=j.concat(C("GeometryCollection",N)),S(U,j)},n.isFeature=(N,U=!1)=>{if(!E(N))return S(U,["must be a JSON Object"]);let j=[];if("bbox"in N){const z=n.isBbox(N.bbox,!0);z.length&&(j=j.concat(z))}if("type"in N?N.type!=="Feature"&&j.push('type must be "Feature"'):j.push('must have a member with the name "type"'),"properties"in N||j.push('must have a member with the name "properties"'),"geometry"in N){if(N.geometry!==null){const z=n.isGeometryObject(N.geometry,!0);z.length&&(j=j.concat(z))}}else j.push('must have a member with the name "geometry"');return j=j.concat(C("Feature",N)),S(U,j)},n.isFeatureCollection=(N,U=!1)=>{if(!E(N))return S(U,["must be a JSON Object"]);let j=[];if("bbox"in N){const z=n.isBbox(N.bbox,!0);z.length&&(j=z)}return"type"in N?N.type!=="FeatureCollection"&&j.push('type must be "FeatureCollection"'):j.push('must have a member with the name "type"'),"features"in N?Array.isArray(N.features)?N.features.forEach((z,Z)=>{const X=n.isFeature(z,!0);X.length&&(X[0]="at "+Z+": ".concat(X[0]),j=j.concat(X))}):j.push('"Features" must be an array'):j.push('must have a member with the name "Features"'),j=j.concat(C("FeatureCollection",N)),S(U,j)},n.isBbox=(N,U=!1)=>{let j=[];return Array.isArray(N)?N.length%2!==0&&j.push("bbox, must be a 2*n array"):j.push("bbox must be an array"),j=j.concat(C("Bbox",N)),S(U,j)};const I={Feature:n.isFeature,FeatureCollection:n.isFeatureCollection},B={Point:n.isPoint,MultiPoint:n.isMultiPoint,LineString:n.isLineString,MultiLineString:n.isMultiLineString,Polygon:n.isPolygon,MultiPolygon:n.isMultiPolygon,GeometryCollection:n.isGeometryCollection},O={Feature:n.isFeature,FeatureCollection:n.isFeatureCollection,Point:n.isPoint,MultiPoint:n.isMultiPoint,LineString:n.isLineString,MultiLineString:n.isMultiLineString,Polygon:n.isPolygon,MultiPolygon:n.isMultiPolygon,GeometryCollection:n.isGeometryCollection,Bbox:n.isBbox,Position:n.isPosition,GeoJSON:n.isGeoJSONObject,GeometryObject:n.isGeometryObject};n.allTypes=O})(geojsonValidation);const gjv=getDefaultExportFromCjs(geojsonValidation),estSpcificationHoroDatage=n=>!!n&&typeof n.systme=="string"&&typeof n.val=="string";class Cholqij{lireDate(r){const{systme:_,val:E}=r;switch(_){case"dateJS":case"grgorien":{const S=new Date(E);if(isNaN(S.valueOf()))throw new Error(E);return S}default:throw new Error(_)}}dateValide(r){if(!estSpcificationHoroDatage(r))return!1;try{return this.lireDate(r),!0}catch{return!1}}}const cholqij=new Cholqij;function gnrerFonctionRgle({rgle:n,varsColonnes:r,donnesCatgorie:_}){const E=n.rgle,{colonne:S}=n,{typeRgle:C}=E.rgle;switch(C){case"existe":return A=>A.filter(B=>B.donnes[S]===void 0).map(B=>{const{id:O}=B;return{id:O,erreur:{rgle:n}}});case"catgorie":return A=>{const I=E.rgle.dtails.catgorie;return A.filter(O=>!validerCatgorieVal({val:O.donnes[S],catgorie:I})).map(O=>{const{id:N}=O;return{id:N,erreur:{rgle:n}}})};case"bornes":{const A=E;let I,B;const{val:O,op:N,type:U}=A.rgle.dtails,j=(z,Z)=>z===void 0||Z===void 0;switch(N){case">":B=(z,Z)=>j(z,Z)||z>Z;break;case"<":B=(z,Z)=>j(z,Z)||z<Z;break;case"":case">=":B=(z,Z)=>j(z,Z)||z>=Z;break;case"":case"<=":B=(z,Z)=>j(z,Z)||z<=Z;break}return U==="fixe"?I=z=>{const Z=z.donnes[S];return Array.isArray(Z)?Z.every(X=>B(X,O)):B(Z,O)}:I=z=>{const Z=z.donnes[S],X=U==="dynamiqueVariable"?z.donnes[r[O]]:z.donnes[O];return Array.isArray(Z)?Z.every(Q=>B(Q,X)):B(Z,X)},z=>z.filter(X=>!validerBorneVal({val:X,fComp:I})).map(X=>{const{id:Q}=X;return{id:Q,erreur:{rgle:n}}})}case"valeurCatgorique":{const A=E.rgle,I=A.dtails.type==="fixe"?A.dtails.options:_;if(!I)throw new Error("Options non spcifies");return B=>B.filter(N=>N.donnes[S]!==void 0&&!I.includes(N.donnes[S])).map(N=>{const{id:U}=N;return{id:U,colonne:S,erreur:{rgle:n}}})}default:throw Error(`Catgorie ${C} inconnue.`)}}const formatsFichiers={images:["webp","svg","png","jpg","jpeg","jfif","pjpeg","pjp","gif","avif","apng"],vido:["mp4"],audio:["mp3","ogg","m4a"]};function validFichier(n,r){if(typeof n!="string")return!1;let _,E;try{[_,E]=n.split("/")}catch{return!1}if(!E||!cidValide(_))return!1;if(r){const S=E.split(".")[1];return r.includes(S)}return!0}function validerCatgorieVal({val:n,catgorie:r}){return n===void 0?!0:r.type==="simple"?validerCatgorieBase({catgorie:r.catgorie,val:n}):Array.isArray(n)?n.every(_=>validerCatgorieBase({catgorie:r.catgorie,val:_})):!1}const validerBorneVal=({val:n,fComp:r})=>Array.isArray(n)?n.every(_=>r(_)):r(n),estUnHoroDatage=n=>{if(["number","string"].includes(typeof n)){const r=new Date(n);return!isNaN(r.valueOf())}else return cholqij.dateValide(n)},validerCatgorieBase=({catgorie:n,val:r})=>{switch(n){case"numrique":return typeof r=="number";case"horoDatage":return estUnHoroDatage(r);case"intervaleTemps":return!Array.isArray(r)||r.length!==2?!1:r.every(_=>estUnHoroDatage(_));case"chane":return isValidAddress(r);case"chaneNonTraductible":return typeof r=="string";case"boolen":return typeof r=="boolean";case"gojson":return typeof r!="object"?!1:gjv.valid(r);case"vido":return validFichier(r,formatsFichiers.vido);case"audio":return validFichier(r,formatsFichiers.audio);case"image":return validFichier(r,formatsFichiers.images);case"fichier":return validFichier(r);default:return!1}},schmaBdInfoColAvecCatgorie={type:"object",additionalProperties:{type:"object",properties:{catgorie:{type:"object",nullable:!0,properties:{catgorie:{type:"string"},type:{type:"string"}},required:["catgorie","type"]},id:{type:"string"},variable:{type:"string"},index:{type:"boolean",nullable:!0}},required:["id","variable"]},required:[]},schmaBdDonnesTableau={type:"object",additionalProperties:{type:"object",additionalProperties:!0,required:[]},required:[]},schmaBdRgles={type:"object",additionalProperties:{type:"object",properties:{colonne:{type:"string"},source:{type:"object",properties:{id:{type:"string"},type:{type:"string"}},required:["id","type"]},rgle:{type:"object",properties:{id:{type:"string"},rgle:{type:"object",properties:{dtails:{type:"object",required:[]},typeRgle:{type:"string"}},required:["dtails","typeRgle"]}},required:["id","rgle"]}},required:["colonne","rgle","source"]},required:[]};function lmentsgaux(n,r){const _=Object.keys(n).filter(S=>S!=="id"),E=Object.keys(r).filter(S=>S!=="id");return!(!_.every(S=>n[S]===r[S])||!E.every(S=>n[S]===r[S]))}function indexlmentsgaux(n,r,_){return!!_.every(E=>n[E]===r[E])}const schmaStructureBdTableau={type:"object",properties:{type:{type:"string"},noms:{type:"string"},donnes:{type:"string"},colonnes:{type:"string"},rgles:{type:"string"}},required:["donnes","colonnes","noms","rgles","type"]};class Tableaux{client;constructor({client:r}){this.client=r}async crerTableau({idBd:r}){const _=await this.client.obtOpsAccs({idBd:r}),E=await this.client.crerBdIndpendante({type:"keyvalue",optionsAccs:_}),{bd:S,fOublier:C}=await this.client.ouvrirBdType({id:E,type:"keyvalue",schma:schmaStructureBdTableau});await S.set("type","tableau");const A=await this.client.crerBdIndpendante({type:"keyvalue",optionsAccs:_});await S.set("noms",A);const I=await this.client.crerBdIndpendante({type:"keyvalue",optionsAccs:_});await S.set("donnes",I);const B=await this.client.crerBdIndpendante({type:"keyvalue",optionsAccs:_});await S.set("colonnes",B);const O=await this.client.crerBdIndpendante({type:"keyvalue",optionsAccs:_});return await S.set("rgles",O),await C(),E}async copierTableau({id:r,idBd:_,copierDonnes:E=!0}){const{bd:S,fOublier:C}=await this.client.ouvrirBdType({id:r,type:"keyvalue",schma:schmaStructureBdTableau}),A=await this.crerTableau({idBd:_}),{bd:I,fOublier:B}=await this.client.ouvrirBdType({id:A,type:"keyvalue",schma:schmaStructureBdTableau}),O=await S.get("noms");if(O){const{bd:N,fOublier:U}=await this.client.ouvrirBdType({id:O,type:"keyvalue",schma:schmaStructureBdNoms}),j=await N.allAsJSON();await U(),await this.sauvegarderNomsTableau({idTableau:A,noms:j})}return await this.client.copierContenuBdDic({bdBase:S,nouvelleBd:I,clef:"colonnes",schma:schmaBdInfoColAvecCatgorie}),await this.client.copierContenuBdDic({bdBase:S,nouvelleBd:I,clef:"rgles",schma:schmaBdRgles}),E&&await this.client.copierContenuBdDic({bdBase:S,nouvelleBd:I,clef:"donnes",schma:schmaBdDonnesTableau}),await Promise.all([C(),B()]),A}async suivreDiffrencesAvecTableau({idTableau:r,idTableauRf:_,f:E}){const S={},C=async()=>{if(!S.colonnesTableau||!S.colonnesTableauRf)return;const B=[];for(const O of S.colonnesTableauRf){const N=S.colonnesTableau.find(U=>U.id===O.id);if(N){if(N.variable!==O.variable){const U={type:"variableColonne",svre:!0,idCol:N.id,varColTableau:N.variable,varColTableauLie:O.variable};B.push(U)}if(N.index!==O.index){const U={type:"indexColonne",svre:!0,idCol:N.id,colTableauIndexe:!!N.index};B.push(U)}}else{const U={type:"colonneManquante",svre:!0,idManquante:O.id};B.push(U)}}for(const O of S.colonnesTableau)if(!S.colonnesTableauRf.find(U=>U.id===O.id)){const U={type:"colonneSupplmentaire",svre:!1,idExtra:O.id};B.push(U)}await E(B)},A=await this.suivreColonnesTableau({idTableau:r,f:async B=>{S.colonnesTableau=B,await C()},catgories:!1}),I=await this.suivreColonnesTableau({idTableau:_,f:async B=>{S.colonnesTableauRf=B,await C()},catgories:!1});return async()=>{await Promise.all([A,I])}}async changerColIndex({idTableau:r,idColonne:_,val:E}){const S=await this.client.obtIdBd({nom:"colonnes",racine:r,type:"keyvalue"});if(!S)throw new Error(`Permission de modification refuse pour BD ${r}.`);const{bd:C,fOublier:A}=await this.client.ouvrirBdType({id:S,type:"keyvalue",schma:schmaBdInfoColAvecCatgorie}),B=(await C.all()).find(O=>O.value.id===_);if(B&&!!B.value.index!==E){const{value:O}=B,N=Object.assign(O,{index:E});await C.put(_,N)}await A()}async suivreIndex({idTableau:r,f:_}){const E=async S=>{const C=S.filter(A=>A.index).map(A=>A.id);await _(C)};return await this.suivreColonnesTableau({idTableau:r,f:E,catgories:!1})}async suivreDonnes({idTableau:r,f:_,clefsSelonVariables:E=!1}){const S={},C=async()=>{const{donnes:N,colonnes:U}=S;if(N&&U){const j=Object.entries(N).map(([z,Z])=>({donnes:E?Object.keys(Z).reduce((Q,se)=>{const oe=se==="id"?"id":U[se];return Q[oe]=Z[se],Q},{}):Z,id:z}));await _(j)}},A=async N=>{S.colonnes=Object.fromEntries(N.map(U=>[U.id,U.variable])),await C()},I=await this.suivreColonnesTableau({idTableau:r,f:A,catgories:!1}),B=async N=>{S.donnes=N,await C()},O=await this.client.suivreBdDicDeClef({id:r,clef:"donnes",f:B,schma:schmaBdDonnesTableau});return async()=>{await O(),await I()}}async formaterlment({:r,colonnes:_,fichiersSFIP:E,langues:S}){const C=async({adresseBdTrads:B,langues:O})=>{const N=await uneFois(U=>this.client.suivreBdDic({id:B,f:U}));return traduire(N,O||[])||B},A={},I=async(B,O)=>{switch(typeof B){case"object":return JSON.stringify(B);case"boolean":return B.toString();case"number":return B;case"string":return["audio","image","vido","fichier"].includes(O)?(E.add(B),B):O==="chane"&&isValidAddress(B)?await C({adresseBdTrads:B,langues:S}):B;default:return}};for(const B of Object.keys(r)){const O=_.find(Z=>Z.id===B);if(!O)continue;const{variable:N,catgorie:U}=O;let j;const z=r[B];U?.type==="simple"?j=await I(z,U.catgorie):U?.type==="liste"&&Array.isArray(z)&&(j=JSON.stringify(await Promise.all(z.map(Z=>I(Z,U.catgorie))))),j!==void 0&&(A[N]=j)}return A}async suivreDonnesExportation({idTableau:r,langues:_,f:E}){const S={},C=[],A=async()=>{const{colonnes:O,donnes:N,nomsTableau:U,nomsVariables:j}=S;if(O&&N&&(!_||U&&j)){const z=new Set;let Z=await Promise.all(N.map(se=>this.formaterlment({:se.donnes,fichiersSFIP:z,colonnes:O,langues:_})));Z=Z.map(se=>Object.keys(se).reduce((oe,ue)=>{const we=O.find(xe=>xe.variable===ue)?.id;if(!we)throw new Error(`Colonnne pour variable ${ue} non trouve parmis les colonnnes :
${JSON.stringify(O,void 0,2)}.`);const Te=_&&j?.[ue]&&traduire(j[ue],_)||we;return oe[Te]=se[ue],oe},{}));const X=r.split("/").pop(),Q=_&&U&&traduire(U,_)||X;return await E({nomTableau:Q,donnes:Z,fichiersSFIP:z})}};if(_){const O=await this.suivreNomsTableau({idTableau:r,f:async U=>{S.nomsTableau=U,await A()}});C.push(O);const N=await suivreBdsDeFonctionListe({fListe:async U=>this.suivreVariables({idTableau:r,f:U}),f:async U=>{S.nomsVariables=Object.fromEntries(U.map(j=>[j.idVar,j.noms])),await A()},fBranche:async(U,j)=>await this.client.variables.suivreNomsVariable({idVariable:U,f:async z=>await j({idVar:U,noms:z})})});C.push(N)}const I=await this.suivreColonnesTableau({idTableau:r,f:async O=>{S.colonnes=O,await A()},catgories:!0});C.push(I);const B=await this.suivreDonnes({idTableau:r,f:async O=>{S.donnes=O,await A()}});return C.push(B),async()=>{Promise.all(C.map(O=>O()))}}async exporterDonnes({idTableau:r,langues:_,doc:E,nomFichier:S,patience:C=500}){E=E||utils.book_new();const A=await uneFois(async B=>await this.suivreDonnesExportation({idTableau:r,langues:_,f:B}),attendreStabilit(C)),I=utils.json_to_sheet(A.donnes);return utils.book_append_sheet(E,I,A.nomTableau.slice(0,30)),S=S||A.nomTableau,{doc:E,fichiersSFIP:A.fichiersSFIP,nomFichier:S}}async ajouterlment({idTableau:r,vals:_}){Array.isArray(_)||(_=[_]);const E=await this.client.obtIdBd({nom:"donnes",racine:r,type:"keyvalue"});if(!E)throw new Error(`Permission de modification refuse pour BD ${r}.`);const{bd:S,fOublier:C}=await this.client.ouvrirBdType({id:E,type:"keyvalue",schma:schmaBdDonnesTableau}),A=(await uneFois(O=>this.suivreColonnesTableau({idTableau:r,f:O,catgories:!1}))).filter(O=>O.index).map(O=>O.id),I=O=>{const N=Object.fromEntries(Object.entries(O).filter(U=>A.includes(U[0])));return Base64.stringify(md5(JSON.stringify(N)))},B=[];for(const O of _){const N=A.length?I(O):v4();await S.put(N,O),B.push(N)}return await C(),B}async modifierlment({idTableau:r,vals:_,idlment:E}){const S=await this.client.obtIdBd({nom:"donnes",racine:r,type:"keyvalue"});if(!S)throw new Error(`Permission de modification refuse pour BD ${r}.`);const{bd:C,fOublier:A}=await this.client.ouvrirBdType({id:S,type:"keyvalue",schma:schmaBdDonnesTableau}),I=await C.get(E);if(!I)throw new Error(`Id lment ${E} n'existe pas.`);const B=Object.assign({},I,_);Object.keys(_).map(O=>{_[O]===void 0&&delete B[O]}),lmentsgaux(B,I)||await C.put(E,B),await A()}async vrifierClefslment({idTableau:r,lment:_}){const E=await this.client.obtIdBd({nom:"colonnes",racine:r,type:"keyvalue"});if(!E)throw new Error(`Permission de modification refuse pour BD ${r}.`);const{bd:S,fOublier:C}=await this.client.ouvrirBdType({id:E,type:"keyvalue",schma:schmaBdInfoColAvecCatgorie}),I=[...(await S.all()).map(O=>O.value.id),"id"],B=Object.keys(_).filter(O=>I.includes(O));return await C(),Object.fromEntries(B.map(O=>[O,_[O]]))}async effacerlment({idTableau:r,idlment:_}){const E=await this.client.obtIdBd({nom:"donnes",racine:r,type:"keyvalue"});if(!E)throw new Error(`Permission de modification refuse pour BD ${r}.`);const{bd:S,fOublier:C}=await this.client.ouvrirBdType({id:E,type:"keyvalue",schma:schmaBdDonnesTableau});await S.del(_),await C()}async combinerDonnes({idTableauBase:r,idTableau2:_}){const E=await uneFois(async I=>await this.suivreDonnes({idTableau:r,f:I})),S=await uneFois(async I=>await this.suivreColonnesTableau({idTableau:r,f:I,catgories:!1}),I=>I!==void 0&&[...new Set(E.map(B=>Object.keys(B.donnes).filter(O=>O!=="id")).flat())].length<=I.length),C=await uneFois(async I=>await this.suivreDonnes({idTableau:_,f:I})),A=S.filter(I=>I.index).map(I=>I.id);for(const I of C){const B=E.find(O=>indexlmentsgaux(O.donnes,I.donnes,A));if(B){const O={};for(const N of S)B.donnes[N.id]===void 0&&I.donnes[N.id]!==void 0&&(O[N.id]=I.donnes[N.id]);Object.keys(O).length&&(await this.effacerlment({idTableau:r,idlment:B.id}),await this.ajouterlment({idTableau:r,vals:Object.assign({},B.donnes,O)}))}else await this.ajouterlment({idTableau:r,vals:I.donnes})}}async convertirDonnes({idTableau:r,donnes:_,conversions:E={},importerFichiers:S,cheminBaseFichiers:C,donnesExistantes:A}){const I=await uneFois(async X=>await this.suivreColonnesTableau({idTableau:r,f:X,catgories:!0})),B=new Set(A?.map(X=>I.filter(Q=>Q.catgorie?.catgorie==="chane").map(Q=>Q.catgorie?.type==="simple"?[X[Q.id]]:X[Q.id]).flat().filter(Q=>typeof Q=="string")).flat()||[]),O={},N=async({chemin:X})=>{try{if(new URL(X),O[X])return O[X];const Q=(await axios.get(X)).data,se=X.split("/"),oe=se.pop()||se.pop();if(!oe)throw new Error("Nom de fichier manquant.");const ue=await this.client.ajouterSFIP({nomFichier:oe,contenu:Q});O[X]=ue}catch{}if(isNode||isElectronMain){const Q=await __vitePreload(()=>Promise.resolve().then(()=>__viteBrowserExternal),void 0),se=await __vitePreload(()=>Promise.resolve().then(()=>path$1),void 0),oe=C?se.resolve(C,X):X;if(!Q.existsSync(oe))return;if(O[oe])return O[oe];const ue=Q.readFileSync(oe),we=await this.client.ajouterSFIP({nomFichier:se.basename(oe),contenu:ue});return O[X]=we,we}},U={},j=async({val:X,langue:Q})=>{if(U[Q]?.[X])return U[Q][X];for(const se of B){const{bd:oe,fOublier:ue}=await this.client.ouvrirBdType({id:se,type:"keyvalue",schma:schmaStructureBdNoms}),we=await oe.get(Q);if(await ue(),we===X)return U[Q]||(U[Q]={}),U[Q][X]=se,se}},z=async({val:X,langue:Q})=>{const{bd:se,fOublier:oe}=await this.client.ouvrirBdType({id:r,type:"keyvalue",schma:schmaStructureBdNoms}),we={address:se.access.address};await oe();const Te=await this.client.crerBdIndpendante({type:"keyvalue",optionsAccs:we}),{bd:xe,fOublier:Re}=await this.client.ouvrirBdType({id:Te,type:"keyvalue",schma:schmaStructureBdNoms});return await xe.set(Q,X),await Re(),B.add(Te),Te},Z=async({val:X,catgorie:Q,conversion:se})=>{switch(Q){case"audio":case"image":case"vido":case"fichier":return typeof X=="string"&&S?cidEtFichierValide(X)?X:await N({chemin:X})||X:X;case"boolen":return typeof X=="string"?X.toLowerCase()==="true":X;case"numrique":{let oe,ue;se?.type==="numrique"&&({opration:oe,systmeNumration:ue}=se);const we=({val:xe,ops:Re})=>{if(!Re)return xe;let Ne=xe;for(const Fe of Re)switch(Fe.op){case"+":Ne=xe+Fe.val;break;case"-":Ne=xe-Fe.val;break;case"*":Ne=xe*Fe.val;break;case"/":Ne=xe/Fe.val;break;case"^":Ne=xe**Fe.val;break;default:throw new Error(Fe.op)}return Ne};let Te;if(typeof X=="string")try{Te=this.client.ennikkai.({:X,:ue})}catch{}else typeof X=="number"&&(Te=X);return Te!==void 0?we({val:Te,ops:Array.isArray(oe)||typeof oe>"u"?oe:[oe]}):X}case"horoDatage":if(se?.type==="horoDatage"&&typeof X=="string"){const{systme:oe,format:ue}=se;return{systme:"dateJS",val:cholqij.lireDate({systme:oe,val:X,format:ue}).valueOf()}}else{if(["number","string"].includes(typeof X)){const oe=new Date(X);return isNaN(oe.valueOf())?X:{systme:"dateJS",val:oe.valueOf()}}return X}case"intervaleTemps":{const oe=typeof X=="string"?JSON.parse(X):X;return Array.isArray(oe)?await Promise.all(oe.map(async ue=>await Z({val:ue,catgorie:"horoDatage",conversion:se}))):oe}case"chaneNonTraductible":return X;case"chane":{if(typeof X!="string"||isValidAddress(X))return X;if(se?.type==="chane"){const{langue:oe}=se;return await j({val:X,langue:oe})||await z({val:X,langue:oe})}return X}case"gojson":return typeof X=="string"?JSON.parse(X):X;default:return X}};for(const X of _)for(const Q of I)if(Q.catgorie){const{type:se,catgorie:oe}=Q.catgorie,ue=X[Q.id];if(ue===void 0)continue;const we=E[Q.id];if(se==="simple")X[Q.id]=await Z({val:ue,catgorie:oe,conversion:we});else{const Te=typeof ue=="string"?JSON.parse(ue):ue;X[Q.id]=Array.isArray(Te)?await Promise.all(Te.map(async xe=>await Z({val:xe,catgorie:oe,conversion:we}))):[await Z({val:Te,catgorie:oe,conversion:we})]}}return _}async importerDonnes({idTableau:r,donnes:_,conversions:E={},cheminBaseFichiers:S}){const C=await uneFois(async O=>await this.suivreDonnes({idTableau:r,f:O})),A=await this.convertirDonnes({idTableau:r,donnes:_,conversions:E,importerFichiers:!0,cheminBaseFichiers:S,donnesExistantes:C.map(O=>O.donnes)}),I=[];for(const O of A)C.some(N=>lmentsgaux(N.donnes,O))||I.push(O);const B=[];for(const O of C)A.some(N=>lmentsgaux(N,O.donnes))||B.push(O.id);for(const O of B)await this.effacerlment({idTableau:r,idlment:O});for(const O of I)await this.ajouterlment({idTableau:r,vals:O})}async sauvegarderNomsTableau({idTableau:r,noms:_}){const E=await this.client.obtIdBd({nom:"noms",racine:r,type:"keyvalue"});if(!E)throw new Error(`Permission de modification refuse pour BD ${r}.`);const{bd:S,fOublier:C}=await this.client.ouvrirBdType({id:E,type:"keyvalue",schma:schmaStructureBdNoms});for(const A in _)await S.set(A,_[A]);await C()}async sauvegarderNomTableau({idTableau:r,langue:_,nom:E}){const S=await this.client.obtIdBd({nom:"noms",racine:r,type:"keyvalue"});if(!S)throw new Error(`Permission de modification refuse pour BD ${r}.`);const{bd:C,fOublier:A}=await this.client.ouvrirBdType({id:S,type:"keyvalue",schma:schmaStructureBdNoms});await C.set(_,E),await A()}async effacerNomTableau({idTableau:r,langue:_}){const E=await this.client.obtIdBd({nom:"noms",racine:r,type:"keyvalue"});if(!E)throw new Error(`Permission de modification refuse pour BD ${r}.`);const{bd:S,fOublier:C}=await this.client.ouvrirBdType({id:E,type:"keyvalue",schma:schmaStructureBdNoms});await S.del(_),await C()}async suivreNomsTableau({idTableau:r,f:_}){return await this.client.suivreBdDicDeClef({id:r,clef:"noms",schma:schmaStructureBdNoms,f:_})}async ajouterColonneTableau({idTableau:r,idVariable:_,idColonne:E}){const S=await this.client.obtIdBd({nom:"colonnes",racine:r,type:"keyvalue"});if(!S)throw new Error(`Permission de modification refuse pour BD ${r}.`);const{bd:C,fOublier:A}=await this.client.ouvrirBdType({id:S,type:"keyvalue",schma:schmaBdInfoColAvecCatgorie});E=E||v4();const I={id:E,variable:_};return await C.put(E,I),await A(),E}async effacerColonneTableau({idTableau:r,idColonne:_}){const E=await this.client.obtIdBd({nom:"colonnes",racine:r,type:"keyvalue"});if(!E)throw new Error(`Permission de modification refuse pour BD ${r}.`);const{bd:S,fOublier:C}=await this.client.ouvrirBdType({id:E,type:"keyvalue",schma:schmaBdInfoColAvecCatgorie});await S.del(_),await C()}async suivreColonnesTableau({idTableau:r,f:_,catgories:E=!1}){const S=async O=>{if(O)return await _(O)},C=async(O,N,U)=>O?await this.client.variables.suivreCatgorieVariable({idVariable:O,f:async j=>{const z=Object.assign({catgorie:j},U);await N(z)}}):faisRien,A=O=>O.variable,I=O=>O.id,B=async({id:O,fSuivreBd:N})=>await this.client.suivreBdsDeBdDic({id:O,f:N,fBranche:C,fIdBdDeBranche:A,fCode:I});return E?await this.client.suivreBdDeClef({id:r,clef:"colonnes",f:S,fSuivre:B}):await this.client.suivreBdDicDeClef({id:r,clef:"colonnes",schma:schmaBdInfoColAvecCatgorie,f:async O=>S(Object.values(O))})}async suivreVariables({idTableau:r,f:_}){const E=async C=>{await _((C||[]).filter(A=>A&&isValidAddress(A)))},S=async({id:C,fSuivreBd:A})=>await this.client.suivreBdListe({id:C,f:I=>A(I.map(B=>B.variable))});return await this.client.suivreBdDeClef({id:r,clef:"colonnes",f:E,fSuivre:S})}async ajouterRgleTableau({idTableau:r,idColonne:_,rgle:E}){const S=await this.client.obtIdBd({nom:"rgles",racine:r,type:"keyvalue"});if(!S)throw new Error(`Permission de modification refuse pour tableau ${r}.`);const{bd:C,fOublier:A}=await this.client.ouvrirBdType({id:S,type:"keyvalue",schma:schmaBdRgles}),I=v4(),O={rgle:{id:I,rgle:E},source:{type:"tableau",id:r},colonne:_};return await C.put(I,O),await A(),I}async effacerRgleTableau({idTableau:r,idRgle:_}){const E=await this.client.obtIdBd({nom:"rgles",racine:r,type:"keyvalue"});if(!E)throw new Error(`Permission de modification refuse pour tableau ${r}.`);const{bd:S,fOublier:C}=await this.client.ouvrirBdType({id:E,type:"keyvalue",schma:schmaBdRgles});await S.del(_),await C()}async suivreRgles({idTableau:r,f:_}){const E={},S=async()=>{if(!(!E.tableau||!E.variable))return await _([...E.tableau,...E.variable])},C=async Z=>(E.tableau=Object.values(Z),await S()),A=await this.client.suivreBdDicDeClef({id:r,clef:"rgles",schma:schmaBdRgles,f:C}),j=await suivreBdsDeFonctionListe({fListe:async Z=>await this.suivreColonnesTableau({idTableau:r,f:Z,catgories:!1}),f:async Z=>(E.variable=Z,await S()),fBranche:async(Z,X,Q)=>{const se=oe=>{const ue=oe.map(we=>({rgle:we,source:{type:"variable",id:Z},colonne:Q.id}));return X(ue)};return await this.client.variables.suivreRglesVariable({idVariable:Z,f:se})},fIdBdDeBranche:Z=>Z.variable,fCode:Z=>Z.id});return async()=>{await A(),await j()}}async suivreValidDonnes({idTableau:r,f:_}){const E={},S=async()=>{if(!E.donnes||!E.rgles)return;let X=[];for(const Q of E.rgles){const se=Q(E.donnes);X=[...X,...se.flat()]}await _(X)},C=async X=>{E.varsColonnes&&(E.rgles=X.map(Q=>gnrerFonctionRgle({rgle:Q.rgle,varsColonnes:E.varsColonnes,donnesCatgorie:Q.donnesCatgorie})),await S())},A=async X=>{E.donnes=X,await S()},I=await this.suivreColonnesTableau({idTableau:r,f:async X=>{const Q=X.reduce((se,oe)=>({...se,[oe.variable]:oe.id}),{});E.varsColonnes=Q,await S()},catgories:!1}),j=await suivreBdsDeFonctionListe({fListe:async X=>await this.suivreRgles({idTableau:r,f:X}),f:C,fBranche:async(X,Q,se)=>{if(se.rgle.rgle.typeRgle==="valeurCatgorique"&&se.rgle.rgle.dtails.type==="dynamique"){const{tableau:oe,colonne:ue}=se.rgle.rgle.dtails;return await this.suivreDonnes({idTableau:oe,f:async we=>await Q({rgle:se,donnesCatgorie:we.map(Te=>Te.donnes[ue])})})}else return await Q({rgle:se}),faisRien},fIdBdDeBranche:X=>X.rgle.id,fCode:X=>X.rgle.id}),z=await this.suivreDonnes({idTableau:r,f:A});return async()=>{await j(),await z(),await I()}}async suivreValidRgles({idTableau:r,f:_}){const E={},S=async()=>{if(!E.colonnes||!E.rgles)return;const z=[],Z=E.rgles.map(oe=>oe.rgle).filter(oe=>oe.rgle.rgle.typeRgle==="bornes"),X=Z.filter(oe=>oe.rgle.rgle.dtails.type==="dynamiqueColonne"),Q=Z.filter(oe=>oe.rgle.rgle.dtails.type==="dynamiqueVariable"),se=E.rgles.filter(oe=>oe.rgle.rgle.rgle.typeRgle==="valeurCatgorique"&&oe.rgle.rgle.rgle.dtails.type==="dynamique");for(const oe of X)if(!E.colonnes.find(we=>we.id===oe.rgle.rgle.dtails.val)){const we={rgle:oe,dtails:"colonneBornesInexistante"};z.push(we)}for(const oe of Q)if(!E.colonnes.find(we=>we.variable===oe.rgle.rgle.dtails.val)){const we={rgle:oe,dtails:"variableBornesNonPrsente"};z.push(we)}for(const oe of se)if(!oe.colsTableauRf?.find(we=>we.id===oe.rgle.rgle.rgle.dtails.colonne)){const we={rgle:oe.rgle,dtails:"colonneCatgInexistante"};z.push(we)}await _(z)},C=async z=>(E.rgles=z,await S()),A=await this.suivreColonnesTableau({idTableau:r,f:async z=>(E.colonnes=z,await S()),catgories:!1}),U=await suivreBdsDeFonctionListe({fListe:async z=>await this.suivreRgles({idTableau:r,f:z}),f:C,fBranche:async(z,Z,X)=>{if(X.rgle.rgle.typeRgle==="valeurCatgorique"&&X.rgle.rgle.dtails.type==="dynamique"){const{tableau:Q}=X.rgle.rgle.dtails;return await this.suivreColonnesTableau({idTableau:Q,f:se=>Z({rgle:X,colsTableauRf:se}),catgories:!1})}else return await Z({rgle:X}),faisRien},fIdBdDeBranche:z=>z.rgle.id,fCode:z=>z.rgle.id});return async()=>{await U(),await A()}}async effacerTableau({idTableau:r}){for(const _ of["noms","donnes","colonnes","rgles"]){const E=await this.client.obtIdBd({nom:_,racine:r});E&&await this.client.effacerBd({id:E})}await this.client.effacerBd({id:r})}}__decorate([cacheSuivi],Tableaux.prototype,"suivreDiffrencesAvecTableau",null);__decorate([cacheSuivi],Tableaux.prototype,"suivreIndex",null);__decorate([cacheSuivi],Tableaux.prototype,"suivreDonnes",null);__decorate([cacheSuivi],Tableaux.prototype,"suivreNomsTableau",null);__decorate([cacheSuivi],Tableaux.prototype,"suivreColonnesTableau",null);__decorate([cacheSuivi],Tableaux.prototype,"suivreVariables",null);__decorate([cacheSuivi],Tableaux.prototype,"suivreRgles",null);__decorate([cacheSuivi],Tableaux.prototype,"suivreValidDonnes",null);__decorate([cacheSuivi],Tableaux.prototype,"suivreValidRgles",null);const schmaBdPrincipale$3={type:"string"},schmaStructureBdVariable={type:"object",properties:{type:{type:"string",nullable:!0},catgorie:{type:"object",properties:{catgorie:{type:"string",nullable:!0},type:{type:"string",nullable:!0}},required:[],nullable:!0},noms:{type:"string",nullable:!0},descriptions:{type:"string",nullable:!0},units:{type:"string",nullable:!0},rgles:{type:"string",nullable:!0},statut:{type:"object",properties:{idNouvelle:{type:"string",nullable:!0},statut:{type:"string",nullable:!0}},required:[],nullable:!0}},required:[]},schmaBdRglesVariable={type:"object",additionalProperties:{type:"object",properties:{typeRgle:{type:"string"},dtails:{type:"object",required:[],additionalProperties:!0}},required:["dtails","typeRgle"]},required:[]};class Variables extends ComposanteClientListe{constructor({client:r}){super({client:r,clef:"variables",schmaBdPrincipale:schmaBdPrincipale$3})}async pingler(){await this.client.pingles.pinglerBd({id:await this.obtIdBd(),rcursif:!1,fichiers:!1})}async suivreVariables({f:r,idCompte:_}){return await this.suivreBdPrincipale({idCompte:_,f:r})}async crerVariable({catgorie:r}){const _=await this.client.crerBdIndpendante({type:"keyvalue",optionsAccs:{address:void 0,write:await this.client.obtIdCompte()}});await this.ajouterMesVariables({idVariable:_});const{bd:E,fOublier:S}=await this.client.ouvrirBdType({id:_,type:"keyvalue",schma:schmaStructureBdVariable}),C=E.access;if(!estUnContrleurConstellation(C))throw Error("Contrleur de type non reconnu.");const A={address:C.address};await E.set("type","variable");const I=await this.client.crerBdIndpendante({type:"keyvalue",optionsAccs:A});await E.set("noms",I);const B=await this.client.crerBdIndpendante({type:"keyvalue",optionsAccs:A});await E.set("descriptions",B);const O=await this.client.crerBdIndpendante({type:"keyvalue",optionsAccs:A});return await E.set("rgles",O),await E.set("catgorie",this.standardiserCatgorieVariable(r)),await this.tablirStatut({id:_,statut:{statut:"active"}}),S(),_}async ajouterMesVariables({idVariable:r}){const{bd:_,fOublier:E}=await this.obtBd();await _.add(r),await E()}async enleverDeMesVariables({idVariable:r}){const{bd:_,fOublier:E}=await this.obtBd();await _.del(r),await E()}async copierVariable({idVariable:r}){const{bd:_,fOublier:E}=await this.client.ouvrirBdType({id:r,type:"keyvalue",schma:schmaStructureBdVariable}),S=await _.get("catgorie"),C=await this.crerVariable({catgorie:S}),{bd:A,fOublier:I}=await this.client.ouvrirBdType({id:C,type:"keyvalue",schma:schmaStructureBdVariable}),B=await _.get("noms");if(B){const{bd:z,fOublier:Z}=await this.client.ouvrirBdType({id:B,type:"keyvalue",schma:schmaStructureBdNoms}),X=await z.allAsJSON();await Z(),await this.sauvegarderNomsVariable({idVariable:C,noms:X})}const O=await _.get("descriptions");if(O){const{bd:z,fOublier:Z}=await this.client.ouvrirBdType({id:O,type:"keyvalue",schma:schmaStructureBdNoms}),X=await z.allAsJSON();await Z(),await this.sauvegarderDescriptionsVariable({idVariable:C,descriptions:X})}const N=await _.get("units");N&&await A.put("units",N);const U=await _.get("rgles");if(U){const{bd:z,fOublier:Z}=await this.client.ouvrirBdType({id:U,type:"keyvalue",schma:schmaBdRglesVariable}),X=await z.allAsJSON();await Z(),await Promise.all(Object.entries(X).map(async([Q,se])=>{await this.ajouterRgleVariable({idVariable:C,rgle:se,idRgle:Q})}))}const j=await _.get("statut")||{statut:"active"};return await this.tablirStatut({id:C,statut:j}),await Promise.all([E(),I()]),C}async inviterAuteur({idVariable:r,idCompteAuteur:_,rle:E}){await this.client.donnerAccs({idBd:r,identit:_,rle:E})}async sauvegarderNomsVariable({idVariable:r,noms:_}){const E=await this.client.obtIdBd({nom:"noms",racine:r,type:"keyvalue"});if(!E)throw new Error(`Permission de modification refuse pour Variable ${r}.`);const{bd:S,fOublier:C}=await this.client.ouvrirBdType({id:E,type:"keyvalue",schma:schmaStructureBdNoms});for(const A in _)await S.set(A,_[A]);await C()}async sauvegarderNomVariable({idVariable:r,langue:_,nom:E}){const S=await this.client.obtIdBd({nom:"noms",racine:r,type:"keyvalue"});if(!S)throw new Error(`Permission de modification refuse pour variable ${r}.`);const{bd:C,fOublier:A}=await this.client.ouvrirBdType({id:S,type:"keyvalue",schma:schmaStructureBdNoms});await C.set(_,E),await A()}async effacerNomVariable({idVariable:r,langue:_}){const E=await this.client.obtIdBd({nom:"noms",racine:r,type:"keyvalue"});if(!E)throw new Error(`Permission de modification refuse pour Variable ${r}.`);const{bd:S,fOublier:C}=await this.client.ouvrirBdType({id:E,type:"keyvalue",schma:schmaStructureBdNoms});await S.del(_),await C()}async sauvegarderDescriptionsVariable({idVariable:r,descriptions:_}){const E=await this.client.obtIdBd({nom:"descriptions",racine:r,type:"keyvalue"});if(!E)throw new Error(`Permission de modification refuse pour Variable ${r}.`);const{bd:S,fOublier:C}=await this.client.ouvrirBdType({id:E,type:"keyvalue",schma:schmaStructureBdNoms});for(const A in _)await S.set(A,_[A]);await C()}async sauvegarderDescriptionVariable({idVariable:r,langue:_,description:E}){const S=await this.client.obtIdBd({nom:"descriptions",racine:r,type:"keyvalue"});if(!S)throw new Error(`Permission de modification refuse pour Variable ${r}.`);const{bd:C,fOublier:A}=await this.client.ouvrirBdType({id:S,type:"keyvalue",schma:schmaStructureBdNoms});await C.set(_,E),await A()}async effacerDescriptionVariable({idVariable:r,langue:_}){const E=await this.client.obtIdBd({nom:"descriptions",racine:r,type:"keyvalue"});if(!E)throw new Error(`Permission de modification refuse pour Variable ${r}.`);const{bd:S,fOublier:C}=await this.client.ouvrirBdType({id:E,type:"keyvalue",schma:schmaStructureBdNoms});await S.del(_),await C()}async sauvegarderCatgorieVariable({idVariable:r,catgorie:_}){const{bd:E,fOublier:S}=await this.client.ouvrirBdType({id:r,type:"keyvalue",schma:schmaStructureBdVariable});await E.set("catgorie",this.standardiserCatgorieVariable(_)),await S()}standardiserCatgorieVariable(r){return typeof r=="string"?{type:"simple",catgorie:r}:r}async sauvegarderUnitsVariable({idVariable:r,idUnit:_}){const{bd:E,fOublier:S}=await this.client.ouvrirBdType({id:r,type:"keyvalue",schma:schmaStructureBdVariable});await E.set("units",_),await S()}async ajouterRgleVariable({idVariable:r,rgle:_,idRgle:E}){const S=await this.client.obtIdBd({nom:"rgles",racine:r,type:"keyvalue"});if(!S)throw new Error(`Permission de modification refuse pour variable ${r}.`);E=E||v4();const{bd:C,fOublier:A}=await this.client.ouvrirBdType({id:S,type:"keyvalue",schma:schmaBdRglesVariable});return await C.put(E,_),await A(),E}async effacerRgleVariable({idVariable:r,idRgle:_}){const E=await this.client.obtIdBd({nom:"rgles",racine:r,type:"keyvalue"});if(!E)throw new Error(`Permission de modification refuse pour variable ${r}.`);const{bd:S,fOublier:C}=await this.client.ouvrirBdType({id:E,type:"keyvalue",schma:schmaBdRglesVariable});await S.del(_),await C()}async modifierRgleVariable({idVariable:r,rgleModifie:_,idRgle:E}){await this.effacerRgleVariable({idVariable:r,idRgle:E}),await this.ajouterRgleVariable({idVariable:r,rgle:_,idRgle:E})}async suivreNomsVariable({idVariable:r,f:_}){return await this.client.suivreBdDicDeClef({id:r,clef:"noms",schma:schmaStructureBdNoms,f:_})}async suivreDescriptionsVariable({idVariable:r,f:_}){return await this.client.suivreBdDicDeClef({id:r,clef:"descriptions",schma:schmaStructureBdNoms,f:_})}async suivreCatgorieVariable({idVariable:r,f:_}){return await this.client.suivreBd({id:r,type:"keyvalue",schma:schmaStructureBdVariable,f:async E=>{const S=await E.get("catgorie");S&&S.catgorie&&S.type&&await _(this.standardiserCatgorieVariable(S))}})}async suivreUnitsVariable({idVariable:r,f:_}){return await this.client.suivreBd({id:r,type:"keyvalue",schma:schmaStructureBdVariable,f:async E=>{const S=await E.get("units");await _(S||null)}})}async suivreRglesVariable({idVariable:r,f:_}){const E={catgorie:{},propres:{}},S=async()=>{await _(Object.entries(Object.assign({},E.catgorie,E.propres)).map(([N,U])=>({id:N,rgle:U})))},C=async N=>{const U={[v4()]:{typeRgle:"catgorie",dtails:{catgorie:N}}};E.catgorie=U,await S()},A=await this.suivreCatgorieVariable({idVariable:r,f:C}),I=async N=>{E.propres=N,await S()},B=await this.client.suivreBdDicDeClef({id:r,clef:"rgles",schma:schmaBdRglesVariable,f:I});return async()=>{await A(),await B()}}async suivreQualitVariable({idVariable:r,f:_}){const E={noms:{},descr:{},rgles:[]},S=async()=>{const U=[Object.keys(E.noms).length?1:0,Object.keys(E.descr).length?1:0];E.catgorie?.catgorie==="numrique"&&U.push(E.units?1:0),E.catgorie?.catgorie==="numrique"&&U.push(E.rgles.length>=1?1:0);const j=U.reduce((z,Z)=>z+Z,0)/U.length;await _(j)},C=await this.suivreNomsVariable({idVariable:r,f:async U=>{E.noms=U,await S()}}),A=await this.suivreDescriptionsVariable({idVariable:r,f:async U=>{E.descr=U,await S()}}),I=await this.suivreUnitsVariable({idVariable:r,f:async U=>{E.units=U,await S()}}),B=await this.suivreCatgorieVariable({idVariable:r,f:async U=>{E.catgorie=U,await S()}}),O=await this.suivreRglesVariable({idVariable:r,f:async U=>{E.rgles=U,await S()}});return async()=>{await Promise.all([C(),A(),I(),B(),O()])}}async tablirStatut({id:r,statut:_}){const{bd:E,fOublier:S}=await this.client.ouvrirBdType({id:r,type:"keyvalue",schma:schmaStructureBdVariable});await E.set("statut",_),await S()}async marquerObsolte({id:r,idNouvelle:_}){const{bd:E,fOublier:S}=await this.client.ouvrirBdType({id:r,type:"keyvalue",schma:schmaStructureBdVariable});E.set("statut",{statut:"obsolte",idNouvelle:_}),await S()}async effacerVariable({idVariable:r}){await this.enleverDeMesVariables({idVariable:r});for(const _ of["noms","descriptions","rgles"]){const E=await this.client.obtIdBd({nom:_,racine:r});E&&await this.client.effacerBd({id:E})}await this.client.effacerBd({id:r})}}__decorate([cacheSuivi],Variables.prototype,"suivreVariables",null);__decorate([cacheSuivi],Variables.prototype,"suivreNomsVariable",null);__decorate([cacheSuivi],Variables.prototype,"suivreDescriptionsVariable",null);__decorate([cacheSuivi],Variables.prototype,"suivreCatgorieVariable",null);__decorate([cacheSuivi],Variables.prototype,"suivreUnitsVariable",null);__decorate([cacheSuivi],Variables.prototype,"suivreRglesVariable",null);__decorate([cacheSuivi],Variables.prototype,"suivreQualitVariable",null);function baseSum$1(n,r){for(var _,E=-1,S=n.length;++E<S;){var C=r(n[E]);C!==void 0&&(_=_===void 0?C:_+C)}return _}var _baseSum=baseSum$1;function identity$5(n){return n}var identity_1=identity$5,baseSum=_baseSum,identity$4=identity_1;function sum$1(n){return n&&n.length?baseSum(n,identity$4):0}var sum_1=sum$1;const sum$2=getDefaultExportFromCjs(sum_1);var average$3=function(r){return r.reduce(sum,0)/r.length};function sum(n,r){return n+r}var average$2=average$3,variance$1=function(r){var _=average$2(r);function E(S,C){var A=C-_;return S+A*A}return r.reduce(E,0)/r.length},average$1=average$3,covariance$1=function(r,_){for(var E=r.length,S=0,C=average$1(r),A=average$1(_),I=[];S<E;S+=1){var B=r[S]-C,O=_[S]-A;I.push(B*O)}return average$1(I)},average=average$3,variance=variance$1,covariance=covariance$1,ssim=function(r,_,E){E=E||{};var S="K1"in E?E.K1:.01,C="K2"in E?E.K2:.03,A="L"in E?E.L:255,I="alpha"in E?E.alpha:1,B="beta"in E?E.beta:1,O="gamma"in E?E.gamma:1,N=S*A*(S*A),U=C*A*(C*A),j=U/2;function z(ue,we){var Te=average(ue),xe=average(we);return(2*Te*xe+N)/(Te*Te+xe*xe+N)}function Z(ue,we){var Te=variance(ue),xe=variance(we),Re=Math.sqrt(Te),Ne=Math.sqrt(xe);return(2*Re*Ne+U)/(Te+xe+U)}function X(ue,we){var Te=Math.sqrt(variance(ue)),xe=Math.sqrt(variance(we)),Re=covariance(ue,we);return(Re+j)/(Te*xe+j)}var Q=Math.pow(z(r,_),I),se=Math.pow(Z(r,_),B),oe=Math.pow(X(r,_),O);return Q*se*oe};const ssim$1=getDefaultExportFromCjs(ssim);function reverse(n){return n.split("").reverse().join("")}function findMatchStarts(n,r,_){const E=reverse(r);return _.map(S=>{const C=Math.max(0,S.end-r.length-S.errors),A=reverse(n.slice(C,S.end));return{start:findMatchEnds(A,E,S.errors).reduce((B,O)=>S.end-O.end<B?S.end-O.end:B,S.end),end:S.end,errors:S.errors}})}function oneIfNotZero(n){return(n|-n)>>31&1}function advanceBlock(n,r,_,E){let S=n.P[_],C=n.M[_];const A=E>>>31,I=r[_]|A,B=I|C,O=(I&S)+S^S|I;let N=C|~(O|S),U=S&O;const j=oneIfNotZero(N&n.lastRowMask[_])-oneIfNotZero(U&n.lastRowMask[_]);return N<<=1,U<<=1,U|=A,N|=oneIfNotZero(E)-A,S=U|~(B|N),C=N&B,n.P[_]=S,n.M[_]=C,j}function findMatchEnds(n,r,_){if(r.length===0)return[];_=Math.min(_,r.length);const E=[],S=32,C=Math.ceil(r.length/S)-1,A={P:new Uint32Array(C+1),M:new Uint32Array(C+1),lastRowMask:new Uint32Array(C+1)};A.lastRowMask.fill(1<<31),A.lastRowMask[C]=1<<(r.length-1)%S;const I=new Uint32Array(C+1),B=new Map,O=[];for(let j=0;j<256;j++)O.push(I);for(let j=0;j<r.length;j+=1){const z=r.charCodeAt(j);if(B.has(z))continue;const Z=new Uint32Array(C+1);B.set(z,Z),z<O.length&&(O[z]=Z);for(let X=0;X<=C;X+=1){Z[X]=0;for(let Q=0;Q<S;Q+=1){const se=X*S+Q;if(se>=r.length)continue;r.charCodeAt(se)===z&&(Z[X]|=1<<Q)}}}let N=Math.max(0,Math.ceil(_/S)-1);const U=new Uint32Array(C+1);for(let j=0;j<=N;j+=1)U[j]=(j+1)*S;U[C]=r.length;for(let j=0;j<=N;j+=1)A.P[j]=-1,A.M[j]=0;for(let j=0;j<n.length;j+=1){const z=n.charCodeAt(j);let Z;z<O.length?Z=O[z]:(Z=B.get(z),typeof Z>"u"&&(Z=I));let X=0;for(let Q=0;Q<=N;Q+=1)X=advanceBlock(A,Z,Q,X),U[Q]+=X;if(U[N]-X<=_&&N<C&&(Z[N+1]&1||X<0)){N+=1,A.P[N]=-1,A.M[N]=0;let Q;if(N===C){const se=r.length%S;Q=se===0?S:se}else Q=S;U[N]=U[N-1]+Q-X+advanceBlock(A,Z,N,X)}else for(;N>0&&U[N]>=_+S;)N-=1;N===C&&U[N]<=_&&(U[N]<_&&E.splice(0,E.length),E.push({start:-1,end:j+1,errors:U[N]}),_=U[N])}return E}function search(n,r,_){const E=findMatchEnds(n,r,_);return findMatchStarts(n,r,E)}const rechercherDansTexte=(n,r)=>{const E=search(r,n,Math.ceil(n.length/4)).sort((S,C)=>S.errors>C.errors?1:-1)[0];if(E)return{type:"texte",score:1/(E.errors+1),dbut:E.start,fin:E.end}},similTexte=(n,r)=>(Array.isArray(r)&&(r=Object.fromEntries(r.map(S=>[S,S]))),Object.entries(r).map(([S,C])=>{const A=rechercherDansTexte(n,C);if(A){const{score:I,dbut:B,fin:O}=A;return{type:"rsultat",score:I,clef:S,info:{type:"texte",texte:C,dbut:B,fin:O}}}}).filter(S=>S).sort((S,C)=>S.score>C.score?-1:1)[0]),similImages=(n,r)=>{if(!r)return 0;const{mssim:_}=ssim$1(n,r);return _},combinerRecherches=async(n,r,_,E)=>{const S=[],C=Object.fromEntries(Object.keys(n).map(I=>[I,void 0])),A=()=>{const I=Object.values(C).filter(B=>B).sort((B,O)=>aMieuxQueB(B,O)?-1:1)[0];E(I)};return await Promise.all(Object.entries(n).map(async([I,B])=>{const O=async N=>{C[I]=N,A()};S.push(await B(r,_,O))})),async()=>{await Promise.all(S.map(I=>I()))}},sousRecherche=async(n,r,_,E,S)=>await suivreBdsDeFonctionListe({fListe:r,f:async B=>{const O=meilleurRsultat(B);if(O){const N={type:"rsultat",de:n,clef:O.id,score:O.rsultat.score,info:{type:"rsultat",de:O.rsultat.de,info:O.rsultat.info}};O.rsultat.clef&&(N.info.clef=O.rsultat.clef),await S(N)}},fBranche:async(B,O)=>await _(E,B,async N=>{N&&O({id:B,rsultat:N})})}),aMieuxQueB=(n,r)=>{const _=(S,C)=>{for(;S.type==="rsultat";)S=S.info;for(;C.type==="rsultat";)C=C.info;const A=["vide","texte"],I=A.indexOf(S.type),B=A.indexOf(C.type);return I>B},E=(S,C)=>{for(;S.type==="rsultat";)S=S.info;for(;C.type==="rsultat";)C=C.info;switch(S.type){case"texte":return C.type==="texte"?S.fin-S.dbut>C.fin-C.dbut:!1;default:return!1}};return n.score>r.score?!0:n.score<r.score?!1:E(n.info,r.info)?!0:_(n.info,r.info)},meilleurRsultat=n=>Object.values(n).filter(_=>_).sort((_,E)=>aMieuxQueB(_.rsultat,E.rsultat)?-1:1)[0],rechercherSelonId=n=>async(r,_,E)=>{const S=rechercherDansTexte(n,_);if(S){const{score:C,dbut:A,fin:I}=S;await E({score:C,type:"rsultat",de:"id",info:{type:"texte",dbut:A,fin:I,texte:_}})}else await E();return faisRien},rechercherTous=()=>async(n,r,_)=>(await _({type:"rsultat",score:1,de:"*",info:{type:"vide"}}),faisRien),rechercherTousSiVide=n=>async(r,_,E)=>(n===""&&await E({type:"rsultat",score:1,de:"*",info:{type:"vide"}}),faisRien),rechercherProfilsSelonActivit=()=>async(n,r,_)=>{const E={noms:void 0,image:void 0,courriel:void 0},S=()=>({type:"rsultat",score:[Object.keys(E.noms||{}).length>0,E.image,E.courriel].filter(Boolean).length/3,de:"activit",info:{type:"vide"}}),C=j=>{E.noms=j,_(S())},A=j=>{E.image=j,_(S())},I=j=>{E.courriel=j,_(S())},B=await n.profil.suivreNoms({idCompte:r,f:C}),O=await n.profil.suivreImage({idCompte:r,f:A}),N=await n.profil.suivreCourriel({idCompte:r,f:I});return async()=>{await Promise.all([B(),O(),N()])}},rechercherProfilsSelonNom=n=>async(r,_,E)=>{const S=A=>{const I=similTexte(n,A);if(I){const{score:B,clef:O,info:N}=I;E({type:"rsultat",score:B,clef:O,info:N,de:"nom"})}else E()};return await r.profil.suivreNoms({idCompte:_,f:S})},rechercherProfilsSelonCourriel=n=>async(r,_,E)=>{const S=A=>{const I=A?rechercherDansTexte(n,A):void 0;if(I&&A){const{score:B,dbut:O,fin:N}=I;E({type:"rsultat",score:B,de:"courriel",info:{type:"texte",dbut:O,fin:N,texte:A}})}else E()};return await r.profil.suivreCourriel({idCompte:_,f:S})},rechercherProfilsSelonTexte=n=>async(r,_,E)=>{const S=rechercherProfilsSelonNom(n),C=rechercherProfilsSelonCourriel(n),A=rechercherSelonId(n),I=rechercherTousSiVide(n);return await combinerRecherches({noms:S,courriel:C,id:A,vide:I},r,_,E)},rechercherProfilsSelonImage=n=>async(r,_,E)=>{const S=A=>{const I=similImages(n,A);E({type:"rsultat",score:I,de:"image",info:{type:"vide"}})};return await r.profil.suivreImage({idCompte:_,f:S})},schmaBdPrincipaleRseau={type:"object",additionalProperties:{type:"string"},required:[]},INTERVALE_SALUT=1e3*10,FACTEUR_ATNUATION_CONFIANCE=.8,FACTEUR_ATNUATION_BLOQUS=.9,CONFIANCE_DE_COAUTEUR=.9,CONFIANCE_DE_FAVORIS=.7,DLAI_SESOUVENIR_MEMBRES_EN_LIGNE=1e3*60*60*24*30,N_DSIR_SOUVENIR_MEMBRES_EN_LIGNE=50;class Rseau extends ComposanteClientDic{client;bloqusPrivs;_ferm;dispositifsEnLigne;fsOublier;vnements;constructor({client:r}){super({client:r,clef:"rseau",schmaBdPrincipale:schmaBdPrincipaleRseau}),this.client=r,this.bloqusPrivs=new Set,this.dispositifsEnLigne={},this.fsOublier=[],this._ferm=!1,this.vnements=new eventsExports.EventEmitter}async initialiser(){const{sfip:r}=await this.client.attendreSfipEtOrbite(),_={},E=r.libp2p.services.pubsub;E.subscribe(this.client.sujet_rseau);const S=O=>{const N=O.detail.msg,U=v4();if(N.topic===this.client.sujet_rseau)try{const j=this.messageReu({msg:JSON.parse(new TextDecoder().decode(N.data))});_[U]=j,j.then(()=>{delete _[U]})}catch(j){console.error(j.toString()),console.error(j.stack.toString())}};E.addEventListener("gossipsub:message",S),this.fsOublier.push(async()=>{E.unsubscribe(this.client.sujet_rseau),E.removeEventListener("gossipsub:message",S),await Promise.all(Object.values(_))});const C=r.libp2p,A=()=>{this.vnements.emit("changementConnexions")},I=["peer:discovery","peer:connect","peer:disconnect"];for(const O of I)C.addEventListener(O,A);this.fsOublier.push(...I.map(O=>async()=>C.removeEventListener(O,A)));const B=setInterval(()=>{this.direSalut({})},INTERVALE_SALUT);this.fsOublier.unshift(async()=>clearInterval(B)),await this.direSalut({})}async pingler(){await this.client.pingles.pinglerBd({id:await this.obtIdBd(),rcursif:!1,fichiers:!1})}async envoyerMessageAuDispositif({msg:r,idSFIP:_}){_&&(r.destinataire=_);const E=this.client.sujet_rseau,{sfip:S}=await this.client.attendreSfipEtOrbite(),C=S.libp2p.services.pubsub,A=Buffer$4.from(JSON.stringify(r));await C.publish(E,A)}async envoyerMessageAuMembre({msg:r,idCompte:_,encrypt:E=!0}){const C={signature:await this.client.signer({message:JSON.stringify(r)}),valeur:r},A=Date.now(),I=Object.values(this.dispositifsEnLigne).filter(B=>B.infoDispositif.idCompte===_).filter(B=>B.vu&&A-B.vu<INTERVALE_SALUT+1e3*30);if(!I.length)throw new Error(`Aucun dispositif prsentement en ligne pour membre ${_}`);await Promise.all(I.map(async B=>{const{idSFIP:O,encryption:N}=B.infoDispositif;if(E){if(N?.type!==this.client.encryption.nom)return;const U=await this.client.encryption.encrypter({message:JSON.stringify(C),clefPubliqueDestinataire:N.clefPublique}),{publique:j}=await this.client.encryption.obtClefs(),z={encrypt:!0,clefPubliqueExpditeur:j,donnes:U};await this.envoyerMessageAuDispositif({msg:z,idSFIP:O})}else{const U={encrypt:!1,donnes:C};await this.envoyerMessageAuDispositif({msg:U,idSFIP:O})}}))}async direSalut({:r}){const _={type:"Salut !",contenu:{idSFIP:(await this.client.obtIdSFIP()).toString(),idDispositif:this.client.orbite.identity.id,clefPublique:this.client.orbite.identity.publicKey,signatures:this.client.orbite.identity.signatures,idCompte:await this.client.obtIdCompte()}},{publique:E}=await this.client.encryption.obtClefs();this.client.encryption&&(_.contenu.encryption={type:this.client.encryption.nom,clefPublique:E});const C={encrypt:!1,donnes:{signature:await this.client.signer({message:JSON.stringify(_)}),valeur:_}};try{await this.envoyerMessageAuDispositif({msg:C,idSFIP:r})}catch(A){if(!A.toString().includes("PublishError.InsufficientPeers"))throw A}}async envoyerDemandeRejoindreCompte({idCompte:r,codeSecret:_}){const E=await this.client.obtIdDispositif(),S={type:"Je veux rejoindre ce compte",contenu:{idDispositif:E,empreinteVrification:this.client.empreinteInvitation({idDispositif:E,codeSecret:_})}};await this.envoyerMessageAuMembre({msg:S,idCompte:r})}async messageReu({msg:r}){if(this._ferm)return;const{encrypt:_,destinataire:E}=r;if(E&&E!==(await this.client.obtIdSFIP()).toString())return;const S=_?JSON.parse(await this.client.encryption.dcrypter({message:r.donnes,clefPubliqueExpditeur:r.clefPubliqueExpditeur})):r.donnes,{valeur:C,signature:A}=S;if(A.clefPublique===this.client.orbite.identity.publicKey&&C.type!=="Salut !"||!await this.client.vrifierSignature({signature:A,message:JSON.stringify(C)}))return;const B=C.contenu;switch(C.type){case"Salut !":{const O=B,{clefPublique:N}=O;if(N!==A.clefPublique)return;await this.recevoirSalut({message:O}),E||await this.direSalut({:O.idSFIP});break}case"Je veux rejoindre ce compte":{const O=B;await this.client.considrerRequteRejoindreCompte({requte:O});break}}}async recevoirSalut({message:r}){await this._validerInfoMembre({info:r})&&(this.dispositifsEnLigne[r.idDispositif]={infoDispositif:r,vu:r.idDispositif===await this.client.obtIdDispositif()?void 0:new Date().getTime()},this.vnements.emit("membreVu"),await this._sauvegarderDispositifsEnLigne())}_nettoyerDispositifsEnLigne(){const r=new Date().getTime(),_=Object.values(this.dispositifsEnLigne).filter(C=>r-(C.vu||0)>DLAI_SESOUVENIR_MEMBRES_EN_LIGNE).sort((C,A)=>(C.vu||0)<(A.vu||0)?-1:1).map(C=>C.infoDispositif.idDispositif),E=Object.keys(this.dispositifsEnLigne).length-N_DSIR_SOUVENIR_MEMBRES_EN_LIGNE;_.slice(_.length-E).forEach(C=>delete this.dispositifsEnLigne[C])}async _sauvegarderDispositifsEnLigne(){this._nettoyerDispositifsEnLigne(),await this.client.sauvegarderAuStockageLocal({clef:"dispositifsEnLigne",val:JSON.stringify(this.dispositifsEnLigne)})}async _validerInfoMembre({info:r}){const{idCompte:_,signatures:E,clefPublique:S,idDispositif:C}=r;if(!(_&&E&&S&&C))return!1;const A=await this.client.vrifierSignature({signature:{signature:E.id,clefPublique:S},message:C}),I=await this.client.vrifierSignature({signature:{signature:E.publicKey,clefPublique:C},message:S+E.id});if(!isValidAddress(_))return!1;const{bd:B,fOublier:O}=await this.client.orbite.ouvrirBd({id:_});if(!estUnContrleurConstellation(B.access))return!1;const N=B.access.estAutoris(C);return await O(),A&&I&&N}async faireConfianceAuMembre({idCompte:r}){const{bd:_,fOublier:E}=await this.obtBd();await _.set(r,"FIABLE"),await E()}async nePlusFaireConfianceAuMembre({idCompte:r}){const{bd:_,fOublier:E}=await this.obtBd();Object.keys(await _.allAsJSON()).includes(r)&&await _.get(r)==="FIABLE"&&await _.del(r),await E()}async suivreFiables({f:r,idCompte:_}){const E=async S=>{const C=Object.keys(S).filter(A=>S[A]==="FIABLE");return await r(C)};return await this.suivreBdPrincipale({idCompte:_,f:E})}async _initaliserBloqusPrivs(){const r=await this.client.obtDeStockageLocal({clef:"membresBloqus"});r&&(JSON.parse(r).forEach(_=>this.bloqusPrivs.add(_)),this.vnements.emit("changementMembresBloqus"))}async _sauvegarderBloqusPrivs(){const r=[...this.bloqusPrivs];this.client.sauvegarderAuStockageLocal({clef:"membresBloqus",val:JSON.stringify(r)})}async bloquerMembre({idCompte:r,priv:_=!1}){if(_)await this.dbloquerMembre({idCompte:r}),this.bloqusPrivs.add(r),await this._sauvegarderBloqusPrivs();else{const{bd:E,fOublier:S}=await this.obtBd();await this.dbloquerMembre({idCompte:r}),await E.set(r,"BLOQU"),await S()}this.vnements.emit("changementMembresBloqus")}async dbloquerMembre({idCompte:r}){const{bd:_,fOublier:E}=await this.obtBd();Object.keys(await _.allAsJSON()).includes(r)&&await _.get(r)==="BLOQU"&&await _.del(r),await E(),this.bloqusPrivs.has(r)&&(this.bloqusPrivs.delete(r),await this._sauvegarderBloqusPrivs()),this.vnements.emit("changementMembresBloqus")}async suivreBloqusPubliques({f:r,idCompte:_}){const E=async S=>{const C=Object.keys(S).filter(A=>S[A]==="BLOQU");return await r(C)};return await this.suivreBdPrincipale({idCompte:_,f:E})}async suivreBloqus({f:r,idCompte:_}){const E=[];let S=[];const C=async()=>{const A=[...new Set([...[...this.bloqusPrivs].map(I=>({idCompte:I,priv:!0})),...S.map(I=>({idCompte:I,priv:!1}))])];return await r(A)};return E.push(await this.suivreBloqusPubliques({f:async A=>(S=A,await C()),idCompte:_})),(_===void 0||_===this.client.idCompte)&&(await this._initaliserBloqusPrivs(),this.vnements.on("changementMembresBloqus",C),E.push(async()=>{this.vnements.off("changementMembresBloqus",C)}),await C()),async()=>{await Promise.all(E.map(A=>A()))}}async suivreRelationsImmdiates({f:r,idCompte:_}){_=_||this.client.idCompte;const E=[],S={suivis:[],favoris:[],coauteursBds:[],coauteursProjets:[],coauteursVariables:[],coauteursMotsClefs:[]};let C=[];const A=async()=>{const z=[...S.suivis,...S.favoris,...S.coauteursBds,...S.coauteursProjets,...S.coauteursVariables,...S.coauteursMotsClefs,...C.map(Q=>({idCompte:Q,confiance:-1}))],X=[...new Set(z)].map(Q=>{const{idCompte:se}=Q;if(C.includes(se))return{idCompte:se,confiance:-1};const ue=1-z.filter(we=>we.idCompte===se).map(we=>we.confiance).map(we=>1-we).reduce((we,Te)=>Te*we,1);return{idCompte:se,confiance:ue}});return await r(X)};E.push(await this.suivreBloqus({f:async z=>{C=z.map(Z=>Z.idCompte),await A()},idCompte:_})),E.push(await this.client.suivreBdDicDeClef({id:_,clef:"rseau",schma:schmaBdPrincipaleRseau,f:async z=>(S.suivis=Object.entries(z).filter(([Z,X])=>X==="FIABLE").map(([Z,X])=>({idCompte:Z,confiance:1})),await A())}));const I=async(z,Z,X)=>{E.push(await suivreBdsDeFonctionListe({fListe:z,f:async Q=>(S[Z]=Q.map(se=>({idCompte:se,confiance:X})),await A()),fBranche:async(Q,se)=>await this.client.suivreAccsBd({id:Q,f:oe=>se(oe.map(ue=>ue.idCompte).filter(ue=>ue!==_))})}))};return await I(async z=>await this.suivreFavorisMembre({idCompte:_,f:Z=>z((Z||[]).map(X=>X.idObjet))}),"favoris",CONFIANCE_DE_FAVORIS),await I(async z=>await this.suivreBdsMembre({idCompte:_,f:Z=>z(Z||[])}),"coauteursBds",CONFIANCE_DE_COAUTEUR),await I(async z=>await this.suivreProjetsMembre({idCompte:_,f:Z=>z(Z||[])}),"coauteursProjets",CONFIANCE_DE_COAUTEUR),await I(async z=>await this.suivreVariablesMembre({idCompte:_,f:Z=>z(Z||[])}),"coauteursVariables",CONFIANCE_DE_COAUTEUR),await I(async z=>await this.suivreMotsClefsMembre({idCompte:_,f:Z=>z(Z||[])}),"coauteursMotsClefs",CONFIANCE_DE_COAUTEUR),async()=>{await Promise.all(E.map(z=>z()))}}async suivreRelationsConfiance({f:r,profondeur:_=1/0,idCompteDbut:E}){const S=E||await this.client.obtIdCompte(),C={},A={},I=new s$1;let B=!1;const O=se=>Object.entries(C).filter(([oe,ue])=>ue.relations.map(we=>we.idCompte).includes(se)).map(([oe,ue])=>oe),N=se=>{if(se===S)return 0;const oe=({ids:ue,p:we=1,djVues:Te=new Set})=>{const xe=ue.map(Re=>O(Re).filter(Ne=>!Te.has(Ne))).flat();return xe.includes(S)?we:xe.length?(Te=new Set(...Te,...xe),oe({ids:xe,p:we+1,djVues:Te})):1/0};return oe({ids:[se]})},U=async()=>{const se=[];for(const[oe,ue]of Object.entries(C))for(const we of ue.relations){const Te=N(oe)+1;se.push({de:oe,pour:we.idCompte,confiance:we.confiance,profondeur:Te})}return await r(se)},j=async se=>{C[se]={relations:[]};const oe=await this.suivreRelationsImmdiates({f:ue=>{C[se]&&(C[se].relations=ue,Z())},idCompte:se});A[se]=oe},z=async se=>{await A[se](),delete A[se],delete C[se]},Z=async()=>{if(B)return;await I.acquire("modification");const se=Object.keys(C).filter(ue=>N(ue)>=_),oe=[...new Set(Object.entries(C).filter(([ue,we])=>N(ue)+1<_).map(([ue,we])=>we.relations.map(Te=>Te.idCompte)).flat())].filter(ue=>!Object.keys(C).includes(ue));await Promise.all(se.map(ue=>z(ue))),await Promise.all(oe.map(ue=>j(ue))),await U(),I.release("modification")};return await j(S),{fOublier:async()=>{B=!0,await Promise.all(Object.values(A).map(se=>se()))},fChangerProfondeur:async se=>{_=se,await Z()}}}async suivreComptesRseau({f:r,profondeur:_,idCompteDbut:E}){const S=async C=>{C.push({de:this.client.idCompte,pour:this.client.idCompte,confiance:1,profondeur:0});const A={};C.forEach(B=>{Object.keys(A).includes(B.pour)||(A[B.pour]=[]),A[B.pour].push(B)});const I=Object.entries(A).map(([B,O])=>{const N=O.find(Q=>Q.de===this.client.idCompte);if(N?.confiance===1||N?.confiance===-1)return{idCompte:B,profondeur:N.pour===this.client.idCompte?0:1,confiance:N.confiance};const U=Math.min(...O.map(Q=>Q.profondeur)),j=O.filter(Q=>Q.confiance>=0),Z=1-O.filter(Q=>Q.confiance<0).map(Q=>1+Q.confiance*Math.pow(FACTEUR_ATNUATION_BLOQUS,Q.profondeur-1)).reduce((Q,se)=>se*Q,1),X=1-j.map(Q=>1-Q.confiance*Math.pow(FACTEUR_ATNUATION_CONFIANCE,Q.profondeur-1)).reduce((Q,se)=>se*Q,1)-Z;return{idCompte:B,profondeur:U,confiance:X}});return await r(I)};return await this.suivreRelationsConfiance({f:S,profondeur:_,idCompteDbut:E})}async suivreComptesRseauEtEnLigne({f:r,profondeur:_,idCompteDbut:E}){const S={rseau:[],enLigne:[]},C=async()=>{const U=[...S.rseau];return S.enLigne.forEach(j=>{U.find(z=>z.idCompte===j.idCompte)||U.push(j)}),await r(U)},A=await this.suivreConnexionsMembres({f:async U=>{const j=U.filter(z=>z.infoMembre.idCompte!==this.client.idCompte).map(z=>({idCompte:z.infoMembre.idCompte,profondeur:1/0,confiance:0}));return S.enLigne=j,await C()}}),I=async U=>(S.rseau=U,await C()),{fOublier:B,fChangerProfondeur:O}=await this.suivreComptesRseau({f:I,profondeur:_,idCompteDbut:E});return{fOublier:async()=>{await A(),await B()},fChangerProfondeur:O}}async suivreConfianceMonRseauPourMembre({idCompte:r,f:_,profondeur:E,idCompteRfrence:S}){const C=S||await this.client.obtIdCompte(),A=async I=>{const B=I.find(O=>O.idCompte===r);return await _(B?.confiance||0)};return await this.suivreComptesRseau({f:A,profondeur:E,idCompteDbut:C})}async suivreConnexionsPostesSFIP({f:r}){const _=async()=>{const{sfip:S}=await this.client.attendreSfipEtOrbite(),C=S.libp2p.getPeers(),A=S.libp2p.getConnections();return await r(C.map(I=>{const B=I.toString(),O=A.filter(N=>N.remotePeer.toString()===B).map(N=>N.remoteAddr.toString());return{pair:B,adresses:O}}))};return this.vnements.on("changementConnexions",_),await _(),async()=>{this.vnements.off("changementConnexions",_)}}async suivreConnexionsDispositifs({f:r}){const _={infoDispositif:{idSFIP:(await this.client.obtIdSFIP()).toString(),idDispositif:await this.client.obtIdDispositif(),idCompte:await this.client.obtIdCompte(),clefPublique:(await this.client.obtIdentitOrbite()).publicKey,encryption:{type:await this.client.encryption.obtNom(),clefPublique:(await this.client.encryption.obtClefs()).publique},signatures:(await this.client.obtIdentitOrbite()).signatures}},E=async()=>await r([...Object.values(this.dispositifsEnLigne),_]);return this.vnements.on("membreVu",E),await E(),async()=>{this.vnements.off("membreVu",E)}}async suivreConnexionsMembres({f:r}){return await suivreBdsDeFonctionListe({fListe:async S=>{const C=async A=>{const I={};for(const B of A){const{idCompte:O}=B.infoDispositif;I[O]||(I[O]={infoMembre:{idCompte:O,dispositifs:[]}});const{infoMembre:N,vu:U}=I[O];N.dispositifs.push(B.infoDispositif),I[O].vu=U?B.vu?Math.max(U,B.vu):U:B.vu}return await S(Object.values(I))};return await this.suivreConnexionsDispositifs({f:C})},f:r,fBranche:async(S,C,A)=>await this.suivreProtocolesMembre({idCompte:S,f:I=>{C({infoMembre:{...A.infoMembre,protocoles:Object.values(I).flat()},vu:A.vu})}}),fIdBdDeBranche:S=>S.infoMembre.idCompte,fCode:S=>S.infoMembre.idCompte})}async suivreProtocolesMembre({f:r,idCompte:_}){return await this.client.suivreBdDicDeClef({id:_||await this.client.obtIdCompte(),clef:"protocoles",schma:schmaStructureBdCompte,f:r})}async suivreProtocolesDispositif({idDispositif:r,f:_}){const E=r||await this.client.obtIdDispositif();return await suivreBdDeFonction({fRacine:async({fSuivreRacine:I})=>await this.suivreConnexionsDispositifs({f:async B=>{const O=B.find(N=>N.infoDispositif.idDispositif===E);if(O){const{idCompte:N}=O.infoDispositif;return await I(N)}else return await I(void 0)}}),f:async I=>{if(I)return await _(I[E])},fSuivre:async({id:I,fSuivreBd:B})=>await this.suivreProtocolesMembre({f:B,idCompte:I})})}async rechercher({f:r,nRsultatsDsirs:_=1/0,fRecherche:E,fConfiance:S,fQualit:C,fObjectif:A,fScore:I}){I||(I=Fe=>(Fe.confiance+Fe.qualit+Fe.objectif.score)/3),A=A||rechercherTous();const B={},O={},N=3e3;let U,j=3,z=!1;const Z=async Fe=>{j=Fe,await Te(Fe),U&&clearTimeout(U)},X=(Fe=N)=>{if(z)return;U&&clearTimeout(U);const ht=Object.values(B).map(Ge=>Ge.rsultats).flat().map(Ge=>Ge.rsultatObjectif.score),nt=ht.length>=_?Math.min(...ht.slice(0,_)):0,Ee=Object.values(B).reduce(function(Ge,je){return Ge[String(je.membre.profondeur)]=Ge[String(je.membre.profondeur)]||[],Ge[String(je.membre.profondeur)].push(...je.rsultats),Ge},{}),_e=Object.entries(Ee).sort((Ge,je)=>Number(Ge[0])<Number(je[0])?-1:1).map(Ge=>Ge[1]).map(Ge=>Ge.filter(je=>je.rsultatObjectif.score>=nt).length),Ie=_e.slice(_e.length-3),He=_e.slice(_e.length-4),Be=Math.max(3,sum$2(Ie)?j+1:sum$2(He)?j:j-1);Be>j?U=setTimeout(()=>Z(Be),Fe):Be<j&&Z(Be)},Q=async()=>{const ht=Object.values(B).map(nt=>nt.rsultats).flat().sort((nt,Ee)=>nt.rsultatObjectif.score<Ee.rsultatObjectif.score?1:-1);await r(ht.slice(0,_)),X()},se=async Fe=>{const{idCompte:ht}=Fe,nt=async Ie=>await E({idCompte:Fe.idCompte,fSuivi:async He=>await Ie(He||[])}),Ee=async Ie=>(B[ht].rsultats=Ie,await Q()),Ce=async(Ie,He)=>{const Be={id:Ie},Ge=async()=>{const{objectif:ct,confiance:Qe,qualit:dt}=Be;if(ct&&Qe!==void 0&&dt!==void 0){const vt={id:Ie,rsultatObjectif:{...ct,score:I(Be)}};return await He(vt)}else return await He(void 0)},je=async ct=>(Be.objectif=ct,await Ge()),Ve=await A(this.client,Ie,je),Me=await S(Ie,async ct=>(Be.confiance=ct,await Ge())),Ke=await C(Ie,async ct=>(Be.qualit=ct,await Ge()));return async()=>{await Promise.all([Ve(),Me(),Ke()])}};B[ht]={rsultats:[],membre:Fe,mettreJour:Q};const _e=await suivreBdsDeFonctionListe({fListe:nt,f:Ee,fBranche:Ce});O[ht]=_e},oe=async Fe=>{await O[Fe](),delete B[Fe],delete O[Fe],await Q()},ue=new s$1,we=async Fe=>{await ue.acquire("rechercher"),Fe=Fe.filter(Ce=>Ce.confiance>=0);const ht=Fe.filter(Ce=>!B[Ce.idCompte]),nt=Object.keys(B).filter(Ce=>!Fe.find(_e=>_e.idCompte===Ce)),Ee=Fe.filter(Ce=>{const _e=B[Ce.idCompte];return _e&&(Ce.confiance!==_e.membre.confiance||Ce.profondeur!==_e.membre.profondeur)});await Promise.all(ht.map(se)),await Promise.all(Ee.map(async Ce=>await B[Ce.idCompte].mettreJour(Ce))),await Promise.all(nt.map(Ce=>oe(Ce))),ue.release("rechercher")},{fChangerProfondeur:Te,fOublier:xe}=await this.suivreComptesRseauEtEnLigne({f:we,profondeur:j});return{fChangerN:async(Fe=1/0)=>{const ht=_;_=Fe,Fe!==ht&&(await Q(),X(0))},fOublier:async()=>{z=!0,U&&clearTimeout(U),await xe(),await Promise.all(Object.values(O).map(Fe=>Fe()))}}}async rechercherMembres({f:r,nRsultatsDsirs:_,fObjectif:E}){const S=async(I,B)=>{const{fOublier:O}=await this.suivreConfianceMonRseauPourMembre({idCompte:I,f:B,profondeur:4});return O},C=async({idCompte:I,fSuivi:B})=>(await B([I]),faisRien),A=async(I,B)=>await rechercherProfilsSelonActivit()(this.client,I,async N=>{await B(N?.score||0)});return await this.rechercher({f:r,nRsultatsDsirs:_,fRecherche:C,fConfiance:S,fQualit:A,fObjectif:E})}async suivreConfianceAuteurs({idItem:r,clef:_,f:E}){return await suivreBdsDeFonctionListe({fListe:async B=>await this.suivreAuteursObjet({idObjet:r,clef:_,f:async O=>{const N=O.filter(U=>U.accept).map(U=>U.idCompte);return await B(N)}}),f:async B=>{const O=B.reduce((N,U)=>N+U,0);await E(O)},fBranche:async(B,O)=>{const{fOublier:N}=await this.suivreConfianceMonRseauPourMembre({idCompte:B,f:O,profondeur:4});return N},fRduction:B=>B.flat()})}async rechercherObjets({f:r,clef:_,nRsultatsDsirs:E,fRecherche:S,fRechercheLesMiens:C,fQualit:A,fObjectif:I,toutLeRseau:B=!0}){if(!B){const U=I||rechercherTous();return await suivreBdsDeFonctionListe({fListe:async j=>({fOublier:await C(j),fChangerN:()=>Promise.resolve()}),f:r,fBranche:async(j,z)=>await U(this.client,j,z)})}const O=async({idCompte:U,fSuivi:j})=>{const z={propres:[],favoris:[]},Z=async()=>{const se=[...new Set([...z.propres,...z.favoris])];await j(se)},X=await S({idCompte:U,f:async se=>{z.propres=se||[],await Z()}}),Q=await this.suivreFavorisMembre({idCompte:U,f:async se=>{z.favoris=se?se.map(oe=>oe.idObjet):[],await Z()}});return async()=>{await X(),await Q()}},N=async(U,j)=>await this.suivreConfianceAuteurs({idItem:U,clef:_,f:j});return await this.rechercher({f:r,nRsultatsDsirs:E,fRecherche:O,fConfiance:N,fQualit:A,fObjectif:I})}async rechercherNues({f:r,nRsultatsDsirs:_,fObjectif:E,toutLeRseau:S=!0}){const C=this.suivreNuesMembre.bind(this),A=async(B,O)=>await this.client.nues.suivreQualitNue({idNue:B,f:O}),I=async B=>await this.client.nues.suivreNues({f:B});return await this.rechercherObjets({f:r,clef:"nues",nRsultatsDsirs:_,fRecherche:C,fRechercheLesMiens:I,fQualit:A,fObjectif:E,toutLeRseau:S})}async rechercherBds({f:r,nRsultatsDsirs:_,fObjectif:E,toutLeRseau:S=!0}){const C=this.suivreBdsMembre.bind(this),A=async(B,O)=>{const N=async U=>await O(U.total);return await this.client.bds.suivreQualitBd({idBd:B,f:N})},I=async B=>await this.client.bds.suivreBds({f:B});return await this.rechercherObjets({f:r,clef:"bds",nRsultatsDsirs:_,fRecherche:C,fRechercheLesMiens:I,fQualit:A,fObjectif:E,toutLeRseau:S})}async rechercherVariables({f:r,nRsultatsDsirs:_,fObjectif:E,toutLeRseau:S=!0}){const C=this.suivreVariablesMembre.bind(this),A=async(B,O)=>await this.client.variables.suivreQualitVariable({idVariable:B,f:O}),I=async B=>await this.client.variables.suivreVariables({f:B});return await this.rechercherObjets({f:r,clef:"variables",nRsultatsDsirs:_,fRecherche:C,fRechercheLesMiens:I,fQualit:A,fObjectif:E,toutLeRseau:S})}async rechercherMotsClefs({f:r,nRsultatsDsirs:_,fObjectif:E,toutLeRseau:S=!0}){const C=this.suivreMotsClefsMembre.bind(this),A=async(B,O)=>await this.client.motsClefs.suivreQualitMotClef({idMotClef:B,f:O}),I=async B=>await this.client.motsClefs.suivreMotsClefs({f:B});return await this.rechercherObjets({f:r,clef:"motsClefs",nRsultatsDsirs:_,fRecherche:C,fRechercheLesMiens:I,fQualit:A,fObjectif:E,toutLeRseau:S})}async rechercherProjets({f:r,nRsultatsDsirs:_,fObjectif:E,toutLeRseau:S=!0}){const C=this.suivreProjetsMembre.bind(this),A=async(B,O)=>await this.client.projets.suivreQualitProjet({idProjet:B,f:O}),I=async B=>await this.client.projets.suivreProjets({f:B});return await this.rechercherObjets({f:r,clef:"projets",nRsultatsDsirs:_,fRecherche:C,fRechercheLesMiens:I,fQualit:A,fObjectif:E,toutLeRseau:S})}async suivreAuteursObjet({idObjet:r,clef:_,f:E}){return await suivreBdsDeFonctionListe({fListe:async O=>await this.client.suivreAccsBd({id:r,f:O}),f:E,fBranche:async(O,N,U)=>{const j=async Z=>(Z=Z||[],N([{idCompte:U.idCompte,rle:U.rle,accept:Z.includes(r)}]));let z;switch(_){case"motsClefs":z=await this.client.motsClefs.suivreMotsClefs({f:j,idCompte:O});break;case"variables":z=await this.client.variables.suivreVariables({f:j,idCompte:O});break;case"bds":z=await this.client.bds.suivreBds({f:j,idCompte:O});break;case"nues":z=await this.client.nues.suivreNues({f:j,idCompte:O});break;case"projets":z=await this.client.projets.suivreProjets({f:j,idCompte:O});break;default:throw new Error(_)}return z},fIdBdDeBranche:O=>O.idCompte,fCode:O=>O.idCompte})}async suivreAuteursMotClef({idMotClef:r,f:_}){return await this.suivreAuteursObjet({idObjet:r,clef:"motsClefs",f:_})}async suivreAuteursVariable({idVariable:r,f:_}){return await this.suivreAuteursObjet({idObjet:r,clef:"variables",f:_})}async suivreAuteursBd({idBd:r,f:_}){return await this.suivreAuteursObjet({idObjet:r,clef:"bds",f:_})}async suivreAuteursProjet({idProjet:r,f:_}){return await this.suivreAuteursObjet({idObjet:r,clef:"projets",f:_})}async suivreAuteursNue({idNue:r,f:_}){return await this.suivreAuteursObjet({idObjet:r,clef:"nues",f:_})}async suivreObjetsMembre({idCompte:r,fListeObjets:_,fSuivi:E}){return await this.client.suivreBdsSelonCondition({fListe:_,fCondition:async(S,C)=>await this.client.suivreAccsBd({id:S,f:A=>C(A.map(I=>I.idCompte).includes(r))}),f:E})}async suivreBdsMembre({idCompte:r,f:_}){return await this.suivreObjetsMembre({idCompte:r,fListeObjets:async E=>await this.client.bds.suivreBds({f:E,idCompte:r}),fSuivi:_})}async suivreProjetsMembre({idCompte:r,f:_}){return await this.suivreObjetsMembre({idCompte:r,fListeObjets:async E=>await this.client.projets.suivreProjets({f:E,idCompte:r}),fSuivi:_})}async suivreFavorisMembre({idCompte:r,f:_}){return await this.client.favoris.suivreFavoris({f:_,idCompte:r})}async suivreVariablesMembre({idCompte:r,f:_}){return await this.suivreObjetsMembre({idCompte:r,fListeObjets:async E=>await this.client.variables.suivreVariables({f:E,idCompte:r}),fSuivi:_})}async suivreMotsClefsMembre({idCompte:r,f:_}){return await this.suivreObjetsMembre({idCompte:r,fListeObjets:async E=>await this.client.motsClefs.suivreMotsClefs({f:E,idCompte:r}),fSuivi:_})}async suivreNuesMembre({idCompte:r,f:_}){return await this.suivreObjetsMembre({idCompte:r,fListeObjets:async E=>await this.client.nues.suivreNues({f:E,idCompte:r}),fSuivi:_})}async suivreFavorisObjet({idObjet:r,f:_,profondeur:E}){const S=async I=>{const B=I.filter(O=>O.idObjet===r);await _(B)},C=async I=>{const B=async O=>await I([this.client.idCompte,...O.map(N=>N.idCompte)]);return await this.suivreComptesRseauEtEnLigne({f:B,profondeur:E,idCompteDbut:this.client.idCompte})},A=async(I,B)=>await this.suivreFavorisMembre({idCompte:I,f:O=>B(O?O.map(N=>({idCompte:I,...N})):void 0)});return await this.client.suivreBdsDeFonctionRecherche({fListe:C,f:S,fBranche:A})}async suivreRplications({idObjet:r,f:_,profondeur:E}){const S={connexionsMembres:[],connexionsDispositifs:[],favoris:[]},C=async()=>{const{connexionsMembres:Q,favoris:se}=S,oe=se.map(xe=>xe.favoris.idCompte),ue=Q.filter(xe=>oe.includes(xe.infoMembre.idCompte)),we=(await Promise.all(se.map(async xe=>{const{favoris:Re,dispositifs:Ne}=xe;return await Promise.all(Ne.map(async Fe=>{const ht=S.connexionsDispositifs.find(Ce=>Ce.infoDispositif.idDispositif===Fe)?.vu,nt=S.connexionsDispositifs.find(Ce=>Ce.infoDispositif.idDispositif===Fe)?.infoDispositif.idCompte;return{idObjet:r,idDispositif:Fe,idCompte:nt,bd:await this.client.favoris.estpinglSurDispositif({dispositifs:Re.dispositifs,idDispositif:Fe}),fichiers:await this.client.favoris.estpinglSurDispositif({dispositifs:Re.dispositifsFichiers,idDispositif:Fe}),rcursif:Re.rcursif,vu:ht}}))}))).flat();return await _({membres:ue,dispositifs:we})},A=await this.suivreConnexionsMembres({f:async Q=>(S.connexionsMembres=Q,await C())}),I=await this.suivreConnexionsDispositifs({f:async Q=>(S.connexionsDispositifs=Q,await C())}),B=async Q=>(S.favoris=Q,await C()),O=async Q=>await this.suivreFavorisObjet({idObjet:r,f:Q,profondeur:E}),N=async(Q,se,oe)=>{const ue=async Te=>await se({favoris:oe,dispositifs:Te}),we=await this.client.suivreDispositifs({f:ue,idCompte:Q});return async()=>{await we()}},U=Q=>Q.idCompte,j=Q=>Q.idCompte,{fOublier:z,fChangerProfondeur:Z}=await this.client.suivreBdsDeFonctionRecherche({fListe:O,f:B,fBranche:N,fIdBdDeBranche:U,fCode:j});return{fOublier:async()=>{await z(),await A(),await I()},fChangerProfondeur:Z}}async suivreBdsDeNue({idNue:r,f:_,nRsultatsDsirs:E}){const S=async(A,I)=>await this.client.bds.rechercherBdsParNue({idNue:r,f:I,idCompte:A}),C=async A=>await this.suivreComptesRseauEtEnLigne({f:async I=>await A(I.map(B=>B.idCompte)),profondeur:E});return await this.client.suivreBdsDeFonctionRecherche({fListe:C,f:_,fBranche:S})}async suivrelmentsDeTableauxUniques({idNueUnique:r,clef:_,f:E,nBds:S=100}){const C=async O=>{const N=async j=>await this.suivreBdsDeNue({idNue:r,f:j,nRsultatsDsirs:S}),U=async(j,z)=>await this.suivreAuteursBd({idBd:j,f:async Z=>{const X=Z.find(se=>se.accept)?.idCompte;return await z(X?{bd:j,idCompte:X}:void 0)}});return await this.client.suivreBdsDeFonctionRecherche({fListe:N,f:O,fBranche:U})},A=async(O,N,U)=>{const{idCompte:j}=U;return await suivreBdDeFonction({fRacine:async({fSuivreRacine:Q})=>await this.client.bds.suivreIdTableauParClef({idBd:O,clef:_,f:se=>{se&&Q(se)}}),f:async Q=>await N(Q||[]),fSuivre:async({id:Q,fSuivreBd:se})=>{const oe=async ue=>{const we=ue.map(Te=>({idCompte:j,lment:Te}));return await se(we)};return await this.client.tableaux.suivreDonnes({idTableau:Q,f:oe})}})},I=O=>O.bd,B=O=>O.bd;return await this.client.suivreBdsDeFonctionRecherche({fListe:C,f:E,fBranche:A,fIdBdDeBranche:I,fCode:B})}async fermer(){this._ferm=!0,await Promise.all(this.fsOublier.map(r=>r()))}}__decorate([cacheSuivi],Rseau.prototype,"suivreFiables",null);__decorate([cacheSuivi],Rseau.prototype,"suivreBloqusPubliques",null);__decorate([cacheSuivi],Rseau.prototype,"suivreBloqus",null);__decorate([cacheSuivi],Rseau.prototype,"suivreRelationsImmdiates",null);__decorate([cacheRechercheParProfondeur],Rseau.prototype,"suivreRelationsConfiance",null);__decorate([cacheRechercheParProfondeur],Rseau.prototype,"suivreComptesRseau",null);__decorate([cacheSuivi],Rseau.prototype,"suivreConnexionsPostesSFIP",null);__decorate([cacheSuivi],Rseau.prototype,"suivreConnexionsDispositifs",null);__decorate([cacheSuivi],Rseau.prototype,"suivreConnexionsMembres",null);__decorate([cacheSuivi],Rseau.prototype,"suivreProtocolesMembre",null);__decorate([cacheSuivi],Rseau.prototype,"suivreProtocolesDispositif",null);__decorate([cacheSuivi],Rseau.prototype,"suivreAuteursObjet",null);__decorate([cacheSuivi],Rseau.prototype,"suivreBdsMembre",null);__decorate([cacheSuivi],Rseau.prototype,"suivreProjetsMembre",null);__decorate([cacheSuivi],Rseau.prototype,"suivreFavorisMembre",null);__decorate([cacheSuivi],Rseau.prototype,"suivreVariablesMembre",null);__decorate([cacheSuivi],Rseau.prototype,"suivreMotsClefsMembre",null);__decorate([cacheSuivi],Rseau.prototype,"suivreNuesMembre",null);__decorate([cacheRechercheParNRsultats],Rseau.prototype,"suivreBdsDeNue",null);const importationAuth=__vitePreload(()=>import("./index-CQxI6A9X.js"),__vite__mapDeps([0,1])),importationCrypto=__vitePreload(()=>import("./index-DtVrj2pT.js").then(n=>n.y),__vite__mapDeps([])),verrouImportation=new s$1;let auth;const obtAuth=async()=>(await verrouImportation.acquire("auth"),auth||(auth=await importationAuth),verrouImportation.release("auth"),auth);let crypto$1;const obtCrypto=async()=>(await verrouImportation.acquire("crypto"),crypto$1||(crypto$1=await importationCrypto),verrouImportation.release("crypto"),crypto$1);class EncryptionLocalFirst{vnements;clefs;nom="local-first-auth";constructor(){this.vnements=new EventEmitter$3,obtAuth().then(({asymmetric:r})=>{const{publicKey:_,secretKey:E}=r.keyPair();this.clefs={secrte:E,publique:_},this.vnements.emit("clefs",this.clefs)})}async obtClefs(){return this.clefs||await new Promise(_=>{this.vnements.once("clefs",_)})}async encrypter({message:r,clefPubliqueDestinataire:_}){const{asymmetric:E}=await obtAuth(),S=await this.obtClefs();return E.encrypt({secret:r,recipientPublicKey:_,senderSecretKey:S.secrte}).toString()}async dcrypter({message:r,clefPubliqueExpditeur:_}){const{asymmetric:E}=await obtAuth(),S=await this.obtClefs();return E.decrypt({cipher:r,recipientSecretKey:S.secrte,senderPublicKey:_})}async clefAlatoire(r=6){const{randomKey:_}=await obtCrypto();return _(r)}async obtNom(){return this.nom}}const schmaBdPrincipale$2={type:"object",additionalProperties:{type:"object",properties:{dispositifs:{anyOf:[{type:"array",items:{type:"string"}},{type:"string"}]},dispositifsFichiers:{type:["array","string"],anyOf:[{type:"array",items:{type:"string"},nullable:!0},{type:"string",nullable:!0}],nullable:!0},rcursif:{type:"boolean"}},required:["dispositifs","rcursif"]},required:[]};class Favoris extends ComposanteClientDic{_promesseInit;oublierpingler;constructor({client:r}){super({client:r,clef:"favoris",schmaBdPrincipale:schmaBdPrincipale$2}),this._promesseInit=this._pinglerFavoris()}async pingler(){await this.client.pingles.pinglerBd({id:await this.obtIdBd(),rcursif:!1,fichiers:!1})}async _pinglerFavoris(){let r=[];const _=async S=>{const C=[];await Promise.all(Object.entries(S).map(async([I,B])=>{const O=await this.estpinglSurDispositif({dispositifs:B.dispositifs}),N=await this.estpinglSurDispositif({dispositifs:B.dispositifsFichiers});O&&await this.client.pingles.pinglerBd({id:I,rcursif:B.rcursif,fichiers:N}),C.push(I)}));const A=r.filter(I=>!C.includes(I));await Promise.all(A.map(async I=>await this.client.pingles.dspinglerBd({id:I}))),r=C},E=await this.suivreBdPrincipale({f:_});this.oublierpingler=E}async suivreFavoris({f:r,idCompte:_}){const E=async S=>{const C=Object.entries(S).map(([A,I])=>({idObjet:A,...I}));await r(C)};return await this.suivreBdPrincipale({idCompte:_,f:E})}async pinglerFavori({idObjet:r,dispositifs:_="TOUS",dispositifsFichiers:E="INSTALL",rcursif:S=!0}){const{bd:C,fOublier:A}=await this.obtBd(),I={rcursif:S,dispositifs:_};E&&(I.dispositifsFichiers=E),await C.put(r,I),await A()}async dspinglerFavori({idObjet:r}){const{bd:_,fOublier:E}=await this.obtBd();await _.del(r),await E()}async suivretatFavori({idObjet:r,f:_}){return await this.suivreBdPrincipale({f:E=>_(E[r])})}async suivreEstpinglSurDispositif({idObjet:r,f:_,idDispositif:E}){const S=async C=>{const A=await this.estpinglSurDispositif({dispositifs:C?.dispositifs,idDispositif:E}),I=await this.estpinglSurDispositif({dispositifs:C?.dispositifsFichiers,idDispositif:E});return await _({idObjet:r,bd:A,fichiers:I,rcursif:C?.rcursif||!1})};return await this.suivretatFavori({idObjet:r,f:S})}async estpinglSurDispositif({dispositifs:r,idDispositif:_}){return _=_||await this.client.obtIdDispositif(),r===void 0?!1:r==="TOUS"?!0:r==="INSTALL"?_===await this.client.obtIdDispositif()?isNode||isElectronMain:!1:typeof r=="string"?r===_:r.includes(_)}async fermer(){await this._promesseInit,this.oublierpingler&&await this.oublierpingler()}}__decorate([cacheSuivi],Favoris.prototype,"suivreFavoris",null);__decorate([cacheSuivi],Favoris.prototype,"suivretatFavori",null);__decorate([cacheSuivi],Favoris.prototype,"suivreEstpinglSurDispositif",null);const schmaStructureBdMotsClefsdeProjet={type:"string"},schmaStuctureBdsDeProjet={type:"string"},MAX_TAILLE_IMAGE$1=500*1e3,MAX_TAILLE_IMAGE_VIS$1=1500*1e3,schmaBdPrincipale$1={type:"string"},schmaStructureBdProjet={type:"object",properties:{type:{type:"string"},noms:{type:"string"},descriptions:{type:"string"},bds:{type:"string"},image:{type:"string",nullable:!0},motsClefs:{type:"string"},statut:{type:"object",properties:{statut:{type:"string"},idNouvelle:{type:"string",nullable:!0}},required:["statut"]},copiDe:{type:"object",properties:{id:{type:"string"}},required:["id"]}},required:["noms","descriptions","statut","type","bds","copiDe"]};class Projets extends ComposanteClientListe{constructor({client:r}){super({client:r,clef:"projets",schmaBdPrincipale:schmaBdPrincipale$1})}async pingler(){await this.client.pingles.pinglerBd({id:await this.obtIdBd(),rcursif:!1,fichiers:!1})}async suivreProjets({f:r,idCompte:_}){return await this.suivreBdPrincipale({idCompte:_,f:r})}async crerProjet(){const{bd:r,fOublier:_}=await this.client.ouvrirBdType({id:await this.obtIdBd(),type:"set",schma:schmaBdPrincipale$1}),E=await this.client.crerBdIndpendante({type:"keyvalue",optionsAccs:{address:void 0,write:await this.client.obtIdCompte()}}),{bd:S,fOublier:C}=await this.client.ouvrirBdType({id:E,type:"keyvalue",schma:schmaStructureBdProjet}),A=S.access;if(!estUnContrleurConstellation(A))throw Error("Contrleur de type non reconnu.");const I={address:A.address};await S.set("type","projet");const B=await this.client.crerBdIndpendante({type:"keyvalue",optionsAccs:I});await S.set("noms",B);const O=await this.client.crerBdIndpendante({type:"keyvalue",optionsAccs:I});await S.set("descriptions",O);const N=await this.client.crerBdIndpendante({type:"set",optionsAccs:I});await S.set("bds",N);const U=await this.client.crerBdIndpendante({type:"set",optionsAccs:I});return await S.set("motsClefs",U),await S.set("statut",{statut:"active"}),await r.add(E),await Promise.all([_(),C()]),E}async copierProjet({idProjet:r}){const{bd:_,fOublier:E}=await this.client.ouvrirBdType({id:r,type:"keyvalue",schma:schmaStructureBdProjet}),S=await this.crerProjet(),{bd:C,fOublier:A}=await this.client.ouvrirBdType({id:S,type:"keyvalue",schma:schmaStructureBdProjet}),I=await _.get("noms");if(I){const{bd:z,fOublier:Z}=await this.client.ouvrirBdType({id:I,type:"keyvalue",schma:schmaStructureBdNoms}),X=await z.allAsJSON();await Z(),await this.sauvegarderNomsProjet({idProjet:S,noms:X})}const B=await _.get("descriptions");if(B){const{bd:z,fOublier:Z}=await this.client.ouvrirBdType({id:B,type:"keyvalue",schma:schmaStructureBdNoms}),X=await z.allAsJSON();await Z(),await this.sauvegarderDescriptionsProjet({idProjet:S,descriptions:X})}const O=await _.get("motsClefs");if(O){const{bd:z,fOublier:Z}=await this.client.ouvrirBdType({id:O,type:"set",schma:schmaStructureBdMotsClefsdeProjet}),X=(await z.all()).map(Q=>Q.value);await Z(),await this.ajouterMotsClefsProjet({idProjet:S,idsMotsClefs:X})}const N=await _.get("bds");if(N){const{bd:z,fOublier:Z}=await this.client.ouvrirBdType({id:N,type:"set",schma:schmaStuctureBdsDeProjet}),X=(await z.all()).map(Q=>Q.value);await Z(),await Promise.all(X.map(async Q=>{await this.ajouterBdProjet({idProjet:S,idBd:Q})}))}const U=await _.get("statut")||{statut:"active"};await C.set("statut",U);const j=await _.get("image");return j&&await C.set("image",j),await C.set("copiDe",{id:r}),await Promise.all([E(),A()]),S}async ajouterMesProjets({idProjet:r}){const{bd:_,fOublier:E}=await this.client.ouvrirBdType({id:await this.obtIdBd(),type:"set",schma:schmaBdPrincipale$1});await _.add(r),await E()}async enleverDeMesProjets({idProjet:r}){const{bd:_,fOublier:E}=await this.client.ouvrirBdType({id:await this.obtIdBd(),type:"set",schma:schmaBdPrincipale$1});await _.del(r),await E()}async inviterAuteur({idProjet:r,idCompteAuteur:_,rle:E}){await this.client.donnerAccs({idBd:r,identit:_,rle:E})}async _obtBdNoms({idProjet:r}){const _=await this.client.obtIdBd({nom:"noms",racine:r,type:"keyvalue"});if(!_)throw new Error(`Permission de modification refuse pour Projet ${r}.`);return await this.client.ouvrirBdType({id:_,type:"keyvalue",schma:schmaStructureBdNoms})}async sauvegarderNomsProjet({idProjet:r,noms:_}){const{bd:E,fOublier:S}=await this._obtBdNoms({idProjet:r});for(const C in _)await E.set(C,_[C]);await S()}async sauvegarderNomProjet({idProjet:r,langue:_,nom:E}){const{bd:S,fOublier:C}=await this._obtBdNoms({idProjet:r});await S.set(_,E),await C()}async effacerNomProjet({idProjet:r,langue:_}){const{bd:E,fOublier:S}=await this._obtBdNoms({idProjet:r});await E.del(_),await S()}async _obtBdDescr({idProjet:r}){const _=await this.client.obtIdBd({nom:"descriptions",racine:r,type:"keyvalue"});if(!_)throw new Error(`Permission de modification refuse pour Projet ${r}.`);return await this.client.ouvrirBdType({id:_,type:"keyvalue",schma:schmaStructureBdNoms})}async sauvegarderDescriptionsProjet({idProjet:r,descriptions:_}){const{bd:E,fOublier:S}=await this._obtBdDescr({idProjet:r});for(const C in _)await E.set(C,_[C]);await S()}async sauvegarderDescriptionProjet({idProjet:r,langue:_,description:E}){const{bd:S,fOublier:C}=await this._obtBdDescr({idProjet:r});await S.set(_,E),await C()}async effacerDescriptionProjet({idProjet:r,langue:_}){const{bd:E,fOublier:S}=await this._obtBdDescr({idProjet:r});await E.del(_),await S()}async _obtBdMotsClefs({idProjet:r}){const _=await this.client.obtIdBd({nom:"motsClefs",racine:r,type:"set"});if(!_)throw new Error(`Permission de modification refuse pour projet ${r}.`);return await this.client.ouvrirBdType({id:_,type:"set",schma:schmaStructureBdMotsClefsdeProjet})}async ajouterMotsClefsProjet({idProjet:r,idsMotsClefs:_}){Array.isArray(_)||(_=[_]);const{bd:E,fOublier:S}=await this._obtBdMotsClefs({idProjet:r});await Promise.all(_.map(async C=>{(await E.all()).map(I=>I.value).includes(C)||await E.add(C)})),await S()}async effacerMotClefProjet({idProjet:r,idMotClef:_}){const{bd:E,fOublier:S}=await this._obtBdMotsClefs({idProjet:r});await E.del(_),await S()}async _obtBdBds({idProjet:r}){const _=await this.client.obtIdBd({nom:"bds",racine:r,type:"set"});if(!_)throw new Error(`Permission de modification refuse pour Projet ${r}.`);return await this.client.ouvrirBdType({id:_,type:"set",schma:schmaStructureBdMotsClefsdeProjet})}async ajouterBdProjet({idProjet:r,idBd:_}){const{bd:E,fOublier:S}=await this._obtBdBds({idProjet:r});await E.add(_),await S()}async effacerBdProjet({idProjet:r,idBd:_}){const{bd:E,fOublier:S}=await this._obtBdBds({idProjet:r});await E.del(_),await S()}async marquerObsolte({idProjet:r,idNouvelle:_}){const{bd:E,fOublier:S}=await this.client.ouvrirBdType({id:r,type:"keyvalue",schma:schmaStructureBdProjet});E.set("statut",{statut:"obsolte",idNouvelle:_}),await S()}async changerStatutProjet({idProjet:r,statut:_}){const{bd:E,fOublier:S}=await this.client.ouvrirBdType({id:r,type:"keyvalue",schma:schmaStructureBdProjet});E.set("statut",_),await S()}async marquerActif({idProjet:r}){const{bd:_,fOublier:E}=await this.client.ouvrirBdType({id:r,type:"keyvalue",schma:schmaStructureBdProjet});_.set("statut",{statut:"active"}),await E()}async marquerJouet({idProjet:r}){const{bd:_,fOublier:E}=await this.client.ouvrirBdType({id:r,type:"keyvalue",schma:schmaStructureBdProjet});_.set("statut",{statut:"jouet"}),await E()}async marquerInterne({idProjet:r}){const{bd:_,fOublier:E}=await this.client.ouvrirBdType({id:r,type:"keyvalue",schma:schmaStructureBdProjet});_.set("statut",{statut:"interne"}),await E()}async sauvegarderImage({idProjet:r,image:_}){if(_.contenu.byteLength>MAX_TAILLE_IMAGE$1)throw new Error("Taille maximale excde");const E=await this.client.ajouterSFIP(_),{bd:S,fOublier:C}=await this.client.ouvrirBdType({id:r,type:"keyvalue",schma:schmaStructureBdProjet});await S.set("image",E),await C()}async effacerImage({idProjet:r}){const{bd:_,fOublier:E}=await this.client.ouvrirBdType({id:r,type:"keyvalue",schma:schmaStructureBdProjet});await _.del("image"),await E()}async suivreImage({idProjet:r,f:_}){return await this.client.suivreBd({id:r,type:"keyvalue",schma:schmaStructureBdProjet,f:async E=>{const S=await E.get("image");if(S){const C=await this.client.obtFichierSFIP({id:S,max:MAX_TAILLE_IMAGE_VIS$1});return await _(C)}else return await _(null)}})}async suivreNomsProjet({idProjet:r,f:_}){return await this.client.suivreBdDicDeClef({id:r,clef:"noms",schma:schmaStructureBdNoms,f:_})}async suivreDescriptionsProjet({idProjet:r,f:_}){return await this.client.suivreBdDicDeClef({id:r,clef:"descriptions",schma:schmaStructureBdNoms,f:_})}async suivreMotsClefsProjet({idProjet:r,f:_}){const E={},S=async()=>{if(E.propres&&E.bds){const U=[...E.propres.map(j=>({idMotClef:j,source:"projet"})),...E.bds.map(j=>({idMotClef:j,source:"bds"}))];return await _(U)}},C=async U=>(E.propres=U,await S()),A=await this.client.suivreBdListeDeClef({id:r,clef:"motsClefs",schma:{type:"string"},f:C}),N=await suivreBdsDeFonctionListe({fListe:async U=>await this.suivreBdsProjet({idProjet:r,f:U}),f:async U=>(E.bds=U,await S()),fBranche:async(U,j)=>await this.client.bds.suivreMotsClefsBd({idBd:U,f:j})});return async()=>{await A(),await N()}}async suivreBdsProjet({idProjet:r,f:_}){return await this.client.suivreBdListeDeClef({id:r,clef:"bds",schma:{type:"string"},f:_})}async suivreVariablesProjet({idProjet:r,f:_}){const E=async A=>await _(A||[]),S=async(A,I)=>await this.client.bds.suivreVariablesBd({idBd:A,f:I}),C=async({id:A,fSuivreBd:I})=>await this.client.suivreBdsDeBdListe({id:A,f:I,fBranche:S});return await this.client.suivreBdDeClef({id:r,clef:"bds",f:E,fSuivre:C})}async suivreQualitProjet({idProjet:r,f:_}){return await suivreBdsDeFonctionListe({fListe:async I=>await this.suivreBdsProjet({idProjet:r,f:I}),f:async I=>await _(I.length?I.reduce((B,O)=>B+O,0)/I.length:0),fBranche:async(I,B)=>await this.client.bds.suivreQualitBd({idBd:I,f:O=>B(O.total)}),fRduction:I=>I.flat()})}async suivreDonnesExportation({idProjet:r,langues:_,f:E}){const S={},C=[],A=async()=>{const{nomsProjet:B,donnes:O}=S;if(!O)return;const N=r.split("/").pop(),U=B&&_&&traduire(B,_)||N;return await E({nomProjet:U,bds:O})},I=await suivreBdsDeFonctionListe({fListe:async B=>await this.suivreBdsProjet({idProjet:r,f:B}),f:async B=>{S.donnes=B,await A()},fBranche:async(B,O)=>await this.client.bds.suivreDonnesExportation({idBd:B,langues:_,f:O})});if(C.push(I),_){const B=await this.suivreNomsProjet({idProjet:r,f:async O=>{S.nomsProjet=O,await A()}});C.push(B)}return async()=>{await Promise.all(C.map(B=>B()))}}async exporterDonnes({idProjet:r,langues:_,nomFichier:E,patience:S=500}){const C=await uneFois(async I=>await this.suivreDonnesExportation({idProjet:r,langues:_,f:I}),attendreStabilit(S));E=E||C.nomProjet;const A=new Set;return C.bds.forEach(I=>{I.tableaux.forEach(B=>B.fichiersSFIP.forEach(O=>A.add(O)))}),{docs:C.bds.map(I=>{const B=utils.book_new();for(const O of I.tableaux){const N=utils.json_to_sheet(O.donnes);utils.book_append_sheet(B,N,O.nomTableau.slice(0,30))}return{doc:B,nom:I.nomBd}}),fichiersSFIP:A,nomFichier:E}}async exporterDocumentDonnes({donnes:r,formatDoc:_,dossier:E="",inclureFichiersSFIP:S=!0}){const{docs:C,fichiersSFIP:A,nomFichier:I}=r,O={xls:"biff8"}[_]||_,N=C.map(j=>({nom:`${j.nom}.${_}`,octets:writeSync(j.doc,{bookType:O,type:"buffer"})})),U=S?await Promise.all([...A].map(async j=>({nom:j.replace("/","-"),octets:await toBuffer(await this.client.obtItrableAsyncSFIP({id:j}))}))):[];await zipper(N,U,path.join(E,I))}async effacerProjet({idProjet:r}){await this.enleverDeMesProjets({idProjet:r});for(const _ of["noms","descriptions","motsClefs","bds"]){const E=await this.client.obtIdBd({nom:_,racine:r});E&&await this.client.effacerBd({id:E})}await this.client.effacerBd({id:r})}}__decorate([cacheSuivi],Projets.prototype,"suivreProjets",null);__decorate([cacheSuivi],Projets.prototype,"suivreImage",null);__decorate([cacheSuivi],Projets.prototype,"suivreNomsProjet",null);__decorate([cacheSuivi],Projets.prototype,"suivreDescriptionsProjet",null);__decorate([cacheSuivi],Projets.prototype,"suivreMotsClefsProjet",null);__decorate([cacheSuivi],Projets.prototype,"suivreBdsProjet",null);__decorate([cacheSuivi],Projets.prototype,"suivreVariablesProjet",null);__decorate([cacheSuivi],Projets.prototype,"suivreQualitProjet",null);const schmaBdPrincipale={type:"string"},schmaBdMotClef={type:"object",properties:{type:{type:"string",nullable:!0},noms:{type:"string",nullable:!0},descriptions:{type:"string",nullable:!0}},required:[]};class MotsClefs extends ComposanteClientListe{constructor({client:r}){super({client:r,clef:"motsClefs",schmaBdPrincipale})}async pingler(){const r=await this.obtIdBd();await this.client.pingles.pinglerBd({id:r,rcursif:!1,fichiers:!1})}async suivreMotsClefs({f:r,idCompte:_}){return await this.suivreBdPrincipale({idCompte:_,f:r})}async crerMotClef(){const r=await this.client.crerBdIndpendante({type:"keyvalue",optionsAccs:{address:void 0,write:await this.client.obtIdCompte()}});await this.ajouterMesMotsClefs({idMotClef:r});const{bd:_,fOublier:E}=await this.client.ouvrirBdType({id:r,type:"keyvalue",schma:schmaBdMotClef}),C={address:_.access.address};await _.set("type","motClef");const A=await this.client.crerBdIndpendante({type:"keyvalue",optionsAccs:C});await _.set("noms",A);const I=await this.client.crerBdIndpendante({type:"keyvalue",optionsAccs:C});return await _.set("descriptions",I),await E(),r}async ajouterMesMotsClefs({idMotClef:r}){const{bd:_,fOublier:E}=await this.obtBd();await _.add(r),await E()}async enleverDeMesMotsClefs({idMotClef:r}){const{bd:_,fOublier:E}=await this.obtBd();await _.del(r),await E()}async copierMotClef({idMotClef:r}){const{bd:_,fOublier:E}=await this.client.ouvrirBdType({id:r,type:"keyvalue",schma:schmaBdMotClef}),S=await this.crerMotClef(),C=await _.get("noms");if(C){const{bd:I,fOublier:B}=await this.client.ouvrirBdType({id:C,type:"keyvalue",schma:schmaStructureBdNoms}),O=await I.allAsJSON();await this.sauvegarderNomsMotClef({idMotClef:S,noms:O}),await B()}const A=await _.get("descriptions");if(A){const{bd:I,fOublier:B}=await this.client.ouvrirBdType({id:A,type:"keyvalue",schma:schmaStructureBdNoms}),O=await I.allAsJSON();await this.sauvegarderDescriptionsMotClef({idMotClef:S,descriptions:O}),await B()}return await E(),S}async inviterAuteur({idMotClef:r,idCompteAuteur:_,rle:E}){await this.client.donnerAccs({idBd:r,identit:_,rle:E})}async sauvegarderNomsMotClef({idMotClef:r,noms:_}){const E=await this.client.obtIdBd({nom:"noms",racine:r,type:"keyvalue"});if(!E)throw new Error(`Permission de modification refuse pour mot clef ${r}.`);const{bd:S,fOublier:C}=await this.client.ouvrirBdType({id:E,type:"keyvalue",schma:schmaStructureBdNoms});for(const A in _)await S.set(A,_[A]);await C()}async sauvegarderNomMotClef({idMotClef:r,langue:_,nom:E}){const S=await this.client.obtIdBd({nom:"noms",racine:r,type:"keyvalue"});if(!S)throw new Error(`Permission de modification refuse pour mot clef ${r}.`);const{bd:C,fOublier:A}=await this.client.ouvrirBdType({id:S,type:"keyvalue",schma:schmaStructureBdNoms});await C.set(_,E),await A()}async effacerNomMotClef({idMotClef:r,langue:_}){const E=await this.client.obtIdBd({nom:"noms",racine:r,type:"keyvalue"});if(!E)throw new Error(`Permission de modification refuse pour mot clef ${r}.`);const{bd:S,fOublier:C}=await this.client.ouvrirBdType({id:E,type:"keyvalue",schma:schmaStructureBdNoms});await S.del(_),await C()}async suivreNomsMotClef({idMotClef:r,f:_}){return await this.client.suivreBdDicDeClef({id:r,clef:"noms",schma:schmaStructureBdNoms,f:_})}async sauvegarderDescriptionsMotClef({idMotClef:r,descriptions:_}){const E=await this.client.obtIdBd({nom:"descriptions",racine:r,type:"keyvalue"});if(!E)throw new Error(`Permission de modification refuse pour mot clef ${r}.`);const{bd:S,fOublier:C}=await this.client.ouvrirBdType({id:E,type:"keyvalue",schma:schmaStructureBdNoms});for(const A in _)await S.set(A,_[A]);await C()}async sauvegarderDescriptionMotClef({idMotClef:r,langue:_,description:E}){const S=await this.client.obtIdBd({nom:"descriptions",racine:r,type:"keyvalue"});if(!S)throw new Error(`Permission de modification refuse pour mot clef ${r}.`);const{bd:C,fOublier:A}=await this.client.ouvrirBdType({id:S,type:"keyvalue",schma:schmaStructureBdNoms});await C.set(_,E),await A()}async effacerDescriptionMotClef({id:r,langue:_}){const E=await this.client.obtIdBd({nom:"descriptions",racine:r,type:"keyvalue"});if(!E)throw new Error(`Permission de modification refuse pour mot clef ${r}.`);const{bd:S,fOublier:C}=await this.client.ouvrirBdType({id:E,type:"keyvalue",schma:schmaStructureBdNoms});await S.del(_),await C()}async suivreDescriptionsMotClef({idMotClef:r,f:_}){return await this.client.suivreBdDicDeClef({id:r,clef:"descriptions",schma:schmaStructureBdNoms,f:_})}async effacerMotClef({idMotClef:r}){await this.enleverDeMesMotsClefs({idMotClef:r});for(const _ of["noms"]){const E=await this.client.obtIdBd({nom:_,racine:r});E&&await this.client.effacerBd({id:E})}await this.client.effacerBd({id:r})}async suivreQualitMotClef({idMotClef:r,f:_}){return await this.suivreNomsMotClef({idMotClef:r,f:E=>_(Object.keys(E).length?1:0)})}}__decorate([cacheSuivi],MotsClefs.prototype,"suivreMotsClefs",null);__decorate([cacheSuivi],MotsClefs.prototype,"suivreNomsMotClef",null);__decorate([cacheSuivi],MotsClefs.prototype,"suivreDescriptionsMotClef",null);__decorate([cacheSuivi],MotsClefs.prototype,"suivreQualitMotClef",null);const MAX_TAILLE_IMAGE=500*1e3,MAX_TAILLE_IMAGE_VIS=1500*1e3,schmaBdAutorisations={type:"object",additionalProperties:{type:"string"},required:[]},schmaStructureBdNue={type:"object",properties:{type:{type:"string",nullable:!0},mtadonnes:{type:"string",nullable:!0},noms:{type:"string",nullable:!0},descriptions:{type:"string",nullable:!0},motsClefs:{type:"string",nullable:!0},image:{type:"string",nullable:!0},tableaux:{type:"string",nullable:!0},autorisation:{type:"string",nullable:!0},statut:{type:"object",properties:{idNouvelle:{type:"string",nullable:!0},statut:{type:"string",nullable:!0}},required:[],nullable:!0},parent:{type:"string",nullable:!0},copiDe:{type:"string",nullable:!0}},required:[]},schmaStructureBdAuthorisation={type:"object",properties:{philosophie:{type:"string",nullable:!0},membres:{type:"string",nullable:!0}},required:[]},schmaBdMotsClefsNue={type:"string"};class Nues extends ComposanteClientListe{constructor({client:r}){super({client:r,clef:"nues",schmaBdPrincipale:{type:"string"}})}async pingler(){await this.client.pingles.pinglerBd({id:await this.obtIdBd(),rcursif:!1,fichiers:!1})}async crerNue({nueParent:r,autorisation:_="IJPC",ajouter:E=!0}){const S=await this.client.crerBdIndpendante({type:"keyvalue",optionsAccs:{address:void 0,write:await this.client.obtIdCompte()}});E&&await this.ajouterMesNues({idNue:S});const{bd:C,fOublier:A}=await this.client.ouvrirBdType({id:S,type:"keyvalue",schma:schmaStructureBdNue}),B={address:C.access.address};await C.set("type","nue");let O;if(isValidAddress(_))O=_;else if(_==="CJPI"||_==="IJPC")O=await this.gnrerGestionnaireAutorisations({philosophie:_});else throw new Error(`Autorisation non valide : ${_}`);await C.set("autorisation",O),_==="CJPI"&&await this.accepterMembreNue({idNue:S,idCompte:await this.client.obtIdCompte()});const N=await this.client.crerBdIndpendante({type:"keyvalue",optionsAccs:B});await C.set("noms",N);const U=await this.client.crerBdIndpendante({type:"keyvalue",optionsAccs:B});await C.set("descriptions",U);const j=await this.client.crerBdIndpendante({type:"ordered-keyvalue",optionsAccs:B});await C.set("tableaux",j);const z=await this.client.crerBdIndpendante({type:"keyvalue",optionsAccs:B});await C.set("mtadonnes",z);const Z=await this.client.crerBdIndpendante({type:"set",optionsAccs:B});return await C.set("motsClefs",Z),await C.set("statut",{statut:"active"}),r&&await C.set("parent",r),A(),S}async ajouterMesNues({idNue:r}){const{bd:_,fOublier:E}=await this.obtBd();await _.add(r),await E()}async enleverDeMesNues({idNue:r}){const{bd:_,fOublier:E}=await this.obtBd();await _.del(r),await E()}async copierNue({idNue:r,ajouterMesNues:_=!0}){const{bd:E,fOublier:S}=await this.client.ouvrirBdType({id:r,type:"keyvalue",schma:schmaStructureBdNue}),C=await E.get("parent"),A=await this.crerNue({nueParent:C,ajouter:_}),{bd:I,fOublier:B}=await this.client.ouvrirBdType({id:A,type:"keyvalue",schma:schmaStructureBdNue}),O=await E.get("mtadonnes");if(O){const{bd:se,fOublier:oe}=await this.client.ouvrirBdType({id:O,type:"keyvalue",schma:schmaStructureBdNoms}),ue=await se.allAsJSON();await oe(),await this.sauvegarderMtadonnesNue({idNue:A,mtadonnes:ue})}const N=await E.get("noms");if(N){const{bd:se,fOublier:oe}=await this.client.ouvrirBdType({id:N,type:"keyvalue",schma:schmaStructureBdNoms}),ue=await se.allAsJSON();await oe(),await this.sauvegarderNomsNue({idNue:A,noms:ue})}const U=await E.get("descriptions");if(U){const{bd:se,fOublier:oe}=await this.client.ouvrirBdType({id:U,type:"keyvalue",schma:schmaStructureBdNoms}),ue=await se.allAsJSON();await oe(),await this.sauvegarderDescriptionsNue({idNue:A,descriptions:ue})}const j=await E.get("motsClefs");if(j){const{bd:se,fOublier:oe}=await this.client.ouvrirBdType({id:j,type:"set",schma:schmaBdMotsClefsNue}),ue=(await se.all()).map(we=>we.value);await oe(),await this.ajouterMotsClefsNue({idNue:A,idsMotsClefs:ue})}const z=await E.get("tableaux"),Z=await I.get("tableaux");if(!Z)throw new Error("Erreur initialisation.");if(z){const{bd:se,fOublier:oe}=await this.client.ouvrirBdType({id:Z,type:"ordered-keyvalue",schma:schmaBdTableauxDeBd}),{bd:ue,fOublier:we}=await this.client.ouvrirBdType({id:z,type:"ordered-keyvalue",schma:schmaBdTableauxDeBd}),Te=await ue.all();await we();for(const xe of Te){const Re=await this.client.tableaux.copierTableau({id:xe.key,idBd:A,copierDonnes:!1});await se.set(Re,xe.value)}await oe()}const X=await E.get("statut")||{statut:"active"};await I.set("statut",X);const Q=await E.get("image");return Q&&await I.set("image",Q),await I.set("copiDe",r),await Promise.all([S(),B()]),A}async suivreNues({f:r,idCompte:_}){return await this.suivreBdPrincipale({f:r,idCompte:_})}async suivreDeParents({idNue:r,f:_,fParents:E}){return await suivreBdsDeFonctionListe({fListe:async S=>await this.suivreNuesParents({idNue:r,f:C=>S([r,...C].reverse())}),f:_,fBranche:E,fRduction:S=>S})}async sauvegarderMtadonneNue({idNue:r,clef:_,valeur:E}){const S=await this.client.obtIdBd({nom:"mtadonnes",racine:r,type:"keyvalue"});if(!S)throw new Error(`Permission de modification refuse pour Nue ${r}.`);const{bd:C,fOublier:A}=await this.client.ouvrirBdType({id:S,type:"keyvalue",schma:schmaStructureBdMtadonnes});await C.set(_,E),await A()}async sauvegarderMtadonnesNue({idNue:r,mtadonnes:_}){const E=await this.client.obtIdBd({nom:"mtadonnes",racine:r,type:"keyvalue"});if(!E)throw new Error(`Permission de modification refuse pour Nue ${r}.`);const{bd:S,fOublier:C}=await this.client.ouvrirBdType({id:E,type:"keyvalue",schma:schmaStructureBdMtadonnes});for(const A in _)await S.set(A,_[A]);await C()}async effacerMtadonneNue({idNue:r,clef:_}){const E=await this.client.obtIdBd({nom:"mtadonnes",racine:r,type:"keyvalue"});if(!E)throw new Error(`Permission de modification refuse pour Nue ${r}.`);const{bd:S,fOublier:C}=await this.client.ouvrirBdType({id:E,type:"keyvalue",schma:schmaStructureBdMtadonnes});await S.del(_),await C()}async suivreMtadonnesNue({idNue:r,f:_}){const E=async S=>{await _(Object.assign({},...S))};return await this.suivreDeParents({idNue:r,f:E,fParents:async(S,C)=>await this.client.suivreBdDicDeClef({id:S,clef:"mtadonnes",schma:schmaStructureBdMtadonnes,f:C})})}async sauvegarderNomNue({idNue:r,langue:_,nom:E}){const S=await this.client.obtIdBd({nom:"noms",racine:r,type:"keyvalue"});if(!S)throw new Error(`Permission de modification refuse pour Nue ${r}.`);const{bd:C,fOublier:A}=await this.client.ouvrirBdType({id:S,type:"keyvalue",schma:schmaStructureBdNoms});await C.set(_,E),await A()}async sauvegarderNomsNue({idNue:r,noms:_}){const E=await this.client.obtIdBd({nom:"noms",racine:r,type:"keyvalue"});if(!E)throw new Error(`Permission de modification refuse pour Nue ${r}.`);const{bd:S,fOublier:C}=await this.client.ouvrirBdType({id:E,type:"keyvalue",schma:schmaStructureBdNoms});for(const A in _)await S.set(A,_[A]);await C()}async effacerNomNue({idNue:r,langue:_}){const E=await this.client.obtIdBd({nom:"noms",racine:r,type:"keyvalue"});if(!E)throw new Error(`Permission de modification refuse pour Nue ${r}.`);const{bd:S,fOublier:C}=await this.client.ouvrirBdType({id:E,type:"keyvalue",schma:schmaStructureBdNoms});await S.del(_),await C()}async suivreNomsNue({idNue:r,f:_}){const E=async S=>{await _(Object.assign({},...S))};return await this.suivreDeParents({idNue:r,f:E,fParents:async(S,C)=>await this.client.suivreBdDicDeClef({id:S,clef:"noms",schma:schmaStructureBdNoms,f:C})})}async sauvegarderDescriptionNue({idNue:r,langue:_,description:E}){const S=await this.client.obtIdBd({nom:"descriptions",racine:r,type:"keyvalue"});if(!S)throw new Error(`Permission de modification refuse pour Nue ${r}.`);const{bd:C,fOublier:A}=await this.client.ouvrirBdType({id:S,type:"keyvalue",schma:schmaStructureBdNoms});await C.set(_,E),await A()}async sauvegarderDescriptionsNue({idNue:r,descriptions:_}){const E=await this.client.obtIdBd({nom:"descriptions",racine:r,type:"keyvalue"});if(!E)throw new Error(`Permission de modification refuse pour BD ${r}.`);const{bd:S,fOublier:C}=await this.client.ouvrirBdType({id:E,type:"keyvalue",schma:schmaStructureBdNoms});for(const A in _)await S.set(A,_[A]);await C()}async effacerDescriptionNue({idNue:r,langue:_}){const E=await this.client.obtIdBd({nom:"descriptions",racine:r,type:"keyvalue"});if(!E)throw new Error(`Permission de modification refuse pour BD ${r}.`);const{bd:S,fOublier:C}=await this.client.ouvrirBdType({id:E,type:"keyvalue",schma:schmaStructureBdNoms});await S.del(_),await C()}async suivreDescriptionsNue({idNue:r,f:_}){const E=async S=>{await _(Object.assign({},...S))};return await this.suivreDeParents({idNue:r,f:E,fParents:async(S,C)=>await this.client.suivreBdDicDeClef({id:S,clef:"descriptions",schma:schmaStructureBdNoms,f:C})})}async sauvegarderImage({idNue:r,image:_}){if(_.contenu.byteLength>MAX_TAILLE_IMAGE)throw new Error("Taille maximale excde");const E=await this.client.ajouterSFIP(_),{bd:S,fOublier:C}=await this.client.ouvrirBdType({id:r,type:"keyvalue",schma:schmaStructureBdNue});await S.set("image",E),await C()}async effacerImage({idNue:r}){const{bd:_,fOublier:E}=await this.client.ouvrirBdType({id:r,type:"keyvalue",schma:schmaStructureBdNue});await _.del("image"),await E()}async suivreImage({idNue:r,f:_}){return await this.client.suivreBd({id:r,type:"keyvalue",schma:schmaStructureBdNue,f:async E=>{const S=await E.get("image");if(!S)await _(null);else{const C=await this.client.obtFichierSFIP({id:S,max:MAX_TAILLE_IMAGE_VIS});await _(C)}}})}async ajouterMotsClefsNue({idNue:r,idsMotsClefs:_}){Array.isArray(_)||(_=[_]);const E=await this.client.obtIdBd({nom:"motsClefs",racine:r,type:"set"});if(!E)throw new Error(`Permission de modification refuse pour BD ${r}.`);const{bd:S,fOublier:C}=await this.client.ouvrirBdType({id:E,type:"set",schma:schmaBdMotsClefsNue});for(const A of _)(await S.all()).map(B=>B.value).includes(A)||await S.add(A);await C()}async effacerMotClefNue({idNue:r,idMotClef:_}){const E=await this.client.obtIdBd({nom:"motsClefs",racine:r,type:"set"});if(!E)throw new Error(`Permission de modification refuse pour BD ${r}.`);const{bd:S,fOublier:C}=await this.client.ouvrirBdType({id:E,type:"set",schma:schmaBdMotsClefsNue});await S.del(_),await C()}async suivreMotsClefsNue({idNue:r,f:_}){const E=async S=>{await _([...new Set(S.flat())])};return await this.suivreDeParents({idNue:r,f:E,fParents:async(S,C)=>await this.client.suivreBdListeDeClef({id:S,clef:"motsClefs",schma:{type:"string"},f:C})})}async changerStatutNue({idNue:r,statut:_}){const{bd:E,fOublier:S}=await this.client.ouvrirBdType({id:r,type:"keyvalue",schma:schmaStructureBdNue});E.set("statut",_),await S()}async suivreStatutNue({idNue:r,f:_}){return await this.client.suivreBdDic({id:r,f:async E=>{if(E.statut)return await _(E.statut)},schma:schmaStructureBdNue})}async marquerObsolte({idNue:r,idNouvelle:_}){const{bd:E,fOublier:S}=await this.client.ouvrirBdType({id:r,type:"keyvalue",schma:schmaStructureBdNue});E.set("statut",{statut:"obsolte",idNouvelle:_}),await S()}async marquerActive({idNue:r}){const{bd:_,fOublier:E}=await this.client.ouvrirBdType({id:r,type:"keyvalue",schma:schmaStructureBdNue});_.set("statut",{statut:"active"}),await E()}async marquerJouet({idNue:r}){const{bd:_,fOublier:E}=await this.client.ouvrirBdType({id:r,type:"keyvalue",schma:schmaStructureBdNue});_.set("statut",{statut:"jouet"}),await E()}async marquerInterne({idNue:r}){const{bd:_,fOublier:E}=await this.client.ouvrirBdType({id:r,type:"keyvalue",schma:schmaStructureBdNue});_.set("statut",{statut:"interne"}),await E()}async inviterAuteur({idNue:r,idCompteAuteur:_,rle:E}){await this.client.donnerAccs({idBd:r,identit:_,rle:E})}async gnrerGestionnaireAutorisations({philosophie:r="IJPC"}){const _=await this.client.crerBdIndpendante({type:"keyvalue",optionsAccs:{write:await this.client.obtIdCompte()}}),{bd:E,fOublier:S}=await this.client.ouvrirBdType({id:_,type:"keyvalue",schma:schmaStructureBdAuthorisation});await E.set("philosophie",r);const A={address:E.access.address},I=await this.client.crerBdIndpendante({type:"keyvalue",optionsAccs:A});return await E.set("membres",I),S(),_}async changerPhisolophieAutorisation({idAutorisation:r,philosophie:_}){const{bd:E,fOublier:S}=await this.client.ouvrirBdType({id:r,type:"keyvalue",schma:schmaStructureBdAuthorisation});await E.set("philosophie",_),S()}async suivrePhilosophieAutorisation({idNue:r,f:_}){return await suivreBdDeFonction({fRacine:async({fSuivreRacine:A})=>await this.suivreGestionnaireAutorisations({idNue:r,f:A}),f:async A=>{if(!A)return;const I=await A.get("philosophie");I&&["IJPC","CJPI"].includes(I)&&await _(I)},fSuivre:async({id:A,fSuivreBd:I})=>await this.client.suivreBd({id:A,type:"keyvalue",schma:schmaStructureBdAuthorisation,f:I})})}async accepterMembreAutorisation({idAutorisation:r,idCompte:_}){const E=await this.client.obtIdBd({nom:"membres",racine:r,type:"keyvalue"});if(!E)throw new Error(`Permission de modification refuse pour groupe d'autorisation ${r}.`);const{bd:S,fOublier:C}=await this.client.ouvrirBdType({id:E,type:"keyvalue",schma:schmaBdAutorisations});await S.set(_,"accept"),C()}async accepterMembreNue({idNue:r,idCompte:_}){const E=await this.obtGestionnaireAutorisationsDeNue({idNue:r});return await this.accepterMembreAutorisation({idAutorisation:E,idCompte:_})}async exclureMembreAutorisation({idAutorisation:r,idCompte:_}){const E=await this.client.obtIdBd({nom:"membres",racine:r,type:"keyvalue"});if(!E)throw new Error(`Permission de modification refuse pour groupe d'autorisation ${r}.`);const{bd:S,fOublier:C}=await this.client.ouvrirBdType({id:E,type:"keyvalue",schma:schmaBdAutorisations});await S.set(_,"exclus"),C()}async exclureMembreDeNue({idNue:r,idCompte:_}){const E=await this.obtGestionnaireAutorisationsDeNue({idNue:r});return await this.exclureMembreAutorisation({idAutorisation:E,idCompte:_})}async suivreGestionnaireAutorisations({idNue:r,f:_}){return await this.client.suivreBd({id:r,type:"keyvalue",schma:schmaStructureBdNue,f:async E=>{const S=await E.get("autorisation");await _(S)}})}async changerGestionnaireAutorisations({idNue:r,idAutorisation:_}){const{bd:E,fOublier:S}=await this.client.ouvrirBdType({id:r,type:"keyvalue",schma:schmaStructureBdNue});await E.set("autorisation",_),S()}async obtGestionnaireAutorisationsDeNue({idNue:r}){return await uneFois(async _=>await this.suivreGestionnaireAutorisations({idNue:r,f:ignorerNonDfinis(_)}))}async suivreAutorisationsMembresDeGestionnaire({idAutorisation:r,f:_}){const E=async S=>{const C=Object.entries(S).map(([A,I])=>({idCompte:A,statut:I}));await _(C)};return await this.client.suivreBdDicDeClef({id:r,clef:"membres",schma:schmaBdAutorisations,f:E})}async suivreAutorisationsMembresDeNue({idNue:r,f:_}){const E=async({fSuivreRacine:C})=>await this.suivreGestionnaireAutorisations({idNue:r,f:C}),S=async({id:C,fSuivreBd:A})=>await this.suivreAutorisationsMembresDeGestionnaire({idAutorisation:C,f:A});return await suivreBdDeFonction({fRacine:E,f:ignorerNonDfinis(_),fSuivre:S})}async ajouterTableauNue({idNue:r,clefTableau:_}){const E=await this.client.obtIdBd({nom:"tableaux",racine:r,type:"ordered-keyvalue"});if(!E)throw new Error(`Permission de modification refuse pour Nue ${r}.`);const{bd:S,fOublier:C}=await this.client.ouvrirBdType({id:E,type:"ordered-keyvalue",schma:schmaBdTableauxDeBd});_=_||v4();const A=await this.client.tableaux.crerTableau({idBd:r});return await S.set(A,{clef:_}),await C(),A}async effacerTableauNue({idNue:r,idTableau:_}){const E=await this.client.obtIdBd({nom:"tableaux",racine:r,type:"ordered-keyvalue"});if(!E)throw new Error(`Permission de modification refuse pour Nue ${r}.`);const{bd:S,fOublier:C}=await this.client.ouvrirBdType({id:E,type:"ordered-keyvalue",schma:schmaBdTableauxDeBd});await S.del(_),await C(),await this.client.tableaux.effacerTableau({idTableau:_})}async suivreTableauxNue({idNue:r,f:_}){const E=async C=>{await _(C.flat())},S=async(C,A)=>{const I=B=>{const O=B.map(N=>({id:N.key,...N.value}));A(O)};return await this.client.suivreBdDicOrdonneDeClef({id:C,clef:"tableaux",schma:schmaBdTableauxDeBd,f:I})};return await this.suivreDeParents({idNue:r,f:E,fParents:S})}async ajouterNomsTableauNue({idTableau:r,noms:_}){return await this.client.tableaux.sauvegarderNomsTableau({idTableau:r,noms:_})}async effacerNomsTableauNue({idTableau:r,langue:_}){return await this.client.tableaux.effacerNomTableau({idTableau:r,langue:_})}async suivreNomsTableauNue({idNue:r,clefTableau:_,f:E}){const S=async A=>{await E(Object.assign({},...A))},C=async(A,I)=>await suivreBdDeFonction({fRacine:async({fSuivreRacine:B})=>await this.client.bds.suivreIdTableauParClef({idBd:A,clef:_,f:B}),f:ignorerNonDfinis(I),fSuivre:async({id:B,fSuivreBd:O})=>await this.client.tableaux.suivreNomsTableau({idTableau:B,f:O})});return await this.suivreDeParents({idNue:r,f:S,fParents:C})}async ajouterColonneTableauNue({idTableau:r,idVariable:_,idColonne:E,index:S}){const C=await this.client.tableaux.ajouterColonneTableau({idTableau:r,idVariable:_,idColonne:E});return S&&await this.changerColIndexTableauNue({idTableau:r,idColonne:C,val:!0}),C}async effacerColonneTableauNue({idTableau:r,idColonne:_}){return await this.client.tableaux.effacerColonneTableau({idTableau:r,idColonne:_})}async changerColIndexTableauNue({idTableau:r,idColonne:_,val:E}){return await this.client.tableaux.changerColIndex({idTableau:r,idColonne:_,val:E})}async suivreColonnesTableauNue({idNue:r,clefTableau:_,f:E,catgories:S=!0}){const C=async I=>{await E(I.flat())},A=async(I,B)=>await suivreBdDeFonction({fRacine:async({fSuivreRacine:O})=>await this.client.bds.suivreIdTableauParClef({idBd:I,clef:_,f:O}),f:ignorerNonDfinis(B),fSuivre:async({id:O,fSuivreBd:N})=>await this.client.tableaux.suivreColonnesTableau({idTableau:O,f:N,catgories:S})});return await this.suivreDeParents({idNue:r,f:C,fParents:A})}async ajouterRgleTableauNue({idTableau:r,idColonne:_,rgle:E}){return await this.client.tableaux.ajouterRgleTableau({idTableau:r,idColonne:_,rgle:E})}async effacerRgleTableauNue({idTableau:r,idRgle:_}){return await this.client.tableaux.effacerRgleTableau({idTableau:r,idRgle:_})}async suivreRglesTableauNue({idNue:r,clefTableau:_,f:E}){const S=async A=>{await E(A.flat())},C=async(A,I)=>await suivreBdDeFonction({fRacine:async({fSuivreRacine:B})=>await this.client.bds.suivreIdTableauParClef({idBd:A,clef:_,f:B}),f:ignorerNonDfinis(I),fSuivre:async({id:B,fSuivreBd:O})=>await this.client.tableaux.suivreRgles({idTableau:B,f:O})});return await this.suivreDeParents({idNue:r,f:S,fParents:C})}async suivreVariablesNue({idNue:r,f:_}){return await suivreBdsDeFonctionListe({fListe:async A=>await this.suivreTableauxNue({idNue:r,f:I=>A(I.map(B=>B.id))}),f:async A=>await _(A||[]),fBranche:async(A,I)=>await this.client.tableaux.suivreVariables({idTableau:A,f:I})})}async suivreQualitNue({idNue:r,f:_}){const E={noms:{},descr:{}},S=async()=>{const B=[Object.keys(E.noms).length?1:0,Object.keys(E.descr).length?1:0],O=B.reduce((N,U)=>N+U,0)/B.length;await _(O)},C=await this.suivreNomsNue({idNue:r,f:B=>{E.noms=B,S()}}),A=await this.suivreDescriptionsNue({idNue:r,f:B=>{E.descr=B,S()}});return async()=>{await C(),await A()}}async suivreDiffrencesNueEtTableau({idNue:r,clefTableau:_,idTableau:E,f:S,stricte:C=!0}){const A=async O=>{const N=O.filter(U=>C||U.svre);await S(N)},I=async({fSuivreRacine:O})=>await this.client.bds.suivreIdTableauParClef({idBd:r,clef:_,f:O}),B=async({id:O,fSuivreBd:N})=>await this.client.tableaux.suivreDiffrencesAvecTableau({idTableau:E,idTableauRf:O,f:N});return await suivreBdDeFonction({fRacine:I,f:ignorerNonDfinis(A),fSuivre:B})}async suivreDiffrencesNueEtBd({idNue:r,idBd:_,f:E}){const S={},C=async()=>{const B=[];if(S.tableauxNue&&S.tableauxBd){for(const O of S.tableauxNue)if(!S.tableauxNue.find(U=>U.clef===O.clef)){const U={type:"tableauManquant",svre:!0,clefManquante:O.clef};B.push(U)}for(const O of S.tableauxBd)if(!S.tableauxNue.find(U=>U.clef===O.clef)){const U={type:"tableauSupplmentaire",svre:!1,clefExtra:O.clef};B.push(U)}}await E(B)},A=await this.client.bds.suivreTableauxBd({idBd:_,f:B=>{S.tableauxBd=B,C()}}),I=await this.suivreTableauxNue({idNue:r,f:B=>{S.tableauxNue=B,C()}});return async()=>{await A(),await I()}}async suivreCorrespondanceBd({idBd:r,f:_}){return await suivreBdsDeFonctionListe({fListe:async C=>await this.client.bds.suivreNuesBd({idBd:r,f:C}),f:_,fBranche:async(C,A)=>{const I={diffrencesBds:[],diffrencesTableaux:[]},B=async()=>{A([...I.diffrencesBds,...I.diffrencesTableaux])},O=await this.suivreDiffrencesNueEtBd({idNue:C,idBd:r,f:async j=>{I.diffrencesBds=j,await B()}}),U=await suivreBdsDeFonctionListe({fListe:async j=>await this.client.bds.suivreTableauxBd({idBd:r,f:j}),f:async j=>{I.diffrencesTableaux=j,await B()},fBranche:async(j,z,Z)=>await this.suivreDiffrencesNueEtTableau({idNue:C,clefTableau:Z.clef,idTableau:j,f:async X=>{await z(X.map(Q=>({type:"tableau",svre:Q.svre,idTableau:j,diffrence:Q})))}}),fCode:j=>j.id,fIdBdDeBranche:j=>j.id});return async()=>{await Promise.all([O,U])}}})}async rechercherNuesDscendantes({idNue:r,f:_,nRsultatsDsirs:E}){const S=async C=>{_(C.map(A=>A.id))};return await this.client.rseau.rechercherNues({f:S,fObjectif:async(C,A,I)=>await C.nues.suivreNuesParents({idNue:A,f:B=>{B.includes(r)&&I({type:"rsultat",score:1,de:"*",info:{type:"vide"}})}}),nRsultatsDsirs:E})}async prciserParent({idNue:r,idNueParent:_}){const{bd:E,fOublier:S}=await this.client.ouvrirBdType({id:r,type:"keyvalue",schma:schmaStructureBdNue});E.set("parent",_),await S()}async enleverParent({idNue:r}){const{bd:_,fOublier:E}=await this.client.ouvrirBdType({id:r,type:"keyvalue",schma:schmaStructureBdNue});_.del("parent"),await E()}async suivreNuesParents({idNue:r,f:_}){let E=!1;const S={},C=async()=>{await _(Object.values(Object.values(S).map(B=>B.parent)))},A=async({id:B})=>await this.client.suivreBd({id:B,type:"keyvalue",schma:schmaStructureBdNue,f:async O=>{if(E)return;const N=await O.get("parent");if(S[B]?.parent===N){N||await C();return}if(await S[B]?.fOublier(),N){const U=await A({id:N});S[B]={parent:N,fOublier:async()=>{await U(),await S[N]?.fOublier(),delete S[B],await C()}}}else delete S[B];await C()}}),I=await A({id:r});return async()=>{E=!0,await I(),await Promise.all(Object.values(S).map(B=>B.fOublier()))}}async suivreBdsCorrespondantesDUneNue({idNue:r,f:_,nRsultatsDsirs:E,vrifierAutorisation:S=!0,toujoursInclureLesMiennes:C=!0}){if(S){const A={},I=async()=>{const{philoAutorisation:Q,membres:se,bds:oe}=A;if(!oe)return;if(!Q)return C?await _(oe.filter(Te=>Te.auteurs.some(xe=>xe===this.client.idCompte)).map(Te=>Te.idBd)):void 0;if(!se)return;const ue=await this.client.obtIdCompte();return await _((Te=>{if(Q==="CJPI"){const xe=se.filter(Re=>Re.statut==="accept").map(Re=>Re.idCompte);return Te.filter(Re=>Re.auteurs.some(Ne=>xe.includes(Ne))||C&&Re.auteurs.includes(ue)).map(Re=>Re.idBd)}else if(Q==="IJPC"){const xe=se.filter(Re=>Re.statut==="exclus").map(Re=>Re.idCompte);return Te.filter(Re=>!Re.auteurs.some(Ne=>xe.includes(Ne))).map(Re=>Re.idBd)}else throw new Error(Q)})(oe))},B=await this.suivrePhilosophieAutorisation({idNue:r,f:async Q=>{A.philoAutorisation=Q,await I()}}),O=await this.suivreAutorisationsMembresDeNue({idNue:r,f:async Q=>{A.membres=Q,await I()}}),N=async Q=>{A.bds=Q,await I()},U=async Q=>await this.client.rseau.suivreBdsDeNue({idNue:r,f:Q,nRsultatsDsirs:E}),j=async(Q,se)=>{const oe=async ue=>await se({idBd:Q,auteurs:ue.filter(we=>we.accept).map(we=>we.idCompte)});return await this.client.rseau.suivreAuteursBd({idBd:Q,f:oe})},{fOublier:z,fChangerProfondeur:Z}=await suivreBdsDeFonctionListe({fListe:U,f:N,fBranche:j});return{fOublier:async()=>{await Promise.all([z,O,B].map(Q=>Q()))},fChangerProfondeur:Z}}else return await this.client.rseau.suivreBdsDeNue({idNue:r,f:_,nRsultatsDsirs:E})}async suivreBdsCorrespondantes({idNue:r,f:_,nRsultatsDsirs:E,hritage:S,vrifierAutorisation:C=!0,toujoursInclureLesMiennes:A=!0}){const I={},B=[],O=async()=>{if(!I.directes)return;const j=[...new Set([...I.ascendance||[],...I.descendance||[],...I.directes])];return await _(j)};if(S&&S.includes("ascendance")){const j=await this.suivreDeParents({idNue:r,f:async z=>{const Z=[];z.forEach(X=>X.forEach(Q=>{!Z.includes(Q)&&Z.push(Q)})),I.ascendance=Z,await O()},fParents:async(z,Z)=>(await this.suivreBdsCorrespondantesDUneNue({idNue:z,f:Z,nRsultatsDsirs:E,vrifierAutorisation:C,toujoursInclureLesMiennes:A})).fOublier});B.push(j)}if(S&&S.includes("descendance")){const{fOublier:j}=await suivreBdsDeFonctionListe({fListe:async z=>await this.rechercherNuesDscendantes({idNue:r,f:Z=>z([r,...Z].reverse())}),f:async z=>{I.descendance=z,await O()},fBranche:async(z,Z)=>(await this.suivreBdsCorrespondantesDUneNue({idNue:z,f:Z,nRsultatsDsirs:E,vrifierAutorisation:C,toujoursInclureLesMiennes:A})).fOublier});B.push(j)}const{fOublier:N,fChangerProfondeur:U}=await this.suivreBdsCorrespondantesDUneNue({idNue:r,f:async j=>{I.directes=j,await O()},nRsultatsDsirs:E,vrifierAutorisation:C,toujoursInclureLesMiennes:A});return B.push(N),{fOublier:async()=>{await Promise.all(B.map(j=>j()))},fChangerProfondeur:U}}async suivreEmpreinteTtesBdsNue({idNue:r,f:_,hritage:E}){return await suivreBdsDeFonctionListe({fListe:async S=>{const{fOublier:C}=await this.suivreBdsCorrespondantes({idNue:r,f:async A=>S([r,...A]),hritage:E});return C},f:async S=>{const C=Base64.stringify(md5(S.join(":")));return await _(C)},fBranche:async(S,C)=>await this.client.suivreEmpreinteTtesBdRcursive({idBd:S,f:C})})}async suivreDonnesTableauNue({idNue:r,clefTableau:_,f:E,nRsultatsDsirs:S,hritage:C,ignorerErreursFormatBd:A=!0,ignorerErreursFormatTableau:I=!1,ignorerErreursDonnesTableau:B=!0,licencesPermises:O=void 0,toujoursInclureLesMiennes:N=!0,clefsSelonVariables:U=!1}){const j=async Q=>{const se=Q.flat();await E(se)},z=async Q=>await this.suivreBdsCorrespondantes({idNue:r,f:Q,nRsultatsDsirs:S,hritage:C,toujoursInclureLesMiennes:N});return await suivreBdsDeFonctionListe({fListe:async Q=>{const se=async(oe,ue)=>{const we={licence:!1,formatBd:!0},Te=[],xe=async()=>{const Re=Object.values(we).every(Ne=>Ne);await ue(Re)};if(O){const Re=await this.client.bds.suivreLicenceBd({idBd:oe,f:async Ne=>(we.licence=O.includes(Ne),await xe())});Te.push(Re)}else we.licence=!0;if(A)we.formatBd=!0;else{const Re=await this.suivreDiffrencesNueEtBd({idBd:oe,idNue:r,f:async Ne=>(we.formatBd=!Ne.length,await xe())});Te.push(Re)}return await xe(),async()=>{await Promise.all(Te.map(Re=>Re()))}};return await this.client.suivreBdsSelonCondition({fListe:z,fCondition:se,f:Q})},f:j,fBranche:async(Q,se)=>{const oe={},ue=async()=>{const{donnes:Re,erreurslments:Ne,auteurs:Fe}=oe;if(Re&&Ne&&Fe&&Fe.length){const ht=Fe.find(Ee=>Ee.accept)?.idCompte;if(!ht)return;const nt=Re.map(Ee=>({idCompte:ht,lment:Ee,valid:Ne.filter(Ce=>Ce.id==Ee.id)})).filter(Ee=>B||!Ee.valid.length);await se(nt)}},Te=await suivreBdDeFonction({fRacine:async({fSuivreRacine:Re})=>await this.client.suivreBdSelonCondition({fRacine:async Ne=>await this.client.bds.suivreIdTableauParClef({idBd:Q,clef:_,f:ignorerNonDfinis(Ne)}),fCondition:async(Ne,Fe)=>I?(await Fe(!0),faisRien):(await Fe(!0),await this.suivreDiffrencesNueEtTableau({idNue:r,clefTableau:_,idTableau:Ne,f:async ht=>await Fe(!ht.length),stricte:!1})),f:Re}),f:async Re=>{oe.donnes=Re?.donnes,oe.erreurslments=Re?.erreurs,await ue()},fSuivre:async({id:Re,fSuivreBd:Ne})=>{const Fe={},ht=[],nt=async()=>{const{donnes:_e,erreurs:Ie}=Fe;_e&&await Ne({donnes:_e,erreurs:Ie||[]})},Ee=await this.client.tableaux.suivreDonnes({idTableau:Re,f:async _e=>{Fe.donnes=_e,await nt()},clefsSelonVariables:U});ht.push(Ee);const Ce=await this.client.tableaux.suivreValidDonnes({idTableau:Re,f:async _e=>{Fe.erreurs=_e,await nt()}});return ht.push(Ce),async()=>{await Promise.all(ht.map(_e=>_e()))}}}),xe=await this.client.rseau.suivreAuteursBd({idBd:Q,f:async Re=>{oe.auteurs=Re,await ue()}});return async()=>{await Promise.all([Te,xe])}}})}async suivreDonnesExportationTableau({clefTableau:r,idNue:_,langues:E,f:S,nRsultatsDsirs:C,hritage:A}){const I={},B=[],O=async()=>{const{colonnes:j,donnes:z,nomsTableau:Z,nomsVariables:X}=I;if(j&&z&&(!E||Z&&X)){const Q=new Set;let se=await Promise.all(z.map(async we=>({...await this.client.tableaux.formaterlment({:we.lment.donnes,colonnes:j,fichiersSFIP:Q,langues:E}),auteur:we.idCompte})));se=se.map(we=>Object.keys(we).reduce((Te,xe)=>{if(xe==="auteur")Te[xe]=we[xe];else{const Re=j.find(Fe=>Fe.variable===xe)?.id,Ne=E&&X?.[xe]?traduire(X[xe],E)||Re||xe:Re||xe;Te[Ne]=we[xe]}return Te},{}));const oe=r.split("/").pop(),ue=E&&Z&&traduire(Z,E)||oe;return await S({nomTableau:ue,donnes:se,fichiersSFIP:Q})}};if(E){const j=await this.suivreNomsTableauNue({idNue:_,clefTableau:r,f:async Z=>{I.nomsTableau=Z,await O()}});B.push(j);const z=await suivreBdsDeFonctionListe({fListe:async Z=>this.suivreVariablesNue({idNue:_,f:Z}),f:async Z=>{I.nomsVariables=Object.fromEntries(Z.map(X=>[X.idVar,X.noms])),await O()},fBranche:async(Z,X)=>await this.client.variables.suivreNomsVariable({idVariable:Z,f:async Q=>await X({idVar:Z,noms:{...Q,auteur:"auteur"}})})});B.push(z)}const N=await this.suivreColonnesTableauNue({idNue:_,clefTableau:r,f:async j=>{I.colonnes=j,await O()},catgories:!0});B.push(N);const{fOublier:U}=await this.suivreDonnesTableauNue({idNue:_,clefTableau:r,nRsultatsDsirs:C,hritage:A,f:async j=>{I.donnes=j,await O()}});return B.push(U),async()=>{Promise.all(B.map(j=>j()))}}async suivreDonnesExportation({idNue:r,langues:_,f:E,nRsultatsDsirs:S,hritage:C}){const A={},I=[],B=async()=>{const{nomsNue:U,donnes:j}=A;if(!j)return;const z=r.split("/").pop(),Z=U&&_&&traduire(U,_)||z;await E({nomNue:Z,tableaux:j})},O=await suivreBdsDeFonctionListe({fListe:async U=>await this.suivreTableauxNue({idNue:r,f:U}),f:async U=>{A.donnes=U,await B()},fBranche:async(U,j)=>await this.suivreDonnesExportationTableau({idNue:r,clefTableau:U,langues:_,nRsultatsDsirs:S,hritage:C,f:async z=>await j(z)}),fIdBdDeBranche:U=>U.clef,fCode:U=>U.clef});if(I.push(O),_){const U=await this.suivreNomsNue({idNue:r,f:async j=>{A.nomsNue=j,await B()}});I.push(U)}return async()=>{await Promise.all(I.map(U=>U()))}}async exporterDonnesNue({idNue:r,langues:_,nomFichier:E,nRsultatsDsirs:S,hritage:C,patience:A=500}){const I=utils.book_new(),B=new Set,O=await uneFois(async N=>await this.suivreDonnesExportation({idNue:r,langues:_,f:N,hritage:C,nRsultatsDsirs:S}),attendreStabilit(A));E=E||O.nomNue;for(const N of O.tableaux){N.fichiersSFIP.forEach(j=>B.add(j));const U=utils.json_to_sheet(N.donnes);utils.book_append_sheet(I,U,N.nomTableau.slice(0,30))}return{doc:I,fichiersSFIP:B,nomFichier:E}}async gnrerDeBd({idBd:r,patience:_=500}){const E=await this.crerNue({}),[S,C,A,I]=await Promise.all([uneFois(async B=>await this.client.bds.suivreNomsBd({idBd:r,f:B}),attendreStabilit(_)),uneFois(async B=>await this.client.bds.suivreDescriptionsBd({idBd:r,f:B}),attendreStabilit(_)),uneFois(async B=>await this.client.bds.suivreMotsClefsBd({idBd:r,f:B}),attendreStabilit(_)),uneFois(async B=>await this.client.bds.suivreTableauxBd({idBd:r,f:B}),attendreStabilit(_))]);return await Promise.all([this.sauvegarderNomsNue({idNue:E,noms:S}),await this.sauvegarderDescriptionsNue({idNue:E,descriptions:C}),await this.ajouterMotsClefsNue({idNue:E,idsMotsClefs:A})]),await Promise.all(I.map(async B=>{const O=B.id,N=await this.ajouterTableauNue({idNue:E,clefTableau:B.clef}),U=await uneFois(async j=>await this.client.tableaux.suivreColonnesTableau({idTableau:O,f:j,catgories:!1}),attendreStabilit(_));for(const j of U){await this.ajouterColonneTableauNue({idTableau:N,idVariable:j.variable,idColonne:j.id,index:j.index}),await this.changerColIndexTableauNue({idTableau:N,idColonne:j.id,val:!!j.index});const z=await uneFois(async Z=>await this.client.tableaux.suivreRgles({idTableau:O,f:Z}),attendreStabilit(_));for(const Z of z)Z.source.type==="tableau"&&await this.ajouterRgleTableauNue({idTableau:N,idColonne:j.id,rgle:Z.rgle.rgle})}})),E}async gnrerSchmaBdNue({idNue:r,licence:_,patience:E=500}){const[S,C]=await Promise.all([uneFois(async O=>await this.suivreMotsClefsNue({idNue:r,f:O}),attendreStabilit(E)),uneFois(async O=>await this.suivreTableauxNue({idNue:r,f:O}),attendreStabilit(E))]),A=async O=>await uneFois(async N=>await this.suivreRglesTableauNue({idNue:r,clefTableau:O,f:N}),attendreStabilit(E)),I=async O=>await uneFois(async N=>await this.suivreColonnesTableauNue({idNue:r,clefTableau:O,f:N,catgories:!1}),attendreStabilit(E));return{licence:_,nues:[r],motsClefs:S,tableaux:await Promise.all(C.map(async O=>{const[N,U]=await Promise.all([I(O.clef),A(O.clef)]);return{cols:N.map(j=>{const z=U.some(Z=>Z.colonne===j.id&&Z.rgle.rgle.typeRgle==="existe");return{idColonne:j.id,idVariable:j.variable,index:!!j.index,optionnelle:!z}}),clef:O.clef}}))}}async effacerNue({idNue:r}){const{bd:_,fOublier:E}=await this.obtBd();await _.del(r),await E();for(const C of["noms","descriptions","motsClefs"]){const A=await this.client.obtIdBd({nom:C,racine:r});A&&await this.client.effacerBd({id:A})}const S=await this.client.obtIdBd({nom:"tableaux",racine:r,type:"ordered-keyvalue"});if(S){const{bd:C,fOublier:A}=await this.client.ouvrirBdType({id:S,type:"ordered-keyvalue",schma:schmaBdTableauxDeBd}),I=Object.keys(C.all);for(const B of I)await this.client.tableaux.effacerTableau({idTableau:B});A(),await this.client.effacerBd({id:S})}await this.enleverDeMesNues({idNue:r}),await this.client.effacerBd({id:r})}}__decorate([cacheSuivi],Nues.prototype,"suivreDescriptionsNue",null);__decorate([cacheSuivi],Nues.prototype,"suivreImage",null);__decorate([cacheSuivi],Nues.prototype,"suivreMotsClefsNue",null);__decorate([cacheSuivi],Nues.prototype,"suivreNomsTableauNue",null);__decorate([cacheSuivi],Nues.prototype,"suivreColonnesTableauNue",null);__decorate([cacheSuivi],Nues.prototype,"suivreRglesTableauNue",null);__decorate([cacheSuivi],Nues.prototype,"suivreQualitNue",null);__decorate([cacheSuivi],Nues.prototype,"suivreDiffrencesNueEtTableau",null);__decorate([cacheSuivi],Nues.prototype,"suivreDiffrencesNueEtBd",null);__decorate([cacheSuivi],Nues.prototype,"suivreCorrespondanceBd",null);__decorate([cacheRechercheParNRsultats],Nues.prototype,"rechercherNuesDscendantes",null);__decorate([cacheSuivi],Nues.prototype,"suivreNuesParents",null);__decorate([cacheRechercheParNRsultats],Nues.prototype,"suivreBdsCorrespondantesDUneNue",null);__decorate([cacheRechercheParNRsultats],Nues.prototype,"suivreBdsCorrespondantes",null);__decorate([cacheSuivi],Nues.prototype,"suivreEmpreinteTtesBdsNue",null);__decorate([cacheRechercheParNRsultats],Nues.prototype,"suivreDonnesTableauNue",null);const rechercherVariablesSelonNom=n=>async(r,_,E)=>{const S=async A=>{const I=similTexte(n,A);if(I){const{score:B,clef:O,info:N}=I;return await E({type:"rsultat",score:B,de:"nom",clef:O,info:N})}else return await E()};return await r.variables.suivreNomsVariable({idVariable:_,f:S})},rechercherVariablesSelonDescr=n=>async(r,_,E)=>{const S=async A=>{const I=similTexte(n,A);if(I){const{score:B,clef:O,info:N}=I;return await E({type:"rsultat",score:B,de:"descr",clef:O,info:N})}else return await E()};return await r.variables.suivreDescriptionsVariable({idVariable:_,f:S})},rechercherVariablesSelonTexte=n=>async(r,_,E)=>{const S=rechercherVariablesSelonNom(n),C=rechercherVariablesSelonDescr(n),A=rechercherSelonId(n),I=rechercherTousSiVide(n);return await combinerRecherches({noms:S,descr:C,id:A,vide:I},r,_,E)},rechercherMotsClefsSelonNom=n=>async(r,_,E)=>{const S=async A=>{const I=similTexte(n,A);if(I){const{score:B,clef:O,info:N}=I;return await E({type:"rsultat",score:B,clef:O,info:N,de:"nom"})}else return await E()};return await r.motsClefs.suivreNomsMotClef({idMotClef:_,f:S})},rechercherMotsClefsSelonDescr=n=>async(r,_,E)=>{const S=async A=>{const I=similTexte(n,A);if(I){const{score:B,clef:O,info:N}=I;return await E({type:"rsultat",score:B,clef:O,info:N,de:"descr"})}else return await E()};return await r.motsClefs.suivreDescriptionsMotClef({idMotClef:_,f:S})},rechercherMotsClefsSelonTexte=n=>async(r,_,E)=>{const S=rechercherMotsClefsSelonNom(n),C=rechercherMotsClefsSelonDescr(n),A=rechercherSelonId(n),I=rechercherTousSiVide(n);return await combinerRecherches({noms:S,id:A,descr:C,vide:I},r,_,E)},rechercherBdsSelonNom=n=>async(r,_,E)=>{const S=async A=>{const I=similTexte(n,A);if(I){const{score:B,clef:O,info:N}=I;return await E({type:"rsultat",score:B,clef:O,info:N,de:"nom"})}else return await E()};return await r.bds.suivreNomsBd({idBd:_,f:S})},rechercherBdsSelonDescr=n=>async(r,_,E)=>{const S=async A=>{const I=similTexte(n,A);if(I){const{score:B,clef:O,info:N}=I;return await E({type:"rsultat",score:B,clef:O,info:N,de:"descr"})}else return await E()};return await r.bds.suivreDescriptionsBd({idBd:_,f:S})},rechercherBdsSelonIdVariable=n=>async(r,_,E)=>{const S=async A=>await r.bds.suivreVariablesBd({idBd:_,f:A}),C=rechercherSelonId(n);return await sousRecherche("variable",S,C,r,E)},rechercherBdsSelonNomVariable=n=>async(r,_,E)=>{const S=async A=>await r.bds.suivreVariablesBd({idBd:_,f:A}),C=rechercherVariablesSelonNom(n);return await sousRecherche("variable",S,C,r,E)},rechercherBdsSelonVariable=n=>async(r,_,E)=>await combinerRecherches({id:rechercherBdsSelonIdVariable(n),nom:rechercherBdsSelonNomVariable(n)},r,_,E),rechercherBdsSelonIdMotClef=n=>async(r,_,E)=>{const S=async A=>await r.bds.suivreMotsClefsBd({idBd:_,f:A}),C=rechercherSelonId(n);return await sousRecherche("motClef",S,C,r,E)},rechercherBdsSelonNomMotClef=n=>async(r,_,E)=>{const S=async A=>await r.bds.suivreMotsClefsBd({idBd:_,f:A}),C=rechercherMotsClefsSelonNom(n);return await sousRecherche("motClef",S,C,r,E)},rechercherBdsSelonMotClef=n=>async(r,_,E)=>await combinerRecherches({id:rechercherBdsSelonIdMotClef(n),nom:rechercherBdsSelonNomMotClef(n)},r,_,E),rechercherBdsSelonTexte=n=>async(r,_,E)=>await combinerRecherches({nom:rechercherBdsSelonNom(n),descr:rechercherBdsSelonDescr(n),variables:rechercherBdsSelonVariable(n),motsClefs:rechercherBdsSelonMotClef(n),id:rechercherSelonId(n),vide:rechercherTousSiVide(n)},r,_,E),rechercherProjetsSelonNom=n=>async(r,_,E)=>{const S=A=>{const I=similTexte(n,A);if(I){const{score:B,clef:O,info:N}=I;E({type:"rsultat",score:B,clef:O,info:N,de:"nom"})}else E()};return await r.projets.suivreNomsProjet({idProjet:_,f:S})},rechercherProjetsSelonDescr=n=>async(r,_,E)=>{const S=A=>{const I=similTexte(n,A);if(I){const{score:B,clef:O,info:N}=I;E({type:"rsultat",score:B,clef:O,info:N,de:"descr"})}else E()};return await r.projets.suivreDescriptionsProjet({idProjet:_,f:S})},rechercherProjetsSelonIdBd=n=>async(r,_,E)=>{const S=async A=>await r.projets.suivreBdsProjet({idProjet:_,f:A}),C=rechercherSelonId(n);return await sousRecherche("bd",S,C,r,E)},rechercherProjetsSelonBd=n=>async(r,_,E)=>{const S=async A=>await r.projets.suivreBdsProjet({idProjet:_,f:A}),C=rechercherBdsSelonTexte(n);return await sousRecherche("bd",S,C,r,E)},rechercherProjetsSelonIdVariable=n=>async(r,_,E)=>{const S=async A=>await r.projets.suivreVariablesProjet({idProjet:_,f:A}),C=rechercherSelonId(n);return await sousRecherche("variable",S,C,r,E)},rechercherProjetsSelonNomVariable=n=>async(r,_,E)=>{const S=async A=>await r.projets.suivreVariablesProjet({idProjet:_,f:A}),C=rechercherVariablesSelonNom(n);return await sousRecherche("variable",S,C,r,E)},rechercherProjetsSelonVariable=n=>async(r,_,E)=>{const S=async A=>await r.projets.suivreVariablesProjet({idProjet:_,f:A}),C=rechercherVariablesSelonTexte(n);return await sousRecherche("variable",S,C,r,E)},rechercherProjetsSelonIdMotClef=n=>async(r,_,E)=>{const S=async A=>await r.projets.suivreMotsClefsProjet({idProjet:_,f:I=>A(I.map(B=>B.idMotClef))}),C=rechercherSelonId(n);return await sousRecherche("motClef",S,C,r,E)},rechercherProjetsSelonNomMotClef=n=>async(r,_,E)=>{const S=async A=>await r.projets.suivreMotsClefsProjet({idProjet:_,f:I=>A(I.map(B=>B.idMotClef))}),C=rechercherMotsClefsSelonNom(n);return await sousRecherche("motClef",S,C,r,E)},rechercherProjetsSelonMotClef=n=>async(r,_,E)=>{const S=async A=>await r.projets.suivreMotsClefsProjet({idProjet:_,f:I=>A(I.map(B=>B.idMotClef))}),C=rechercherMotsClefsSelonTexte(n);return await sousRecherche("motClef",S,C,r,E)},rechercherProjetsSelonTexte=n=>async(r,_,E)=>{const S=rechercherProjetsSelonNom(n),C=rechercherProjetsSelonDescr(n),A=rechercherProjetsSelonBd(n),I=rechercherProjetsSelonVariable(n),B=rechercherProjetsSelonMotClef(n),O=rechercherSelonId(n),N=rechercherTousSiVide(n);return await combinerRecherches({noms:S,descr:C,bd:A,variable:I,motClef:B,id:O,tous:N},r,_,E)},rechercherNuesSelonNom=n=>async(r,_,E)=>{const S=A=>{const I=similTexte(n,A);if(I){const{score:B,clef:O,info:N}=I;E({type:"rsultat",score:B,clef:O,info:N,de:"nom"})}else E()};return await r.nues.suivreNomsNue({idNue:_,f:S})},rechercherNuesSelonDescr=n=>async(r,_,E)=>{const S=A=>{const I=similTexte(n,A);if(I){const{score:B,clef:O,info:N}=I;E({type:"rsultat",score:B,clef:O,info:N,de:"descr"})}else E()};return await r.nues.suivreDescriptionsNue({idNue:_,f:S})},rechercherNuesSelonIdVariable=n=>async(r,_,E)=>{const S=async A=>await r.nues.suivreVariablesNue({idNue:_,f:A}),C=rechercherSelonId(n);return await sousRecherche("variable",S,C,r,E)},rechercherNuesSelonNomVariable=n=>async(r,_,E)=>{const S=async A=>await r.nues.suivreVariablesNue({idNue:_,f:A}),C=rechercherVariablesSelonNom(n);return await sousRecherche("variable",S,C,r,E)},rechercherNuesSelonVariable=n=>async(r,_,E)=>await combinerRecherches({id:rechercherNuesSelonIdVariable(n),nom:rechercherNuesSelonNomVariable(n)},r,_,E),rechercherNuesSelonIdMotClef=n=>async(r,_,E)=>{const S=async A=>await r.nues.suivreMotsClefsNue({idNue:_,f:A}),C=rechercherSelonId(n);return await sousRecherche("motClef",S,C,r,E)},rechercherNuesSelonNomMotClef=n=>async(r,_,E)=>{const S=async A=>await r.nues.suivreMotsClefsNue({idNue:_,f:A}),C=rechercherMotsClefsSelonNom(n);return await sousRecherche("motClef",S,C,r,E)},rechercherNuesSelonMotClef=n=>async(r,_,E)=>await combinerRecherches({id:rechercherNuesSelonIdMotClef(n),nom:rechercherNuesSelonNomMotClef(n)},r,_,E),rechercherNuesSelonTexte=n=>async(r,_,E)=>await combinerRecherches({nom:rechercherNuesSelonNom(n),descr:rechercherNuesSelonDescr(n),variables:rechercherNuesSelonVariable(n),motsClefs:rechercherNuesSelonMotClef(n),id:rechercherSelonId(n),tous:rechercherTousSiVide(n)},r,_,E);class Recherche{client;constructor({client:r}){this.client=r}async rechercherVariables({f:r,nRsultatsDsirs:_,toutLeRseau:E=!0}){return await this.client.rseau.rechercherVariables({f:r,nRsultatsDsirs:_,toutLeRseau:E})}async rechercherVariablesSelonId({idVariable:r,f:_,nRsultatsDsirs:E,toutLeRseau:S=!0}){const C=rechercherSelonId(r);return await this.client.rseau.rechercherVariables({f:_,nRsultatsDsirs:E,fObjectif:C,toutLeRseau:S})}async rechercherVariablesSelonNom({nomVariable:r,f:_,nRsultatsDsirs:E,toutLeRseau:S=!0}){const C=rechercherVariablesSelonNom(r);return await this.client.rseau.rechercherVariables({f:_,nRsultatsDsirs:E,fObjectif:C,toutLeRseau:S})}async rechercherVariablesSelonDescr({descrVariable:r,f:_,nRsultatsDsirs:E,toutLeRseau:S=!0}){const C=rechercherVariablesSelonDescr(r);return await this.client.rseau.rechercherVariables({f:_,nRsultatsDsirs:E,fObjectif:C,toutLeRseau:S})}async rechercherVariablesSelonTexte({texte:r,f:_,nRsultatsDsirs:E,toutLeRseau:S=!0}){const C=rechercherVariablesSelonTexte(r);return await this.client.rseau.rechercherVariables({f:_,nRsultatsDsirs:E,fObjectif:C,toutLeRseau:S})}async rechercherMotsClefs({f:r,nRsultatsDsirs:_,toutLeRseau:E=!0}){return await this.client.rseau.rechercherMotsClefs({f:r,nRsultatsDsirs:_,toutLeRseau:E})}async rechercherMotsClefsSelonId({idMotClef:r,f:_,nRsultatsDsirs:E,toutLeRseau:S=!0}){const C=rechercherSelonId(r);return await this.client.rseau.rechercherMotsClefs({f:_,nRsultatsDsirs:E,fObjectif:C,toutLeRseau:S})}async rechercherMotsClefsSelonNom({nomMotClef:r,f:_,nRsultatsDsirs:E,toutLeRseau:S=!0}){const C=rechercherMotsClefsSelonNom(r);return await this.client.rseau.rechercherMotsClefs({f:_,nRsultatsDsirs:E,fObjectif:C,toutLeRseau:S})}async rechercherMotsClefsSelonDescr({descrMotClef:r,f:_,nRsultatsDsirs:E,toutLeRseau:S=!0}){const C=rechercherMotsClefsSelonDescr(r);return await this.client.rseau.rechercherMotsClefs({f:_,nRsultatsDsirs:E,fObjectif:C,toutLeRseau:S})}async rechercherMotsClefsSelonTexte({texte:r,f:_,nRsultatsDsirs:E,toutLeRseau:S=!0}){const C=rechercherMotsClefsSelonTexte(r);return await this.client.rseau.rechercherMotsClefs({f:_,nRsultatsDsirs:E,fObjectif:C,toutLeRseau:S})}async rechercherBds({f:r,nRsultatsDsirs:_,toutLeRseau:E=!0}){return await this.client.rseau.rechercherBds({f:r,nRsultatsDsirs:_,toutLeRseau:E})}async rechercherBdsSelonId({idBd:r,f:_,nRsultatsDsirs:E,toutLeRseau:S=!0}){const C=rechercherSelonId(r);return await this.client.rseau.rechercherBds({f:_,nRsultatsDsirs:E,fObjectif:C,toutLeRseau:S})}async rechercherBdsSelonNom({nomBd:r,f:_,nRsultatsDsirs:E,toutLeRseau:S=!0}){const C=rechercherBdsSelonNom(r);return await this.client.rseau.rechercherBds({f:_,nRsultatsDsirs:E,fObjectif:C,toutLeRseau:S})}async rechercherBdsSelonDescr({descrBd:r,f:_,nRsultatsDsirs:E,toutLeRseau:S=!0}){const C=rechercherBdsSelonDescr(r);return await this.client.rseau.rechercherBds({f:_,nRsultatsDsirs:E,fObjectif:C,toutLeRseau:S})}async rechercherBdsSelonIdMotClef({idMotClef:r,f:_,nRsultatsDsirs:E,toutLeRseau:S=!0}){const C=rechercherBdsSelonIdMotClef(r);return await this.client.rseau.rechercherBds({f:_,nRsultatsDsirs:E,fObjectif:C,toutLeRseau:S})}async rechercherBdsSelonIdVariable({idVariable:r,f:_,nRsultatsDsirs:E,toutLeRseau:S=!0}){const C=rechercherBdsSelonIdVariable(r);return await this.client.rseau.rechercherBds({f:_,nRsultatsDsirs:E,fObjectif:C,toutLeRseau:S})}async rechercherBdsSelonNomMotClef({nomMotClef:r,f:_,nRsultatsDsirs:E,toutLeRseau:S=!0}){const C=rechercherBdsSelonNomMotClef(r);return await this.client.rseau.rechercherBds({f:_,nRsultatsDsirs:E,fObjectif:C,toutLeRseau:S})}async rechercherBdsSelonNomVariable({nomVariable:r,f:_,nRsultatsDsirs:E,toutLeRseau:S=!0}){const C=rechercherBdsSelonNomVariable(r);return await this.client.rseau.rechercherBds({f:_,nRsultatsDsirs:E,fObjectif:C,toutLeRseau:S})}async rechercherBdsSelonMotClef({texte:r,f:_,nRsultatsDsirs:E,toutLeRseau:S=!0}){const C=rechercherBdsSelonMotClef(r);return await this.client.rseau.rechercherBds({f:_,nRsultatsDsirs:E,fObjectif:C,toutLeRseau:S})}async rechercherBdsSelonVariable({texte:r,f:_,nRsultatsDsirs:E,toutLeRseau:S=!0}){const C=rechercherBdsSelonVariable(r);return await this.client.rseau.rechercherBds({f:_,nRsultatsDsirs:E,fObjectif:C,toutLeRseau:S})}async rechercherBdsSelonTexte({texte:r,f:_,nRsultatsDsirs:E,toutLeRseau:S=!0}){const C=rechercherBdsSelonTexte(r);return await this.client.rseau.rechercherBds({f:_,nRsultatsDsirs:E,fObjectif:C,toutLeRseau:S})}async rechercherProfilsSelonId({idCompte:r,f:_,nRsultatsDsirs:E}){const S=rechercherSelonId(r);return await this.client.rseau.rechercherMembres({f:_,nRsultatsDsirs:E,fObjectif:S})}async rechercherProfilsSelonNom({nom:r,f:_,nRsultatsDsirs:E}){const S=rechercherProfilsSelonNom(r);return await this.client.rseau.rechercherMembres({f:_,nRsultatsDsirs:E,fObjectif:S})}async rechercherProfilsSelonImage({image:r,f:_,nRsultatsDsirs:E}){const S=rechercherProfilsSelonImage(r);return await this.client.rseau.rechercherMembres({f:_,nRsultatsDsirs:E,fObjectif:S})}async rechercherProfilsSelonActivit({f:r,nRsultatsDsirs:_}){const E=rechercherProfilsSelonActivit();return await this.client.rseau.rechercherMembres({f:r,nRsultatsDsirs:_,fObjectif:E})}async rechercherProfilsSelonCourriel({courriel:r,f:_,nRsultatsDsirs:E}){const S=rechercherProfilsSelonCourriel(r);return await this.client.rseau.rechercherMembres({f:_,nRsultatsDsirs:E,fObjectif:S})}async rechercherProfilsSelonTexte({texte:r,f:_,nRsultatsDsirs:E}){const S=rechercherProfilsSelonTexte(r);return await this.client.rseau.rechercherMembres({f:_,nRsultatsDsirs:E,fObjectif:S})}async rechercherProjets({f:r,nRsultatsDsirs:_,toutLeRseau:E=!0}){return await this.client.rseau.rechercherProjets({f:r,nRsultatsDsirs:_,toutLeRseau:E})}async rechercherProjetsSelonId({idProjet:r,f:_,nRsultatsDsirs:E,toutLeRseau:S=!0}){const C=rechercherSelonId(r);return await this.client.rseau.rechercherProjets({f:_,nRsultatsDsirs:E,fObjectif:C,toutLeRseau:S})}async rechercherProjetsSelonNom({nomProjet:r,f:_,nRsultatsDsirs:E,toutLeRseau:S=!0}){const C=rechercherProjetsSelonNom(r);return await this.client.rseau.rechercherProjets({f:_,nRsultatsDsirs:E,fObjectif:C,toutLeRseau:S})}async rechercherProjetsSelonDescr({descrProjet:r,f:_,nRsultatsDsirs:E,toutLeRseau:S=!0}){const C=rechercherProjetsSelonDescr(r);return await this.client.rseau.rechercherProjets({f:_,nRsultatsDsirs:E,fObjectif:C,toutLeRseau:S})}async rechercherProjetsSelonIdVariable({idVariable:r,f:_,nRsultatsDsirs:E,toutLeRseau:S=!0}){const C=rechercherProjetsSelonIdVariable(r);return await this.client.rseau.rechercherProjets({f:_,nRsultatsDsirs:E,fObjectif:C,toutLeRseau:S})}async rechercherProjetsSelonNomVariable({nomVariable:r,f:_,nRsultatsDsirs:E,toutLeRseau:S=!0}){const C=rechercherProjetsSelonNomVariable(r);return await this.client.rseau.rechercherProjets({f:_,nRsultatsDsirs:E,fObjectif:C,toutLeRseau:S})}async rechercherProjetsSelonVariable({texte:r,f:_,nRsultatsDsirs:E,toutLeRseau:S=!0}){const C=rechercherProjetsSelonVariable(r);return await this.client.rseau.rechercherProjets({f:_,nRsultatsDsirs:E,fObjectif:C,toutLeRseau:S})}async rechercherProjetsSelonIdMotClef({idMotClef:r,f:_,nRsultatsDsirs:E,toutLeRseau:S=!0}){const C=rechercherProjetsSelonIdMotClef(r);return await this.client.rseau.rechercherProjets({f:_,nRsultatsDsirs:E,fObjectif:C,toutLeRseau:S})}async rechercherProjetsSelonNomMotClef({nomMotClef:r,f:_,nRsultatsDsirs:E,toutLeRseau:S=!0}){const C=rechercherProjetsSelonNomMotClef(r);return await this.client.rseau.rechercherProjets({f:_,nRsultatsDsirs:E,fObjectif:C,toutLeRseau:S})}async rechercherProjetsSelonMotClef({texte:r,f:_,nRsultatsDsirs:E,toutLeRseau:S=!0}){const C=rechercherProjetsSelonMotClef(r);return await this.client.rseau.rechercherProjets({f:_,nRsultatsDsirs:E,fObjectif:C,toutLeRseau:S})}async rechercherProjetsSelonIdBd({idBd:r,f:_,nRsultatsDsirs:E,toutLeRseau:S=!0}){const C=rechercherProjetsSelonIdBd(r);return await this.client.rseau.rechercherProjets({f:_,nRsultatsDsirs:E,fObjectif:C,toutLeRseau:S})}async rechercherProjetsSelonBd({texte:r,f:_,nRsultatsDsirs:E,toutLeRseau:S=!0}){const C=rechercherProjetsSelonBd(r);return await this.client.rseau.rechercherProjets({f:_,nRsultatsDsirs:E,fObjectif:C,toutLeRseau:S})}async rechercherProjetsSelonTexte({texte:r,f:_,nRsultatsDsirs:E,toutLeRseau:S=!0}){const C=rechercherProjetsSelonTexte(r);return await this.client.rseau.rechercherProjets({f:_,nRsultatsDsirs:E,fObjectif:C,toutLeRseau:S})}async rechercherNues({f:r,nRsultatsDsirs:_,toutLeRseau:E=!0}){return await this.client.rseau.rechercherNues({f:r,nRsultatsDsirs:_,toutLeRseau:E})}async rechercherNuesSelonId({idNue:r,f:_,nRsultatsDsirs:E,toutLeRseau:S=!0}){const C=rechercherSelonId(r);return await this.client.rseau.rechercherNues({f:_,nRsultatsDsirs:E,fObjectif:C,toutLeRseau:S})}async rechercherNuesSelonNom({nomNue:r,f:_,nRsultatsDsirs:E,toutLeRseau:S=!0}){const C=rechercherNuesSelonNom(r);return await this.client.rseau.rechercherNues({f:_,nRsultatsDsirs:E,fObjectif:C,toutLeRseau:S})}async rechercherNuesSelonDescr({descrNue:r,f:_,nRsultatsDsirs:E,toutLeRseau:S=!0}){const C=rechercherNuesSelonDescr(r);return await this.client.rseau.rechercherNues({f:_,nRsultatsDsirs:E,fObjectif:C,toutLeRseau:S})}async rechercherNuesSelonIdMotClef({idMotClef:r,f:_,nRsultatsDsirs:E,toutLeRseau:S=!0}){const C=rechercherNuesSelonIdMotClef(r);return await this.client.rseau.rechercherNues({f:_,nRsultatsDsirs:E,fObjectif:C,toutLeRseau:S})}async rechercherNuesSelonIdVariable({idVariable:r,f:_,nRsultatsDsirs:E,toutLeRseau:S=!0}){const C=rechercherNuesSelonIdVariable(r);return await this.client.rseau.rechercherNues({f:_,nRsultatsDsirs:E,fObjectif:C,toutLeRseau:S})}async rechercherNuesSelonNomMotClef({nomMotClef:r,f:_,nRsultatsDsirs:E,toutLeRseau:S=!0}){const C=rechercherNuesSelonNomMotClef(r);return await this.client.rseau.rechercherNues({f:_,nRsultatsDsirs:E,fObjectif:C,toutLeRseau:S})}async rechercherNuesSelonNomVariable({nomVariable:r,f:_,nRsultatsDsirs:E,toutLeRseau:S=!0}){const C=rechercherNuesSelonNomVariable(r);return await this.client.rseau.rechercherNues({f:_,nRsultatsDsirs:E,fObjectif:C,toutLeRseau:S})}async rechercherNuesSelonMotClef({texte:r,f:_,nRsultatsDsirs:E,toutLeRseau:S=!0}){const C=rechercherNuesSelonMotClef(r);return await this.client.rseau.rechercherNues({f:_,nRsultatsDsirs:E,fObjectif:C,toutLeRseau:S})}async rechercherNuesSelonVariable({texte:r,f:_,nRsultatsDsirs:E,toutLeRseau:S=!0}){const C=rechercherNuesSelonVariable(r);return await this.client.rseau.rechercherNues({f:_,nRsultatsDsirs:E,fObjectif:C,toutLeRseau:S})}async rechercherNuesSelonTexte({texte:r,f:_,nRsultatsDsirs:E,toutLeRseau:S=!0}){const C=rechercherNuesSelonTexte(r);return await this.client.rseau.rechercherNues({f:_,nRsultatsDsirs:E,fObjectif:C,toutLeRseau:S})}}__decorate([cacheRechercheParNRsultats],Recherche.prototype,"rechercherVariables",null);__decorate([cacheRechercheParNRsultats],Recherche.prototype,"rechercherVariablesSelonId",null);__decorate([cacheRechercheParNRsultats],Recherche.prototype,"rechercherVariablesSelonNom",null);__decorate([cacheRechercheParNRsultats],Recherche.prototype,"rechercherVariablesSelonDescr",null);__decorate([cacheRechercheParNRsultats],Recherche.prototype,"rechercherVariablesSelonTexte",null);__decorate([cacheRechercheParNRsultats],Recherche.prototype,"rechercherMotsClefs",null);__decorate([cacheRechercheParNRsultats],Recherche.prototype,"rechercherMotsClefsSelonId",null);__decorate([cacheRechercheParNRsultats],Recherche.prototype,"rechercherMotsClefsSelonNom",null);__decorate([cacheRechercheParNRsultats],Recherche.prototype,"rechercherMotsClefsSelonDescr",null);__decorate([cacheRechercheParNRsultats],Recherche.prototype,"rechercherMotsClefsSelonTexte",null);__decorate([cacheRechercheParNRsultats],Recherche.prototype,"rechercherBds",null);__decorate([cacheRechercheParNRsultats],Recherche.prototype,"rechercherBdsSelonId",null);__decorate([cacheRechercheParNRsultats],Recherche.prototype,"rechercherBdsSelonNom",null);__decorate([cacheRechercheParNRsultats],Recherche.prototype,"rechercherBdsSelonDescr",null);__decorate([cacheRechercheParNRsultats],Recherche.prototype,"rechercherBdsSelonIdMotClef",null);__decorate([cacheRechercheParNRsultats],Recherche.prototype,"rechercherBdsSelonIdVariable",null);__decorate([cacheRechercheParNRsultats],Recherche.prototype,"rechercherBdsSelonNomMotClef",null);__decorate([cacheRechercheParNRsultats],Recherche.prototype,"rechercherBdsSelonNomVariable",null);__decorate([cacheRechercheParNRsultats],Recherche.prototype,"rechercherBdsSelonMotClef",null);__decorate([cacheRechercheParNRsultats],Recherche.prototype,"rechercherBdsSelonVariable",null);__decorate([cacheRechercheParNRsultats],Recherche.prototype,"rechercherBdsSelonTexte",null);__decorate([cacheRechercheParNRsultats],Recherche.prototype,"rechercherProfilsSelonId",null);__decorate([cacheRechercheParNRsultats],Recherche.prototype,"rechercherProfilsSelonNom",null);__decorate([cacheRechercheParNRsultats],Recherche.prototype,"rechercherProfilsSelonImage",null);__decorate([cacheRechercheParNRsultats],Recherche.prototype,"rechercherProfilsSelonActivit",null);__decorate([cacheRechercheParNRsultats],Recherche.prototype,"rechercherProfilsSelonCourriel",null);__decorate([cacheRechercheParNRsultats],Recherche.prototype,"rechercherProfilsSelonTexte",null);__decorate([cacheRechercheParNRsultats],Recherche.prototype,"rechercherProjets",null);__decorate([cacheRechercheParNRsultats],Recherche.prototype,"rechercherProjetsSelonId",null);__decorate([cacheRechercheParNRsultats],Recherche.prototype,"rechercherProjetsSelonNom",null);__decorate([cacheRechercheParNRsultats],Recherche.prototype,"rechercherProjetsSelonDescr",null);__decorate([cacheRechercheParNRsultats],Recherche.prototype,"rechercherProjetsSelonIdVariable",null);__decorate([cacheRechercheParNRsultats],Recherche.prototype,"rechercherProjetsSelonNomVariable",null);__decorate([cacheRechercheParNRsultats],Recherche.prototype,"rechercherProjetsSelonVariable",null);__decorate([cacheRechercheParNRsultats],Recherche.prototype,"rechercherProjetsSelonIdMotClef",null);__decorate([cacheRechercheParNRsultats],Recherche.prototype,"rechercherProjetsSelonNomMotClef",null);__decorate([cacheRechercheParNRsultats],Recherche.prototype,"rechercherProjetsSelonMotClef",null);__decorate([cacheRechercheParNRsultats],Recherche.prototype,"rechercherProjetsSelonIdBd",null);__decorate([cacheRechercheParNRsultats],Recherche.prototype,"rechercherProjetsSelonBd",null);__decorate([cacheRechercheParNRsultats],Recherche.prototype,"rechercherProjetsSelonTexte",null);__decorate([cacheRechercheParNRsultats],Recherche.prototype,"rechercherNues",null);__decorate([cacheRechercheParNRsultats],Recherche.prototype,"rechercherNuesSelonId",null);__decorate([cacheRechercheParNRsultats],Recherche.prototype,"rechercherNuesSelonNom",null);__decorate([cacheRechercheParNRsultats],Recherche.prototype,"rechercherNuesSelonDescr",null);__decorate([cacheRechercheParNRsultats],Recherche.prototype,"rechercherNuesSelonIdMotClef",null);__decorate([cacheRechercheParNRsultats],Recherche.prototype,"rechercherNuesSelonIdVariable",null);__decorate([cacheRechercheParNRsultats],Recherche.prototype,"rechercherNuesSelonNomMotClef",null);__decorate([cacheRechercheParNRsultats],Recherche.prototype,"rechercherNuesSelonNomVariable",null);__decorate([cacheRechercheParNRsultats],Recherche.prototype,"rechercherNuesSelonMotClef",null);__decorate([cacheRechercheParNRsultats],Recherche.prototype,"rechercherNuesSelonVariable",null);__decorate([cacheRechercheParNRsultats],Recherche.prototype,"rechercherNuesSelonTexte",null);class ImportateurFeuilleCalcul{doc;constructor(r){this.doc=r}obtNomsTableaux(){return this.doc.SheetNames}obtColsTableau(r){const _=this.doc.Sheets[r];return(utils.sheet_to_json(_,{header:1})[0]||[]).map(S=>S.toString())}obtDonnes(r,_){const E=this.doc.Sheets[r],S=utils.sheet_to_json(E);if(Array.isArray(_))return S.map(C=>Object.fromEntries(Object.keys(C).filter(A=>_.includes(A)).map(A=>[A,C[A]])));{const C=Object.fromEntries(Object.entries(_).map(([A,I])=>[I,A]));return S.map(A=>Object.fromEntries(Object.keys(A).filter(I=>Object.keys(C).includes(I)).map(I=>[C[I],A[I]])))}}}const copieProfonde=n=>JSON.parse(JSON.stringify(n)),estUnDic=n=>typeof n=="object"&&!Array.isArray(n),estUneListe=n=>Array.isArray(n),extraireBranches=(n,r)=>{let _;if(!r.length)return _=estUnDic(n)?Object.values(n):n,{base:{},branches:_};const E=extraireDonnes(n,r.slice(0,r.length-1)),S=r[r.length-1];let C;if(typeof S=="number")if(estUneListe(E)){const A=E[S];if(typeof A!="object")throw new Error(A.toString());C=A,delete E[S]}else throw new Error(`${S} ne peut pas indexer une liste.`);else if(typeof S=="string")if(estUnDic(E)){const A=E[S];if(typeof A!="object")throw new Error(A.toString());C=A,delete E[S]}else throw new Error(`${S} ne peut pas indexer un objet.`);else throw new Error(`${S} n'est pas une clef valide.`);if(estUnDic(C))_=Object.values(C);else if(estUneListe(C))_=C;else throw Error(JSON.stringify(C));return{base:n,branches:_}},injecterBranche=(n,r,_)=>{if(!r.length)Object.assign(n,_);else{const E=r.slice(1,r.length),S=extraireDonnes(n,E),C=r[r.length-1];if(typeof C=="number")if(estUneListe(S))S[C]=_;else throw new Error(`${C} ne peut pas indexer une liste.`);else if(typeof C=="string")if(estUnDic(S))S[C]=_;else throw new Error(`${C} ne peut pas indexer un objet.`);else throw new Error(`${C} n'est pas une clef valide.`)}},aplatirDonnes=(n,r=[],_,E=[])=>{r[r.length-1]!==-1&&r.push(-1);const S=r.indexOf(-1),C=r.slice(0,S),A=r.slice(S+1,r.length),{base:I,branches:B}=extraireBranches(n,C);for(const O of B){if(typeof O!="object")throw new Error(O.toString());const N=copieProfonde(I);injecterBranche(N,C,O),A.length?aplatirDonnes(O,A,N,E):E.push(N)}return E},extraireDonnes=(n,r)=>{let _=n;for(const E of r)if(typeof E=="number")if(estUneListe(_))_=_[E];else throw new Error(`${E} ne peut pas indexer une liste.`);else if(typeof E=="string")if(estUnDic(_))_=_[E];else throw new Error(`${E} ne peut pas indexer un objet.`);else throw new Error(`Clef de type non indexable: ${E}`);return _};class ImportateurDonnesJSON{donnesJSON;constructor(r){this.donnesJSON=r}obtDonnes(r,_,E){let S=[],C=extraireDonnes(this.donnesJSON,r);if(typeof C!="object")throw new Error(`Type de donnes erron: ${C.toString()}`);C=aplatirDonnes(C,_);for(const A of C){if(typeof A!="object")throw new Error(`lment de type non support: ${A}`);S=[Object.fromEntries(Object.keys(E).map(B=>{const O=E[B];let N;try{N=extraireDonnes(A,O)}catch{N=void 0}return[B,N]}).filter(B=>B[1]!==void 0)),...S]}return S}}(isElectronMain||isNode)&&(__vitePreload(()=>Promise.resolve().then(()=>__viteBrowserExternal),void 0).then(n=>set_fs(n)),__vitePreload(()=>Promise.resolve().then(()=>stream),void 0).then(n=>__stream.set_readable(n.Readable)));const MESSAGE_NON_DISPO_NAVIGATEUR="L'automatisation de l'importation des fichiers locaux n'est pas disponible sur la version apli internet de Constellation.",schmaBdAutomatisations={type:"object",additionalProperties:{type:"object",anyOf:[{type:"object",properties:{type:{type:"string"},id:{type:"string"},frquence:{type:"object",properties:{n:{type:"number"},units:{type:"string"}},nullable:!0,required:["n","units"]},idObjet:{type:"string"},typeObjet:{type:"string"},formatDoc:{type:"string"},dossier:{type:"string",nullable:!0},langues:{type:"array",items:{type:"string"},nullable:!0},dispositifs:{type:"array",items:{type:"string"}},inclureFichiersSFIP:{type:"boolean"},nRsultatsDsirsNue:{type:"integer",nullable:!0}},required:["type","idObjet","typeObjet","formatDoc","dispositifs","inclureFichiersSFIP"]},{type:"object",properties:{id:{type:"string"},frquence:{type:"object",properties:{n:{type:"number"},units:{type:"string"}},nullable:!0,required:["n","units"]},idTableau:{type:"string"},dispositif:{type:"string"},source:{type:"object",properties:{typeSource:{type:"string"},adresseFichier:{type:"string",nullable:!0},info:{type:"object",additionalProperties:!0,required:[]}},required:["info","typeSource"]},conversions:{type:"object",nullable:!0,additionalProperties:!0,required:[]}},required:["id","idTableau","dispositif","source"]}],required:["id","type"]},required:[]},obtTempsInterval=n=>{const{n:r,units:_}=n;switch(_){case"annes":return r*365.25*24*60*60*1e3;case"mois":return r*30*24*60*60*1e3;case"semaines":return r*7*24*60*60*1e3;case"jours":return r*24*60*60*1e3;case"heures":return r*60*60*1e3;case"minutes":return r*60*1e3;case"secondes":return r*1e3;case"millisecondes":return r;default:throw new Error(_)}},gnrerFExportation=(n,r)=>async()=>{const _=await __vitePreload(()=>import("./os-LYVib_3U.js").then(N=>N.a),__vite__mapDeps([])),E=await __vitePreload(()=>Promise.resolve().then(()=>path$1),void 0),S=await __vitePreload(()=>Promise.resolve().then(()=>__viteBrowserExternal),void 0),C=n.dossier?await r.automatisations.rsoudreAdressePriveFichier({clef:n.dossier}):E.join(_.homedir(),"constellation");if(!C)throw new Error("Dossier introuvable");let A;const I=N=>{const U=N.split(".");return`${U[0]}-${Date.now()}.${U[1]}`};switch(n.typeObjet){case"tableau":{const N=await r.tableaux.exporterDonnes({idTableau:n.idObjet,langues:n.langues});A=N.nomFichier,n.copies&&(A=I(A)),await r.bds.exporterDocumentDonnes({donnes:N,formatDoc:n.formatDoc,dossier:C,inclureFichiersSFIP:n.inclureFichiersSFIP});break}case"bd":{const N=await r.bds.exporterDonnes({idBd:n.idObjet,langues:n.langues});A=N.nomFichier,n.copies&&(A=I(A)),await r.bds.exporterDocumentDonnes({donnes:N,formatDoc:n.formatDoc,dossier:C,inclureFichiersSFIP:n.inclureFichiersSFIP});break}case"projet":{const N=await r.projets.exporterDonnes({idProjet:n.idObjet,langues:n.langues});A=N.nomFichier,n.copies&&(A=I(A)),await r.projets.exporterDocumentDonnes({donnes:N,formatDoc:n.formatDoc,dossier:C,inclureFichiersSFIP:n.inclureFichiersSFIP});break}case"nue":{const N=await r.nues.exporterDonnesNue({idNue:n.idObjet,langues:n.langues,nRsultatsDsirs:n.nRsultatsDsirsNue||1e3,hritage:n.hritage});A=N.nomFichier,n.copies&&(A=I(A)),await r.bds.exporterDocumentDonnes({donnes:N,formatDoc:n.formatDoc,dossier:C,inclureFichiersSFIP:n.inclureFichiersSFIP});break}default:throw new Error(n.typeObjet)}const B=S.readdirSync(C).filter(N=>{try{return S.statSync(N).isFile()&&O(E.basename(N),A)}catch{return!1}}),O=(N,U)=>{const j=N.split(".").pop()||"";return`${N.slice(0,-(j?.length+1)).split("-").slice(0,-1).join("")}.${j}`===U};if(n.copies){if(n.copies.type==="n"){const N=n.copies.n-B.length;N>0&&B.map(Z=>({temps:new Date(S.statSync(Z).mtime).valueOf(),fichier:Z})).sort((Z,X)=>Z.temps>X.temps?1:-1).slice(N).map(Z=>Z.fichier).forEach(Z=>S.rmSync(Z))}else if(n.copies.type==="temps"){const N=Date.now(),{temps:U}=n.copies;B.filter(z=>{const Z=new Date(S.statSync(z).mtime).valueOf();return N-Z<obtTempsInterval(U)}).forEach(z=>S.rmSync(z))}}},gnrerFAuto=(n,r)=>{switch(n.type){case"importation":return async()=>{const _=async A=>await r.automatisations.rsoudreAdressePriveFichier({clef:A})||void 0,E=await r.automatisations.obtDonnesImportation(n,_),S=await __vitePreload(()=>Promise.resolve().then(()=>path$1),void 0);let C;if(n.source.typeSource==="fichier"&&n.source.adresseFichier){const A=await _(n.source.adresseFichier);A&&(C=S.dirname(A))}await r.tableaux.importerDonnes({idTableau:n.idTableau,donnes:E,conversions:n.conversions,cheminBaseFichiers:C})};case"exportation":return gnrerFExportation(n,r);default:throw new Error(n)}},lancerAutomatisation=async({spc:n,idSpc:r,client:_,ftat:E})=>{const S=gnrerFAuto(n,_),C=`auto: ${r}`,A=n.frquence?obtTempsInterval(n.frquence):void 0,I=new s$1;let B="";const O=await _.obtDeStockageLocal({clef:C}),N=new Set([O]),U=async j=>{if(N.has(j))return;if(B=j,await I.acquire("opration"),j!==B||N.has(j)){I.release("opration");return}await _.sauvegarderAuStockageLocal({clef:C,val:j}),N.add(j);const z={type:"sync",depuis:new Date().getTime()};E(z);try{if(await S(),A){const Z={type:"programme",:Date.now()+A};E(Z)}else E({type:"coute"})}catch(Z){const X={type:"erreur",erreur:JSON.stringify({nom:Z.name,message:Z.message,pile:Z.stack,cause:Z.cause},void 0,2),prochaineProgramme:A?Date.now()+A:void 0};E(X)}I.release("opration")};if(n.frquence){E({type:"programme",:A});const z={},Z=async()=>{const Te=new Date().getTime();await U(Te.toString());const xe=setTimeout(Z,A);z.f=async()=>clearTimeout(xe)},X=new Date().getTime(),Q=await _.obtDeStockageLocal({clef:C}),se=Q?parseInt(Q):-1/0,oe=X-se,ue=setTimeout(Z,Math.max(A-oe,0));return z.f=async()=>clearTimeout(ue),async()=>{z.f&&await z.f()}}else switch(E({type:"coute"}),n.type){case"exportation":return n.typeObjet==="nue"?await _.nues.suivreEmpreinteTtesBdsNue({idNue:n.idObjet,f:U}):await _.suivreEmpreinteTtesBdRcursive({idBd:n.idObjet,f:U});case"importation":switch(n.source.typeSource){case"fichier":{if(!isNode&&!isElectronMain)throw new Error(MESSAGE_NON_DISPO_NAVIGATEUR);const z=await __vitePreload(()=>import("chokidar"),__vite__mapDeps([])),Z=await __vitePreload(()=>Promise.resolve().then(()=>__viteBrowserExternal),void 0),{adresseFichier:X}=n.source,Q=await _.automatisations.rsoudreAdressePriveFichier({clef:X});if(!Q||!Z.existsSync(Q))throw new Error(`Fichier ${X} introuvable.`);const se=z.watch(Q);se.on("change",async()=>{const xe=new Date().getTime().toString();U(xe)});const oe=Z.statSync(Q).mtime.getTime(),ue=await _.obtDeStockageLocal({clef:C});if(ue?oe>parseInt(ue):!0){const xe=new Date().getTime().toString();U(xe)}return async()=>await se.close()}case"url":return E({type:"erreur",erreur:"La frquence d'une automatisation d'importation d'URL doit tre spcifie.",prochaineProgramme:void 0}),faisRien;default:throw new Error(n.source)}default:throw new Error(n)}};class AutomatisationActive extends eventsExports.EventEmitter{client;tat;fOublier;constructor(r,_,E){super(),this.client=E,lancerAutomatisation({spc:r,idSpc:_,client:this.client,ftat:S=>{this.tat=S,this.emit("misJour")}}).then(S=>{this.fOublier=S,this.emit("prt")})}async fermer(){this.fOublier||await new Promise(r=>{this.once("prt",()=>{r()})}),await this.fOublier?.()}}const activePourCeDispositif=(n,r)=>{switch(n.type){case"importation":return n.dispositif===r;case"exportation":return n.dispositifs.includes(r);default:throw new Error(n)}},verrou=new s$1;class Automatisations extends ComposanteClientDic{automatisations;vnements;fOublier;constructor({client:r}){super({client:r,clef:"automatisations",schmaBdPrincipale:schmaBdAutomatisations}),this.automatisations={},this.vnements=new eventsExports.EventEmitter,this.initialiser()}async initialiser(){this.fOublier=await this.suivreBdPrincipale({f:r=>this.mettreAutosJour(Object.values(r))})}async pingler(){await this.client.pingles.pinglerBd({id:await this.obtIdBd(),rcursif:!1,fichiers:!1})}async mettreAutosJour(r){await verrou.acquire("miseJour");const _=Object.keys(this.automatisations);for(const S of _)r.find(C=>C.id===S)||await this.fermerAuto(S);const E=await this.client.obtIdDispositif();for(const S of r)if(activePourCeDispositif(S,E)){if(!Object.keys(this.automatisations).includes(S.id)){const C=new AutomatisationActive(S,S.id,this.client);C.on("misJour",()=>this.vnements.emit("misJour")),this.automatisations[S.id]=C}}else this.automatisations[S.id]&&await this.fermerAuto(S.id);verrou.release("miseJour")}async obtDonnesImportation(r,_=async E=>E){const{typeSource:E}=r.source,{formatDonnes:S}=r.source.info;switch(E){case"url":{const{url:C}=r.source;switch(S){case"json":{const{clefsRacine:A,clefslments:I,cols:B}=r.source.info,O=await importerJSONdURL(C);return new ImportateurDonnesJSON(O).obtDonnes(A,I,B)}case"feuilleCalcul":{const{nomTableau:A,cols:I,optionsXLSX:B}=r.source.info,O=await importerFeuilleCalculDURL(C,B);return new ImportateurFeuilleCalcul(O).obtDonnes(A,I)}default:throw new Error(S)}}case"fichier":{if(!isElectronMain&&!isNode)throw new Error(MESSAGE_NON_DISPO_NAVIGATEUR);const C=await __vitePreload(()=>Promise.resolve().then(()=>__viteBrowserExternal),void 0),{adresseFichier:A}=r.source,I=await _(A);if(!I||!C.existsSync(I))throw new Error(`Fichier ${I} introuvable.`);switch(S){case"json":{const{clefsRacine:B,clefslments:O,cols:N}=r.source.info,U=await C.promises.readFile(I),j=JSON.parse(U.toString());return new ImportateurDonnesJSON(j).obtDonnes(B,O,N)}case"feuilleCalcul":{const{nomTableau:B,cols:O}=r.source.info,N=readFileSync(I);return new ImportateurFeuilleCalcul(N).obtDonnes(B,O)}default:throw new Error(S)}}default:throw new Error(E)}}async ajouterAutomatisationExporter({id:r,typeObjet:_,formatDoc:E,inclureFichiersSFIP:S,dossier:C,langues:A,frquence:I,dispositifs:B,nRsultatsDsirsNue:O,hritage:N,copies:U}){const{orbite:j}=await this.client.attendreSfipEtOrbite();B=B||[j.identity.id];const z=v4(),Z=await this.sauvegarderAdressePriveFichier({fichier:C}),X={type:"exportation",id:z,idObjet:r,typeObjet:_,dispositifs:B,frquence:I,formatDoc:E,langues:A,inclureFichiersSFIP:S,dossier:Z,nRsultatsDsirsNue:O,hritage:N,copies:U};Object.keys(X).forEach(oe=>{X[oe]===void 0&&delete X[oe]});const{bd:Q,fOublier:se}=await this.obtBd();return await Q.put(z,X),await se(),z}async ajouterAutomatisationImporter({idTableau:r,source:_,frquence:E,dispositif:S}){const{bd:C,fOublier:A}=await this.obtBd(),{orbite:I}=await this.client.attendreSfipEtOrbite();S=S||I.identity.id;const B=v4();_.typeSource==="fichier"&&(_.adresseFichier=await this.sauvegarderAdressePriveFichier({fichier:_.adresseFichier}));const O={type:"importation",id:B,idTableau:r,dispositif:S,frquence:E,source:_};return Object.keys(O).forEach(N=>{O[N]===void 0&&delete O[N]}),await C.put(B,O),await A(),B}async annulerAutomatisation({id:r}){const{bd:_,fOublier:E}=await this.obtBd();await _.del(r),await E()}async rsoudreAdressePriveFichier({clef:r}){return r?await this.client.obtDeStockageLocal({clef:r}):null}async sauvegarderAdressePriveFichier({fichier:r}){const _="dossier."+v4();return await this.client.sauvegarderAuStockageLocal({clef:_,val:r}),_}async suivreAutomatisations({f:r,idCompte:_}){const E=async S=>{const C=await Promise.all(Object.values(S).map(async A=>{const I=deepcopy(A);if(I.type==="importation"&&I.source.typeSource==="fichier"){const{adresseFichier:B}=I.source;if(B){const O=await this.rsoudreAdressePriveFichier({clef:B});O?I.source.adresseFichier=O:delete I.source.adresseFichier}}else if(I.type==="exportation"){const{dossier:B}=I;if(B){const O=await this.rsoudreAdressePriveFichier({clef:B});O?I.dossier=O:delete I.dossier}}return I}));await r(C)};return await this.suivreBdPrincipale({idCompte:_,f:E})}async suivretatAutomatisations({f:r}){const _=async()=>{const E=Object.fromEntries(Object.keys(this.automatisations).map(S=>[S,this.automatisations[S].tat]).filter(S=>S[1]));await r(E)};return this.vnements.on("misJour",_),async()=>{this.vnements.off("misJour",_)}}async fermerAuto(r){await this.automatisations[r].fermer(),delete this.automatisations[r]}async fermer(){await Promise.all(Object.keys(this.automatisations).map(r=>{this.fermerAuto(r)})),await this.fOublier?.()}}const stockagesLocaux={};class LocalStorage{fichier;_donnes;_vnements;_idRequteSauvegarde;verrou;fOublier;constructor(r){this.fichier=path.join(r,"donnes.json"),this._vnements=new eventsExports.EventEmitter,this.verrou=new s$1,net.existsSync(r)||net.mkdirSync(r);try{this._donnes=JSON.parse(net.readFileSync(this.fichier).toString())}catch{this._donnes={}}const _=()=>{const E=v4();this._idRequteSauvegarde=E,this.sauvegarder(E)};this._vnements.on("sauvegarder",_),this.fOublier=()=>this._vnements.off("sauvegarder",_)}getItem(r){return this._donnes[r]}setItem(r,_){this._donnes[r]=_,this.demanderSauvegarde()}demanderSauvegarde(){this._vnements.emit("sauvegarder")}removeItem(r){delete this._donnes[r],this.demanderSauvegarde()}clear(){this._donnes={},net.rmSync(this.fichier)}async sauvegarder(r){if(await this.verrou.acquire("sauvegarder"),this._idRequteSauvegarde!==r){this.verrou.release("sauvegarder");return}await net.promises.writeFile(this.fichier,JSON.stringify(this._donnes)),this.verrou.release("sauvegarder")}async fermer(){await this.verrou.acquire("sauvegarder"),this.fOublier&&this.fOublier(),this.verrou.release("sauvegarder")}}const obtStockageLocal=async n=>{if(typeof localStorage>"u"||localStorage===null){const r=path.join(n,"stockageLocal");return stockagesLocaux[r]||(stockagesLocaux[r]=new LocalStorage(r)),stockagesLocaux[r]}else return localStorage},exporterStockageLocal=async n=>{const r=await obtStockageLocal(n);return r instanceof LocalStorage?JSON.stringify(r._donnes):JSON.stringify(r)};var sha256$1={exports:{}};(function(n,r){(function(_,E){n.exports=E(requireCore())})(commonjsGlobal,function(_){return function(E){var S=_,C=S.lib,A=C.WordArray,I=C.Hasher,B=S.algo,O=[],N=[];(function(){function z(se){for(var oe=E.sqrt(se),ue=2;ue<=oe;ue++)if(!(se%ue))return!1;return!0}function Z(se){return(se-(se|0))*4294967296|0}for(var X=2,Q=0;Q<64;)z(X)&&(Q<8&&(O[Q]=Z(E.pow(X,1/2))),N[Q]=Z(E.pow(X,1/3)),Q++),X++})();var U=[],j=B.SHA256=I.extend({_doReset:function(){this._hash=new A.init(O.slice(0))},_doProcessBlock:function(z,Z){for(var X=this._hash.words,Q=X[0],se=X[1],oe=X[2],ue=X[3],we=X[4],Te=X[5],xe=X[6],Re=X[7],Ne=0;Ne<64;Ne++){if(Ne<16)U[Ne]=z[Z+Ne]|0;else{var Fe=U[Ne-15],ht=(Fe<<25|Fe>>>7)^(Fe<<14|Fe>>>18)^Fe>>>3,nt=U[Ne-2],Ee=(nt<<15|nt>>>17)^(nt<<13|nt>>>19)^nt>>>10;U[Ne]=ht+U[Ne-7]+Ee+U[Ne-16]}var Ce=we&Te^~we&xe,_e=Q&se^Q&oe^se&oe,Ie=(Q<<30|Q>>>2)^(Q<<19|Q>>>13)^(Q<<10|Q>>>22),He=(we<<26|we>>>6)^(we<<21|we>>>11)^(we<<7|we>>>25),Be=Re+He+Ce+N[Ne]+U[Ne],Ge=Ie+_e;Re=xe,xe=Te,Te=we,we=ue+Be|0,ue=oe,oe=se,se=Q,Q=Be+Ge|0}X[0]=X[0]+Q|0,X[1]=X[1]+se|0,X[2]=X[2]+oe|0,X[3]=X[3]+ue|0,X[4]=X[4]+we|0,X[5]=X[5]+Te|0,X[6]=X[6]+xe|0,X[7]=X[7]+Re|0},_doFinalize:function(){var z=this._data,Z=z.words,X=this._nDataBytes*8,Q=z.sigBytes*8;return Z[Q>>>5]|=128<<24-Q%32,Z[(Q+64>>>9<<4)+14]=E.floor(X/4294967296),Z[(Q+64>>>9<<4)+15]=X,z.sigBytes=Z.length*4,this._process(),this._hash},clone:function(){var z=I.clone.call(this);return z._hash=this._hash.clone(),z}});S.SHA256=I._createHelper(j),S.HmacSHA256=I._createHmacHelper(j)}(Math),_.SHA256})})(sha256$1);var sha256Exports=sha256$1.exports;const sha256=getDefaultExportFromCjs(sha256Exports),schmaStructureBdProtocoles={type:"object",additionalProperties:{type:"array",items:{type:"string"}},required:[]};class Protocoles extends ComposanteClientDic{constructor({client:r}){super({client:r,clef:"protocoles",schmaBdPrincipale:schmaStructureBdProtocoles})}async tablirProtocoles({protocoles:r,idDispositif:_}){_=_||await this.client.obtIdDispositif();const{bd:E,fOublier:S}=await this.obtBd(),C=(await E.allAsJSON())[_]||[];r?(r.some(A=>!C.includes(A))||C.some(A=>!r.includes(A)))&&await E.put(_,r):C.length&&await E.del(_),await S()}async suivreProtocoles({f:r,idCompte:_}){return await this.suivreBdPrincipale({idCompte:_,f:r})}}__decorate([cacheSuivi],Protocoles.prototype,"suivreProtocoles",null);function openFailedError(n){return n=n??new Error("Open failed"),errCode$1(n,"ERR_OPEN_FAILED")}function closeFailedError(n){return n=n??new Error("Close failed"),errCode$1(n,"ERR_CLOSE_FAILED")}function putFailedError(n){return n=n??new Error("Put failed"),errCode$1(n,"ERR_PUT_FAILED")}function getFailedError(n){return n=n??new Error("Get failed"),errCode$1(n,"ERR_GET_FAILED")}function deleteFailedError(n){return n=n??new Error("Delete failed"),errCode$1(n,"ERR_DELETE_FAILED")}function hasFailedError(n){return n=n??new Error("Has failed"),errCode$1(n,"ERR_HAS_FAILED")}function notFoundError$1(n){return n=n??new Error("Not Found"),errCode$1(n,"ERR_NOT_FOUND")}function abortedError(n){return n=n??new Error("Aborted"),errCode$1(n,"ERR_ABORTED")}const ErrorsImport=Object.freeze(Object.defineProperty({__proto__:null,abortedError,closeFailedError,deleteFailedError,getFailedError,hasFailedError,notFoundError:notFoundError$1,openFailedError,putFailedError},Symbol.toStringTag,{value:"Module"}));class BaseBlockstore{has(r,_){return Promise.reject(new Error(".has is not implemented"))}put(r,_,E){return Promise.reject(new Error(".put is not implemented"))}async*putMany(r,_){for await(const{cid:E,block:S}of r)await this.put(E,S,_),yield E}get(r,_){return Promise.reject(new Error(".get is not implemented"))}async*getMany(r,_){for await(const E of r)yield{cid:E,block:await this.get(E,_)}}delete(r,_){return Promise.reject(new Error(".delete is not implemented"))}async*deleteMany(r,_){for await(const E of r)await this.delete(E,_),yield E}async*getAll(r){throw new Error(".getAll is not implemented")}}class MemoryBlockstore extends BaseBlockstore{data;constructor(){super(),this.data=new Map}put(r,_){return this.data.set(base32.encode(r.multihash.bytes),_),r}get(r){const _=this.data.get(base32.encode(r.multihash.bytes));if(_==null)throw notFoundError$1();return _}has(r){return this.data.has(base32.encode(r.multihash.bytes))}async delete(r){this.data.delete(base32.encode(r.multihash.bytes))}async*getAll(){for(const[r,_]of this.data.entries())yield{cid:CID.createV1(code$6,decode$h(base32.decode(r))),block:_}}}function isAsyncIterable$5(n){return n[Symbol.asyncIterator]!=null}function drain(n){if(isAsyncIterable$5(n))return(async()=>{for await(const r of n);})();for(const r of n);}logger$2("blockstore:core:tiered");const Errors={...ErrorsImport};function notFoundError(n){return n=n??new Error("Not Found"),errCode$1(n,"ERR_NOT_FOUND")}const pathSepS="/",pathSepB=new TextEncoder().encode(pathSepS),pathSep=pathSepB[0];class Key{_buf;constructor(r,_){if(typeof r=="string")this._buf=fromString$3(r);else if(r instanceof Uint8Array)this._buf=r;else throw new Error("Invalid key, should be String of Uint8Array");if(_==null&&(_=!0),_&&this.clean(),this._buf.byteLength===0||this._buf[0]!==pathSep)throw new Error("Invalid key")}toString(r="utf8"){return toString$4(this._buf,r)}uint8Array(){return this._buf}get[Symbol.toStringTag](){return`Key(${this.toString()})`}static withNamespaces(r){return new Key(r.join(pathSepS))}static random(){return new Key(Math.random().toString().substring(2))}static asKey(r){return r instanceof Uint8Array||typeof r=="string"?new Key(r):typeof r.uint8Array=="function"?new Key(r.uint8Array()):null}clean(){if((this._buf==null||this._buf.byteLength===0)&&(this._buf=pathSepB),this._buf[0]!==pathSep){const r=new Uint8Array(this._buf.byteLength+1);r.fill(pathSep,0,1),r.set(this._buf,1),this._buf=r}for(;this._buf.byteLength>1&&this._buf[this._buf.byteLength-1]===pathSep;)this._buf=this._buf.subarray(0,-1)}less(r){const _=this.list(),E=r.list();for(let S=0;S<_.length;S++){if(E.length<S+1)return!1;const C=_[S],A=E[S];if(C<A)return!0;if(C>A)return!1}return _.length<E.length}reverse(){return Key.withNamespaces(this.list().slice().reverse())}namespaces(){return this.list()}baseNamespace(){const r=this.namespaces();return r[r.length-1]}list(){return this.toString().split(pathSepS).slice(1)}type(){return namespaceType(this.baseNamespace())}name(){return namespaceValue(this.baseNamespace())}instance(r){return new Key(this.toString()+":"+r)}path(){let r=this.parent().toString();return r.endsWith(pathSepS)||(r+=pathSepS),r+=this.type(),new Key(r)}parent(){const r=this.list();return r.length===1?new Key(pathSepS):new Key(r.slice(0,-1).join(pathSepS))}child(r){return this.toString()===pathSepS?r:r.toString()===pathSepS?this:new Key(this.toString()+r.toString(),!1)}isAncestorOf(r){return r.toString()===this.toString()?!1:r.toString().startsWith(this.toString())}isDecendantOf(r){return r.toString()===this.toString()?!1:this.toString().startsWith(r.toString())}isTopLevel(){return this.list().length===1}concat(...r){return Key.withNamespaces([...this.namespaces(),...flatten(r.map(_=>_.namespaces()))])}}function namespaceType(n){const r=n.split(":");return r.length<2?"":r.slice(0,-1).join(":")}function namespaceValue(n){const r=n.split(":");return r[r.length-1]}function flatten(n){return[].concat(...n)}const SHARDING_FN="SHARDING";function isAsyncIterable$4(n){return n[Symbol.asyncIterator]!=null}function sort(n,r){return isAsyncIterable$4(n)?async function*(){yield*(await all$1(n)).sort(r)}():function*(){yield*all$1(n).sort(r)}()}function isAsyncIterable$3(n){return n[Symbol.asyncIterator]!=null}function take(n,r){return isAsyncIterable$3(n)?async function*(){let _=0;if(!(r<1)){for await(const E of n)if(yield E,_++,_===r)return}}():function*(){let _=0;if(!(r<1)){for(const E of n)if(yield E,_++,_===r)return}}()}class BaseDatastore{put(r,_,E){return Promise.reject(new Error(".put is not implemented"))}get(r,_){return Promise.reject(new Error(".get is not implemented"))}has(r,_){return Promise.reject(new Error(".has is not implemented"))}delete(r,_){return Promise.reject(new Error(".delete is not implemented"))}async*putMany(r,_={}){for await(const{key:E,value:S}of r)await this.put(E,S,_),yield E}async*getMany(r,_={}){for await(const E of r)yield{key:E,value:await this.get(E,_)}}async*deleteMany(r,_={}){for await(const E of r)await this.delete(E,_),yield E}batch(){let r=[],_=[];return{put(E,S){r.push({key:E,value:S})},delete(E){_.push(E)},commit:async E=>{await drain(this.putMany(r,E)),r=[],await drain(this.deleteMany(_,E)),_=[]}}}async*_all(r,_){throw new Error("._all is not implemented")}async*_allKeys(r,_){throw new Error("._allKeys is not implemented")}query(r,_){let E=this._all(r,_);if(r.prefix!=null){const S=r.prefix;E=filter(E,C=>C.key.toString().startsWith(S))}if(Array.isArray(r.filters)&&(E=r.filters.reduce((S,C)=>filter(S,C),E)),Array.isArray(r.orders)&&(E=r.orders.reduce((S,C)=>sort(S,C),E)),r.offset!=null){let S=0;const C=r.offset;E=filter(E,()=>S++>=C)}return r.limit!=null&&(E=take(E,r.limit)),E}queryKeys(r,_){let E=this._allKeys(r,_);if(r.prefix!=null){const S=r.prefix;E=filter(E,C=>C.toString().startsWith(S))}if(Array.isArray(r.filters)&&(E=r.filters.reduce((S,C)=>filter(S,C),E)),Array.isArray(r.orders)&&(E=r.orders.reduce((S,C)=>sort(S,C),E)),r.offset!=null){const S=r.offset;let C=0;E=filter(E,()=>C++>=S)}return r.limit!=null&&(E=take(E,r.limit)),E}}class MemoryDatastore extends BaseDatastore{data;constructor(){super(),this.data=new Map}put(r,_){return this.data.set(r.toString(),_),r}get(r){const _=this.data.get(r.toString());if(_==null)throw notFoundError();return _}has(r){return this.data.has(r.toString())}delete(r){this.data.delete(r.toString())}*_all(){for(const[r,_]of this.data.entries())yield{key:new Key(r),value:_}}*_allKeys(){for(const r of this.data.keys())yield new Key(r)}}new Key(SHARDING_FN);logger$2("datastore:core:tiered");function anySignal(n){const r=new globalThis.AbortController;function _(){r.abort();for(const C of n)C?.removeEventListener!=null&&C.removeEventListener("abort",_)}for(const C of n){if(C?.aborted===!0){_();break}C?.addEventListener!=null&&C.addEventListener("abort",_)}function E(){for(const C of n)C?.removeEventListener!=null&&C.removeEventListener("abort",_)}const S=r.signal;return S.clear=E,S}function isAsyncIterable$2(n){return n[Symbol.asyncIterator]!=null}function isPromise$4(n){return n?.then!=null}function forEach(n,r){if(isAsyncIterable$2(n))return async function*(){for await(const I of n){const B=r(I);isPromise$4(B)&&await B,yield I}}();const _=peekable(n),{value:E,done:S}=_.next();if(S===!0)return function*(){}();if(typeof r(E)?.then=="function")return async function*(){yield E;for await(const I of _){const B=r(I);isPromise$4(B)&&await B,yield I}}();const A=r;return function*(){yield E;for(const I of _)A(I),yield I}()}class TrackedMap extends Map{metric;constructor(r){super();const{name:_,metrics:E}=r;this.metric=E.registerMetric(_),this.updateComponentMetric()}set(r,_){return super.set(r,_),this.updateComponentMetric(),this}delete(r){const _=super.delete(r);return this.updateComponentMetric(),_}clear(){super.clear(),this.updateComponentMetric()}updateComponentMetric(){this.metric.update(this.size)}}function trackedMap(n){const{name:r,metrics:_}=n;let E;return _!=null?E=new TrackedMap({name:r,metrics:_}):E=new Map,E}var encode_1$1=encode$8,MSB$4=128,REST$4=127,MSBALL$1=~REST$4,INT$1=Math.pow(2,31);function encode$8(n,r,_){r=r||[],_=_||0;for(var E=_;n>=INT$1;)r[_++]=n&255|MSB$4,n/=128;for(;n&MSBALL$1;)r[_++]=n&255|MSB$4,n>>>=7;return r[_]=n|0,encode$8.bytes=_-E+1,r}var decode$6=read$2,MSB$3=128,REST$3=127;function read$2(n,E){var _=0,E=E||0,S=0,C=E,A,I=n.length;do{if(C>=I)throw read$2.bytes=0,new RangeError("Could not decode varint");A=n[C++],_+=S<28?(A&REST$3)<<S:(A&REST$3)*Math.pow(2,S),S+=7}while(A>=MSB$3);return read$2.bytes=C-E,_}var N1$1=Math.pow(2,7),N2$1=Math.pow(2,14),N3$1=Math.pow(2,21),N4$1=Math.pow(2,28),N5$1=Math.pow(2,35),N6$1=Math.pow(2,42),N7$1=Math.pow(2,49),N8$1=Math.pow(2,56),N9$1=Math.pow(2,63),length$2=function(n){return n<N1$1?1:n<N2$1?2:n<N3$1?3:n<N4$1?4:n<N5$1?5:n<N6$1?6:n<N7$1?7:n<N8$1?8:n<N9$1?9:10},varint$3={encode:encode_1$1,decode:decode$6,encodingLength:length$2};const varint$2=varint$3;var src$3=n=>{if(!(n instanceof Uint8Array))throw new Error("arg needs to be a Uint8Array");const r=[];for(;n.length>0;){const _=varint$2.decode(n);r.push(_),n=n.slice(varint$2.decode.bytes)}return r};const vd=getDefaultExportFromCjs(src$3);class WantListEntry{_refCounter;cid;priority;wantType;constructor(r,_,E){this._refCounter=1,this.cid=r,this.priority=_??1,this.wantType=E}inc(){this._refCounter+=1}dec(){this._refCounter=Math.max(0,this._refCounter-1)}hasRefs(){return this._refCounter>0}get[Symbol.toStringTag](){return`WantlistEntry <key: ${this.cid.toString(base58btc)}, priority: ${this.priority}, refs: ${this._refCounter}>`}equals(r){return this._refCounter===r._refCounter&&this.cid.equals(r.cid)&&this.priority===r.priority&&this.wantType===r.wantType}}class BitswapMessageEntry{entry;cancel;sendDontHave;constructor(r,_,E,S,C){this.entry=new WantListEntry(r,_,E),this.cancel=!!S,this.sendDontHave=!!C}get cid(){return this.entry.cid}set cid(r){this.entry.cid=r}get priority(){return this.entry.priority}set priority(r){this.entry.priority=r}get wantType(){return this.entry.wantType}set wantType(r){this.entry.wantType=r}get[Symbol.toStringTag](){return`BitswapMessageEntry ${this.cid.toString(base58btc)} <cancel: ${this.cancel}, priority: ${this.priority}>`}equals(r){return this.cancel===r.cancel&&this.sendDontHave===r.sendDontHave&&this.wantType===r.wantType&&this.entry.equals(r.entry)}}const logger$1=(n,r)=>{const _=["bitswap"];return r!=null&&_.push(r),n!=null&&_.push(`${n.toString().slice(0,8)}`),logger$2(_.join(":"))},isMapEqual=(n,r)=>{if(n.size!==r.size)return!1;for(const[_,E]of n){const S=r.get(_);if(S===void 0||E instanceof Uint8Array&&S instanceof Uint8Array&&!equals$1(E,S)||E instanceof BitswapMessageEntry&&S instanceof BitswapMessageEntry&&!E.equals(S))return!1}return!0};var encode_1=encode$7,MSB$2=128,REST$2=127,MSBALL=~REST$2,INT=Math.pow(2,31);function encode$7(n,r,_){if(Number.MAX_SAFE_INTEGER&&n>Number.MAX_SAFE_INTEGER)throw encode$7.bytes=0,new RangeError("Could not encode varint");r=r||[],_=_||0;for(var E=_;n>=INT;)r[_++]=n&255|MSB$2,n/=128;for(;n&MSBALL;)r[_++]=n&255|MSB$2,n>>>=7;return r[_]=n|0,encode$7.bytes=_-E+1,r}var decode$5=read$1,MSB$1=128,REST$1=127;function read$1(n,E){var _=0,E=E||0,S=0,C=E,A,I=n.length;do{if(C>=I||S>49)throw read$1.bytes=0,new RangeError("Could not decode varint");A=n[C++],_+=S<28?(A&REST$1)<<S:(A&REST$1)*Math.pow(2,S),S+=7}while(A>=MSB$1);return read$1.bytes=C-E,_}var N1=Math.pow(2,7),N2=Math.pow(2,14),N3=Math.pow(2,21),N4=Math.pow(2,28),N5=Math.pow(2,35),N6=Math.pow(2,42),N7=Math.pow(2,49),N8=Math.pow(2,56),N9=Math.pow(2,63),length$1=function(n){return n<N1?1:n<N2?2:n<N3?3:n<N4?4:n<N5?5:n<N6?6:n<N7?7:n<N8?8:n<N9?9:10},varint$1={encode:encode_1,decode:decode$5,encodingLength:length$1};const index$1=getDefaultExportFromCjs(varint$1);function varintEncoder(n){let r=new Uint8Array(n.reduce((E,S)=>E+index$1.encodingLength(S),0)),_=0;for(const E of n)r=varint$1.encode(E,r,_),_+=index$1.encodingLength(E);return r}var Message$4;(function(n){(function(S){let C;(function(B){B.Block="Block",B.Have="Have"})(C=S.WantType||(S.WantType={}));let A;(function(B){B[B.Block=0]="Block",B[B.Have=1]="Have"})(A||(A={})),function(B){B.codec=()=>enumeration(A)}(C=S.WantType||(S.WantType={})),function(B){let O;B.codec=()=>(O==null&&(O=message((N,U,j={})=>{j.lengthDelimited!==!1&&U.fork(),N.block!=null&&N.block.byteLength>0&&(U.uint32(10),U.bytes(N.block)),N.priority!=null&&N.priority!==0&&(U.uint32(16),U.int32(N.priority)),N.cancel!=null&&N.cancel!==!1&&(U.uint32(24),U.bool(N.cancel)),N.wantType!=null&&A[N.wantType]!==0&&(U.uint32(32),n.Wantlist.WantType.codec().encode(N.wantType,U)),N.sendDontHave!=null&&N.sendDontHave!==!1&&(U.uint32(40),U.bool(N.sendDontHave)),j.lengthDelimited!==!1&&U.ldelim()},(N,U)=>{const j={block:new Uint8Array(0),priority:0,cancel:!1,wantType:C.Block,sendDontHave:!1},z=U==null?N.len:N.pos+U;for(;N.pos<z;){const Z=N.uint32();switch(Z>>>3){case 1:j.block=N.bytes();break;case 2:j.priority=N.int32();break;case 3:j.cancel=N.bool();break;case 4:j.wantType=n.Wantlist.WantType.codec().decode(N);break;case 5:j.sendDontHave=N.bool();break;default:N.skipType(Z&7);break}}return j})),O),B.encode=N=>encodeMessage(N,B.codec()),B.decode=N=>decodeMessage$1(N,B.codec())}(S.Entry||(S.Entry={}));let I;S.codec=()=>(I==null&&(I=message((B,O,N={})=>{if(N.lengthDelimited!==!1&&O.fork(),B.entries!=null)for(const U of B.entries)O.uint32(10),n.Wantlist.Entry.codec().encode(U,O);B.full!=null&&B.full!==!1&&(O.uint32(16),O.bool(B.full)),N.lengthDelimited!==!1&&O.ldelim()},(B,O)=>{const N={entries:[],full:!1},U=O==null?B.len:B.pos+O;for(;B.pos<U;){const j=B.uint32();switch(j>>>3){case 1:N.entries.push(n.Wantlist.Entry.codec().decode(B,B.uint32()));break;case 2:N.full=B.bool();break;default:B.skipType(j&7);break}}return N})),I),S.encode=B=>encodeMessage(B,S.codec()),S.decode=B=>decodeMessage$1(B,S.codec())})(n.Wantlist||(n.Wantlist={})),function(S){let C;S.codec=()=>(C==null&&(C=message((A,I,B={})=>{B.lengthDelimited!==!1&&I.fork(),A.prefix!=null&&A.prefix.byteLength>0&&(I.uint32(10),I.bytes(A.prefix)),A.data!=null&&A.data.byteLength>0&&(I.uint32(18),I.bytes(A.data)),B.lengthDelimited!==!1&&I.ldelim()},(A,I)=>{const B={prefix:new Uint8Array(0),data:new Uint8Array(0)},O=I==null?A.len:A.pos+I;for(;A.pos<O;){const N=A.uint32();switch(N>>>3){case 1:B.prefix=A.bytes();break;case 2:B.data=A.bytes();break;default:A.skipType(N&7);break}}return B})),C),S.encode=A=>encodeMessage(A,S.codec()),S.decode=A=>decodeMessage$1(A,S.codec())}(n.Block||(n.Block={}));let r;(function(S){S.Have="Have",S.DontHave="DontHave"})(r=n.BlockPresenceType||(n.BlockPresenceType={}));let _;(function(S){S[S.Have=0]="Have",S[S.DontHave=1]="DontHave"})(_||(_={})),function(S){S.codec=()=>enumeration(_)}(r=n.BlockPresenceType||(n.BlockPresenceType={})),function(S){let C;S.codec=()=>(C==null&&(C=message((A,I,B={})=>{B.lengthDelimited!==!1&&I.fork(),A.cid!=null&&A.cid.byteLength>0&&(I.uint32(10),I.bytes(A.cid)),A.type!=null&&_[A.type]!==0&&(I.uint32(16),n.BlockPresenceType.codec().encode(A.type,I)),B.lengthDelimited!==!1&&I.ldelim()},(A,I)=>{const B={cid:new Uint8Array(0),type:r.Have},O=I==null?A.len:A.pos+I;for(;A.pos<O;){const N=A.uint32();switch(N>>>3){case 1:B.cid=A.bytes();break;case 2:B.type=n.BlockPresenceType.codec().decode(A);break;default:A.skipType(N&7);break}}return B})),C),S.encode=A=>encodeMessage(A,S.codec()),S.decode=A=>decodeMessage$1(A,S.codec())}(n.BlockPresence||(n.BlockPresence={}));let E;n.codec=()=>(E==null&&(E=message((S,C,A={})=>{if(A.lengthDelimited!==!1&&C.fork(),S.wantlist!=null&&(C.uint32(10),n.Wantlist.codec().encode(S.wantlist,C)),S.blocks!=null)for(const I of S.blocks)C.uint32(18),C.bytes(I);if(S.payload!=null)for(const I of S.payload)C.uint32(26),n.Block.codec().encode(I,C);if(S.blockPresences!=null)for(const I of S.blockPresences)C.uint32(34),n.BlockPresence.codec().encode(I,C);S.pendingBytes!=null&&S.pendingBytes!==0&&(C.uint32(40),C.int32(S.pendingBytes)),A.lengthDelimited!==!1&&C.ldelim()},(S,C)=>{const A={blocks:[],payload:[],blockPresences:[],pendingBytes:0},I=C==null?S.len:S.pos+C;for(;S.pos<I;){const B=S.uint32();switch(B>>>3){case 1:A.wantlist=n.Wantlist.codec().decode(S,S.uint32());break;case 2:A.blocks.push(S.bytes());break;case 3:A.payload.push(n.Block.codec().decode(S,S.uint32()));break;case 4:A.blockPresences.push(n.BlockPresence.codec().decode(S,S.uint32()));break;case 5:A.pendingBytes=S.int32();break;default:S.skipType(B&7);break}}return A})),E),n.encode=S=>encodeMessage(S,n.codec()),n.decode=S=>decodeMessage$1(S,n.codec())})(Message$4||(Message$4={}));class BitswapMessage{static Entry=BitswapMessageEntry;static WantType={Block:Message$4.Wantlist.WantType.Block,Have:Message$4.Wantlist.WantType.Have};static BlockPresenceType={Have:Message$4.BlockPresenceType.Have,DontHave:Message$4.BlockPresenceType.DontHave};static deserialize=async(r,_)=>{const E=Message$4.decode(r),S=E.wantlist?.full===!0,C=new BitswapMessage(S);return E.wantlist?.entries.forEach(A=>{if(A.block==null)return;const I=CID.decode(A.block);C.addEntry(I,A.priority??0,A.wantType,!!A.cancel,!!A.sendDontHave)}),E.blockPresences.forEach(A=>{if(A.cid==null)return;const I=CID.decode(A.cid);A.type===BitswapMessage.BlockPresenceType.Have?C.addHave(I):C.addDontHave(I)}),E.blocks.length>0?(await Promise.all(E.blocks.map(async A=>{const I=await sha256$6.digest(A),B=CID.createV0(I);C.addBlock(B,A)})),C):(E.payload.length>0&&(await Promise.all(E.payload.map(async A=>{if(A.prefix==null||A.data==null)return;const I=vd(A.prefix),B=I[0],O=I[1],N=I[2],U=N===sha256$6.code?sha256$6:await _?.getHasher(N);if(U==null)throw new CodeError$4("Unknown hash algorithm","ERR_UNKNOWN_HASH_ALG");const j=await U.digest(A.data),z=CID.create(B,O,j);C.addBlock(z,A.data)})),C.setPendingBytes(E.pendingBytes)),C)};static blockPresenceSize=r=>r.bytes.length+1;full;wantlist;blocks;blockPresences;pendingBytes;constructor(r){this.full=r,this.wantlist=new Map,this.blocks=new Map,this.blockPresences=new Map,this.pendingBytes=0}get empty(){return this.blocks.size===0&&this.wantlist.size===0&&this.blockPresences.size===0}addEntry(r,_,E,S,C){E==null&&(E=BitswapMessage.WantType.Block);const A=r.toString(base58btc),I=this.wantlist.get(A);I!=null?(I.wantType===E&&(I.priority=_),S===!0&&(I.cancel=!!S),C===!0&&(I.sendDontHave=!!C),E===BitswapMessage.WantType.Block&&I.wantType===BitswapMessage.WantType.Have&&(I.wantType=E)):this.wantlist.set(A,new BitswapMessageEntry(r,_,E,S,C))}addBlock(r,_){const E=r.toString(base58btc);this.blocks.set(E,_)}addHave(r){const _=r.toString(base58btc);this.blockPresences.has(_)||this.blockPresences.set(_,BitswapMessage.BlockPresenceType.Have)}addDontHave(r){const _=r.toString(base58btc);this.blockPresences.has(_)||this.blockPresences.set(_,BitswapMessage.BlockPresenceType.DontHave)}cancel(r){const _=r.toString(base58btc);this.wantlist.delete(_),this.addEntry(r,0,BitswapMessage.WantType.Block,!0,!1)}setPendingBytes(r){this.pendingBytes=r}serializeToBitswap100(){return Message$4.encode({wantlist:{entries:Array.from(this.wantlist.values()).map(r=>({block:r.cid.bytes,priority:Number(r.priority),cancel:!!r.cancel,wantType:Message$4.Wantlist.WantType.Block,sendDontHave:!1})),full:!!this.full},blocks:Array.from(this.blocks.values())})}serializeToBitswap110(){const r={wantlist:{entries:Array.from(this.wantlist.values()).map(_=>({block:_.cid.bytes,priority:Number(_.priority),wantType:_.wantType,cancel:!!_.cancel,sendDontHave:!!_.sendDontHave})),full:!!this.full},blockPresences:[],payload:[],pendingBytes:this.pendingBytes,blocks:[]};for(const[_,E]of this.blocks.entries()){const S=CID.parse(_),C=S.version,A=S.code,I=S.multihash.code,B=S.multihash.digest.length,O=varintEncoder([C,A,I,B]);r.payload.push({prefix:O,data:E})}for(const[_,E]of this.blockPresences)r.blockPresences.push({cid:CID.parse(_).bytes,type:E});return this.pendingBytes>0&&(r.pendingBytes=this.pendingBytes),Message$4.encode(r)}equals(r){return!(this.full!==r.full||this.pendingBytes!==r.pendingBytes||!isMapEqual(this.wantlist,r.wantlist)||!isMapEqual(this.blocks,r.blocks)||!isMapEqual(this.blockPresences,r.blockPresences))}get[Symbol.toStringTag](){const r=Array.from(this.wantlist.keys()),_=Array.from(this.blocks.keys());return`BitswapMessage <full: ${this.full}, list: ${r}, blocks: ${_}>`}}const WantType$1={Block:Message$4.Wantlist.WantType.Block,Have:Message$4.Wantlist.WantType.Have},sortBy=(n,r)=>Array.prototype.slice.call(r,0).sort((_,E)=>{const S=n(_),C=n(E);return S<C?-1:S>C?1:0});class Wantlist{static Entry=WantListEntry;set;_stats;constructor(r,_){this.set=_!=null?trackedMap({name:"ipfs_bitswap_wantlist",metrics:_.metrics}):new Map,this._stats=r}get length(){return this.set.size}add(r,_,E){const S=r.toString(base58btc),C=this.set.get(S);C!=null?(C.inc(),C.priority=_,C.wantType===WantType$1.Have&&E===WantType$1.Block&&(C.wantType=E)):(this.set.set(S,new WantListEntry(r,_,E)),this._stats!=null&&this._stats.push(void 0,"wantListSize",1))}remove(r){const _=r.toString(base58btc),E=this.set.get(_);E!=null&&(E.dec(),!E.hasRefs()&&(this.set.delete(_),this._stats!=null&&this._stats.push(void 0,"wantListSize",-1)))}removeForce(r){this.set.has(r)&&this.set.delete(r)}forEach(r){this.set.forEach(r)}entries(){return this.set.entries()}sortedEntries(){return new Map(sortBy(r=>r[1].key,Array.from(this.set.entries())))}contains(r){const _=r.toString(base58btc);return this.set.has(_)}get(r){const _=r.toString(base58btc);return this.set.get(_)}}class Ledger{partner;wantlist;exchangeCount;accounting;lastExchange;constructor(r){this.partner=r,this.wantlist=new Wantlist,this.exchangeCount=0,this.accounting={bytesSent:0,bytesRecv:0}}sentBytes(r){this.exchangeCount++,this.lastExchange=new Date().getTime(),this.accounting.bytesSent+=r}receivedBytes(r){this.exchangeCount++,this.lastExchange=new Date().getTime(),this.accounting.bytesRecv+=r}wants(r,_,E){this.wantlist.add(r,_,E)}cancelWant(r){this.wantlist.remove(r)}wantlistContains(r){return this.wantlist.get(r)}debtRatio(){return this.accounting.bytesSent/(this.accounting.bytesRecv+1)}}class SortedMap extends Map{_cmp;_keys;constructor(r,_){super(),this._cmp=_??this._defaultSort,this._keys=[];for(const[E,S]of r??[])this.set(E,S)}update(r){if(r<0||r>=this._keys.length)return;const _=this._keys[r];this._keys.splice(r,1);const E=this._find(_);this._keys.splice(E,0,_)}set(r,_){if(this.has(r)){const S=this.indexOf(r);this._keys.splice(S,1)}super.set(r,_);const E=this._find(r);return this._keys.splice(E,0,r),this}clear(){super.clear(),this._keys=[]}delete(r){if(!this.has(r))return!1;const _=this.indexOf(r);return this._keys.splice(_,1),super.delete(r)}indexOf(r){if(!this.has(r))return-1;const _=this._find(r);if(this._keys[_]===r)return _;for(let E=1;E<this._keys.length;E++){if(this._keys[_+E]===r)return _+E;if(this._keys[_-E]===r)return _-E}return-1}_find(r){let _=0,E=this._keys.length;for(;_<E;){const S=_+E>>>1,C=this._kCmp(this._keys[S],r);if(C<0)_=S+1;else if(C>0)E=S;else return S}return _}*keys(){for(const r of this._keys)yield r}*values(){for(const r of this._keys)yield this.get(r)}*entries(){for(const r of this._keys)yield[r,this.get(r)]}*[Symbol.iterator](){yield*this.entries()}forEach(r,_=this){if(r!=null)for(const E of this._keys){const S=this.get(E);if(S==null)throw new Error("Value cannot be undefined");r.apply(_,[[E,S]])}}_defaultSort(r,_){return r[0]<_[0]?-1:_[0]<r[0]?1:0}_kCmp(r,_){return this._cmp([r,this.get(r)],[_,this.get(_)])}}const DefaultTaskMerger$1={hasNewInfo(){return!1},merge(){}};class RequestQueue{_taskMerger;_byPeer;constructor(r=DefaultTaskMerger$1){this._taskMerger=r,this._byPeer=new SortedMap([],PeerTasks.compare)}pushTasks(r,_){let E=this._byPeer.get(r.toString());E==null&&(E=new PeerTasks(r,this._taskMerger)),E.pushTasks(_),this._byPeer.set(r.toString(),E)}popTasks(r){const _=this._head();if(_===void 0)return{tasks:[],pendingSize:0};const{tasks:E,pendingSize:S}=_.popTasks(r);if(E.length===0)return{tasks:E,pendingSize:S};const C=_.peerId;return _.isIdle()?this._byPeer.delete(C.toString()):this._byPeer.update(0),{peerId:C,tasks:E,pendingSize:S}}_head(){if(this._byPeer.size!==0)for(const[,r]of this._byPeer)return r}remove(r,_){this._byPeer.get(_.toString())?.remove(r)}tasksDone(r,_){const E=this._byPeer.get(r.toString());if(E==null)return;const S=this._byPeer.indexOf(r.toString());for(const C of _)E.taskDone(C);this._byPeer.update(S)}}class PeerTasks{peerId;_taskMerger;_activeTotalSize;_pending;_active;constructor(r,_){this.peerId=r,this._taskMerger=_,this._activeTotalSize=0,this._pending=new PendingTasks,this._active=new Set}pushTasks(r){for(const _ of r)this._pushTask(_)}_pushTask(r){if(!this._taskHasMoreInfoThanActiveTasks(r))return;const _=this._pending.get(r.topic);if(_!=null){r.priority>_.priority&&this._pending.updatePriority(r.topic,r.priority),this._taskMerger.merge(r,_);return}this._pending.add(r)}_taskHasMoreInfoThanActiveTasks(r){const _=[];for(const E of this._active)E.topic===r.topic&&_.push(E);return _.length===0?!0:this._taskMerger.hasNewInfo(r,_)}popTasks(r){let _=0;const E=[],S=this._pending.tasks();for(let C=0;C<S.length&&_<r;C++){const A=S[C];E.push(A),_+=A.size,this._pending.delete(A.topic),this._activeTotalSize+=A.size,this._active.add(A)}return{tasks:E,pendingSize:this._pending.totalSize}}taskDone(r){this._active.has(r)&&(this._activeTotalSize-=r.size,this._active.delete(r))}remove(r){this._pending.delete(r)}isIdle(){return this._pending.length===0&&this._active.size===0}static compare(r,_){return r[1]._pending.length===0?1:_[1]._pending.length===0?-1:r[1]._activeTotalSize===_[1]._activeTotalSize?_[1]._pending.length-r[1]._pending.length:r[1]._activeTotalSize-_[1]._activeTotalSize}}class PendingTasks{_tasks;constructor(){this._tasks=new SortedMap([],this._compare)}get length(){return this._tasks.size}get totalSize(){return[...this._tasks.values()].reduce((r,_)=>r+_.task.size,0)}get(r){return this._tasks?.get(r)?.task}add(r){this._tasks.set(r.topic,{created:Date.now(),task:r})}delete(r){this._tasks.delete(r)}tasks(){return[...this._tasks.values()].map(r=>r.task)}updatePriority(r,_){const E=this._tasks.get(r);if(E==null)return;const S=this._tasks.indexOf(r);E.task.priority=_,this._tasks.update(S)}_compare(r,_){return r[1].task.priority===_[1].task.priority?r[1].created-_[1].created:_[1].task.priority-r[1].task.priority}}const DefaultTaskMerger={hasNewInfo(n,r){let _=!1,E=!1;for(const S of r)S.data.haveBlock&&(_=!0),S.data.isWantBlock&&(E=!0);return!!(!E&&n.data.isWantBlock||!_&&n.data.haveBlock)},merge(n,r){const _=n.data,E=r.data;!E.haveBlock&&_.haveBlock&&(E.haveBlock=_.haveBlock,E.blockSize=_.blockSize),!E.isWantBlock&&_.isWantBlock&&(E.isWantBlock=!0,(!E.haveBlock||_.haveBlock)&&(E.haveBlock=_.haveBlock,r.size=n.size)),E.isWantBlock&&E.haveBlock&&(r.size=E.blockSize)}},WantType=BitswapMessage.WantType,TARGET_MESSAGE_SIZE=16*1024,MAX_SIZE_REPLACE_HAS_WITH_BLOCK=1024;class DecisionEngine{_log;blockstore;network;_stats;_opts;ledgerMap;_running;_requestQueue;constructor(r,_,E,S,C,A={}){this._log=logger$1(r,"engine"),this.blockstore=_,this.network=E,this._stats=S,this._opts=this._processOpts(A),this.ledgerMap=trackedMap({name:"ipfs_bitswap_ledger_map",metrics:C.metrics}),this._running=!1,this._requestQueue=new RequestQueue(DefaultTaskMerger)}_processOpts(r){return{maxSizeReplaceHasWithBlock:MAX_SIZE_REPLACE_HAS_WITH_BLOCK,targetMessageSize:TARGET_MESSAGE_SIZE,...r}}_scheduleProcessTasks(){setTimeout(()=>{this._processTasks().catch(r=>{this._log.error("error processing stats",r)})})}async _processTasks(){if(!this._running)return;const{peerId:r,tasks:_,pendingSize:E}=this._requestQueue.popTasks(this._opts.targetMessageSize);if(_.length===0)return;const S=new BitswapMessage(!1);S.setPendingBytes(E);const C=[],A=new Map;for(const B of _){const O=CID.parse(B.topic);B.data.haveBlock?B.data.isWantBlock?(C.push(O),A.set(B.topic,B.data)):S.addHave(O):S.addDontHave(O)}const I=await this._getBlocks(C);for(const[B,O]of A){const N=CID.parse(B),U=I.get(B);U!=null?S.addBlock(N,U):O.sendDontHave&&S.addDontHave(N)}if(S.empty){r!=null&&this._requestQueue.tasksDone(r,_),this._scheduleProcessTasks();return}try{r!=null&&await this.network.sendMessage(r,S);for(const[B,O]of I.entries())r!=null&&this.messageSent(r,CID.parse(B),O)}catch(B){this._log.error(B)}r!=null&&this._requestQueue.tasksDone(r,_),this._scheduleProcessTasks()}wantlistForPeer(r){const _=r.toString(),E=this.ledgerMap.get(_);return E!=null?E.wantlist.sortedEntries():new Map}ledgerForPeer(r){const _=r.toString(),E=this.ledgerMap.get(_);if(E!=null)return{peer:E.partner,value:E.debtRatio(),sent:E.accounting.bytesSent,recv:E.accounting.bytesRecv,exchanged:E.exchangeCount}}peers(){return Array.from(this.ledgerMap.values()).map(r=>r.partner)}receivedBlocks(r){if(r.length!==0){for(const _ of this.ledgerMap.values())for(const{cid:E,block:S}of r){const C=_.wantlistContains(E);if(C==null)continue;const A=S.length,I=this._sendAsBlock(C.wantType,A);let B=A;I||(B=BitswapMessage.blockPresenceSize(C.cid)),this._requestQueue.pushTasks(_.partner,[{topic:C.cid.toString(base58btc),priority:C.priority,size:B,data:{blockSize:A,isWantBlock:I,haveBlock:!0,sendDontHave:!1}}])}this._scheduleProcessTasks()}}async messageReceived(r,_){const E=this._findOrCreate(r);if(_.empty)return;if(_.full&&(E.wantlist=new Wantlist),this._updateBlockAccounting(_.blocks,E),_.wantlist.size===0){this._scheduleProcessTasks();return}const S=[],C=[];_.wantlist.forEach(A=>{A.cancel?(E.cancelWant(A.cid),S.push(A.cid)):(E.wants(A.cid,A.priority,A.wantType),C.push(A))}),this._cancelWants(r,S),await this._addWants(r,C),this._scheduleProcessTasks()}_cancelWants(r,_){for(const E of _)this._requestQueue.remove(E.toString(base58btc),r)}async _addWants(r,_){const E=await this._getBlockSizes(_.map(C=>C.cid)),S=[];for(const C of _){const A=C.cid.toString(base58btc),I=E.get(A);if(I==null)C.sendDontHave&&S.push({topic:A,priority:C.priority,size:BitswapMessage.blockPresenceSize(C.cid),data:{isWantBlock:C.wantType===WantType.Block,blockSize:0,haveBlock:!1,sendDontHave:C.sendDontHave}});else{const B=this._sendAsBlock(C.wantType,I);let O=I;B||(O=BitswapMessage.blockPresenceSize(C.cid)),S.push({topic:A,priority:C.priority,size:O,data:{isWantBlock:B,blockSize:I,haveBlock:!0,sendDontHave:C.sendDontHave}})}this._requestQueue.pushTasks(r,S)}}_sendAsBlock(r,_){return r===WantType.Block||_<=this._opts.maxSizeReplaceHasWithBlock}async _getBlockSizes(r){const _=await this._getBlocks(r);return new Map([..._].map(([E,S])=>[E,S.length]))}async _getBlocks(r){const _=new Map;return await Promise.all(r.map(async E=>{try{const S=await this.blockstore.get(E);_.set(E.toString(base58btc),S)}catch(S){S.code!=="ERR_NOT_FOUND"&&this._log.error("failed to query blockstore for %s: %s",E,S)}})),_}_updateBlockAccounting(r,_){for(const E of r.values())this._log("got block (%s bytes)",E.length),_.receivedBytes(E.length)}messageSent(r,_,E){const S=this._findOrCreate(r);S.sentBytes(E.length),S.wantlist.remove(_)}numBytesSentTo(r){return this._findOrCreate(r).accounting.bytesSent}numBytesReceivedFrom(r){return this._findOrCreate(r).accounting.bytesRecv}peerDisconnected(r){this.ledgerMap.delete(r.toString())}_findOrCreate(r){const _=r.toString(),E=this.ledgerMap.get(_);if(E!=null)return E;const S=new Ledger(r);return this.ledgerMap.set(_,S),this._stats!=null&&this._stats.push(_,"peerCount",1),S}start(){this._running=!0}stop(){this._running=!1}}function isAsyncIterable$1(n){return n[Symbol.asyncIterator]!=null}const defaultEncoder=n=>{const r=encodingLength(n),_=allocUnsafe$1(r);return encode$b(n,_),defaultEncoder.bytes=r,_};defaultEncoder.bytes=0;function encode$6(n,r){r=r??{};const _=r.lengthEncoder??defaultEncoder;function*E(S){const C=_(S.byteLength);C instanceof Uint8Array?yield C:yield*C,S instanceof Uint8Array?yield S:yield*S}return isAsyncIterable$1(n)?async function*(){for await(const S of n)yield*E(S)}():function*(){for(const S of n)yield*E(S)}()}encode$6.single=(n,r)=>{r=r??{};const _=r.lengthEncoder??defaultEncoder;return new Uint8ArrayList(_(n.byteLength),n)};const MAX_LENGTH_LENGTH=8,MAX_DATA_LENGTH=1024*1024*4;var ReadMode;(function(n){n[n.LENGTH=0]="LENGTH",n[n.DATA=1]="DATA"})(ReadMode||(ReadMode={}));const defaultDecoder=n=>{const r=decode$b(n);return defaultDecoder.bytes=encodingLength(r),r};defaultDecoder.bytes=0;function decode$4(n,r){const _=new Uint8ArrayList;let E=ReadMode.LENGTH,S=-1;const C=r?.lengthDecoder??defaultDecoder,A=r?.maxLengthLength??MAX_LENGTH_LENGTH,I=r?.maxDataLength??MAX_DATA_LENGTH;function*B(){for(;_.byteLength>0;){if(E===ReadMode.LENGTH)try{if(S=C(_),S<0)throw errCode$1(new Error("invalid message length"),"ERR_INVALID_MSG_LENGTH");if(S>I)throw errCode$1(new Error("message length too long"),"ERR_MSG_DATA_TOO_LONG");const O=C.bytes;_.consume(O),r?.onLength!=null&&r.onLength(S),E=ReadMode.DATA}catch(O){if(O instanceof RangeError){if(_.byteLength>A)throw errCode$1(new Error("message length length too long"),"ERR_MSG_LENGTH_TOO_LONG");break}throw O}if(E===ReadMode.DATA){if(_.byteLength<S)break;const O=_.sublist(0,S);_.consume(S),r?.onData!=null&&r.onData(O),yield O,E=ReadMode.LENGTH}}}return isAsyncIterable$1(n)?async function*(){for await(const O of n)_.append(O),yield*B();if(_.byteLength>0)throw errCode$1(new Error("unexpected end of input"),"ERR_UNEXPECTED_EOF")}():function*(){for(const O of n)_.append(O),yield*B();if(_.byteLength>0)throw errCode$1(new Error("unexpected end of input"),"ERR_UNEXPECTED_EOF")}()}decode$4.fromReader=(n,r)=>{let _=1;const E=async function*(){for(;;)try{const{done:C,value:A}=await n.next(_);if(C===!0)return;A!=null&&(yield A)}catch(C){if(C.code==="ERR_UNDER_READ")return{done:!0,value:null};throw C}finally{_=1}}();return decode$4(E,{...r??{},onLength:C=>{_=C}})};const maxProvidersPerRequest=3,kMaxPriority=Math.pow(2,31)-1,maxListeners=1e3,wantlistSendDebounceMs=1,BITSWAP100="/ipfs/bitswap/1.0.0",BITSWAP110="/ipfs/bitswap/1.1.0",BITSWAP120="/ipfs/bitswap/1.2.0",DEFAULT_MAX_INBOUND_STREAMS$2=1024,DEFAULT_MAX_OUTBOUND_STREAMS$2=1024,DEFAULT_INCOMING_STREAM_TIMEOUT=3e4;let Network$1=class{_log;_libp2p;_bitswap;_protocols;_stats;_running;_hashLoader;_maxInboundStreams;_maxOutboundStreams;_incomingStreamTimeout;_registrarIds;constructor(r,_,E,S={}){this._log=logger$1(r.peerId,"network"),this._libp2p=r,this._bitswap=_,this._protocols=[BITSWAP100],S.b100Only!==!0&&(this._protocols.unshift(BITSWAP110),this._protocols.unshift(BITSWAP120)),this._stats=E,this._running=!1,this._onPeerConnect=this._onPeerConnect.bind(this),this._onPeerDisconnect=this._onPeerDisconnect.bind(this),this._onConnection=this._onConnection.bind(this),this._hashLoader=S.hashLoader??{async getHasher(){throw new Error("Not implemented")}},this._maxInboundStreams=S.maxInboundStreams??DEFAULT_MAX_INBOUND_STREAMS$2,this._maxOutboundStreams=S.maxOutboundStreams??DEFAULT_MAX_OUTBOUND_STREAMS$2,this._incomingStreamTimeout=S.incomingStreamTimeout??DEFAULT_INCOMING_STREAM_TIMEOUT}async start(){this._running=!0,await this._libp2p.handle(this._protocols,this._onConnection,{maxInboundStreams:this._maxInboundStreams,maxOutboundStreams:this._maxOutboundStreams});const r={onConnect:this._onPeerConnect,onDisconnect:this._onPeerDisconnect};this._registrarIds=[];for(const _ of this._protocols)this._registrarIds.push(await this._libp2p.register(_,r));this._libp2p.getConnections().forEach(_=>{this._onPeerConnect(_.remotePeer)})}async stop(){if(this._running=!1,await this._libp2p.unhandle(this._protocols),this._registrarIds!=null){for(const r of this._registrarIds)this._libp2p.unregister(r);this._registrarIds=[]}}_onConnection(r){if(!this._running)return;const{stream:_,connection:E}=r,S=new timeoutAbortController.TimeoutController(this._incomingStreamTimeout);Promise.resolve().then(async()=>{this._log("incoming new bitswap %s connection from %p",_.protocol,E.remotePeer);const C=()=>{_.abort(new CodeError$4("Incoming Bitswap stream timed out","ERR_TIMEOUT"))};let A=AbortSignal.timeout(this._incomingStreamTimeout);A.addEventListener("abort",C),await pipe(_,I=>decode$4(I),async I=>{for await(const B of I){try{const O=await BitswapMessage.deserialize(B.subarray(),this._hashLoader);await this._bitswap._receiveMessage(E.remotePeer,O)}catch(O){this._bitswap._receiveError(O);break}A.removeEventListener("abort",C),A=AbortSignal.timeout(this._incomingStreamTimeout),A.addEventListener("abort",C)}}),await _.close({signal:A})}).catch(C=>{this._log(C),_.abort(C)}).finally(()=>{S.clear()})}_onPeerConnect(r){this._bitswap._onPeerConnected(r)}_onPeerDisconnect(r){this._bitswap._onPeerDisconnected(r)}findProviders(r,_={}){return _.onProgress?.(new CustomProgressEvent("bitswap:network:find-providers",r)),this._libp2p.contentRouting.findProviders(r,_)}async findAndConnect(r,_){await drain(take(map$1(this.findProviders(r,_),async E=>this.connectTo(E.id,_).catch(S=>{this._log.error(S)})),maxProvidersPerRequest)).catch(E=>{this._log.error(E)})}async provide(r,_={}){_.onProgress?.(new CustomProgressEvent("bitswap:network:provide",r)),await this._libp2p.contentRouting.provide(r,_)}async sendMessage(r,_,E={}){if(!this._running)throw new Error("network isn't running");const S=r.toString();this._log("sendMessage to %s",S,_),E.onProgress?.(new CustomProgressEvent("bitswap:network:send-wantlist",r)),await this._writeMessage(r,_,E),this._updateSentStats(r,_.blocks)}async connectTo(r,_={}){if(!this._running)throw new Error("network isn't running");return _.onProgress?.(new CustomProgressEvent("bitswap:network:dial",r)),this._libp2p.dial(r,_)}_updateSentStats(r,_){const E=r.toString();if(this._stats!=null){for(const S of _.values())this._stats.push(E,"dataSent",S.length);this._stats.push(E,"blocksSent",_.size)}}async _writeMessage(r,_,E={}){const S=await this._libp2p.dialProtocol(r,[BITSWAP120,BITSWAP110,BITSWAP100]);try{let C;switch(S.protocol){case BITSWAP100:C=_.serializeToBitswap100();break;case BITSWAP110:case BITSWAP120:C=_.serializeToBitswap110();break;default:throw new Error(`Unknown protocol: ${S.protocol}`)}await pipe([C],A=>encode$6(A),S),await S.close()}catch(C){E.onProgress?.(new CustomProgressEvent("bitswap:network:send-wantlist:error",{peer:r,error:C})),this._log(C),S.abort(C)}}};const unwantEvent=n=>`unwant:${toString$4(n.multihash.bytes,"base64")}`,blockEvent=n=>`block:${toString$4(n.multihash.bytes,"base64")}`;class Notifications extends eventsExports.EventEmitter{_log;constructor(r){super(),this.setMaxListeners(maxListeners),this._log=logger$1(r,"notif")}hasBlock(r,_){const E=blockEvent(r);this._log(E),this.emit(E,_)}async wantBlock(r,_={}){if(r==null)throw new Error("Not a valid cid");const E=blockEvent(r),S=unwantEvent(r);return this._log(`wantBlock:${r}`),new Promise((C,A)=>{const I=()=>{this.removeListener(E,B),_.onProgress?.(new CustomProgressEvent("bitswap:want-block:unwant",r)),A(new Error(`Block for ${r} unwanted`))},B=O=>{this.removeListener(S,I),_.onProgress?.(new CustomProgressEvent("bitswap:want-block:block",r)),C(O)};this.once(S,I),this.once(E,B),_.signal?.addEventListener("abort",()=>{this.removeListener(E,B),this.removeListener(S,I),A(new Error(`Want for ${r} aborted`))})})}unwantBlock(r){const _=unwantEvent(r);this._log(_),this.emit(_)}}var movingAverage={exports:{}};(function(n,r){const _=Math.exp;n.exports=function(S){if(typeof S!="number")throw new Error("must provide a timespan to the moving average constructor");if(S<=0)throw new Error("must provide a timespan > 0 to the moving average constructor");let C,A=0,I=0,B=0,O,N={};function U(j,z){return 1-_(-(j-z)/S)}return N.push=function(z,Z){if(O){const X=U(z,O),Q=Z-C,se=X*Q;C=X*Z+(1-X)*C,A=(1-X)*(A+Q*se),I=Math.sqrt(A),B=C+X*Q}else C=Z;O=z},N.movingAverage=function(){return C},N.variance=function(){return A},N.deviation=function(){return I},N.forecast=function(){return B},N}})(movingAverage);var movingAverageExports=movingAverage.exports;const MovingAverage=getDefaultExportFromCjs(movingAverageExports);class Stat extends eventsExports.EventEmitter{_options;_queue;_stats;_frequencyLastTime;_frequencyAccumulators;_movingAverages;_enabled;_timeout;constructor(r,_){super(),this._options=_,this._queue=[],this._stats={},this._frequencyLastTime=Date.now(),this._frequencyAccumulators={},this._movingAverages={},this._update=this._update.bind(this),r.forEach(E=>{this._stats[E]=BigInt(0),this._movingAverages[E]={},this._options.movingAverageIntervals.forEach(S=>{(this._movingAverages[E][S]=MovingAverage(S)).push(this._frequencyLastTime,0)})}),this._enabled=this._options.enabled}enable(){this._enabled=!0}disable(){this._enabled=!1}stop(){this._timeout!=null&&clearTimeout(this._timeout)}get snapshot(){return Object.assign({},this._stats)}get movingAverages(){return Object.assign({},this._movingAverages)}push(r,_){this._enabled&&(this._queue.push([r,_,Date.now()]),this._resetComputeTimeout())}_resetComputeTimeout(){this._timeout!=null&&clearTimeout(this._timeout),this._timeout=setTimeout(this._update,this._nextTimeout())}_nextTimeout(){const r=this._queue.length/this._options.computeThrottleMaxQueueSize;return Math.max(this._options.computeThrottleTimeout*(1-r),0)}_update(){if(this._timeout=void 0,this._queue.length>0){let r;for(;this._queue.length>0;){const _=r=this._queue.shift();_!=null&&this._applyOp(_)}r!=null&&this._updateFrequency(r[2]),this.emit("update",this._stats)}}_updateFrequency(r){const _=r-this._frequencyLastTime;_>0&&Object.keys(this._stats).forEach(E=>{this._updateFrequencyFor(E,_,r)}),this._frequencyLastTime=r}_updateFrequencyFor(r,_,E){const S=this._frequencyAccumulators[r]??0;this._frequencyAccumulators[r]=0;const C=S/_*1e3;let A=this._movingAverages[r];A==null&&(A=this._movingAverages[r]={}),this._options.movingAverageIntervals.forEach(I=>{let B=A[I];B==null&&(B=A[I]=MovingAverage(I)),B.push(E,C)})}_applyOp(r){const _=r[0],E=r[1];if(typeof E!="number")throw new Error(`invalid increment number: ${E}`);Object.prototype.hasOwnProperty.call(this._stats,_)||(this._stats[_]=BigInt(0)),this._stats[_]=BigInt(this._stats[_])+BigInt(E),this._frequencyAccumulators[_]==null&&(this._frequencyAccumulators[_]=0),this._frequencyAccumulators[_]+=E}}const defaultOptions$8={enabled:!1,computeThrottleTimeout:1e3,computeThrottleMaxQueueSize:1e3,movingAverageIntervals:[60*1e3,5*60*1e3,15*60*1e3]};class Stats extends eventsExports.EventEmitter{_initialCounters;_options;_enabled;_global;_peers;constructor(r,_=[],E=defaultOptions$8){super();const S=Object.assign({},defaultOptions$8,E);if(typeof S.computeThrottleTimeout!="number")throw new Error("need computeThrottleTimeout");if(typeof S.computeThrottleMaxQueueSize!="number")throw new Error("need computeThrottleMaxQueueSize");this._initialCounters=_,this._options=S,this._enabled=this._options.enabled,this._global=new Stat(_,S),this._global.on("update",C=>this.emit("update",C)),this._peers=trackedMap({name:"ipfs_bitswap_stats_peers",metrics:r.metrics})}enable(){this._enabled=!0,this._options.enabled=!0,this._global.enable()}disable(){this._enabled=!1,this._options.enabled=!1,this._global.disable()}stop(){this._enabled=!1,this._global.stop();for(const r of this._peers)r[1].stop()}get snapshot(){return this._global.snapshot}get movingAverages(){return this._global.movingAverages}forPeer(r){const _=r.toString();return this._peers.get(_)}push(r,_,E){if(this._enabled&&(this._global.push(_,E),r!=null)){let S=this._peers.get(r);S==null&&(S=new Stat(this._initialCounters,this._options),this._peers.set(r,S)),S.push(_,E)}}disconnected(r){const _=r.toString(),E=this._peers.get(_);E!=null&&(E.stop(),this._peers.delete(_))}}var functionDebounce=debounce$2;function debounce$2(n,r,_){var E=null,S=null,C=function(){E&&(clearTimeout(E),S=null,E=null)},A=function(){var B=S;C(),B&&B()},I=function(){if(!r)return n.apply(this,arguments);var B=this,O=arguments,N=_&&!E;if(C(),S=function(){n.apply(B,O)},E=setTimeout(function(){if(E=null,!N){var U=S;return S=null,U()}},r),N)return S()};return I.cancel=C,I.flush=A,I}class MsgQueue{peerId;refcnt;network;_entries;_log;constructor(r,_,E){this.peerId=_,this.network=E,this.refcnt=1,this._entries=[],this._log=logger$1(r,"msgqueue"),this.sendEntries=functionDebounce(this.sendEntries.bind(this),wantlistSendDebounceMs)}addMessage(r,_={}){r.empty||this.send(r,_)}addEntries(r,_={}){this._entries=this._entries.concat(r),this.sendEntries(_)}sendEntries(r={}){if(this._entries.length===0)return;const _=new BitswapMessage(!1);this._entries.forEach(E=>{E.cancel===!0?_.cancel(E.cid):_.addEntry(E.cid,E.priority)}),this._entries=[],this.addMessage(_,r)}async send(r,_={}){try{await this.network.connectTo(this.peerId,_)}catch(E){this._log.error("cant connect to peer %p: %s",this.peerId,E.message);return}this._log("sending message to peer %p",this.peerId),this.network.sendMessage(this.peerId,r,_).catch(E=>{this._log.error("send error",E)})}}class WantManager{peers;wantlist;network;_peerId;_log;constructor(r,_,E,S){this.peers=trackedMap({name:"ipfs_bitswap_want_manager_peers",metrics:S.metrics}),this.wantlist=new Wantlist(E,S),this.network=_,this._peerId=r,this._log=logger$1(r,"want")}_addEntries(r,_,E,S={}){const C=r.map((A,I)=>new BitswapMessage.Entry(A,kMaxPriority-I,BitswapMessage.WantType.Block,_));C.forEach(A=>{A.cancel?E===!0?this.wantlist.removeForce(A.cid.toString(base58btc)):this.wantlist.remove(A.cid):(this._log("adding to wantlist"),this.wantlist.add(A.cid,A.priority))});for(const A of this.peers.values())A.addEntries(C,S)}_startPeerHandler(r){let _=this.peers.get(r.toString());if(_!=null){_.refcnt++;return}_=new MsgQueue(this._peerId,r,this.network);const E=new BitswapMessage(!0);for(const S of this.wantlist.entries())E.addEntry(S[1].cid,S[1].priority);return _.addMessage(E),this.peers.set(r.toString(),_),_}_stopPeerHandler(r){const _=this.peers.get(r.toString());_!=null&&(_.refcnt--,!(_.refcnt>0)&&this.peers.delete(r.toString()))}wantBlocks(r,_={}){this._addEntries(r,!1,!1,_),_.signal?.addEventListener("abort",()=>{this.cancelWants(r)})}unwantBlocks(r){this._log("unwant blocks: %s",r.length),this._addEntries(r,!0,!0)}cancelWants(r){this._log("cancel wants: %s",r.length),this._addEntries(r,!0)}connectedPeers(){return Array.from(this.peers.keys())}connected(r){this._startPeerHandler(r)}disconnected(r){this._stopPeerHandler(r)}start(){}stop(){this.peers.forEach(r=>{this.disconnected(r.peerId)})}}const hashLoader={async getHasher(){throw new Error("Not implemented")}},defaultOptions$7={maxInboundStreams:1024,maxOutboundStreams:1024,incomingStreamTimeout:3e4,hashLoader,statsEnabled:!1,statsComputeThrottleTimeout:1e3,statsComputeThrottleMaxQueueSize:1e3},statsKeys=["blocksReceived","dataReceived","dupBlksReceived","dupDataReceived","blocksSent","dataSent","providesBufferLength","wantListLength","peerCount"];class DefaultBitswap{_libp2p;_log;stats;network;blockstore;engine;wm;notifications;started;constructor(r,_,E={}){this._libp2p=r,this._log=logger$1(this.peerId),E=Object.assign({},defaultOptions$7,E),this.stats=new Stats(r,statsKeys,{enabled:E.statsEnabled,computeThrottleTimeout:E.statsComputeThrottleTimeout,computeThrottleMaxQueueSize:E.statsComputeThrottleMaxQueueSize}),this.network=new Network$1(r,this,this.stats,{hashLoader:E.hashLoader,maxInboundStreams:E.maxInboundStreams,maxOutboundStreams:E.maxOutboundStreams,incomingStreamTimeout:E.incomingStreamTimeout}),this.blockstore=_,this.engine=new DecisionEngine(this.peerId,_,this.network,this.stats,r),this.wm=new WantManager(this.peerId,this.network,this.stats,r),this.notifications=new Notifications(this.peerId),this.started=!1}isStarted(){return this.started}get peerId(){return this._libp2p.peerId}async _receiveMessage(r,_){try{await this.engine.messageReceived(r,_)}catch{this._log("failed to receive message",_)}if(_.blocks.size===0)return;const E=[];for(const[S,C]of _.blocks.entries()){const A=CID.parse(S);E.push({wasWanted:this.wm.wantlist.contains(A),cid:A,data:C})}this.wm.cancelWants(E.filter(({wasWanted:S})=>S).map(({cid:S})=>S)),await Promise.all(E.map(async({cid:S,wasWanted:C,data:A})=>{await this._handleReceivedBlock(r,S,A,C)}))}async _handleReceivedBlock(r,_,E,S){this._log("received block");const C=await this.blockstore.has(_);this._updateReceiveCounters(r.toString(),_,E,C),S&&await this.put(_,E)}_updateReceiveCounters(r,_,E,S){this.stats.push(r,"blocksReceived",1),this.stats.push(r,"dataReceived",E.length),S&&(this.stats.push(r,"dupBlksReceived",1),this.stats.push(r,"dupDataReceived",E.length))}_receiveError(r){this._log.error("ReceiveError",r)}_onPeerConnected(r){this.wm.connected(r)}_onPeerDisconnected(r){this.wm.disconnected(r),this.engine.peerDisconnected(r),this.stats.disconnected(r)}enableStats(){this.stats.enable()}disableStats(){this.stats.disable()}wantlistForPeer(r,_){return this.engine.wantlistForPeer(r)}ledgerForPeer(r){return this.engine.ledgerForPeer(r)}async want(r,_={}){const E=async(B,O)=>(this.wm.wantBlocks([B],O),this.notifications.wantBlock(B,O));let S=!1;const C=async(B,O)=>{try{return await this.blockstore.get(B,O)}catch(N){if(N.code!=="ERR_NOT_FOUND")throw N;return S||(S=!0,this.network.findAndConnect(B,O).catch(U=>{this._log.error(U)})),await E(B,O)}},A=new AbortController,I=anySignal([A.signal,_.signal]);try{return await Promise.race([this.notifications.wantBlock(r,{..._,signal:I}),C(r,{..._,signal:I})])}finally{A.abort(),I.clear()}}unwant(r){const _=Array.isArray(r)?r:[r];this.wm.unwantBlocks(_),_.forEach(E=>{this.notifications.unwantBlock(E)})}cancelWants(r){this.wm.cancelWants(Array.isArray(r)?r:[r])}async put(r,_,E){await this.blockstore.put(r,_),this.notify(r,_)}async*putMany(r,_){yield*this.blockstore.putMany(forEach(r,({cid:E,block:S})=>{this.notify(E,S)}),_)}notify(r,_,E={}){this.notifications.hasBlock(r,_),this.engine.receivedBlocks([{cid:r,block:_}]),this.network.provide(r,E).catch(S=>{this._log.error("Failed to provide: %s",S.message)})}getWantlist(){return this.wm.wantlist.entries()}get peers(){return this.engine.peers()}async start(){this.wm.start(),await this.network.start(),this.engine.start(),this.started=!0}async stop(){this.stats.stop(),this.wm.stop(),await this.network.stop(),this.engine.stop(),this.started=!1}}const createBitswap=(n,r,_={})=>new DefaultBitswap(n,r,_);let BitswapBlockBroker$1=class{bitswap;started;constructor(r,_={}){const{libp2p:E,blockstore:S,hashers:C}=r;this.bitswap=createBitswap(E,S,{hashLoader:{getHasher:async A=>{const I=C.find(B=>B.code===A||B.name===A);if(I!=null)return I;throw new Error(`Could not load hasher for code/name "${A}"`)}},..._}),this.started=!1}isStarted(){return this.started}async start(){await this.bitswap.start(),this.started=!0}async stop(){await this.bitswap.stop(),this.started=!1}announce(r,_,E){this.bitswap.notify(r,_,E)}async retrieve(r,{validateFn:_,...E}={}){return this.bitswap.want(r,E)}};function bitswap$1(n={}){return r=>new BitswapBlockBroker$1(r,n)}class TrustlessGateway{url;#e=0;#t=0;#r=0;#a=0;constructor(r){this.url=r instanceof URL?r:new URL(r)}async getRawBlock(r,_){const E=this.url;if(E.pathname=`/ipfs/${r.toString()}`,E.search="?format=raw",_?.aborted===!0)throw new Error(`Signal to fetch raw block for CID ${r} from gateway ${this.url} was aborted prior to fetch`);try{this.#e++;const S=await fetch(E.toString(),{signal:_,headers:{Accept:"application/vnd.ipld.raw"},cache:"force-cache"});if(!S.ok)throw this.#t++,new Error(`unable to fetch raw block for CID ${r} from gateway ${this.url}`);return this.#a++,new Uint8Array(await S.arrayBuffer())}catch{throw _?.aborted===!0?new Error(`fetching raw block for CID ${r} from gateway ${this.url} was aborted`):(this.#t++,new Error(`unable to fetch raw block for CID ${r}`))}}reliability(){return this.#e===0?1:this.#r>0?-1/0:this.#a/(this.#e+this.#t*3)}incrementInvalidBlocks(){this.#r++}}class TrustlessGatewayBlockBroker{gateways;log;constructor(r,_={}){this.log=r.logger.forComponent("helia:trustless-gateway-block-broker"),this.gateways=(_.gateways??DEFAULT_TRUSTLESS_GATEWAYS).map(E=>new TrustlessGateway(E))}async retrieve(r,_={}){const E=this.gateways.sort((C,A)=>A.reliability()-C.reliability()),S=[];for(const C of E){this.log("getting block for %c from %s",r,C.url);try{const A=await C.getRawBlock(r,_.signal);this.log.trace("got block for %c from %s",r,C.url);try{await _.validateFn?.(A)}catch(I){throw this.log.error("failed to validate block for %c from %s",r,C.url,I),C.incrementInvalidBlocks(),new Error(`unable to validate block for CID ${r} from gateway ${C.url}`)}return A}catch(A){if(this.log.error("failed to get block for %c from %s",r,C.url,A),A instanceof Error?S.push(A):S.push(new Error(`unable to fetch raw block for CID ${r} from gateway ${C.url}`)),_.signal?.aborted===!0){this.log.trace("request aborted while fetching raw block for CID %c from gateway %s",r,C.url);break}}}throw new AggregateError(S,`unable to fetch raw block for CID ${r} from any gateway`)}}const DEFAULT_TRUSTLESS_GATEWAYS=["https://dweb.link","https://cf-ipfs.com","https://4everland.io"];function trustlessGateway(n={}){return r=>new TrustlessGatewayBlockBroker(r,n)}function isBlockRetriever(n){return typeof n.retrieve=="function"}function isBlockAnnouncer(n){return typeof n.announce=="function"}class NetworkedStorage{child;blockRetrievers;blockAnnouncers;hashers;started;log;constructor(r,_){this.log=r.logger.forComponent("helia:networked-storage"),this.child=r.blockstore,this.blockRetrievers=(_.blockBrokers??[]).filter(isBlockRetriever),this.blockAnnouncers=(_.blockBrokers??[]).filter(isBlockAnnouncer),this.hashers=_.hashers??[],this.started=!1}isStarted(){return this.started}async start(){await start(this.child,...new Set([...this.blockRetrievers,...this.blockAnnouncers])),this.started=!0}async stop(){await stop(this.child,...new Set([...this.blockRetrievers,...this.blockAnnouncers])),this.started=!1}unwrap(){return this.child}async put(r,_,E={}){return await this.child.has(r)?(E.onProgress?.(new CustomProgressEvent("blocks:put:duplicate",r)),r):(E.onProgress?.(new CustomProgressEvent("blocks:put:providers:notify",r)),this.blockAnnouncers.forEach(S=>{S.announce(r,_,E)}),E.onProgress?.(new CustomProgressEvent("blocks:put:blockstore:put",r)),this.child.put(r,_,E))}async*putMany(r,_={}){const E=filter(r,async({cid:C})=>{const A=await this.child.has(C);return A&&_.onProgress?.(new CustomProgressEvent("blocks:put-many:duplicate",C)),!A}),S=forEach(E,({cid:C,block:A})=>{_.onProgress?.(new CustomProgressEvent("blocks:put-many:providers:notify",C)),this.blockAnnouncers.forEach(I=>{I.announce(C,A,_)})});_.onProgress?.(new CustomProgressEvent("blocks:put-many:blockstore:put-many")),yield*this.child.putMany(S,_)}async get(r,_={}){if(_.offline!==!0&&!await this.child.has(r)){_.onProgress?.(new CustomProgressEvent("blocks:get:providers:get",r));const E=await raceBlockRetrievers(r,this.blockRetrievers,this.hashers,{..._,log:this.log});return _.onProgress?.(new CustomProgressEvent("blocks:get:blockstore:put",r)),await this.child.put(r,E,_),_.onProgress?.(new CustomProgressEvent("blocks:get:providers:notify",r)),this.blockAnnouncers.forEach(S=>{S.announce(r,E,_)}),E}return _.onProgress?.(new CustomProgressEvent("blocks:get:blockstore:get",r)),this.child.get(r,_)}async*getMany(r,_={}){_.onProgress?.(new CustomProgressEvent("blocks:get-many:blockstore:get-many")),yield*this.child.getMany(forEach(r,async E=>{if(_.offline!==!0&&!await this.child.has(E)){_.onProgress?.(new CustomProgressEvent("blocks:get-many:providers:get",E));const S=await raceBlockRetrievers(E,this.blockRetrievers,this.hashers,{..._,log:this.log});_.onProgress?.(new CustomProgressEvent("blocks:get-many:blockstore:put",E)),await this.child.put(E,S,_),_.onProgress?.(new CustomProgressEvent("blocks:get-many:providers:notify",E)),this.blockAnnouncers.forEach(C=>{C.announce(E,S,_)})}}))}async delete(r,_={}){_.onProgress?.(new CustomProgressEvent("blocks:delete:blockstore:delete",r)),await this.child.delete(r,_)}async*deleteMany(r,_={}){_.onProgress?.(new CustomProgressEvent("blocks:delete-many:blockstore:delete-many")),yield*this.child.deleteMany(async function*(){for await(const E of r)yield E}(),_)}async has(r,_={}){return this.child.has(r,_)}async*getAll(r={}){r.onProgress?.(new CustomProgressEvent("blocks:get-all:blockstore:get-many")),yield*this.child.getAll(r)}}const getCidBlockVerifierFunction=(n,r)=>{const _=r.find(E=>E.code===n.multihash.code);if(_==null)throw new CodeError$4(`No hasher configured for multihash code 0x${n.multihash.code.toString(16)}, please configure one. You can look up which hash this is at https://github.com/multiformats/multicodec/blob/master/table.csv`,"ERR_UNKNOWN_HASH_ALG");return async E=>{const S=await _.digest(E);if(!equals$1(S.digest,n.multihash.digest))throw new CodeError$4("Hash of downloaded block did not match multihash from passed CID","ERR_HASH_MISMATCH")}};async function raceBlockRetrievers(n,r,_,E){const S=getCidBlockVerifierFunction(n,_),C=new AbortController,A=anySignal([C.signal,E.signal]);try{return await Promise.any(r.map(async I=>{try{let B=!1;const O=await I.retrieve(n,{...E,signal:A,validateFn:async N=>{await S(N),B=!0}});return B||await S(O),O}catch(B){throw E.log.error("could not retrieve verified block for %c",n,B),B}}))}finally{A.clear()}}let AbortError$4=class extends Error{type;code;constructor(r,_){super(r??"The operation was aborted"),this.type="aborted",this.name="AbortError",this.code=_??"ABORT_ERR"}};async function raceEvent(n,r,_,E){const S=new AbortError$4(E?.errorMessage,E?.errorCode);return _?.aborted===!0?Promise.reject(S):new Promise((C,A)=>{const I=O=>{try{if(E?.filter?.(O)===!1)return}catch(N){n.removeEventListener(r,I),_?.removeEventListener("abort",B),A(N);return}n.removeEventListener(r,I),_?.removeEventListener("abort",B),C(O)},B=()=>{n.removeEventListener(r,I),_?.removeEventListener("abort",B),A(S)};n.addEventListener(r,I),_?.addEventListener("abort",B)})}let AbortError$3=class extends Error{type;code;constructor(r,_){super(r??"The operation was aborted"),this.type="aborted",this.name="AbortError",this.code=_??"ABORT_ERR"}};async function raceSignal(n,r,_){if(r==null)return n;if(r.aborted)return Promise.reject(new AbortError$3(_?.errorMessage,_?.errorCode));let E;const S=new AbortError$3(_?.errorMessage,_?.errorCode);try{return await Promise.race([n,new Promise((C,A)=>{E=()=>{A(S)},r.addEventListener("abort",E)})])}finally{E!=null&&r.removeEventListener("abort",E)}}class JobRecipient{deferred;signal;where;constructor(r,_){this.signal=_,this.deferred=pDefer(),this.where=r,this.onAbort=this.onAbort.bind(this),this.signal?.addEventListener("abort",this.onAbort)}onAbort(){this.deferred.reject(new AbortError$5)}cleanup(){this.signal?.removeEventListener("abort",this.onAbort)}}function randomId(){return`${parseInt(String(Math.random()*1e9),10).toString()}${Date.now()}`}class Job{id;fn;options;priority;recipients;status;timeline;controller;constructor(r,_,E=0){this.id=randomId(),this.status="queued",this.fn=r,this.priority=E,this.options=_,this.recipients=[],this.timeline={created:Date.now()},this.controller=new AbortController,setMaxListeners$2(1/0,this.controller.signal),this.onAbort=this.onAbort.bind(this)}abort(r){this.controller.abort(r)}onAbort(){this.recipients.reduce((_,E)=>_&&E.signal?.aborted===!0,!0)&&this.controller.abort(new AbortError$5)}async join(r={}){const _=new JobRecipient(new Error("where").stack,r.signal);return this.recipients.push(_),r.signal?.addEventListener("abort",this.onAbort),_.deferred.promise}async run(){this.status="running",this.timeline.started=Date.now();try{this.controller.signal.throwIfAborted();const r=await raceSignal(this.fn({...this.options??{},signal:this.controller.signal}),this.controller.signal);this.recipients.forEach(_=>{_.deferred.resolve(r)}),this.status="complete"}catch(r){this.recipients.forEach(_=>{_.deferred.reject(r)}),this.status="errored"}finally{this.timeline.finished=Date.now(),this.cleanup()}}cleanup(){this.recipients.forEach(r=>{r.signal?.removeEventListener("abort",this.onAbort)})}}function lowerBound$1(n,r,_){let E=0,S=n.length;for(;S>0;){const C=Math.trunc(S/2);let A=E+C;_(n[A],r)<=0?(E=++A,S-=C+1):S=C}return E}class Queue extends TypedEventEmitter{concurrency;queue;pending;constructor(r={}){super(),this.concurrency=r.concurrency??Number.POSITIVE_INFINITY,this.pending=0,r.metricName!=null&&r.metrics?.registerMetricGroup(r.metricName,{calculate:()=>({size:this.queue.length,running:this.pending,queued:this.queue.length-this.pending})}),this.queue=[]}tryToStartAnother(){if(this.size===0)return queueMicrotask(()=>{this.safeDispatchEvent("empty")}),this.running===0&&queueMicrotask(()=>{this.safeDispatchEvent("idle")}),!1;if(this.pending<this.concurrency){let r;for(const _ of this.queue)if(_.status==="queued"){r=_;break}return r==null?!1:(this.safeDispatchEvent("active"),this.pending++,r.run().finally(()=>{for(let _=0;_<this.queue.length;_++)if(this.queue[_]===r){this.queue.splice(_,1);break}this.pending--,this.tryToStartAnother(),this.safeDispatchEvent("next")}),!0)}return!1}enqueue(r){if(this.queue[this.size-1]?.priority>=r.priority){this.queue.push(r);return}const _=lowerBound$1(this.queue,r,(E,S)=>S.priority-E.priority);this.queue.splice(_,0,r)}async add(r,_){_?.signal?.throwIfAborted();const E=new Job(r,_,_?.priority),S=E.join(_).then(C=>(this.safeDispatchEvent("completed",{detail:C}),C)).catch(C=>{throw this.safeDispatchEvent("error",{detail:C}),C});return this.enqueue(E),this.safeDispatchEvent("add"),this.tryToStartAnother(),S}clear(){this.queue.splice(0,this.queue.length)}abort(){this.queue.forEach(r=>{r.abort(new AbortError$5)}),this.clear()}async onEmpty(r){this.size!==0&&await raceEvent(this,"empty",r?.signal)}async onSizeLessThan(r,_){this.size<r||await raceEvent(this,"next",_?.signal,{filter:()=>this.size<r})}async onIdle(r){this.pending===0&&this.size===0||await raceEvent(this,"idle",r?.signal)}get size(){return this.queue.length}get queued(){return this.queue.length-this.pending}get running(){return this.pending}async*toGenerator(r){r?.signal?.throwIfAborted();const _=pushable$1({objectMode:!0}),E=B=>{B!=null?this.abort():this.clear(),_.end(B)},S=B=>{B.detail!=null&&_.push(B.detail)},C=B=>{E(B.detail)},A=()=>{E()},I=()=>{E(new CodeError$4("Queue aborted","ERR_QUEUE_ABORTED"))};this.addEventListener("completed",S),this.addEventListener("error",C),this.addEventListener("idle",A),r?.signal?.addEventListener("abort",I);try{yield*_}finally{this.removeEventListener("completed",S),this.removeEventListener("error",C),this.removeEventListener("idle",A),r?.signal?.removeEventListener("abort",I),E()}}}const dagPbWalker={codec:code$2,*walk(n){yield*decode$9(n).Links.map(_=>_.Hash)}},rawWalker={codec:code$6,*walk(){}},CID_TAG=42,dagCborWalker={codec:code$8,*walk(n){const r=[],_=[];_[CID_TAG]=E=>{if(E[0]!==0)throw new Error("Invalid CID for CBOR tag 42; expected leading 0x00");const S=CID.decode(E.subarray(1));return r.push(S),S},decode$l(n,{tags:_}),yield*r}};class DagJsonTokenizer extends Tokenizer{tokenBuffer;constructor(r,_){super(r,_),this.tokenBuffer=[]}done(){return this.tokenBuffer.length===0&&super.done()}_next(){return this.tokenBuffer.length>0?this.tokenBuffer.pop():super.next()}next(){const r=this._next();if(r.type===Type.map){const _=this._next();if(_.type===Type.string&&_.value==="/"){const E=this._next();if(E.type===Type.string){if(this._next().type!==Type.break)throw new Error("Invalid encoded CID form");return this.tokenBuffer.push(E),new Token(Type.tag,42,0)}if(E.type===Type.map){const S=this._next();if(S.type===Type.string&&S.value==="bytes"){const C=this._next();if(C.type===Type.string){for(let I=0;I<2;I++)if(this._next().type!==Type.break)throw new Error("Invalid encoded Bytes form");const A=base64$5.decode(`m${C.value}`);return new Token(Type.bytes,A,C.value.length)}this.tokenBuffer.push(C)}this.tokenBuffer.push(S)}this.tokenBuffer.push(E)}this.tokenBuffer.push(_)}return r}}const dagJsonWalker={codec:code$1,*walk(n){const r=[],_=[];_[CID_TAG]=E=>{const S=CID.parse(E);return r.push(S),S},decode$8(n,{tags:_,tokenizer:new DagJsonTokenizer(n,{tags:_,allowIndefinite:!0,allowUndefined:!0,allowNaN:!0,allowInfinity:!0,allowBigInt:!0,strict:!1,rejectDuplicateMapKeys:!1})}),yield*r}},jsonWalker={codec:code$7,*walk(){}},DEFAULT_DAG_WALKERS=[rawWalker,dagPbWalker,dagCborWalker,dagJsonWalker,jsonWalker],DATASTORE_PIN_PREFIX="/pin/",DATASTORE_BLOCK_PREFIX="/pinned-block/",DATASTORE_ENCODING=base36$4,DAG_WALK_QUEUE_CONCURRENCY=1;function toDSKey(n){return n.version===0&&(n=n.toV1()),new Key(`${DATASTORE_PIN_PREFIX}${n.toString(DATASTORE_ENCODING)}`)}class PinsImpl{datastore;blockstore;dagWalkers;constructor(r,_,E){this.datastore=r,this.blockstore=_,this.dagWalkers={},[...DEFAULT_DAG_WALKERS,...E].forEach(S=>{this.dagWalkers[S.codec]=S})}async*add(r,_={}){const E=toDSKey(r);if(await this.datastore.has(E))throw new Error("Already pinned");const S=Math.round(_.depth??1/0);if(S<0)throw new Error("Depth must be greater than or equal to 0");const C=new Queue({concurrency:DAG_WALK_QUEUE_CONCURRENCY});for await(const I of this.#e(r,C,{..._,depth:S}))await this.#t(I,B=>B.pinnedBy.find(O=>equals$1(O,r.bytes))!=null?!1:(B.pinCount++,B.pinnedBy.push(r.bytes),!0),_),yield I;const A={depth:S,metadata:_.metadata??{}};await this.datastore.put(E,encode$j(A),_)}async*#e(r,_,E){if(E.depth===-1)return;const S=this.dagWalkers[r.code];if(S==null)throw new Error(`No dag walker found for cid codec ${r.code}`);const C=await this.blockstore.get(r,E);yield r;for await(const A of S.walk(C))yield*await _.add(async()=>this.#e(A,_,{...E,depth:E.depth-1}))}async#t(r,_,E){const S=new Key(`${DATASTORE_BLOCK_PREFIX}${DATASTORE_ENCODING.encode(r.multihash.bytes)}`);let C={pinCount:0,pinnedBy:[]};try{C=decode$l(await this.datastore.get(S,E))}catch(I){if(I.code!=="ERR_NOT_FOUND")throw I}if(_(C)){if(C.pinCount===0&&await this.datastore.has(S)){await this.datastore.delete(S);return}await this.datastore.put(S,encode$j(C),E),E.onProgress?.(new CustomProgressEvent("helia:pin:add",r))}}async*rm(r,_={}){const E=toDSKey(r),S=await this.datastore.get(E,_),C=decode$l(S);await this.datastore.delete(E,_);const A=new Queue({concurrency:DAG_WALK_QUEUE_CONCURRENCY});for await(const I of this.#e(r,A,{..._,depth:C.depth}))await this.#t(I,B=>(B.pinCount--,B.pinnedBy=B.pinnedBy.filter(O=>equals$1(O,r.bytes)),!0),{..._,depth:C.depth}),yield I}async*ls(r={}){for await(const{key:_,value:E}of this.datastore.query({prefix:DATASTORE_PIN_PREFIX+(r.cid!=null?`${r.cid.toString(base36$4)}`:"")},r)){const S=CID.parse(_.toString().substring(5),base36$4),C=decode$l(E);yield{cid:S,...C}}}async isPinned(r,_={}){const E=new Key(`${DATASTORE_BLOCK_PREFIX}${DATASTORE_ENCODING.encode(r.multihash.bytes)}`);return this.datastore.has(E,_)}}const events={},observable=n=>{n.addEventListener("message",r=>{observable.dispatchEvent("message",n,r)}),n.port!=null&&n.port.addEventListener("message",r=>{observable.dispatchEvent("message",n,r)})};observable.addEventListener=(n,r)=>{events[n]==null&&(events[n]=[]),events[n].push(r)};observable.removeEventListener=(n,r)=>{events[n]!=null&&(events[n]=events[n].filter(_=>_===r))};observable.dispatchEvent=function(n,r,_){events[n]!=null&&events[n].forEach(E=>E(r,_))};const WORKER_REQUEST_READ_LOCK="lock:worker:request-read",WORKER_RELEASE_READ_LOCK="lock:worker:release-read",MASTER_GRANT_READ_LOCK="lock:master:grant-read",WORKER_REQUEST_WRITE_LOCK="lock:worker:request-write",WORKER_RELEASE_WRITE_LOCK="lock:worker:release-write",MASTER_GRANT_WRITE_LOCK="lock:master:grant-write",nanoid=(n=21)=>Math.random().toString().substring(2),handleWorkerLockRequest=(n,r,_,E,S)=>(C,A)=>{if(A.data.type!==_)return;const I={type:A.data.type,name:A.data.name,identifier:A.data.identifier};n.dispatchEvent(new MessageEvent(r,{data:{name:I.name,handler:async()=>{C.postMessage({type:S,name:I.name,identifier:I.identifier}),await new Promise(B=>{const O=N=>{if(N==null||N.data==null)return;const U={type:N.data.type,name:N.data.name,identifier:N.data.identifier};U.type===E&&U.identifier===I.identifier&&(C.removeEventListener("message",O),B())};C.addEventListener("message",O)})}}}))},makeWorkerLockRequest=(n,r,_,E)=>async()=>{const S=nanoid();return globalThis.postMessage({type:r,identifier:S,name:n}),new Promise(C=>{const A=I=>{if(I==null||I.data==null)return;const B={type:I.data.type,identifier:I.data.identifier};B.type===_&&B.identifier===S&&(globalThis.removeEventListener("message",A),C(()=>{globalThis.postMessage({type:E,identifier:S,name:n})}))};globalThis.addEventListener("message",A)})},defaultOptions$6={singleProcess:!1},impl=n=>{if(n=Object.assign({},defaultOptions$6,n),!!globalThis.document||n.singleProcess){const _=new EventTarget;return observable.addEventListener("message",handleWorkerLockRequest(_,"requestReadLock",WORKER_REQUEST_READ_LOCK,WORKER_RELEASE_READ_LOCK,MASTER_GRANT_READ_LOCK)),observable.addEventListener("message",handleWorkerLockRequest(_,"requestWriteLock",WORKER_REQUEST_WRITE_LOCK,WORKER_RELEASE_WRITE_LOCK,MASTER_GRANT_WRITE_LOCK)),_}return{isWorker:!0,readLock:_=>makeWorkerLockRequest(_,WORKER_REQUEST_READ_LOCK,MASTER_GRANT_READ_LOCK,WORKER_RELEASE_READ_LOCK),writeLock:_=>makeWorkerLockRequest(_,WORKER_REQUEST_WRITE_LOCK,MASTER_GRANT_WRITE_LOCK,WORKER_RELEASE_WRITE_LOCK)}},mutexes={};let implementation;async function createReleaseable(n,r){let _;const E=new Promise(S=>{_=S});return n.add(async()=>pTimeout$1((async()=>{await new Promise(S=>{_(()=>{S()})})})(),{milliseconds:r.timeout})),E}const createMutex=(n,r)=>{if(implementation.isWorker===!0)return{readLock:implementation.readLock(n,r),writeLock:implementation.writeLock(n,r)};const _=new PQueue$1({concurrency:1});let E;return{async readLock(){if(E!=null)return createReleaseable(E,r);E=new PQueue$1({concurrency:r.concurrency,autoStart:!1});const S=E,C=createReleaseable(E,r);return _.add(async()=>{S.start(),await S.onIdle().then(()=>{E===S&&(E=null)})}),C},async writeLock(){return E=null,createReleaseable(_,r)}}},defaultOptions$5={name:"lock",concurrency:1/0,timeout:846e5,singleProcess:!1};function createMortice(n){const r=Object.assign({},defaultOptions$5,n);return implementation==null&&(implementation=impl(r),implementation.isWorker!==!0&&(implementation.addEventListener("requestReadLock",_=>{mutexes[_.data.name]!=null&&mutexes[_.data.name].readLock().then(async E=>_.data.handler().finally(()=>{E()}))}),implementation.addEventListener("requestWriteLock",async _=>{mutexes[_.data.name]!=null&&mutexes[_.data.name].writeLock().then(async E=>_.data.handler().finally(()=>{E()}))}))),mutexes[r.name]==null&&(mutexes[r.name]=createMutex(r.name,r)),mutexes[r.name]}class BlockStorage{lock;child;pins;started;constructor(r,_,E={}){this.child=r,this.pins=_,this.lock=createMortice({singleProcess:E.holdGcLock}),this.started=!1}isStarted(){return this.started}async start(){await start(this.child),this.started=!0}async stop(){await stop(this.child),this.started=!1}unwrap(){return this.child}async put(r,_,E={}){const S=await this.lock.readLock();try{return await this.child.put(r,_,E)}finally{S()}}async*putMany(r,_={}){const E=await this.lock.readLock();try{yield*this.child.putMany(r,_)}finally{E()}}async get(r,_={}){const E=await this.lock.readLock();try{return await this.child.get(r,_)}finally{E()}}async*getMany(r,_={}){const E=await this.lock.readLock();try{yield*this.child.getMany(r,_)}finally{E()}}async delete(r,_={}){const E=await this.lock.writeLock();try{if(await this.pins.isPinned(r))throw new Error("CID was pinned");await this.child.delete(r,_)}finally{E()}}async*deleteMany(r,_={}){const E=await this.lock.writeLock();try{const S=this;yield*this.child.deleteMany(async function*(){for await(const C of r){if(await S.pins.isPinned(C))throw new Error("CID was pinned");yield C}}(),_)}finally{E()}}async has(r,_={}){const E=await this.lock.readLock();try{return await this.child.has(r,_)}finally{E()}}async*getAll(r={}){const _=await this.lock.readLock();try{yield*this.child.getAll(r)}finally{_()}}}const DS_VERSION_KEY=new Key("/version"),CURRENT_VERSION=1;async function assertDatastoreVersionIsCurrent(n){if(!await n.has(DS_VERSION_KEY)){await n.put(DS_VERSION_KEY,fromString$3(`${CURRENT_VERSION}`));return}const r=await n.get(DS_VERSION_KEY),_=toString$4(r);if(parseInt(_,10)!==CURRENT_VERSION)throw new Error("Unknown datastore version, a datastore migration may be required")}function defaultHashers(n=[]){return[sha256$6,sha512$4,identity$6,...n]}class HeliaImpl{libp2p;blockstore;datastore;pins;logger;log;constructor(r){this.logger=r.libp2p.logger,this.log=this.logger.forComponent("helia");const _=defaultHashers(r.hashers),E={blockstore:r.blockstore,datastore:r.datastore,libp2p:r.libp2p,hashers:_,logger:r.libp2p.logger},S=r.blockBrokers?.map(A=>A(E))??[bitswap$1()(E),trustlessGateway()(E)],C=new NetworkedStorage(E,{blockBrokers:S,hashers:_});this.pins=new PinsImpl(r.datastore,C,r.dagWalkers??[]),this.libp2p=r.libp2p,this.blockstore=new BlockStorage(C,this.pins,{holdGcLock:r.holdGcLock}),this.datastore=r.datastore}async start(){await assertDatastoreVersionIsCurrent(this.datastore),await start(this.blockstore),await this.libp2p.start()}async stop(){await this.libp2p.stop(),await stop(this.blockstore)}async gc(r={}){const _=await this.blockstore.lock.writeLock();try{const E=this,S=this.blockstore.unwrap();this.log("gc start"),await drain(S.deleteMany(async function*(){for await(const{cid:C}of S.getAll())try{if(await E.pins.isPinned(C,r))continue;yield C,r.onProgress?.(new CustomProgressEvent("helia:gc:deleted",C))}catch(A){E.log.error("Error during gc",A),r.onProgress?.(new CustomProgressEvent("helia:gc:error",A))}}()))}finally{_()}this.log("gc finished")}}const inspect$2=Symbol.for("nodejs.util.inspect.custom"),baseDecoder$1=Object.values(bases$2).map(n=>n.decoder).reduce((n,r)=>n.or(r),bases$2.identity.decoder),LIBP2P_KEY_CODE$1=114,MARSHALLED_ED225519_PUBLIC_KEY_LENGTH$1=36,MARSHALLED_SECP256K1_PUBLIC_KEY_LENGTH$1=37;let PeerIdImpl$1=class{type;multihash;privateKey;publicKey;string;constructor(r){this.type=r.type,this.multihash=r.multihash,this.privateKey=r.privateKey,Object.defineProperty(this,"string",{enumerable:!1,writable:!0})}get[Symbol.toStringTag](){return`PeerId(${this.toString()})`}[peerIdSymbol]=!0;toString(){return this.string==null&&(this.string=base58btc.encode(this.multihash.bytes).slice(1)),this.string}toCID(){return CID.createV1(LIBP2P_KEY_CODE$1,this.multihash)}toBytes(){return this.multihash.bytes}toJSON(){return this.toString()}equals(r){if(r==null)return!1;if(r instanceof Uint8Array)return equals$1(this.multihash.bytes,r);if(typeof r=="string")return peerIdFromString$1(r).equals(this);if(r?.multihash?.bytes!=null)return equals$1(this.multihash.bytes,r.multihash.bytes);throw new Error("not valid Id")}[inspect$2](){return`PeerId(${this.toString()})`}},RSAPeerIdImpl$1=class extends PeerIdImpl$1{type="RSA";publicKey;constructor(r){super({...r,type:"RSA"}),this.publicKey=r.publicKey}},Ed25519PeerIdImpl$1=class extends PeerIdImpl$1{type="Ed25519";publicKey;constructor(r){super({...r,type:"Ed25519"}),this.publicKey=r.multihash.digest}},Secp256k1PeerIdImpl$1=class extends PeerIdImpl$1{type="secp256k1";publicKey;constructor(r){super({...r,type:"secp256k1"}),this.publicKey=r.multihash.digest}};function peerIdFromPeerId(n){if(n.type==="RSA")return new RSAPeerIdImpl$1(n);if(n.type==="Ed25519")return new Ed25519PeerIdImpl$1(n);if(n.type==="secp256k1")return new Secp256k1PeerIdImpl$1(n);throw new CodeError$4("Not a PeerId","ERR_INVALID_PARAMETERS")}function peerIdFromString$1(n,r){if(n.charAt(0)==="1"||n.charAt(0)==="Q"){const _=decode$h(base58btc.decode(`z${n}`));return n.startsWith("12D")?new Ed25519PeerIdImpl$1({multihash:_}):n.startsWith("16U")?new Secp256k1PeerIdImpl$1({multihash:_}):new RSAPeerIdImpl$1({multihash:_})}return peerIdFromBytes$1(baseDecoder$1.decode(n))}function peerIdFromBytes$1(n){try{const r=decode$h(n);if(r.code===identity$6.code){if(r.digest.length===MARSHALLED_ED225519_PUBLIC_KEY_LENGTH$1)return new Ed25519PeerIdImpl$1({multihash:r});if(r.digest.length===MARSHALLED_SECP256K1_PUBLIC_KEY_LENGTH$1)return new Secp256k1PeerIdImpl$1({multihash:r})}if(r.code===sha256$6.code)return new RSAPeerIdImpl$1({multihash:r})}catch{return peerIdFromCID$1(CID.decode(n))}throw new Error("Supplied PeerID CID is invalid")}function peerIdFromCID$1(n){if(n==null||n.multihash==null||n.version==null||n.version===1&&n.code!==LIBP2P_KEY_CODE$1)throw new Error("Supplied PeerID CID is invalid");const r=n.multihash;if(r.code===sha256$6.code)return new RSAPeerIdImpl$1({multihash:n.multihash});if(r.code===identity$6.code){if(r.digest.length===MARSHALLED_ED225519_PUBLIC_KEY_LENGTH$1)return new Ed25519PeerIdImpl$1({multihash:n.multihash});if(r.digest.length===MARSHALLED_SECP256K1_PUBLIC_KEY_LENGTH$1)return new Secp256k1PeerIdImpl$1({multihash:n.multihash})}throw new Error("Supplied PeerID CID is invalid")}async function peerIdFromKeys$1(n,r){return n.length===MARSHALLED_ED225519_PUBLIC_KEY_LENGTH$1?new Ed25519PeerIdImpl$1({multihash:create$4(identity$6.code,n),privateKey:r}):n.length===MARSHALLED_SECP256K1_PUBLIC_KEY_LENGTH$1?new Secp256k1PeerIdImpl$1({multihash:create$4(identity$6.code,n),privateKey:r}):new RSAPeerIdImpl$1({multihash:await sha256$6.digest(n),publicKey:n,privateKey:r})}const second$1=1e3,minute$1=60*second$1,FloodsubID="/floodsub/1.0.0",GossipsubIDv10="/meshsub/1.0.0",GossipsubIDv11="/meshsub/1.1.0",GossipsubD=6,GossipsubDlo=4,GossipsubDhi=12,GossipsubDscore=4,GossipsubDout=2,GossipsubHistoryLength=5,GossipsubHistoryGossip=3,GossipsubDlazy=6,GossipsubGossipFactor=.25,GossipsubGossipRetransmission=3,GossipsubHeartbeatInitialDelay=100,GossipsubHeartbeatInterval=second$1,GossipsubFanoutTTL=minute$1,GossipsubPrunePeers=16,GossipsubPruneBackoff=minute$1,GossipsubUnsubscribeBackoff=10*second$1,GossipsubPruneBackoffTicks=15,GossipsubDirectConnectTicks=300,GossipsubDirectConnectInitialDelay=second$1,GossipsubOpportunisticGraftTicks=60,GossipsubOpportunisticGraftPeers=2,GossipsubGraftFloodThreshold=10*second$1,GossipsubMaxIHaveLength=5e3,GossipsubMaxIHaveMessages=10,GossipsubIWantFollowupTime=3*second$1,GossipsubSeenTTL=2*minute$1,TimeCacheDuration=120*1e3,ERR_TOPIC_VALIDATOR_REJECT="ERR_TOPIC_VALIDATOR_REJECT",ERR_TOPIC_VALIDATOR_IGNORE="ERR_TOPIC_VALIDATOR_IGNORE",ACCEPT_FROM_WHITELIST_THRESHOLD_SCORE=0,ACCEPT_FROM_WHITELIST_MAX_MESSAGES=128,ACCEPT_FROM_WHITELIST_DURATION_MS=1e3,DEFAULT_METRIC_MESH_MESSAGE_DELIVERIES_WINDOWS=1e3,BACKOFF_SLACK=1;var indexMinimal={},minimal$1={},aspromise,hasRequiredAspromise;function requireAspromise(){if(hasRequiredAspromise)return aspromise;hasRequiredAspromise=1,aspromise=n;function n(r,_){for(var E=new Array(arguments.length-1),S=0,C=2,A=!0;C<arguments.length;)E[S++]=arguments[C++];return new Promise(function(B,O){E[S]=function(U){if(A)if(A=!1,U)O(U);else{for(var j=new Array(arguments.length-1),z=0;z<j.length;)j[z++]=arguments[z];B.apply(null,j)}};try{r.apply(_||null,E)}catch(N){A&&(A=!1,O(N))}})}return aspromise}var base64$4={},hasRequiredBase64;function requireBase64(){return hasRequiredBase64||(hasRequiredBase64=1,function(n){var r=n;r.length=function(I){var B=I.length;if(!B)return 0;for(var O=0;--B%4>1&&I.charAt(B)==="=";)++O;return Math.ceil(I.length*3)/4-O};for(var _=new Array(64),E=new Array(123),S=0;S<64;)E[_[S]=S<26?S+65:S<52?S+71:S<62?S-4:S-59|43]=S++;r.encode=function(I,B,O){for(var N=null,U=[],j=0,z=0,Z;B<O;){var X=I[B++];switch(z){case 0:U[j++]=_[X>>2],Z=(X&3)<<4,z=1;break;case 1:U[j++]=_[Z|X>>4],Z=(X&15)<<2,z=2;break;case 2:U[j++]=_[Z|X>>6],U[j++]=_[X&63],z=0;break}j>8191&&((N||(N=[])).push(String.fromCharCode.apply(String,U)),j=0)}return z&&(U[j++]=_[Z],U[j++]=61,z===1&&(U[j++]=61)),N?(j&&N.push(String.fromCharCode.apply(String,U.slice(0,j))),N.join("")):String.fromCharCode.apply(String,U.slice(0,j))};var C="invalid encoding";r.decode=function(I,B,O){for(var N=O,U=0,j,z=0;z<I.length;){var Z=I.charCodeAt(z++);if(Z===61&&U>1)break;if((Z=E[Z])===void 0)throw Error(C);switch(U){case 0:j=Z,U=1;break;case 1:B[O++]=j<<2|(Z&48)>>4,j=Z,U=2;break;case 2:B[O++]=(j&15)<<4|(Z&60)>>2,j=Z,U=3;break;case 3:B[O++]=(j&3)<<6|Z,U=0;break}}if(U===1)throw Error(C);return O-N},r.test=function(I){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(I)}}(base64$4)),base64$4}var eventemitter,hasRequiredEventemitter;function requireEventemitter(){if(hasRequiredEventemitter)return eventemitter;hasRequiredEventemitter=1,eventemitter=n;function n(){this._listeners={}}return n.prototype.on=function(_,E,S){return(this._listeners[_]||(this._listeners[_]=[])).push({fn:E,ctx:S||this}),this},n.prototype.off=function(_,E){if(_===void 0)this._listeners={};else if(E===void 0)this._listeners[_]=[];else for(var S=this._listeners[_],C=0;C<S.length;)S[C].fn===E?S.splice(C,1):++C;return this},n.prototype.emit=function(_){var E=this._listeners[_];if(E){for(var S=[],C=1;C<arguments.length;)S.push(arguments[C++]);for(C=0;C<E.length;)E[C].fn.apply(E[C++].ctx,S)}return this},eventemitter}var float,hasRequiredFloat;function requireFloat(){if(hasRequiredFloat)return float;hasRequiredFloat=1,float=n(n);function n(C){return typeof Float32Array<"u"?function(){var A=new Float32Array([-0]),I=new Uint8Array(A.buffer),B=I[3]===128;function O(z,Z,X){A[0]=z,Z[X]=I[0],Z[X+1]=I[1],Z[X+2]=I[2],Z[X+3]=I[3]}function N(z,Z,X){A[0]=z,Z[X]=I[3],Z[X+1]=I[2],Z[X+2]=I[1],Z[X+3]=I[0]}C.writeFloatLE=B?O:N,C.writeFloatBE=B?N:O;function U(z,Z){return I[0]=z[Z],I[1]=z[Z+1],I[2]=z[Z+2],I[3]=z[Z+3],A[0]}function j(z,Z){return I[3]=z[Z],I[2]=z[Z+1],I[1]=z[Z+2],I[0]=z[Z+3],A[0]}C.readFloatLE=B?U:j,C.readFloatBE=B?j:U}():function(){function A(B,O,N,U){var j=O<0?1:0;if(j&&(O=-O),O===0)B(1/O>0?0:2147483648,N,U);else if(isNaN(O))B(2143289344,N,U);else if(O>34028234663852886e22)B((j<<31|2139095040)>>>0,N,U);else if(O<11754943508222875e-54)B((j<<31|Math.round(O/1401298464324817e-60))>>>0,N,U);else{var z=Math.floor(Math.log(O)/Math.LN2),Z=Math.round(O*Math.pow(2,-z)*8388608)&8388607;B((j<<31|z+127<<23|Z)>>>0,N,U)}}C.writeFloatLE=A.bind(null,r),C.writeFloatBE=A.bind(null,_);function I(B,O,N){var U=B(O,N),j=(U>>31)*2+1,z=U>>>23&255,Z=U&8388607;return z===255?Z?NaN:j*(1/0):z===0?j*1401298464324817e-60*Z:j*Math.pow(2,z-150)*(Z+8388608)}C.readFloatLE=I.bind(null,E),C.readFloatBE=I.bind(null,S)}(),typeof Float64Array<"u"?function(){var A=new Float64Array([-0]),I=new Uint8Array(A.buffer),B=I[7]===128;function O(z,Z,X){A[0]=z,Z[X]=I[0],Z[X+1]=I[1],Z[X+2]=I[2],Z[X+3]=I[3],Z[X+4]=I[4],Z[X+5]=I[5],Z[X+6]=I[6],Z[X+7]=I[7]}function N(z,Z,X){A[0]=z,Z[X]=I[7],Z[X+1]=I[6],Z[X+2]=I[5],Z[X+3]=I[4],Z[X+4]=I[3],Z[X+5]=I[2],Z[X+6]=I[1],Z[X+7]=I[0]}C.writeDoubleLE=B?O:N,C.writeDoubleBE=B?N:O;function U(z,Z){return I[0]=z[Z],I[1]=z[Z+1],I[2]=z[Z+2],I[3]=z[Z+3],I[4]=z[Z+4],I[5]=z[Z+5],I[6]=z[Z+6],I[7]=z[Z+7],A[0]}function j(z,Z){return I[7]=z[Z],I[6]=z[Z+1],I[5]=z[Z+2],I[4]=z[Z+3],I[3]=z[Z+4],I[2]=z[Z+5],I[1]=z[Z+6],I[0]=z[Z+7],A[0]}C.readDoubleLE=B?U:j,C.readDoubleBE=B?j:U}():function(){function A(B,O,N,U,j,z){var Z=U<0?1:0;if(Z&&(U=-U),U===0)B(0,j,z+O),B(1/U>0?0:2147483648,j,z+N);else if(isNaN(U))B(0,j,z+O),B(2146959360,j,z+N);else if(U>17976931348623157e292)B(0,j,z+O),B((Z<<31|2146435072)>>>0,j,z+N);else{var X;if(U<22250738585072014e-324)X=U/5e-324,B(X>>>0,j,z+O),B((Z<<31|X/4294967296)>>>0,j,z+N);else{var Q=Math.floor(Math.log(U)/Math.LN2);Q===1024&&(Q=1023),X=U*Math.pow(2,-Q),B(X*4503599627370496>>>0,j,z+O),B((Z<<31|Q+1023<<20|X*1048576&1048575)>>>0,j,z+N)}}}C.writeDoubleLE=A.bind(null,r,0,4),C.writeDoubleBE=A.bind(null,_,4,0);function I(B,O,N,U,j){var z=B(U,j+O),Z=B(U,j+N),X=(Z>>31)*2+1,Q=Z>>>20&2047,se=4294967296*(Z&1048575)+z;return Q===2047?se?NaN:X*(1/0):Q===0?X*5e-324*se:X*Math.pow(2,Q-1075)*(se+4503599627370496)}C.readDoubleLE=I.bind(null,E,0,4),C.readDoubleBE=I.bind(null,S,4,0)}(),C}function r(C,A,I){A[I]=C&255,A[I+1]=C>>>8&255,A[I+2]=C>>>16&255,A[I+3]=C>>>24}function _(C,A,I){A[I]=C>>>24,A[I+1]=C>>>16&255,A[I+2]=C>>>8&255,A[I+3]=C&255}function E(C,A){return(C[A]|C[A+1]<<8|C[A+2]<<16|C[A+3]<<24)>>>0}function S(C,A){return(C[A]<<24|C[A+1]<<16|C[A+2]<<8|C[A+3])>>>0}return float}var inquire_1,hasRequiredInquire;function requireInquire(){if(hasRequiredInquire)return inquire_1;hasRequiredInquire=1,inquire_1=inquire;function inquire(moduleName){try{var mod=eval("quire".replace(/^/,"re"))(moduleName);if(mod&&(mod.length||Object.keys(mod).length))return mod}catch(n){}return null}return inquire_1}var utf8={},hasRequiredUtf8;function requireUtf8(){return hasRequiredUtf8||(hasRequiredUtf8=1,function(n){var r=n;r.length=function(E){for(var S=0,C=0,A=0;A<E.length;++A)C=E.charCodeAt(A),C<128?S+=1:C<2048?S+=2:(C&64512)===55296&&(E.charCodeAt(A+1)&64512)===56320?(++A,S+=4):S+=3;return S},r.read=function(E,S,C){var A=C-S;if(A<1)return"";for(var I=null,B=[],O=0,N;S<C;)N=E[S++],N<128?B[O++]=N:N>191&&N<224?B[O++]=(N&31)<<6|E[S++]&63:N>239&&N<365?(N=((N&7)<<18|(E[S++]&63)<<12|(E[S++]&63)<<6|E[S++]&63)-65536,B[O++]=55296+(N>>10),B[O++]=56320+(N&1023)):B[O++]=(N&15)<<12|(E[S++]&63)<<6|E[S++]&63,O>8191&&((I||(I=[])).push(String.fromCharCode.apply(String,B)),O=0);return I?(O&&I.push(String.fromCharCode.apply(String,B.slice(0,O))),I.join("")):String.fromCharCode.apply(String,B.slice(0,O))},r.write=function(E,S,C){for(var A=C,I,B,O=0;O<E.length;++O)I=E.charCodeAt(O),I<128?S[C++]=I:I<2048?(S[C++]=I>>6|192,S[C++]=I&63|128):(I&64512)===55296&&((B=E.charCodeAt(O+1))&64512)===56320?(I=65536+((I&1023)<<10)+(B&1023),++O,S[C++]=I>>18|240,S[C++]=I>>12&63|128,S[C++]=I>>6&63|128,S[C++]=I&63|128):(S[C++]=I>>12|224,S[C++]=I>>6&63|128,S[C++]=I&63|128);return C-A}}(utf8)),utf8}var pool_1,hasRequiredPool;function requirePool(){if(hasRequiredPool)return pool_1;hasRequiredPool=1,pool_1=n;function n(r,_,E){var S=E||8192,C=S>>>1,A=null,I=S;return function(O){if(O<1||O>C)return r(O);I+O>S&&(A=r(S),I=0);var N=_.call(A,I,I+=O);return I&7&&(I=(I|7)+1),N}}return pool_1}var longbits,hasRequiredLongbits;function requireLongbits(){if(hasRequiredLongbits)return longbits;hasRequiredLongbits=1,longbits=r;var n=requireMinimal$1();function r(C,A){this.lo=C>>>0,this.hi=A>>>0}var _=r.zero=new r(0,0);_.toNumber=function(){return 0},_.zzEncode=_.zzDecode=function(){return this},_.length=function(){return 1};var E=r.zeroHash="\0\0\0\0\0\0\0\0";r.fromNumber=function(A){if(A===0)return _;var I=A<0;I&&(A=-A);var B=A>>>0,O=(A-B)/4294967296>>>0;return I&&(O=~O>>>0,B=~B>>>0,++B>4294967295&&(B=0,++O>4294967295&&(O=0))),new r(B,O)},r.from=function(A){if(typeof A=="number")return r.fromNumber(A);if(n.isString(A))if(n.Long)A=n.Long.fromString(A);else return r.fromNumber(parseInt(A,10));return A.low||A.high?new r(A.low>>>0,A.high>>>0):_},r.prototype.toNumber=function(A){if(!A&&this.hi>>>31){var I=~this.lo+1>>>0,B=~this.hi>>>0;return I||(B=B+1>>>0),-(I+B*4294967296)}return this.lo+this.hi*4294967296},r.prototype.toLong=function(A){return n.Long?new n.Long(this.lo|0,this.hi|0,!!A):{low:this.lo|0,high:this.hi|0,unsigned:!!A}};var S=String.prototype.charCodeAt;return r.fromHash=function(A){return A===E?_:new r((S.call(A,0)|S.call(A,1)<<8|S.call(A,2)<<16|S.call(A,3)<<24)>>>0,(S.call(A,4)|S.call(A,5)<<8|S.call(A,6)<<16|S.call(A,7)<<24)>>>0)},r.prototype.toHash=function(){return String.fromCharCode(this.lo&255,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,this.hi&255,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)},r.prototype.zzEncode=function(){var A=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^A)>>>0,this.lo=(this.lo<<1^A)>>>0,this},r.prototype.zzDecode=function(){var A=-(this.lo&1);return this.lo=((this.lo>>>1|this.hi<<31)^A)>>>0,this.hi=(this.hi>>>1^A)>>>0,this},r.prototype.length=function(){var A=this.lo,I=(this.lo>>>28|this.hi<<4)>>>0,B=this.hi>>>24;return B===0?I===0?A<16384?A<128?1:2:A<2097152?3:4:I<16384?I<128?5:6:I<2097152?7:8:B<128?9:10},longbits}var hasRequiredMinimal$1;function requireMinimal$1(){return hasRequiredMinimal$1||(hasRequiredMinimal$1=1,function(n){var r=n;r.asPromise=requireAspromise(),r.base64=requireBase64(),r.EventEmitter=requireEventemitter(),r.float=requireFloat(),r.inquire=requireInquire(),r.utf8=requireUtf8(),r.pool=requirePool(),r.LongBits=requireLongbits(),r.isNode=!!(typeof commonjsGlobal<"u"&&commonjsGlobal&&commonjsGlobal.process&&commonjsGlobal.process.versions&&commonjsGlobal.process.versions.node),r.global=r.isNode&&commonjsGlobal||typeof window<"u"&&window||typeof self<"u"&&self||commonjsGlobal,r.emptyArray=Object.freeze?Object.freeze([]):[],r.emptyObject=Object.freeze?Object.freeze({}):{},r.isInteger=Number.isInteger||function(C){return typeof C=="number"&&isFinite(C)&&Math.floor(C)===C},r.isString=function(C){return typeof C=="string"||C instanceof String},r.isObject=function(C){return C&&typeof C=="object"},r.isset=r.isSet=function(C,A){var I=C[A];return I!=null&&C.hasOwnProperty(A)?typeof I!="object"||(Array.isArray(I)?I.length:Object.keys(I).length)>0:!1},r.Buffer=function(){try{var S=r.inquire("buffer").Buffer;return S.prototype.utf8Write?S:null}catch{return null}}(),r._Buffer_from=null,r._Buffer_allocUnsafe=null,r.newBuffer=function(C){return typeof C=="number"?r.Buffer?r._Buffer_allocUnsafe(C):new r.Array(C):r.Buffer?r._Buffer_from(C):typeof Uint8Array>"u"?C:new Uint8Array(C)},r.Array=typeof Uint8Array<"u"?Uint8Array:Array,r.Long=r.global.dcodeIO&&r.global.dcodeIO.Long||r.global.Long||r.inquire("long"),r.key2Re=/^true|false|0|1$/,r.key32Re=/^-?(?:0|[1-9][0-9]*)$/,r.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/,r.longToHash=function(C){return C?r.LongBits.from(C).toHash():r.LongBits.zeroHash},r.longFromHash=function(C,A){var I=r.LongBits.fromHash(C);return r.Long?r.Long.fromBits(I.lo,I.hi,A):I.toNumber(!!A)};function _(S,C,A){for(var I=Object.keys(C),B=0;B<I.length;++B)(S[I[B]]===void 0||!A)&&(S[I[B]]=C[I[B]]);return S}r.merge=_,r.lcFirst=function(C){return C.charAt(0).toLowerCase()+C.substring(1)};function E(S){function C(A,I){if(!(this instanceof C))return new C(A,I);Object.defineProperty(this,"message",{get:function(){return A}}),Error.captureStackTrace?Error.captureStackTrace(this,C):Object.defineProperty(this,"stack",{value:new Error().stack||""}),I&&_(this,I)}return C.prototype=Object.create(Error.prototype,{constructor:{value:C,writable:!0,enumerable:!1,configurable:!0},name:{get:function(){return S},set:void 0,enumerable:!1,configurable:!0},toString:{value:function(){return this.name+": "+this.message},writable:!0,enumerable:!1,configurable:!0}}),C}r.newError=E,r.ProtocolError=E("ProtocolError"),r.oneOfGetter=function(C){for(var A={},I=0;I<C.length;++I)A[C[I]]=1;return function(){for(var B=Object.keys(this),O=B.length-1;O>-1;--O)if(A[B[O]]===1&&this[B[O]]!==void 0&&this[B[O]]!==null)return B[O]}},r.oneOfSetter=function(C){return function(A){for(var I=0;I<C.length;++I)C[I]!==A&&delete this[C[I]]}},r.toJSONOptions={longs:String,enums:String,bytes:String,json:!0},r._configure=function(){var S=r.Buffer;if(!S){r._Buffer_from=r._Buffer_allocUnsafe=null;return}r._Buffer_from=S.from!==Uint8Array.from&&S.from||function(A,I){return new S(A,I)},r._Buffer_allocUnsafe=S.allocUnsafe||function(A){return new S(A)}}}(minimal$1)),minimal$1}var writer,hasRequiredWriter;function requireWriter(){if(hasRequiredWriter)return writer;hasRequiredWriter=1,writer=B;var n=requireMinimal$1(),r,_=n.LongBits,E=n.base64,S=n.utf8;function C(Q,se,oe){this.fn=Q,this.len=se,this.next=void 0,this.val=oe}function A(){}function I(Q){this.head=Q.head,this.tail=Q.tail,this.len=Q.len,this.next=Q.states}function B(){this.len=0,this.head=new C(A,0,0),this.tail=this.head,this.states=null}var O=function(){return n.Buffer?function(){return(B.create=function(){return new r})()}:function(){return new B}};B.create=O(),B.alloc=function(se){return new n.Array(se)},n.Array!==Array&&(B.alloc=n.pool(B.alloc,n.Array.prototype.subarray)),B.prototype._push=function(se,oe,ue){return this.tail=this.tail.next=new C(se,oe,ue),this.len+=oe,this};function N(Q,se,oe){se[oe]=Q&255}function U(Q,se,oe){for(;Q>127;)se[oe++]=Q&127|128,Q>>>=7;se[oe]=Q}function j(Q,se){this.len=Q,this.next=void 0,this.val=se}j.prototype=Object.create(C.prototype),j.prototype.fn=U,B.prototype.uint32=function(se){return this.len+=(this.tail=this.tail.next=new j((se=se>>>0)<128?1:se<16384?2:se<2097152?3:se<268435456?4:5,se)).len,this},B.prototype.int32=function(se){return se<0?this._push(z,10,_.fromNumber(se)):this.uint32(se)},B.prototype.sint32=function(se){return this.uint32((se<<1^se>>31)>>>0)};function z(Q,se,oe){for(;Q.hi;)se[oe++]=Q.lo&127|128,Q.lo=(Q.lo>>>7|Q.hi<<25)>>>0,Q.hi>>>=7;for(;Q.lo>127;)se[oe++]=Q.lo&127|128,Q.lo=Q.lo>>>7;se[oe++]=Q.lo}B.prototype.uint64=function(se){var oe=_.from(se);return this._push(z,oe.length(),oe)},B.prototype.int64=B.prototype.uint64,B.prototype.sint64=function(se){var oe=_.from(se).zzEncode();return this._push(z,oe.length(),oe)},B.prototype.bool=function(se){return this._push(N,1,se?1:0)};function Z(Q,se,oe){se[oe]=Q&255,se[oe+1]=Q>>>8&255,se[oe+2]=Q>>>16&255,se[oe+3]=Q>>>24}B.prototype.fixed32=function(se){return this._push(Z,4,se>>>0)},B.prototype.sfixed32=B.prototype.fixed32,B.prototype.fixed64=function(se){var oe=_.from(se);return this._push(Z,4,oe.lo)._push(Z,4,oe.hi)},B.prototype.sfixed64=B.prototype.fixed64,B.prototype.float=function(se){return this._push(n.float.writeFloatLE,4,se)},B.prototype.double=function(se){return this._push(n.float.writeDoubleLE,8,se)};var X=n.Array.prototype.set?function(se,oe,ue){oe.set(se,ue)}:function(se,oe,ue){for(var we=0;we<se.length;++we)oe[ue+we]=se[we]};return B.prototype.bytes=function(se){var oe=se.length>>>0;if(!oe)return this._push(N,1,0);if(n.isString(se)){var ue=B.alloc(oe=E.length(se));E.decode(se,ue,0),se=ue}return this.uint32(oe)._push(X,oe,se)},B.prototype.string=function(se){var oe=S.length(se);return oe?this.uint32(oe)._push(S.write,oe,se):this._push(N,1,0)},B.prototype.fork=function(){return this.states=new I(this),this.head=this.tail=new C(A,0,0),this.len=0,this},B.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new C(A,0,0),this.len=0),this},B.prototype.ldelim=function(){var se=this.head,oe=this.tail,ue=this.len;return this.reset().uint32(ue),ue&&(this.tail.next=se.next,this.tail=oe,this.len+=ue),this},B.prototype.finish=function(){for(var se=this.head.next,oe=this.constructor.alloc(this.len),ue=0;se;)se.fn(se.val,oe,ue),ue+=se.len,se=se.next;return oe},B._configure=function(Q){r=Q,B.create=O(),r._configure()},writer}var writer_buffer,hasRequiredWriter_buffer;function requireWriter_buffer(){if(hasRequiredWriter_buffer)return writer_buffer;hasRequiredWriter_buffer=1,writer_buffer=_;var n=requireWriter();(_.prototype=Object.create(n.prototype)).constructor=_;var r=requireMinimal$1();function _(){n.call(this)}_._configure=function(){_.alloc=r._Buffer_allocUnsafe,_.writeBytesBuffer=r.Buffer&&r.Buffer.prototype instanceof Uint8Array&&r.Buffer.prototype.set.name==="set"?function(C,A,I){A.set(C,I)}:function(C,A,I){if(C.copy)C.copy(A,I,0,C.length);else for(var B=0;B<C.length;)A[I++]=C[B++]}},_.prototype.bytes=function(C){r.isString(C)&&(C=r._Buffer_from(C,"base64"));var A=C.length>>>0;return this.uint32(A),A&&this._push(_.writeBytesBuffer,A,C),this};function E(S,C,A){S.length<40?r.utf8.write(S,C,A):C.utf8Write?C.utf8Write(S,A):C.write(S,A)}return _.prototype.string=function(C){var A=r.Buffer.byteLength(C);return this.uint32(A),A&&this._push(E,A,C),this},_._configure(),writer_buffer}var reader,hasRequiredReader;function requireReader(){if(hasRequiredReader)return reader;hasRequiredReader=1,reader=C;var n=requireMinimal$1(),r,_=n.LongBits,E=n.utf8;function S(U,j){return RangeError("index out of range: "+U.pos+" + "+(j||1)+" > "+U.len)}function C(U){this.buf=U,this.pos=0,this.len=U.length}var A=typeof Uint8Array<"u"?function(j){if(j instanceof Uint8Array||Array.isArray(j))return new C(j);throw Error("illegal buffer")}:function(j){if(Array.isArray(j))return new C(j);throw Error("illegal buffer")},I=function(){return n.Buffer?function(z){return(C.create=function(X){return n.Buffer.isBuffer(X)?new r(X):A(X)})(z)}:A};C.create=I(),C.prototype._slice=n.Array.prototype.subarray||n.Array.prototype.slice,C.prototype.uint32=function(){var j=4294967295;return function(){if(j=(this.buf[this.pos]&127)>>>0,this.buf[this.pos++]<128||(j=(j|(this.buf[this.pos]&127)<<7)>>>0,this.buf[this.pos++]<128)||(j=(j|(this.buf[this.pos]&127)<<14)>>>0,this.buf[this.pos++]<128)||(j=(j|(this.buf[this.pos]&127)<<21)>>>0,this.buf[this.pos++]<128)||(j=(j|(this.buf[this.pos]&15)<<28)>>>0,this.buf[this.pos++]<128))return j;if((this.pos+=5)>this.len)throw this.pos=this.len,S(this,10);return j}}(),C.prototype.int32=function(){return this.uint32()|0},C.prototype.sint32=function(){var j=this.uint32();return j>>>1^-(j&1)|0};function B(){var U=new _(0,0),j=0;if(this.len-this.pos>4){for(;j<4;++j)if(U.lo=(U.lo|(this.buf[this.pos]&127)<<j*7)>>>0,this.buf[this.pos++]<128)return U;if(U.lo=(U.lo|(this.buf[this.pos]&127)<<28)>>>0,U.hi=(U.hi|(this.buf[this.pos]&127)>>4)>>>0,this.buf[this.pos++]<128)return U;j=0}else{for(;j<3;++j){if(this.pos>=this.len)throw S(this);if(U.lo=(U.lo|(this.buf[this.pos]&127)<<j*7)>>>0,this.buf[this.pos++]<128)return U}return U.lo=(U.lo|(this.buf[this.pos++]&127)<<j*7)>>>0,U}if(this.len-this.pos>4){for(;j<5;++j)if(U.hi=(U.hi|(this.buf[this.pos]&127)<<j*7+3)>>>0,this.buf[this.pos++]<128)return U}else for(;j<5;++j){if(this.pos>=this.len)throw S(this);if(U.hi=(U.hi|(this.buf[this.pos]&127)<<j*7+3)>>>0,this.buf[this.pos++]<128)return U}throw Error("invalid varint encoding")}C.prototype.bool=function(){return this.uint32()!==0};function O(U,j){return(U[j-4]|U[j-3]<<8|U[j-2]<<16|U[j-1]<<24)>>>0}C.prototype.fixed32=function(){if(this.pos+4>this.len)throw S(this,4);return O(this.buf,this.pos+=4)},C.prototype.sfixed32=function(){if(this.pos+4>this.len)throw S(this,4);return O(this.buf,this.pos+=4)|0};function N(){if(this.pos+8>this.len)throw S(this,8);return new _(O(this.buf,this.pos+=4),O(this.buf,this.pos+=4))}return C.prototype.float=function(){if(this.pos+4>this.len)throw S(this,4);var j=n.float.readFloatLE(this.buf,this.pos);return this.pos+=4,j},C.prototype.double=function(){if(this.pos+8>this.len)throw S(this,4);var j=n.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,j},C.prototype.bytes=function(){var j=this.uint32(),z=this.pos,Z=this.pos+j;if(Z>this.len)throw S(this,j);if(this.pos+=j,Array.isArray(this.buf))return this.buf.slice(z,Z);if(z===Z){var X=n.Buffer;return X?X.alloc(0):new this.buf.constructor(0)}return this._slice.call(this.buf,z,Z)},C.prototype.string=function(){var j=this.bytes();return E.read(j,0,j.length)},C.prototype.skip=function(j){if(typeof j=="number"){if(this.pos+j>this.len)throw S(this,j);this.pos+=j}else do if(this.pos>=this.len)throw S(this);while(this.buf[this.pos++]&128);return this},C.prototype.skipType=function(U){switch(U){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;(U=this.uint32()&7)!==4;)this.skipType(U);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+U+" at offset "+this.pos)}return this},C._configure=function(U){r=U,C.create=I(),r._configure();var j=n.Long?"toLong":"toNumber";n.merge(C.prototype,{int64:function(){return B.call(this)[j](!1)},uint64:function(){return B.call(this)[j](!0)},sint64:function(){return B.call(this).zzDecode()[j](!1)},fixed64:function(){return N.call(this)[j](!0)},sfixed64:function(){return N.call(this)[j](!1)}})},reader}var reader_buffer,hasRequiredReader_buffer;function requireReader_buffer(){if(hasRequiredReader_buffer)return reader_buffer;hasRequiredReader_buffer=1,reader_buffer=_;var n=requireReader();(_.prototype=Object.create(n.prototype)).constructor=_;var r=requireMinimal$1();function _(E){n.call(this,E)}return _._configure=function(){r.Buffer&&(_.prototype._slice=r.Buffer.prototype.slice)},_.prototype.string=function(){var S=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+S,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+S,this.len))},_._configure(),reader_buffer}var rpc$1={},service,hasRequiredService;function requireService(){if(hasRequiredService)return service;hasRequiredService=1,service=r;var n=requireMinimal$1();(r.prototype=Object.create(n.EventEmitter.prototype)).constructor=r;function r(_,E,S){if(typeof _!="function")throw TypeError("rpcImpl must be a function");n.EventEmitter.call(this),this.rpcImpl=_,this.requestDelimited=!!E,this.responseDelimited=!!S}return r.prototype.rpcCall=function _(E,S,C,A,I){if(!A)throw TypeError("request must be specified");var B=this;if(!I)return n.asPromise(_,B,E,S,C,A);if(!B.rpcImpl){setTimeout(function(){I(Error("already ended"))},0);return}try{return B.rpcImpl(E,S[B.requestDelimited?"encodeDelimited":"encode"](A).finish(),function(N,U){if(N)return B.emit("error",N,E),I(N);if(U===null){B.end(!0);return}if(!(U instanceof C))try{U=C[B.responseDelimited?"decodeDelimited":"decode"](U)}catch(j){return B.emit("error",j,E),I(j)}return B.emit("data",U,E),I(null,U)})}catch(O){B.emit("error",O,E),setTimeout(function(){I(O)},0);return}},r.prototype.end=function(E){return this.rpcImpl&&(E||this.rpcImpl(null,null,null),this.rpcImpl=null,this.emit("end").off()),this},service}var hasRequiredRpc;function requireRpc(){return hasRequiredRpc||(hasRequiredRpc=1,function(n){var r=n;r.Service=requireService()}(rpc$1)),rpc$1}var roots,hasRequiredRoots;function requireRoots(){return hasRequiredRoots||(hasRequiredRoots=1,roots={}),roots}var hasRequiredIndexMinimal;function requireIndexMinimal(){return hasRequiredIndexMinimal||(hasRequiredIndexMinimal=1,function(n){var r=n;r.build="minimal",r.Writer=requireWriter(),r.BufferWriter=requireWriter_buffer(),r.Reader=requireReader(),r.BufferReader=requireReader_buffer(),r.util=requireMinimal$1(),r.rpc=requireRpc(),r.roots=requireRoots(),r.configure=_;function _(){r.util._configure(),r.Writer._configure(r.BufferWriter),r.Reader._configure(r.BufferReader)}_()}(indexMinimal)),indexMinimal}var minimal,hasRequiredMinimal;function requireMinimal(){return hasRequiredMinimal||(hasRequiredMinimal=1,minimal=requireIndexMinimal()),minimal}var minimalExports=requireMinimal();const protobuf=getDefaultExportFromCjs(minimalExports),defaultDecodeRpcLimits={maxSubscriptions:1/0,maxMessages:1/0,maxIhaveMessageIDs:1/0,maxIwantMessageIDs:1/0,maxControlMessages:1/0,maxPeerInfos:1/0};function decodeRpc(n,r){r={...r};const _=protobuf.Reader.create(n),E=n.length,S=E===void 0?_.len:_.pos+E,C={};for(;_.pos<S;){const A=_.uint32();switch(A>>>3){case 1:C.subscriptions!=null&&C.subscriptions.length>0||(C.subscriptions=[]),C.subscriptions.length<r.maxSubscriptions?C.subscriptions.push(decodeSubOpts(_,_.uint32())):_.skipType(A&7);break;case 2:C.messages!=null&&C.messages.length>0||(C.messages=[]),C.messages.length<r.maxMessages?C.messages.push(decodeMessage(_,_.uint32())):_.skipType(A&7);break;case 3:C.control=decodeControlMessage(_,_.uint32(),r);break;default:_.skipType(A&7);break}}return C}function decodeSubOpts(n,r){const _=r===void 0?n.len:n.pos+r,E={};for(;n.pos<_;){const S=n.uint32();switch(S>>>3){case 1:E.subscribe=n.bool();break;case 2:E.topic=n.string();break;default:n.skipType(S&7);break}}return E}function decodeMessage(n,r){const _=r===void 0?n.len:n.pos+r,E={};for(;n.pos<_;){const S=n.uint32();switch(S>>>3){case 1:E.from=n.bytes();break;case 2:E.data=n.bytes();break;case 3:E.seqno=n.bytes();break;case 4:E.topic=n.string();break;case 5:E.signature=n.bytes();break;case 6:E.key=n.bytes();break;default:n.skipType(S&7);break}}if(!E.topic)throw Error("missing required 'topic'");return E}function decodeControlMessage(n,r,_){const E=r===void 0?n.len:n.pos+r,S={};for(;n.pos<E;){const C=n.uint32();switch(C>>>3){case 1:S.ihave!=null&&S.ihave.length>0||(S.ihave=[]),S.ihave.length<_.maxControlMessages?S.ihave.push(decodeControlIHave(n,n.uint32(),_)):n.skipType(C&7);break;case 2:S.iwant!=null&&S.iwant.length>0||(S.iwant=[]),S.iwant.length<_.maxControlMessages?S.iwant.push(decodeControlIWant(n,n.uint32(),_)):n.skipType(C&7);break;case 3:S.graft!=null&&S.graft.length>0||(S.graft=[]),S.graft.length<_.maxControlMessages?S.graft.push(decodeControlGraft(n,n.uint32())):n.skipType(C&7);break;case 4:S.prune!=null&&S.prune.length>0||(S.prune=[]),S.prune.length<_.maxControlMessages?S.prune.push(decodeControlPrune(n,n.uint32(),_)):n.skipType(C&7);break;default:n.skipType(C&7);break}}return S}function decodeControlIHave(n,r,_){const E=r===void 0?n.len:n.pos+r,S={};for(;n.pos<E;){const C=n.uint32();switch(C>>>3){case 1:S.topicID=n.string();break;case 2:S.messageIDs!=null&&S.messageIDs.length>0||(S.messageIDs=[]),_.maxIhaveMessageIDs-- >0?S.messageIDs.push(n.bytes()):n.skipType(C&7);break;default:n.skipType(C&7);break}}return S}function decodeControlIWant(n,r,_){const E=r===void 0?n.len:n.pos+r,S={};for(;n.pos<E;){const C=n.uint32();switch(C>>>3){case 1:S.messageIDs!=null&&S.messageIDs.length>0||(S.messageIDs=[]),_.maxIwantMessageIDs-- >0?S.messageIDs.push(n.bytes()):n.skipType(C&7);break;default:n.skipType(C&7);break}}return S}function decodeControlGraft(n,r){const _=r===void 0?n.len:n.pos+r,E={};for(;n.pos<_;){const S=n.uint32();switch(S>>>3){case 1:E.topicID=n.string();break;default:n.skipType(S&7);break}}return E}function decodeControlPrune(n,r,_){const E=r===void 0?n.len:n.pos+r,S={};for(;n.pos<E;){const C=n.uint32();switch(C>>>3){case 1:S.topicID=n.string();break;case 2:S.peers!=null&&S.peers.length>0||(S.peers=[]),_.maxPeerInfos-- >0?S.peers.push(decodePeerInfo(n,n.uint32())):n.skipType(C&7);break;case 3:S.backoff=n.uint64();break;default:n.skipType(C&7);break}}return S}function decodePeerInfo(n,r){const _=r===void 0?n.len:n.pos+r,E={};for(;n.pos<_;){const S=n.uint32();switch(S>>>3){case 1:E.peerID=n.bytes();break;case 2:E.signedPeerRecord=n.bytes();break;default:n.skipType(S&7);break}}return E}var rpc={exports:{}};(function(n){(function(r,_){typeof commonjsRequire=="function"&&n&&n.exports&&(n.exports=_(requireMinimal()))})(commonjsGlobal,function(r){var _=r.Reader,E=r.Writer,S=r.util,C=r.roots.default||(r.roots.default={});return C.RPC=function(){function A(B){if(this.subscriptions=[],this.messages=[],B)for(var O=Object.keys(B),N=0;N<O.length;++N)B[O[N]]!=null&&(this[O[N]]=B[O[N]])}A.prototype.subscriptions=S.emptyArray,A.prototype.messages=S.emptyArray,A.prototype.control=null;var I;return Object.defineProperty(A.prototype,"_control",{get:S.oneOfGetter(I=["control"]),set:S.oneOfSetter(I)}),A.encode=function(O,N){if(N||(N=E.create()),O.subscriptions!=null&&O.subscriptions.length)for(var U=0;U<O.subscriptions.length;++U)C.RPC.SubOpts.encode(O.subscriptions[U],N.uint32(10).fork()).ldelim();if(O.messages!=null&&O.messages.length)for(var U=0;U<O.messages.length;++U)C.RPC.Message.encode(O.messages[U],N.uint32(18).fork()).ldelim();return O.control!=null&&Object.hasOwnProperty.call(O,"control")&&C.RPC.ControlMessage.encode(O.control,N.uint32(26).fork()).ldelim(),N},A.decode=function(O,N){O instanceof _||(O=_.create(O));for(var U=N===void 0?O.len:O.pos+N,j=new C.RPC;O.pos<U;){var z=O.uint32();switch(z>>>3){case 1:j.subscriptions&&j.subscriptions.length||(j.subscriptions=[]),j.subscriptions.push(C.RPC.SubOpts.decode(O,O.uint32()));break;case 2:j.messages&&j.messages.length||(j.messages=[]),j.messages.push(C.RPC.Message.decode(O,O.uint32()));break;case 3:j.control=C.RPC.ControlMessage.decode(O,O.uint32());break;default:O.skipType(z&7);break}}return j},A.fromObject=function(O){if(O instanceof C.RPC)return O;var N=new C.RPC;if(O.subscriptions){if(!Array.isArray(O.subscriptions))throw TypeError(".RPC.subscriptions: array expected");N.subscriptions=[];for(var U=0;U<O.subscriptions.length;++U){if(typeof O.subscriptions[U]!="object")throw TypeError(".RPC.subscriptions: object expected");N.subscriptions[U]=C.RPC.SubOpts.fromObject(O.subscriptions[U])}}if(O.messages){if(!Array.isArray(O.messages))throw TypeError(".RPC.messages: array expected");N.messages=[];for(var U=0;U<O.messages.length;++U){if(typeof O.messages[U]!="object")throw TypeError(".RPC.messages: object expected");N.messages[U]=C.RPC.Message.fromObject(O.messages[U])}}if(O.control!=null){if(typeof O.control!="object")throw TypeError(".RPC.control: object expected");N.control=C.RPC.ControlMessage.fromObject(O.control)}return N},A.toObject=function(O,N){N||(N={});var U={};if((N.arrays||N.defaults)&&(U.subscriptions=[],U.messages=[]),O.subscriptions&&O.subscriptions.length){U.subscriptions=[];for(var j=0;j<O.subscriptions.length;++j)U.subscriptions[j]=C.RPC.SubOpts.toObject(O.subscriptions[j],N)}if(O.messages&&O.messages.length){U.messages=[];for(var j=0;j<O.messages.length;++j)U.messages[j]=C.RPC.Message.toObject(O.messages[j],N)}return O.control!=null&&O.hasOwnProperty("control")&&(U.control=C.RPC.ControlMessage.toObject(O.control,N),N.oneofs&&(U._control="control")),U},A.prototype.toJSON=function(){return this.constructor.toObject(this,r.util.toJSONOptions)},A.SubOpts=function(){function B(N){if(N)for(var U=Object.keys(N),j=0;j<U.length;++j)N[U[j]]!=null&&(this[U[j]]=N[U[j]])}B.prototype.subscribe=null,B.prototype.topic=null;var O;return Object.defineProperty(B.prototype,"_subscribe",{get:S.oneOfGetter(O=["subscribe"]),set:S.oneOfSetter(O)}),Object.defineProperty(B.prototype,"_topic",{get:S.oneOfGetter(O=["topic"]),set:S.oneOfSetter(O)}),B.encode=function(U,j){return j||(j=E.create()),U.subscribe!=null&&Object.hasOwnProperty.call(U,"subscribe")&&j.uint32(8).bool(U.subscribe),U.topic!=null&&Object.hasOwnProperty.call(U,"topic")&&j.uint32(18).string(U.topic),j},B.decode=function(U,j){U instanceof _||(U=_.create(U));for(var z=j===void 0?U.len:U.pos+j,Z=new C.RPC.SubOpts;U.pos<z;){var X=U.uint32();switch(X>>>3){case 1:Z.subscribe=U.bool();break;case 2:Z.topic=U.string();break;default:U.skipType(X&7);break}}return Z},B.fromObject=function(U){if(U instanceof C.RPC.SubOpts)return U;var j=new C.RPC.SubOpts;return U.subscribe!=null&&(j.subscribe=!!U.subscribe),U.topic!=null&&(j.topic=String(U.topic)),j},B.toObject=function(U,j){j||(j={});var z={};return U.subscribe!=null&&U.hasOwnProperty("subscribe")&&(z.subscribe=U.subscribe,j.oneofs&&(z._subscribe="subscribe")),U.topic!=null&&U.hasOwnProperty("topic")&&(z.topic=U.topic,j.oneofs&&(z._topic="topic")),z},B.prototype.toJSON=function(){return this.constructor.toObject(this,r.util.toJSONOptions)},B}(),A.Message=function(){function B(N){if(N)for(var U=Object.keys(N),j=0;j<U.length;++j)N[U[j]]!=null&&(this[U[j]]=N[U[j]])}B.prototype.from=null,B.prototype.data=null,B.prototype.seqno=null,B.prototype.topic="",B.prototype.signature=null,B.prototype.key=null;var O;return Object.defineProperty(B.prototype,"_from",{get:S.oneOfGetter(O=["from"]),set:S.oneOfSetter(O)}),Object.defineProperty(B.prototype,"_data",{get:S.oneOfGetter(O=["data"]),set:S.oneOfSetter(O)}),Object.defineProperty(B.prototype,"_seqno",{get:S.oneOfGetter(O=["seqno"]),set:S.oneOfSetter(O)}),Object.defineProperty(B.prototype,"_signature",{get:S.oneOfGetter(O=["signature"]),set:S.oneOfSetter(O)}),Object.defineProperty(B.prototype,"_key",{get:S.oneOfGetter(O=["key"]),set:S.oneOfSetter(O)}),B.encode=function(U,j){return j||(j=E.create()),U.from!=null&&Object.hasOwnProperty.call(U,"from")&&j.uint32(10).bytes(U.from),U.data!=null&&Object.hasOwnProperty.call(U,"data")&&j.uint32(18).bytes(U.data),U.seqno!=null&&Object.hasOwnProperty.call(U,"seqno")&&j.uint32(26).bytes(U.seqno),j.uint32(34).string(U.topic),U.signature!=null&&Object.hasOwnProperty.call(U,"signature")&&j.uint32(42).bytes(U.signature),U.key!=null&&Object.hasOwnProperty.call(U,"key")&&j.uint32(50).bytes(U.key),j},B.decode=function(U,j){U instanceof _||(U=_.create(U));for(var z=j===void 0?U.len:U.pos+j,Z=new C.RPC.Message;U.pos<z;){var X=U.uint32();switch(X>>>3){case 1:Z.from=U.bytes();break;case 2:Z.data=U.bytes();break;case 3:Z.seqno=U.bytes();break;case 4:Z.topic=U.string();break;case 5:Z.signature=U.bytes();break;case 6:Z.key=U.bytes();break;default:U.skipType(X&7);break}}if(!Z.hasOwnProperty("topic"))throw S.ProtocolError("missing required 'topic'",{instance:Z});return Z},B.fromObject=function(U){if(U instanceof C.RPC.Message)return U;var j=new C.RPC.Message;return U.from!=null&&(typeof U.from=="string"?S.base64.decode(U.from,j.from=S.newBuffer(S.base64.length(U.from)),0):U.from.length&&(j.from=U.from)),U.data!=null&&(typeof U.data=="string"?S.base64.decode(U.data,j.data=S.newBuffer(S.base64.length(U.data)),0):U.data.length&&(j.data=U.data)),U.seqno!=null&&(typeof U.seqno=="string"?S.base64.decode(U.seqno,j.seqno=S.newBuffer(S.base64.length(U.seqno)),0):U.seqno.length&&(j.seqno=U.seqno)),U.topic!=null&&(j.topic=String(U.topic)),U.signature!=null&&(typeof U.signature=="string"?S.base64.decode(U.signature,j.signature=S.newBuffer(S.base64.length(U.signature)),0):U.signature.length&&(j.signature=U.signature)),U.key!=null&&(typeof U.key=="string"?S.base64.decode(U.key,j.key=S.newBuffer(S.base64.length(U.key)),0):U.key.length&&(j.key=U.key)),j},B.toObject=function(U,j){j||(j={});var z={};return j.defaults&&(z.topic=""),U.from!=null&&U.hasOwnProperty("from")&&(z.from=j.bytes===String?S.base64.encode(U.from,0,U.from.length):j.bytes===Array?Array.prototype.slice.call(U.from):U.from,j.oneofs&&(z._from="from")),U.data!=null&&U.hasOwnProperty("data")&&(z.data=j.bytes===String?S.base64.encode(U.data,0,U.data.length):j.bytes===Array?Array.prototype.slice.call(U.data):U.data,j.oneofs&&(z._data="data")),U.seqno!=null&&U.hasOwnProperty("seqno")&&(z.seqno=j.bytes===String?S.base64.encode(U.seqno,0,U.seqno.length):j.bytes===Array?Array.prototype.slice.call(U.seqno):U.seqno,j.oneofs&&(z._seqno="seqno")),U.topic!=null&&U.hasOwnProperty("topic")&&(z.topic=U.topic),U.signature!=null&&U.hasOwnProperty("signature")&&(z.signature=j.bytes===String?S.base64.encode(U.signature,0,U.signature.length):j.bytes===Array?Array.prototype.slice.call(U.signature):U.signature,j.oneofs&&(z._signature="signature")),U.key!=null&&U.hasOwnProperty("key")&&(z.key=j.bytes===String?S.base64.encode(U.key,0,U.key.length):j.bytes===Array?Array.prototype.slice.call(U.key):U.key,j.oneofs&&(z._key="key")),z},B.prototype.toJSON=function(){return this.constructor.toObject(this,r.util.toJSONOptions)},B}(),A.ControlMessage=function(){function B(O){if(this.ihave=[],this.iwant=[],this.graft=[],this.prune=[],O)for(var N=Object.keys(O),U=0;U<N.length;++U)O[N[U]]!=null&&(this[N[U]]=O[N[U]])}return B.prototype.ihave=S.emptyArray,B.prototype.iwant=S.emptyArray,B.prototype.graft=S.emptyArray,B.prototype.prune=S.emptyArray,B.encode=function(N,U){if(U||(U=E.create()),N.ihave!=null&&N.ihave.length)for(var j=0;j<N.ihave.length;++j)C.RPC.ControlIHave.encode(N.ihave[j],U.uint32(10).fork()).ldelim();if(N.iwant!=null&&N.iwant.length)for(var j=0;j<N.iwant.length;++j)C.RPC.ControlIWant.encode(N.iwant[j],U.uint32(18).fork()).ldelim();if(N.graft!=null&&N.graft.length)for(var j=0;j<N.graft.length;++j)C.RPC.ControlGraft.encode(N.graft[j],U.uint32(26).fork()).ldelim();if(N.prune!=null&&N.prune.length)for(var j=0;j<N.prune.length;++j)C.RPC.ControlPrune.encode(N.prune[j],U.uint32(34).fork()).ldelim();return U},B.decode=function(N,U){N instanceof _||(N=_.create(N));for(var j=U===void 0?N.len:N.pos+U,z=new C.RPC.ControlMessage;N.pos<j;){var Z=N.uint32();switch(Z>>>3){case 1:z.ihave&&z.ihave.length||(z.ihave=[]),z.ihave.push(C.RPC.ControlIHave.decode(N,N.uint32()));break;case 2:z.iwant&&z.iwant.length||(z.iwant=[]),z.iwant.push(C.RPC.ControlIWant.decode(N,N.uint32()));break;case 3:z.graft&&z.graft.length||(z.graft=[]),z.graft.push(C.RPC.ControlGraft.decode(N,N.uint32()));break;case 4:z.prune&&z.prune.length||(z.prune=[]),z.prune.push(C.RPC.ControlPrune.decode(N,N.uint32()));break;default:N.skipType(Z&7);break}}return z},B.fromObject=function(N){if(N instanceof C.RPC.ControlMessage)return N;var U=new C.RPC.ControlMessage;if(N.ihave){if(!Array.isArray(N.ihave))throw TypeError(".RPC.ControlMessage.ihave: array expected");U.ihave=[];for(var j=0;j<N.ihave.length;++j){if(typeof N.ihave[j]!="object")throw TypeError(".RPC.ControlMessage.ihave: object expected");U.ihave[j]=C.RPC.ControlIHave.fromObject(N.ihave[j])}}if(N.iwant){if(!Array.isArray(N.iwant))throw TypeError(".RPC.ControlMessage.iwant: array expected");U.iwant=[];for(var j=0;j<N.iwant.length;++j){if(typeof N.iwant[j]!="object")throw TypeError(".RPC.ControlMessage.iwant: object expected");U.iwant[j]=C.RPC.ControlIWant.fromObject(N.iwant[j])}}if(N.graft){if(!Array.isArray(N.graft))throw TypeError(".RPC.ControlMessage.graft: array expected");U.graft=[];for(var j=0;j<N.graft.length;++j){if(typeof N.graft[j]!="object")throw TypeError(".RPC.ControlMessage.graft: object expected");U.graft[j]=C.RPC.ControlGraft.fromObject(N.graft[j])}}if(N.prune){if(!Array.isArray(N.prune))throw TypeError(".RPC.ControlMessage.prune: array expected");U.prune=[];for(var j=0;j<N.prune.length;++j){if(typeof N.prune[j]!="object")throw TypeError(".RPC.ControlMessage.prune: object expected");U.prune[j]=C.RPC.ControlPrune.fromObject(N.prune[j])}}return U},B.toObject=function(N,U){U||(U={});var j={};if((U.arrays||U.defaults)&&(j.ihave=[],j.iwant=[],j.graft=[],j.prune=[]),N.ihave&&N.ihave.length){j.ihave=[];for(var z=0;z<N.ihave.length;++z)j.ihave[z]=C.RPC.ControlIHave.toObject(N.ihave[z],U)}if(N.iwant&&N.iwant.length){j.iwant=[];for(var z=0;z<N.iwant.length;++z)j.iwant[z]=C.RPC.ControlIWant.toObject(N.iwant[z],U)}if(N.graft&&N.graft.length){j.graft=[];for(var z=0;z<N.graft.length;++z)j.graft[z]=C.RPC.ControlGraft.toObject(N.graft[z],U)}if(N.prune&&N.prune.length){j.prune=[];for(var z=0;z<N.prune.length;++z)j.prune[z]=C.RPC.ControlPrune.toObject(N.prune[z],U)}return j},B.prototype.toJSON=function(){return this.constructor.toObject(this,r.util.toJSONOptions)},B}(),A.ControlIHave=function(){function B(N){if(this.messageIDs=[],N)for(var U=Object.keys(N),j=0;j<U.length;++j)N[U[j]]!=null&&(this[U[j]]=N[U[j]])}B.prototype.topicID=null,B.prototype.messageIDs=S.emptyArray;var O;return Object.defineProperty(B.prototype,"_topicID",{get:S.oneOfGetter(O=["topicID"]),set:S.oneOfSetter(O)}),B.encode=function(U,j){if(j||(j=E.create()),U.topicID!=null&&Object.hasOwnProperty.call(U,"topicID")&&j.uint32(10).string(U.topicID),U.messageIDs!=null&&U.messageIDs.length)for(var z=0;z<U.messageIDs.length;++z)j.uint32(18).bytes(U.messageIDs[z]);return j},B.decode=function(U,j){U instanceof _||(U=_.create(U));for(var z=j===void 0?U.len:U.pos+j,Z=new C.RPC.ControlIHave;U.pos<z;){var X=U.uint32();switch(X>>>3){case 1:Z.topicID=U.string();break;case 2:Z.messageIDs&&Z.messageIDs.length||(Z.messageIDs=[]),Z.messageIDs.push(U.bytes());break;default:U.skipType(X&7);break}}return Z},B.fromObject=function(U){if(U instanceof C.RPC.ControlIHave)return U;var j=new C.RPC.ControlIHave;if(U.topicID!=null&&(j.topicID=String(U.topicID)),U.messageIDs){if(!Array.isArray(U.messageIDs))throw TypeError(".RPC.ControlIHave.messageIDs: array expected");j.messageIDs=[];for(var z=0;z<U.messageIDs.length;++z)typeof U.messageIDs[z]=="string"?S.base64.decode(U.messageIDs[z],j.messageIDs[z]=S.newBuffer(S.base64.length(U.messageIDs[z])),0):U.messageIDs[z].length&&(j.messageIDs[z]=U.messageIDs[z])}return j},B.toObject=function(U,j){j||(j={});var z={};if((j.arrays||j.defaults)&&(z.messageIDs=[]),U.topicID!=null&&U.hasOwnProperty("topicID")&&(z.topicID=U.topicID,j.oneofs&&(z._topicID="topicID")),U.messageIDs&&U.messageIDs.length){z.messageIDs=[];for(var Z=0;Z<U.messageIDs.length;++Z)z.messageIDs[Z]=j.bytes===String?S.base64.encode(U.messageIDs[Z],0,U.messageIDs[Z].length):j.bytes===Array?Array.prototype.slice.call(U.messageIDs[Z]):U.messageIDs[Z]}return z},B.prototype.toJSON=function(){return this.constructor.toObject(this,r.util.toJSONOptions)},B}(),A.ControlIWant=function(){function B(O){if(this.messageIDs=[],O)for(var N=Object.keys(O),U=0;U<N.length;++U)O[N[U]]!=null&&(this[N[U]]=O[N[U]])}return B.prototype.messageIDs=S.emptyArray,B.encode=function(N,U){if(U||(U=E.create()),N.messageIDs!=null&&N.messageIDs.length)for(var j=0;j<N.messageIDs.length;++j)U.uint32(10).bytes(N.messageIDs[j]);return U},B.decode=function(N,U){N instanceof _||(N=_.create(N));for(var j=U===void 0?N.len:N.pos+U,z=new C.RPC.ControlIWant;N.pos<j;){var Z=N.uint32();switch(Z>>>3){case 1:z.messageIDs&&z.messageIDs.length||(z.messageIDs=[]),z.messageIDs.push(N.bytes());break;default:N.skipType(Z&7);break}}return z},B.fromObject=function(N){if(N instanceof C.RPC.ControlIWant)return N;var U=new C.RPC.ControlIWant;if(N.messageIDs){if(!Array.isArray(N.messageIDs))throw TypeError(".RPC.ControlIWant.messageIDs: array expected");U.messageIDs=[];for(var j=0;j<N.messageIDs.length;++j)typeof N.messageIDs[j]=="string"?S.base64.decode(N.messageIDs[j],U.messageIDs[j]=S.newBuffer(S.base64.length(N.messageIDs[j])),0):N.messageIDs[j].length&&(U.messageIDs[j]=N.messageIDs[j])}return U},B.toObject=function(N,U){U||(U={});var j={};if((U.arrays||U.defaults)&&(j.messageIDs=[]),N.messageIDs&&N.messageIDs.length){j.messageIDs=[];for(var z=0;z<N.messageIDs.length;++z)j.messageIDs[z]=U.bytes===String?S.base64.encode(N.messageIDs[z],0,N.messageIDs[z].length):U.bytes===Array?Array.prototype.slice.call(N.messageIDs[z]):N.messageIDs[z]}return j},B.prototype.toJSON=function(){return this.constructor.toObject(this,r.util.toJSONOptions)},B}(),A.ControlGraft=function(){function B(N){if(N)for(var U=Object.keys(N),j=0;j<U.length;++j)N[U[j]]!=null&&(this[U[j]]=N[U[j]])}B.prototype.topicID=null;var O;return Object.defineProperty(B.prototype,"_topicID",{get:S.oneOfGetter(O=["topicID"]),set:S.oneOfSetter(O)}),B.encode=function(U,j){return j||(j=E.create()),U.topicID!=null&&Object.hasOwnProperty.call(U,"topicID")&&j.uint32(10).string(U.topicID),j},B.decode=function(U,j){U instanceof _||(U=_.create(U));for(var z=j===void 0?U.len:U.pos+j,Z=new C.RPC.ControlGraft;U.pos<z;){var X=U.uint32();switch(X>>>3){case 1:Z.topicID=U.string();break;default:U.skipType(X&7);break}}return Z},B.fromObject=function(U){if(U instanceof C.RPC.ControlGraft)return U;var j=new C.RPC.ControlGraft;return U.topicID!=null&&(j.topicID=String(U.topicID)),j},B.toObject=function(U,j){j||(j={});var z={};return U.topicID!=null&&U.hasOwnProperty("topicID")&&(z.topicID=U.topicID,j.oneofs&&(z._topicID="topicID")),z},B.prototype.toJSON=function(){return this.constructor.toObject(this,r.util.toJSONOptions)},B}(),A.ControlPrune=function(){function B(N){if(this.peers=[],N)for(var U=Object.keys(N),j=0;j<U.length;++j)N[U[j]]!=null&&(this[U[j]]=N[U[j]])}B.prototype.topicID=null,B.prototype.peers=S.emptyArray,B.prototype.backoff=null;var O;return Object.defineProperty(B.prototype,"_topicID",{get:S.oneOfGetter(O=["topicID"]),set:S.oneOfSetter(O)}),Object.defineProperty(B.prototype,"_backoff",{get:S.oneOfGetter(O=["backoff"]),set:S.oneOfSetter(O)}),B.encode=function(U,j){if(j||(j=E.create()),U.topicID!=null&&Object.hasOwnProperty.call(U,"topicID")&&j.uint32(10).string(U.topicID),U.peers!=null&&U.peers.length)for(var z=0;z<U.peers.length;++z)C.RPC.PeerInfo.encode(U.peers[z],j.uint32(18).fork()).ldelim();return U.backoff!=null&&Object.hasOwnProperty.call(U,"backoff")&&j.uint32(24).uint64(U.backoff),j},B.decode=function(U,j){U instanceof _||(U=_.create(U));for(var z=j===void 0?U.len:U.pos+j,Z=new C.RPC.ControlPrune;U.pos<z;){var X=U.uint32();switch(X>>>3){case 1:Z.topicID=U.string();break;case 2:Z.peers&&Z.peers.length||(Z.peers=[]),Z.peers.push(C.RPC.PeerInfo.decode(U,U.uint32()));break;case 3:Z.backoff=U.uint64();break;default:U.skipType(X&7);break}}return Z},B.fromObject=function(U){if(U instanceof C.RPC.ControlPrune)return U;var j=new C.RPC.ControlPrune;if(U.topicID!=null&&(j.topicID=String(U.topicID)),U.peers){if(!Array.isArray(U.peers))throw TypeError(".RPC.ControlPrune.peers: array expected");j.peers=[];for(var z=0;z<U.peers.length;++z){if(typeof U.peers[z]!="object")throw TypeError(".RPC.ControlPrune.peers: object expected");j.peers[z]=C.RPC.PeerInfo.fromObject(U.peers[z])}}return U.backoff!=null&&(S.Long?(j.backoff=S.Long.fromValue(U.backoff)).unsigned=!0:typeof U.backoff=="string"?j.backoff=parseInt(U.backoff,10):typeof U.backoff=="number"?j.backoff=U.backoff:typeof U.backoff=="object"&&(j.backoff=new S.LongBits(U.backoff.low>>>0,U.backoff.high>>>0).toNumber(!0))),j},B.toObject=function(U,j){j||(j={});var z={};if((j.arrays||j.defaults)&&(z.peers=[]),U.topicID!=null&&U.hasOwnProperty("topicID")&&(z.topicID=U.topicID,j.oneofs&&(z._topicID="topicID")),U.peers&&U.peers.length){z.peers=[];for(var Z=0;Z<U.peers.length;++Z)z.peers[Z]=C.RPC.PeerInfo.toObject(U.peers[Z],j)}return U.backoff!=null&&U.hasOwnProperty("backoff")&&(typeof U.backoff=="number"?z.backoff=j.longs===String?String(U.backoff):U.backoff:z.backoff=j.longs===String?S.Long.prototype.toString.call(U.backoff):j.longs===Number?new S.LongBits(U.backoff.low>>>0,U.backoff.high>>>0).toNumber(!0):U.backoff,j.oneofs&&(z._backoff="backoff")),z},B.prototype.toJSON=function(){return this.constructor.toObject(this,r.util.toJSONOptions)},B}(),A.PeerInfo=function(){function B(N){if(N)for(var U=Object.keys(N),j=0;j<U.length;++j)N[U[j]]!=null&&(this[U[j]]=N[U[j]])}B.prototype.peerID=null,B.prototype.signedPeerRecord=null;var O;return Object.defineProperty(B.prototype,"_peerID",{get:S.oneOfGetter(O=["peerID"]),set:S.oneOfSetter(O)}),Object.defineProperty(B.prototype,"_signedPeerRecord",{get:S.oneOfGetter(O=["signedPeerRecord"]),set:S.oneOfSetter(O)}),B.encode=function(U,j){return j||(j=E.create()),U.peerID!=null&&Object.hasOwnProperty.call(U,"peerID")&&j.uint32(10).bytes(U.peerID),U.signedPeerRecord!=null&&Object.hasOwnProperty.call(U,"signedPeerRecord")&&j.uint32(18).bytes(U.signedPeerRecord),j},B.decode=function(U,j){U instanceof _||(U=_.create(U));for(var z=j===void 0?U.len:U.pos+j,Z=new C.RPC.PeerInfo;U.pos<z;){var X=U.uint32();switch(X>>>3){case 1:Z.peerID=U.bytes();break;case 2:Z.signedPeerRecord=U.bytes();break;default:U.skipType(X&7);break}}return Z},B.fromObject=function(U){if(U instanceof C.RPC.PeerInfo)return U;var j=new C.RPC.PeerInfo;return U.peerID!=null&&(typeof U.peerID=="string"?S.base64.decode(U.peerID,j.peerID=S.newBuffer(S.base64.length(U.peerID)),0):U.peerID.length&&(j.peerID=U.peerID)),U.signedPeerRecord!=null&&(typeof U.signedPeerRecord=="string"?S.base64.decode(U.signedPeerRecord,j.signedPeerRecord=S.newBuffer(S.base64.length(U.signedPeerRecord)),0):U.signedPeerRecord.length&&(j.signedPeerRecord=U.signedPeerRecord)),j},B.toObject=function(U,j){j||(j={});var z={};return U.peerID!=null&&U.hasOwnProperty("peerID")&&(z.peerID=j.bytes===String?S.base64.encode(U.peerID,0,U.peerID.length):j.bytes===Array?Array.prototype.slice.call(U.peerID):U.peerID,j.oneofs&&(z._peerID="peerID")),U.signedPeerRecord!=null&&U.hasOwnProperty("signedPeerRecord")&&(z.signedPeerRecord=j.bytes===String?S.base64.encode(U.signedPeerRecord,0,U.signedPeerRecord.length):j.bytes===Array?Array.prototype.slice.call(U.signedPeerRecord):U.signedPeerRecord,j.oneofs&&(z._signedPeerRecord="signedPeerRecord")),z},B.prototype.toJSON=function(){return this.constructor.toObject(this,r.util.toJSONOptions)},B}(),A}(),C})})(rpc);var rpcExports=rpc.exports;const cjs=getDefaultExportFromCjs(rpcExports),{RPC:RPC$1}=cjs;class MessageCache{gossip;msgs=new Map;msgIdToStrFn;history=[];notValidatedCount=0;constructor(r,_,E){this.gossip=r,this.msgIdToStrFn=E;for(let S=0;S<_;S++)this.history[S]=[]}get size(){return this.msgs.size}put(r,_,E=!1){const{msgIdStr:S}=r;return this.msgs.has(S)?!1:(this.msgs.set(S,{message:_,validated:E,originatingPeers:new Set,iwantCounts:new Map}),this.history[0].push({...r,topic:_.topic}),E||this.notValidatedCount++,!0)}observeDuplicate(r,_){const E=this.msgs.get(r);E!=null&&!E.validated&&E.originatingPeers.add(_)}get(r){return this.msgs.get(this.msgIdToStrFn(r))?.message}getWithIWantCount(r,_){const E=this.msgs.get(r);if(E==null)return null;const S=(E.iwantCounts.get(_)??0)+1;return E.iwantCounts.set(_,S),{msg:E.message,count:S}}getGossipIDs(r){const _=new Map;for(let E=0;E<this.gossip;E++)this.history[E].forEach(S=>{if((this.msgs.get(S.msgIdStr)?.validated??!1)&&r.has(S.topic)){let A=_.get(S.topic);A==null&&(A=[],_.set(S.topic,A)),A.push(S.msgId)}});return _}validate(r){const _=this.msgs.get(r);if(_==null)return null;_.validated||this.notValidatedCount--;const{message:E,originatingPeers:S}=_;return _.validated=!0,_.originatingPeers=new Set,{message:E,originatingPeers:S}}shift(){this.history[this.history.length-1].forEach(_=>{const E=this.msgs.get(_.msgIdStr);E!=null&&(this.msgs.delete(_.msgIdStr),E.validated||this.notValidatedCount--)}),this.history.pop(),this.history.unshift([])}remove(r){const _=this.msgs.get(r);return _==null?null:(this.msgs.delete(r),_)}}var SignaturePolicy;(function(n){n.StrictSign="StrictSign",n.StrictNoSign="StrictNoSign"})(SignaturePolicy||(SignaturePolicy={}));var PublishConfigType;(function(n){n[n.Signing=0]="Signing",n[n.Anonymous=1]="Anonymous"})(PublishConfigType||(PublishConfigType={}));var RejectReason;(function(n){n.Error="error",n.Ignore="ignore",n.Reject="reject",n.Blacklisted="blacklisted"})(RejectReason||(RejectReason={}));var ValidateError;(function(n){n.InvalidSignature="invalid_signature",n.InvalidSeqno="invalid_seqno",n.InvalidPeerId="invalid_peerid",n.SignaturePresent="signature_present",n.SeqnoPresent="seqno_present",n.FromPresent="from_present",n.TransformFailed="transform_failed"})(ValidateError||(ValidateError={}));var MessageStatus;(function(n){n.duplicate="duplicate",n.invalid="invalid",n.valid="valid"})(MessageStatus||(MessageStatus={}));function rejectReasonFromAcceptance(n){switch(n){case TopicValidatorResult.Ignore:return RejectReason.Ignore;case TopicValidatorResult.Reject:return RejectReason.Reject;default:throw new Error("Unreachable")}}var MessageSource;(function(n){n.forward="forward",n.publish="publish"})(MessageSource||(MessageSource={}));var InclusionReason;(function(n){n.Fanout="fanout",n.Random="random",n.Subscribed="subscribed",n.Outbound="outbound",n.NotEnough="not_enough",n.Opportunistic="opportunistic"})(InclusionReason||(InclusionReason={}));var ChurnReason;(function(n){n.Dc="disconnected",n.BadScore="bad_score",n.Prune="prune",n.Excess="excess"})(ChurnReason||(ChurnReason={}));var ScorePenalty;(function(n){n.GraftBackoff="graft_backoff",n.BrokenPromise="broken_promise",n.MessageDeficit="message_deficit",n.IPColocation="IP_colocation"})(ScorePenalty||(ScorePenalty={}));var IHaveIgnoreReason;(function(n){n.LowScore="low_score",n.MaxIhave="max_ihave",n.MaxIasked="max_iasked"})(IHaveIgnoreReason||(IHaveIgnoreReason={}));var ScoreThreshold;(function(n){n.graylist="graylist",n.publish="publish",n.gossip="gossip",n.mesh="mesh"})(ScoreThreshold||(ScoreThreshold={}));function getMetrics(n,r,_){return{protocolsEnabled:n.gauge({name:"gossipsub_protocol",help:"Status of enabled protocols",labelNames:["protocol"]}),topicSubscriptionStatus:n.gauge({name:"gossipsub_topic_subscription_status",help:"Status of our subscription to this topic",labelNames:["topicStr"]}),topicPeersCount:n.gauge({name:"gossipsub_topic_peer_count",help:"Number of peers subscribed to each topic",labelNames:["topicStr"]}),meshPeerCounts:n.gauge({name:"gossipsub_mesh_peer_count",help:"Number of peers in our mesh",labelNames:["topicStr"]}),meshPeerInclusionEventsFanout:n.gauge({name:"gossipsub_mesh_peer_inclusion_events_fanout_total",help:"Number of times we include peers in a topic mesh for fanout reasons",labelNames:["topic"]}),meshPeerInclusionEventsRandom:n.gauge({name:"gossipsub_mesh_peer_inclusion_events_random_total",help:"Number of times we include peers in a topic mesh for random reasons",labelNames:["topic"]}),meshPeerInclusionEventsSubscribed:n.gauge({name:"gossipsub_mesh_peer_inclusion_events_subscribed_total",help:"Number of times we include peers in a topic mesh for subscribed reasons",labelNames:["topic"]}),meshPeerInclusionEventsOutbound:n.gauge({name:"gossipsub_mesh_peer_inclusion_events_outbound_total",help:"Number of times we include peers in a topic mesh for outbound reasons",labelNames:["topic"]}),meshPeerInclusionEventsNotEnough:n.gauge({name:"gossipsub_mesh_peer_inclusion_events_not_enough_total",help:"Number of times we include peers in a topic mesh for not_enough reasons",labelNames:["topic"]}),meshPeerInclusionEventsOpportunistic:n.gauge({name:"gossipsub_mesh_peer_inclusion_events_opportunistic_total",help:"Number of times we include peers in a topic mesh for opportunistic reasons",labelNames:["topic"]}),meshPeerInclusionEventsUnknown:n.gauge({name:"gossipsub_mesh_peer_inclusion_events_unknown_total",help:"Number of times we include peers in a topic mesh for unknown reasons",labelNames:["topic"]}),meshPeerChurnEventsDisconnected:n.gauge({name:"gossipsub_peer_churn_events_disconnected_total",help:"Number of times we remove peers in a topic mesh for disconnected reasons",labelNames:["topic"]}),meshPeerChurnEventsBadScore:n.gauge({name:"gossipsub_peer_churn_events_bad_score_total",help:"Number of times we remove peers in a topic mesh for bad_score reasons",labelNames:["topic"]}),meshPeerChurnEventsPrune:n.gauge({name:"gossipsub_peer_churn_events_prune_total",help:"Number of times we remove peers in a topic mesh for prune reasons",labelNames:["topic"]}),meshPeerChurnEventsExcess:n.gauge({name:"gossipsub_peer_churn_events_excess_total",help:"Number of times we remove peers in a topic mesh for excess reasons",labelNames:["topic"]}),meshPeerChurnEventsUnknown:n.gauge({name:"gossipsub_peer_churn_events_unknown_total",help:"Number of times we remove peers in a topic mesh for unknown reasons",labelNames:["topic"]}),peersPerProtocol:n.gauge({name:"gossipsub_peers_per_protocol_count",help:"Peers connected for each topic",labelNames:["protocol"]}),heartbeatDuration:n.histogram({name:"gossipsub_heartbeat_duration_seconds",help:"The time it takes to complete one iteration of the heartbeat",buckets:[.01,.1,1]}),heartbeatSkipped:n.gauge({name:"gossipsub_heartbeat_skipped",help:"Heartbeat run took longer than heartbeat interval so next is skipped"}),acceptedMessagesTotal:n.gauge({name:"gossipsub_accepted_messages_total",help:"Total accepted messages for each topic",labelNames:["topic"]}),ignoredMessagesTotal:n.gauge({name:"gossipsub_ignored_messages_total",help:"Total ignored messages for each topic",labelNames:["topic"]}),rejectedMessagesTotal:n.gauge({name:"gossipsub_rejected_messages_total",help:"Total rejected messages for each topic",labelNames:["topic"]}),unknownValidationResultsTotal:n.gauge({name:"gossipsub_unknown_validation_results_total",help:"Total unknown validation results for each topic",labelNames:["topic"]}),asyncValidationMcacheHit:n.gauge({name:"gossipsub_async_validation_mcache_hit_total",help:"Async validation result reported by the user layer",labelNames:["hit"]}),asyncValidationDelayFromFirstSeenSec:n.histogram({name:"gossipsub_async_validation_delay_from_first_seen",help:"Async validation report delay from first seen in second",buckets:[.01,.03,.1,.3,1,3,10]}),asyncValidationUnknownFirstSeen:n.gauge({name:"gossipsub_async_validation_unknown_first_seen_count_total",help:"Async validation report unknown first seen value for message"}),peerReadStreamError:n.gauge({name:"gossipsub_peer_read_stream_err_count_total",help:"Peer read stream error"}),rpcRecvBytes:n.gauge({name:"gossipsub_rpc_recv_bytes_total",help:"RPC recv"}),rpcRecvCount:n.gauge({name:"gossipsub_rpc_recv_count_total",help:"RPC recv"}),rpcRecvSubscription:n.gauge({name:"gossipsub_rpc_recv_subscription_total",help:"RPC recv"}),rpcRecvMessage:n.gauge({name:"gossipsub_rpc_recv_message_total",help:"RPC recv"}),rpcRecvControl:n.gauge({name:"gossipsub_rpc_recv_control_total",help:"RPC recv"}),rpcRecvIHave:n.gauge({name:"gossipsub_rpc_recv_ihave_total",help:"RPC recv"}),rpcRecvIWant:n.gauge({name:"gossipsub_rpc_recv_iwant_total",help:"RPC recv"}),rpcRecvGraft:n.gauge({name:"gossipsub_rpc_recv_graft_total",help:"RPC recv"}),rpcRecvPrune:n.gauge({name:"gossipsub_rpc_recv_prune_total",help:"RPC recv"}),rpcDataError:n.gauge({name:"gossipsub_rpc_data_err_count_total",help:"RPC data error"}),rpcRecvError:n.gauge({name:"gossipsub_rpc_recv_err_count_total",help:"RPC recv error"}),rpcRecvNotAccepted:n.gauge({name:"gossipsub_rpc_rcv_not_accepted_total",help:"Total count of RPC dropped because acceptFrom() == false"}),rpcSentBytes:n.gauge({name:"gossipsub_rpc_sent_bytes_total",help:"RPC sent"}),rpcSentCount:n.gauge({name:"gossipsub_rpc_sent_count_total",help:"RPC sent"}),rpcSentSubscription:n.gauge({name:"gossipsub_rpc_sent_subscription_total",help:"RPC sent"}),rpcSentMessage:n.gauge({name:"gossipsub_rpc_sent_message_total",help:"RPC sent"}),rpcSentControl:n.gauge({name:"gossipsub_rpc_sent_control_total",help:"RPC sent"}),rpcSentIHave:n.gauge({name:"gossipsub_rpc_sent_ihave_total",help:"RPC sent"}),rpcSentIWant:n.gauge({name:"gossipsub_rpc_sent_iwant_total",help:"RPC sent"}),rpcSentGraft:n.gauge({name:"gossipsub_rpc_sent_graft_total",help:"RPC sent"}),rpcSentPrune:n.gauge({name:"gossipsub_rpc_sent_prune_total",help:"RPC sent"}),msgPublishCount:n.gauge({name:"gossipsub_msg_publish_count_total",help:"Total count of msg published by topic",labelNames:["topic"]}),msgPublishPeersByTopic:n.gauge({name:"gossipsub_msg_publish_peers_total",help:"Total count of peers that we publish a msg to",labelNames:["topic"]}),directPeersPublishedTotal:n.gauge({name:"gossipsub_direct_peers_published_total",help:"Total direct peers that we publish a msg to",labelNames:["topic"]}),floodsubPeersPublishedTotal:n.gauge({name:"gossipsub_floodsub_peers_published_total",help:"Total floodsub peers that we publish a msg to",labelNames:["topic"]}),meshPeersPublishedTotal:n.gauge({name:"gossipsub_mesh_peers_published_total",help:"Total mesh peers that we publish a msg to",labelNames:["topic"]}),fanoutPeersPublishedTotal:n.gauge({name:"gossipsub_fanout_peers_published_total",help:"Total fanout peers that we publish a msg to",labelNames:["topic"]}),msgPublishBytes:n.gauge({name:"gossipsub_msg_publish_bytes_total",help:"Total count of msg publish data.length bytes",labelNames:["topic"]}),msgPublishTime:n.histogram({name:"gossipsub_msg_publish_seconds",help:"Total time in seconds to publish a message",buckets:[.001,.002,.005,.01,.1,.5,1],labelNames:["topic"]}),msgForwardCount:n.gauge({name:"gossipsub_msg_forward_count_total",help:"Total count of msg forwarded by topic",labelNames:["topic"]}),msgForwardPeers:n.gauge({name:"gossipsub_msg_forward_peers_total",help:"Total count of peers that we forward a msg to",labelNames:["topic"]}),msgReceivedPreValidation:n.gauge({name:"gossipsub_msg_received_prevalidation_total",help:"Total count of recv msgs before any validation",labelNames:["topic"]}),msgReceivedError:n.gauge({name:"gossipsub_msg_received_error_total",help:"Total count of recv msgs error",labelNames:["topic"]}),prevalidationInvalidTotal:n.gauge({name:"gossipsub_pre_validation_invalid_total",help:"Total count of invalid messages received",labelNames:["topic"]}),prevalidationValidTotal:n.gauge({name:"gossipsub_pre_validation_valid_total",help:"Total count of valid messages received",labelNames:["topic"]}),prevalidationDuplicateTotal:n.gauge({name:"gossipsub_pre_validation_duplicate_total",help:"Total count of duplicate messages received",labelNames:["topic"]}),prevalidationUnknownTotal:n.gauge({name:"gossipsub_pre_validation_unknown_status_total",help:"Total count of unknown_status messages received",labelNames:["topic"]}),msgReceivedInvalid:n.gauge({name:"gossipsub_msg_received_invalid_total",help:"Tracks specific reason of invalid",labelNames:["error"]}),msgReceivedInvalidByTopic:n.gauge({name:"gossipsub_msg_received_invalid_by_topic_total",help:"Tracks specific invalid message by topic",labelNames:["topic"]}),duplicateMsgDeliveryDelay:n.histogram({name:"gossisub_duplicate_msg_delivery_delay_seconds",help:"Time since the 1st duplicated message validated",labelNames:["topic"],buckets:[.25*_.maxMeshMessageDeliveriesWindowSec,.5*_.maxMeshMessageDeliveriesWindowSec,Number(_.maxMeshMessageDeliveriesWindowSec),2*_.maxMeshMessageDeliveriesWindowSec,4*_.maxMeshMessageDeliveriesWindowSec]}),duplicateMsgLateDelivery:n.gauge({name:"gossisub_duplicate_msg_late_delivery_total",help:"Total count of late duplicate message delivery by topic, which triggers P3 penalty",labelNames:["topic"]}),duplicateMsgIgnored:n.gauge({name:"gossisub_ignored_published_duplicate_msgs_total",help:"Total count of published duplicate message ignored by topic",labelNames:["topic"]}),scoreFnCalls:n.gauge({name:"gossipsub_score_fn_calls_total",help:"Total times score() is called"}),scoreFnRuns:n.gauge({name:"gossipsub_score_fn_runs_total",help:"Total times score() call actually computed computeScore(), no cache"}),scoreCachedDelta:n.histogram({name:"gossipsub_score_cache_delta",help:"Delta of score between cached values that expired",buckets:[10,100,1e3]}),peersByScoreThreshold:n.gauge({name:"gossipsub_peers_by_score_threshold_count",help:"Current count of peers by score threshold",labelNames:["threshold"]}),score:n.avgMinMax({name:"gossipsub_score",help:"Avg min max of gossip scores"}),scoreWeights:n.avgMinMax({name:"gossipsub_score_weights",help:"Separate score weights",labelNames:["topic","p"]}),scorePerMesh:n.avgMinMax({name:"gossipsub_score_per_mesh",help:"Histogram of the scores for each mesh topic",labelNames:["topic"]}),scoringPenalties:n.gauge({name:"gossipsub_scoring_penalties_total",help:"A counter of the kind of penalties being applied to peers",labelNames:["penalty"]}),behaviourPenalty:n.histogram({name:"gossipsub_peer_stat_behaviour_penalty",help:"Current peer stat behaviour_penalty at each scrape",buckets:[.25*_.behaviourPenaltyThreshold,.5*_.behaviourPenaltyThreshold,Number(_.behaviourPenaltyThreshold),2*_.behaviourPenaltyThreshold,4*_.behaviourPenaltyThreshold]}),ihaveRcvIgnored:n.gauge({name:"gossipsub_ihave_rcv_ignored_total",help:"Total received IHAVE messages that we ignore for some reason",labelNames:["reason"]}),ihaveRcvMsgids:n.gauge({name:"gossipsub_ihave_rcv_msgids_total",help:"Total received IHAVE messages by topic",labelNames:["topic"]}),ihaveRcvNotSeenMsgids:n.gauge({name:"gossipsub_ihave_rcv_not_seen_msgids_total",help:"Total messages per topic we do not have, not actual requests",labelNames:["topic"]}),iwantRcvMsgids:n.gauge({name:"gossipsub_iwant_rcv_msgids_total",help:"Total received IWANT messages by topic",labelNames:["topic"]}),iwantRcvDonthaveMsgids:n.gauge({name:"gossipsub_iwant_rcv_dont_have_msgids_total",help:"Total requested messageIDs that we do not have"}),iwantPromiseStarted:n.gauge({name:"gossipsub_iwant_promise_sent_total",help:"Total count of started IWANT promises"}),iwantPromiseResolved:n.gauge({name:"gossipsub_iwant_promise_resolved_total",help:"Total count of resolved IWANT promises"}),iwantPromiseResolvedFromDuplicate:n.gauge({name:"gossipsub_iwant_promise_resolved_from_duplicate_total",help:"Total count of resolved IWANT promises from duplicate messages"}),iwantPromiseResolvedPeers:n.gauge({name:"gossipsub_iwant_promise_resolved_peers",help:"Total count of peers we have asked IWANT promises that are resolved"}),iwantPromiseBroken:n.gauge({name:"gossipsub_iwant_promise_broken",help:"Total count of broken IWANT promises"}),iwantMessagePruned:n.gauge({name:"gossipsub_iwant_message_pruned",help:"Total count of pruned IWANT messages"}),iwantPromiseDeliveryTime:n.histogram({name:"gossipsub_iwant_promise_delivery_seconds",help:"Histogram of delivery time of resolved IWANT promises",buckets:[.5*_.gossipPromiseExpireSec,Number(_.gossipPromiseExpireSec),2*_.gossipPromiseExpireSec,4*_.gossipPromiseExpireSec]}),iwantPromiseUntracked:n.gauge({name:"gossip_iwant_promise_untracked",help:"Total count of untracked IWANT promise"}),connectedPeersBackoffSec:n.histogram({name:"gossipsub_connected_peers_backoff_seconds",help:"Backoff time in seconds",buckets:[1,2,4,10,20,60,120]}),cacheSize:n.gauge({name:"gossipsub_cache_size",help:"Unbounded cache sizes",labelNames:["cache"]}),mcacheSize:n.gauge({name:"gossipsub_mcache_size",help:"Current mcache msg count"}),mcacheNotValidatedCount:n.gauge({name:"gossipsub_mcache_not_validated_count",help:"Current mcache msg count not validated"}),fastMsgIdCacheCollision:n.gauge({name:"gossipsub_fastmsgid_cache_collision_total",help:"Total count of key collisions on fastmsgid cache put"}),newConnectionCount:n.gauge({name:"gossipsub_new_connection_total",help:"Total new connection by status",labelNames:["status"]}),topicStrToLabel:r,toTopic(E){return this.topicStrToLabel.get(E)??E},onJoin(E){this.topicSubscriptionStatus.set({topicStr:E},1),this.meshPeerCounts.set({topicStr:E},0)},onLeave(E){this.topicSubscriptionStatus.set({topicStr:E},0),this.meshPeerCounts.set({topicStr:E},0)},onAddToMesh(E,S,C){const A=this.toTopic(E);switch(S){case InclusionReason.Fanout:this.meshPeerInclusionEventsFanout.inc({topic:A},C);break;case InclusionReason.Random:this.meshPeerInclusionEventsRandom.inc({topic:A},C);break;case InclusionReason.Subscribed:this.meshPeerInclusionEventsSubscribed.inc({topic:A},C);break;case InclusionReason.Outbound:this.meshPeerInclusionEventsOutbound.inc({topic:A},C);break;case InclusionReason.NotEnough:this.meshPeerInclusionEventsNotEnough.inc({topic:A},C);break;case InclusionReason.Opportunistic:this.meshPeerInclusionEventsOpportunistic.inc({topic:A},C);break;default:this.meshPeerInclusionEventsUnknown.inc({topic:A},C);break}},onRemoveFromMesh(E,S,C){const A=this.toTopic(E);switch(S){case ChurnReason.Dc:this.meshPeerChurnEventsDisconnected.inc({topic:A},C);break;case ChurnReason.BadScore:this.meshPeerChurnEventsBadScore.inc({topic:A},C);break;case ChurnReason.Prune:this.meshPeerChurnEventsPrune.inc({topic:A},C);break;case ChurnReason.Excess:this.meshPeerChurnEventsExcess.inc({topic:A},C);break;default:this.meshPeerChurnEventsUnknown.inc({topic:A},C);break}},onReportValidation(E,S,C){if(this.asyncValidationMcacheHit.inc({hit:E!=null?"hit":"miss"}),E!=null){const A=this.toTopic(E.message.topic);switch(S){case TopicValidatorResult.Accept:this.acceptedMessagesTotal.inc({topic:A});break;case TopicValidatorResult.Ignore:this.ignoredMessagesTotal.inc({topic:A});break;case TopicValidatorResult.Reject:this.rejectedMessagesTotal.inc({topic:A});break;default:this.unknownValidationResultsTotal.inc({topic:A});break}}C!=null?this.asyncValidationDelayFromFirstSeenSec.observe((Date.now()-C)/1e3):this.asyncValidationUnknownFirstSeen.inc()},onScorePenalty(E){this.scoringPenalties.inc({penalty:E},1)},onIhaveRcv(E,S,C){const A=this.toTopic(E);this.ihaveRcvMsgids.inc({topic:A},S),this.ihaveRcvNotSeenMsgids.inc({topic:A},C)},onIwantRcv(E,S){for(const[C,A]of E){const I=this.toTopic(C);this.iwantRcvMsgids.inc({topic:I},A)}this.iwantRcvDonthaveMsgids.inc(S)},onForwardMsg(E,S){const C=this.toTopic(E);this.msgForwardCount.inc({topic:C},1),this.msgForwardPeers.inc({topic:C},S)},onPublishMsg(E,S,C,A,I){const B=this.toTopic(E);this.msgPublishCount.inc({topic:B},1),this.msgPublishBytes.inc({topic:B},C*A),this.msgPublishPeersByTopic.inc({topic:B},C),this.directPeersPublishedTotal.inc({topic:B},S.direct),this.floodsubPeersPublishedTotal.inc({topic:B},S.floodsub),this.meshPeersPublishedTotal.inc({topic:B},S.mesh),this.fanoutPeersPublishedTotal.inc({topic:B},S.fanout),this.msgPublishTime.observe({topic:B},I/1e3)},onMsgRecvPreValidation(E){const S=this.toTopic(E);this.msgReceivedPreValidation.inc({topic:S},1)},onMsgRecvError(E){const S=this.toTopic(E);this.msgReceivedError.inc({topic:S},1)},onPrevalidationResult(E,S){const C=this.toTopic(E);switch(S){case MessageStatus.duplicate:this.prevalidationDuplicateTotal.inc({topic:C});break;case MessageStatus.invalid:this.prevalidationInvalidTotal.inc({topic:C});break;case MessageStatus.valid:this.prevalidationValidTotal.inc({topic:C});break;default:this.prevalidationUnknownTotal.inc({topic:C});break}},onMsgRecvInvalid(E,S){const C=this.toTopic(E),A=S.reason===RejectReason.Error?S.error:S.reason;this.msgReceivedInvalid.inc({error:A},1),this.msgReceivedInvalidByTopic.inc({topic:C},1)},onDuplicateMsgDelivery(E,S,C){const A=this.toTopic(E);this.duplicateMsgDeliveryDelay.observe({topic:A},S/1e3),C&&this.duplicateMsgLateDelivery.inc({topic:A},1)},onPublishDuplicateMsg(E){const S=this.toTopic(E);this.duplicateMsgIgnored.inc({topic:S},1)},onPeerReadStreamError(){this.peerReadStreamError.inc(1)},onRpcRecvError(){this.rpcRecvError.inc(1)},onRpcDataError(){this.rpcDataError.inc(1)},onRpcRecv(E,S){this.rpcRecvBytes.inc(S),this.rpcRecvCount.inc(1),E.subscriptions!=null&&this.rpcRecvSubscription.inc(E.subscriptions.length),E.messages!=null&&this.rpcRecvMessage.inc(E.messages.length),E.control!=null&&(this.rpcRecvControl.inc(1),E.control.ihave!=null&&this.rpcRecvIHave.inc(E.control.ihave.length),E.control.iwant!=null&&this.rpcRecvIWant.inc(E.control.iwant.length),E.control.graft!=null&&this.rpcRecvGraft.inc(E.control.graft.length),E.control.prune!=null&&this.rpcRecvPrune.inc(E.control.prune.length))},onRpcSent(E,S){if(this.rpcSentBytes.inc(S),this.rpcSentCount.inc(1),E.subscriptions!=null&&this.rpcSentSubscription.inc(E.subscriptions.length),E.messages!=null&&this.rpcSentMessage.inc(E.messages.length),E.control!=null){const C=E.control.ihave?.length??0,A=E.control.iwant?.length??0,I=E.control.graft?.length??0,B=E.control.prune?.length??0;C>0&&this.rpcSentIHave.inc(C),A>0&&this.rpcSentIWant.inc(A),I>0&&this.rpcSentGraft.inc(I),B>0&&this.rpcSentPrune.inc(B),(C>0||A>0||I>0||B>0)&&this.rpcSentControl.inc(1)}},registerScores(E,S){let C=0,A=0,I=0,B=0;for(const O of E)O>=S.graylistThreshold&&C++,O>=S.publishThreshold&&A++,O>=S.gossipThreshold&&I++,O>=0&&B++;this.peersByScoreThreshold.set({threshold:ScoreThreshold.graylist},C),this.peersByScoreThreshold.set({threshold:ScoreThreshold.publish},A),this.peersByScoreThreshold.set({threshold:ScoreThreshold.gossip},I),this.peersByScoreThreshold.set({threshold:ScoreThreshold.mesh},B),this.score.set(E)},registerScoreWeights(E){for(const[S,C]of E.byTopic)this.scoreWeights.set({topic:S,p:"p1"},C.p1w),this.scoreWeights.set({topic:S,p:"p2"},C.p2w),this.scoreWeights.set({topic:S,p:"p3"},C.p3w),this.scoreWeights.set({topic:S,p:"p3b"},C.p3bw),this.scoreWeights.set({topic:S,p:"p4"},C.p4w);this.scoreWeights.set({p:"p5"},E.p5w),this.scoreWeights.set({p:"p6"},E.p6w),this.scoreWeights.set({p:"p7"},E.p7w)},registerScorePerMesh(E,S){const C=new Map;E.forEach((A,I)=>{const B=this.topicStrToLabel.get(I)??"unknown";let O=C.get(B);O==null&&(O=new Set,C.set(B,O)),A.forEach(N=>O?.add(N))});for(const[A,I]of C){const B=[];I.forEach(O=>{B.push(S.get(O)??0)}),this.scorePerMesh.set({topic:A},B)}}}}const ERR_INVALID_PEER_SCORE_PARAMS="ERR_INVALID_PEER_SCORE_PARAMS",defaultPeerScoreParams={topics:{},topicScoreCap:10,appSpecificScore:()=>0,appSpecificWeight:10,IPColocationFactorWeight:-5,IPColocationFactorThreshold:10,IPColocationFactorWhitelist:new Set,behaviourPenaltyWeight:-10,behaviourPenaltyThreshold:0,behaviourPenaltyDecay:.2,decayInterval:1e3,decayToZero:.1,retainScore:3600*1e3},defaultTopicScoreParams={topicWeight:.5,timeInMeshWeight:1,timeInMeshQuantum:1,timeInMeshCap:3600,firstMessageDeliveriesWeight:1,firstMessageDeliveriesDecay:.5,firstMessageDeliveriesCap:2e3,meshMessageDeliveriesWeight:-1,meshMessageDeliveriesDecay:.5,meshMessageDeliveriesCap:100,meshMessageDeliveriesThreshold:20,meshMessageDeliveriesWindow:10,meshMessageDeliveriesActivation:5e3,meshFailurePenaltyWeight:-1,meshFailurePenaltyDecay:.5,invalidMessageDeliveriesWeight:-1,invalidMessageDeliveriesDecay:.3};function createPeerScoreParams(n={}){return{...defaultPeerScoreParams,...n,topics:n.topics!=null?Object.entries(n.topics).reduce((r,[_,E])=>(r[_]=createTopicScoreParams(E),r),{}):{}}}function createTopicScoreParams(n={}){return{...defaultTopicScoreParams,...n}}function validatePeerScoreParams(n){for(const[r,_]of Object.entries(n.topics))try{validateTopicScoreParams(_)}catch(E){throw new CodeError$4(`invalid score parameters for topic ${r}: ${E.message}`,ERR_INVALID_PEER_SCORE_PARAMS)}if(n.topicScoreCap<0)throw new CodeError$4("invalid topic score cap; must be positive (or 0 for no cap)",ERR_INVALID_PEER_SCORE_PARAMS);if(n.appSpecificScore===null||n.appSpecificScore===void 0)throw new CodeError$4("missing application specific score function",ERR_INVALID_PEER_SCORE_PARAMS);if(n.IPColocationFactorWeight>0)throw new CodeError$4("invalid IPColocationFactorWeight; must be negative (or 0 to disable)",ERR_INVALID_PEER_SCORE_PARAMS);if(n.IPColocationFactorWeight!==0&&n.IPColocationFactorThreshold<1)throw new CodeError$4("invalid IPColocationFactorThreshold; must be at least 1",ERR_INVALID_PEER_SCORE_PARAMS);if(n.behaviourPenaltyWeight>0)throw new CodeError$4("invalid BehaviourPenaltyWeight; must be negative (or 0 to disable)",ERR_INVALID_PEER_SCORE_PARAMS);if(n.behaviourPenaltyWeight!==0&&(n.behaviourPenaltyDecay<=0||n.behaviourPenaltyDecay>=1))throw new CodeError$4("invalid BehaviourPenaltyDecay; must be between 0 and 1",ERR_INVALID_PEER_SCORE_PARAMS);if(n.decayInterval<1e3)throw new CodeError$4("invalid DecayInterval; must be at least 1s",ERR_INVALID_PEER_SCORE_PARAMS);if(n.decayToZero<=0||n.decayToZero>=1)throw new CodeError$4("invalid DecayToZero; must be between 0 and 1",ERR_INVALID_PEER_SCORE_PARAMS)}function validateTopicScoreParams(n){if(n.topicWeight<0)throw new CodeError$4("invalid topic weight; must be >= 0",ERR_INVALID_PEER_SCORE_PARAMS);if(n.timeInMeshQuantum===0)throw new CodeError$4("invalid TimeInMeshQuantum; must be non zero",ERR_INVALID_PEER_SCORE_PARAMS);if(n.timeInMeshWeight<0)throw new CodeError$4("invalid TimeInMeshWeight; must be positive (or 0 to disable)",ERR_INVALID_PEER_SCORE_PARAMS);if(n.timeInMeshWeight!==0&&n.timeInMeshQuantum<=0)throw new CodeError$4("invalid TimeInMeshQuantum; must be positive",ERR_INVALID_PEER_SCORE_PARAMS);if(n.timeInMeshWeight!==0&&n.timeInMeshCap<=0)throw new CodeError$4("invalid TimeInMeshCap; must be positive",ERR_INVALID_PEER_SCORE_PARAMS);if(n.firstMessageDeliveriesWeight<0)throw new CodeError$4("invallid FirstMessageDeliveriesWeight; must be positive (or 0 to disable)",ERR_INVALID_PEER_SCORE_PARAMS);if(n.firstMessageDeliveriesWeight!==0&&(n.firstMessageDeliveriesDecay<=0||n.firstMessageDeliveriesDecay>=1))throw new CodeError$4("invalid FirstMessageDeliveriesDecay; must be between 0 and 1",ERR_INVALID_PEER_SCORE_PARAMS);if(n.firstMessageDeliveriesWeight!==0&&n.firstMessageDeliveriesCap<=0)throw new CodeError$4("invalid FirstMessageDeliveriesCap; must be positive",ERR_INVALID_PEER_SCORE_PARAMS);if(n.meshMessageDeliveriesWeight>0)throw new CodeError$4("invalid MeshMessageDeliveriesWeight; must be negative (or 0 to disable)",ERR_INVALID_PEER_SCORE_PARAMS);if(n.meshMessageDeliveriesWeight!==0&&(n.meshMessageDeliveriesDecay<=0||n.meshMessageDeliveriesDecay>=1))throw new CodeError$4("invalid MeshMessageDeliveriesDecay; must be between 0 and 1",ERR_INVALID_PEER_SCORE_PARAMS);if(n.meshMessageDeliveriesWeight!==0&&n.meshMessageDeliveriesCap<=0)throw new CodeError$4("invalid MeshMessageDeliveriesCap; must be positive",ERR_INVALID_PEER_SCORE_PARAMS);if(n.meshMessageDeliveriesWeight!==0&&n.meshMessageDeliveriesThreshold<=0)throw new CodeError$4("invalid MeshMessageDeliveriesThreshold; must be positive",ERR_INVALID_PEER_SCORE_PARAMS);if(n.meshMessageDeliveriesWindow<0)throw new CodeError$4("invalid MeshMessageDeliveriesWindow; must be non-negative",ERR_INVALID_PEER_SCORE_PARAMS);if(n.meshMessageDeliveriesWeight!==0&&n.meshMessageDeliveriesActivation<1e3)throw new CodeError$4("invalid MeshMessageDeliveriesActivation; must be at least 1s",ERR_INVALID_PEER_SCORE_PARAMS);if(n.meshFailurePenaltyWeight>0)throw new CodeError$4("invalid MeshFailurePenaltyWeight; must be negative (or 0 to disable)",ERR_INVALID_PEER_SCORE_PARAMS);if(n.meshFailurePenaltyWeight!==0&&(n.meshFailurePenaltyDecay<=0||n.meshFailurePenaltyDecay>=1))throw new CodeError$4("invalid MeshFailurePenaltyDecay; must be between 0 and 1",ERR_INVALID_PEER_SCORE_PARAMS);if(n.invalidMessageDeliveriesWeight>0)throw new CodeError$4("invalid InvalidMessageDeliveriesWeight; must be negative (or 0 to disable)",ERR_INVALID_PEER_SCORE_PARAMS);if(n.invalidMessageDeliveriesDecay<=0||n.invalidMessageDeliveriesDecay>=1)throw new CodeError$4("invalid InvalidMessageDeliveriesDecay; must be between 0 and 1",ERR_INVALID_PEER_SCORE_PARAMS)}const defaultPeerScoreThresholds={gossipThreshold:-10,publishThreshold:-50,graylistThreshold:-80,acceptPXThreshold:10,opportunisticGraftThreshold:20};function createPeerScoreThresholds(n={}){return{...defaultPeerScoreThresholds,...n}}function removeItemsFromSet(n,r,_=()=>!0){const E=new Set;if(r<=0)return E;for(const S of n){if(E.size>=r)break;_(S)&&(E.add(S),n.delete(S))}return E}function removeFirstNItemsFromSet(n,r){return removeItemsFromSet(n,r,()=>!0)}class MapDef extends Map{getDefault;constructor(r){super(),this.getDefault=r}getOrDefault(r){let _=super.get(r);return _===void 0&&(_=this.getDefault(),this.set(r,_)),_}}function computeScore(n,r,_,E){let S=0;Object.entries(r.topics).forEach(([A,I])=>{const B=_.topics[A];if(B===void 0)return;let O=0;if(I.inMesh){let z=I.meshTime/B.timeInMeshQuantum;z>B.timeInMeshCap&&(z=B.timeInMeshCap),O+=z*B.timeInMeshWeight}let N=I.firstMessageDeliveries;if(N>B.firstMessageDeliveriesCap&&(N=B.firstMessageDeliveriesCap),O+=N*B.firstMessageDeliveriesWeight,I.meshMessageDeliveriesActive&&I.meshMessageDeliveries<B.meshMessageDeliveriesThreshold){const z=B.meshMessageDeliveriesThreshold-I.meshMessageDeliveries,Z=z*z;O+=Z*B.meshMessageDeliveriesWeight}const U=I.meshFailurePenalty;O+=U*B.meshFailurePenaltyWeight;const j=I.invalidMessageDeliveries*I.invalidMessageDeliveries;O+=j*B.invalidMessageDeliveriesWeight,S+=O*B.topicWeight}),_.topicScoreCap>0&&S>_.topicScoreCap&&(S=_.topicScoreCap);const C=_.appSpecificScore(n);if(S+=C*_.appSpecificWeight,r.knownIPs.forEach(A=>{if(_.IPColocationFactorWhitelist.has(A))return;const I=E.get(A),B=I!=null?I.size:0;if(B>_.IPColocationFactorThreshold){const O=B-_.IPColocationFactorThreshold,N=O*O;S+=N*_.IPColocationFactorWeight}}),r.behaviourPenalty>_.behaviourPenaltyThreshold){const A=r.behaviourPenalty-_.behaviourPenaltyThreshold,I=A*A;S+=I*_.behaviourPenaltyWeight}return S}function Denque(n,_){var _=_||{};this._capacity=_.capacity,this._head=0,this._tail=0,Array.isArray(n)?this._fromArray(n):(this._capacityMask=3,this._list=new Array(4))}Denque.prototype.peekAt=function n(r){var _=r;if(_===(_|0)){var E=this.size();if(!(_>=E||_<-E))return _<0&&(_+=E),_=this._head+_&this._capacityMask,this._list[_]}};Denque.prototype.get=function n(r){return this.peekAt(r)};Denque.prototype.peek=function n(){if(this._head!==this._tail)return this._list[this._head]};Denque.prototype.peekFront=function n(){return this.peek()};Denque.prototype.peekBack=function n(){return this.peekAt(-1)};Object.defineProperty(Denque.prototype,"length",{get:function n(){return this.size()}});Denque.prototype.size=function n(){return this._head===this._tail?0:this._head<this._tail?this._tail-this._head:this._capacityMask+1-(this._head-this._tail)};Denque.prototype.unshift=function n(r){if(arguments.length===0)return this.size();var _=this._list.length;return this._head=this._head-1+_&this._capacityMask,this._list[this._head]=r,this._tail===this._head&&this._growArray(),this._capacity&&this.size()>this._capacity&&this.pop(),this._head<this._tail?this._tail-this._head:this._capacityMask+1-(this._head-this._tail)};Denque.prototype.shift=function n(){var r=this._head;if(r!==this._tail){var _=this._list[r];return this._list[r]=void 0,this._head=r+1&this._capacityMask,r<2&&this._tail>1e4&&this._tail<=this._list.length>>>2&&this._shrinkArray(),_}};Denque.prototype.push=function n(r){if(arguments.length===0)return this.size();var _=this._tail;return this._list[_]=r,this._tail=_+1&this._capacityMask,this._tail===this._head&&this._growArray(),this._capacity&&this.size()>this._capacity&&this.shift(),this._head<this._tail?this._tail-this._head:this._capacityMask+1-(this._head-this._tail)};Denque.prototype.pop=function n(){var r=this._tail;if(r!==this._head){var _=this._list.length;this._tail=r-1+_&this._capacityMask;var E=this._list[this._tail];return this._list[this._tail]=void 0,this._head<2&&r>1e4&&r<=_>>>2&&this._shrinkArray(),E}};Denque.prototype.removeOne=function n(r){var _=r;if(_===(_|0)&&this._head!==this._tail){var E=this.size(),S=this._list.length;if(!(_>=E||_<-E)){_<0&&(_+=E),_=this._head+_&this._capacityMask;var C=this._list[_],A;if(r<E/2){for(A=r;A>0;A--)this._list[_]=this._list[_=_-1+S&this._capacityMask];this._list[_]=void 0,this._head=this._head+1+S&this._capacityMask}else{for(A=E-1-r;A>0;A--)this._list[_]=this._list[_=_+1+S&this._capacityMask];this._list[_]=void 0,this._tail=this._tail-1+S&this._capacityMask}return C}}};Denque.prototype.remove=function n(r,_){var E=r,S,C=_;if(E===(E|0)&&this._head!==this._tail){var A=this.size(),I=this._list.length;if(!(E>=A||E<-A||_<1)){if(E<0&&(E+=A),_===1||!_)return S=new Array(1),S[0]=this.removeOne(E),S;if(E===0&&E+_>=A)return S=this.toArray(),this.clear(),S;E+_>A&&(_=A-E);var B;for(S=new Array(_),B=0;B<_;B++)S[B]=this._list[this._head+E+B&this._capacityMask];if(E=this._head+E&this._capacityMask,r+_===A){for(this._tail=this._tail-_+I&this._capacityMask,B=_;B>0;B--)this._list[E=E+1+I&this._capacityMask]=void 0;return S}if(r===0){for(this._head=this._head+_+I&this._capacityMask,B=_-1;B>0;B--)this._list[E=E+1+I&this._capacityMask]=void 0;return S}if(E<A/2){for(this._head=this._head+r+_+I&this._capacityMask,B=r;B>0;B--)this.unshift(this._list[E=E-1+I&this._capacityMask]);for(E=this._head-1+I&this._capacityMask;C>0;)this._list[E=E-1+I&this._capacityMask]=void 0,C--;r<0&&(this._tail=E)}else{for(this._tail=E,E=E+_+I&this._capacityMask,B=A-(_+r);B>0;B--)this.push(this._list[E++]);for(E=this._tail;C>0;)this._list[E=E+1+I&this._capacityMask]=void 0,C--}return this._head<2&&this._tail>1e4&&this._tail<=I>>>2&&this._shrinkArray(),S}}};Denque.prototype.splice=function n(r,_){var E=r;if(E===(E|0)){var S=this.size();if(E<0&&(E+=S),!(E>S))if(arguments.length>2){var C,A,I,B=arguments.length,O=this._list.length,N=2;if(!S||E<S/2){for(A=new Array(E),C=0;C<E;C++)A[C]=this._list[this._head+C&this._capacityMask];for(_===0?(I=[],E>0&&(this._head=this._head+E+O&this._capacityMask)):(I=this.remove(E,_),this._head=this._head+E+O&this._capacityMask);B>N;)this.unshift(arguments[--B]);for(C=E;C>0;C--)this.unshift(A[C-1])}else{A=new Array(S-(E+_));var U=A.length;for(C=0;C<U;C++)A[C]=this._list[this._head+E+_+C&this._capacityMask];for(_===0?(I=[],E!=S&&(this._tail=this._head+E+O&this._capacityMask)):(I=this.remove(E,_),this._tail=this._tail-U+O&this._capacityMask);N<B;)this.push(arguments[N++]);for(C=0;C<U;C++)this.push(A[C])}return I}else return this.remove(E,_)}};Denque.prototype.clear=function n(){this._list=new Array(this._list.length),this._head=0,this._tail=0};Denque.prototype.isEmpty=function n(){return this._head===this._tail};Denque.prototype.toArray=function n(){return this._copyArray(!1)};Denque.prototype._fromArray=function n(r){var _=r.length,E=this._nextPowerOf2(_);this._list=new Array(E),this._capacityMask=E-1,this._tail=_;for(var S=0;S<_;S++)this._list[S]=r[S]};Denque.prototype._copyArray=function n(r,_){var E=this._list,S=E.length,C=this.length;if(_=_|C,_==C&&this._head<this._tail)return this._list.slice(this._head,this._tail);var A=new Array(_),I=0,B;if(r||this._head>this._tail){for(B=this._head;B<S;B++)A[I++]=E[B];for(B=0;B<this._tail;B++)A[I++]=E[B]}else for(B=this._head;B<this._tail;B++)A[I++]=E[B];return A};Denque.prototype._growArray=function n(){if(this._head!=0){var r=this._copyArray(!0,this._list.length<<1);this._tail=this._list.length,this._head=0,this._list=r}else this._tail=this._list.length,this._list.length<<=1;this._capacityMask=this._capacityMask<<1|1};Denque.prototype._shrinkArray=function n(){this._list.length>>>=1,this._capacityMask>>>=1};Denque.prototype._nextPowerOf2=function n(r){var _=Math.log(r)/Math.log(2),E=1<<_+1;return Math.max(E,4)};var denque=Denque;const Denque$1=getDefaultExportFromCjs(denque);var DeliveryRecordStatus;(function(n){n[n.unknown=0]="unknown",n[n.valid=1]="valid",n[n.invalid=2]="invalid",n[n.ignored=3]="ignored"})(DeliveryRecordStatus||(DeliveryRecordStatus={}));class MessageDeliveries{records;queue;constructor(){this.records=new Map,this.queue=new Denque$1}getRecord(r){return this.records.get(r)}ensureRecord(r){let _=this.records.get(r);if(_!=null)return _;_={status:DeliveryRecordStatus.unknown,firstSeenTsMs:Date.now(),validated:0,peers:new Set},this.records.set(r,_);const E={msgId:r,expire:Date.now()+TimeCacheDuration};return this.queue.push(E),_}gc(){const r=Date.now();let _=this.queue.peekFront();for(;_!=null&&_.expire<r;)this.records.delete(_.msgId),this.queue.shift(),_=this.queue.peekFront()}clear(){this.records.clear(),this.queue.clear()}}class PeerScore{params;metrics;peerStats=new Map;peerIPs=new MapDef(()=>new Set);scoreCache=new Map;deliveryRecords=new MessageDeliveries;_backgroundInterval;scoreCacheValidityMs;computeScore;log;constructor(r,_,E,S){this.params=r,this.metrics=_,validatePeerScoreParams(r),this.scoreCacheValidityMs=S.scoreCacheValidityMs,this.computeScore=S.computeScore??computeScore,this.log=E.forComponent("libp2p:gossipsub:score")}get size(){return this.peerStats.size}start(){if(this._backgroundInterval!=null){this.log("Peer score already running");return}this._backgroundInterval=setInterval(()=>{this.background()},this.params.decayInterval),this.log("started")}stop(){if(this._backgroundInterval==null){this.log("Peer score already stopped");return}clearInterval(this._backgroundInterval),delete this._backgroundInterval,this.peerIPs.clear(),this.peerStats.clear(),this.deliveryRecords.clear(),this.log("stopped")}background(){this.refreshScores(),this.deliveryRecords.gc()}dumpPeerScoreStats(){return Object.fromEntries(Array.from(this.peerStats.entries()).map(([r,_])=>[r,_]))}messageFirstSeenTimestampMs(r){const _=this.deliveryRecords.getRecord(r);return _!=null?_.firstSeenTsMs:null}refreshScores(){const r=Date.now(),_=this.params.decayToZero;this.peerStats.forEach((E,S)=>{if(!E.connected){r>E.expire&&(this.removeIPsForPeer(S,E.knownIPs),this.peerStats.delete(S),this.scoreCache.delete(S));return}Object.entries(E.topics).forEach(([C,A])=>{const I=this.params.topics[C];I!==void 0&&(A.firstMessageDeliveries*=I.firstMessageDeliveriesDecay,A.firstMessageDeliveries<_&&(A.firstMessageDeliveries=0),A.meshMessageDeliveries*=I.meshMessageDeliveriesDecay,A.meshMessageDeliveries<_&&(A.meshMessageDeliveries=0),A.meshFailurePenalty*=I.meshFailurePenaltyDecay,A.meshFailurePenalty<_&&(A.meshFailurePenalty=0),A.invalidMessageDeliveries*=I.invalidMessageDeliveriesDecay,A.invalidMessageDeliveries<_&&(A.invalidMessageDeliveries=0),A.inMesh&&(A.meshTime=r-A.graftTime,A.meshTime>I.meshMessageDeliveriesActivation&&(A.meshMessageDeliveriesActive=!0)))}),E.behaviourPenalty*=this.params.behaviourPenaltyDecay,E.behaviourPenalty<_&&(E.behaviourPenalty=0)})}score(r){this.metrics?.scoreFnCalls.inc();const _=this.peerStats.get(r);if(_==null)return 0;const E=Date.now(),S=this.scoreCache.get(r);if(S!=null&&S.cacheUntil>E)return S.score;this.metrics?.scoreFnRuns.inc();const C=this.computeScore(r,_,this.params,this.peerIPs),A=E+this.scoreCacheValidityMs;return S!=null?(this.metrics?.scoreCachedDelta.observe(Math.abs(C-S.score)),S.score=C,S.cacheUntil=A):this.scoreCache.set(r,{score:C,cacheUntil:A}),C}addPenalty(r,_,E){const S=this.peerStats.get(r);S!=null&&(S.behaviourPenalty+=_,this.metrics?.onScorePenalty(E))}addPeer(r){const _={connected:!0,expire:0,topics:{},knownIPs:new Set,behaviourPenalty:0};this.peerStats.set(r,_)}addIP(r,_){const E=this.peerStats.get(r);E?.knownIPs.add(_),this.peerIPs.getOrDefault(_).add(r)}removeIP(r,_){const E=this.peerStats.get(r);E?.knownIPs.delete(_);const S=this.peerIPs.get(_);S!=null&&(S.delete(r),S.size===0&&this.peerIPs.delete(_))}removePeer(r){const _=this.peerStats.get(r);if(_!=null){if(this.score(r)>0){this.removeIPsForPeer(r,_.knownIPs),this.peerStats.delete(r);return}Object.entries(_.topics).forEach(([E,S])=>{S.firstMessageDeliveries=0;const C=this.params.topics[E].meshMessageDeliveriesThreshold;if(S.inMesh&&S.meshMessageDeliveriesActive&&S.meshMessageDeliveries<C){const A=C-S.meshMessageDeliveries;S.meshFailurePenalty+=A*A}S.inMesh=!1,S.meshMessageDeliveriesActive=!1}),_.connected=!1,_.expire=Date.now()+this.params.retainScore}}graft(r,_){const E=this.peerStats.get(r);if(E!=null){const S=this.getPtopicStats(E,_);S!=null&&(S.inMesh=!0,S.graftTime=Date.now(),S.meshTime=0,S.meshMessageDeliveriesActive=!1)}}prune(r,_){const E=this.peerStats.get(r);if(E!=null){const S=this.getPtopicStats(E,_);if(S!=null){const C=this.params.topics[_].meshMessageDeliveriesThreshold;if(S.meshMessageDeliveriesActive&&S.meshMessageDeliveries<C){const A=C-S.meshMessageDeliveries;S.meshFailurePenalty+=A*A}S.meshMessageDeliveriesActive=!1,S.inMesh=!1}}}validateMessage(r){this.deliveryRecords.ensureRecord(r)}deliverMessage(r,_,E){this.markFirstMessageDelivery(r,E);const S=this.deliveryRecords.ensureRecord(_),C=Date.now();if(S.status!==DeliveryRecordStatus.unknown){this.log("unexpected delivery: message from %s was first seen %s ago and has delivery status %s",r,C-S.firstSeenTsMs,DeliveryRecordStatus[S.status]);return}S.status=DeliveryRecordStatus.valid,S.validated=C,S.peers.forEach(A=>{A!==r.toString()&&this.markDuplicateMessageDelivery(A,E)})}rejectInvalidMessage(r,_){this.markInvalidMessageDelivery(r,_)}rejectMessage(r,_,E,S){switch(S){case RejectReason.Error:this.markInvalidMessageDelivery(r,E);return;case RejectReason.Blacklisted:return}const C=this.deliveryRecords.ensureRecord(_);if(C.status!==DeliveryRecordStatus.unknown){this.log("unexpected rejection: message from %s was first seen %s ago and has delivery status %d",r,Date.now()-C.firstSeenTsMs,DeliveryRecordStatus[C.status]);return}if(S===RejectReason.Ignore){C.status=DeliveryRecordStatus.ignored,C.peers.clear();return}C.status=DeliveryRecordStatus.invalid,this.markInvalidMessageDelivery(r,E),C.peers.forEach(A=>{this.markInvalidMessageDelivery(A,E)}),C.peers.clear()}duplicateMessage(r,_,E){const S=this.deliveryRecords.ensureRecord(_);if(!S.peers.has(r))switch(S.status){case DeliveryRecordStatus.unknown:S.peers.add(r);break;case DeliveryRecordStatus.valid:S.peers.add(r),this.markDuplicateMessageDelivery(r,E,S.validated);break;case DeliveryRecordStatus.invalid:this.markInvalidMessageDelivery(r,E);break;case DeliveryRecordStatus.ignored:break}}markInvalidMessageDelivery(r,_){const E=this.peerStats.get(r);if(E!=null){const S=this.getPtopicStats(E,_);S!=null&&(S.invalidMessageDeliveries+=1)}}markFirstMessageDelivery(r,_){const E=this.peerStats.get(r);if(E!=null){const S=this.getPtopicStats(E,_);if(S!=null){let C=this.params.topics[_].firstMessageDeliveriesCap;S.firstMessageDeliveries=Math.min(C,S.firstMessageDeliveries+1),S.inMesh&&(C=this.params.topics[_].meshMessageDeliveriesCap,S.meshMessageDeliveries=Math.min(C,S.meshMessageDeliveries+1))}}}markDuplicateMessageDelivery(r,_,E){const S=this.peerStats.get(r);if(S!=null){const C=E!==void 0?Date.now():0,A=this.getPtopicStats(S,_);if(A!=null&&A.inMesh){const I=this.params.topics[_];if(E!==void 0){const O=C-E,N=O>I.meshMessageDeliveriesWindow;if(this.metrics?.onDuplicateMsgDelivery(_,O,N),N)return}const B=I.meshMessageDeliveriesCap;A.meshMessageDeliveries=Math.min(B,A.meshMessageDeliveries+1)}}}removeIPsForPeer(r,_){for(const E of _){const S=this.peerIPs.get(E);S!=null&&(S.delete(r),S.size===0&&this.peerIPs.delete(E))}}getPtopicStats(r,_){let E=r.topics[_];return E!==void 0?E:this.params.topics[_]!==void 0?(E={inMesh:!1,graftTime:0,meshTime:0,firstMessageDeliveries:0,meshMessageDeliveries:0,meshMessageDeliveriesActive:!1,meshFailurePenalty:0,invalidMessageDeliveries:0},r.topics[_]=E,E):null}}function computeScoreWeights(n,r,_,E,S){let C=0;const A=new Map;if(Object.entries(r.topics).forEach(([j,z])=>{const Z=S.get(j)??"unknown",X=_.topics[j];if(X===void 0)return;let Q=A.get(Z);Q==null&&(Q={p1w:0,p2w:0,p3w:0,p3bw:0,p4w:0},A.set(Z,Q));let se=0,oe=0,ue=0,we=0,Te=0;if(z.inMesh){const Fe=Math.max(z.meshTime/X.timeInMeshQuantum,X.timeInMeshCap);se+=Fe*X.timeInMeshWeight}let xe=z.firstMessageDeliveries;if(xe>X.firstMessageDeliveriesCap&&(xe=X.firstMessageDeliveriesCap),oe+=xe*X.firstMessageDeliveriesWeight,z.meshMessageDeliveriesActive&&z.meshMessageDeliveries<X.meshMessageDeliveriesThreshold){const Fe=X.meshMessageDeliveriesThreshold-z.meshMessageDeliveries,ht=Fe*Fe;ue+=ht*X.meshMessageDeliveriesWeight}const Re=z.meshFailurePenalty;we+=Re*X.meshFailurePenaltyWeight;const Ne=z.invalidMessageDeliveries*z.invalidMessageDeliveries;Te+=Ne*X.invalidMessageDeliveriesWeight,C+=(se+oe+ue+we+Te)*X.topicWeight,Q.p1w+=se,Q.p2w+=oe,Q.p3w+=ue,Q.p3bw+=we,Q.p4w+=Te}),_.topicScoreCap>0&&C>_.topicScoreCap){C=_.topicScoreCap;const j=_.topicScoreCap/C;for(const z of A.values())z.p1w*=j,z.p2w*=j,z.p3w*=j,z.p3bw*=j,z.p4w*=j}let I=0,B=0,O=0;const N=_.appSpecificScore(n);I+=N*_.appSpecificWeight,r.knownIPs.forEach(j=>{if(_.IPColocationFactorWhitelist.has(j))return;const z=E.get(j),Z=z!=null?z.size:0;if(Z>_.IPColocationFactorThreshold){const X=Z-_.IPColocationFactorThreshold,Q=X*X;B+=Q*_.IPColocationFactorWeight}});const U=r.behaviourPenalty*r.behaviourPenalty;return O+=U*_.behaviourPenaltyWeight,C+=I+B+O,{byTopic:A,p5w:I,p6w:B,p7w:O,score:C}}function computeAllPeersScoreWeights(n,r,_,E,S){const C={byTopic:new Map,p5w:[],p6w:[],p7w:[],score:[]};for(const A of n){const I=r.get(A);if(I!=null){const B=computeScoreWeights(A,I,_,E,S);for(const[O,N]of B.byTopic){let U=C.byTopic.get(O);U==null&&(U={p1w:[],p2w:[],p3w:[],p3bw:[],p4w:[]},C.byTopic.set(O,U)),U.p1w.push(N.p1w),U.p2w.push(N.p2w),U.p3w.push(N.p3w),U.p3bw.push(N.p3bw),U.p4w.push(N.p4w)}C.p5w.push(B.p5w),C.p6w.push(B.p6w),C.p7w.push(B.p7w),C.score.push(B.score)}else C.p5w.push(0),C.p6w.push(0),C.p7w.push(0),C.score.push(0)}return C}class OutboundStream{rawStream;pushable;closeController;maxBufferSize;constructor(r,_,E){this.rawStream=r,this.pushable=pushable$1(),this.closeController=new AbortController,this.maxBufferSize=E.maxBufferSize??1/0,this.closeController.signal.addEventListener("abort",()=>{r.close().catch(S=>{r.abort(S)})}),pipe(this.pushable,this.rawStream).catch(_)}get protocol(){return this.rawStream.protocol}push(r){if(this.pushable.readableLength>this.maxBufferSize)throw Error(`OutboundStream buffer full, size > ${this.maxBufferSize}`);this.pushable.push(encode$6.single(r))}pushPrefixed(r){if(this.pushable.readableLength>this.maxBufferSize)throw Error(`OutboundStream buffer full, size > ${this.maxBufferSize}`);this.pushable.push(r)}async close(){this.closeController.abort(),await this.pushable.return()}}class InboundStream{source;rawStream;closeController;constructor(r,_={}){this.rawStream=r,this.closeController=new AbortController,this.closeController.signal.addEventListener("abort",()=>{r.close().catch(E=>{r.abort(E)})}),this.source=pipe(this.rawStream,E=>decode$4(E,_))}async close(){this.closeController.abort()}}class IWantTracer{gossipsubIWantFollowupMs;msgIdToStrFn;metrics;promises=new Map;requestMsByMsg=new Map;requestMsByMsgExpire;constructor(r,_,E){this.gossipsubIWantFollowupMs=r,this.msgIdToStrFn=_,this.metrics=E,this.requestMsByMsgExpire=10*r}get size(){return this.promises.size}get requestMsByMsgSize(){return this.requestMsByMsg.size}addPromise(r,_){const E=Math.floor(Math.random()*_.length),S=_[E],C=this.msgIdToStrFn(S);let A=this.promises.get(C);A==null&&(A=new Map,this.promises.set(C,A));const I=Date.now();A.has(r)||(A.set(r,I+this.gossipsubIWantFollowupMs),this.metrics!=null&&(this.metrics.iwantPromiseStarted.inc(1),this.requestMsByMsg.has(C)||this.requestMsByMsg.set(C,I)))}getBrokenPromises(){const r=Date.now(),_=new Map;let E=0;return this.promises.forEach((S,C)=>{S.forEach((A,I)=>{A<r&&(_.set(I,(_.get(I)??0)+1),S.delete(I),E++)}),S.size===0&&this.promises.delete(C)}),this.metrics?.iwantPromiseBroken.inc(E),_}deliverMessage(r,_=!1){this.trackMessage(r);const E=this.promises.get(r);E!=null&&(this.promises.delete(r),this.metrics!=null&&(this.metrics.iwantPromiseResolved.inc(1),_&&this.metrics.iwantPromiseResolvedFromDuplicate.inc(1),this.metrics.iwantPromiseResolvedPeers.inc(E.size)))}rejectMessage(r,_){switch(this.trackMessage(r),_){case RejectReason.Error:return}this.promises.delete(r)}clear(){this.promises.clear()}prune(){const r=Date.now()-this.requestMsByMsgExpire;let _=0;for(const[E,S]of this.requestMsByMsg.entries())if(S<r)this.requestMsByMsg.delete(E),_++;else break;this.metrics?.iwantMessagePruned.inc(_)}trackMessage(r){if(this.metrics!=null){const _=this.requestMsByMsg.get(r);_!==void 0&&(this.metrics.iwantPromiseDeliveryTime.observe((Date.now()-_)/1e3),this.requestMsByMsg.delete(r))}}}const webcrypto$1={get(n=globalThis){const r=n.crypto;if(r==null||r.subtle==null)throw Object.assign(new Error("Missing Web Crypto API. The most likely cause of this error is that this page is being accessed from an insecure context (i.e. not HTTPS). For more information and possible resolutions see https://github.com/libp2p/js-libp2p/blob/main/packages/crypto/README.md#web-crypto-api"),{code:"ERR_MISSING_WEB_CRYPTO"});return r}};function isPromise$3(n){return n==null?!1:typeof n.then=="function"&&typeof n.catch=="function"&&typeof n.finally=="function"}const PUBLIC_KEY_BYTE_LENGTH$1=32,PRIVATE_KEY_BYTE_LENGTH$1=64,KEYS_BYTE_LENGTH$1=32;function generateKey$5(){const n=ed25519.utils.randomPrivateKey(),r=ed25519.getPublicKey(n);return{privateKey:concatKeys$1(n,r),publicKey:r}}function generateKeyFromSeed$1(n){if(n.length!==KEYS_BYTE_LENGTH$1)throw new TypeError('"seed" must be 32 bytes in length.');if(!(n instanceof Uint8Array))throw new TypeError('"seed" must be a node.js Buffer, or Uint8Array.');const r=n,_=ed25519.getPublicKey(r);return{privateKey:concatKeys$1(r,_),publicKey:_}}function hashAndSign$5(n,r){const _=n.subarray(0,KEYS_BYTE_LENGTH$1);return ed25519.sign(r instanceof Uint8Array?r:r.subarray(),_)}function hashAndVerify$5(n,r,_){return ed25519.verify(r,_ instanceof Uint8Array?_:_.subarray(),n)}function concatKeys$1(n,r){const _=new Uint8Array(PRIVATE_KEY_BYTE_LENGTH$1);for(let E=0;E<KEYS_BYTE_LENGTH$1;E++)_[E]=n[E],_[KEYS_BYTE_LENGTH$1+E]=r[E];return _}const derivedEmptyPasswordKey$1={alg:"A128GCM",ext:!0,k:"scm9jmO_4BJAgdwWGVulLg",key_ops:["encrypt","decrypt"],kty:"oct"};function create$1(n){const r=n?.algorithm??"AES-GCM";let _=n?.keyLength??16;const E=n?.nonceLength??12,S=n?.digest??"SHA-256",C=n?.saltLength??16,A=n?.iterations??32767,I=webcrypto$1.get();_*=8;async function B(U,j){const z=I.getRandomValues(new Uint8Array(C)),Z=I.getRandomValues(new Uint8Array(E)),X={name:r,iv:Z};typeof j=="string"&&(j=fromString$3(j));let Q;if(j.length===0){Q=await I.subtle.importKey("jwk",derivedEmptyPasswordKey$1,{name:"AES-GCM"},!0,["encrypt"]);try{const oe={name:"PBKDF2",salt:z,iterations:A,hash:{name:S}},ue=await I.subtle.importKey("raw",j,{name:"PBKDF2"},!1,["deriveKey"]);Q=await I.subtle.deriveKey(oe,ue,{name:r,length:_},!0,["encrypt"])}catch{Q=await I.subtle.importKey("jwk",derivedEmptyPasswordKey$1,{name:"AES-GCM"},!0,["encrypt"])}}else{const oe={name:"PBKDF2",salt:z,iterations:A,hash:{name:S}},ue=await I.subtle.importKey("raw",j,{name:"PBKDF2"},!1,["deriveKey"]);Q=await I.subtle.deriveKey(oe,ue,{name:r,length:_},!0,["encrypt"])}const se=await I.subtle.encrypt(X,Q,U);return concat$4([z,X.iv,new Uint8Array(se)])}async function O(U,j){const z=U.subarray(0,C),Z=U.subarray(C,C+E),X=U.subarray(C+E),Q={name:r,iv:Z};typeof j=="string"&&(j=fromString$3(j));let se;if(j.length===0)try{const ue={name:"PBKDF2",salt:z,iterations:A,hash:{name:S}},we=await I.subtle.importKey("raw",j,{name:"PBKDF2"},!1,["deriveKey"]);se=await I.subtle.deriveKey(ue,we,{name:r,length:_},!0,["decrypt"])}catch{se=await I.subtle.importKey("jwk",derivedEmptyPasswordKey$1,{name:"AES-GCM"},!0,["decrypt"])}else{const ue={name:"PBKDF2",salt:z,iterations:A,hash:{name:S}},we=await I.subtle.importKey("raw",j,{name:"PBKDF2"},!1,["deriveKey"]);se=await I.subtle.deriveKey(ue,we,{name:r,length:_},!0,["decrypt"])}const oe=await I.subtle.decrypt(Q,se,X);return new Uint8Array(oe)}return{encrypt:B,decrypt:O}}async function exporter$1(n,r){const E=await create$1().encrypt(n,r);return base64$5.encode(E)}var KeyType$1;(function(n){n.RSA="RSA",n.Ed25519="Ed25519",n.Secp256k1="Secp256k1"})(KeyType$1||(KeyType$1={}));var __KeyTypeValues$1;(function(n){n[n.RSA=0]="RSA",n[n.Ed25519=1]="Ed25519",n[n.Secp256k1=2]="Secp256k1"})(__KeyTypeValues$1||(__KeyTypeValues$1={}));(function(n){n.codec=()=>enumeration(__KeyTypeValues$1)})(KeyType$1||(KeyType$1={}));var PublicKey$1;(function(n){let r;n.codec=()=>(r==null&&(r=message((_,E,S={})=>{S.lengthDelimited!==!1&&E.fork(),_.Type!=null&&(E.uint32(8),KeyType$1.codec().encode(_.Type,E)),_.Data!=null&&(E.uint32(18),E.bytes(_.Data)),S.lengthDelimited!==!1&&E.ldelim()},(_,E)=>{const S={},C=E==null?_.len:_.pos+E;for(;_.pos<C;){const A=_.uint32();switch(A>>>3){case 1:S.Type=KeyType$1.codec().decode(_);break;case 2:S.Data=_.bytes();break;default:_.skipType(A&7);break}}return S})),r),n.encode=_=>encodeMessage(_,n.codec()),n.decode=_=>decodeMessage$1(_,n.codec())})(PublicKey$1||(PublicKey$1={}));var PrivateKey$1;(function(n){let r;n.codec=()=>(r==null&&(r=message((_,E,S={})=>{S.lengthDelimited!==!1&&E.fork(),_.Type!=null&&(E.uint32(8),KeyType$1.codec().encode(_.Type,E)),_.Data!=null&&(E.uint32(18),E.bytes(_.Data)),S.lengthDelimited!==!1&&E.ldelim()},(_,E)=>{const S={},C=E==null?_.len:_.pos+E;for(;_.pos<C;){const A=_.uint32();switch(A>>>3){case 1:S.Type=KeyType$1.codec().decode(_);break;case 2:S.Data=_.bytes();break;default:_.skipType(A&7);break}}return S})),r),n.encode=_=>encodeMessage(_,n.codec()),n.decode=_=>decodeMessage$1(_,n.codec())})(PrivateKey$1||(PrivateKey$1={}));let Ed25519PublicKey$1=class{_key;constructor(r){this._key=ensureKey$1(r,PUBLIC_KEY_BYTE_LENGTH$1)}verify(r,_){return hashAndVerify$5(this._key,_,r)}marshal(){return this._key}get bytes(){return PublicKey$1.encode({Type:KeyType$1.Ed25519,Data:this.marshal()}).subarray()}equals(r){return equals$1(this.bytes,r.bytes)}hash(){const r=sha256$6.digest(this.bytes);return isPromise$3(r)?r.then(({bytes:_})=>_):r.bytes}},Ed25519PrivateKey$1=class{_key;_publicKey;constructor(r,_){this._key=ensureKey$1(r,PRIVATE_KEY_BYTE_LENGTH$1),this._publicKey=ensureKey$1(_,PUBLIC_KEY_BYTE_LENGTH$1)}sign(r){return hashAndSign$5(this._key,r)}get public(){return new Ed25519PublicKey$1(this._publicKey)}marshal(){return this._key}get bytes(){return PrivateKey$1.encode({Type:KeyType$1.Ed25519,Data:this.marshal()}).subarray()}equals(r){return equals$1(this.bytes,r.bytes)}async hash(){const r=sha256$6.digest(this.bytes);let _;return isPromise$3(r)?{bytes:_}=await r:_=r.bytes,_}async id(){const r=identity$6.digest(this.public.bytes);return base58btc.encode(r.bytes).substring(1)}async export(r,_="libp2p-key"){if(_==="libp2p-key")return exporter$1(this.bytes,r);throw new CodeError$4(`export format '${_}' is not supported`,"ERR_INVALID_EXPORT_FORMAT")}};function unmarshalEd25519PrivateKey$1(n){if(n.length>PRIVATE_KEY_BYTE_LENGTH$1){n=ensureKey$1(n,PRIVATE_KEY_BYTE_LENGTH$1+PUBLIC_KEY_BYTE_LENGTH$1);const E=n.subarray(0,PRIVATE_KEY_BYTE_LENGTH$1),S=n.subarray(PRIVATE_KEY_BYTE_LENGTH$1,n.length);return new Ed25519PrivateKey$1(E,S)}n=ensureKey$1(n,PRIVATE_KEY_BYTE_LENGTH$1);const r=n.subarray(0,PRIVATE_KEY_BYTE_LENGTH$1),_=n.subarray(PUBLIC_KEY_BYTE_LENGTH$1);return new Ed25519PrivateKey$1(r,_)}function unmarshalEd25519PublicKey$1(n){return n=ensureKey$1(n,PUBLIC_KEY_BYTE_LENGTH$1),new Ed25519PublicKey$1(n)}async function generateKeyPair$6(){const{privateKey:n,publicKey:r}=generateKey$5();return new Ed25519PrivateKey$1(n,r)}async function generateKeyPairFromSeed$1(n){const{privateKey:r,publicKey:_}=generateKeyFromSeed$1(n);return new Ed25519PrivateKey$1(r,_)}function ensureKey$1(n,r){if(n=Uint8Array.from(n??[]),n.length!==r)throw new CodeError$4(`Key must be a Uint8Array of length ${r}, got ${n.length}`,"ERR_INVALID_KEY_TYPE");return n}const Ed25519$1=Object.freeze(Object.defineProperty({__proto__:null,Ed25519PrivateKey:Ed25519PrivateKey$1,Ed25519PublicKey:Ed25519PublicKey$1,generateKeyPair:generateKeyPair$6,generateKeyPairFromSeed:generateKeyPairFromSeed$1,unmarshalEd25519PrivateKey:unmarshalEd25519PrivateKey$1,unmarshalEd25519PublicKey:unmarshalEd25519PublicKey$1},Symbol.toStringTag,{value:"Module"}));async function importer(n,r){const _=base64$5.decode(n);return create$1().decrypt(_,r)}function randomBytes$1(n){if(isNaN(n)||n<=0)throw new CodeError$4("random bytes length must be a Number bigger than 0","ERR_INVALID_LENGTH");return randomBytes$3(n)}function pbkdf2Init(n,r,_,E){hash(n);const S=checkOpts$1({dkLen:32,asyncTick:10},E),{c:C,dkLen:A,asyncTick:I}=S;if(number$2(C),number$2(A),number$2(I),C<1)throw new Error("PBKDF2: iterations (c) should be >= 1");const B=toBytes$2(r),O=toBytes$2(_),N=new Uint8Array(A),U=hmac.create(n,B),j=U._cloneInto().update(O);return{c:C,dkLen:A,asyncTick:I,DK:N,PRF:U,PRFSalt:j}}function pbkdf2Output(n,r,_,E,S){return n.destroy(),r.destroy(),E&&E.destroy(),S.fill(0),_}function pbkdf2$1(n,r,_,E){const{c:S,dkLen:C,DK:A,PRF:I,PRFSalt:B}=pbkdf2Init(n,r,_,E);let O;const N=new Uint8Array(4),U=createView$1(N),j=new Uint8Array(I.outputLen);for(let z=1,Z=0;Z<C;z++,Z+=I.outputLen){const X=A.subarray(Z,Z+I.outputLen);U.setInt32(0,z,!1),(O=B._cloneInto(O)).update(N).digestInto(j),X.set(j.subarray(0,X.length));for(let Q=1;Q<S;Q++){I._cloneInto(O).update(j).digestInto(j);for(let se=0;se<X.length;se++)X[se]^=j[se]}}return pbkdf2Output(I,B,A,O,j)}async function pbkdf2Async(n,r,_,E){const{c:S,dkLen:C,asyncTick:A,DK:I,PRF:B,PRFSalt:O}=pbkdf2Init(n,r,_,E);let N;const U=new Uint8Array(4),j=createView$1(U),z=new Uint8Array(B.outputLen);for(let Z=1,X=0;X<C;Z++,X+=B.outputLen){const Q=I.subarray(X,X+B.outputLen);j.setInt32(0,Z,!1),(N=O._cloneInto(N)).update(U).digestInto(z),Q.set(z.subarray(0,Q.length)),await asyncLoop(S-1,A,()=>{B._cloneInto(N).update(z).digestInto(z);for(let se=0;se<Q.length;se++)Q[se]^=z[se]})}return pbkdf2Output(B,O,I,N,z)}/*!
 * MIT License
 * 
 * Copyright (c) 2017-2022 Peculiar Ventures, LLC
 * 
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 * 
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 * 
 */const ARRAY_BUFFER_NAME="[object ArrayBuffer]";class BufferSourceConverter{static isArrayBuffer(r){return Object.prototype.toString.call(r)===ARRAY_BUFFER_NAME}static toArrayBuffer(r){return this.isArrayBuffer(r)?r:r.byteLength===r.buffer.byteLength||r.byteOffset===0&&r.byteLength===r.buffer.byteLength?r.buffer:this.toUint8Array(r.buffer).slice(r.byteOffset,r.byteOffset+r.byteLength).buffer}static toUint8Array(r){return this.toView(r,Uint8Array)}static toView(r,_){if(r.constructor===_)return r;if(this.isArrayBuffer(r))return new _(r);if(this.isArrayBufferView(r))return new _(r.buffer,r.byteOffset,r.byteLength);throw new TypeError("The provided value is not of type '(ArrayBuffer or ArrayBufferView)'")}static isBufferSource(r){return this.isArrayBufferView(r)||this.isArrayBuffer(r)}static isArrayBufferView(r){return ArrayBuffer.isView(r)||r&&this.isArrayBuffer(r.buffer)}static isEqual(r,_){const E=BufferSourceConverter.toUint8Array(r),S=BufferSourceConverter.toUint8Array(_);if(E.length!==S.byteLength)return!1;for(let C=0;C<E.length;C++)if(E[C]!==S[C])return!1;return!0}static concat(...r){let _;Array.isArray(r[0])&&!(r[1]instanceof Function)||Array.isArray(r[0])&&r[1]instanceof Function?_=r[0]:r[r.length-1]instanceof Function?_=r.slice(0,r.length-1):_=r;let E=0;for(const A of _)E+=A.byteLength;const S=new Uint8Array(E);let C=0;for(const A of _){const I=this.toUint8Array(A);S.set(I,C),C+=I.length}return r[r.length-1]instanceof Function?this.toView(S,r[r.length-1]):S.buffer}}const STRING_TYPE="string",HEX_REGEX=/^[0-9a-f]+$/i,BASE64_REGEX=/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/,BASE64URL_REGEX=/^[a-zA-Z0-9-_]+$/;class Utf8Converter{static fromString(r){const _=unescape(encodeURIComponent(r)),E=new Uint8Array(_.length);for(let S=0;S<_.length;S++)E[S]=_.charCodeAt(S);return E.buffer}static toString(r){const _=BufferSourceConverter.toUint8Array(r);let E="";for(let C=0;C<_.length;C++)E+=String.fromCharCode(_[C]);return decodeURIComponent(escape(E))}}class Utf16Converter{static toString(r,_=!1){const E=BufferSourceConverter.toArrayBuffer(r),S=new DataView(E);let C="";for(let A=0;A<E.byteLength;A+=2){const I=S.getUint16(A,_);C+=String.fromCharCode(I)}return C}static fromString(r,_=!1){const E=new ArrayBuffer(r.length*2),S=new DataView(E);for(let C=0;C<r.length;C++)S.setUint16(C*2,r.charCodeAt(C),_);return E}}class Convert{static isHex(r){return typeof r===STRING_TYPE&&HEX_REGEX.test(r)}static isBase64(r){return typeof r===STRING_TYPE&&BASE64_REGEX.test(r)}static isBase64Url(r){return typeof r===STRING_TYPE&&BASE64URL_REGEX.test(r)}static ToString(r,_="utf8"){const E=BufferSourceConverter.toUint8Array(r);switch(_.toLowerCase()){case"utf8":return this.ToUtf8String(E);case"binary":return this.ToBinary(E);case"hex":return this.ToHex(E);case"base64":return this.ToBase64(E);case"base64url":return this.ToBase64Url(E);case"utf16le":return Utf16Converter.toString(E,!0);case"utf16":case"utf16be":return Utf16Converter.toString(E);default:throw new Error(`Unknown type of encoding '${_}'`)}}static FromString(r,_="utf8"){if(!r)return new ArrayBuffer(0);switch(_.toLowerCase()){case"utf8":return this.FromUtf8String(r);case"binary":return this.FromBinary(r);case"hex":return this.FromHex(r);case"base64":return this.FromBase64(r);case"base64url":return this.FromBase64Url(r);case"utf16le":return Utf16Converter.fromString(r,!0);case"utf16":case"utf16be":return Utf16Converter.fromString(r);default:throw new Error(`Unknown type of encoding '${_}'`)}}static ToBase64(r){const _=BufferSourceConverter.toUint8Array(r);if(typeof btoa<"u"){const E=this.ToString(_,"binary");return btoa(E)}else return Buffer$4.from(_).toString("base64")}static FromBase64(r){const _=this.formatString(r);if(!_)return new ArrayBuffer(0);if(!Convert.isBase64(_))throw new TypeError("Argument 'base64Text' is not Base64 encoded");return typeof atob<"u"?this.FromBinary(atob(_)):new Uint8Array(Buffer$4.from(_,"base64")).buffer}static FromBase64Url(r){const _=this.formatString(r);if(!_)return new ArrayBuffer(0);if(!Convert.isBase64Url(_))throw new TypeError("Argument 'base64url' is not Base64Url encoded");return this.FromBase64(this.Base64Padding(_.replace(/\-/g,"+").replace(/\_/g,"/")))}static ToBase64Url(r){return this.ToBase64(r).replace(/\+/g,"-").replace(/\//g,"_").replace(/\=/g,"")}static FromUtf8String(r,_=Convert.DEFAULT_UTF8_ENCODING){switch(_){case"ascii":return this.FromBinary(r);case"utf8":return Utf8Converter.fromString(r);case"utf16":case"utf16be":return Utf16Converter.fromString(r);case"utf16le":case"usc2":return Utf16Converter.fromString(r,!0);default:throw new Error(`Unknown type of encoding '${_}'`)}}static ToUtf8String(r,_=Convert.DEFAULT_UTF8_ENCODING){switch(_){case"ascii":return this.ToBinary(r);case"utf8":return Utf8Converter.toString(r);case"utf16":case"utf16be":return Utf16Converter.toString(r);case"utf16le":case"usc2":return Utf16Converter.toString(r,!0);default:throw new Error(`Unknown type of encoding '${_}'`)}}static FromBinary(r){const _=r.length,E=new Uint8Array(_);for(let S=0;S<_;S++)E[S]=r.charCodeAt(S);return E.buffer}static ToBinary(r){const _=BufferSourceConverter.toUint8Array(r);let E="";for(let S=0;S<_.length;S++)E+=String.fromCharCode(_[S]);return E}static ToHex(r){const _=BufferSourceConverter.toUint8Array(r);let E="";const S=_.length;for(let C=0;C<S;C++){const A=_[C];A<16&&(E+="0"),E+=A.toString(16)}return E}static FromHex(r){let _=this.formatString(r);if(!_)return new ArrayBuffer(0);if(!Convert.isHex(_))throw new TypeError("Argument 'hexString' is not HEX encoded");_.length%2&&(_=`0${_}`);const E=new Uint8Array(_.length/2);for(let S=0;S<_.length;S=S+2){const C=_.slice(S,S+2);E[S/2]=parseInt(C,16)}return E.buffer}static ToUtf16String(r,_=!1){return Utf16Converter.toString(r,_)}static FromUtf16String(r,_=!1){return Utf16Converter.fromString(r,_)}static Base64Padding(r){const _=4-r.length%4;if(_<4)for(let E=0;E<_;E++)r+="=";return r}static formatString(r){return r?.replace(/[\n\r\t ]/g,"")||""}}Convert.DEFAULT_UTF8_ENCODING="utf8";/*!
 Copyright (c) Peculiar Ventures, LLC
*/function utilFromBase(n,r){let _=0;if(n.length===1)return n[0];for(let E=n.length-1;E>=0;E--)_+=n[n.length-1-E]*Math.pow(2,r*E);return _}function utilToBase(n,r,_=-1){const E=_;let S=n,C=0,A=Math.pow(2,r);for(let I=1;I<8;I++){if(n<A){let B;if(E<0)B=new ArrayBuffer(I),C=I;else{if(E<I)return new ArrayBuffer(0);B=new ArrayBuffer(E),C=E}const O=new Uint8Array(B);for(let N=I-1;N>=0;N--){const U=Math.pow(2,N*r);O[C-N-1]=Math.floor(S/U),S-=O[C-N-1]*U}return B}A*=Math.pow(2,r)}return new ArrayBuffer(0)}function utilConcatView(...n){let r=0,_=0;for(const C of n)r+=C.length;const E=new ArrayBuffer(r),S=new Uint8Array(E);for(const C of n)S.set(C,_),_+=C.length;return S}function utilDecodeTC(){const n=new Uint8Array(this.valueHex);if(this.valueHex.byteLength>=2){const I=n[0]===255&&n[1]&128,B=n[0]===0&&(n[1]&128)===0;(I||B)&&this.warnings.push("Needlessly long format")}const r=new ArrayBuffer(this.valueHex.byteLength),_=new Uint8Array(r);for(let I=0;I<this.valueHex.byteLength;I++)_[I]=0;_[0]=n[0]&128;const E=utilFromBase(_,8),S=new ArrayBuffer(this.valueHex.byteLength),C=new Uint8Array(S);for(let I=0;I<this.valueHex.byteLength;I++)C[I]=n[I];return C[0]&=127,utilFromBase(C,8)-E}function utilEncodeTC(n){const r=n<0?n*-1:n;let _=128;for(let E=1;E<8;E++){if(r<=_){if(n<0){const A=_-r,I=utilToBase(A,8,E),B=new Uint8Array(I);return B[0]|=128,I}let S=utilToBase(r,8,E),C=new Uint8Array(S);if(C[0]&128){const A=S.slice(0),I=new Uint8Array(A);S=new ArrayBuffer(S.byteLength+1),C=new Uint8Array(S);for(let B=0;B<A.byteLength;B++)C[B+1]=I[B];C[0]=0}return S}_*=Math.pow(2,8)}return new ArrayBuffer(0)}function isEqualBuffer(n,r){if(n.byteLength!==r.byteLength)return!1;const _=new Uint8Array(n),E=new Uint8Array(r);for(let S=0;S<_.length;S++)if(_[S]!==E[S])return!1;return!0}function padNumber(n,r){const _=n.toString(10);if(r<_.length)return"";const E=r-_.length,S=new Array(E);for(let A=0;A<E;A++)S[A]="0";return S.join("").concat(_)}/*!
 * Copyright (c) 2014, GMO GlobalSign
 * Copyright (c) 2015-2022, Peculiar Ventures
 * All rights reserved.
 * 
 * Author 2014-2019, Yury Strozhevsky
 * 
 * Redistribution and use in source and binary forms, with or without modification,
 * are permitted provided that the following conditions are met:
 * 
 * * Redistributions of source code must retain the above copyright notice, this
 *   list of conditions and the following disclaimer.
 * 
 * * Redistributions in binary form must reproduce the above copyright notice, this
 *   list of conditions and the following disclaimer in the documentation and/or
 *   other materials provided with the distribution.
 * 
 * * Neither the name of the copyright holder nor the names of its
 *   contributors may be used to endorse or promote products derived from
 *   this software without specific prior written permission.
 * 
 * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND
 * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED
 * WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
 * DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR
 * ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES
 * (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
 * LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON
 * ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
 * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
 * SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 * 
 */function assertBigInt(){if(typeof BigInt>"u")throw new Error("BigInt is not defined. Your environment doesn't implement BigInt.")}function concat$3(n){let r=0,_=0;for(let S=0;S<n.length;S++){const C=n[S];r+=C.byteLength}const E=new Uint8Array(r);for(let S=0;S<n.length;S++){const C=n[S];E.set(new Uint8Array(C),_),_+=C.byteLength}return E.buffer}function checkBufferParams(n,r,_,E){return r instanceof Uint8Array?r.byteLength?_<0?(n.error="Wrong parameter: inputOffset less than zero",!1):E<0?(n.error="Wrong parameter: inputLength less than zero",!1):r.byteLength-_-E<0?(n.error="End of input reached before message was fully decoded (inconsistent offset and length values)",!1):!0:(n.error="Wrong parameter: inputBuffer has zero length",!1):(n.error="Wrong parameter: inputBuffer must be 'Uint8Array'",!1)}class ViewWriter{constructor(){this.items=[]}write(r){this.items.push(r)}final(){return concat$3(this.items)}}const powers2=[new Uint8Array([1])],digitsString="0123456789",EMPTY_STRING="",EMPTY_BUFFER$1=new ArrayBuffer(0),EMPTY_VIEW=new Uint8Array(0),END_OF_CONTENT_NAME="EndOfContent",OCTET_STRING_NAME="OCTET STRING",BIT_STRING_NAME="BIT STRING";function HexBlock(n){var r;return r=class extends n{constructor(...E){var S;super(...E);const C=E[0]||{};this.isHexOnly=(S=C.isHexOnly)!==null&&S!==void 0?S:!1,this.valueHexView=C.valueHex?BufferSourceConverter.toUint8Array(C.valueHex):EMPTY_VIEW}get valueHex(){return this.valueHexView.slice().buffer}set valueHex(E){this.valueHexView=new Uint8Array(E)}fromBER(E,S,C){const A=E instanceof ArrayBuffer?new Uint8Array(E):E;if(!checkBufferParams(this,A,S,C))return-1;const I=S+C;return this.valueHexView=A.subarray(S,I),this.valueHexView.length?(this.blockLength=C,I):(this.warnings.push("Zero buffer length"),S)}toBER(E=!1){return this.isHexOnly?E?new ArrayBuffer(this.valueHexView.byteLength):this.valueHexView.byteLength===this.valueHexView.buffer.byteLength?this.valueHexView.buffer:this.valueHexView.slice().buffer:(this.error="Flag 'isHexOnly' is not set, abort",EMPTY_BUFFER$1)}toJSON(){return{...super.toJSON(),isHexOnly:this.isHexOnly,valueHex:Convert.ToHex(this.valueHexView)}}},r.NAME="hexBlock",r}class LocalBaseBlock{constructor({blockLength:r=0,error:_=EMPTY_STRING,warnings:E=[],valueBeforeDecode:S=EMPTY_VIEW}={}){this.blockLength=r,this.error=_,this.warnings=E,this.valueBeforeDecodeView=BufferSourceConverter.toUint8Array(S)}static blockName(){return this.NAME}get valueBeforeDecode(){return this.valueBeforeDecodeView.slice().buffer}set valueBeforeDecode(r){this.valueBeforeDecodeView=new Uint8Array(r)}toJSON(){return{blockName:this.constructor.NAME,blockLength:this.blockLength,error:this.error,warnings:this.warnings,valueBeforeDecode:Convert.ToHex(this.valueBeforeDecodeView)}}}LocalBaseBlock.NAME="baseBlock";class ValueBlock extends LocalBaseBlock{fromBER(r,_,E){throw TypeError("User need to make a specific function in a class which extends 'ValueBlock'")}toBER(r,_){throw TypeError("User need to make a specific function in a class which extends 'ValueBlock'")}}ValueBlock.NAME="valueBlock";class LocalIdentificationBlock extends HexBlock(LocalBaseBlock){constructor({idBlock:r={}}={}){var _,E,S,C;super(),r?(this.isHexOnly=(_=r.isHexOnly)!==null&&_!==void 0?_:!1,this.valueHexView=r.valueHex?BufferSourceConverter.toUint8Array(r.valueHex):EMPTY_VIEW,this.tagClass=(E=r.tagClass)!==null&&E!==void 0?E:-1,this.tagNumber=(S=r.tagNumber)!==null&&S!==void 0?S:-1,this.isConstructed=(C=r.isConstructed)!==null&&C!==void 0?C:!1):(this.tagClass=-1,this.tagNumber=-1,this.isConstructed=!1)}toBER(r=!1){let _=0;switch(this.tagClass){case 1:_|=0;break;case 2:_|=64;break;case 3:_|=128;break;case 4:_|=192;break;default:return this.error="Unknown tag class",EMPTY_BUFFER$1}if(this.isConstructed&&(_|=32),this.tagNumber<31&&!this.isHexOnly){const S=new Uint8Array(1);if(!r){let C=this.tagNumber;C&=31,_|=C,S[0]=_}return S.buffer}if(!this.isHexOnly){const S=utilToBase(this.tagNumber,7),C=new Uint8Array(S),A=S.byteLength,I=new Uint8Array(A+1);if(I[0]=_|31,!r){for(let B=0;B<A-1;B++)I[B+1]=C[B]|128;I[A]=C[A-1]}return I.buffer}const E=new Uint8Array(this.valueHexView.byteLength+1);if(E[0]=_|31,!r){const S=this.valueHexView;for(let C=0;C<S.length-1;C++)E[C+1]=S[C]|128;E[this.valueHexView.byteLength]=S[S.length-1]}return E.buffer}fromBER(r,_,E){const S=BufferSourceConverter.toUint8Array(r);if(!checkBufferParams(this,S,_,E))return-1;const C=S.subarray(_,_+E);if(C.length===0)return this.error="Zero buffer length",-1;switch(C[0]&192){case 0:this.tagClass=1;break;case 64:this.tagClass=2;break;case 128:this.tagClass=3;break;case 192:this.tagClass=4;break;default:return this.error="Unknown tag class",-1}this.isConstructed=(C[0]&32)===32,this.isHexOnly=!1;const I=C[0]&31;if(I!==31)this.tagNumber=I,this.blockLength=1;else{let B=1,O=this.valueHexView=new Uint8Array(255),N=255;for(;C[B]&128;){if(O[B-1]=C[B]&127,B++,B>=C.length)return this.error="End of input reached before message was fully decoded",-1;if(B===N){N+=255;const j=new Uint8Array(N);for(let z=0;z<O.length;z++)j[z]=O[z];O=this.valueHexView=new Uint8Array(N)}}this.blockLength=B+1,O[B-1]=C[B]&127;const U=new Uint8Array(B);for(let j=0;j<B;j++)U[j]=O[j];O=this.valueHexView=new Uint8Array(B),O.set(U),this.blockLength<=9?this.tagNumber=utilFromBase(O,7):(this.isHexOnly=!0,this.warnings.push("Tag too long, represented as hex-coded"))}if(this.tagClass===1&&this.isConstructed)switch(this.tagNumber){case 1:case 2:case 5:case 6:case 9:case 13:case 14:case 23:case 24:case 31:case 32:case 33:case 34:return this.error="Constructed encoding used for primitive type",-1}return _+this.blockLength}toJSON(){return{...super.toJSON(),tagClass:this.tagClass,tagNumber:this.tagNumber,isConstructed:this.isConstructed}}}LocalIdentificationBlock.NAME="identificationBlock";class LocalLengthBlock extends LocalBaseBlock{constructor({lenBlock:r={}}={}){var _,E,S;super(),this.isIndefiniteForm=(_=r.isIndefiniteForm)!==null&&_!==void 0?_:!1,this.longFormUsed=(E=r.longFormUsed)!==null&&E!==void 0?E:!1,this.length=(S=r.length)!==null&&S!==void 0?S:0}fromBER(r,_,E){const S=BufferSourceConverter.toUint8Array(r);if(!checkBufferParams(this,S,_,E))return-1;const C=S.subarray(_,_+E);if(C.length===0)return this.error="Zero buffer length",-1;if(C[0]===255)return this.error="Length block 0xFF is reserved by standard",-1;if(this.isIndefiniteForm=C[0]===128,this.isIndefiniteForm)return this.blockLength=1,_+this.blockLength;if(this.longFormUsed=!!(C[0]&128),this.longFormUsed===!1)return this.length=C[0],this.blockLength=1,_+this.blockLength;const A=C[0]&127;if(A>8)return this.error="Too big integer",-1;if(A+1>C.length)return this.error="End of input reached before message was fully decoded",-1;const I=_+1,B=S.subarray(I,I+A);return B[A-1]===0&&this.warnings.push("Needlessly long encoded length"),this.length=utilFromBase(B,8),this.longFormUsed&&this.length<=127&&this.warnings.push("Unnecessary usage of long length form"),this.blockLength=A+1,_+this.blockLength}toBER(r=!1){let _,E;if(this.length>127&&(this.longFormUsed=!0),this.isIndefiniteForm)return _=new ArrayBuffer(1),r===!1&&(E=new Uint8Array(_),E[0]=128),_;if(this.longFormUsed){const S=utilToBase(this.length,8);if(S.byteLength>127)return this.error="Too big length",EMPTY_BUFFER$1;if(_=new ArrayBuffer(S.byteLength+1),r)return _;const C=new Uint8Array(S);E=new Uint8Array(_),E[0]=S.byteLength|128;for(let A=0;A<S.byteLength;A++)E[A+1]=C[A];return _}return _=new ArrayBuffer(1),r===!1&&(E=new Uint8Array(_),E[0]=this.length),_}toJSON(){return{...super.toJSON(),isIndefiniteForm:this.isIndefiniteForm,longFormUsed:this.longFormUsed,length:this.length}}}LocalLengthBlock.NAME="lengthBlock";const typeStore={};class BaseBlock extends LocalBaseBlock{constructor({name:r=EMPTY_STRING,optional:_=!1,primitiveSchema:E,...S}={},C){super(S),this.name=r,this.optional=_,E&&(this.primitiveSchema=E),this.idBlock=new LocalIdentificationBlock(S),this.lenBlock=new LocalLengthBlock(S),this.valueBlock=C?new C(S):new ValueBlock(S)}fromBER(r,_,E){const S=this.valueBlock.fromBER(r,_,this.lenBlock.isIndefiniteForm?E:this.lenBlock.length);return S===-1?(this.error=this.valueBlock.error,S):(this.idBlock.error.length||(this.blockLength+=this.idBlock.blockLength),this.lenBlock.error.length||(this.blockLength+=this.lenBlock.blockLength),this.valueBlock.error.length||(this.blockLength+=this.valueBlock.blockLength),S)}toBER(r,_){const E=_||new ViewWriter;_||prepareIndefiniteForm(this);const S=this.idBlock.toBER(r);if(E.write(S),this.lenBlock.isIndefiniteForm)E.write(new Uint8Array([128]).buffer),this.valueBlock.toBER(r,E),E.write(new ArrayBuffer(2));else{const C=this.valueBlock.toBER(r);this.lenBlock.length=C.byteLength;const A=this.lenBlock.toBER(r);E.write(A),E.write(C)}return _?EMPTY_BUFFER$1:E.final()}toJSON(){const r={...super.toJSON(),idBlock:this.idBlock.toJSON(),lenBlock:this.lenBlock.toJSON(),valueBlock:this.valueBlock.toJSON(),name:this.name,optional:this.optional};return this.primitiveSchema&&(r.primitiveSchema=this.primitiveSchema.toJSON()),r}toString(r="ascii"){return r==="ascii"?this.onAsciiEncoding():Convert.ToHex(this.toBER())}onAsciiEncoding(){return`${this.constructor.NAME} : ${Convert.ToHex(this.valueBlock.valueBeforeDecodeView)}`}isEqual(r){if(this===r)return!0;if(!(r instanceof this.constructor))return!1;const _=this.toBER(),E=r.toBER();return isEqualBuffer(_,E)}}BaseBlock.NAME="BaseBlock";function prepareIndefiniteForm(n){if(n instanceof typeStore.Constructed)for(const r of n.valueBlock.value)prepareIndefiniteForm(r)&&(n.lenBlock.isIndefiniteForm=!0);return!!n.lenBlock.isIndefiniteForm}class BaseStringBlock extends BaseBlock{constructor({value:r=EMPTY_STRING,..._}={},E){super(_,E),r&&this.fromString(r)}getValue(){return this.valueBlock.value}setValue(r){this.valueBlock.value=r}fromBER(r,_,E){const S=this.valueBlock.fromBER(r,_,this.lenBlock.isIndefiniteForm?E:this.lenBlock.length);return S===-1?(this.error=this.valueBlock.error,S):(this.fromBuffer(this.valueBlock.valueHexView),this.idBlock.error.length||(this.blockLength+=this.idBlock.blockLength),this.lenBlock.error.length||(this.blockLength+=this.lenBlock.blockLength),this.valueBlock.error.length||(this.blockLength+=this.valueBlock.blockLength),S)}onAsciiEncoding(){return`${this.constructor.NAME} : '${this.valueBlock.value}'`}}BaseStringBlock.NAME="BaseStringBlock";class LocalPrimitiveValueBlock extends HexBlock(ValueBlock){constructor({isHexOnly:r=!0,..._}={}){super(_),this.isHexOnly=r}}LocalPrimitiveValueBlock.NAME="PrimitiveValueBlock";var _a$w;class Primitive extends BaseBlock{constructor(r={}){super(r,LocalPrimitiveValueBlock),this.idBlock.isConstructed=!1}}_a$w=Primitive;typeStore.Primitive=_a$w;Primitive.NAME="PRIMITIVE";function localChangeType(n,r){if(n instanceof r)return n;const _=new r;return _.idBlock=n.idBlock,_.lenBlock=n.lenBlock,_.warnings=n.warnings,_.valueBeforeDecodeView=n.valueBeforeDecodeView,_}function localFromBER(n,r=0,_=n.length){const E=r;let S=new BaseBlock({},ValueBlock);const C=new LocalBaseBlock;if(!checkBufferParams(C,n,r,_))return S.error=C.error,{offset:-1,result:S};if(!n.subarray(r,r+_).length)return S.error="Zero buffer length",{offset:-1,result:S};let I=S.idBlock.fromBER(n,r,_);if(S.idBlock.warnings.length&&S.warnings.concat(S.idBlock.warnings),I===-1)return S.error=S.idBlock.error,{offset:-1,result:S};if(r=I,_-=S.idBlock.blockLength,I=S.lenBlock.fromBER(n,r,_),S.lenBlock.warnings.length&&S.warnings.concat(S.lenBlock.warnings),I===-1)return S.error=S.lenBlock.error,{offset:-1,result:S};if(r=I,_-=S.lenBlock.blockLength,!S.idBlock.isConstructed&&S.lenBlock.isIndefiniteForm)return S.error="Indefinite length form used for primitive encoding form",{offset:-1,result:S};let B=BaseBlock;switch(S.idBlock.tagClass){case 1:if(S.idBlock.tagNumber>=37&&S.idBlock.isHexOnly===!1)return S.error="UNIVERSAL 37 and upper tags are reserved by ASN.1 standard",{offset:-1,result:S};switch(S.idBlock.tagNumber){case 0:if(S.idBlock.isConstructed&&S.lenBlock.length>0)return S.error="Type [UNIVERSAL 0] is reserved",{offset:-1,result:S};B=typeStore.EndOfContent;break;case 1:B=typeStore.Boolean;break;case 2:B=typeStore.Integer;break;case 3:B=typeStore.BitString;break;case 4:B=typeStore.OctetString;break;case 5:B=typeStore.Null;break;case 6:B=typeStore.ObjectIdentifier;break;case 10:B=typeStore.Enumerated;break;case 12:B=typeStore.Utf8String;break;case 13:B=typeStore.RelativeObjectIdentifier;break;case 14:B=typeStore.TIME;break;case 15:return S.error="[UNIVERSAL 15] is reserved by ASN.1 standard",{offset:-1,result:S};case 16:B=typeStore.Sequence;break;case 17:B=typeStore.Set;break;case 18:B=typeStore.NumericString;break;case 19:B=typeStore.PrintableString;break;case 20:B=typeStore.TeletexString;break;case 21:B=typeStore.VideotexString;break;case 22:B=typeStore.IA5String;break;case 23:B=typeStore.UTCTime;break;case 24:B=typeStore.GeneralizedTime;break;case 25:B=typeStore.GraphicString;break;case 26:B=typeStore.VisibleString;break;case 27:B=typeStore.GeneralString;break;case 28:B=typeStore.UniversalString;break;case 29:B=typeStore.CharacterString;break;case 30:B=typeStore.BmpString;break;case 31:B=typeStore.DATE;break;case 32:B=typeStore.TimeOfDay;break;case 33:B=typeStore.DateTime;break;case 34:B=typeStore.Duration;break;default:{const O=S.idBlock.isConstructed?new typeStore.Constructed:new typeStore.Primitive;O.idBlock=S.idBlock,O.lenBlock=S.lenBlock,O.warnings=S.warnings,S=O}}break;case 2:case 3:case 4:default:B=S.idBlock.isConstructed?typeStore.Constructed:typeStore.Primitive}return S=localChangeType(S,B),I=S.fromBER(n,r,S.lenBlock.isIndefiniteForm?_:S.lenBlock.length),S.valueBeforeDecodeView=n.subarray(E,E+S.blockLength),{offset:I,result:S}}function fromBER(n){if(!n.byteLength){const r=new BaseBlock({},ValueBlock);return r.error="Input buffer has zero length",{offset:-1,result:r}}return localFromBER(BufferSourceConverter.toUint8Array(n).slice(),0,n.byteLength)}function checkLen(n,r){return n?1:r}class LocalConstructedValueBlock extends ValueBlock{constructor({value:r=[],isIndefiniteForm:_=!1,...E}={}){super(E),this.value=r,this.isIndefiniteForm=_}fromBER(r,_,E){const S=BufferSourceConverter.toUint8Array(r);if(!checkBufferParams(this,S,_,E))return-1;if(this.valueBeforeDecodeView=S.subarray(_,_+E),this.valueBeforeDecodeView.length===0)return this.warnings.push("Zero buffer length"),_;let C=_;for(;checkLen(this.isIndefiniteForm,E)>0;){const A=localFromBER(S,C,E);if(A.offset===-1)return this.error=A.result.error,this.warnings.concat(A.result.warnings),-1;if(C=A.offset,this.blockLength+=A.result.blockLength,E-=A.result.blockLength,this.value.push(A.result),this.isIndefiniteForm&&A.result.constructor.NAME===END_OF_CONTENT_NAME)break}return this.isIndefiniteForm&&(this.value[this.value.length-1].constructor.NAME===END_OF_CONTENT_NAME?this.value.pop():this.warnings.push("No EndOfContent block encoded")),C}toBER(r,_){const E=_||new ViewWriter;for(let S=0;S<this.value.length;S++)this.value[S].toBER(r,E);return _?EMPTY_BUFFER$1:E.final()}toJSON(){const r={...super.toJSON(),isIndefiniteForm:this.isIndefiniteForm,value:[]};for(const _ of this.value)r.value.push(_.toJSON());return r}}LocalConstructedValueBlock.NAME="ConstructedValueBlock";var _a$v;class Constructed extends BaseBlock{constructor(r={}){super(r,LocalConstructedValueBlock),this.idBlock.isConstructed=!0}fromBER(r,_,E){this.valueBlock.isIndefiniteForm=this.lenBlock.isIndefiniteForm;const S=this.valueBlock.fromBER(r,_,this.lenBlock.isIndefiniteForm?E:this.lenBlock.length);return S===-1?(this.error=this.valueBlock.error,S):(this.idBlock.error.length||(this.blockLength+=this.idBlock.blockLength),this.lenBlock.error.length||(this.blockLength+=this.lenBlock.blockLength),this.valueBlock.error.length||(this.blockLength+=this.valueBlock.blockLength),S)}onAsciiEncoding(){const r=[];for(const E of this.valueBlock.value)r.push(E.toString("ascii").split(`
`).map(S=>`  ${S}`).join(`
`));const _=this.idBlock.tagClass===3?`[${this.idBlock.tagNumber}]`:this.constructor.NAME;return r.length?`${_} :
${r.join(`
`)}`:`${_} :`}}_a$v=Constructed;typeStore.Constructed=_a$v;Constructed.NAME="CONSTRUCTED";class LocalEndOfContentValueBlock extends ValueBlock{fromBER(r,_,E){return _}toBER(r){return EMPTY_BUFFER$1}}LocalEndOfContentValueBlock.override="EndOfContentValueBlock";var _a$u;class EndOfContent extends BaseBlock{constructor(r={}){super(r,LocalEndOfContentValueBlock),this.idBlock.tagClass=1,this.idBlock.tagNumber=0}}_a$u=EndOfContent;typeStore.EndOfContent=_a$u;EndOfContent.NAME=END_OF_CONTENT_NAME;var _a$t;class Null extends BaseBlock{constructor(r={}){super(r,ValueBlock),this.idBlock.tagClass=1,this.idBlock.tagNumber=5}fromBER(r,_,E){return this.lenBlock.length>0&&this.warnings.push("Non-zero length of value block for Null type"),this.idBlock.error.length||(this.blockLength+=this.idBlock.blockLength),this.lenBlock.error.length||(this.blockLength+=this.lenBlock.blockLength),this.blockLength+=E,_+E>r.byteLength?(this.error="End of input reached before message was fully decoded (inconsistent offset and length values)",-1):_+E}toBER(r,_){const E=new ArrayBuffer(2);if(!r){const S=new Uint8Array(E);S[0]=5,S[1]=0}return _&&_.write(E),E}onAsciiEncoding(){return`${this.constructor.NAME}`}}_a$t=Null;typeStore.Null=_a$t;Null.NAME="NULL";class LocalBooleanValueBlock extends HexBlock(ValueBlock){constructor({value:r,..._}={}){super(_),_.valueHex?this.valueHexView=BufferSourceConverter.toUint8Array(_.valueHex):this.valueHexView=new Uint8Array(1),r&&(this.value=r)}get value(){for(const r of this.valueHexView)if(r>0)return!0;return!1}set value(r){this.valueHexView[0]=r?255:0}fromBER(r,_,E){const S=BufferSourceConverter.toUint8Array(r);return checkBufferParams(this,S,_,E)?(this.valueHexView=S.subarray(_,_+E),E>1&&this.warnings.push("Boolean value encoded in more then 1 octet"),this.isHexOnly=!0,utilDecodeTC.call(this),this.blockLength=E,_+E):-1}toBER(){return this.valueHexView.slice()}toJSON(){return{...super.toJSON(),value:this.value}}}LocalBooleanValueBlock.NAME="BooleanValueBlock";var _a$s;let Boolean$1=class extends BaseBlock{constructor(r={}){super(r,LocalBooleanValueBlock),this.idBlock.tagClass=1,this.idBlock.tagNumber=1}getValue(){return this.valueBlock.value}setValue(r){this.valueBlock.value=r}onAsciiEncoding(){return`${this.constructor.NAME} : ${this.getValue}`}};_a$s=Boolean$1;typeStore.Boolean=_a$s;Boolean$1.NAME="BOOLEAN";class LocalOctetStringValueBlock extends HexBlock(LocalConstructedValueBlock){constructor({isConstructed:r=!1,..._}={}){super(_),this.isConstructed=r}fromBER(r,_,E){let S=0;if(this.isConstructed){if(this.isHexOnly=!1,S=LocalConstructedValueBlock.prototype.fromBER.call(this,r,_,E),S===-1)return S;for(let C=0;C<this.value.length;C++){const A=this.value[C].constructor.NAME;if(A===END_OF_CONTENT_NAME){if(this.isIndefiniteForm)break;return this.error="EndOfContent is unexpected, OCTET STRING may consists of OCTET STRINGs only",-1}if(A!==OCTET_STRING_NAME)return this.error="OCTET STRING may consists of OCTET STRINGs only",-1}}else this.isHexOnly=!0,S=super.fromBER(r,_,E),this.blockLength=E;return S}toBER(r,_){return this.isConstructed?LocalConstructedValueBlock.prototype.toBER.call(this,r,_):r?new ArrayBuffer(this.valueHexView.byteLength):this.valueHexView.slice().buffer}toJSON(){return{...super.toJSON(),isConstructed:this.isConstructed}}}LocalOctetStringValueBlock.NAME="OctetStringValueBlock";var _a$r;class OctetString extends BaseBlock{constructor({idBlock:r={},lenBlock:_={},...E}={}){var S,C;(S=E.isConstructed)!==null&&S!==void 0||(E.isConstructed=!!(!((C=E.value)===null||C===void 0)&&C.length)),super({idBlock:{isConstructed:E.isConstructed,...r},lenBlock:{..._,isIndefiniteForm:!!E.isIndefiniteForm},...E},LocalOctetStringValueBlock),this.idBlock.tagClass=1,this.idBlock.tagNumber=4}fromBER(r,_,E){if(this.valueBlock.isConstructed=this.idBlock.isConstructed,this.valueBlock.isIndefiniteForm=this.lenBlock.isIndefiniteForm,E===0)return this.idBlock.error.length===0&&(this.blockLength+=this.idBlock.blockLength),this.lenBlock.error.length===0&&(this.blockLength+=this.lenBlock.blockLength),_;if(!this.valueBlock.isConstructed){const C=(r instanceof ArrayBuffer?new Uint8Array(r):r).subarray(_,_+E);try{if(C.byteLength){const A=localFromBER(C,0,C.byteLength);A.offset!==-1&&A.offset===E&&(this.valueBlock.value=[A.result])}}catch{}}return super.fromBER(r,_,E)}onAsciiEncoding(){return this.valueBlock.isConstructed||this.valueBlock.value&&this.valueBlock.value.length?Constructed.prototype.onAsciiEncoding.call(this):`${this.constructor.NAME} : ${Convert.ToHex(this.valueBlock.valueHexView)}`}getValue(){if(!this.idBlock.isConstructed)return this.valueBlock.valueHexView.slice().buffer;const r=[];for(const _ of this.valueBlock.value)_ instanceof OctetString&&r.push(_.valueBlock.valueHexView);return BufferSourceConverter.concat(r)}}_a$r=OctetString;typeStore.OctetString=_a$r;OctetString.NAME=OCTET_STRING_NAME;class LocalBitStringValueBlock extends HexBlock(LocalConstructedValueBlock){constructor({unusedBits:r=0,isConstructed:_=!1,...E}={}){super(E),this.unusedBits=r,this.isConstructed=_,this.blockLength=this.valueHexView.byteLength}fromBER(r,_,E){if(!E)return _;let S=-1;if(this.isConstructed){if(S=LocalConstructedValueBlock.prototype.fromBER.call(this,r,_,E),S===-1)return S;for(const I of this.value){const B=I.constructor.NAME;if(B===END_OF_CONTENT_NAME){if(this.isIndefiniteForm)break;return this.error="EndOfContent is unexpected, BIT STRING may consists of BIT STRINGs only",-1}if(B!==BIT_STRING_NAME)return this.error="BIT STRING may consists of BIT STRINGs only",-1;const O=I.valueBlock;if(this.unusedBits>0&&O.unusedBits>0)return this.error='Using of "unused bits" inside constructive BIT STRING allowed for least one only',-1;this.unusedBits=O.unusedBits}return S}const C=BufferSourceConverter.toUint8Array(r);if(!checkBufferParams(this,C,_,E))return-1;const A=C.subarray(_,_+E);if(this.unusedBits=A[0],this.unusedBits>7)return this.error="Unused bits for BitString must be in range 0-7",-1;if(!this.unusedBits){const I=A.subarray(1);try{if(I.byteLength){const B=localFromBER(I,0,I.byteLength);B.offset!==-1&&B.offset===E-1&&(this.value=[B.result])}}catch{}}return this.valueHexView=A.subarray(1),this.blockLength=A.length,_+E}toBER(r,_){if(this.isConstructed)return LocalConstructedValueBlock.prototype.toBER.call(this,r,_);if(r)return new ArrayBuffer(this.valueHexView.byteLength+1);if(!this.valueHexView.byteLength)return EMPTY_BUFFER$1;const E=new Uint8Array(this.valueHexView.length+1);return E[0]=this.unusedBits,E.set(this.valueHexView,1),E.buffer}toJSON(){return{...super.toJSON(),unusedBits:this.unusedBits,isConstructed:this.isConstructed}}}LocalBitStringValueBlock.NAME="BitStringValueBlock";var _a$q;class BitString extends BaseBlock{constructor({idBlock:r={},lenBlock:_={},...E}={}){var S,C;(S=E.isConstructed)!==null&&S!==void 0||(E.isConstructed=!!(!((C=E.value)===null||C===void 0)&&C.length)),super({idBlock:{isConstructed:E.isConstructed,...r},lenBlock:{..._,isIndefiniteForm:!!E.isIndefiniteForm},...E},LocalBitStringValueBlock),this.idBlock.tagClass=1,this.idBlock.tagNumber=3}fromBER(r,_,E){return this.valueBlock.isConstructed=this.idBlock.isConstructed,this.valueBlock.isIndefiniteForm=this.lenBlock.isIndefiniteForm,super.fromBER(r,_,E)}onAsciiEncoding(){if(this.valueBlock.isConstructed||this.valueBlock.value&&this.valueBlock.value.length)return Constructed.prototype.onAsciiEncoding.call(this);{const r=[],_=this.valueBlock.valueHexView;for(const S of _)r.push(S.toString(2).padStart(8,"0"));const E=r.join("");return`${this.constructor.NAME} : ${E.substring(0,E.length-this.valueBlock.unusedBits)}`}}}_a$q=BitString;typeStore.BitString=_a$q;BitString.NAME=BIT_STRING_NAME;var _a$p;function viewAdd(n,r){const _=new Uint8Array([0]),E=new Uint8Array(n),S=new Uint8Array(r);let C=E.slice(0);const A=C.length-1,I=S.slice(0),B=I.length-1;let O=0;const N=B<A?A:B;let U=0;for(let j=N;j>=0;j--,U++){switch(!0){case U<I.length:O=C[A-U]+I[B-U]+_[0];break;default:O=C[A-U]+_[0]}switch(_[0]=O/10,!0){case U>=C.length:C=utilConcatView(new Uint8Array([O%10]),C);break;default:C[A-U]=O%10}}return _[0]>0&&(C=utilConcatView(_,C)),C}function power2(n){if(n>=powers2.length)for(let r=powers2.length;r<=n;r++){const _=new Uint8Array([0]);let E=powers2[r-1].slice(0);for(let S=E.length-1;S>=0;S--){const C=new Uint8Array([(E[S]<<1)+_[0]]);_[0]=C[0]/10,E[S]=C[0]%10}_[0]>0&&(E=utilConcatView(_,E)),powers2.push(E)}return powers2[n]}function viewSub(n,r){let _=0;const E=new Uint8Array(n),S=new Uint8Array(r),C=E.slice(0),A=C.length-1,I=S.slice(0),B=I.length-1;let O,N=0;for(let U=B;U>=0;U--,N++)switch(O=C[A-N]-I[B-N]-_,!0){case O<0:_=1,C[A-N]=O+10;break;default:_=0,C[A-N]=O}if(_>0)for(let U=A-B+1;U>=0;U--,N++)if(O=C[A-N]-_,O<0)_=1,C[A-N]=O+10;else{_=0,C[A-N]=O;break}return C.slice()}class LocalIntegerValueBlock extends HexBlock(ValueBlock){constructor({value:r,..._}={}){super(_),this._valueDec=0,_.valueHex&&this.setValueHex(),r!==void 0&&(this.valueDec=r)}setValueHex(){this.valueHexView.length>=4?(this.warnings.push("Too big Integer for decoding, hex only"),this.isHexOnly=!0,this._valueDec=0):(this.isHexOnly=!1,this.valueHexView.length>0&&(this._valueDec=utilDecodeTC.call(this)))}set valueDec(r){this._valueDec=r,this.isHexOnly=!1,this.valueHexView=new Uint8Array(utilEncodeTC(r))}get valueDec(){return this._valueDec}fromDER(r,_,E,S=0){const C=this.fromBER(r,_,E);if(C===-1)return C;const A=this.valueHexView;return A[0]===0&&A[1]&128?this.valueHexView=A.subarray(1):S!==0&&A.length<S&&(S-A.length>1&&(S=A.length+1),this.valueHexView=A.subarray(S-A.length)),C}toDER(r=!1){const _=this.valueHexView;switch(!0){case(_[0]&128)!==0:{const E=new Uint8Array(this.valueHexView.length+1);E[0]=0,E.set(_,1),this.valueHexView=E}break;case(_[0]===0&&(_[1]&128)===0):this.valueHexView=this.valueHexView.subarray(1);break}return this.toBER(r)}fromBER(r,_,E){const S=super.fromBER(r,_,E);return S===-1||this.setValueHex(),S}toBER(r){return r?new ArrayBuffer(this.valueHexView.length):this.valueHexView.slice().buffer}toJSON(){return{...super.toJSON(),valueDec:this.valueDec}}toString(){const r=this.valueHexView.length*8-1;let _=new Uint8Array(this.valueHexView.length*8/3),E=0,S;const C=this.valueHexView;let A="",I=!1;for(let B=C.byteLength-1;B>=0;B--){S=C[B];for(let O=0;O<8;O++){if((S&1)===1)switch(E){case r:_=viewSub(power2(E),_),A="-";break;default:_=viewAdd(_,power2(E))}E++,S>>=1}}for(let B=0;B<_.length;B++)_[B]&&(I=!0),I&&(A+=digitsString.charAt(_[B]));return I===!1&&(A+=digitsString.charAt(0)),A}}_a$p=LocalIntegerValueBlock;LocalIntegerValueBlock.NAME="IntegerValueBlock";Object.defineProperty(_a$p.prototype,"valueHex",{set:function(n){this.valueHexView=new Uint8Array(n),this.setValueHex()},get:function(){return this.valueHexView.slice().buffer}});var _a$o;class Integer extends BaseBlock{constructor(r={}){super(r,LocalIntegerValueBlock),this.idBlock.tagClass=1,this.idBlock.tagNumber=2}toBigInt(){return assertBigInt(),BigInt(this.valueBlock.toString())}static fromBigInt(r){assertBigInt();const _=BigInt(r),E=new ViewWriter,S=_.toString(16).replace(/^-/,""),C=new Uint8Array(Convert.FromHex(S));if(_<0){const I=new Uint8Array(C.length+(C[0]&128?1:0));I[0]|=128;const O=BigInt(`0x${Convert.ToHex(I)}`)+_,N=BufferSourceConverter.toUint8Array(Convert.FromHex(O.toString(16)));N[0]|=128,E.write(N)}else C[0]&128&&E.write(new Uint8Array([0])),E.write(C);return new Integer({valueHex:E.final()})}convertToDER(){const r=new Integer({valueHex:this.valueBlock.valueHexView});return r.valueBlock.toDER(),r}convertFromDER(){return new Integer({valueHex:this.valueBlock.valueHexView[0]===0?this.valueBlock.valueHexView.subarray(1):this.valueBlock.valueHexView})}onAsciiEncoding(){return`${this.constructor.NAME} : ${this.valueBlock.toString()}`}}_a$o=Integer;typeStore.Integer=_a$o;Integer.NAME="INTEGER";var _a$n;class Enumerated extends Integer{constructor(r={}){super(r),this.idBlock.tagClass=1,this.idBlock.tagNumber=10}}_a$n=Enumerated;typeStore.Enumerated=_a$n;Enumerated.NAME="ENUMERATED";class LocalSidValueBlock extends HexBlock(ValueBlock){constructor({valueDec:r=-1,isFirstSid:_=!1,...E}={}){super(E),this.valueDec=r,this.isFirstSid=_}fromBER(r,_,E){if(!E)return _;const S=BufferSourceConverter.toUint8Array(r);if(!checkBufferParams(this,S,_,E))return-1;const C=S.subarray(_,_+E);this.valueHexView=new Uint8Array(E);for(let I=0;I<E&&(this.valueHexView[I]=C[I]&127,this.blockLength++,!!(C[I]&128));I++);const A=new Uint8Array(this.blockLength);for(let I=0;I<this.blockLength;I++)A[I]=this.valueHexView[I];return this.valueHexView=A,C[this.blockLength-1]&128?(this.error="End of input reached before message was fully decoded",-1):(this.valueHexView[0]===0&&this.warnings.push("Needlessly long format of SID encoding"),this.blockLength<=8?this.valueDec=utilFromBase(this.valueHexView,7):(this.isHexOnly=!0,this.warnings.push("Too big SID for decoding, hex only")),_+this.blockLength)}set valueBigInt(r){assertBigInt();let _=BigInt(r).toString(2);for(;_.length%7;)_="0"+_;const E=new Uint8Array(_.length/7);for(let S=0;S<E.length;S++)E[S]=parseInt(_.slice(S*7,S*7+7),2)+(S+1<E.length?128:0);this.fromBER(E.buffer,0,E.length)}toBER(r){if(this.isHexOnly){if(r)return new ArrayBuffer(this.valueHexView.byteLength);const S=this.valueHexView,C=new Uint8Array(this.blockLength);for(let A=0;A<this.blockLength-1;A++)C[A]=S[A]|128;return C[this.blockLength-1]=S[this.blockLength-1],C.buffer}const _=utilToBase(this.valueDec,7);if(_.byteLength===0)return this.error="Error during encoding SID value",EMPTY_BUFFER$1;const E=new Uint8Array(_.byteLength);if(!r){const S=new Uint8Array(_),C=_.byteLength-1;for(let A=0;A<C;A++)E[A]=S[A]|128;E[C]=S[C]}return E}toString(){let r="";if(this.isHexOnly)r=Convert.ToHex(this.valueHexView);else if(this.isFirstSid){let _=this.valueDec;this.valueDec<=39?r="0.":this.valueDec<=79?(r="1.",_-=40):(r="2.",_-=80),r+=_.toString()}else r=this.valueDec.toString();return r}toJSON(){return{...super.toJSON(),valueDec:this.valueDec,isFirstSid:this.isFirstSid}}}LocalSidValueBlock.NAME="sidBlock";class LocalObjectIdentifierValueBlock extends ValueBlock{constructor({value:r=EMPTY_STRING,..._}={}){super(_),this.value=[],r&&this.fromString(r)}fromBER(r,_,E){let S=_;for(;E>0;){const C=new LocalSidValueBlock;if(S=C.fromBER(r,S,E),S===-1)return this.blockLength=0,this.error=C.error,S;this.value.length===0&&(C.isFirstSid=!0),this.blockLength+=C.blockLength,E-=C.blockLength,this.value.push(C)}return S}toBER(r){const _=[];for(let E=0;E<this.value.length;E++){const S=this.value[E].toBER(r);if(S.byteLength===0)return this.error=this.value[E].error,EMPTY_BUFFER$1;_.push(S)}return concat$3(_)}fromString(r){this.value=[];let _=0,E=0,S="",C=!1;do if(E=r.indexOf(".",_),E===-1?S=r.substring(_):S=r.substring(_,E),_=E+1,C){const A=this.value[0];let I=0;switch(A.valueDec){case 0:break;case 1:I=40;break;case 2:I=80;break;default:this.value=[];return}const B=parseInt(S,10);if(isNaN(B))return;A.valueDec=B+I,C=!1}else{const A=new LocalSidValueBlock;if(S>Number.MAX_SAFE_INTEGER){assertBigInt();const I=BigInt(S);A.valueBigInt=I}else if(A.valueDec=parseInt(S,10),isNaN(A.valueDec))return;this.value.length||(A.isFirstSid=!0,C=!0),this.value.push(A)}while(E!==-1)}toString(){let r="",_=!1;for(let E=0;E<this.value.length;E++){_=this.value[E].isHexOnly;let S=this.value[E].toString();E!==0&&(r=`${r}.`),_?(S=`{${S}}`,this.value[E].isFirstSid?r=`2.{${S} - 80}`:r+=S):r+=S}return r}toJSON(){const r={...super.toJSON(),value:this.toString(),sidArray:[]};for(let _=0;_<this.value.length;_++)r.sidArray.push(this.value[_].toJSON());return r}}LocalObjectIdentifierValueBlock.NAME="ObjectIdentifierValueBlock";var _a$m;class ObjectIdentifier extends BaseBlock{constructor(r={}){super(r,LocalObjectIdentifierValueBlock),this.idBlock.tagClass=1,this.idBlock.tagNumber=6}getValue(){return this.valueBlock.toString()}setValue(r){this.valueBlock.fromString(r)}onAsciiEncoding(){return`${this.constructor.NAME} : ${this.valueBlock.toString()||"empty"}`}toJSON(){return{...super.toJSON(),value:this.getValue()}}}_a$m=ObjectIdentifier;typeStore.ObjectIdentifier=_a$m;ObjectIdentifier.NAME="OBJECT IDENTIFIER";class LocalRelativeSidValueBlock extends HexBlock(LocalBaseBlock){constructor({valueDec:r=0,..._}={}){super(_),this.valueDec=r}fromBER(r,_,E){if(E===0)return _;const S=BufferSourceConverter.toUint8Array(r);if(!checkBufferParams(this,S,_,E))return-1;const C=S.subarray(_,_+E);this.valueHexView=new Uint8Array(E);for(let I=0;I<E&&(this.valueHexView[I]=C[I]&127,this.blockLength++,!!(C[I]&128));I++);const A=new Uint8Array(this.blockLength);for(let I=0;I<this.blockLength;I++)A[I]=this.valueHexView[I];return this.valueHexView=A,C[this.blockLength-1]&128?(this.error="End of input reached before message was fully decoded",-1):(this.valueHexView[0]===0&&this.warnings.push("Needlessly long format of SID encoding"),this.blockLength<=8?this.valueDec=utilFromBase(this.valueHexView,7):(this.isHexOnly=!0,this.warnings.push("Too big SID for decoding, hex only")),_+this.blockLength)}toBER(r){if(this.isHexOnly){if(r)return new ArrayBuffer(this.valueHexView.byteLength);const S=this.valueHexView,C=new Uint8Array(this.blockLength);for(let A=0;A<this.blockLength-1;A++)C[A]=S[A]|128;return C[this.blockLength-1]=S[this.blockLength-1],C.buffer}const _=utilToBase(this.valueDec,7);if(_.byteLength===0)return this.error="Error during encoding SID value",EMPTY_BUFFER$1;const E=new Uint8Array(_.byteLength);if(!r){const S=new Uint8Array(_),C=_.byteLength-1;for(let A=0;A<C;A++)E[A]=S[A]|128;E[C]=S[C]}return E.buffer}toString(){let r="";return this.isHexOnly?r=Convert.ToHex(this.valueHexView):r=this.valueDec.toString(),r}toJSON(){return{...super.toJSON(),valueDec:this.valueDec}}}LocalRelativeSidValueBlock.NAME="relativeSidBlock";class LocalRelativeObjectIdentifierValueBlock extends ValueBlock{constructor({value:r=EMPTY_STRING,..._}={}){super(_),this.value=[],r&&this.fromString(r)}fromBER(r,_,E){let S=_;for(;E>0;){const C=new LocalRelativeSidValueBlock;if(S=C.fromBER(r,S,E),S===-1)return this.blockLength=0,this.error=C.error,S;this.blockLength+=C.blockLength,E-=C.blockLength,this.value.push(C)}return S}toBER(r,_){const E=[];for(let S=0;S<this.value.length;S++){const C=this.value[S].toBER(r);if(C.byteLength===0)return this.error=this.value[S].error,EMPTY_BUFFER$1;E.push(C)}return concat$3(E)}fromString(r){this.value=[];let _=0,E=0,S="";do{E=r.indexOf(".",_),E===-1?S=r.substring(_):S=r.substring(_,E),_=E+1;const C=new LocalRelativeSidValueBlock;if(C.valueDec=parseInt(S,10),isNaN(C.valueDec))return!0;this.value.push(C)}while(E!==-1);return!0}toString(){let r="",_=!1;for(let E=0;E<this.value.length;E++){_=this.value[E].isHexOnly;let S=this.value[E].toString();E!==0&&(r=`${r}.`),_&&(S=`{${S}}`),r+=S}return r}toJSON(){const r={...super.toJSON(),value:this.toString(),sidArray:[]};for(let _=0;_<this.value.length;_++)r.sidArray.push(this.value[_].toJSON());return r}}LocalRelativeObjectIdentifierValueBlock.NAME="RelativeObjectIdentifierValueBlock";var _a$l;class RelativeObjectIdentifier extends BaseBlock{constructor(r={}){super(r,LocalRelativeObjectIdentifierValueBlock),this.idBlock.tagClass=1,this.idBlock.tagNumber=13}getValue(){return this.valueBlock.toString()}setValue(r){this.valueBlock.fromString(r)}onAsciiEncoding(){return`${this.constructor.NAME} : ${this.valueBlock.toString()||"empty"}`}toJSON(){return{...super.toJSON(),value:this.getValue()}}}_a$l=RelativeObjectIdentifier;typeStore.RelativeObjectIdentifier=_a$l;RelativeObjectIdentifier.NAME="RelativeObjectIdentifier";var _a$k;class Sequence extends Constructed{constructor(r={}){super(r),this.idBlock.tagClass=1,this.idBlock.tagNumber=16}}_a$k=Sequence;typeStore.Sequence=_a$k;Sequence.NAME="SEQUENCE";var _a$j;let Set$1=class extends Constructed{constructor(r={}){super(r),this.idBlock.tagClass=1,this.idBlock.tagNumber=17}};_a$j=Set$1;typeStore.Set=_a$j;Set$1.NAME="SET";class LocalStringValueBlock extends HexBlock(ValueBlock){constructor({...r}={}){super(r),this.isHexOnly=!0,this.value=EMPTY_STRING}toJSON(){return{...super.toJSON(),value:this.value}}}LocalStringValueBlock.NAME="StringValueBlock";class LocalSimpleStringValueBlock extends LocalStringValueBlock{}LocalSimpleStringValueBlock.NAME="SimpleStringValueBlock";class LocalSimpleStringBlock extends BaseStringBlock{constructor({...r}={}){super(r,LocalSimpleStringValueBlock)}fromBuffer(r){this.valueBlock.value=String.fromCharCode.apply(null,BufferSourceConverter.toUint8Array(r))}fromString(r){const _=r.length,E=this.valueBlock.valueHexView=new Uint8Array(_);for(let S=0;S<_;S++)E[S]=r.charCodeAt(S);this.valueBlock.value=r}}LocalSimpleStringBlock.NAME="SIMPLE STRING";class LocalUtf8StringValueBlock extends LocalSimpleStringBlock{fromBuffer(r){this.valueBlock.valueHexView=BufferSourceConverter.toUint8Array(r);try{this.valueBlock.value=Convert.ToUtf8String(r)}catch(_){this.warnings.push(`Error during "decodeURIComponent": ${_}, using raw string`),this.valueBlock.value=Convert.ToBinary(r)}}fromString(r){this.valueBlock.valueHexView=new Uint8Array(Convert.FromUtf8String(r)),this.valueBlock.value=r}}LocalUtf8StringValueBlock.NAME="Utf8StringValueBlock";var _a$i;class Utf8String extends LocalUtf8StringValueBlock{constructor(r={}){super(r),this.idBlock.tagClass=1,this.idBlock.tagNumber=12}}_a$i=Utf8String;typeStore.Utf8String=_a$i;Utf8String.NAME="UTF8String";class LocalBmpStringValueBlock extends LocalSimpleStringBlock{fromBuffer(r){this.valueBlock.value=Convert.ToUtf16String(r),this.valueBlock.valueHexView=BufferSourceConverter.toUint8Array(r)}fromString(r){this.valueBlock.value=r,this.valueBlock.valueHexView=new Uint8Array(Convert.FromUtf16String(r))}}LocalBmpStringValueBlock.NAME="BmpStringValueBlock";var _a$h;class BmpString extends LocalBmpStringValueBlock{constructor({...r}={}){super(r),this.idBlock.tagClass=1,this.idBlock.tagNumber=30}}_a$h=BmpString;typeStore.BmpString=_a$h;BmpString.NAME="BMPString";class LocalUniversalStringValueBlock extends LocalSimpleStringBlock{fromBuffer(r){const _=ArrayBuffer.isView(r)?r.slice().buffer:r.slice(0),E=new Uint8Array(_);for(let S=0;S<E.length;S+=4)E[S]=E[S+3],E[S+1]=E[S+2],E[S+2]=0,E[S+3]=0;this.valueBlock.value=String.fromCharCode.apply(null,new Uint32Array(_))}fromString(r){const _=r.length,E=this.valueBlock.valueHexView=new Uint8Array(_*4);for(let S=0;S<_;S++){const C=utilToBase(r.charCodeAt(S),8),A=new Uint8Array(C);if(A.length>4)continue;const I=4-A.length;for(let B=A.length-1;B>=0;B--)E[S*4+B+I]=A[B]}this.valueBlock.value=r}}LocalUniversalStringValueBlock.NAME="UniversalStringValueBlock";var _a$g;class UniversalString extends LocalUniversalStringValueBlock{constructor({...r}={}){super(r),this.idBlock.tagClass=1,this.idBlock.tagNumber=28}}_a$g=UniversalString;typeStore.UniversalString=_a$g;UniversalString.NAME="UniversalString";var _a$f;class NumericString extends LocalSimpleStringBlock{constructor(r={}){super(r),this.idBlock.tagClass=1,this.idBlock.tagNumber=18}}_a$f=NumericString;typeStore.NumericString=_a$f;NumericString.NAME="NumericString";var _a$e;class PrintableString extends LocalSimpleStringBlock{constructor(r={}){super(r),this.idBlock.tagClass=1,this.idBlock.tagNumber=19}}_a$e=PrintableString;typeStore.PrintableString=_a$e;PrintableString.NAME="PrintableString";var _a$d;class TeletexString extends LocalSimpleStringBlock{constructor(r={}){super(r),this.idBlock.tagClass=1,this.idBlock.tagNumber=20}}_a$d=TeletexString;typeStore.TeletexString=_a$d;TeletexString.NAME="TeletexString";var _a$c;class VideotexString extends LocalSimpleStringBlock{constructor(r={}){super(r),this.idBlock.tagClass=1,this.idBlock.tagNumber=21}}_a$c=VideotexString;typeStore.VideotexString=_a$c;VideotexString.NAME="VideotexString";var _a$b;class IA5String extends LocalSimpleStringBlock{constructor(r={}){super(r),this.idBlock.tagClass=1,this.idBlock.tagNumber=22}}_a$b=IA5String;typeStore.IA5String=_a$b;IA5String.NAME="IA5String";var _a$a;class GraphicString extends LocalSimpleStringBlock{constructor(r={}){super(r),this.idBlock.tagClass=1,this.idBlock.tagNumber=25}}_a$a=GraphicString;typeStore.GraphicString=_a$a;GraphicString.NAME="GraphicString";var _a$9;class VisibleString extends LocalSimpleStringBlock{constructor(r={}){super(r),this.idBlock.tagClass=1,this.idBlock.tagNumber=26}}_a$9=VisibleString;typeStore.VisibleString=_a$9;VisibleString.NAME="VisibleString";var _a$8;class GeneralString extends LocalSimpleStringBlock{constructor(r={}){super(r),this.idBlock.tagClass=1,this.idBlock.tagNumber=27}}_a$8=GeneralString;typeStore.GeneralString=_a$8;GeneralString.NAME="GeneralString";var _a$7;class CharacterString extends LocalSimpleStringBlock{constructor(r={}){super(r),this.idBlock.tagClass=1,this.idBlock.tagNumber=29}}_a$7=CharacterString;typeStore.CharacterString=_a$7;CharacterString.NAME="CharacterString";var _a$6;class UTCTime extends VisibleString{constructor({value:r,valueDate:_,...E}={}){if(super(E),this.year=0,this.month=0,this.day=0,this.hour=0,this.minute=0,this.second=0,r){this.fromString(r),this.valueBlock.valueHexView=new Uint8Array(r.length);for(let S=0;S<r.length;S++)this.valueBlock.valueHexView[S]=r.charCodeAt(S)}_&&(this.fromDate(_),this.valueBlock.valueHexView=new Uint8Array(this.toBuffer())),this.idBlock.tagClass=1,this.idBlock.tagNumber=23}fromBuffer(r){this.fromString(String.fromCharCode.apply(null,BufferSourceConverter.toUint8Array(r)))}toBuffer(){const r=this.toString(),_=new ArrayBuffer(r.length),E=new Uint8Array(_);for(let S=0;S<r.length;S++)E[S]=r.charCodeAt(S);return _}fromDate(r){this.year=r.getUTCFullYear(),this.month=r.getUTCMonth()+1,this.day=r.getUTCDate(),this.hour=r.getUTCHours(),this.minute=r.getUTCMinutes(),this.second=r.getUTCSeconds()}toDate(){return new Date(Date.UTC(this.year,this.month-1,this.day,this.hour,this.minute,this.second))}fromString(r){const E=/(\d{2})(\d{2})(\d{2})(\d{2})(\d{2})(\d{2})Z/ig.exec(r);if(E===null){this.error="Wrong input string for conversion";return}const S=parseInt(E[1],10);S>=50?this.year=1900+S:this.year=2e3+S,this.month=parseInt(E[2],10),this.day=parseInt(E[3],10),this.hour=parseInt(E[4],10),this.minute=parseInt(E[5],10),this.second=parseInt(E[6],10)}toString(r="iso"){if(r==="iso"){const _=new Array(7);return _[0]=padNumber(this.year<2e3?this.year-1900:this.year-2e3,2),_[1]=padNumber(this.month,2),_[2]=padNumber(this.day,2),_[3]=padNumber(this.hour,2),_[4]=padNumber(this.minute,2),_[5]=padNumber(this.second,2),_[6]="Z",_.join("")}return super.toString(r)}onAsciiEncoding(){return`${this.constructor.NAME} : ${this.toDate().toISOString()}`}toJSON(){return{...super.toJSON(),year:this.year,month:this.month,day:this.day,hour:this.hour,minute:this.minute,second:this.second}}}_a$6=UTCTime;typeStore.UTCTime=_a$6;UTCTime.NAME="UTCTime";var _a$5;class GeneralizedTime extends UTCTime{constructor(r={}){var _;super(r),(_=this.millisecond)!==null&&_!==void 0||(this.millisecond=0),this.idBlock.tagClass=1,this.idBlock.tagNumber=24}fromDate(r){super.fromDate(r),this.millisecond=r.getUTCMilliseconds()}toDate(){return new Date(Date.UTC(this.year,this.month-1,this.day,this.hour,this.minute,this.second,this.millisecond))}fromString(r){let _=!1,E="",S="",C=0,A,I=0,B=0;if(r[r.length-1]==="Z")E=r.substring(0,r.length-1),_=!0;else{const U=new Number(r[r.length-1]);if(isNaN(U.valueOf()))throw new Error("Wrong input string for conversion");E=r}if(_){if(E.indexOf("+")!==-1)throw new Error("Wrong input string for conversion");if(E.indexOf("-")!==-1)throw new Error("Wrong input string for conversion")}else{let U=1,j=E.indexOf("+"),z="";if(j===-1&&(j=E.indexOf("-"),U=-1),j!==-1){if(z=E.substring(j+1),E=E.substring(0,j),z.length!==2&&z.length!==4)throw new Error("Wrong input string for conversion");let Z=parseInt(z.substring(0,2),10);if(isNaN(Z.valueOf()))throw new Error("Wrong input string for conversion");if(I=U*Z,z.length===4){if(Z=parseInt(z.substring(2,4),10),isNaN(Z.valueOf()))throw new Error("Wrong input string for conversion");B=U*Z}}}let O=E.indexOf(".");if(O===-1&&(O=E.indexOf(",")),O!==-1){const U=new Number(`0${E.substring(O)}`);if(isNaN(U.valueOf()))throw new Error("Wrong input string for conversion");C=U.valueOf(),S=E.substring(0,O)}else S=E;switch(!0){case S.length===8:if(A=/(\d{4})(\d{2})(\d{2})/ig,O!==-1)throw new Error("Wrong input string for conversion");break;case S.length===10:if(A=/(\d{4})(\d{2})(\d{2})(\d{2})/ig,O!==-1){let U=60*C;this.minute=Math.floor(U),U=60*(U-this.minute),this.second=Math.floor(U),U=1e3*(U-this.second),this.millisecond=Math.floor(U)}break;case S.length===12:if(A=/(\d{4})(\d{2})(\d{2})(\d{2})(\d{2})/ig,O!==-1){let U=60*C;this.second=Math.floor(U),U=1e3*(U-this.second),this.millisecond=Math.floor(U)}break;case S.length===14:if(A=/(\d{4})(\d{2})(\d{2})(\d{2})(\d{2})(\d{2})/ig,O!==-1){const U=1e3*C;this.millisecond=Math.floor(U)}break;default:throw new Error("Wrong input string for conversion")}const N=A.exec(S);if(N===null)throw new Error("Wrong input string for conversion");for(let U=1;U<N.length;U++)switch(U){case 1:this.year=parseInt(N[U],10);break;case 2:this.month=parseInt(N[U],10);break;case 3:this.day=parseInt(N[U],10);break;case 4:this.hour=parseInt(N[U],10)+I;break;case 5:this.minute=parseInt(N[U],10)+B;break;case 6:this.second=parseInt(N[U],10);break;default:throw new Error("Wrong input string for conversion")}if(_===!1){const U=new Date(this.year,this.month,this.day,this.hour,this.minute,this.second,this.millisecond);this.year=U.getUTCFullYear(),this.month=U.getUTCMonth(),this.day=U.getUTCDay(),this.hour=U.getUTCHours(),this.minute=U.getUTCMinutes(),this.second=U.getUTCSeconds(),this.millisecond=U.getUTCMilliseconds()}}toString(r="iso"){if(r==="iso"){const _=[];return _.push(padNumber(this.year,4)),_.push(padNumber(this.month,2)),_.push(padNumber(this.day,2)),_.push(padNumber(this.hour,2)),_.push(padNumber(this.minute,2)),_.push(padNumber(this.second,2)),this.millisecond!==0&&(_.push("."),_.push(padNumber(this.millisecond,3))),_.push("Z"),_.join("")}return super.toString(r)}toJSON(){return{...super.toJSON(),millisecond:this.millisecond}}}_a$5=GeneralizedTime;typeStore.GeneralizedTime=_a$5;GeneralizedTime.NAME="GeneralizedTime";var _a$4;class DATE extends Utf8String{constructor(r={}){super(r),this.idBlock.tagClass=1,this.idBlock.tagNumber=31}}_a$4=DATE;typeStore.DATE=_a$4;DATE.NAME="DATE";var _a$3;class TimeOfDay extends Utf8String{constructor(r={}){super(r),this.idBlock.tagClass=1,this.idBlock.tagNumber=32}}_a$3=TimeOfDay;typeStore.TimeOfDay=_a$3;TimeOfDay.NAME="TimeOfDay";var _a$2;class DateTime extends Utf8String{constructor(r={}){super(r),this.idBlock.tagClass=1,this.idBlock.tagNumber=33}}_a$2=DateTime;typeStore.DateTime=_a$2;DateTime.NAME="DateTime";var _a$1;class Duration extends Utf8String{constructor(r={}){super(r),this.idBlock.tagClass=1,this.idBlock.tagNumber=34}}_a$1=Duration;typeStore.Duration=_a$1;Duration.NAME="Duration";var _a;class TIME extends Utf8String{constructor(r={}){super(r),this.idBlock.tagClass=1,this.idBlock.tagNumber=14}}_a=TIME;typeStore.TIME=_a;TIME.NAME="TIME";function pkcs1ToJwk$1(n){const{result:r}=fromBER(n),_=r.valueBlock.value;return{n:toString$4(bnToBuf(_[1].toBigInt()),"base64url"),e:toString$4(bnToBuf(_[2].toBigInt()),"base64url"),d:toString$4(bnToBuf(_[3].toBigInt()),"base64url"),p:toString$4(bnToBuf(_[4].toBigInt()),"base64url"),q:toString$4(bnToBuf(_[5].toBigInt()),"base64url"),dp:toString$4(bnToBuf(_[6].toBigInt()),"base64url"),dq:toString$4(bnToBuf(_[7].toBigInt()),"base64url"),qi:toString$4(bnToBuf(_[8].toBigInt()),"base64url"),kty:"RSA",alg:"RS256"}}function jwkToPkcs1$1(n){if(n.n==null||n.e==null||n.d==null||n.p==null||n.q==null||n.dp==null||n.dq==null||n.qi==null)throw new CodeError$4("JWK was missing components","ERR_INVALID_PARAMETERS");const _=new Sequence({value:[new Integer({value:0}),Integer.fromBigInt(bufToBn(fromString$3(n.n,"base64url"))),Integer.fromBigInt(bufToBn(fromString$3(n.e,"base64url"))),Integer.fromBigInt(bufToBn(fromString$3(n.d,"base64url"))),Integer.fromBigInt(bufToBn(fromString$3(n.p,"base64url"))),Integer.fromBigInt(bufToBn(fromString$3(n.q,"base64url"))),Integer.fromBigInt(bufToBn(fromString$3(n.dp,"base64url"))),Integer.fromBigInt(bufToBn(fromString$3(n.dq,"base64url"))),Integer.fromBigInt(bufToBn(fromString$3(n.qi,"base64url")))]}).toBER();return new Uint8Array(_,0,_.byteLength)}function pkixToJwk$1(n){const{result:r}=fromBER(n),_=r.valueBlock.value[1].valueBlock.value[0].valueBlock.value;return{kty:"RSA",n:toString$4(bnToBuf(_[0].toBigInt()),"base64url"),e:toString$4(bnToBuf(_[1].toBigInt()),"base64url")}}function jwkToPkix$1(n){if(n.n==null||n.e==null)throw new CodeError$4("JWK was missing components","ERR_INVALID_PARAMETERS");const _=new Sequence({value:[new Sequence({value:[new ObjectIdentifier({value:"1.2.840.113549.1.1.1"}),new Null]}),new BitString({valueHex:new Sequence({value:[Integer.fromBigInt(bufToBn(fromString$3(n.n,"base64url"))),Integer.fromBigInt(bufToBn(fromString$3(n.e,"base64url")))]}).toBER()})]}).toBER();return new Uint8Array(_,0,_.byteLength)}function bnToBuf(n){let r=n.toString(16);r.length%2>0&&(r=`0${r}`);const _=r.length/2,E=new Uint8Array(_);let S=0,C=0;for(;S<_;)E[S]=parseInt(r.slice(C,C+2),16),S+=1,C+=2;return E}function bufToBn(n){const r=[];return n.forEach(function(_){let E=_.toString(16);E.length%2>0&&(E=`0${E}`),r.push(E)}),BigInt("0x"+r.join(""))}const SALT_LENGTH=16,KEY_SIZE=32,ITERATIONS=1e4;async function exportToPem(n,r){const _=webcrypto$1.get(),S=new Sequence({value:[new Integer({value:0}),new Sequence({value:[new ObjectIdentifier({value:"1.2.840.113549.1.1.1"}),new Null]}),new OctetString({valueHex:n.marshal()})]}).toBER(),C=new Uint8Array(S,0,S.byteLength),A=randomBytes$1(SALT_LENGTH),I=await pbkdf2Async(sha512$1,r,A,{c:ITERATIONS,dkLen:KEY_SIZE}),B=randomBytes$1(16),O=await _.subtle.importKey("raw",I,"AES-CBC",!1,["encrypt"]),N=await _.subtle.encrypt({name:"AES-CBC",iv:B},O,C),U=new Sequence({value:[new OctetString({valueHex:A}),new Integer({value:ITERATIONS}),new Integer({value:KEY_SIZE}),new Sequence({value:[new ObjectIdentifier({value:"1.2.840.113549.2.11"}),new Null]})]}),j=new Sequence({value:[new ObjectIdentifier({value:"1.2.840.113549.1.5.13"}),new Sequence({value:[new Sequence({value:[new ObjectIdentifier({value:"1.2.840.113549.1.5.12"}),U]}),new Sequence({value:[new ObjectIdentifier({value:"2.16.840.1.101.3.4.1.42"}),new OctetString({valueHex:B})]})]})]}),Z=new Sequence({value:[j,new OctetString({valueHex:N})]}).toBER(),X=new Uint8Array(Z,0,Z.byteLength);return["-----BEGIN ENCRYPTED PRIVATE KEY-----",...toString$4(X,"base64pad").split(/(.{64})/).filter(Boolean),"-----END ENCRYPTED PRIVATE KEY-----"].join(`
`)}async function importFromPem(n,r){const _=webcrypto$1.get();let E;if(n.includes("-----BEGIN ENCRYPTED PRIVATE KEY-----")){const S=fromString$3(n.replace("-----BEGIN ENCRYPTED PRIVATE KEY-----","").replace("-----END ENCRYPTED PRIVATE KEY-----","").replace(/\n/g,"").trim(),"base64pad"),{result:C}=fromBER(S),{iv:A,salt:I,iterations:B,keySize:O,cipherText:N}=findEncryptedPEMData(C),U=await pbkdf2Async(sha512$1,r,I,{c:B,dkLen:O}),j=await _.subtle.importKey("raw",U,"AES-CBC",!1,["decrypt"]),z=toUint8Array(await _.subtle.decrypt({name:"AES-CBC",iv:A},j,N)),{result:Z}=fromBER(z);E=findPEMData(Z)}else if(n.includes("-----BEGIN PRIVATE KEY-----")){const S=fromString$3(n.replace("-----BEGIN PRIVATE KEY-----","").replace("-----END PRIVATE KEY-----","").replace(/\n/g,"").trim(),"base64pad"),{result:C}=fromBER(S);E=findPEMData(C)}else throw new CodeError$4("Could not parse private key from PEM data","ERR_INVALID_PARAMETERS");return unmarshalRsaPrivateKey$1(E)}function findEncryptedPEMData(n){const r=n.valueBlock.value[0];if(r.valueBlock.value[0].toString()!=="OBJECT IDENTIFIER : 1.2.840.113549.1.5.13")throw new CodeError$4("Only pkcs5PBES2 encrypted private keys are supported","ERR_INVALID_PARAMS");const E=r.valueBlock.value[1].valueBlock.value[0];if(E.valueBlock.value[0].toString()!=="OBJECT IDENTIFIER : 1.2.840.113549.1.5.12")throw new CodeError$4("Only pkcs5PBKDF2 key derivation functions are supported","ERR_INVALID_PARAMS");const C=E.valueBlock.value[1],A=toUint8Array(C.valueBlock.value[0].getValue());let I=ITERATIONS,B=KEY_SIZE;if(C.valueBlock.value.length===3)I=Number(C.valueBlock.value[1].toBigInt()),B=Number(C.valueBlock.value[2].toBigInt());else if(C.valueBlock.value.length===2)throw new CodeError$4("Could not derive key size and iterations from PEM file - please use @libp2p/rsa to re-import your key","ERR_INVALID_PARAMS");const O=r.valueBlock.value[1].valueBlock.value[1],N=O.valueBlock.value[0].toString();if(N!=="OBJECT IDENTIFIER : 1.2.840.113549.3.7"){if(N!=="OBJECT IDENTIFIER : 1.3.14.3.2.7"){if(N!=="OBJECT IDENTIFIER : 2.16.840.1.101.3.4.1.2"){if(N!=="OBJECT IDENTIFIER : 2.16.840.1.101.3.4.1.22"){if(N!=="OBJECT IDENTIFIER : 2.16.840.1.101.3.4.1.42")throw new CodeError$4("Only AES-CBC encryption schemes are supported","ERR_INVALID_PARAMS")}}}}const U=toUint8Array(O.valueBlock.value[1].getValue());return{cipherText:toUint8Array(n.valueBlock.value[1].getValue()),salt:A,iterations:I,keySize:B,iv:U}}function findPEMData(n){return toUint8Array(n.valueBlock.value[2].getValue())}function toUint8Array(n){return new Uint8Array(n,0,n.byteLength)}async function generateKey$4(n){const r=await webcrypto$1.get().subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:n,publicExponent:new Uint8Array([1,0,1]),hash:{name:"SHA-256"}},!0,["sign","verify"]),_=await exportKey$1(r);return{privateKey:_[0],publicKey:_[1]}}async function unmarshalPrivateKey$2(n){const _=[await webcrypto$1.get().subtle.importKey("jwk",n,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!0,["sign"]),await derivePublicFromPrivate$1(n)],E=await exportKey$1({privateKey:_[0],publicKey:_[1]});return{privateKey:E[0],publicKey:E[1]}}async function hashAndSign$4(n,r){const _=await webcrypto$1.get().subtle.importKey("jwk",n,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!1,["sign"]),E=await webcrypto$1.get().subtle.sign({name:"RSASSA-PKCS1-v1_5"},_,r instanceof Uint8Array?r:r.subarray());return new Uint8Array(E,0,E.byteLength)}async function hashAndVerify$4(n,r,_){const E=await webcrypto$1.get().subtle.importKey("jwk",n,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!1,["verify"]);return webcrypto$1.get().subtle.verify({name:"RSASSA-PKCS1-v1_5"},E,r,_ instanceof Uint8Array?_:_.subarray())}async function exportKey$1(n){if(n.privateKey==null||n.publicKey==null)throw new CodeError$4("Private and public key are required","ERR_INVALID_PARAMETERS");return Promise.all([webcrypto$1.get().subtle.exportKey("jwk",n.privateKey),webcrypto$1.get().subtle.exportKey("jwk",n.publicKey)])}async function derivePublicFromPrivate$1(n){return webcrypto$1.get().subtle.importKey("jwk",{kty:n.kty,n:n.n,e:n.e},{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!0,["verify"])}function keySize$1(n){if(n.kty!=="RSA")throw new CodeError$4("invalid key type","ERR_INVALID_KEY_TYPE");if(n.n==null)throw new CodeError$4("invalid key modulus","ERR_INVALID_KEY_MODULUS");return fromString$3(n.n,"base64url").length*8}const MAX_RSA_KEY_SIZE=8192;let RsaPublicKey$1=class{_key;constructor(r){this._key=r}verify(r,_){return hashAndVerify$4(this._key,_,r)}marshal(){return jwkToPkix$1(this._key)}get bytes(){return PublicKey$1.encode({Type:KeyType$1.RSA,Data:this.marshal()}).subarray()}equals(r){return equals$1(this.bytes,r.bytes)}hash(){const r=sha256$6.digest(this.bytes);return isPromise$3(r)?r.then(({bytes:_})=>_):r.bytes}},RsaPrivateKey$1=class{_key;_publicKey;constructor(r,_){this._key=r,this._publicKey=_}genSecret(){return randomBytes$1(16)}sign(r){return hashAndSign$4(this._key,r)}get public(){if(this._publicKey==null)throw new CodeError$4("public key not provided","ERR_PUBKEY_NOT_PROVIDED");return new RsaPublicKey$1(this._publicKey)}marshal(){return jwkToPkcs1$1(this._key)}get bytes(){return PrivateKey$1.encode({Type:KeyType$1.RSA,Data:this.marshal()}).subarray()}equals(r){return equals$1(this.bytes,r.bytes)}hash(){const r=sha256$6.digest(this.bytes);return isPromise$3(r)?r.then(({bytes:_})=>_):r.bytes}async id(){const r=await this.public.hash();return toString$4(r,"base58btc")}async export(r,_="pkcs-8"){if(_==="pkcs-8")return exportToPem(this,r);if(_==="libp2p-key")return exporter$1(this.bytes,r);throw new CodeError$4(`export format '${_}' is not supported`,"ERR_INVALID_EXPORT_FORMAT")}};async function unmarshalRsaPrivateKey$1(n){const r=pkcs1ToJwk$1(n);if(keySize$1(r)>MAX_RSA_KEY_SIZE)throw new CodeError$4("key size is too large","ERR_KEY_SIZE_TOO_LARGE");const _=await unmarshalPrivateKey$2(r);return new RsaPrivateKey$1(_.privateKey,_.publicKey)}function unmarshalRsaPublicKey$1(n){const r=pkixToJwk$1(n);if(keySize$1(r)>MAX_RSA_KEY_SIZE)throw new CodeError$4("key size is too large","ERR_KEY_SIZE_TOO_LARGE");return new RsaPublicKey$1(r)}async function fromJwk$1(n){if(keySize$1(n)>MAX_RSA_KEY_SIZE)throw new CodeError$4("key size is too large","ERR_KEY_SIZE_TOO_LARGE");const r=await unmarshalPrivateKey$2(n);return new RsaPrivateKey$1(r.privateKey,r.publicKey)}async function generateKeyPair$5(n){if(n>MAX_RSA_KEY_SIZE)throw new CodeError$4("key size is too large","ERR_KEY_SIZE_TOO_LARGE");const r=await generateKey$4(n);return new RsaPrivateKey$1(r.privateKey,r.publicKey)}const RSA$1=Object.freeze(Object.defineProperty({__proto__:null,MAX_RSA_KEY_SIZE,RsaPrivateKey:RsaPrivateKey$1,RsaPublicKey:RsaPublicKey$1,fromJwk:fromJwk$1,generateKeyPair:generateKeyPair$5,unmarshalRsaPrivateKey:unmarshalRsaPrivateKey$1,unmarshalRsaPublicKey:unmarshalRsaPublicKey$1},Symbol.toStringTag,{value:"Module"}));function generateKey$3(){return secp256k1.utils.randomPrivateKey()}function hashAndSign$3(n,r){const _=sha256$6.digest(r instanceof Uint8Array?r:r.subarray());if(isPromise$3(_))return _.then(({digest:E})=>secp256k1.sign(E,n).toDERRawBytes()).catch(E=>{throw new CodeError$4(String(E),"ERR_INVALID_INPUT")});try{return secp256k1.sign(_.digest,n).toDERRawBytes()}catch(E){throw new CodeError$4(String(E),"ERR_INVALID_INPUT")}}function hashAndVerify$3(n,r,_){const E=sha256$6.digest(_ instanceof Uint8Array?_:_.subarray());if(isPromise$3(E))return E.then(({digest:S})=>secp256k1.verify(r,S,n)).catch(S=>{throw new CodeError$4(String(S),"ERR_INVALID_INPUT")});try{return secp256k1.verify(r,E.digest,n)}catch(S){throw new CodeError$4(String(S),"ERR_INVALID_INPUT")}}function compressPublicKey$1(n){return secp256k1.ProjectivePoint.fromHex(n).toRawBytes(!0)}function validatePrivateKey$1(n){try{secp256k1.getPublicKey(n,!0)}catch(r){throw new CodeError$4(String(r),"ERR_INVALID_PRIVATE_KEY")}}function validatePublicKey$1(n){try{secp256k1.ProjectivePoint.fromHex(n)}catch(r){throw new CodeError$4(String(r),"ERR_INVALID_PUBLIC_KEY")}}function computePublicKey$1(n){try{return secp256k1.getPublicKey(n,!0)}catch(r){throw new CodeError$4(String(r),"ERR_INVALID_PRIVATE_KEY")}}let Secp256k1PublicKey$1=class{_key;constructor(r){validatePublicKey$1(r),this._key=r}verify(r,_){return hashAndVerify$3(this._key,_,r)}marshal(){return compressPublicKey$1(this._key)}get bytes(){return PublicKey$1.encode({Type:KeyType$1.Secp256k1,Data:this.marshal()}).subarray()}equals(r){return equals$1(this.bytes,r.bytes)}async hash(){const r=sha256$6.digest(this.bytes);let _;return isPromise$3(r)?{bytes:_}=await r:_=r.bytes,_}},Secp256k1PrivateKey$1=class{_key;_publicKey;constructor(r,_){this._key=r,this._publicKey=_??computePublicKey$1(r),validatePrivateKey$1(this._key),validatePublicKey$1(this._publicKey)}sign(r){return hashAndSign$3(this._key,r)}get public(){return new Secp256k1PublicKey$1(this._publicKey)}marshal(){return this._key}get bytes(){return PrivateKey$1.encode({Type:KeyType$1.Secp256k1,Data:this.marshal()}).subarray()}equals(r){return equals$1(this.bytes,r.bytes)}hash(){const r=sha256$6.digest(this.bytes);return isPromise$3(r)?r.then(({bytes:_})=>_):r.bytes}async id(){const r=await this.public.hash();return toString$4(r,"base58btc")}async export(r,_="libp2p-key"){if(_==="libp2p-key")return exporter$1(this.bytes,r);throw new CodeError$4(`export format '${_}' is not supported`,"ERR_INVALID_EXPORT_FORMAT")}};function unmarshalSecp256k1PrivateKey$1(n){return new Secp256k1PrivateKey$1(n)}function unmarshalSecp256k1PublicKey$1(n){return new Secp256k1PublicKey$1(n)}async function generateKeyPair$4(){const n=generateKey$3();return new Secp256k1PrivateKey$1(n)}const Secp256k1$1=Object.freeze(Object.defineProperty({__proto__:null,Secp256k1PrivateKey:Secp256k1PrivateKey$1,Secp256k1PublicKey:Secp256k1PublicKey$1,generateKeyPair:generateKeyPair$4,unmarshalSecp256k1PrivateKey:unmarshalSecp256k1PrivateKey$1,unmarshalSecp256k1PublicKey:unmarshalSecp256k1PublicKey$1},Symbol.toStringTag,{value:"Module"})),supportedKeys$1={rsa:RSA$1,ed25519:Ed25519$1,secp256k1:Secp256k1$1};function unsupportedKey$1(n){const r=Object.keys(supportedKeys$1).join(" / ");return new CodeError$4(`invalid or unsupported key type ${n}. Must be ${r}`,"ERR_UNSUPPORTED_KEY_TYPE")}function typeToKey(n){if(n=n.toLowerCase(),n==="rsa"||n==="ed25519"||n==="secp256k1")return supportedKeys$1[n];throw unsupportedKey$1(n)}async function generateKeyPair$3(n,r){return typeToKey(n).generateKeyPair(r??2048)}function unmarshalPublicKey$1(n){const r=PublicKey$1.decode(n),_=r.Data??new Uint8Array;switch(r.Type){case KeyType$1.RSA:return supportedKeys$1.rsa.unmarshalRsaPublicKey(_);case KeyType$1.Ed25519:return supportedKeys$1.ed25519.unmarshalEd25519PublicKey(_);case KeyType$1.Secp256k1:return supportedKeys$1.secp256k1.unmarshalSecp256k1PublicKey(_);default:throw unsupportedKey$1(r.Type??"unknown")}}function marshalPublicKey(n,r){return r=(r??"rsa").toLowerCase(),typeToKey(r),n.bytes}async function unmarshalPrivateKey$1(n){const r=PrivateKey$1.decode(n),_=r.Data??new Uint8Array;switch(r.Type){case KeyType$1.RSA:return supportedKeys$1.rsa.unmarshalRsaPrivateKey(_);case KeyType$1.Ed25519:return supportedKeys$1.ed25519.unmarshalEd25519PrivateKey(_);case KeyType$1.Secp256k1:return supportedKeys$1.secp256k1.unmarshalSecp256k1PrivateKey(_);default:throw unsupportedKey$1(r.Type??"RSA")}}function marshalPrivateKey(n,r){return r=(r??"rsa").toLowerCase(),typeToKey(r),n.bytes}async function importKey(n,r){try{const _=await importer(n,r);return await unmarshalPrivateKey$1(_)}catch{}if(!n.includes("BEGIN"))throw new CodeError$4("Encrypted key was not a libp2p-key or a PEM file","ERR_INVALID_IMPORT_FORMAT");return importFromPem(n,r)}const SHA1_IV=new Uint32Array([1732584193,4023233417,2562383102,271733878,3285377520]),SHA1_W=new Uint32Array(80);class SHA1 extends HashMD{constructor(){super(64,20,8,!1),this.A=SHA1_IV[0]|0,this.B=SHA1_IV[1]|0,this.C=SHA1_IV[2]|0,this.D=SHA1_IV[3]|0,this.E=SHA1_IV[4]|0}get(){const{A:r,B:_,C:E,D:S,E:C}=this;return[r,_,E,S,C]}set(r,_,E,S,C){this.A=r|0,this.B=_|0,this.C=E|0,this.D=S|0,this.E=C|0}process(r,_){for(let B=0;B<16;B++,_+=4)SHA1_W[B]=r.getUint32(_,!1);for(let B=16;B<80;B++)SHA1_W[B]=rotl$1(SHA1_W[B-3]^SHA1_W[B-8]^SHA1_W[B-14]^SHA1_W[B-16],1);let{A:E,B:S,C,D:A,E:I}=this;for(let B=0;B<80;B++){let O,N;B<20?(O=Chi(S,C,A),N=1518500249):B<40?(O=S^C^A,N=1859775393):B<60?(O=Maj(S,C,A),N=2400959708):(O=S^C^A,N=3395469782);const U=rotl$1(E,5)+O+I+N+SHA1_W[B]|0;I=A,A=C,C=rotl$1(S,30),S=E,E=U}E=E+this.A|0,S=S+this.B|0,C=C+this.C|0,A=A+this.D|0,I=I+this.E|0,this.set(E,S,C,A,I)}roundClean(){SHA1_W.fill(0)}destroy(){this.set(0,0,0,0,0),this.buffer.fill(0)}}const sha1=wrapConstructor(()=>new SHA1),hashName={sha1,"sha2-256":sha256$2,"sha2-512":sha512$1};function pbkdf2(n,r,_,E,S){if(S!=="sha1"&&S!=="sha2-256"&&S!=="sha2-512"){const I=Object.keys(hashName).join(" / ");throw new CodeError$4(`Hash '${S}' is unknown or not supported. Must be ${I}`,"ERR_UNSUPPORTED_HASH_TYPE")}const C=hashName[S],A=pbkdf2$1(C,n,r,{c:_,dkLen:E});return base64$5.encode(A).substring(1)}const SignPrefix=fromString$3("libp2p-pubsub:");async function buildRawMessage(n,r,_,E){switch(n.type){case PublishConfigType.Signing:{const S={from:n.author.toBytes(),data:E,seqno:randomBytes$1(8),topic:r,signature:void 0,key:void 0},C=concat$4([SignPrefix,RPC$1.Message.encode(S).finish()]);S.signature=await n.privateKey.sign(C),S.key=n.key;const A={type:"signed",from:n.author,data:_,sequenceNumber:BigInt(`0x${toString$4(S.seqno,"base16")}`),topic:r,signature:S.signature,key:S.key};return{raw:S,msg:A}}case PublishConfigType.Anonymous:return{raw:{from:void 0,data:E,seqno:void 0,topic:r,signature:void 0,key:void 0},msg:{type:"unsigned",data:_,topic:r}};default:throw new Error("Unreachable")}}async function validateToRawMessage(n,r){switch(n){case StrictNoSign:return r.signature!=null?{valid:!1,error:ValidateError.SignaturePresent}:r.seqno!=null?{valid:!1,error:ValidateError.SeqnoPresent}:r.key!=null?{valid:!1,error:ValidateError.FromPresent}:{valid:!0,message:{type:"unsigned",topic:r.topic,data:r.data??new Uint8Array(0)}};case StrictSign:{if(r.seqno==null)return{valid:!1,error:ValidateError.InvalidSeqno};if(r.seqno.length!==8)return{valid:!1,error:ValidateError.InvalidSeqno};if(r.signature==null)return{valid:!1,error:ValidateError.InvalidSignature};if(r.from==null)return{valid:!1,error:ValidateError.InvalidPeerId};let _;try{_=peerIdFromBytes$1(r.from)}catch{return{valid:!1,error:ValidateError.InvalidPeerId}}let E;if(r.key!=null){if(E=unmarshalPublicKey$1(r.key),_.publicKey!==void 0&&!equals$1(E.bytes,_.publicKey))return{valid:!1,error:ValidateError.InvalidPeerId}}else{if(_.publicKey==null)return{valid:!1,error:ValidateError.InvalidPeerId};E=unmarshalPublicKey$1(_.publicKey)}const S={from:r.from,data:r.data,seqno:r.seqno,topic:r.topic,signature:void 0,key:void 0},C=concat$4([SignPrefix,RPC$1.Message.encode(S).finish()]);return await E.verify(C,r.signature)?{valid:!0,message:{type:"signed",from:_,data:r.data??new Uint8Array(0),sequenceNumber:BigInt(`0x${toString$4(r.seqno,"base16")}`),topic:r.topic,signature:r.signature,key:r.key??marshalPublicKey(E)}}:{valid:!1,error:ValidateError.InvalidSignature}}default:throw new Error("Unreachable")}}function shuffle(n){if(n.length<=1)return n;const r=()=>Math.floor(Math.random()*Math.floor(n.length));for(let _=0;_<n.length;_++){const E=r(),S=n[_];n[_]=n[E],n[E]=S}return n}function messageIdToString(n){return toString$4(n,"base64")}async function getPublishConfigFromPeerId(n,r){switch(n){case StrictSign:{if(r==null)throw Error("Must provide PeerId");if(r.privateKey==null)throw Error("Cannot sign message, no private key present");if(r.publicKey==null)throw Error("Cannot sign message, no public key present");const _=await unmarshalPrivateKey$1(r.privateKey);return{type:PublishConfigType.Signing,author:r,key:r.publicKey,privateKey:_}}case StrictNoSign:return{type:PublishConfigType.Anonymous};default:throw new Error(`Unknown signature policy "${n}"`)}}const msgId=(n,r)=>{const _=fromString$3(r.toString(16).padStart(16,"0"),"base16"),E=new Uint8Array(n.length+_.length);return E.set(n,0),E.set(_,n.length),E};function msgIdFnStrictSign(n){if(n.type!=="signed")throw new Error("expected signed message type");if(n.sequenceNumber==null)throw Error("missing seqno field");return msgId(n.from.toBytes(),n.sequenceNumber)}async function msgIdFnStrictNoSign(n){return sha256$6.encode(n.data)}class Parser{index=0;input="";new(r){return this.index=0,this.input=r,this}readAtomically(r){const _=this.index,E=r();return E===void 0&&(this.index=_),E}parseWith(r){const _=r();if(this.index===this.input.length)return _}peekChar(){if(!(this.index>=this.input.length))return this.input[this.index]}readChar(){if(!(this.index>=this.input.length))return this.input[this.index++]}readGivenChar(r){return this.readAtomically(()=>{const _=this.readChar();if(_===r)return _})}readSeparator(r,_,E){return this.readAtomically(()=>{if(!(_>0&&this.readGivenChar(r)===void 0))return E()})}readNumber(r,_,E,S){return this.readAtomically(()=>{let C=0,A=0;const I=this.peekChar();if(I===void 0)return;const B=I==="0",O=2**(8*S)-1;for(;;){const N=this.readAtomically(()=>{const U=this.readChar();if(U===void 0)return;const j=Number.parseInt(U,r);if(!Number.isNaN(j))return j});if(N===void 0)break;if(C*=r,C+=N,C>O||(A+=1,_!==void 0&&A>_))return}if(A!==0)return!E&&B&&A>1?void 0:C})}readIPv4Addr(){return this.readAtomically(()=>{const r=new Uint8Array(4);for(let _=0;_<r.length;_++){const E=this.readSeparator(".",_,()=>this.readNumber(10,3,!1,1));if(E===void 0)return;r[_]=E}return r})}readIPv6Addr(){const r=_=>{for(let E=0;E<_.length/2;E++){const S=E*2;if(E<_.length-3){const A=this.readSeparator(":",E,()=>this.readIPv4Addr());if(A!==void 0)return _[S]=A[0],_[S+1]=A[1],_[S+2]=A[2],_[S+3]=A[3],[S+4,!0]}const C=this.readSeparator(":",E,()=>this.readNumber(16,4,!0,2));if(C===void 0)return[S,!1];_[S]=C>>8,_[S+1]=C&255}return[_.length,!1]};return this.readAtomically(()=>{const _=new Uint8Array(16),[E,S]=r(_);if(E===16)return _;if(S||this.readGivenChar(":")===void 0||this.readGivenChar(":")===void 0)return;const C=new Uint8Array(14),A=16-(E+2),[I]=r(C.subarray(0,A));return _.set(C.subarray(0,I),16-I),_})}readIPAddr(){return this.readIPv4Addr()??this.readIPv6Addr()}}const MAX_IPV6_LENGTH=45,MAX_IPV4_LENGTH=15,parser=new Parser;function parseIPv4(n){if(!(n.length>MAX_IPV4_LENGTH))return parser.new(n).parseWith(()=>parser.readIPv4Addr())}function parseIPv6(n){if(n.includes("%")&&(n=n.split("%")[0]),!(n.length>MAX_IPV6_LENGTH))return parser.new(n).parseWith(()=>parser.readIPv6Addr())}function parseIP(n){if(n.includes("%")&&(n=n.split("%")[0]),!(n.length>MAX_IPV6_LENGTH))return parser.new(n).parseWith(()=>parser.readIPAddr())}function isIPv4(n){return!!parseIPv4(n)}function isIPv6(n){return!!parseIPv6(n)}function isIP(n){return!!parseIP(n)}const isV4=isIPv4,isV6=isIPv6,toBytes$1=function(n){let r=0;if(n=n.toString().trim(),isV4(n)){const _=new Uint8Array(r+4);return n.split(/\./g).forEach(E=>{_[r++]=parseInt(E,10)&255}),_}if(isV6(n)){const _=n.split(":",8);let E;for(E=0;E<_.length;E++){const C=isV4(_[E]);let A;C&&(A=toBytes$1(_[E]),_[E]=toString$4(A.slice(0,2),"base16")),A!=null&&++E<8&&_.splice(E,0,toString$4(A.slice(2,4),"base16"))}if(_[0]==="")for(;_.length<8;)_.unshift("0");else if(_[_.length-1]==="")for(;_.length<8;)_.push("0");else if(_.length<8){for(E=0;E<_.length&&_[E]!=="";E++);const C=[E,1];for(E=9-_.length;E>0;E--)C.push("0");_.splice.apply(_,C)}const S=new Uint8Array(r+16);for(E=0;E<_.length;E++){const C=parseInt(_[E],16);S[r++]=C>>8&255,S[r++]=C&255}return S}throw new Error("invalid ip address")},toString$3=function(n,r=0,_){r=~~r,_=_??n.length-r;const E=new DataView(n.buffer);if(_===4){const S=[];for(let C=0;C<_;C++)S.push(n[r+C]);return S.join(".")}if(_===16){const S=[];for(let C=0;C<_;C+=2)S.push(E.getUint16(r+C).toString(16));return S.join(":").replace(/(^|:)0(:0)*:0(:|$)/,"$1::$3").replace(/:{3,4}/,"::")}return""},V=-1,names$3={},codes$7={},table=[[4,32,"ip4"],[6,16,"tcp"],[33,16,"dccp"],[41,128,"ip6"],[42,V,"ip6zone"],[43,8,"ipcidr"],[53,V,"dns",!0],[54,V,"dns4",!0],[55,V,"dns6",!0],[56,V,"dnsaddr",!0],[132,16,"sctp"],[273,16,"udp"],[275,0,"p2p-webrtc-star"],[276,0,"p2p-webrtc-direct"],[277,0,"p2p-stardust"],[280,0,"webrtc-direct"],[281,0,"webrtc"],[290,0,"p2p-circuit"],[301,0,"udt"],[302,0,"utp"],[400,V,"unix",!1,!0],[421,V,"ipfs"],[421,V,"p2p"],[443,0,"https"],[444,96,"onion"],[445,296,"onion3"],[446,V,"garlic64"],[448,0,"tls"],[449,V,"sni"],[460,0,"quic"],[461,0,"quic-v1"],[465,0,"webtransport"],[466,V,"certhash"],[477,0,"ws"],[478,0,"wss"],[479,0,"p2p-websocket-star"],[480,0,"http"],[777,V,"memory"]];table.forEach(n=>{const r=createProtocol(...n);codes$7[r.code]=r,names$3[r.name]=r});function createProtocol(n,r,_,E,S){return{code:n,size:r,name:_,resolvable:!!E,path:!!S}}function getProtocol(n){if(typeof n=="number"){if(codes$7[n]!=null)return codes$7[n];throw new Error(`no protocol with code: ${n}`)}else if(typeof n=="string"){if(names$3[n]!=null)return names$3[n];throw new Error(`no protocol with name: ${n}`)}throw new Error(`invalid protocol id type: ${typeof n}`)}getProtocol("ip4");getProtocol("ip6");getProtocol("ipcidr");function convertToString(n,r){switch(getProtocol(n).code){case 4:case 41:return bytes2ip(r);case 42:return bytes2str(r);case 6:case 273:case 33:case 132:return bytes2port(r).toString();case 53:case 54:case 55:case 56:case 400:case 449:case 777:return bytes2str(r);case 421:return bytes2mh(r);case 444:return bytes2onion(r);case 445:return bytes2onion(r);case 466:return bytes2mb(r);default:return toString$4(r,"base16")}}function convertToBytes(n,r){switch(getProtocol(n).code){case 4:return ip2bytes(r);case 41:return ip2bytes(r);case 42:return str2bytes(r);case 6:case 273:case 33:case 132:return port2bytes(parseInt(r,10));case 53:case 54:case 55:case 56:case 400:case 449:case 777:return str2bytes(r);case 421:return mh2bytes(r);case 444:return onion2bytes(r);case 445:return onion32bytes(r);case 466:return mb2bytes(r);default:return fromString$3(r,"base16")}}const decoders=Object.values(bases$2).map(n=>n.decoder),anybaseDecoder=function(){let n=decoders[0].or(decoders[1]);return decoders.slice(2).forEach(r=>n=n.or(r)),n}();function ip2bytes(n){if(!isIP(n))throw new Error("invalid ip address");return toBytes$1(n)}function bytes2ip(n){const r=toString$3(n,0,n.length);if(r==null)throw new Error("ipBuff is required");if(!isIP(r))throw new Error("invalid ip address");return r}function port2bytes(n){const r=new ArrayBuffer(2);return new DataView(r).setUint16(0,n),new Uint8Array(r)}function bytes2port(n){return new DataView(n.buffer).getUint16(n.byteOffset)}function str2bytes(n){const r=fromString$3(n),_=Uint8Array.from(encode$b(r.length));return concat$4([_,r],_.length+r.length)}function bytes2str(n){const r=decode$b(n);if(n=n.slice(encodingLength(r)),n.length!==r)throw new Error("inconsistent lengths");return toString$4(n)}function mh2bytes(n){let r;n[0]==="Q"||n[0]==="1"?r=decode$h(base58btc.decode(`z${n}`)).bytes:r=CID.parse(n).multihash.bytes;const _=Uint8Array.from(encode$b(r.length));return concat$4([_,r],_.length+r.length)}function mb2bytes(n){const r=anybaseDecoder.decode(n),_=Uint8Array.from(encode$b(r.length));return concat$4([_,r],_.length+r.length)}function bytes2mb(n){const r=decode$b(n),_=n.slice(encodingLength(r));if(_.length!==r)throw new Error("inconsistent lengths");return"u"+toString$4(_,"base64url")}function bytes2mh(n){const r=decode$b(n),_=n.slice(encodingLength(r));if(_.length!==r)throw new Error("inconsistent lengths");return toString$4(_,"base58btc")}function onion2bytes(n){const r=n.split(":");if(r.length!==2)throw new Error(`failed to parse onion addr: ["'${r.join('", "')}'"]' does not contain a port number`);if(r[0].length!==16)throw new Error(`failed to parse onion addr: ${r[0]} not a Tor onion address.`);const _=base32.decode("b"+r[0]),E=parseInt(r[1],10);if(E<1||E>65536)throw new Error("Port number is not in range(1, 65536)");const S=port2bytes(E);return concat$4([_,S],_.length+S.length)}function onion32bytes(n){const r=n.split(":");if(r.length!==2)throw new Error(`failed to parse onion addr: ["'${r.join('", "')}'"]' does not contain a port number`);if(r[0].length!==56)throw new Error(`failed to parse onion addr: ${r[0]} not a Tor onion3 address.`);const _=base32.decode(`b${r[0]}`),E=parseInt(r[1],10);if(E<1||E>65536)throw new Error("Port number is not in range(1, 65536)");const S=port2bytes(E);return concat$4([_,S],_.length+S.length)}function bytes2onion(n){const r=n.slice(0,n.length-2),_=n.slice(n.length-2),E=toString$4(r,"base32"),S=bytes2port(_);return`${E}:${S}`}var Protocol;(function(n){n[n.ip4=4]="ip4",n[n.ip6=41]="ip6"})(Protocol||(Protocol={}));function multiaddrToIPStr(n){for(const r of n.tuples())switch(r[0]){case Protocol.ip4:case Protocol.ip6:return convertToString(r[0],r[1])}return null}class SimpleTimeCache{entries=new Map;validityMs;constructor(r){this.validityMs=r.validityMs}get size(){return this.entries.size}put(r,_){return this.entries.has(r)?!0:(this.entries.set(r,{value:_,validUntilMs:Date.now()+this.validityMs}),!1)}prune(){const r=Date.now();for(const[_,E]of this.entries.entries())if(E.validUntilMs<r)this.entries.delete(_);else break}has(r){return this.entries.has(r)}get(r){const _=this.entries.get(r);return _!=null&&_.validUntilMs>=Date.now()?_.value:void 0}clear(){this.entries.clear()}}var GossipStatusCode;(function(n){n[n.started=0]="started",n[n.stopped=1]="stopped"})(GossipStatusCode||(GossipStatusCode={}));class GossipSub extends TypedEventEmitter{globalSignaturePolicy;multicodecs=[GossipsubIDv11,GossipsubIDv10];publishConfig;dataTransform;peers=new Set;streamsInbound=new Map;streamsOutbound=new Map;outboundInflightQueue=pushable$1({objectMode:!0});direct=new Set;floodsubPeers=new Set;seenCache;acceptFromWhitelist=new Map;topics=new Map;subscriptions=new Set;mesh=new Map;fanout=new Map;fanoutLastpub=new Map;gossip=new Map;control=new Map;peerhave=new Map;iasked=new Map;backoff=new Map;outbound=new Map;msgIdFn;fastMsgIdFn;msgIdToStrFn;fastMsgIdCache;publishedMessageIds;mcache;score;topicValidators=new Map;log;heartbeatTicks=0;gossipTracer;components;directPeerInitial=null;static multicodec=GossipsubIDv11;opts;decodeRpcLimits;metrics;status={code:GossipStatusCode.stopped};maxInboundStreams;maxOutboundStreams;runOnTransientConnection;allowedTopics;heartbeatTimer=null;constructor(r,_={}){super();const E={fallbackToFloodsub:!0,floodPublish:!0,batchPublish:!1,doPX:!1,directPeers:[],D:GossipsubD,Dlo:GossipsubDlo,Dhi:GossipsubDhi,Dscore:GossipsubDscore,Dout:GossipsubDout,Dlazy:GossipsubDlazy,heartbeatInterval:GossipsubHeartbeatInterval,fanoutTTL:GossipsubFanoutTTL,mcacheLength:GossipsubHistoryLength,mcacheGossip:GossipsubHistoryGossip,seenTTL:GossipsubSeenTTL,gossipsubIWantFollowupMs:GossipsubIWantFollowupTime,prunePeers:GossipsubPrunePeers,pruneBackoff:GossipsubPruneBackoff,unsubcribeBackoff:GossipsubUnsubscribeBackoff,graftFloodThreshold:GossipsubGraftFloodThreshold,opportunisticGraftPeers:GossipsubOpportunisticGraftPeers,opportunisticGraftTicks:GossipsubOpportunisticGraftTicks,directConnectTicks:GossipsubDirectConnectTicks,..._,scoreParams:createPeerScoreParams(_.scoreParams),scoreThresholds:createPeerScoreThresholds(_.scoreThresholds)};if(this.components=r,this.decodeRpcLimits=E.decodeRpcLimits??defaultDecodeRpcLimits,this.globalSignaturePolicy=E.globalSignaturePolicy??StrictSign,E.fallbackToFloodsub&&this.multicodecs.push(FloodsubID),this.log=r.logger.forComponent(E.debugName??"libp2p:gossipsub"),this.opts=E,this.direct=new Set(E.directPeers.map(S=>S.id.toString())),this.seenCache=new SimpleTimeCache({validityMs:E.seenTTL}),this.publishedMessageIds=new SimpleTimeCache({validityMs:E.seenTTL}),_.msgIdFn!=null)this.msgIdFn=_.msgIdFn;else switch(this.globalSignaturePolicy){case StrictSign:this.msgIdFn=msgIdFnStrictSign;break;case StrictNoSign:this.msgIdFn=msgIdFnStrictNoSign;break;default:throw new Error(`Invalid globalSignaturePolicy: ${this.globalSignaturePolicy}`)}if(_.fastMsgIdFn!=null&&(this.fastMsgIdFn=_.fastMsgIdFn,this.fastMsgIdCache=new SimpleTimeCache({validityMs:E.seenTTL})),this.msgIdToStrFn=_.msgIdToStrFn??messageIdToString,this.mcache=_.messageCache??new MessageCache(E.mcacheGossip,E.mcacheLength,this.msgIdToStrFn),_.dataTransform!=null&&(this.dataTransform=_.dataTransform),_.metricsRegister!=null){if(_.metricsTopicStrToLabel==null)throw Error("Must set metricsTopicStrToLabel with metrics");const S=Math.max(...Object.values(E.scoreParams.topics).map(A=>A.meshMessageDeliveriesWindow),DEFAULT_METRIC_MESH_MESSAGE_DELIVERIES_WINDOWS),C=getMetrics(_.metricsRegister,_.metricsTopicStrToLabel,{gossipPromiseExpireSec:this.opts.gossipsubIWantFollowupMs/1e3,behaviourPenaltyThreshold:E.scoreParams.behaviourPenaltyThreshold,maxMeshMessageDeliveriesWindowSec:S/1e3});C.mcacheSize.addCollect(()=>{this.onScrapeMetrics(C)});for(const A of this.multicodecs)C.protocolsEnabled.set({protocol:A},1);this.metrics=C}else this.metrics=null;this.gossipTracer=new IWantTracer(this.opts.gossipsubIWantFollowupMs,this.msgIdToStrFn,this.metrics),this.score=new PeerScore(this.opts.scoreParams,this.metrics,this.components.logger,{scoreCacheValidityMs:E.heartbeatInterval}),this.maxInboundStreams=_.maxInboundStreams,this.maxOutboundStreams=_.maxOutboundStreams,this.runOnTransientConnection=_.runOnTransientConnection,this.allowedTopics=E.allowedTopics!=null?new Set(E.allowedTopics):null}getPeers(){return[...this.peers.keys()].map(r=>peerIdFromString$1(r))}isStarted(){return this.status.code===GossipStatusCode.started}async start(){if(this.isStarted())return;this.log("starting"),this.publishConfig=await getPublishConfigFromPeerId(this.globalSignaturePolicy,this.components.peerId),this.outboundInflightQueue=pushable$1({objectMode:!0}),pipe(this.outboundInflightQueue,async C=>{for await(const{peerId:A,connection:I}of C)await this.createOutboundStream(A,I)}).catch(C=>{this.log.error("outbound inflight queue error",C)}),await Promise.all(this.opts.directPeers.map(async C=>{await this.components.peerStore.merge(C.id,{multiaddrs:C.addrs})}));const r=this.components.registrar;await Promise.all(this.multicodecs.map(async C=>r.handle(C,this.onIncomingStream.bind(this),{maxInboundStreams:this.maxInboundStreams,maxOutboundStreams:this.maxOutboundStreams,runOnTransientConnection:this.runOnTransientConnection})));const _={onConnect:this.onPeerConnected.bind(this),onDisconnect:this.onPeerDisconnected.bind(this),notifyOnTransient:this.runOnTransientConnection},E=await Promise.all(this.multicodecs.map(async C=>r.register(C,_))),S=setTimeout(this.runHeartbeat,GossipsubHeartbeatInitialDelay);this.status={code:GossipStatusCode.started,registrarTopologyIds:E,heartbeatTimeout:S,hearbeatStartMs:Date.now()+GossipsubHeartbeatInitialDelay},this.score.start(),this.directPeerInitial=setTimeout(()=>{Promise.resolve().then(async()=>{await Promise.all(Array.from(this.direct).map(async C=>this.connect(C)))}).catch(C=>{this.log(C)})},GossipsubDirectConnectInitialDelay),this.log("started")}async stop(){if(this.log("stopping"),this.status.code!==GossipStatusCode.started)return;const{registrarTopologyIds:r}=this.status;this.status={code:GossipStatusCode.stopped};const _=this.components.registrar;await Promise.all(this.multicodecs.map(async S=>_.unhandle(S))),r.forEach(S=>{_.unregister(S)}),this.outboundInflightQueue.end();const E=[];for(const S of this.streamsOutbound.values())E.push(S.close());this.streamsOutbound.clear();for(const S of this.streamsInbound.values())E.push(S.close());this.streamsInbound.clear(),await Promise.all(E),this.peers.clear(),this.subscriptions.clear(),this.heartbeatTimer!=null&&(this.heartbeatTimer.cancel(),this.heartbeatTimer=null),this.score.stop(),this.mesh.clear(),this.fanout.clear(),this.fanoutLastpub.clear(),this.gossip.clear(),this.control.clear(),this.peerhave.clear(),this.iasked.clear(),this.backoff.clear(),this.outbound.clear(),this.gossipTracer.clear(),this.seenCache.clear(),this.fastMsgIdCache!=null&&this.fastMsgIdCache.clear(),this.directPeerInitial!=null&&clearTimeout(this.directPeerInitial),this.log("stopped")}dumpPeerScoreStats(){return this.score.dumpPeerScoreStats()}onIncomingStream({stream:r,connection:_}){if(!this.isStarted())return;const E=_.remotePeer;this.addPeer(E,_.direction,_.remoteAddr),this.createInboundStream(E,r),this.outboundInflightQueue.push({peerId:E,connection:_})}onPeerConnected(r,_){this.metrics?.newConnectionCount.inc({status:_.status}),!(!this.isStarted()||_.status!=="open")&&(this.addPeer(r,_.direction,_.remoteAddr),this.outboundInflightQueue.push({peerId:r,connection:_}))}onPeerDisconnected(r){this.log("connection ended %p",r),this.removePeer(r)}async createOutboundStream(r,_){if(!this.isStarted())return;const E=r.toString();if(this.peers.has(E)&&!this.streamsOutbound.has(E))try{const S=new OutboundStream(await _.newStream(this.multicodecs,{runOnTransientConnection:this.runOnTransientConnection}),A=>{this.log.error("outbound pipe error",A)},{maxBufferSize:this.opts.maxOutboundBufferSize});this.log("create outbound stream %p",r),this.streamsOutbound.set(E,S);const C=S.protocol;C===FloodsubID&&this.floodsubPeers.add(E),this.metrics?.peersPerProtocol.inc({protocol:C},1),this.subscriptions.size>0&&(this.log("send subscriptions to",E),this.sendSubscriptions(E,Array.from(this.subscriptions),!0))}catch(S){this.log.error("createOutboundStream error",S)}}createInboundStream(r,_){if(!this.isStarted())return;const E=r.toString();if(!this.peers.has(E))return;const S=this.streamsInbound.get(E);S!==void 0&&(this.log("replacing existing inbound steam %s",E),S.close().catch(A=>{this.log.error(A)})),this.log("create inbound stream %s",E);const C=new InboundStream(_,{maxDataLength:this.opts.maxInboundDataLength});this.streamsInbound.set(E,C),this.pipePeerReadStream(r,C.source).catch(A=>{this.log(A)})}addPeer(r,_,E){const S=r.toString();if(!this.peers.has(S)){this.log("new peer %p",r),this.peers.add(S),this.score.addPeer(S);const C=multiaddrToIPStr(E);C!==null?this.score.addIP(S,C):this.log("Added peer has no IP in current address %s %s",S,E.toString()),this.outbound.has(S)||this.outbound.set(S,_==="outbound")}}removePeer(r){const _=r.toString();if(!this.peers.has(_))return;this.log("delete peer %p",r),this.peers.delete(_);const E=this.streamsOutbound.get(_),S=this.streamsInbound.get(_);E!=null&&this.metrics?.peersPerProtocol.inc({protocol:E.protocol},-1),E?.close().catch(C=>{this.log.error(C)}),S?.close().catch(C=>{this.log.error(C)}),this.streamsOutbound.delete(_),this.streamsInbound.delete(_);for(const C of this.topics.values())C.delete(_);for(const[C,A]of this.mesh)A.delete(_)&&this.metrics?.onRemoveFromMesh(C,ChurnReason.Dc,1);for(const C of this.fanout.values())C.delete(_);this.floodsubPeers.delete(_),this.gossip.delete(_),this.control.delete(_),this.outbound.delete(_),this.score.removePeer(_),this.acceptFromWhitelist.delete(_)}get started(){return this.status.code===GossipStatusCode.started}getMeshPeers(r){const _=this.mesh.get(r);return _!=null?Array.from(_):[]}getSubscribers(r){const _=this.topics.get(r);return(_!=null?Array.from(_):[]).map(E=>peerIdFromString$1(E))}getTopics(){return Array.from(this.subscriptions)}async pipePeerReadStream(r,_){try{await pipe(_,async E=>{for await(const S of E)try{const C=S.subarray(),A=decodeRpc(C,this.decodeRpcLimits);if(this.metrics?.onRpcRecv(A,C.length),this.opts.awaitRpcHandler)try{await this.handleReceivedRpc(r,A)}catch(I){this.metrics?.onRpcRecvError(),this.log(I)}else this.handleReceivedRpc(r,A).catch(I=>{this.metrics?.onRpcRecvError(),this.log(I)})}catch(C){this.metrics?.onRpcDataError(),this.log(C)}})}catch(E){this.metrics?.onPeerReadStreamError(),this.handlePeerReadStreamError(E,r)}}handlePeerReadStreamError(r,_){this.log.error(r),this.onPeerDisconnected(_)}async handleReceivedRpc(r,_){if(!this.acceptFrom(r.toString())){this.log("received message from unacceptable peer %p",r),this.metrics?.rpcRecvNotAccepted.inc();return}const E=_.subscriptions!=null?_.subscriptions.length:0,S=_.messages!=null?_.messages.length:0;let C=0,A=0,I=0,B=0;if(_.control!=null&&(_.control.ihave!=null&&(C=_.control.ihave.length),_.control.iwant!=null&&(A=_.control.iwant.length),_.control.graft!=null&&(I=_.control.graft.length),_.control.prune!=null&&(B=_.control.prune.length)),this.log(`rpc.from ${r.toString()} subscriptions ${E} messages ${S} ihave ${C} iwant ${A} graft ${I} prune ${B}`),_.subscriptions!=null&&_.subscriptions.length>0){const O=[];_.subscriptions.forEach(N=>{const U=N.topic,j=N.subscribe===!0;if(U!=null){if(this.allowedTopics!=null&&!this.allowedTopics.has(U))return;this.handleReceivedSubscription(r,U,j),O.push({topic:U,subscribe:j})}}),this.safeDispatchEvent("subscription-change",{detail:{peerId:r,subscriptions:O}})}if(_.messages!=null)for(const O of _.messages){if(this.allowedTopics!=null&&!this.allowedTopics.has(O.topic))continue;const N=this.handleReceivedMessage(r,O).catch(U=>{this.metrics?.onMsgRecvError(O.topic),this.log(U)});this.opts.awaitRpcMessageHandler&&await N}_.control!=null&&await this.handleControlMessage(r.toString(),_.control)}handleReceivedSubscription(r,_,E){this.log("subscription update from %p topic %s",r,_);let S=this.topics.get(_);S==null&&(S=new Set,this.topics.set(_,S)),E?S.add(r.toString()):S.delete(r.toString())}async handleReceivedMessage(r,_){this.metrics?.onMsgRecvPreValidation(_.topic);const E=await this.validateReceivedMessage(r,_);this.metrics?.onPrevalidationResult(_.topic,E.code);const S=E.code;switch(S){case MessageStatus.duplicate:this.score.duplicateMessage(r.toString(),E.msgIdStr,_.topic),this.gossipTracer.deliverMessage(E.msgIdStr,!0),this.mcache.observeDuplicate(E.msgIdStr,r.toString());return;case MessageStatus.invalid:if(E.msgIdStr!=null){const C=E.msgIdStr;this.score.rejectMessage(r.toString(),C,_.topic,E.reason),this.gossipTracer.rejectMessage(C,E.reason)}else this.score.rejectInvalidMessage(r.toString(),_.topic);this.metrics?.onMsgRecvInvalid(_.topic,E);return;case MessageStatus.valid:this.score.validateMessage(E.messageId.msgIdStr),this.gossipTracer.deliverMessage(E.messageId.msgIdStr),this.mcache.put(E.messageId,_,!this.opts.asyncValidation),this.subscriptions.has(_.topic)&&(!this.components.peerId.equals(r)||this.opts.emitSelf)&&(super.dispatchEvent(new CustomEvent$1("gossipsub:message",{detail:{propagationSource:r,msgId:E.messageId.msgIdStr,msg:E.msg}})),super.dispatchEvent(new CustomEvent$1("message",{detail:E.msg}))),this.opts.asyncValidation||this.forwardMessage(E.messageId.msgIdStr,_,r.toString());break;default:throw new Error(`Invalid validation result: ${S}`)}}async validateReceivedMessage(r,_){const E=this.fastMsgIdFn?.(_),S=E!==void 0?this.fastMsgIdCache?.get(E):void 0;if(S!=null)return{code:MessageStatus.duplicate,msgIdStr:S};const C=await validateToRawMessage(this.globalSignaturePolicy,_);if(!C.valid)return{code:MessageStatus.invalid,reason:RejectReason.Error,error:C.error};const A=C.message;try{this.dataTransform!=null&&(A.data=this.dataTransform.inboundTransform(_.topic,A.data))}catch(U){return this.log("Invalid message, transform failed",U),{code:MessageStatus.invalid,reason:RejectReason.Error,error:ValidateError.TransformFailed}}const I=await this.msgIdFn(A),B=this.msgIdToStrFn(I),O={msgId:I,msgIdStr:B};if(E!==void 0&&this.fastMsgIdCache!=null&&this.fastMsgIdCache.put(E,B)&&this.metrics?.fastMsgIdCacheCollision.inc(),this.seenCache.has(B))return{code:MessageStatus.duplicate,msgIdStr:B};this.seenCache.put(B);const N=this.topicValidators.get(_.topic);if(N!=null){let U;try{U=await N(r,A)}catch(j){const z=j.code;z===ERR_TOPIC_VALIDATOR_IGNORE&&(U=TopicValidatorResult.Ignore),z===ERR_TOPIC_VALIDATOR_REJECT?U=TopicValidatorResult.Reject:U=TopicValidatorResult.Ignore}if(U!==TopicValidatorResult.Accept)return{code:MessageStatus.invalid,reason:rejectReasonFromAcceptance(U),msgIdStr:B}}return{code:MessageStatus.valid,messageId:O,msg:A}}getScore(r){return this.score.score(r)}sendSubscriptions(r,_,E){this.sendRpc(r,{subscriptions:_.map(S=>({topic:S,subscribe:E}))})}async handleControlMessage(r,_){if(_===void 0)return;const E=_.ihave!=null?this.handleIHave(r,_.ihave):[],S=_.iwant!=null?this.handleIWant(r,_.iwant):[],C=_.graft!=null?await this.handleGraft(r,_.graft):[];if(_.prune!=null&&await this.handlePrune(r,_.prune),E.length===0&&S.length===0&&C.length===0)return;const A=this.sendRpc(r,{messages:S,control:{iwant:E,prune:C}}),I=E[0]?.messageIDs;I!=null&&(A?this.gossipTracer.addPromise(r,I):this.metrics?.iwantPromiseUntracked.inc(1))}acceptFrom(r){if(this.direct.has(r))return!0;const _=Date.now(),E=this.acceptFromWhitelist.get(r);if(E!=null&&E.messagesAccepted<ACCEPT_FROM_WHITELIST_MAX_MESSAGES&&E.acceptUntil>=_)return E.messagesAccepted+=1,!0;const S=this.score.score(r);return S>=ACCEPT_FROM_WHITELIST_THRESHOLD_SCORE?this.acceptFromWhitelist.set(r,{messagesAccepted:0,acceptUntil:_+ACCEPT_FROM_WHITELIST_DURATION_MS}):this.acceptFromWhitelist.delete(r),S>=this.opts.scoreThresholds.graylistThreshold}handleIHave(r,_){if(_.length===0)return[];const E=this.score.score(r);if(E<this.opts.scoreThresholds.gossipThreshold)return this.log("IHAVE: ignoring peer %s with score below threshold [ score = %d ]",r,E),this.metrics?.ihaveRcvIgnored.inc({reason:IHaveIgnoreReason.LowScore}),[];const S=(this.peerhave.get(r)??0)+1;if(this.peerhave.set(r,S),S>GossipsubMaxIHaveMessages)return this.log("IHAVE: peer %s has advertised too many times (%d) within this heartbeat interval; ignoring",r,S),this.metrics?.ihaveRcvIgnored.inc({reason:IHaveIgnoreReason.MaxIhave}),[];const C=this.iasked.get(r)??0;if(C>=GossipsubMaxIHaveLength)return this.log("IHAVE: peer %s has already advertised too many messages (%d); ignoring",r,C),this.metrics?.ihaveRcvIgnored.inc({reason:IHaveIgnoreReason.MaxIasked}),[];const A=new Map;if(_.forEach(({topicID:O,messageIDs:N})=>{if(O==null||N==null||!this.mesh.has(O))return;let U=0;N.forEach(j=>{const z=this.msgIdToStrFn(j);this.seenCache.has(z)||(A.set(z,j),U++)}),this.metrics?.onIhaveRcv(O,N.length,U)}),A.size===0)return[];let I=A.size;I+C>GossipsubMaxIHaveLength&&(I=GossipsubMaxIHaveLength-C),this.log("IHAVE: Asking for %d out of %d messages from %s",I,A.size,r);let B=Array.from(A.values());return shuffle(B),B=B.slice(0,I),this.iasked.set(r,C+I),[{messageIDs:B}]}handleIWant(r,_){if(_.length===0)return[];const E=this.score.score(r);if(E<this.opts.scoreThresholds.gossipThreshold)return this.log("IWANT: ignoring peer %s with score below threshold [score = %d]",r,E),[];const S=new Map,C=new Map;let A=0;return _.forEach(({messageIDs:I})=>{I?.forEach(B=>{const O=this.msgIdToStrFn(B),N=this.mcache.getWithIWantCount(O,r);if(N==null){A++;return}if(C.set(N.msg.topic,1+(C.get(N.msg.topic)??0)),N.count>GossipsubGossipRetransmission){this.log("IWANT: Peer %s has asked for message %s too many times: ignoring request",r,B);return}S.set(O,N.msg)})}),this.metrics?.onIwantRcv(C,A),S.size===0?(this.log("IWANT: Could not provide any wanted messages to %s",r),[]):(this.log("IWANT: Sending %d messages to %s",S.size,r),Array.from(S.values()))}async handleGraft(r,_){const E=[],S=this.score.score(r),C=Date.now();let A=this.opts.doPX;if(_.forEach(({topicID:B})=>{if(B==null)return;const O=this.mesh.get(B);if(O==null){A=!1;return}if(O.has(r))return;if(this.direct.has(r)){this.log("GRAFT: ignoring request from direct peer %s",r),E.push(B),A=!1;return}const N=this.backoff.get(B)?.get(r);if(typeof N=="number"&&C<N){this.log("GRAFT: ignoring backed off peer %s",r),this.score.addPenalty(r,1,ScorePenalty.GraftBackoff),A=!1;const U=N+this.opts.graftFloodThreshold-this.opts.pruneBackoff;C<U&&this.score.addPenalty(r,1,ScorePenalty.GraftBackoff),this.addBackoff(r,B),E.push(B);return}if(S<0){this.log("GRAFT: ignoring peer %s with negative score: score=%d, topic=%s",r,S,B),E.push(B),A=!1,this.addBackoff(r,B);return}if(O.size>=this.opts.Dhi&&!(this.outbound.get(r)??!1)){E.push(B),this.addBackoff(r,B);return}this.log("GRAFT: Add mesh link from %s in %s",r,B),this.score.graft(r,B),O.add(r),this.metrics?.onAddToMesh(B,InclusionReason.Subscribed,1)}),E.length===0)return[];const I=!1;return Promise.all(E.map(async B=>this.makePrune(r,B,A,I)))}async handlePrune(r,_){const E=this.score.score(r);for(const{topicID:S,backoff:C,peers:A}of _){if(S==null)continue;const I=this.mesh.get(S);if(I==null)return;if(this.log("PRUNE: Remove mesh link to %s in %s",r,S),this.score.prune(r,S),I.has(r)&&(I.delete(r),this.metrics?.onRemoveFromMesh(S,ChurnReason.Prune,1)),typeof C=="number"&&C>0?this.doAddBackoff(r,S,C*1e3):this.addBackoff(r,S),A!=null&&A.length>0){if(E<this.opts.scoreThresholds.acceptPXThreshold){this.log("PRUNE: ignoring PX from peer %s with insufficient score [score = %d, topic = %s]",r,E,S);continue}await this.pxConnect(A)}}}addBackoff(r,_){this.doAddBackoff(r,_,this.opts.pruneBackoff)}doAddBackoff(r,_,E){let S=this.backoff.get(_);S==null&&(S=new Map,this.backoff.set(_,S));const C=Date.now()+E;(S.get(r)??0)<C&&S.set(r,C)}applyIwantPenalties(){this.gossipTracer.getBrokenPromises().forEach((r,_)=>{this.log("peer %s didn't follow up in %d IWANT requests; adding penalty",_,r),this.score.addPenalty(_,r,ScorePenalty.BrokenPromise)})}clearBackoff(){if(this.heartbeatTicks%GossipsubPruneBackoffTicks!==0)return;const r=Date.now();this.backoff.forEach((_,E)=>{_.forEach((S,C)=>{S+BACKOFF_SLACK*this.opts.heartbeatInterval<r&&_.delete(C)}),_.size===0&&this.backoff.delete(E)})}async directConnect(){const r=[];this.direct.forEach(_=>{this.streamsOutbound.has(_)||r.push(_)}),await Promise.all(r.map(async _=>this.connect(_)))}async pxConnect(r){r.length>this.opts.prunePeers&&(shuffle(r),r=r.slice(0,this.opts.prunePeers));const _=[];await Promise.all(r.map(async E=>{if(E.peerID==null)return;const S=peerIdFromBytes$1(E.peerID),C=S.toString();if(!this.peers.has(C)){if(E.signedPeerRecord==null){_.push(C);return}try{if(!await this.components.peerStore.consumePeerRecord(E.signedPeerRecord,S)){this.log("bogus peer record obtained through px: could not add peer record to address book");return}_.push(C)}catch{this.log("bogus peer record obtained through px: invalid signature or not a peer record")}}})),_.length!==0&&await Promise.all(_.map(async E=>this.connect(E)))}async connect(r){this.log("Initiating connection with %s",r);const _=peerIdFromString$1(r),E=await this.components.connectionManager.openConnection(_);for(const S of this.multicodecs)for(const C of this.components.registrar.getTopologies(S))C.onConnect?.(_,E)}subscribe(r){if(this.status.code!==GossipStatusCode.started)throw new Error("Pubsub has not started");if(!this.subscriptions.has(r)){this.subscriptions.add(r);for(const _ of this.peers.keys())this.sendSubscriptions(_,[r],!0)}this.join(r)}unsubscribe(r){if(this.status.code!==GossipStatusCode.started)throw new Error("Pubsub is not started");const _=this.subscriptions.delete(r);if(this.log("unsubscribe from %s - am subscribed %s",r,_),_)for(const E of this.peers.keys())this.sendSubscriptions(E,[r],!1);this.leave(r)}join(r){if(this.status.code!==GossipStatusCode.started)throw new Error("Gossipsub has not started");if(this.mesh.has(r))return;this.log("JOIN %s",r),this.metrics?.onJoin(r);const _=new Set,E=this.backoff.get(r),S=this.fanout.get(r);if(S!=null&&(this.fanout.delete(r),this.fanoutLastpub.delete(r),S.forEach(C=>{!this.direct.has(C)&&this.score.score(C)>=0&&(E==null||!E.has(C))&&_.add(C)}),this.metrics?.onAddToMesh(r,InclusionReason.Fanout,_.size)),_.size<this.opts.D){const C=_.size;this.getRandomGossipPeers(r,this.opts.D,I=>!_.has(I)&&!this.direct.has(I)&&this.score.score(I)>=0&&(E==null||!E.has(I))).forEach(I=>{_.add(I)}),this.metrics?.onAddToMesh(r,InclusionReason.Random,_.size-C)}this.mesh.set(r,_),_.forEach(C=>{this.log("JOIN: Add mesh link to %s in %s",C,r),this.sendGraft(C,r)})}leave(r){if(this.status.code!==GossipStatusCode.started)throw new Error("Gossipsub has not started");this.log("LEAVE %s",r),this.metrics?.onLeave(r);const _=this.mesh.get(r);_!=null&&(Promise.all(Array.from(_).map(async E=>{this.log("LEAVE: Remove mesh link to %s in %s",E,r),await this.sendPrune(E,r)})).catch(E=>{this.log("Error sending prunes to mesh peers",E)}),this.mesh.delete(r))}selectPeersToForward(r,_,E){const S=new Set,C=this.topics.get(r);C!=null&&(this.direct.forEach(I=>{C.has(I)&&_!==I&&!(E?.has(I)??!1)&&S.add(I)}),this.floodsubPeers.forEach(I=>{C.has(I)&&_!==I&&!(E?.has(I)??!1)&&this.score.score(I)>=this.opts.scoreThresholds.publishThreshold&&S.add(I)}));const A=this.mesh.get(r);return A!=null&&A.size>0&&A.forEach(I=>{_!==I&&!(E?.has(I)??!1)&&S.add(I)}),S}selectPeersToPublish(r){const _=new Set,E={direct:0,floodsub:0,mesh:0,fanout:0},S=this.topics.get(r);if(S!=null)if(this.opts.floodPublish)S.forEach(C=>{this.direct.has(C)?(_.add(C),E.direct++):this.score.score(C)>=this.opts.scoreThresholds.publishThreshold&&(_.add(C),E.floodsub++)});else{this.direct.forEach(A=>{S.has(A)&&(_.add(A),E.direct++)}),this.floodsubPeers.forEach(A=>{S.has(A)&&this.score.score(A)>=this.opts.scoreThresholds.publishThreshold&&(_.add(A),E.floodsub++)});const C=this.mesh.get(r);if(C!=null&&C.size>0)C.forEach(A=>{_.add(A),E.mesh++});else{const A=this.fanout.get(r);if(A!=null&&A.size>0)A.forEach(I=>{_.add(I),E.fanout++});else{const I=this.getRandomGossipPeers(r,this.opts.D,B=>this.score.score(B)>=this.opts.scoreThresholds.publishThreshold);I.size>0&&(this.fanout.set(r,I),I.forEach(B=>{_.add(B),E.fanout++}))}this.fanoutLastpub.set(r,Date.now())}}return{tosend:_,tosendCount:E}}forwardMessage(r,_,E,S){E!=null&&this.score.deliverMessage(E,r,_.topic);const C=this.selectPeersToForward(_.topic,E,S);C.forEach(A=>{this.sendRpc(A,{messages:[_]})}),this.metrics?.onForwardMsg(_.topic,C.size)}async publish(r,_,E){const S=Date.now(),C=this.dataTransform!=null?this.dataTransform.outboundTransform(r,_):_;if(this.publishConfig==null)throw Error("PublishError.Uninitialized");const{raw:A,msg:I}=await buildRawMessage(this.publishConfig,r,_,C),B=await this.msgIdFn(I),O=this.msgIdToStrFn(B),N=E?.ignoreDuplicatePublishError??this.opts.ignoreDuplicatePublishError;if(this.seenCache.has(O)){if(N)return this.metrics?.onPublishDuplicateMsg(r),{recipients:[]};throw Error("PublishError.Duplicate")}const{tosend:U,tosendCount:j}=this.selectPeersToPublish(r),z=this.opts.emitSelf&&this.subscriptions.has(r),Z=E?.allowPublishToZeroPeers??this.opts.allowPublishToZeroPeers;if(U.size===0&&!Z&&!z)throw Error("PublishError.InsufficientPeers");this.seenCache.put(O),this.mcache.put({msgId:B,msgIdStr:O},A,!0),this.publishedMessageIds.put(O);const X=E?.batchPublish??this.opts.batchPublish,Q={messages:[A]};if(X)this.sendRpcInBatch(U,Q);else for(const oe of U)this.sendRpc(oe,Q)||U.delete(oe);const se=Date.now()-S;return this.metrics?.onPublishMsg(r,j,U.size,A.data!=null?A.data.length:0,se),z&&(U.add(this.components.peerId.toString()),super.dispatchEvent(new CustomEvent$1("gossipsub:message",{detail:{propagationSource:this.components.peerId,msgId:O,msg:I}})),super.dispatchEvent(new CustomEvent$1("message",{detail:I}))),{recipients:Array.from(U.values()).map(oe=>peerIdFromString$1(oe))}}sendRpcInBatch(r,_){const E=RPC$1.encode(_).finish(),S=encode$6.single(E);for(const C of r){const A=this.streamsOutbound.get(C);if(A==null){this.log(`Cannot send RPC to ${C} as there is no open stream to it available`),r.delete(C);continue}try{A.pushPrefixed(S)}catch(I){r.delete(C),this.log.error(`Cannot send rpc to ${C}`,I)}this.metrics?.onRpcSent(_,E.length)}}reportMessageValidationResult(r,_,E){let S;if(E===TopicValidatorResult.Accept){if(S=this.mcache.validate(r),S!=null){const{message:A,originatingPeers:I}=S;this.score.deliverMessage(_,r,A.topic),this.forwardMessage(r,S.message,_,I)}}else if(S=this.mcache.remove(r),S!=null){const A=rejectReasonFromAcceptance(E),{message:I,originatingPeers:B}=S;this.score.rejectMessage(_,r,I.topic,A);for(const O of B)this.score.rejectMessage(O,r,I.topic,A)}const C=this.score.messageFirstSeenTimestampMs(r);this.metrics?.onReportValidation(S,E,C)}sendGraft(r,_){const E=[{topicID:_}];this.sendRpc(r,{control:{graft:E}})}async sendPrune(r,_){const S=[await this.makePrune(r,_,this.opts.doPX,!0)];this.sendRpc(r,{control:{prune:S}})}sendRpc(r,_){const E=this.streamsOutbound.get(r);if(E==null)return this.log(`Cannot send RPC to ${r} as there is no open stream to it available`),!1;const S=this.control.get(r);S!=null&&(this.piggybackControl(r,_,S),this.control.delete(r));const C=this.gossip.get(r);C!=null&&(this.piggybackGossip(r,_,C),this.gossip.delete(r));const A=RPC$1.encode(_).finish();try{E.push(A)}catch(I){return this.log.error(`Cannot send rpc to ${r}`,I),S!=null&&this.control.set(r,S),C!=null&&this.gossip.set(r,C),!1}return this.metrics?.onRpcSent(_,A.length),!0}piggybackControl(r,_,E){if(E.graft!=null){_.control==null&&(_.control={}),_.control.graft==null&&(_.control.graft=[]);for(const S of E.graft)S.topicID!=null&&(this.mesh.get(S.topicID)?.has(r)??!1)&&_.control.graft.push(S)}if(E.prune!=null){_.control==null&&(_.control={}),_.control.prune==null&&(_.control.prune=[]);for(const S of E.prune)S.topicID!=null&&!(this.mesh.get(S.topicID)?.has(r)??!1)&&_.control.prune.push(S)}}piggybackGossip(r,_,E){_.control==null&&(_.control={}),_.control.ihave=E}async sendGraftPrune(r,_,E){const S=this.opts.doPX,C=!1;for(const[A,I]of r){const B=I.map(U=>({topicID:U}));let O=[];const N=_.get(A);N!=null&&(O=await Promise.all(N.map(async U=>this.makePrune(A,U,S&&!(E.get(A)??!1),C))),_.delete(A)),this.sendRpc(A,{control:{graft:B,prune:O}})}for(const[A,I]of _){const B=await Promise.all(I.map(async O=>this.makePrune(A,O,S&&!(E.get(A)??!1),C)));this.sendRpc(A,{control:{prune:B}})}}emitGossip(r){const _=this.mcache.getGossipIDs(new Set(r.keys()));for(const[E,S]of r)this.doEmitGossip(E,S,_.get(E)??[])}doEmitGossip(r,_,E){if(E.length===0||(shuffle(E),E.length>GossipsubMaxIHaveLength&&this.log("too many messages for gossip; will truncate IHAVE list (%d messages)",E.length),_.size===0))return;let S=this.opts.Dlazy;const C=GossipsubGossipFactor*_.size;let A=_;C>S&&(S=C),S>A.size?S=A.size:A=shuffle(Array.from(A)).slice(0,S),A.forEach(I=>{let B=E;E.length>GossipsubMaxIHaveLength&&(B=shuffle(B.slice()).slice(0,GossipsubMaxIHaveLength)),this.pushGossip(I,{topicID:r,messageIDs:B})})}flush(){for(const[r,_]of this.gossip.entries())this.gossip.delete(r),this.sendRpc(r,{control:{ihave:_}});for(const[r,_]of this.control.entries())this.control.delete(r),this.sendRpc(r,{control:{graft:_.graft,prune:_.prune}})}pushGossip(r,_){this.log("Add gossip to %s",r);const E=this.gossip.get(r)??[];this.gossip.set(r,E.concat(_))}async makePrune(r,_,E,S){if(this.score.prune(r,_),this.streamsOutbound.get(r)?.protocol===GossipsubIDv10)return{topicID:_,peers:[]};const C=S?this.opts.unsubcribeBackoff:this.opts.pruneBackoff,A=C/1e3;if(this.doAddBackoff(r,_,C),!E)return{topicID:_,peers:[],backoff:A};const I=this.getRandomGossipPeers(_,this.opts.prunePeers,O=>O!==r&&this.score.score(O)>=0),B=await Promise.all(Array.from(I).map(async O=>{const N=peerIdFromString$1(O);let U;try{U=await this.components.peerStore.get(N)}catch(j){if(j.code!=="ERR_NOT_FOUND")throw j}return{peerID:N.toBytes(),signedPeerRecord:U?.peerRecordEnvelope}}));return{topicID:_,peers:B,backoff:A}}runHeartbeat=()=>{const r=this.metrics?.heartbeatDuration.startTimer();this.heartbeat().catch(_=>{this.log("Error running heartbeat",_)}).finally(()=>{if(r?.(),this.status.code===GossipStatusCode.started){clearTimeout(this.status.heartbeatTimeout);let _=this.opts.heartbeatInterval-(Date.now()-this.status.hearbeatStartMs)%this.opts.heartbeatInterval;_<this.opts.heartbeatInterval*.25&&(_+=this.opts.heartbeatInterval,this.metrics?.heartbeatSkipped.inc()),this.status.heartbeatTimeout=setTimeout(this.runHeartbeat,_)}})};async heartbeat(){const{D:r,Dlo:_,Dhi:E,Dscore:S,Dout:C,fanoutTTL:A}=this.opts;this.heartbeatTicks++;const I=new Map,B=Z=>{let X=I.get(Z);return X===void 0&&(X=this.score.score(Z),I.set(Z,X)),X},O=new Map,N=new Map,U=new Map;this.clearBackoff(),this.peerhave.clear(),this.metrics?.cacheSize.set({cache:"iasked"},this.iasked.size),this.iasked.clear(),this.applyIwantPenalties(),this.heartbeatTicks%this.opts.directConnectTicks===0&&await this.directConnect(),this.fastMsgIdCache?.prune(),this.seenCache.prune(),this.gossipTracer.prune(),this.publishedMessageIds.prune();const j=new Map;this.mesh.forEach((Z,X)=>{const Q=this.topics.get(X),se=new Set,oe=new Set;if(j.set(X,oe),Q!=null){const Te=shuffle(Array.from(Q)),xe=this.backoff.get(X);for(const Re of Te){const Ne=this.streamsOutbound.get(Re);if(Ne!=null&&this.multicodecs.includes(Ne.protocol)&&!Z.has(Re)&&!this.direct.has(Re)){const Fe=B(Re);(xe==null||!xe.has(Re))&&Fe>=0&&se.add(Re),Fe>=this.opts.scoreThresholds.gossipThreshold&&oe.add(Re)}}}const ue=(Te,xe)=>{this.log("HEARTBEAT: Remove mesh link to %s in %s",Te,X),this.addBackoff(Te,X),Z.delete(Te),B(Te)>=this.opts.scoreThresholds.gossipThreshold&&oe.add(Te),this.metrics?.onRemoveFromMesh(X,xe,1);const Re=N.get(Te);Re==null?N.set(Te,[X]):Re.push(X)},we=(Te,xe)=>{this.log("HEARTBEAT: Add mesh link to %s in %s",Te,X),this.score.graft(Te,X),Z.add(Te),oe.delete(Te),this.metrics?.onAddToMesh(X,xe,1);const Re=O.get(Te);Re==null?O.set(Te,[X]):Re.push(X)};if(Z.forEach(Te=>{const xe=B(Te);xe<0&&(this.log("HEARTBEAT: Prune peer %s with negative score: score=%d, topic=%s",Te,xe,X),ue(Te,ChurnReason.BadScore),U.set(Te,!0))}),Z.size<_){const Te=r-Z.size;removeFirstNItemsFromSet(se,Te).forEach(Re=>{we(Re,InclusionReason.NotEnough)})}if(Z.size>E){let Te=Array.from(Z);Te.sort((Re,Ne)=>B(Ne)-B(Re)),Te=Te.slice(0,S).concat(shuffle(Te.slice(S)));let xe=0;if(Te.slice(0,r).forEach(Re=>{(this.outbound.get(Re)??!1)&&xe++}),xe<C){const Re=Fe=>{const ht=Te[Fe];for(let nt=Fe;nt>0;nt--)Te[nt]=Te[nt-1];Te[0]=ht};if(xe>0){let Fe=xe;for(let ht=1;ht<r&&Fe>0;ht++)(this.outbound.get(Te[ht])??!1)&&(Re(ht),Fe--)}let Ne=r-xe;for(let Fe=r;Fe<Te.length&&Ne>0;Fe++)(this.outbound.get(Te[Fe])??!1)&&(Re(Fe),Ne--)}Te.slice(r).forEach(Re=>{ue(Re,ChurnReason.Excess)})}if(Z.size>=_){let Te=0;if(Z.forEach(xe=>{(this.outbound.get(xe)??!1)&&Te++}),Te<C){const xe=C-Te;removeItemsFromSet(se,xe,Ne=>this.outbound.get(Ne)===!0).forEach(Ne=>{we(Ne,InclusionReason.Outbound)})}}if(this.heartbeatTicks%this.opts.opportunisticGraftTicks===0&&Z.size>1){const Te=Array.from(Z).sort((Ne,Fe)=>B(Ne)-B(Fe)),xe=Math.floor(Z.size/2),Re=B(Te[xe]);if(Re<this.opts.scoreThresholds.opportunisticGraftThreshold){const Ne=this.opts.opportunisticGraftPeers,Fe=removeItemsFromSet(se,Ne,ht=>B(ht)>Re);for(const ht of Fe)this.log("HEARTBEAT: Opportunistically graft peer %s on topic %s",ht,X),we(ht,InclusionReason.Opportunistic)}}});const z=Date.now();this.fanoutLastpub.forEach((Z,X)=>{Z+A<z&&(this.fanout.delete(X),this.fanoutLastpub.delete(X))}),this.fanout.forEach((Z,X)=>{const Q=this.topics.get(X);Z.forEach(we=>{(!(Q?.has(we)??!1)||B(we)<this.opts.scoreThresholds.publishThreshold)&&Z.delete(we)});const se=this.topics.get(X),oe=[],ue=new Set;if(j.set(X,ue),se!=null){const we=shuffle(Array.from(se));for(const Te of we){const xe=this.streamsOutbound.get(Te);if(xe!=null&&this.multicodecs.includes(xe.protocol)&&!Z.has(Te)&&!this.direct.has(Te)){const Re=B(Te);Re>=this.opts.scoreThresholds.publishThreshold&&oe.push(Te),Re>=this.opts.scoreThresholds.gossipThreshold&&ue.add(Te)}}}if(Z.size<r){const we=r-Z.size;oe.slice(0,we).forEach(Te=>{Z.add(Te),ue?.delete(Te)})}}),this.emitGossip(j),await this.sendGraftPrune(O,N,U),this.flush(),this.mcache.shift(),this.dispatchEvent(new CustomEvent$1("gossipsub:heartbeat"))}getRandomGossipPeers(r,_,E=()=>!0){const S=this.topics.get(r);if(S==null)return new Set;let C=[];return S.forEach(A=>{const I=this.streamsOutbound.get(A);I!=null&&this.multicodecs.includes(I.protocol)&&E(A)&&C.push(A)}),C=shuffle(C),_>0&&C.length>_&&(C=C.slice(0,_)),new Set(C)}onScrapeMetrics(r){r.mcacheSize.set(this.mcache.size),r.mcacheNotValidatedCount.set(this.mcache.notValidatedCount),r.cacheSize.set({cache:"direct"},this.direct.size),r.cacheSize.set({cache:"seenCache"},this.seenCache.size),r.cacheSize.set({cache:"fastMsgIdCache"},this.fastMsgIdCache?.size??0),r.cacheSize.set({cache:"publishedMessageIds"},this.publishedMessageIds.size),r.cacheSize.set({cache:"mcache"},this.mcache.size),r.cacheSize.set({cache:"score"},this.score.size),r.cacheSize.set({cache:"gossipTracer.promises"},this.gossipTracer.size),r.cacheSize.set({cache:"gossipTracer.requests"},this.gossipTracer.requestMsByMsgSize),r.cacheSize.set({cache:"topics"},this.topics.size),r.cacheSize.set({cache:"subscriptions"},this.subscriptions.size),r.cacheSize.set({cache:"mesh"},this.mesh.size),r.cacheSize.set({cache:"fanout"},this.fanout.size),r.cacheSize.set({cache:"peers"},this.peers.size),r.cacheSize.set({cache:"streamsOutbound"},this.streamsOutbound.size),r.cacheSize.set({cache:"streamsInbound"},this.streamsInbound.size),r.cacheSize.set({cache:"acceptFromWhitelist"},this.acceptFromWhitelist.size),r.cacheSize.set({cache:"gossip"},this.gossip.size),r.cacheSize.set({cache:"control"},this.control.size),r.cacheSize.set({cache:"peerhave"},this.peerhave.size),r.cacheSize.set({cache:"outbound"},this.outbound.size);let _=0;const E=Date.now();r.connectedPeersBackoffSec.reset();for(const I of this.backoff.values()){_+=I.size;for(const[B,O]of I.entries())this.peers.has(B)&&r.connectedPeersBackoffSec.observe(Math.max(0,O-E)/1e3)}r.cacheSize.set({cache:"backoff"},_);for(const[I,B]of this.topics)r.topicPeersCount.set({topicStr:I},B.size);for(const[I,B]of this.mesh)r.meshPeerCounts.set({topicStr:I},B.size);const S=[],C=new Map;r.behaviourPenalty.reset();for(const I of this.peers.keys()){const B=this.score.score(I);S.push(B),C.set(I,B),r.behaviourPenalty.observe(this.score.peerStats.get(I)?.behaviourPenalty??0)}r.registerScores(S,this.opts.scoreThresholds),r.registerScorePerMesh(this.mesh,C);const A=computeAllPeersScoreWeights(this.peers.keys(),this.score.peerStats,this.score.params,this.score.peerIPs,r.topicStrToLabel);r.registerScoreWeights(A)}}function gossipsub(n={}){return r=>new GossipSub(r,n)}class QueuelessPushable{readNext;haveNext;ended;nextResult;constructor(){this.ended=!1,this.readNext=pDefer(),this.haveNext=pDefer()}[Symbol.asyncIterator](){return this}async next(){if(this.nextResult==null&&await this.haveNext.promise,this.nextResult==null)throw new Error("HaveNext promise resolved but nextResult was undefined");const r=this.nextResult;return this.nextResult=void 0,this.readNext.resolve(),this.readNext=pDefer(),r}async throw(r){return this.ended=!0,r!=null&&this.haveNext.reject(r),{done:!0,value:void 0}}async return(){const r={done:!0,value:void 0};return await this._push(void 0),r}async push(r,_){await this._push(r,_)}async end(r,_){r!=null?await this.throw(r):await this._push(void 0,_)}async _push(r,_){if(r!=null&&this.ended)throw new Error("Cannot push value onto an ended pushable");if(this.nextResult!=null&&(await this.readNext.promise,this.nextResult!=null))throw new Error("NeedNext promise resolved but nextResult was not consumed");r!=null?this.nextResult={done:!1,value:r}:(this.ended=!0,this.nextResult={done:!0,value:void 0}),this.haveNext.resolve(),this.haveNext=pDefer(),await raceSignal(this.readNext.promise,_?.signal,_)}}function pushable(){return new QueuelessPushable}let CodeError$2=class extends Error{code;constructor(r,_){super(r),this.code=_}},AbortError$2=class extends CodeError$2{type;constructor(r){super(r,"ABORT_ERR"),this.type="aborted"}};function byteStream(n,r){const _=pushable();n.sink(_).catch(async A=>{await _.end(A)}),n.sink=async A=>{for await(const I of A)await _.push(I);await _.end()};let E=n.source;n.source[Symbol.iterator]!=null?E=n.source[Symbol.iterator]():n.source[Symbol.asyncIterator]!=null&&(E=n.source[Symbol.asyncIterator]());const S=new Uint8ArrayList;return{read:async(A,I)=>{I?.signal?.throwIfAborted();let B;const O=new Promise((N,U)=>{B=()=>{U(new AbortError$2("Read aborted"))},I?.signal?.addEventListener("abort",B)});try{if(A==null){const{done:U,value:j}=await Promise.race([E.next(),O]);return U===!0?new Uint8ArrayList:j}for(;S.byteLength<A;){const{value:U,done:j}=await Promise.race([E.next(),O]);if(j===!0)throw new CodeError$2("unexpected end of input","ERR_UNEXPECTED_EOF");S.append(U)}const N=S.sublist(0,A);return S.consume(A),N}finally{B!=null&&I?.signal?.removeEventListener("abort",B)}},write:async(A,I)=>{I?.signal?.throwIfAborted(),A instanceof Uint8Array?await _.push(A,I):await _.push(A.subarray(),I)},unwrap:()=>{if(S.byteLength>0){const A=n.source;n.source=async function*(){r?.yieldBytes===!1?yield S:yield*S,yield*A}()}return n}}}let CodeError$1=class extends Error{code;constructor(r,_){super(r),this.code=_}};function lpStream(n,r={}){const _=byteStream(n,r);r.maxDataLength!=null&&r.maxLengthLength==null&&(r.maxLengthLength=encodingLength(r.maxDataLength));const E=r?.lengthDecoder??decode$b,S=r?.lengthEncoder??encode$b;return{read:async A=>{let I=-1;const B=new Uint8ArrayList;for(;;){B.append(await _.read(1,A));try{I=E(B)}catch(O){if(O instanceof RangeError)continue;throw O}if(r?.maxLengthLength!=null&&B.byteLength>r.maxLengthLength)throw new CodeError$1("message length length too long","ERR_MSG_LENGTH_TOO_LONG");if(I>-1)break}if(r?.maxDataLength!=null&&I>r.maxDataLength)throw new CodeError$1("message length too long","ERR_MSG_DATA_TOO_LONG");return _.read(I,A)},write:async(A,I)=>{await _.write(new Uint8ArrayList(S(A.byteLength),A),I)},writeV:async(A,I)=>{const B=new Uint8ArrayList(...A.flatMap(O=>[S(O.byteLength),O]));await _.write(B,I)},unwrap:()=>_.unwrap()}}function pair(){const n=pDefer();let r=!1;return{sink:async _=>{if(r)throw new Error("already piped");r=!0,n.resolve(_)},source:async function*(){yield*await n.promise}()}}function duplexPair(){const n=pair(),r=pair();return[{source:n.source,sink:r.sink},{source:r.source,sink:n.sink}]}const NOISE_MSG_MAX_LENGTH_BYTES$1=65535,NOISE_MSG_MAX_LENGTH_BYTES_WITHOUT_TAG$1=NOISE_MSG_MAX_LENGTH_BYTES$1-16,DUMP_SESSION_KEYS$1=!!globalThis.process?.env?.DUMP_SESSION_KEYS;/*! noble-ciphers - MIT License (c) 2023 Paul Miller (paulmillr.com) */const u32=n=>new Uint32Array(n.buffer,n.byteOffset,Math.floor(n.byteLength/4));function isBytes$1(n){return n instanceof Uint8Array||n!=null&&typeof n=="object"&&n.constructor.name==="Uint8Array"}const createView=n=>new DataView(n.buffer,n.byteOffset,n.byteLength),isLE=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;if(!isLE)throw new Error("Non little-endian hardware is not supported");function utf8ToBytes(n){if(typeof n!="string")throw new Error(`utf8ToBytes expected string, got ${typeof n}`);return new Uint8Array(new TextEncoder().encode(n))}function toBytes(n){if(typeof n=="string")n=utf8ToBytes(n);else if(isBytes$1(n))n=n.slice();else throw new Error(`expected Uint8Array, got ${typeof n}`);return n}const isPlainObject=n=>Object.prototype.toString.call(n)==="[object Object]"&&n.constructor===Object;function checkOpts(n,r){if(r!==void 0&&(typeof r!="object"||!isPlainObject(r)))throw new Error("options must be object or undefined");return Object.assign(n,r)}function ensureBytes(n,r){if(!isBytes$1(n))throw new Error("Uint8Array expected");if(typeof r=="number"&&n.length!==r)throw new Error(`Uint8Array length ${r} expected`)}function equalBytes(n,r){if(n.length!==r.length)return!1;let _=0;for(let E=0;E<n.length;E++)_|=n[E]^r[E];return _===0}const wrapCipher=(n,r)=>(Object.assign(r,n),r);function setBigUint64(n,r,_,E){if(typeof n.setBigUint64=="function")return n.setBigUint64(r,_,E);const S=BigInt(32),C=BigInt(4294967295),A=Number(_>>S&C),I=Number(_&C),B=E?4:0,O=E?0:4;n.setUint32(r+B,A,E),n.setUint32(r+O,I,E)}function number$1(n){if(!Number.isSafeInteger(n)||n<0)throw new Error(`wrong positive integer: ${n}`)}function bool(n){if(typeof n!="boolean")throw new Error(`boolean expected, not ${n}`)}function isBytes(n){return n!=null&&typeof n=="object"&&(n instanceof Uint8Array||n.constructor.name==="Uint8Array")}function bytes(n,...r){if(!isBytes(n))throw new Error("Uint8Array expected");if(r.length>0&&!r.includes(n.length))throw new Error(`Uint8Array expected of length ${r}, not of length=${n.length}`)}function exists(n,r=!0){if(n.destroyed)throw new Error("Hash instance has been destroyed");if(r&&n.finished)throw new Error("Hash#digest() has already been called")}function output(n,r){bytes(n);const _=r.outputLen;if(n.length<_)throw new Error(`digestInto() expects output buffer of length at least ${_}`)}const u8to16=(n,r)=>n[r++]&255|(n[r++]&255)<<8;class Poly1305{constructor(r){this.blockLen=16,this.outputLen=16,this.buffer=new Uint8Array(16),this.r=new Uint16Array(10),this.h=new Uint16Array(10),this.pad=new Uint16Array(8),this.pos=0,this.finished=!1,r=toBytes(r),ensureBytes(r,32);const _=u8to16(r,0),E=u8to16(r,2),S=u8to16(r,4),C=u8to16(r,6),A=u8to16(r,8),I=u8to16(r,10),B=u8to16(r,12),O=u8to16(r,14);this.r[0]=_&8191,this.r[1]=(_>>>13|E<<3)&8191,this.r[2]=(E>>>10|S<<6)&7939,this.r[3]=(S>>>7|C<<9)&8191,this.r[4]=(C>>>4|A<<12)&255,this.r[5]=A>>>1&8190,this.r[6]=(A>>>14|I<<2)&8191,this.r[7]=(I>>>11|B<<5)&8065,this.r[8]=(B>>>8|O<<8)&8191,this.r[9]=O>>>5&127;for(let N=0;N<8;N++)this.pad[N]=u8to16(r,16+2*N)}process(r,_,E=!1){const S=E?0:2048,{h:C,r:A}=this,I=A[0],B=A[1],O=A[2],N=A[3],U=A[4],j=A[5],z=A[6],Z=A[7],X=A[8],Q=A[9],se=u8to16(r,_+0),oe=u8to16(r,_+2),ue=u8to16(r,_+4),we=u8to16(r,_+6),Te=u8to16(r,_+8),xe=u8to16(r,_+10),Re=u8to16(r,_+12),Ne=u8to16(r,_+14);let Fe=C[0]+(se&8191),ht=C[1]+((se>>>13|oe<<3)&8191),nt=C[2]+((oe>>>10|ue<<6)&8191),Ee=C[3]+((ue>>>7|we<<9)&8191),Ce=C[4]+((we>>>4|Te<<12)&8191),_e=C[5]+(Te>>>1&8191),Ie=C[6]+((Te>>>14|xe<<2)&8191),He=C[7]+((xe>>>11|Re<<5)&8191),Be=C[8]+((Re>>>8|Ne<<8)&8191),Ge=C[9]+(Ne>>>5|S),je=0,Ve=je+Fe*I+ht*(5*Q)+nt*(5*X)+Ee*(5*Z)+Ce*(5*z);je=Ve>>>13,Ve&=8191,Ve+=_e*(5*j)+Ie*(5*U)+He*(5*N)+Be*(5*O)+Ge*(5*B),je+=Ve>>>13,Ve&=8191;let Pe=je+Fe*B+ht*I+nt*(5*Q)+Ee*(5*X)+Ce*(5*Z);je=Pe>>>13,Pe&=8191,Pe+=_e*(5*z)+Ie*(5*j)+He*(5*U)+Be*(5*N)+Ge*(5*O),je+=Pe>>>13,Pe&=8191;let Me=je+Fe*O+ht*B+nt*I+Ee*(5*Q)+Ce*(5*X);je=Me>>>13,Me&=8191,Me+=_e*(5*Z)+Ie*(5*z)+He*(5*j)+Be*(5*U)+Ge*(5*N),je+=Me>>>13,Me&=8191;let tt=je+Fe*N+ht*O+nt*B+Ee*I+Ce*(5*Q);je=tt>>>13,tt&=8191,tt+=_e*(5*X)+Ie*(5*Z)+He*(5*z)+Be*(5*j)+Ge*(5*U),je+=tt>>>13,tt&=8191;let Ke=je+Fe*U+ht*N+nt*O+Ee*B+Ce*I;je=Ke>>>13,Ke&=8191,Ke+=_e*(5*Q)+Ie*(5*X)+He*(5*Z)+Be*(5*z)+Ge*(5*j),je+=Ke>>>13,Ke&=8191;let mt=je+Fe*j+ht*U+nt*N+Ee*O+Ce*B;je=mt>>>13,mt&=8191,mt+=_e*I+Ie*(5*Q)+He*(5*X)+Be*(5*Z)+Ge*(5*z),je+=mt>>>13,mt&=8191;let ct=je+Fe*z+ht*j+nt*U+Ee*N+Ce*O;je=ct>>>13,ct&=8191,ct+=_e*B+Ie*I+He*(5*Q)+Be*(5*X)+Ge*(5*Z),je+=ct>>>13,ct&=8191;let Qe=je+Fe*Z+ht*z+nt*j+Ee*U+Ce*N;je=Qe>>>13,Qe&=8191,Qe+=_e*O+Ie*B+He*I+Be*(5*Q)+Ge*(5*X),je+=Qe>>>13,Qe&=8191;let dt=je+Fe*X+ht*Z+nt*z+Ee*j+Ce*U;je=dt>>>13,dt&=8191,dt+=_e*N+Ie*O+He*B+Be*I+Ge*(5*Q),je+=dt>>>13,dt&=8191;let vt=je+Fe*Q+ht*X+nt*Z+Ee*z+Ce*j;je=vt>>>13,vt&=8191,vt+=_e*U+Ie*N+He*O+Be*B+Ge*I,je+=vt>>>13,vt&=8191,je=(je<<2)+je|0,je=je+Ve|0,Ve=je&8191,je=je>>>13,Pe+=je,C[0]=Ve,C[1]=Pe,C[2]=Me,C[3]=tt,C[4]=Ke,C[5]=mt,C[6]=ct,C[7]=Qe,C[8]=dt,C[9]=vt}finalize(){const{h:r,pad:_}=this,E=new Uint16Array(10);let S=r[1]>>>13;r[1]&=8191;for(let I=2;I<10;I++)r[I]+=S,S=r[I]>>>13,r[I]&=8191;r[0]+=S*5,S=r[0]>>>13,r[0]&=8191,r[1]+=S,S=r[1]>>>13,r[1]&=8191,r[2]+=S,E[0]=r[0]+5,S=E[0]>>>13,E[0]&=8191;for(let I=1;I<10;I++)E[I]=r[I]+S,S=E[I]>>>13,E[I]&=8191;E[9]-=8192;let C=(S^1)-1;for(let I=0;I<10;I++)E[I]&=C;C=~C;for(let I=0;I<10;I++)r[I]=r[I]&C|E[I];r[0]=(r[0]|r[1]<<13)&65535,r[1]=(r[1]>>>3|r[2]<<10)&65535,r[2]=(r[2]>>>6|r[3]<<7)&65535,r[3]=(r[3]>>>9|r[4]<<4)&65535,r[4]=(r[4]>>>12|r[5]<<1|r[6]<<14)&65535,r[5]=(r[6]>>>2|r[7]<<11)&65535,r[6]=(r[7]>>>5|r[8]<<8)&65535,r[7]=(r[8]>>>8|r[9]<<5)&65535;let A=r[0]+_[0];r[0]=A&65535;for(let I=1;I<8;I++)A=(r[I]+_[I]|0)+(A>>>16)|0,r[I]=A&65535}update(r){exists(this);const{buffer:_,blockLen:E}=this;r=toBytes(r);const S=r.length;for(let C=0;C<S;){const A=Math.min(E-this.pos,S-C);if(A===E){for(;E<=S-C;C+=E)this.process(r,C);continue}_.set(r.subarray(C,C+A),this.pos),this.pos+=A,C+=A,this.pos===E&&(this.process(_,0,!1),this.pos=0)}return this}destroy(){this.h.fill(0),this.r.fill(0),this.buffer.fill(0),this.pad.fill(0)}digestInto(r){exists(this),output(r,this),this.finished=!0;const{buffer:_,h:E}=this;let{pos:S}=this;if(S){for(_[S++]=1;S<16;S++)_[S]=0;this.process(_,0,!0)}this.finalize();let C=0;for(let A=0;A<8;A++)r[C++]=E[A]>>>0,r[C++]=E[A]>>>8;return r}digest(){const{buffer:r,outputLen:_}=this;this.digestInto(r);const E=r.slice(0,_);return this.destroy(),E}}function wrapConstructorWithKey(n){const r=(E,S)=>n(S).update(toBytes(E)).digest(),_=n(new Uint8Array(32));return r.outputLen=_.outputLen,r.blockLen=_.blockLen,r.create=E=>n(E),r}const poly1305=wrapConstructorWithKey(n=>new Poly1305(n)),sigma16=utf8ToBytes("expand 16-byte k"),sigma32=utf8ToBytes("expand 32-byte k"),sigma16_32=u32(sigma16),sigma32_32=u32(sigma32);function rotl(n,r){return n<<r|n>>>32-r}function isAligned32(n){return n.byteOffset%4===0}const BLOCK_LEN=64,BLOCK_LEN32=16,MAX_COUNTER=2**32-1,U32_EMPTY=new Uint32Array;function runCipher(n,r,_,E,S,C,A,I){const B=S.length,O=new Uint8Array(BLOCK_LEN),N=u32(O),U=isAligned32(S)&&isAligned32(C),j=U?u32(S):U32_EMPTY,z=U?u32(C):U32_EMPTY;for(let Z=0;Z<B;A++){if(n(r,_,E,N,A,I),A>=MAX_COUNTER)throw new Error("arx: counter overflow");const X=Math.min(BLOCK_LEN,B-Z);if(U&&X===BLOCK_LEN){const Q=Z/4;if(Z%4!==0)throw new Error("arx: invalid block position");for(let se=0,oe;se<BLOCK_LEN32;se++)oe=Q+se,z[oe]=j[oe]^N[se];Z+=BLOCK_LEN;continue}for(let Q=0,se;Q<X;Q++)se=Z+Q,C[se]=S[se]^O[Q];Z+=X}}function createCipher(n,r){const{allowShortKeys:_,extendNonceFn:E,counterLength:S,counterRight:C,rounds:A}=checkOpts({allowShortKeys:!1,counterLength:8,counterRight:!1,rounds:20},r);if(typeof n!="function")throw new Error("core must be a function");return number$1(S),number$1(A),bool(C),bool(_),(I,B,O,N,U=0)=>{bytes(I),bytes(B),bytes(O);const j=O.length;if(N||(N=new Uint8Array(j)),bytes(N),number$1(U),U<0||U>=MAX_COUNTER)throw new Error("arx: counter overflow");if(N.length<j)throw new Error(`arx: output (${N.length}) is shorter than data (${j})`);const z=[];let Z=I.length,X,Q;if(Z===32)X=I.slice(),z.push(X),Q=sigma32_32;else if(Z===16&&_)X=new Uint8Array(32),X.set(I),X.set(I,16),Q=sigma16_32,z.push(X);else throw new Error(`arx: invalid 32-byte key, got length=${Z}`);isAligned32(B)||(B=B.slice(),z.push(B));const se=u32(X);if(E){if(B.length!==24)throw new Error("arx: extended nonce must be 24 bytes");E(Q,se,u32(B.subarray(0,16)),se),B=B.subarray(16)}const oe=16-S;if(oe!==B.length)throw new Error(`arx: nonce must be ${oe} or 16 bytes`);if(oe!==12){const we=new Uint8Array(12);we.set(B,C?0:12-B.length),B=we,z.push(B)}const ue=u32(B);for(runCipher(n,Q,se,ue,O,N,U,A);z.length>0;)z.pop().fill(0);return N}}function chachaCore(n,r,_,E,S,C=20){let A=n[0],I=n[1],B=n[2],O=n[3],N=r[0],U=r[1],j=r[2],z=r[3],Z=r[4],X=r[5],Q=r[6],se=r[7],oe=S,ue=_[0],we=_[1],Te=_[2],xe=A,Re=I,Ne=B,Fe=O,ht=N,nt=U,Ee=j,Ce=z,_e=Z,Ie=X,He=Q,Be=se,Ge=oe,je=ue,Ve=we,Pe=Te;for(let tt=0;tt<C;tt+=2)xe=xe+ht|0,Ge=rotl(Ge^xe,16),_e=_e+Ge|0,ht=rotl(ht^_e,12),xe=xe+ht|0,Ge=rotl(Ge^xe,8),_e=_e+Ge|0,ht=rotl(ht^_e,7),Re=Re+nt|0,je=rotl(je^Re,16),Ie=Ie+je|0,nt=rotl(nt^Ie,12),Re=Re+nt|0,je=rotl(je^Re,8),Ie=Ie+je|0,nt=rotl(nt^Ie,7),Ne=Ne+Ee|0,Ve=rotl(Ve^Ne,16),He=He+Ve|0,Ee=rotl(Ee^He,12),Ne=Ne+Ee|0,Ve=rotl(Ve^Ne,8),He=He+Ve|0,Ee=rotl(Ee^He,7),Fe=Fe+Ce|0,Pe=rotl(Pe^Fe,16),Be=Be+Pe|0,Ce=rotl(Ce^Be,12),Fe=Fe+Ce|0,Pe=rotl(Pe^Fe,8),Be=Be+Pe|0,Ce=rotl(Ce^Be,7),xe=xe+nt|0,Pe=rotl(Pe^xe,16),He=He+Pe|0,nt=rotl(nt^He,12),xe=xe+nt|0,Pe=rotl(Pe^xe,8),He=He+Pe|0,nt=rotl(nt^He,7),Re=Re+Ee|0,Ge=rotl(Ge^Re,16),Be=Be+Ge|0,Ee=rotl(Ee^Be,12),Re=Re+Ee|0,Ge=rotl(Ge^Re,8),Be=Be+Ge|0,Ee=rotl(Ee^Be,7),Ne=Ne+Ce|0,je=rotl(je^Ne,16),_e=_e+je|0,Ce=rotl(Ce^_e,12),Ne=Ne+Ce|0,je=rotl(je^Ne,8),_e=_e+je|0,Ce=rotl(Ce^_e,7),Fe=Fe+ht|0,Ve=rotl(Ve^Fe,16),Ie=Ie+Ve|0,ht=rotl(ht^Ie,12),Fe=Fe+ht|0,Ve=rotl(Ve^Fe,8),Ie=Ie+Ve|0,ht=rotl(ht^Ie,7);let Me=0;E[Me++]=A+xe|0,E[Me++]=I+Re|0,E[Me++]=B+Ne|0,E[Me++]=O+Fe|0,E[Me++]=N+ht|0,E[Me++]=U+nt|0,E[Me++]=j+Ee|0,E[Me++]=z+Ce|0,E[Me++]=Z+_e|0,E[Me++]=X+Ie|0,E[Me++]=Q+He|0,E[Me++]=se+Be|0,E[Me++]=oe+Ge|0,E[Me++]=ue+je|0,E[Me++]=we+Ve|0,E[Me++]=Te+Pe|0}const chacha20=createCipher(chachaCore,{counterRight:!1,counterLength:4,allowShortKeys:!1}),ZEROS16=new Uint8Array(16),updatePadded=(n,r)=>{n.update(r);const _=r.length%16;_&&n.update(ZEROS16.subarray(_))},ZEROS32=new Uint8Array(32);function computeTag(n,r,_,E,S){const C=n(r,_,ZEROS32),A=poly1305.create(C);S&&updatePadded(A,S),updatePadded(A,E);const I=new Uint8Array(16),B=createView(I);setBigUint64(B,0,BigInt(S?S.length:0),!0),setBigUint64(B,8,BigInt(E.length),!0),A.update(I);const O=A.digest();return C.fill(0),O}const _poly1305_aead=n=>(r,_,E)=>(ensureBytes(r,32),ensureBytes(_),{encrypt:(C,A)=>{const I=C.length,B=I+16;A?ensureBytes(A,B):A=new Uint8Array(B),n(r,_,C,A,1);const O=computeTag(n,r,_,A.subarray(0,-16),E);return A.set(O,I),A},decrypt:(C,A)=>{const I=C.length,B=I-16;if(I<16)throw new Error("encrypted data must be at least 16 bytes");A?ensureBytes(A,B):A=new Uint8Array(B);const O=C.subarray(0,-16),N=C.subarray(-16),U=computeTag(n,r,_,O,E);if(!equalBytes(N,U))throw new Error("invalid tag");return n(r,_,O,A,1),A}}),chacha20poly1305=wrapCipher({blockSize:64,nonceLength:12,tagLength:16},_poly1305_aead(chacha20));function extract(n,r,_){return hash(n),_===void 0&&(_=new Uint8Array(n.outputLen)),hmac(n,toBytes$2(_),toBytes$2(r))}const HKDF_COUNTER=new Uint8Array([0]),EMPTY_BUFFER=new Uint8Array;function expand(n,r,_,E=32){if(hash(n),number$2(E),E>255*n.outputLen)throw new Error("Length should be <= 255*HashLen");const S=Math.ceil(E/n.outputLen);_===void 0&&(_=EMPTY_BUFFER);const C=new Uint8Array(S*n.outputLen),A=hmac.create(n,r),I=A._cloneInto(),B=new Uint8Array(A.outputLen);for(let O=0;O<S;O++)HKDF_COUNTER[0]=O+1,I.update(O===0?EMPTY_BUFFER:B).update(_).update(HKDF_COUNTER).digestInto(B),C.set(B,n.outputLen*O),A._cloneInto(I);return A.destroy(),I.destroy(),B.fill(0),HKDF_COUNTER.fill(0),C.slice(0,E)}const pureJsCrypto$1={hashSHA256(n){return sha256$2(n.subarray())},getHKDF(n,r){const _=extract(sha256$2,r,n),S=expand(sha256$2,_,void 0,96),C=S.subarray(0,32),A=S.subarray(32,64),I=S.subarray(64,96);return[C,A,I]},generateX25519KeyPair(){const n=x25519.utils.randomPrivateKey();return{publicKey:x25519.getPublicKey(n),privateKey:n}},generateX25519KeyPairFromSeed(n){return{publicKey:x25519.getPublicKey(n),privateKey:n}},generateX25519SharedKey(n,r){return x25519.getSharedSecret(n.subarray(),r.subarray())},chaCha20Poly1305Encrypt(n,r,_,E){return chacha20poly1305(E,r,_).encrypt(n.subarray())},chaCha20Poly1305Decrypt(n,r,_,E,S){return chacha20poly1305(E,r,_).decrypt(n.subarray(),S)}},defaultCrypto$1=pureJsCrypto$1,uint16BEEncode$1=n=>{const r=allocUnsafe$1(2);return new DataView(r.buffer,r.byteOffset,r.byteLength).setUint16(0,n,!1),r};uint16BEEncode$1.bytes=2;const uint16BEDecode$1=n=>{if(n.length<2)throw RangeError("Could not decode int16BE");return n instanceof Uint8Array?new DataView(n.buffer,n.byteOffset,n.byteLength).getUint16(0,!1):n.getUint16(0)};uint16BEDecode$1.bytes=2;function encode0(n){return new Uint8ArrayList(n.ne,n.ciphertext)}function encode1(n){return new Uint8ArrayList(n.ne,n.ns,n.ciphertext)}function encode2(n){return new Uint8ArrayList(n.ns,n.ciphertext)}function decode0(n){if(n.length<32)throw new Error("Cannot decode stage 0 MessageBuffer: length less than 32 bytes.");return{ne:n.subarray(0,32),ciphertext:n.subarray(32,n.length),ns:alloc$1(0)}}function decode1(n){if(n.length<80)throw new Error("Cannot decode stage 1 MessageBuffer: length less than 80 bytes.");return{ne:n.subarray(0,32),ns:n.subarray(32,80),ciphertext:n.subarray(80,n.length)}}function decode2(n){if(n.length<48)throw new Error("Cannot decode stage 2 MessageBuffer: length less than 48 bytes.");return{ne:alloc$1(0),ns:n.subarray(0,48),ciphertext:n.subarray(48,n.length)}}const CHACHA_TAG_LENGTH$1=16;function encryptStream$1(n,r){return async function*(_){for await(const E of _)for(let S=0;S<E.length;S+=NOISE_MSG_MAX_LENGTH_BYTES_WITHOUT_TAG$1){let C=S+NOISE_MSG_MAX_LENGTH_BYTES_WITHOUT_TAG$1;C>E.length&&(C=E.length);let A;E instanceof Uint8Array?A=n.encrypt(E.subarray(S,C),n.session):A=n.encrypt(E.sublist(S,C),n.session),r?.encryptedPackets.increment(),yield new Uint8ArrayList(uint16BEEncode$1(A.byteLength),A)}}}function decryptStream$1(n,r){return async function*(_){for await(const E of _)for(let S=0;S<E.length;S+=NOISE_MSG_MAX_LENGTH_BYTES$1){let C=S+NOISE_MSG_MAX_LENGTH_BYTES$1;if(C>E.length&&(C=E.length),C-CHACHA_TAG_LENGTH$1<S)throw new Error("Invalid chunk");const A=E.sublist(S,C),I=E.subarray(S,C-CHACHA_TAG_LENGTH$1),{plaintext:B,valid:O}=n.decrypt(A,n.session,I);if(!O)throw r?.decryptErrors.increment(),new Error("Failed to validate decrypted chunk");r?.decryptedPackets.increment(),yield B}}}let UnexpectedPeerError$1=class Gl extends Error{code;constructor(r="Unexpected Peer"){super(r),this.code=Gl.code}static code="ERR_UNEXPECTED_PEER"},InvalidCryptoExchangeError$1=class Xl extends Error{code;constructor(r="Invalid crypto exchange"){super(r),this.code=Xl.code}static code="ERR_INVALID_CRYPTO_EXCHANGE"};var NoiseExtensions$1;(function(n){let r;n.codec=()=>(r==null&&(r=message((_,E,S={})=>{if(S.lengthDelimited!==!1&&E.fork(),_.webtransportCerthashes!=null)for(const C of _.webtransportCerthashes)E.uint32(10),E.bytes(C);S.lengthDelimited!==!1&&E.ldelim()},(_,E)=>{const S={webtransportCerthashes:[]},C=E==null?_.len:_.pos+E;for(;_.pos<C;){const A=_.uint32();switch(A>>>3){case 1:{S.webtransportCerthashes.push(_.bytes());break}default:{_.skipType(A&7);break}}}return S})),r),n.encode=_=>encodeMessage(_,n.codec()),n.decode=_=>decodeMessage$1(_,n.codec())})(NoiseExtensions$1||(NoiseExtensions$1={}));var NoiseHandshakePayload$1;(function(n){let r;n.codec=()=>(r==null&&(r=message((_,E,S={})=>{S.lengthDelimited!==!1&&E.fork(),_.identityKey!=null&&_.identityKey.byteLength>0&&(E.uint32(10),E.bytes(_.identityKey)),_.identitySig!=null&&_.identitySig.byteLength>0&&(E.uint32(18),E.bytes(_.identitySig)),_.extensions!=null&&(E.uint32(34),NoiseExtensions$1.codec().encode(_.extensions,E)),S.lengthDelimited!==!1&&E.ldelim()},(_,E)=>{const S={identityKey:alloc$1(0),identitySig:alloc$1(0)},C=E==null?_.len:_.pos+E;for(;_.pos<C;){const A=_.uint32();switch(A>>>3){case 1:{S.identityKey=_.bytes();break}case 2:{S.identitySig=_.bytes();break}case 4:{S.extensions=NoiseExtensions$1.codec().decode(_,_.uint32());break}default:{_.skipType(A&7);break}}}return S})),r),n.encode=_=>encodeMessage(_,n.codec()),n.decode=_=>decodeMessage$1(_,n.codec())})(NoiseHandshakePayload$1||(NoiseHandshakePayload$1={}));async function getPayload(n,r,_){const E=await signPayload(n,getHandshakePayload(r));if(n.publicKey==null)throw new Error("PublicKey was missing from local PeerId");return createHandshakePayload$1(n.publicKey,E,_)}function createHandshakePayload$1(n,r,_){return NoiseHandshakePayload$1.encode({identityKey:n,identitySig:r,extensions:_??{webtransportCerthashes:[]}}).subarray()}async function signPayload(n,r){if(n.privateKey==null)throw new Error("PrivateKey was missing from PeerId");return(await unmarshalPrivateKey$3(n.privateKey)).sign(r)}async function getPeerIdFromPayload(n){return peerIdFromKeys$1(n.identityKey)}function decodePayload(n){return NoiseHandshakePayload$1.decode(n)}function getHandshakePayload(n){const r=fromString$3("noise-libp2p-static-key:");return n instanceof Uint8Array?concat$4([r,n],r.length+n.length):(n.prepend(r),n)}async function verifySignedPayload(n,r,_){const E=await peerIdFromKeys$1(r.identityKey);if(!E.equals(_))throw new Error(`Payload identity key ${E.toString()} does not match expected remote peer ${_.toString()}`);const S=getHandshakePayload(n);if(E.publicKey==null)throw new Error("PublicKey was missing from PeerId");if(r.identitySig==null)throw new Error("Signature was missing from message");if(!await unmarshalPublicKey$2(E.publicKey).verify(S,r.identitySig))throw new Error("Static key doesn't match to peer that signed payload!");return E}function isValidPublicKey(n){return!(!(n instanceof Uint8Array)&&!isUint8ArrayList(n)||n.byteLength!==32)}function xor(n,r){if(n.length!==r.length)throw new Error("Inputs should have the same length");const _=allocUnsafe$1(n.length);for(let E=0;E<n.length;E++)_[E]=n[E]^r[E];return _}const MIN_NONCE$1=0,MAX_NONCE$1=4294967295,ERR_MAX_NONCE$1="Cipherstate has reached maximum n, a new handshake must be performed";let Nonce$1=class{n;bytes;view;constructor(r=MIN_NONCE$1){this.n=r,this.bytes=alloc$1(12),this.view=new DataView(this.bytes.buffer,this.bytes.byteOffset,this.bytes.byteLength),this.view.setUint32(4,r,!0)}increment(){this.n++,this.view.setUint32(4,this.n,!0)}getBytes(){return this.bytes}getUint64(){return this.n}assertValue(){if(this.n>MAX_NONCE$1)throw new Error(ERR_MAX_NONCE$1)}};class AbstractHandshake{crypto;log;constructor(r,_){this.log=r.logger.forComponent("libp2p:noise:abstract-handshake"),this.crypto=_}encryptWithAd(r,_,E){const S=this.encrypt(r.k,r.n,_,E);return r.n.increment(),S}decryptWithAd(r,_,E,S){const{plaintext:C,valid:A}=this.decrypt(r.k,r.n,_,E,S);return A&&r.n.increment(),{plaintext:C,valid:A}}hasKey(r){return!this.isEmptyKey(r.k)}createEmptyKey(){return alloc$1(32)}isEmptyKey(r){const _=this.createEmptyKey();return equals$1(_,r)}encrypt(r,_,E,S){return _.assertValue(),this.crypto.chaCha20Poly1305Encrypt(S,_.getBytes(),E,r)}encryptAndHash(r,_){let E;return this.hasKey(r.cs)?E=this.encryptWithAd(r.cs,r.h,_):E=_,this.mixHash(r,E),E}decrypt(r,_,E,S,C){_.assertValue();const A=this.crypto.chaCha20Poly1305Decrypt(S,_.getBytes(),E,r,C);return A?{plaintext:A,valid:!0}:{plaintext:alloc$1(0),valid:!1}}decryptAndHash(r,_){let E,S=!0;return this.hasKey(r.cs)?{plaintext:E,valid:S}=this.decryptWithAd(r.cs,r.h,_):E=_,this.mixHash(r,_),{plaintext:E,valid:S}}dh(r,_){try{const E=this.crypto.generateX25519SharedKey(r,_);return E.length===32?E:E.subarray(0,32)}catch(E){const S=E;return this.log.error("error deriving shared key",S),alloc$1(32)}}mixHash(r,_){r.h=this.getHash(r.h,_)}getHash(r,_){return this.crypto.hashSHA256(new Uint8ArrayList(r,_))}mixKey(r,_){const[E,S]=this.crypto.getHKDF(r.ck,_);r.cs=this.initializeKey(S),r.ck=E}initializeKey(r){return{k:r,n:new Nonce$1}}initializeSymmetric(r){const _=fromString$3(r,"utf-8"),E=this.hashProtocolName(_),S=E,C=this.createEmptyKey();return{cs:this.initializeKey(C),ck:S,h:E}}hashProtocolName(r){if(r.length<=32){const _=alloc$1(32);return _.set(r),_}else return this.getHash(r,alloc$1(0))}split(r){const[_,E]=this.crypto.getHKDF(r.ck,alloc$1(0)),S=this.initializeKey(_),C=this.initializeKey(E);return{cs1:S,cs2:C}}writeMessageRegular(r,_){const E=this.encryptWithAd(r,alloc$1(0),_),S=this.createEmptyKey(),C=alloc$1(0);return{ne:S,ns:C,ciphertext:E}}readMessageRegular(r,_){return this.decryptWithAd(r,alloc$1(0),_.ciphertext)}}class XX extends AbstractHandshake{initializeInitiator(r,_,E,S){const A=this.initializeSymmetric("Noise_XX_25519_ChaChaPoly_SHA256");this.mixHash(A,r);const I=alloc$1(32);return{ss:A,s:_,rs:E,psk:S,re:I}}initializeResponder(r,_,E,S){const A=this.initializeSymmetric("Noise_XX_25519_ChaChaPoly_SHA256");this.mixHash(A,r);const I=alloc$1(32);return{ss:A,s:_,rs:E,psk:S,re:I}}writeMessageA(r,_,E){const S=alloc$1(0);E!==void 0?r.e=E:r.e=this.crypto.generateX25519KeyPair();const C=r.e.publicKey;this.mixHash(r.ss,C);const A=this.encryptAndHash(r.ss,_);return{ne:C,ns:S,ciphertext:A}}writeMessageB(r,_){r.e=this.crypto.generateX25519KeyPair();const E=r.e.publicKey;this.mixHash(r.ss,E),this.mixKey(r.ss,this.dh(r.e.privateKey,r.re));const S=r.s.publicKey,C=this.encryptAndHash(r.ss,S);this.mixKey(r.ss,this.dh(r.s.privateKey,r.re));const A=this.encryptAndHash(r.ss,_);return{ne:E,ns:C,ciphertext:A}}writeMessageC(r,_){const E=r.s.publicKey,S=this.encryptAndHash(r.ss,E);this.mixKey(r.ss,this.dh(r.s.privateKey,r.re));const C=this.encryptAndHash(r.ss,_),I={ne:this.createEmptyKey(),ns:S,ciphertext:C},{cs1:B,cs2:O}=this.split(r.ss);return{h:r.ss.h,messageBuffer:I,cs1:B,cs2:O}}readMessageA(r,_){return isValidPublicKey(_.ne)&&(r.re=_.ne),this.mixHash(r.ss,r.re),this.decryptAndHash(r.ss,_.ciphertext)}readMessageB(r,_){if(isValidPublicKey(_.ne)&&(r.re=_.ne),this.mixHash(r.ss,r.re),!r.e)throw new Error("Handshake state `e` param is missing.");this.mixKey(r.ss,this.dh(r.e.privateKey,r.re));const{plaintext:E,valid:S}=this.decryptAndHash(r.ss,_.ns);S&&isValidPublicKey(E)&&(r.rs=E),this.mixKey(r.ss,this.dh(r.e.privateKey,r.rs));const{plaintext:C,valid:A}=this.decryptAndHash(r.ss,_.ciphertext);return{plaintext:C,valid:S&&A}}readMessageC(r,_){const{plaintext:E,valid:S}=this.decryptAndHash(r.ss,_.ns);if(S&&isValidPublicKey(E)&&(r.rs=E),!r.e)throw new Error("Handshake state `e` param is missing.");this.mixKey(r.ss,this.dh(r.e.privateKey,r.rs));const{plaintext:C,valid:A}=this.decryptAndHash(r.ss,_.ciphertext),{cs1:I,cs2:B}=this.split(r.ss);return{h:r.ss.h,plaintext:C,valid:S&&A,cs1:I,cs2:B}}initSession(r,_,E){const S=this.createEmptyKey(),C=alloc$1(32);let A;return r?A=this.initializeInitiator(_,E,C,S):A=this.initializeResponder(_,E,C,S),{hs:A,i:r,mc:0}}sendMessage(r,_,E){let S;if(r.mc===0)S=this.writeMessageA(r.hs,_,E);else if(r.mc===1)S=this.writeMessageB(r.hs,_);else if(r.mc===2){const{h:C,messageBuffer:A,cs1:I,cs2:B}=this.writeMessageC(r.hs,_);S=A,r.h=C,r.cs1=I,r.cs2=B}else if(r.mc>2)if(r.i){if(!r.cs1)throw new Error("CS1 (cipher state) is not defined");S=this.writeMessageRegular(r.cs1,_)}else{if(!r.cs2)throw new Error("CS2 (cipher state) is not defined");S=this.writeMessageRegular(r.cs2,_)}else throw new Error("Session invalid.");return r.mc++,S}recvMessage(r,_){let E=alloc$1(0),S=!1;if(r.mc===0)({plaintext:E,valid:S}=this.readMessageA(r.hs,_));else if(r.mc===1)({plaintext:E,valid:S}=this.readMessageB(r.hs,_));else if(r.mc===2){const{h:C,plaintext:A,valid:I,cs1:B,cs2:O}=this.readMessageC(r.hs,_);E=A,S=I,r.h=C,r.cs1=B,r.cs2=O}return r.mc++,{plaintext:E,valid:S}}}function logLocalStaticKeys$1(n,r){!r.enabled||!DUMP_SESSION_KEYS$1||(r(`LOCAL_STATIC_PUBLIC_KEY ${toString$4(n.publicKey,"hex")}`),r(`LOCAL_STATIC_PRIVATE_KEY ${toString$4(n.privateKey,"hex")}`))}function logLocalEphemeralKeys$1(n,r){!r.enabled||!DUMP_SESSION_KEYS$1||(n?(r(`LOCAL_PUBLIC_EPHEMERAL_KEY ${toString$4(n.publicKey,"hex")}`),r(`LOCAL_PRIVATE_EPHEMERAL_KEY ${toString$4(n.privateKey,"hex")}`)):r("Missing local ephemeral keys."))}function logRemoteStaticKey$1(n,r){!r.enabled||!DUMP_SESSION_KEYS$1||r(`REMOTE_STATIC_PUBLIC_KEY ${toString$4(n.subarray(),"hex")}`)}function logRemoteEphemeralKey$1(n,r){!r.enabled||!DUMP_SESSION_KEYS$1||r(`REMOTE_EPHEMERAL_PUBLIC_KEY ${toString$4(n.subarray(),"hex")}`)}function logCipherState$1(n,r){!r.enabled||!DUMP_SESSION_KEYS$1||(n.cs1&&n.cs2?(r(`CIPHER_STATE_1 ${n.cs1.n.getUint64()} ${toString$4(n.cs1.k,"hex")}`),r(`CIPHER_STATE_2 ${n.cs2.n.getUint64()} ${toString$4(n.cs2.k,"hex")}`)):r("Missing cipher state."))}class XXHandshake{isInitiator;session;remotePeer;remoteExtensions={webtransportCerthashes:[]};payload;connection;xx;staticKeypair;prologue;log;constructor(r,_,E,S,C,A,I,B,O){this.log=r.logger.forComponent("libp2p:noise:xxhandshake"),this.isInitiator=_,this.payload=E,this.prologue=S,this.staticKeypair=A,this.connection=I,B&&(this.remotePeer=B),this.xx=O??new XX(r,C),this.session=this.xx.initSession(this.isInitiator,this.prologue,this.staticKeypair)}async propose(){if(logLocalStaticKeys$1(this.session.hs.s,this.log),this.isInitiator){this.log.trace("Stage 0 - Initiator starting to send first message.");const r=this.xx.sendMessage(this.session,alloc$1(0));await this.connection.write(encode0(r)),this.log.trace("Stage 0 - Initiator finished sending first message."),logLocalEphemeralKeys$1(this.session.hs.e,this.log)}else{this.log.trace("Stage 0 - Responder waiting to receive first message...");const r=decode0((await this.connection.read()).subarray()),{valid:_}=this.xx.recvMessage(this.session,r);if(!_)throw new InvalidCryptoExchangeError$1("xx handshake stage 0 validation fail");this.log.trace("Stage 0 - Responder received first message."),logRemoteEphemeralKey$1(this.session.hs.re,this.log)}}async exchange(){if(this.isInitiator){this.log.trace("Stage 1 - Initiator waiting to receive first message from responder...");const r=decode1((await this.connection.read()).subarray()),{plaintext:_,valid:E}=this.xx.recvMessage(this.session,r);if(!E)throw new InvalidCryptoExchangeError$1("xx handshake stage 1 validation fail");this.log.trace("Stage 1 - Initiator received the message."),logRemoteEphemeralKey$1(this.session.hs.re,this.log),logRemoteStaticKey$1(this.session.hs.rs,this.log),this.log.trace("Initiator going to check remote's signature...");try{const S=decodePayload(_);this.remotePeer=this.remotePeer||await getPeerIdFromPayload(S),await verifySignedPayload(this.session.hs.rs,S,this.remotePeer),this.setRemoteNoiseExtension(S.extensions)}catch(S){const C=S;throw new UnexpectedPeerError$1(`Error occurred while verifying signed payload: ${C.message}`)}this.log.trace("All good with the signature!")}else{this.log.trace("Stage 1 - Responder sending out first message with signed payload and static key.");const r=this.xx.sendMessage(this.session,this.payload);await this.connection.write(encode1(r)),this.log.trace("Stage 1 - Responder sent the second handshake message with signed payload."),logLocalEphemeralKeys$1(this.session.hs.e,this.log)}}async finish(){if(this.isInitiator){this.log.trace("Stage 2 - Initiator sending third handshake message.");const r=this.xx.sendMessage(this.session,this.payload);await this.connection.write(encode2(r)),this.log.trace("Stage 2 - Initiator sent message with signed payload.")}else{this.log.trace("Stage 2 - Responder waiting for third handshake message...");const r=decode2((await this.connection.read()).subarray()),{plaintext:_,valid:E}=this.xx.recvMessage(this.session,r);if(!E)throw new InvalidCryptoExchangeError$1("xx handshake stage 2 validation fail");this.log.trace("Stage 2 - Responder received the message, finished handshake.");try{const S=decodePayload(_);this.remotePeer=this.remotePeer||await getPeerIdFromPayload(S),await verifySignedPayload(this.session.hs.rs,S,this.remotePeer),this.setRemoteNoiseExtension(S.extensions)}catch(S){const C=S;throw new UnexpectedPeerError$1(`Error occurred while verifying signed payload: ${C.message}`)}}logCipherState$1(this.session,this.log)}encrypt(r,_){const E=this.getCS(_);return this.xx.encryptWithAd(E,alloc$1(0),r)}decrypt(r,_,E){const S=this.getCS(_,!1);return this.xx.decryptWithAd(S,alloc$1(0),r,E)}getRemoteStaticKey(){return this.session.hs.rs}getCS(r,_=!0){if(!r.cs1||!r.cs2)throw new InvalidCryptoExchangeError$1("Handshake not completed properly, cipher state does not exist.");return this.isInitiator?_?r.cs1:r.cs2:_?r.cs2:r.cs1}setRemoteNoiseExtension(r){r&&(this.remoteExtensions=r)}}function registerMetrics$1(n){return{xxHandshakeSuccesses:n.registerCounter("libp2p_noise_xxhandshake_successes_total",{help:"Total count of noise xxHandshakes successes_"}),xxHandshakeErrors:n.registerCounter("libp2p_noise_xxhandshake_error_total",{help:"Total count of noise xxHandshakes errors"}),encryptedPackets:n.registerCounter("libp2p_noise_encrypted_packets_total",{help:"Total count of noise encrypted packets successfully"}),decryptedPackets:n.registerCounter("libp2p_noise_decrypted_packets_total",{help:"Total count of noise decrypted packets"}),decryptErrors:n.registerCounter("libp2p_noise_decrypt_errors_total",{help:"Total count of noise decrypt errors"})}}let Noise$1=class{protocol="/noise";crypto;prologue;staticKeys;extensions;metrics;components;constructor(r,_={}){const{staticNoiseKey:E,extensions:S,crypto:C,prologueBytes:A}=_,{metrics:I}=r;this.components=r,this.crypto=C??defaultCrypto$1,this.extensions=S,this.metrics=I?registerMetrics$1(I):void 0,E?this.staticKeys=this.crypto.generateX25519KeyPairFromSeed(E):this.staticKeys=this.crypto.generateX25519KeyPair(),this.prologue=A??alloc$1(0)}async secureOutbound(r,_,E){const S=lpStream(_,{lengthEncoder:uint16BEEncode$1,lengthDecoder:uint16BEDecode$1,maxDataLength:NOISE_MSG_MAX_LENGTH_BYTES$1}),C=await this.performHandshake({connection:S,isInitiator:!0,localPeer:r,remotePeer:E}),A=await this.createSecureConnection(S,C);return _.source=A.source,_.sink=A.sink,{conn:_,remoteExtensions:C.remoteExtensions,remotePeer:C.remotePeer}}async secureInbound(r,_,E){const S=lpStream(_,{lengthEncoder:uint16BEEncode$1,lengthDecoder:uint16BEDecode$1,maxDataLength:NOISE_MSG_MAX_LENGTH_BYTES$1}),C=await this.performHandshake({connection:S,isInitiator:!1,localPeer:r,remotePeer:E}),A=await this.createSecureConnection(S,C);return _.source=A.source,_.sink=A.sink,{conn:_,remotePeer:C.remotePeer,remoteExtensions:C.remoteExtensions}}async performHandshake(r){const _=await getPayload(r.localPeer,this.staticKeys.publicKey,this.extensions);return this.performXXHandshake(r,_)}async performXXHandshake(r,_){const{isInitiator:E,remotePeer:S,connection:C}=r,A=new XXHandshake(this.components,E,_,this.prologue,this.crypto,this.staticKeys,C,S);try{await A.propose(),await A.exchange(),await A.finish(),this.metrics?.xxHandshakeSuccesses.increment()}catch(I){if(this.metrics?.xxHandshakeErrors.increment(),I instanceof Error)throw I.message=`Error occurred during XX handshake: ${I.message}`,I}return A}async createSecureConnection(r,_){const[E,S]=duplexPair(),C=r.unwrap();return await pipe(E,encryptStream$1(_,this.metrics),C,A=>decode$4(A,{lengthDecoder:uint16BEDecode$1}),decryptStream$1(_,this.metrics),E),S}};function noise$1(n={}){return r=>new Noise$1(r,n)}function getIterator(n){if(n!=null){if(typeof n[Symbol.iterator]=="function")return n[Symbol.iterator]();if(typeof n[Symbol.asyncIterator]=="function")return n[Symbol.asyncIterator]();if(typeof n.next=="function")return n}throw new Error("argument is not an iterator or iterable")}const ERR_INVALID_FRAME="ERR_INVALID_FRAME",ERR_UNREQUESTED_PING="ERR_UNREQUESTED_PING",ERR_NOT_MATCHING_PING="ERR_NOT_MATCHING_PING",ERR_STREAM_ALREADY_EXISTS="ERR_STREAM_ALREADY_EXISTS",ERR_DECODE_INVALID_VERSION="ERR_DECODE_INVALID_VERSION",ERR_BOTH_CLIENTS="ERR_BOTH_CLIENTS",ERR_RECV_WINDOW_EXCEEDED="ERR_RECV_WINDOW_EXCEEDED",PROTOCOL_ERRORS=new Set([ERR_INVALID_FRAME,ERR_UNREQUESTED_PING,ERR_NOT_MATCHING_PING,ERR_STREAM_ALREADY_EXISTS,ERR_DECODE_INVALID_VERSION,ERR_BOTH_CLIENTS,ERR_RECV_WINDOW_EXCEEDED]),ERR_INVALID_CONFIG="ERR_INVALID_CONFIG",ERR_MUXER_LOCAL_CLOSED="ERR_MUXER_LOCAL_CLOSED",ERR_MUXER_REMOTE_CLOSED="ERR_MUXER_REMOTE_CLOSED",ERR_STREAM_ABORT="ERR_STREAM_ABORT",ERR_MAX_OUTBOUND_STREAMS_EXCEEDED="ERROR_MAX_OUTBOUND_STREAMS_EXCEEDED",ERR_DECODE_IN_PROGRESS="ERR_DECODE_IN_PROGRESS",INITIAL_STREAM_WINDOW=256*1024,MAX_STREAM_WINDOW=16*1024*1024,defaultConfig={enableKeepAlive:!0,keepAliveInterval:3e4,maxInboundStreams:1e3,maxOutboundStreams:1e3,initialStreamWindowSize:INITIAL_STREAM_WINDOW,maxStreamWindowSize:MAX_STREAM_WINDOW,maxMessageSize:64*1024};function verifyConfig(n){if(n.keepAliveInterval<=0)throw new CodeError$4("keep-alive interval must be positive",ERR_INVALID_CONFIG);if(n.maxInboundStreams<0)throw new CodeError$4("max inbound streams must be larger or equal 0",ERR_INVALID_CONFIG);if(n.maxOutboundStreams<0)throw new CodeError$4("max outbound streams must be larger or equal 0",ERR_INVALID_CONFIG);if(n.initialStreamWindowSize<INITIAL_STREAM_WINDOW)throw new CodeError$4("InitialStreamWindowSize must be larger or equal 256 kB",ERR_INVALID_CONFIG);if(n.maxStreamWindowSize<n.initialStreamWindowSize)throw new CodeError$4("MaxStreamWindowSize must be larger than the InitialStreamWindowSize",ERR_INVALID_CONFIG);if(n.maxStreamWindowSize>2**32-1)throw new CodeError$4("MaxStreamWindowSize must be less than equal MAX_UINT32",ERR_INVALID_CONFIG);if(n.maxMessageSize<1024)throw new CodeError$4("MaxMessageSize must be greater than a kilobyte",ERR_INVALID_CONFIG)}var FrameType;(function(n){n[n.Data=0]="Data",n[n.WindowUpdate=1]="WindowUpdate",n[n.Ping=2]="Ping",n[n.GoAway=3]="GoAway"})(FrameType||(FrameType={}));var Flag;(function(n){n[n.SYN=1]="SYN",n[n.ACK=2]="ACK",n[n.FIN=4]="FIN",n[n.RST=8]="RST"})(Flag||(Flag={}));Object.values(Flag).filter(n=>typeof n!="string");const YAMUX_VERSION=0;var GoAwayCode;(function(n){n[n.NormalTermination=0]="NormalTermination",n[n.ProtocolError=1]="ProtocolError",n[n.InternalError=2]="InternalError"})(GoAwayCode||(GoAwayCode={}));const HEADER_LENGTH=12,twoPow24=2**24;function decodeHeader(n){if(n[0]!==YAMUX_VERSION)throw new CodeError$4("Invalid frame version",ERR_DECODE_INVALID_VERSION);return{type:n[1],flag:(n[2]<<8)+n[3],streamID:n[4]*twoPow24+(n[5]<<16)+(n[6]<<8)+n[7],length:n[8]*twoPow24+(n[9]<<16)+(n[10]<<8)+n[11]}}let Decoder$1=class{source;buffer;frameInProgress;constructor(r){this.source=returnlessSource(r),this.buffer=new Uint8ArrayList,this.frameInProgress=!1}async*emitFrames(){for await(const r of this.source)for(this.buffer.append(r);;){const _=this.readHeader();if(_===void 0)break;const{type:E,length:S}=_;E===FrameType.Data?(this.frameInProgress=!0,yield{header:_,readData:this.readBytes.bind(this,S)}):yield{header:_}}}readHeader(){if(this.frameInProgress)throw new CodeError$4("decoding frame already in progress",ERR_DECODE_IN_PROGRESS);if(this.buffer.length<HEADER_LENGTH)return;const r=decodeHeader(this.buffer.subarray(0,HEADER_LENGTH));return this.buffer.consume(HEADER_LENGTH),r}async readBytes(r){if(this.buffer.length<r){for await(const E of this.source)if(this.buffer.append(E),this.buffer.length>=r)break}const _=this.buffer.sublist(0,r);return this.buffer.consume(r),this.frameInProgress=!1,_}};function returnlessSource(n){if(n[Symbol.iterator]!==void 0){const r=n[Symbol.iterator]();return r.return=void 0,{[Symbol.iterator](){return r}}}else if(n[Symbol.asyncIterator]!==void 0){const r=n[Symbol.asyncIterator]();return r.return=void 0,{[Symbol.asyncIterator](){return r}}}else throw new Error("a source must be either an iterable or an async iterable")}function encodeHeader(n){const r=new Uint8Array(HEADER_LENGTH);return r[1]=n.type,r[2]=n.flag>>>8,r[3]=n.flag,r[4]=n.streamID>>>24,r[5]=n.streamID>>>16,r[6]=n.streamID>>>8,r[7]=n.streamID,r[8]=n.length>>>24,r[9]=n.length>>>16,r[10]=n.length>>>8,r[11]=n.length,r}function isPromise$2(n){return n==null?!1:typeof n.then=="function"&&typeof n.catch=="function"&&typeof n.finally=="function"}function closeSource(n,r){const _=getIterator(n).return?.();isPromise$2(_)&&_.catch(E=>{r.error("could not cause iterator to return",E)})}const ERR_STREAM_RESET="ERR_STREAM_RESET",ERR_SINK_INVALID_STATE="ERR_SINK_INVALID_STATE",DEFAULT_SEND_CLOSE_WRITE_TIMEOUT=5e3;function isPromise$1(n){return n==null?!1:typeof n.then=="function"&&typeof n.catch=="function"&&typeof n.finally=="function"}class AbstractStream{id;direction;timeline;protocol;metadata;source;status;readStatus;writeStatus;log;sinkController;sinkEnd;closed;endErr;streamSource;onEnd;onCloseRead;onCloseWrite;onReset;onAbort;sendCloseWriteTimeout;sendingData;constructor(r){this.sinkController=new AbortController,this.sinkEnd=pDefer(),this.closed=pDefer(),this.log=r.log,this.status="open",this.readStatus="ready",this.writeStatus="ready",this.id=r.id,this.metadata=r.metadata??{},this.direction=r.direction,this.timeline={open:Date.now()},this.sendCloseWriteTimeout=r.sendCloseWriteTimeout??DEFAULT_SEND_CLOSE_WRITE_TIMEOUT,this.onEnd=r.onEnd,this.onCloseRead=r?.onCloseRead,this.onCloseWrite=r?.onCloseWrite,this.onReset=r?.onReset,this.onAbort=r?.onAbort,this.source=this.streamSource=pushable$1({onEnd:_=>{_!=null?this.log.trace("source ended with error",_):this.log.trace("source ended"),this.onSourceEnd(_)}}),this.sink=this.sink.bind(this)}async sink(r){if(this.writeStatus!=="ready")throw new CodeError$4(`writable end state is "${this.writeStatus}" not "ready"`,ERR_SINK_INVALID_STATE);try{this.writeStatus="writing";const _={signal:this.sinkController.signal};if(this.direction==="outbound"){const S=this.sendNewStream(_);isPromise$1(S)&&await S}const E=()=>{closeSource(r,this.log)};try{this.sinkController.signal.addEventListener("abort",E),this.log.trace("sink reading from source");for await(let S of r){S=S instanceof Uint8Array?new Uint8ArrayList(S):S;const C=this.sendData(S,_);isPromise$1(C)&&(this.sendingData=pDefer(),await C,this.sendingData.resolve(),this.sendingData=void 0)}}finally{this.sinkController.signal.removeEventListener("abort",E)}this.log.trace('sink finished reading from source, write status is "%s"',this.writeStatus),this.writeStatus==="writing"&&(this.writeStatus="closing",this.log.trace("send close write to remote"),await this.sendCloseWrite({signal:AbortSignal.timeout(this.sendCloseWriteTimeout)}),this.writeStatus="closed"),this.onSinkEnd()}catch(_){throw this.log.trace("sink ended with error, calling abort with error",_),this.abort(_),_}finally{this.log.trace("resolve sink end"),this.sinkEnd.resolve()}}onSourceEnd(r){this.timeline.closeRead==null&&(this.timeline.closeRead=Date.now(),this.readStatus="closed",r!=null&&this.endErr==null&&(this.endErr=r),this.onCloseRead?.(),this.timeline.closeWrite!=null?(this.log.trace("source and sink ended"),this.timeline.close=Date.now(),this.status!=="aborted"&&this.status!=="reset"&&(this.status="closed"),this.onEnd!=null&&this.onEnd(this.endErr),this.closed.resolve()):this.log.trace("source ended, waiting for sink to end"))}onSinkEnd(r){this.timeline.closeWrite==null&&(this.timeline.closeWrite=Date.now(),this.writeStatus="closed",r!=null&&this.endErr==null&&(this.endErr=r),this.onCloseWrite?.(),this.timeline.closeRead!=null?(this.log.trace("sink and source ended"),this.timeline.close=Date.now(),this.status!=="aborted"&&this.status!=="reset"&&(this.status="closed"),this.onEnd!=null&&this.onEnd(this.endErr),this.closed.resolve()):this.log.trace("sink ended, waiting for source to end"))}async close(r){this.log.trace("closing gracefully"),this.status="closing",await raceSignal(Promise.all([this.closeWrite(r),this.closeRead(r),this.closed.promise]),r?.signal),this.status="closed",this.log.trace("closed gracefully")}async closeRead(r={}){if(this.readStatus==="closing"||this.readStatus==="closed")return;this.log.trace('closing readable end of stream with starting read status "%s"',this.readStatus);const _=this.readStatus;this.readStatus="closing",this.status!=="reset"&&this.status!=="aborted"&&this.timeline.closeRead==null&&(this.log.trace("send close read to remote"),await this.sendCloseRead(r)),_==="ready"&&(this.log.trace("ending internal source queue with %d queued bytes",this.streamSource.readableLength),this.streamSource.end()),this.log.trace("closed readable end of stream")}async closeWrite(r={}){this.writeStatus==="closing"||this.writeStatus==="closed"||(this.log.trace('closing writable end of stream with starting write status "%s"',this.writeStatus),this.writeStatus==="ready"&&(this.log.trace("sink was never sunk, sink an empty array"),await raceSignal(this.sink([]),r.signal)),this.writeStatus==="writing"&&(this.sendingData!=null&&await raceSignal(this.sendingData.promise,r.signal),this.log.trace("aborting source passed to .sink"),this.sinkController.abort(),await raceSignal(this.sinkEnd.promise,r.signal)),this.writeStatus="closed",this.log.trace("closed writable end of stream"))}abort(r){if(this.status==="closed"||this.status==="aborted"||this.status==="reset")return;this.log("abort with error",r),this.log("try to send reset to remote");const _=this.sendReset();isPromise$1(_)&&_.catch(E=>{this.log.error("error sending reset message",E)}),this.status="aborted",this.timeline.abort=Date.now(),this._closeSinkAndSource(r),this.onAbort?.(r)}reset(){if(this.status==="closed"||this.status==="aborted"||this.status==="reset")return;const r=new CodeError$4("stream reset",ERR_STREAM_RESET);this.status="reset",this.timeline.reset=Date.now(),this._closeSinkAndSource(r),this.onReset?.()}_closeSinkAndSource(r){this._closeSink(r),this._closeSource(r)}_closeSink(r){this.writeStatus==="writing"&&(this.log.trace("end sink source"),this.sinkController.abort()),this.onSinkEnd(r)}_closeSource(r){this.readStatus!=="closing"&&this.readStatus!=="closed"&&(this.log.trace("ending source with %d bytes to be read by consumer",this.streamSource.readableLength),this.readStatus="closing",this.streamSource.end(r))}remoteCloseWrite(){if(this.readStatus==="closing"||this.readStatus==="closed"){this.log("received remote close write but local source is already closed");return}this.log.trace("remote close write"),this._closeSource()}remoteCloseRead(){if(this.writeStatus==="closing"||this.writeStatus==="closed"){this.log("received remote close read but local sink is already closed");return}this.log.trace("remote close read"),this._closeSink()}destroy(){if(this.status==="closed"||this.status==="aborted"||this.status==="reset"){this.log("received destroy but we are already closed");return}this.log.trace("stream destroyed"),this._closeSinkAndSource()}sourcePush(r){this.streamSource.push(r)}sourceReadableLength(){return this.streamSource.readableLength}}var StreamState;(function(n){n[n.Init=0]="Init",n[n.SYNSent=1]="SYNSent",n[n.SYNReceived=2]="SYNReceived",n[n.Established=3]="Established",n[n.Finished=4]="Finished"})(StreamState||(StreamState={}));class YamuxStream extends AbstractStream{name;state;config;_id;sendWindowCapacity;sendWindowCapacityUpdate;recvWindow;recvWindowCapacity;epochStart;getRTT;sendFrame;constructor(r){super({...r,onEnd:_=>{this.state=StreamState.Finished,r.onEnd?.(_)}}),this.config=r.config,this._id=parseInt(r.id,10),this.name=r.name,this.state=r.state,this.sendWindowCapacity=INITIAL_STREAM_WINDOW,this.recvWindow=this.config.initialStreamWindowSize,this.recvWindowCapacity=this.recvWindow,this.epochStart=Date.now(),this.getRTT=r.getRTT,this.sendFrame=r.sendFrame,this.source=forEach(this.source,()=>{this.sendWindowUpdate()})}async sendNewStream(){}async sendData(r,_={}){for(r=r.sublist();r.byteLength!==0;){if(this.sendWindowCapacity===0&&(this.log?.trace("wait for send window capacity, status %s",this.status),await this.waitForSendWindowCapacity(_),this.status==="closed"||this.status==="aborted"||this.status==="reset")){this.log?.trace("%s while waiting for send window capacity",this.status);return}const E=Math.min(this.sendWindowCapacity,this.config.maxMessageSize-HEADER_LENGTH,r.length),S=this.getSendFlags();this.sendFrame({type:FrameType.Data,flag:S,streamID:this._id,length:E},r.sublist(0,E)),this.sendWindowCapacity-=E,r.consume(E)}}async sendReset(){this.sendFrame({type:FrameType.WindowUpdate,flag:Flag.RST,streamID:this._id,length:0})}async sendCloseWrite(){const r=this.getSendFlags()|Flag.FIN;this.sendFrame({type:FrameType.WindowUpdate,flag:r,streamID:this._id,length:0})}async sendCloseRead(){}async waitForSendWindowCapacity(r={}){if(this.sendWindowCapacity>0)return;let _,E;const S=()=>{this.status==="open"||this.status==="closing"?E(new CodeError$4("stream aborted",ERR_STREAM_ABORT)):_()};r.signal?.addEventListener("abort",S);try{await new Promise((C,A)=>{this.sendWindowCapacityUpdate=()=>{C()},E=A,_=C})}finally{r.signal?.removeEventListener("abort",S)}}handleWindowUpdate(r){this.log?.trace("stream received window update id=%s",this._id),this.processFlags(r.flag);const _=this.sendWindowCapacity;this.sendWindowCapacity+=r.length,_===0&&r.length>0&&this.sendWindowCapacityUpdate?.()}async handleData(r,_){if(this.log?.trace("stream received data id=%s",this._id),this.processFlags(r.flag),this.recvWindowCapacity<r.length)throw new CodeError$4("receive window exceeded",ERR_RECV_WINDOW_EXCEEDED,{available:this.recvWindowCapacity,recv:r.length});const E=await _();this.recvWindowCapacity-=r.length,this.sourcePush(E)}processFlags(r){(r&Flag.ACK)===Flag.ACK&&this.state===StreamState.SYNSent&&(this.state=StreamState.Established),(r&Flag.FIN)===Flag.FIN&&this.remoteCloseWrite(),(r&Flag.RST)===Flag.RST&&this.reset()}getSendFlags(){switch(this.state){case StreamState.Init:return this.state=StreamState.SYNSent,Flag.SYN;case StreamState.SYNReceived:return this.state=StreamState.Established,Flag.ACK;default:return 0}}sendWindowUpdate(){const r=this.getSendFlags(),_=Date.now(),E=this.getRTT();if(r===0&&E>-1&&_-this.epochStart<E*4&&(this.recvWindow=Math.min(this.recvWindow*2,this.config.maxStreamWindowSize)),this.recvWindowCapacity>=this.recvWindow&&r===0)return;const S=this.recvWindow-this.recvWindowCapacity;this.recvWindowCapacity=this.recvWindow,this.epochStart=_,this.sendFrame({type:FrameType.WindowUpdate,flag:r,streamID:this._id,length:S})}}const YAMUX_PROTOCOL_ID="/yamux/1.0.0",CLOSE_TIMEOUT$3=500;class Yamux{protocol=YAMUX_PROTOCOL_ID;_components;_init;constructor(r,_={}){this._components=r,this._init=_}createStreamMuxer(r){return new YamuxMuxer(this._components,{...this._init,...r})}}class YamuxMuxer{protocol=YAMUX_PROTOCOL_ID;source;sink;config;log;logger;closeController;nextStreamID;_streams;nextPingID;activePing;rtt;client;localGoAway;remoteGoAway;numInboundStreams;numOutboundStreams;onIncomingStream;onStreamEnd;constructor(r,_){this.client=_.direction==="outbound",this.config={...defaultConfig,..._},this.logger=r.logger,this.log=this.logger.forComponent("libp2p:yamux"),verifyConfig(this.config),this.closeController=new AbortController,setMaxListeners$2(1/0,this.closeController.signal),this.onIncomingStream=_.onIncomingStream,this.onStreamEnd=_.onStreamEnd,this._streams=new Map,this.source=pushable$1({onEnd:()=>{this.log?.trace("muxer source ended"),this._streams.forEach(E=>{E.destroy()})}}),this.sink=async E=>{const S=()=>{const I=getIterator(E);if(I.return!=null){const B=I.return();isPromise(B)&&B.catch(O=>{this.log?.("could not cause sink source to return",O)})}};let C,A;try{const I=new Decoder$1(E);try{this.closeController.signal.addEventListener("abort",S);for await(const B of I.emitFrames())await this.handleFrame(B.header,B.readData)}finally{this.closeController.signal.removeEventListener("abort",S)}C=GoAwayCode.NormalTermination}catch(I){const B=I.code;PROTOCOL_ERRORS.has(B)?(this.log?.error("protocol error in sink",I),C=GoAwayCode.ProtocolError):(this.log?.error("internal error in sink",I),C=GoAwayCode.InternalError),A=I}this.log?.trace("muxer sink ended"),A!=null?this.abort(A,C):await this.close({reason:C})},this.numInboundStreams=0,this.numOutboundStreams=0,this.nextStreamID=this.client?1:2,this.nextPingID=0,this.rtt=-1,this.log?.trace("muxer created"),this.config.enableKeepAlive&&this.keepAliveLoop().catch(E=>this.log?.error("keepalive error: %s",E)),this.ping().catch(E=>this.log?.error("ping error: %s",E))}get streams(){return Array.from(this._streams.values())}newStream(r){if(this.remoteGoAway!==void 0)throw new CodeError$4("muxer closed remotely",ERR_MUXER_REMOTE_CLOSED);if(this.localGoAway!==void 0)throw new CodeError$4("muxer closed locally",ERR_MUXER_LOCAL_CLOSED);const _=this.nextStreamID;if(this.nextStreamID+=2,this.numOutboundStreams>=this.config.maxOutboundStreams)throw new CodeError$4("max outbound streams exceeded",ERR_MAX_OUTBOUND_STREAMS_EXCEEDED);this.log?.trace("new outgoing stream id=%s",_);const E=this._newStream(_,r,StreamState.Init,"outbound");return this._streams.set(_,E),this.numOutboundStreams++,E.sendWindowUpdate(),E}async ping(){if(this.remoteGoAway!==void 0)throw new CodeError$4("muxer closed remotely",ERR_MUXER_REMOTE_CLOSED);if(this.localGoAway!==void 0)throw new CodeError$4("muxer closed locally",ERR_MUXER_LOCAL_CLOSED);if(this.activePing===void 0){let r=()=>{};this.activePing={id:this.nextPingID++,promise:new Promise((S,C)=>{const A=()=>{C(new CodeError$4("muxer closed locally",ERR_MUXER_LOCAL_CLOSED))};this.closeController.signal.addEventListener("abort",A,{once:!0}),r=()=>{this.closeController.signal.removeEventListener("abort",A),S()}}),resolve:r};const _=Date.now();this.sendPing(this.activePing.id);try{await this.activePing.promise}finally{delete this.activePing}const E=Date.now();this.rtt=E-_}else await this.activePing.promise;return this.rtt}getRTT(){return this.rtt}async close(r={}){if(this.closeController.signal.aborted)return;const _=r?.reason??GoAwayCode.NormalTermination;if(this.log?.trace("muxer close reason=%s",_),r.signal==null){const E=AbortSignal.timeout(CLOSE_TIMEOUT$3);setMaxListeners$2(1/0,E),r={...r,signal:E}}try{await Promise.all([...this._streams.values()].map(async E=>E.close(r))),this.sendGoAway(_),this._closeMuxer()}catch(E){this.abort(E)}}abort(r,_){if(!this.closeController.signal.aborted){_=_??GoAwayCode.InternalError,this.log?.error("muxer abort reason=%s error=%s",_,r);for(const E of this._streams.values())E.abort(r);this.sendGoAway(_),this._closeMuxer()}}isClosed(){return this.closeController.signal.aborted}_closeMuxer(){this.closeController.abort(),this.source.end()}_newStream(r,_,E,S){if(this._streams.get(r)!=null)throw new CodeError$4("Stream already exists",ERR_STREAM_ALREADY_EXISTS,{id:r});const C=new YamuxStream({id:r.toString(),name:_,state:E,direction:S,sendFrame:this.sendFrame.bind(this),onEnd:()=>{this.closeStream(r),this.onStreamEnd?.(C)},log:this.logger.forComponent(`libp2p:yamux:${S}:${r}`),config:this.config,getRTT:this.getRTT.bind(this)});return C}closeStream(r){this.client===(r%2===0)?this.numInboundStreams--:this.numOutboundStreams--,this._streams.delete(r)}async keepAliveLoop(){const r=new Promise((_,E)=>{this.closeController.signal.addEventListener("abort",E,{once:!0})});for(this.log?.trace("muxer keepalive enabled interval=%s",this.config.keepAliveInterval);;){let _;try{await Promise.race([r,new Promise(E=>{_=setTimeout(E,this.config.keepAliveInterval)})]),this.ping().catch(E=>this.log?.error("ping error: %s",E))}catch{clearInterval(_);return}}}async handleFrame(r,_){const{streamID:E,type:S,length:C}=r;if(this.log?.trace("received frame %o",r),E===0)switch(S){case FrameType.Ping:{this.handlePing(r);return}case FrameType.GoAway:{this.handleGoAway(C);return}default:throw new CodeError$4("Invalid frame type",ERR_INVALID_FRAME,{header:r})}else switch(r.type){case FrameType.Data:case FrameType.WindowUpdate:{await this.handleStreamMessage(r,_);return}default:throw new CodeError$4("Invalid frame type",ERR_INVALID_FRAME,{header:r})}}handlePing(r){if(r.flag===Flag.SYN)this.log?.trace("received ping request pingId=%s",r.length),this.sendPing(r.length,Flag.ACK);else if(r.flag===Flag.ACK)this.log?.trace("received ping response pingId=%s",r.length),this.handlePingResponse(r.length);else throw new CodeError$4("Invalid frame flag",ERR_INVALID_FRAME,{header:r})}handlePingResponse(r){if(this.activePing===void 0)throw new CodeError$4("ping not requested",ERR_UNREQUESTED_PING);if(this.activePing.id!==r)throw new CodeError$4("ping doesn't match our id",ERR_NOT_MATCHING_PING);this.activePing.resolve()}handleGoAway(r){this.log?.trace("received GoAway reason=%s",GoAwayCode[r]??"unknown"),this.remoteGoAway=r;for(const _ of this._streams.values())_.reset();this._closeMuxer()}async handleStreamMessage(r,_){const{streamID:E,flag:S,type:C}=r;(S&Flag.SYN)===Flag.SYN&&this.incomingStream(E);const A=this._streams.get(E);if(A===void 0){if(C===FrameType.Data){if(this.log?.("discarding data for stream id=%s",E),_===void 0)throw new Error("unreachable");await _()}else this.log?.("frame for missing stream id=%s",E);return}switch(C){case FrameType.WindowUpdate:{A.handleWindowUpdate(r);return}case FrameType.Data:{if(_===void 0)throw new Error("unreachable");await A.handleData(r,_);return}default:throw new Error("unreachable")}}incomingStream(r){if(this.client!==(r%2===0))throw new CodeError$4("both endpoints are clients",ERR_BOTH_CLIENTS);if(this._streams.has(r))return;if(this.log?.trace("new incoming stream id=%s",r),this.localGoAway!==void 0){this.sendFrame({type:FrameType.WindowUpdate,flag:Flag.RST,streamID:r,length:0});return}if(this.numInboundStreams>=this.config.maxInboundStreams){this.log?.("maxIncomingStreams exceeded, forcing stream reset"),this.sendFrame({type:FrameType.WindowUpdate,flag:Flag.RST,streamID:r,length:0});return}const _=this._newStream(r,void 0,StreamState.SYNReceived,"inbound");this.numInboundStreams++,this._streams.set(r,_),this.onIncomingStream?.(_)}sendFrame(r,_){if(this.log?.trace("sending frame %o",r),r.type===FrameType.Data){if(_===void 0)throw new CodeError$4("invalid frame",ERR_INVALID_FRAME);this.source.push(new Uint8ArrayList(encodeHeader(r),_))}else this.source.push(encodeHeader(r))}sendPing(r,_=Flag.SYN){_===Flag.SYN?this.log?.trace("sending ping request pingId=%s",r):this.log?.trace("sending ping response pingId=%s",r),this.sendFrame({type:FrameType.Ping,flag:_,streamID:0,length:r})}sendGoAway(r=GoAwayCode.NormalTermination){this.log?.("sending GoAway reason=%s",GoAwayCode[r]),this.localGoAway=r,this.sendFrame({type:FrameType.GoAway,flag:0,streamID:0,length:r})}}function isPromise(n){return n!=null&&typeof n.then=="function"}function yamux(n={}){return r=>new Yamux(r,n)}const contentRouting=Symbol.for("@libp2p/content-routing");class CodeError extends Error{code;props;constructor(r,_,E){super(r),this.code=_,this.name=E?.name??"CodeError",this.props=E??{}}}function setMaxListeners$1(){}const setMaxListeners=(n,...r)=>{try{[...r]}catch{}},peerRouting=Symbol.for("@libp2p/peer-routing"),base64$2=rfc4648$3({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),base64pad$1=rfc4648$3({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),base64url$1=rfc4648$3({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),base64urlpad$1=rfc4648$3({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6}),base64$3=Object.freeze(Object.defineProperty({__proto__:null,base64:base64$2,base64pad:base64pad$1,base64url:base64url$1,base64urlpad:base64urlpad$1},Symbol.toStringTag,{value:"Module"}));_debug.formatters.b=n=>n==null?"undefined":base58btc$1.baseEncode(n);_debug.formatters.t=n=>n==null?"undefined":base32$2.baseEncode(n);_debug.formatters.m=n=>n==null?"undefined":base64$2.baseEncode(n);_debug.formatters.p=n=>n==null?"undefined":n.toString();_debug.formatters.c=n=>n==null?"undefined":n.toString();_debug.formatters.k=n=>n==null?"undefined":n.toString();_debug.formatters.a=n=>n==null?"undefined":n.toString();function createDisabledLogger(n){const r=()=>{};return r.enabled=!1,r.color="",r.diff=0,r.log=()=>{},r.namespace=n,r.destroy=()=>!0,r.extend=()=>r,r}function logger(n){let r=createDisabledLogger(`${n}:trace`);return _debug.enabled(`${n}:trace`)&&_debug.names.map(_=>_.toString()).find(_=>_.includes(":trace"))!=null&&(r=_debug(`${n}:trace`)),Object.assign(_debug(n),{error:_debug(`${n}:error`),trace:r})}const symbol$1=Symbol.for("@libp2p/peer-id");function isPeerId(n){return n!=null&&!!n[symbol$1]}const base10$2=baseX$2({prefix:"9",name:"base10",alphabet:"0123456789"}),base10$3=Object.freeze(Object.defineProperty({__proto__:null,base10:base10$2},Symbol.toStringTag,{value:"Module"})),base16$2=rfc4648$3({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),base16upper$1=rfc4648$3({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4}),base16$3=Object.freeze(Object.defineProperty({__proto__:null,base16:base16$2,base16upper:base16upper$1},Symbol.toStringTag,{value:"Module"})),base2$2=rfc4648$3({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1}),base2$3=Object.freeze(Object.defineProperty({__proto__:null,base2:base2$2},Symbol.toStringTag,{value:"Module"})),alphabet$1=Array.from(""),alphabetBytesToChars$1=alphabet$1.reduce((n,r,_)=>(n[_]=r,n),[]),alphabetCharsToBytes$1=alphabet$1.reduce((n,r,_)=>(n[r.codePointAt(0)]=_,n),[]);function encode$5(n){return n.reduce((r,_)=>(r+=alphabetBytesToChars$1[_],r),"")}function decode$3(n){const r=[];for(const _ of n){const E=alphabetCharsToBytes$1[_.codePointAt(0)];if(E===void 0)throw new Error(`Non-base256emoji character: ${_}`);r.push(E)}return new Uint8Array(r)}const base256emoji$2=from$4({prefix:"",name:"base256emoji",encode:encode$5,decode:decode$3}),base256emoji$3=Object.freeze(Object.defineProperty({__proto__:null,base256emoji:base256emoji$2},Symbol.toStringTag,{value:"Module"})),base36$2=baseX$2({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),base36upper$1=baseX$2({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"}),base36$3=Object.freeze(Object.defineProperty({__proto__:null,base36:base36$2,base36upper:base36upper$1},Symbol.toStringTag,{value:"Module"})),base8$2=rfc4648$3({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3}),base8$3=Object.freeze(Object.defineProperty({__proto__:null,base8:base8$2},Symbol.toStringTag,{value:"Module"})),identity$3=from$4({prefix:"\0",name:"identity",encode:n=>toString$7(n),decode:n=>fromString$6(n)}),identityBase$1=Object.freeze(Object.defineProperty({__proto__:null,identity:identity$3},Symbol.toStringTag,{value:"Module"}));new TextEncoder;new TextDecoder;const code=0,name$2="identity",encode$4=coerce$1,digest=n=>create$5(code,encode$4(n)),identity$2={code,name:name$2,encode:encode$4,digest},bases$1={...identityBase$1,...base2$3,...base8$3,...base10$3,...base16$3,...base32$3,...base36$3,...base58$1,...base64$3,...base256emoji$3};function equals(n,r){if(n===r)return!0;if(n.byteLength!==r.byteLength)return!1;for(let _=0;_<n.byteLength;_++)if(n[_]!==r[_])return!1;return!0}const inspect$1=Symbol.for("nodejs.util.inspect.custom"),baseDecoder=Object.values(bases$1).map(n=>n.decoder).reduce((n,r)=>n.or(r),bases$1.identity.decoder),LIBP2P_KEY_CODE=114,MARSHALLED_ED225519_PUBLIC_KEY_LENGTH=36,MARSHALLED_SECP256K1_PUBLIC_KEY_LENGTH=37;class PeerIdImpl{type;multihash;privateKey;publicKey;string;constructor(r){this.type=r.type,this.multihash=r.multihash,this.privateKey=r.privateKey,Object.defineProperty(this,"string",{enumerable:!1,writable:!0})}get[Symbol.toStringTag](){return`PeerId(${this.toString()})`}[symbol$1]=!0;toString(){return this.string==null&&(this.string=base58btc$1.encode(this.multihash.bytes).slice(1)),this.string}toCID(){return CID$1.createV1(LIBP2P_KEY_CODE,this.multihash)}toBytes(){return this.multihash.bytes}toJSON(){return this.toString()}equals(r){if(r instanceof Uint8Array)return equals(this.multihash.bytes,r);if(typeof r=="string")return peerIdFromString(r).equals(this);if(r?.multihash?.bytes!=null)return equals(this.multihash.bytes,r.multihash.bytes);throw new Error("not valid Id")}[inspect$1](){return`PeerId(${this.toString()})`}}class RSAPeerIdImpl extends PeerIdImpl{type="RSA";publicKey;constructor(r){super({...r,type:"RSA"}),this.publicKey=r.publicKey}}class Ed25519PeerIdImpl extends PeerIdImpl{type="Ed25519";publicKey;constructor(r){super({...r,type:"Ed25519"}),this.publicKey=r.multihash.digest}}class Secp256k1PeerIdImpl extends PeerIdImpl{type="secp256k1";publicKey;constructor(r){super({...r,type:"secp256k1"}),this.publicKey=r.multihash.digest}}function peerIdFromString(n,r){if(n.charAt(0)==="1"||n.charAt(0)==="Q"){const _=decode$n(base58btc$1.decode(`z${n}`));return n.startsWith("12D")?new Ed25519PeerIdImpl({multihash:_}):n.startsWith("16U")?new Secp256k1PeerIdImpl({multihash:_}):new RSAPeerIdImpl({multihash:_})}return peerIdFromBytes(baseDecoder.decode(n))}function peerIdFromBytes(n){try{const r=decode$n(n);if(r.code===identity$2.code){if(r.digest.length===MARSHALLED_ED225519_PUBLIC_KEY_LENGTH)return new Ed25519PeerIdImpl({multihash:r});if(r.digest.length===MARSHALLED_SECP256K1_PUBLIC_KEY_LENGTH)return new Secp256k1PeerIdImpl({multihash:r})}if(r.code===sha256$7.code)return new RSAPeerIdImpl({multihash:r})}catch{return peerIdFromCID(CID$1.decode(n))}throw new Error("Supplied PeerID CID is invalid")}function peerIdFromCID(n){if(n==null||n.multihash==null||n.version==null||n.version===1&&n.code!==LIBP2P_KEY_CODE)throw new Error("Supplied PeerID CID is invalid");const r=n.multihash;if(r.code===sha256$7.code)return new RSAPeerIdImpl({multihash:n.multihash});if(r.code===identity$2.code){if(r.digest.length===MARSHALLED_ED225519_PUBLIC_KEY_LENGTH)return new Ed25519PeerIdImpl({multihash:n.multihash});if(r.digest.length===MARSHALLED_SECP256K1_PUBLIC_KEY_LENGTH)return new Secp256k1PeerIdImpl({multihash:n.multihash})}throw new Error("Supplied PeerID CID is invalid")}async function peerIdFromKeys(n,r){return n.length===MARSHALLED_ED225519_PUBLIC_KEY_LENGTH?new Ed25519PeerIdImpl({multihash:create$5(identity$2.code,n),privateKey:r}):n.length===MARSHALLED_SECP256K1_PUBLIC_KEY_LENGTH?new Secp256k1PeerIdImpl({multihash:create$5(identity$2.code,n),privateKey:r}):new RSAPeerIdImpl({multihash:await sha256$7.digest(n),publicKey:n,privateKey:r})}function stringToMultiaddrParts(n){n=cleanPath(n);const r=[],_=[];let E=null;const S=n.split("/").slice(1);if(S.length===1&&S[0]==="")return{bytes:new Uint8Array,string:"/",tuples:[],stringTuples:[],path:null};for(let C=0;C<S.length;C++){const A=S[C],I=getProtocol(A);if(I.size===0){r.push([I.code]),_.push([I.code]);continue}if(C++,C>=S.length)throw ParseError("invalid address: "+n);if(I.path===!0){E=cleanPath(S.slice(C).join("/")),r.push([I.code,convertToBytes(I.code,E)]),_.push([I.code,E]);break}const B=convertToBytes(I.code,S[C]);r.push([I.code,B]),_.push([I.code,convertToString(I.code,B)])}return{string:stringTuplesToString(_),bytes:tuplesToBytes(r),tuples:r,stringTuples:_,path:E}}function bytesToMultiaddrParts(n){const r=[],_=[];let E=null,S=0;for(;S<n.length;){const C=decode$b(n,S),A=encodingLength(C),I=getProtocol(C),B=sizeForAddr(I,n.slice(S+A));if(B===0){r.push([C]),_.push([C]),S+=A;continue}const O=n.slice(S+A,S+A+B);if(S+=B+A,S>n.length)throw ParseError("Invalid address Uint8Array: "+toString$4(n,"base16"));r.push([C,O]);const N=convertToString(C,O);if(_.push([C,N]),I.path===!0){E=N;break}}return{bytes:Uint8Array.from(n),string:stringTuplesToString(_),tuples:r,stringTuples:_,path:E}}function stringTuplesToString(n){const r=[];return n.map(_=>{const E=getProtocol(_[0]);return r.push(E.name),_.length>1&&_[1]!=null&&r.push(_[1]),null}),cleanPath(r.join("/"))}function tuplesToBytes(n){return concat$4(n.map(r=>{const _=getProtocol(r[0]);let E=Uint8Array.from(encode$b(_.code));return r.length>1&&r[1]!=null&&(E=concat$4([E,r[1]])),E}))}function sizeForAddr(n,r){if(n.size>0)return n.size/8;if(n.size===0)return 0;{const _=decode$b(r instanceof Uint8Array?r:Uint8Array.from(r));return _+encodingLength(_)}}function cleanPath(n){return"/"+n.trim().split("/").filter(r=>r).join("/")}function ParseError(n){return new Error("Error parsing address: "+n)}const inspect=Symbol.for("nodejs.util.inspect.custom"),symbol=Symbol.for("@multiformats/js-multiaddr/multiaddr"),DNS_CODES=[getProtocol("dns").code,getProtocol("dns4").code,getProtocol("dns6").code,getProtocol("dnsaddr").code];class Multiaddr{bytes;#e;#t;#r;#a;[symbol]=!0;constructor(r){r==null&&(r="");let _;if(r instanceof Uint8Array)_=bytesToMultiaddrParts(r);else if(typeof r=="string"){if(r.length>0&&r.charAt(0)!=="/")throw new Error(`multiaddr "${r}" must start with a "/"`);_=stringToMultiaddrParts(r)}else if(isMultiaddr(r))_=bytesToMultiaddrParts(r.bytes);else throw new Error("addr must be a string, Buffer, or another Multiaddr");this.bytes=_.bytes,this.#e=_.string,this.#t=_.tuples,this.#r=_.stringTuples,this.#a=_.path}toString(){return this.#e}toJSON(){return this.toString()}toOptions(){let r,_,E,S,C="";const A=getProtocol("tcp"),I=getProtocol("udp"),B=getProtocol("ip4"),O=getProtocol("ip6"),N=getProtocol("dns6"),U=getProtocol("ip6zone");for(const[z,Z]of this.stringTuples())z===U.code&&(C=`%${Z??""}`),DNS_CODES.includes(z)&&(_=A.name,S=443,E=`${Z??""}${C}`,r=z===N.code?6:4),(z===A.code||z===I.code)&&(_=getProtocol(z).name,S=parseInt(Z??"")),(z===B.code||z===O.code)&&(_=getProtocol(z).name,E=`${Z??""}${C}`,r=z===O.code?6:4);if(r==null||_==null||E==null||S==null)throw new Error('multiaddr must have a valid format: "/{ip4, ip6, dns4, dns6, dnsaddr}/{address}/{tcp, udp}/{port}".');return{family:r,host:E,transport:_,port:S}}protos(){return this.#t.map(([r])=>Object.assign({},getProtocol(r)))}protoCodes(){return this.#t.map(([r])=>r)}protoNames(){return this.#t.map(([r])=>getProtocol(r).name)}tuples(){return this.#t}stringTuples(){return this.#r}encapsulate(r){return r=new Multiaddr(r),new Multiaddr(this.toString()+r.toString())}decapsulate(r){const _=r.toString(),E=this.toString(),S=E.lastIndexOf(_);if(S<0)throw new Error(`Address ${this.toString()} does not contain subaddress: ${r.toString()}`);return new Multiaddr(E.slice(0,S))}decapsulateCode(r){const _=this.tuples();for(let E=_.length-1;E>=0;E--)if(_[E][0]===r)return new Multiaddr(tuplesToBytes(_.slice(0,E)));return this}getPeerId(){try{let r=[];this.stringTuples().forEach(([E,S])=>{E===names$3.p2p.code&&r.push([E,S]),E===names$3["p2p-circuit"].code&&(r=[])});const _=r.pop();if(_?.[1]!=null){const E=_[1];return E[0]==="Q"||E[0]==="1"?toString$4(base58btc.decode(`z${E}`),"base58btc"):toString$4(CID.parse(E).multihash.bytes,"base58btc")}return null}catch{return null}}getPath(){return this.#a}equals(r){return equals$1(this.bytes,r.bytes)}async resolve(r){const _=this.protos().find(C=>C.resolvable);if(_==null)return[this];const E=resolvers.get(_.name);if(E==null)throw new CodeError$4(`no available resolver for ${_.name}`,"ERR_NO_AVAILABLE_RESOLVER");return(await E(this,r)).map(C=>multiaddr(C))}nodeAddress(){const r=this.toOptions();if(r.transport!=="tcp"&&r.transport!=="udp")throw new Error(`multiaddr must have a valid format - no protocol with name: "${r.transport}". Must have a valid transport protocol: "{tcp, udp}"`);return{family:r.family,address:r.host,port:r.port}}isThinWaistAddress(r){const _=(r??this).protos();return!(_.length!==2||_[0].code!==4&&_[0].code!==41||_[1].code!==6&&_[1].code!==273)}[inspect](){return`Multiaddr(${this.#e})`}}const resolvers=new Map;function isMultiaddr(n){return!!n?.[symbol]}function multiaddr(n){return new Multiaddr(n)}async function*browserReadableStreamToIt(n,r={}){const _=n.getReader();try{for(;;){const E=await _.read();if(E.done)return;yield E.value}}finally{r.preventCancel!==!0&&await _.cancel(),_.releaseLock()}}function createCodec$1(n,r,_,E){return{name:n,prefix:r,encoder:{name:n,prefix:r,encode:_},decoder:{decode:E}}}const string$2=createCodec$1("utf8","u",n=>"u"+new TextDecoder("utf8").decode(n),n=>new TextEncoder().encode(n.substring(1))),ascii$1=createCodec$1("ascii","a",n=>{let r="a";for(let _=0;_<n.length;_++)r+=String.fromCharCode(n[_]);return r},n=>{n=n.substring(1);const r=allocUnsafe$2(n.length);for(let _=0;_<n.length;_++)r[_]=n.charCodeAt(_);return r}),BASES$1={utf8:string$2,"utf-8":string$2,hex:bases$1.base16,latin1:ascii$1,ascii:ascii$1,binary:ascii$1,...bases$1};function fromString$2(n,r="utf8"){const _=BASES$1[r];if(_==null)throw new Error(`Unsupported encoding "${r}"`);return(r==="utf8"||r==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?asUint8Array$2(globalThis.Buffer.from(n,"utf-8")):_.decoder.decode(`${_.prefix}${n}`)}const PUBLIC_KEY_BYTE_LENGTH=32,PRIVATE_KEY_BYTE_LENGTH=64,KEYS_BYTE_LENGTH=32;async function generateKey$2(){const n=ed25519.utils.randomPrivateKey(),r=ed25519.getPublicKey(n);return{privateKey:concatKeys(n,r),publicKey:r}}async function generateKeyFromSeed(n){if(n.length!==KEYS_BYTE_LENGTH)throw new TypeError('"seed" must be 32 bytes in length.');if(!(n instanceof Uint8Array))throw new TypeError('"seed" must be a node.js Buffer, or Uint8Array.');const r=n,_=ed25519.getPublicKey(r);return{privateKey:concatKeys(r,_),publicKey:_}}async function hashAndSign$2(n,r){const _=n.subarray(0,KEYS_BYTE_LENGTH);return ed25519.sign(r,_)}async function hashAndVerify$2(n,r,_){return ed25519.verify(r,_,n)}function concatKeys(n,r){const _=new Uint8Array(PRIVATE_KEY_BYTE_LENGTH);for(let E=0;E<KEYS_BYTE_LENGTH;E++)_[E]=n[E],_[KEYS_BYTE_LENGTH+E]=r[E];return _}const webcrypto={get(n=globalThis){const r=n.crypto;if(r==null||r.subtle==null)throw Object.assign(new Error("Missing Web Crypto API. The most likely cause of this error is that this page is being accessed from an insecure context (i.e. not HTTPS). For more information and possible resolutions see https://github.com/libp2p/js-libp2p-crypto/blob/master/README.md#web-crypto-api"),{code:"ERR_MISSING_WEB_CRYPTO"});return r}},derivedEmptyPasswordKey={alg:"A128GCM",ext:!0,k:"scm9jmO_4BJAgdwWGVulLg",key_ops:["encrypt","decrypt"],kty:"oct"};function create(n){const r=n?.algorithm??"AES-GCM";let _=n?.keyLength??16;const E=n?.nonceLength??12,S=n?.digest??"SHA-256",C=n?.saltLength??16,A=n?.iterations??32767,I=webcrypto.get();_*=8;async function B(U,j){const z=I.getRandomValues(new Uint8Array(C)),Z=I.getRandomValues(new Uint8Array(E)),X={name:r,iv:Z};typeof j=="string"&&(j=fromString$2(j));let Q;if(j.length===0){Q=await I.subtle.importKey("jwk",derivedEmptyPasswordKey,{name:"AES-GCM"},!0,["encrypt"]);try{const oe={name:"PBKDF2",salt:z,iterations:A,hash:{name:S}},ue=await I.subtle.importKey("raw",j,{name:"PBKDF2"},!1,["deriveKey"]);Q=await I.subtle.deriveKey(oe,ue,{name:r,length:_},!0,["encrypt"])}catch{Q=await I.subtle.importKey("jwk",derivedEmptyPasswordKey,{name:"AES-GCM"},!0,["encrypt"])}}else{const oe={name:"PBKDF2",salt:z,iterations:A,hash:{name:S}},ue=await I.subtle.importKey("raw",j,{name:"PBKDF2"},!1,["deriveKey"]);Q=await I.subtle.deriveKey(oe,ue,{name:r,length:_},!0,["encrypt"])}const se=await I.subtle.encrypt(X,Q,U);return concat$7([z,X.iv,new Uint8Array(se)])}async function O(U,j){const z=U.subarray(0,C),Z=U.subarray(C,C+E),X=U.subarray(C+E),Q={name:r,iv:Z};typeof j=="string"&&(j=fromString$2(j));let se;if(j.length===0)try{const ue={name:"PBKDF2",salt:z,iterations:A,hash:{name:S}},we=await I.subtle.importKey("raw",j,{name:"PBKDF2"},!1,["deriveKey"]);se=await I.subtle.deriveKey(ue,we,{name:r,length:_},!0,["decrypt"])}catch{se=await I.subtle.importKey("jwk",derivedEmptyPasswordKey,{name:"AES-GCM"},!0,["decrypt"])}else{const ue={name:"PBKDF2",salt:z,iterations:A,hash:{name:S}},we=await I.subtle.importKey("raw",j,{name:"PBKDF2"},!1,["deriveKey"]);se=await I.subtle.deriveKey(ue,we,{name:r,length:_},!0,["decrypt"])}const oe=await I.subtle.decrypt(Q,se,X);return new Uint8Array(oe)}return{encrypt:B,decrypt:O}}async function exporter(n,r){const E=await create().encrypt(n,r);return base64$2.encode(E)}var KeyType;(function(n){n.RSA="RSA",n.Ed25519="Ed25519",n.Secp256k1="Secp256k1"})(KeyType||(KeyType={}));var __KeyTypeValues;(function(n){n[n.RSA=0]="RSA",n[n.Ed25519=1]="Ed25519",n[n.Secp256k1=2]="Secp256k1"})(__KeyTypeValues||(__KeyTypeValues={}));(function(n){n.codec=()=>enumeration(__KeyTypeValues)})(KeyType||(KeyType={}));var PublicKey;(function(n){let r;n.codec=()=>(r==null&&(r=message((_,E,S={})=>{S.lengthDelimited!==!1&&E.fork(),_.Type!=null&&(E.uint32(8),KeyType.codec().encode(_.Type,E)),_.Data!=null&&(E.uint32(18),E.bytes(_.Data)),S.lengthDelimited!==!1&&E.ldelim()},(_,E)=>{const S={},C=E==null?_.len:_.pos+E;for(;_.pos<C;){const A=_.uint32();switch(A>>>3){case 1:S.Type=KeyType.codec().decode(_);break;case 2:S.Data=_.bytes();break;default:_.skipType(A&7);break}}return S})),r),n.encode=_=>encodeMessage(_,n.codec()),n.decode=_=>decodeMessage$1(_,n.codec())})(PublicKey||(PublicKey={}));var PrivateKey;(function(n){let r;n.codec=()=>(r==null&&(r=message((_,E,S={})=>{S.lengthDelimited!==!1&&E.fork(),_.Type!=null&&(E.uint32(8),KeyType.codec().encode(_.Type,E)),_.Data!=null&&(E.uint32(18),E.bytes(_.Data)),S.lengthDelimited!==!1&&E.ldelim()},(_,E)=>{const S={},C=E==null?_.len:_.pos+E;for(;_.pos<C;){const A=_.uint32();switch(A>>>3){case 1:S.Type=KeyType.codec().decode(_);break;case 2:S.Data=_.bytes();break;default:_.skipType(A&7);break}}return S})),r),n.encode=_=>encodeMessage(_,n.codec()),n.decode=_=>decodeMessage$1(_,n.codec())})(PrivateKey||(PrivateKey={}));class Ed25519PublicKey{_key;constructor(r){this._key=ensureKey(r,PUBLIC_KEY_BYTE_LENGTH)}async verify(r,_){return hashAndVerify$2(this._key,_,r)}marshal(){return this._key}get bytes(){return PublicKey.encode({Type:KeyType.Ed25519,Data:this.marshal()}).subarray()}equals(r){return equals(this.bytes,r.bytes)}async hash(){const{bytes:r}=await sha256$7.digest(this.bytes);return r}}class Ed25519PrivateKey{_key;_publicKey;constructor(r,_){this._key=ensureKey(r,PRIVATE_KEY_BYTE_LENGTH),this._publicKey=ensureKey(_,PUBLIC_KEY_BYTE_LENGTH)}async sign(r){return hashAndSign$2(this._key,r)}get public(){return new Ed25519PublicKey(this._publicKey)}marshal(){return this._key}get bytes(){return PrivateKey.encode({Type:KeyType.Ed25519,Data:this.marshal()}).subarray()}equals(r){return equals(this.bytes,r.bytes)}async hash(){const{bytes:r}=await sha256$7.digest(this.bytes);return r}async id(){const r=identity$2.digest(this.public.bytes);return base58btc$1.encode(r.bytes).substring(1)}async export(r,_="libp2p-key"){if(_==="libp2p-key")return exporter(this.bytes,r);throw new CodeError(`export format '${_}' is not supported`,"ERR_INVALID_EXPORT_FORMAT")}}function unmarshalEd25519PrivateKey(n){if(n.length>PRIVATE_KEY_BYTE_LENGTH){n=ensureKey(n,PRIVATE_KEY_BYTE_LENGTH+PUBLIC_KEY_BYTE_LENGTH);const E=n.subarray(0,PRIVATE_KEY_BYTE_LENGTH),S=n.subarray(PRIVATE_KEY_BYTE_LENGTH,n.length);return new Ed25519PrivateKey(E,S)}n=ensureKey(n,PRIVATE_KEY_BYTE_LENGTH);const r=n.subarray(0,PRIVATE_KEY_BYTE_LENGTH),_=n.subarray(PUBLIC_KEY_BYTE_LENGTH);return new Ed25519PrivateKey(r,_)}function unmarshalEd25519PublicKey(n){return n=ensureKey(n,PUBLIC_KEY_BYTE_LENGTH),new Ed25519PublicKey(n)}async function generateKeyPair$2(){const{privateKey:n,publicKey:r}=await generateKey$2();return new Ed25519PrivateKey(n,r)}async function generateKeyPairFromSeed(n){const{privateKey:r,publicKey:_}=await generateKeyFromSeed(n);return new Ed25519PrivateKey(r,_)}function ensureKey(n,r){if(n=Uint8Array.from(n??[]),n.length!==r)throw new CodeError(`Key must be a Uint8Array of length ${r}, got ${n.length}`,"ERR_INVALID_KEY_TYPE");return n}const Ed25519=Object.freeze(Object.defineProperty({__proto__:null,Ed25519PrivateKey,Ed25519PublicKey,generateKeyPair:generateKeyPair$2,generateKeyPairFromSeed,unmarshalEd25519PrivateKey,unmarshalEd25519PublicKey},Symbol.toStringTag,{value:"Module"}));function toString$2(n,r="utf8"){const _=BASES$1[r];if(_==null)throw new Error(`Unsupported encoding "${r}"`);return(r==="utf8"||r==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(n.buffer,n.byteOffset,n.byteLength).toString("utf8"):_.encoder.encode(n).substring(1)}function bigIntegerToUintBase64url(n,r){let _=Uint8Array.from(n.abs().toByteArray());if(_=_[0]===0?_.subarray(1):_,r!=null){if(_.length>r)throw new Error("byte array longer than desired length");_=concat$7([new Uint8Array(r-_.length),_])}return toString$2(_,"base64url")}function base64urlToBigInteger(n){const r=base64urlToBuffer(n);return new forge$n.jsbn.BigInteger(toString$2(r,"base16"),16)}function base64urlToBuffer(n,r){let _=fromString$2(n,"base64urlpad");if(r!=null){if(_.length>r)throw new Error("byte array longer than desired length");_=concat$7([new Uint8Array(r-_.length),_])}return _}const bits={"P-256":256,"P-384":384,"P-521":521},curveTypes=Object.keys(bits);curveTypes.join(" / ");function randomBytes(n){if(isNaN(n)||n<=0)throw new CodeError("random bytes length must be a Number bigger than 0","ERR_INVALID_LENGTH");return randomBytes$3(n)}function convert(n,r){return r.map(_=>base64urlToBigInteger(n[_]))}function jwk2priv(n){return forge$n.pki.setRsaPrivateKey(...convert(n,["n","e","d","p","q","dp","dq","qi"]))}function jwk2pub(n){return forge$n.pki.setRsaPublicKey(...convert(n,["n","e"]))}function pkcs1ToJwk(n){const r=forge$n.asn1.fromDer(toString$2(n,"ascii")),_=forge$n.pki.privateKeyFromAsn1(r);return{kty:"RSA",n:bigIntegerToUintBase64url(_.n),e:bigIntegerToUintBase64url(_.e),d:bigIntegerToUintBase64url(_.d),p:bigIntegerToUintBase64url(_.p),q:bigIntegerToUintBase64url(_.q),dp:bigIntegerToUintBase64url(_.dP),dq:bigIntegerToUintBase64url(_.dQ),qi:bigIntegerToUintBase64url(_.qInv),alg:"RS256"}}function jwkToPkcs1(n){if(n.n==null||n.e==null||n.d==null||n.p==null||n.q==null||n.dp==null||n.dq==null||n.qi==null)throw new CodeError("JWK was missing components","ERR_INVALID_PARAMETERS");const r=forge$n.pki.privateKeyToAsn1({n:base64urlToBigInteger(n.n),e:base64urlToBigInteger(n.e),d:base64urlToBigInteger(n.d),p:base64urlToBigInteger(n.p),q:base64urlToBigInteger(n.q),dP:base64urlToBigInteger(n.dp),dQ:base64urlToBigInteger(n.dq),qInv:base64urlToBigInteger(n.qi)});return fromString$2(forge$n.asn1.toDer(r).getBytes(),"ascii")}function pkixToJwk(n){const r=forge$n.asn1.fromDer(toString$2(n,"ascii")),_=forge$n.pki.publicKeyFromAsn1(r);return{kty:"RSA",n:bigIntegerToUintBase64url(_.n),e:bigIntegerToUintBase64url(_.e)}}function jwkToPkix(n){if(n.n==null||n.e==null)throw new CodeError("JWK was missing components","ERR_INVALID_PARAMETERS");const r=forge$n.pki.publicKeyToAsn1({n:base64urlToBigInteger(n.n),e:base64urlToBigInteger(n.e)});return fromString$2(forge$n.asn1.toDer(r).getBytes(),"ascii")}async function generateKey$1(n){const r=await webcrypto.get().subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:n,publicExponent:new Uint8Array([1,0,1]),hash:{name:"SHA-256"}},!0,["sign","verify"]),_=await exportKey(r);return{privateKey:_[0],publicKey:_[1]}}async function unmarshalPrivateKey(n){const _=[await webcrypto.get().subtle.importKey("jwk",n,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!0,["sign"]),await derivePublicFromPrivate(n)],E=await exportKey({privateKey:_[0],publicKey:_[1]});return{privateKey:E[0],publicKey:E[1]}}async function hashAndSign$1(n,r){const _=await webcrypto.get().subtle.importKey("jwk",n,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!1,["sign"]),E=await webcrypto.get().subtle.sign({name:"RSASSA-PKCS1-v1_5"},_,Uint8Array.from(r));return new Uint8Array(E,0,E.byteLength)}async function hashAndVerify$1(n,r,_){const E=await webcrypto.get().subtle.importKey("jwk",n,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!1,["verify"]);return webcrypto.get().subtle.verify({name:"RSASSA-PKCS1-v1_5"},E,r,_)}async function exportKey(n){if(n.privateKey==null||n.publicKey==null)throw new CodeError("Private and public key are required","ERR_INVALID_PARAMETERS");return Promise.all([webcrypto.get().subtle.exportKey("jwk",n.privateKey),webcrypto.get().subtle.exportKey("jwk",n.publicKey)])}async function derivePublicFromPrivate(n){return webcrypto.get().subtle.importKey("jwk",{kty:n.kty,n:n.n,e:n.e},{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!0,["verify"])}function convertKey(n,r,_,E){const S=r?jwk2pub(n):jwk2priv(n),C=toString$2(Uint8Array.from(_),"ascii"),A=E(C,S);return fromString$2(A,"ascii")}function encrypt(n,r){return convertKey(n,!0,r,(_,E)=>E.encrypt(_))}function decrypt(n,r){return convertKey(n,!1,r,(_,E)=>E.decrypt(_))}function keySize(n){if(n.kty!=="RSA")throw new CodeError("invalid key type","ERR_INVALID_KEY_TYPE");if(n.n==null)throw new CodeError("invalid key modulus","ERR_INVALID_KEY_MODULUS");return fromString$2(n.n,"base64url").length*8}const MAX_KEY_SIZE=8192;class RsaPublicKey{_key;constructor(r){this._key=r}async verify(r,_){return hashAndVerify$1(this._key,_,r)}marshal(){return jwkToPkix(this._key)}get bytes(){return PublicKey.encode({Type:KeyType.RSA,Data:this.marshal()}).subarray()}encrypt(r){return encrypt(this._key,r)}equals(r){return equals(this.bytes,r.bytes)}async hash(){const{bytes:r}=await sha256$7.digest(this.bytes);return r}}class RsaPrivateKey{_key;_publicKey;constructor(r,_){this._key=r,this._publicKey=_}genSecret(){return randomBytes(16)}async sign(r){return hashAndSign$1(this._key,r)}get public(){if(this._publicKey==null)throw new CodeError("public key not provided","ERR_PUBKEY_NOT_PROVIDED");return new RsaPublicKey(this._publicKey)}decrypt(r){return decrypt(this._key,r)}marshal(){return jwkToPkcs1(this._key)}get bytes(){return PrivateKey.encode({Type:KeyType.RSA,Data:this.marshal()}).subarray()}equals(r){return equals(this.bytes,r.bytes)}async hash(){const{bytes:r}=await sha256$7.digest(this.bytes);return r}async id(){const r=await this.public.hash();return toString$2(r,"base58btc")}async export(r,_="pkcs-8"){if(_==="pkcs-8"){const E=new forge$n.util.ByteBuffer(this.marshal()),S=forge$n.asn1.fromDer(E),C=forge$n.pki.privateKeyFromAsn1(S),A={algorithm:"aes256",count:1e4,saltSize:128/8,prfAlgorithm:"sha512"};return forge$n.pki.encryptRsaPrivateKey(C,r,A)}else{if(_==="libp2p-key")return exporter(this.bytes,r);throw new CodeError(`export format '${_}' is not supported`,"ERR_INVALID_EXPORT_FORMAT")}}}async function unmarshalRsaPrivateKey(n){const r=pkcs1ToJwk(n);if(keySize(r)>MAX_KEY_SIZE)throw new CodeError("key size is too large","ERR_KEY_SIZE_TOO_LARGE");const _=await unmarshalPrivateKey(r);return new RsaPrivateKey(_.privateKey,_.publicKey)}function unmarshalRsaPublicKey(n){const r=pkixToJwk(n);if(keySize(r)>MAX_KEY_SIZE)throw new CodeError("key size is too large","ERR_KEY_SIZE_TOO_LARGE");return new RsaPublicKey(r)}async function fromJwk(n){if(keySize(n)>MAX_KEY_SIZE)throw new CodeError("key size is too large","ERR_KEY_SIZE_TOO_LARGE");const r=await unmarshalPrivateKey(n);return new RsaPrivateKey(r.privateKey,r.publicKey)}async function generateKeyPair$1(n){if(n>MAX_KEY_SIZE)throw new CodeError("key size is too large","ERR_KEY_SIZE_TOO_LARGE");const r=await generateKey$1(n);return new RsaPrivateKey(r.privateKey,r.publicKey)}const RSA=Object.freeze(Object.defineProperty({__proto__:null,MAX_KEY_SIZE,RsaPrivateKey,RsaPublicKey,fromJwk,generateKeyPair:generateKeyPair$1,unmarshalRsaPrivateKey,unmarshalRsaPublicKey},Symbol.toStringTag,{value:"Module"}));function generateKey(){return secp256k1.utils.randomPrivateKey()}async function hashAndSign(n,r){const{digest:_}=await sha256$7.digest(r);try{return secp256k1.sign(_,n).toDERRawBytes()}catch(E){throw new CodeError(String(E),"ERR_INVALID_INPUT")}}async function hashAndVerify(n,r,_){try{const{digest:E}=await sha256$7.digest(_);return secp256k1.verify(r,E,n)}catch(E){throw new CodeError(String(E),"ERR_INVALID_INPUT")}}function compressPublicKey(n){return secp256k1.ProjectivePoint.fromHex(n).toRawBytes(!0)}function validatePrivateKey(n){try{secp256k1.getPublicKey(n,!0)}catch(r){throw new CodeError(String(r),"ERR_INVALID_PRIVATE_KEY")}}function validatePublicKey(n){try{secp256k1.ProjectivePoint.fromHex(n)}catch(r){throw new CodeError(String(r),"ERR_INVALID_PUBLIC_KEY")}}function computePublicKey(n){try{return secp256k1.getPublicKey(n,!0)}catch(r){throw new CodeError(String(r),"ERR_INVALID_PRIVATE_KEY")}}class Secp256k1PublicKey{_key;constructor(r){validatePublicKey(r),this._key=r}async verify(r,_){return hashAndVerify(this._key,_,r)}marshal(){return compressPublicKey(this._key)}get bytes(){return PublicKey.encode({Type:KeyType.Secp256k1,Data:this.marshal()}).subarray()}equals(r){return equals(this.bytes,r.bytes)}async hash(){const{bytes:r}=await sha256$7.digest(this.bytes);return r}}class Secp256k1PrivateKey{_key;_publicKey;constructor(r,_){this._key=r,this._publicKey=_??computePublicKey(r),validatePrivateKey(this._key),validatePublicKey(this._publicKey)}async sign(r){return hashAndSign(this._key,r)}get public(){return new Secp256k1PublicKey(this._publicKey)}marshal(){return this._key}get bytes(){return PrivateKey.encode({Type:KeyType.Secp256k1,Data:this.marshal()}).subarray()}equals(r){return equals(this.bytes,r.bytes)}async hash(){const{bytes:r}=await sha256$7.digest(this.bytes);return r}async id(){const r=await this.public.hash();return toString$2(r,"base58btc")}async export(r,_="libp2p-key"){if(_==="libp2p-key")return exporter(this.bytes,r);throw new CodeError(`export format '${_}' is not supported`,"ERR_INVALID_EXPORT_FORMAT")}}function unmarshalSecp256k1PrivateKey(n){return new Secp256k1PrivateKey(n)}function unmarshalSecp256k1PublicKey(n){return new Secp256k1PublicKey(n)}async function generateKeyPair(){const n=generateKey();return new Secp256k1PrivateKey(n)}const Secp256k1=Object.freeze(Object.defineProperty({__proto__:null,Secp256k1PrivateKey,Secp256k1PublicKey,generateKeyPair,unmarshalSecp256k1PrivateKey,unmarshalSecp256k1PublicKey},Symbol.toStringTag,{value:"Module"})),supportedKeys={rsa:RSA,ed25519:Ed25519,secp256k1:Secp256k1};function unsupportedKey(n){const r=Object.keys(supportedKeys).join(" / ");return new CodeError(`invalid or unsupported key type ${n}. Must be ${r}`,"ERR_UNSUPPORTED_KEY_TYPE")}function unmarshalPublicKey(n){const r=PublicKey.decode(n),_=r.Data??new Uint8Array;switch(r.Type){case KeyType.RSA:return supportedKeys.rsa.unmarshalRsaPublicKey(_);case KeyType.Ed25519:return supportedKeys.ed25519.unmarshalEd25519PublicKey(_);case KeyType.Secp256k1:return supportedKeys.secp256k1.unmarshalSecp256k1PublicKey(_);default:throw unsupportedKey(r.Type??"unknown")}}var timestamp_min={exports:{}};(function(n){(function(){n.exports=Q;var r=86400,_=3200,E=146097*_/400,S=r*E,C=1e3*S,A=864e13,I=4294967296,B=1e6,O="000000000",N=Math.trunc||function(Fe){var ht=Fe-Fe%1;return ht==0&&(Fe<0||Fe===0&&1/Fe!=1/0)?-0:ht},U=Q.prototype,j=(Q.fromDate=function(Fe){return new Q(+Fe)},Q.fromInt64BE=Te(0,1,2,3,0,4),Q.fromInt64LE=Te(3,2,1,0,4,0),Q.fromString=function(Ee){var ht,nt=new Q,Ee=(Ee+="").replace(/^\s*[+\-]?\d+/,function(_e){var _e=+_e,Ie=1970+(_e-1970)%400;return nt.year=_e-Ie,Ie}).replace(/(?:Z|([+\-]\d{2}):?(\d{2}))$/,function(Ce,_e,Ie){return _e<0&&(Ie*=-1),ht=6e4*(60*+_e+ +Ie),""}).replace(/\.\d+$/,function(Ce){return nt.nano=+(Ce+O).substr(1,9),""}).split(/\D+/);if(1<Ee.length?Ee[1]--:Ee[1]=0,nt.time=ht=Date.UTC.apply(Date,Ee)-(ht||0),isNaN(ht))throw new TypeError("Invalid Date");return se(nt)},Q.fromTimeT=function(Fe){return ue(Fe,0)},U.year=0,U.time=0,U.nano=0,U.addNano=function(Fe){return this.nano+=+Fe||0,this},U.getNano=function(){var Fe=se(this);return(Fe.time%1e3*B+ +Fe.nano+1e9)%1e9},U.getTimeT=function(){var ht=se(this),Fe=Math.floor(ht.time/1e3),ht=ht.year;return ht&&(Fe+=ht*E*r/_),Fe},U.getYear=function(){return this.toDate().getUTCFullYear()+this.year},U.toDate=function(){return oe(se(this).time)},U.toJSON=function(){return this.toString().replace(/0{1,6}Z$/,"Z")},U.toString=function(Fe){var ht=this,nt=ht.toDate(),Ee={H:function(){return Re(nt.getUTCHours())},L:function(){return Ne(nt.getUTCMilliseconds(),3)},M:function(){return Re(nt.getUTCMinutes())},N:function(){return Ne(ht.getNano(),9)},S:function(){return Re(nt.getUTCSeconds())},Y:function(){var Ce=ht.getYear();return 999999<Ce?"+"+Ce:9999<Ce?"+"+Ne(Ce,6):0<=Ce?Ne(Ce,4):-999999<=Ce?"-"+Ne(-Ce,6):Ce},a:function(){return Z[nt.getUTCDay()]},b:function(){return z[nt.getUTCMonth()]},d:function(){return Re(nt.getUTCDate())},e:function(){return function(Ce){return(9<Ce?"":" ")+(0|Ce)}(nt.getUTCDate())},m:function(){return Re(nt.getUTCMonth()+1)}};return function Ce(_e){return _e.replace(/%./g,function(Ie){var Be=Ie[1],He=X[Be],Be=Ee[Be];return He?Ce(He):Be?Be():Ie})}(Fe||j)},U.writeInt64BE=we(0,1,2,3,0,4),U.writeInt64LE=we(3,2,1,0,4,0),"%Y-%m-%dT%H:%M:%S.%NZ"),z=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],Z=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],X={"%":"%",F:"%Y-%m-%d",n:`
`,R:"%H:%M",T:"%H:%M:%S",t:"	",X:"%T",Z:"GMT",z:"+0000"};return Q;function Q(Fe,ht,nt){var Ee=this;if(!(Ee instanceof Q))return new Q(Fe,ht,nt);Ee.time=+Fe||0,Ee.nano=+ht||0,Ee.year=+nt||0,se(Ee)}function se(Fe){var ht,nt,Ee,Ce=Fe.year,_e=Fe.time,Ie=Fe.nano,He=((Ie<0||B<=Ie)&&(Ie-=(nt=Math.floor(Ie/B))*B,_e+=nt,nt=1),Ce%_);return(_e<-A||A<_e||He)&&((ht=N(_e/C))&&(Ce+=ht*_,_e-=ht*C),(Ee=oe(_e)).setUTCFullYear(He+Ee.getUTCFullYear()),Ee=(_e=+Ee)+(ht=N((Ce-=He)/_))*C,ht&&-A<=Ee&&Ee<=A&&(Ce-=ht*_,_e=Ee),nt=1),nt&&(Fe.year=Ce,Fe.time=_e,Fe.nano=Ie),Fe}function oe(Fe){var ht=new Date(0);return ht.setTime(Fe),ht}function ue(Ce,Ee){Ce=+Ce||0;var nt=N((Ee=(Ee|0)*I)/S)+N(Ce/S),Ee=Ee%S+Ce%S,Ce=N(Ee/S);return Ce&&(nt+=Ce,Ee-=Ce*S),new Q(1e3*Ee,0,nt*_)}function we(Fe,ht,nt,Ee,Ce,_e){return function(He,Be){var je=se(this);He=He||new Array(8),xe(He,Be|=0);var Ve=Math.floor(je.time/1e3),je=je.year*(E*r/_),Ge=N(je/I)+N(Ve/I),je=je%I+Ve%I,Ve=Math.floor(je/I);return Ve&&(Ge+=Ve,je-=Ve*I),Ie(He,Be+Ce,Ge),Ie(He,Be+_e,je),He};function Ie(He,Be,Ge){He[Be+Fe]=Ge>>24&255,He[Be+ht]=Ge>>16&255,He[Be+nt]=Ge>>8&255,He[Be+Ee]=255&Ge}}function Te(Fe,ht,nt,Ee,Ce,_e){return function(He,Be){xe(He,Be|=0);var Ge=Ie(He,Be+Ce);return ue(Ie(He,Be+_e),Ge)};function Ie(He,Be){return 16777216*He[Be+Fe]+(He[Be+ht]<<16|He[Be+nt]<<8|He[Be+Ee])}}function xe(Fe,ht){if(Fe=Fe&&Fe.length,Fe==null)throw new TypeError("Invalid Buffer");if(Fe<ht+8)throw new RangeError("Out of range")}function Re(Fe){return(9<Fe?"":"0")+(0|Fe)}function Ne(Fe,ht){return(O+(0|Fe)).substr(-ht)}})()})(timestamp_min);var timestamp_minExports=timestamp_min.exports;const NanoDate=getDefaultExportFromCjs(timestamp_minExports),ERR_IPNS_EXPIRED_RECORD$1="ERR_IPNS_EXPIRED_RECORD",ERR_UNRECOGNIZED_VALIDITY$1="ERR_UNRECOGNIZED_VALIDITY",ERR_SIGNATURE_VERIFICATION$1="ERR_SIGNATURE_VERIFICATION",ERR_UNRECOGNIZED_FORMAT$1="ERR_UNRECOGNIZED_FORMAT",ERR_UNDEFINED_PARAMETER$1="ERR_UNDEFINED_PARAMETER",ERR_INVALID_RECORD_DATA$1="ERR_INVALID_RECORD_DATA",ERR_INVALID_VALUE$1="ERR_INVALID_VALUE",ERR_INVALID_EMBEDDED_KEY$1="ERR_INVALID_EMBEDDED_KEY",ERR_RECORD_TOO_LARGE$1="ERR_RECORD_TOO_LARGE";var IpnsEntry$1;(function(n){(function(E){E.EOL="EOL"})(n.ValidityType||(n.ValidityType={}));let r;(function(E){E[E.EOL=0]="EOL"})(r||(r={})),function(E){E.codec=()=>enumeration(r)}(n.ValidityType||(n.ValidityType={}));let _;n.codec=()=>(_==null&&(_=message((E,S,C={})=>{C.lengthDelimited!==!1&&S.fork(),E.value!=null&&(S.uint32(10),S.bytes(E.value)),E.signatureV1!=null&&(S.uint32(18),S.bytes(E.signatureV1)),E.validityType!=null&&(S.uint32(24),n.ValidityType.codec().encode(E.validityType,S)),E.validity!=null&&(S.uint32(34),S.bytes(E.validity)),E.sequence!=null&&(S.uint32(40),S.uint64(E.sequence)),E.ttl!=null&&(S.uint32(48),S.uint64(E.ttl)),E.pubKey!=null&&(S.uint32(58),S.bytes(E.pubKey)),E.signatureV2!=null&&(S.uint32(66),S.bytes(E.signatureV2)),E.data!=null&&(S.uint32(74),S.bytes(E.data)),C.lengthDelimited!==!1&&S.ldelim()},(E,S)=>{const C={},A=S==null?E.len:E.pos+S;for(;E.pos<A;){const I=E.uint32();switch(I>>>3){case 1:C.value=E.bytes();break;case 2:C.signatureV1=E.bytes();break;case 3:C.validityType=n.ValidityType.codec().decode(E);break;case 4:C.validity=E.bytes();break;case 5:C.sequence=E.uint64();break;case 6:C.ttl=E.uint64();break;case 7:C.pubKey=E.bytes();break;case 8:C.signatureV2=E.bytes();break;case 9:C.data=E.bytes();break;default:E.skipType(I&7);break}}return C})),_),n.encode=E=>encodeMessage(E,n.codec()),n.decode=E=>decodeMessage$1(E,n.codec())})(IpnsEntry$1||(IpnsEntry$1={}));const log$4=logger("ipns:utils"),IPNS_PREFIX$2=fromString$3("/ipns/"),LIBP2P_CID_CODEC$1=114;function parseRFC3339$2(n){const r=new RegExp("(\\d{4})-(\\d{2})-(\\d{2})T(\\d{2}):(\\d{2}):(\\d{2})\\.(\\d+)Z"),_=String(n).trim().match(r);if(_==null)throw new Error("Invalid format");const E=parseInt(_[1],10),S=parseInt(_[2],10)-1,C=parseInt(_[3],10),A=parseInt(_[4],10),I=parseInt(_[5],10),B=parseInt(_[6],10),O=parseInt(_[7].padEnd(6,"0").slice(0,3),10);return new Date(Date.UTC(E,S,C,A,I,B,O))}const extractPublicKey$1=async(n,r)=>{if(r==null||n==null){const E=new Error("one or more of the provided parameters are not defined");throw log$4.error(E),errCode$1(E,ERR_UNDEFINED_PARAMETER$1)}let _;if(r.pubKey!=null){try{_=unmarshalPublicKey(r.pubKey)}catch(S){throw log$4.error(S),S}if(!(await peerIdFromKeys(r.pubKey)).equals(n))throw errCode$1(new Error("Embedded public key did not match PeerID"),ERR_INVALID_EMBEDDED_KEY$1)}else n.publicKey!=null&&(_=unmarshalPublicKey(n.publicKey));if(_!=null)return _;throw errCode$1(new Error("no public key is available"),ERR_UNDEFINED_PARAMETER$1)},ipnsRecordDataForV2Sig$1=n=>{const r=fromString$3("ipns-signature:");return concat$4([r,n])},marshal=n=>"signatureV1"in n?IpnsEntry$1.encode({value:fromString$3(n.value),signatureV1:n.signatureV1,validityType:n.validityType,validity:fromString$3(n.validity.toString()),sequence:n.sequence,ttl:n.ttl,pubKey:n.pubKey,signatureV2:n.signatureV2,data:n.data}):IpnsEntry$1.encode({pubKey:n.pubKey,signatureV2:n.signatureV2,data:n.data});function unmarshal$1(n){const r=IpnsEntry$1.decode(n);if(r.sequence!=null&&(r.sequence=BigInt(r.sequence)),r.ttl!=null&&(r.ttl=BigInt(r.ttl)),r.signatureV2==null||r.data==null)throw errCode$1(new Error("missing data or signatureV2"),ERR_SIGNATURE_VERIFICATION$1);const _=parseCborData$1(r.data),E=normalizeValue$1(_.Value);let S;try{S=NanoDate.fromDate(parseRFC3339$2(toString$4(_.Validity)))}catch{throw log$4.error("unrecognized validity format (not an rfc3339 format)"),errCode$1(new Error("unrecognized validity format (not an rfc3339 format)"),ERR_UNRECOGNIZED_FORMAT$1)}if(r.value!=null&&r.signatureV1!=null)return validateCborDataMatchesPbData$1(r),{value:E,validityType:IpnsEntry$1.ValidityType.EOL,validity:S,sequence:_.Sequence,ttl:_.TTL,pubKey:r.pubKey,signatureV1:r.signatureV1,signatureV2:r.signatureV2,data:r.data};if(r.signatureV2!=null)return{value:E,validityType:IpnsEntry$1.ValidityType.EOL,validity:S,sequence:_.Sequence,ttl:_.TTL,pubKey:r.pubKey,signatureV2:r.signatureV2,data:r.data};throw new Error("invalid record: does not include signatureV1 or signatureV2")}const peerIdToRoutingKey=n=>concat$4([IPNS_PREFIX$2,n.toBytes()]),peerIdFromRoutingKey$2=n=>peerIdFromBytes(n.slice(IPNS_PREFIX$2.length)),parseCborData$1=n=>{const r=decode$l(n);if(r.ValidityType===0)r.ValidityType=IpnsEntry$1.ValidityType.EOL;else throw errCode$1(new Error("Unknown validity type"),ERR_UNRECOGNIZED_VALIDITY$1);return Number.isInteger(r.Sequence)&&(r.Sequence=BigInt(r.Sequence)),Number.isInteger(r.TTL)&&(r.TTL=BigInt(r.TTL)),r},normalizeValue$1=n=>{if(n!=null){if(isPeerId(n))return`/ipns/${n.toCID().toString(base36$2)}`;if(n instanceof Uint8Array){const E=toString$4(n);E.startsWith("/")&&(n=E)}const r=n.toString().trim();if(r.startsWith("/")&&r.length>1)return r;const _=CID$1.asCID(n);if(_!=null)return _.code===LIBP2P_CID_CODEC$1?`/ipns/${_.toString(base36$2)}`:`/ipfs/${_.toV1().toString()}`;try{return n instanceof Uint8Array?`/ipfs/${CID$1.decode(n).toV1().toString()}`:`/ipfs/${CID$1.parse(r).toV1().toString()}`}catch{}}throw errCode$1(new Error("Value must be a valid content path starting with /"),ERR_INVALID_VALUE$1)},validateCborDataMatchesPbData$1=n=>{if(n.data==null)throw errCode$1(new Error("Record data is missing"),ERR_INVALID_RECORD_DATA$1);const r=parseCborData$1(n.data);if(!equals$1(r.Value,n.value??new Uint8Array(0)))throw errCode$1(new Error('Field "value" did not match between protobuf and CBOR'),ERR_SIGNATURE_VERIFICATION$1);if(!equals$1(r.Validity,n.validity??new Uint8Array(0)))throw errCode$1(new Error('Field "validity" did not match between protobuf and CBOR'),ERR_SIGNATURE_VERIFICATION$1);if(r.ValidityType!==n.validityType)throw errCode$1(new Error('Field "validityType" did not match between protobuf and CBOR'),ERR_SIGNATURE_VERIFICATION$1);if(r.Sequence!==n.sequence)throw errCode$1(new Error('Field "sequence" did not match between protobuf and CBOR'),ERR_SIGNATURE_VERIFICATION$1);if(r.TTL!==n.ttl)throw errCode$1(new Error('Field "ttl" did not match between protobuf and CBOR'),ERR_SIGNATURE_VERIFICATION$1)};logger("ipns");const log$3=logger("ipns:validator"),MAX_RECORD_SIZE$1=1024*10,validate$2=async(n,r)=>{const _=unmarshal$1(r);let E;try{const S=ipnsRecordDataForV2Sig$1(_.data);E=await n.verify(S,_.signatureV2)}catch{E=!1}if(!E)throw log$3.error("record signature verification failed"),errCode$1(new Error("record signature verification failed"),ERR_SIGNATURE_VERIFICATION$1);if(_.validityType===IpnsEntry$1.ValidityType.EOL){if(_.validity.toDate().getTime()<Date.now())throw log$3.error("record has expired"),errCode$1(new Error("record has expired"),ERR_IPNS_EXPIRED_RECORD$1)}else if(_.validityType!=null)throw log$3.error("unrecognized validity type"),errCode$1(new Error("unrecognized validity type"),ERR_UNRECOGNIZED_VALIDITY$1);log$3("ipns record for %b is valid",_.value)};async function ipnsValidator$1(n,r){if(r.byteLength>MAX_RECORD_SIZE$1)throw errCode$1(new Error("record too large"),ERR_RECORD_TOO_LARGE$1);const _=peerIdFromRoutingKey$2(n),E=unmarshal$1(r),S=await extractPublicKey$1(_,E);await validate$2(S,r)}async function*parse(n){const r=/\r?\n/,_=new TextDecoder("utf8");let E="";for await(let S of n){typeof S=="string"&&(S=new TextEncoder().encode(S)),E+=_.decode(S,{stream:!0});const C=E.split(r);E=C.pop()??"";for(let A=0;A<C.length;A++)yield JSON.parse(C[A])}E+=_.decode(),E!==""&&(yield JSON.parse(E))}class TimeoutError extends Error{constructor(r){super(r),this.name="TimeoutError"}}let AbortError$1=class extends Error{constructor(r){super(),this.name="AbortError",this.message=r}};const getDOMException=n=>globalThis.DOMException===void 0?new AbortError$1(n):new DOMException(n),getAbortedReason=n=>{const r=n.reason===void 0?getDOMException("This operation was aborted."):n.reason;return r instanceof Error?r:getDOMException(r)};function pTimeout(n,r,_,E){let S;const C=new Promise((A,I)=>{if(typeof r!="number"||Math.sign(r)!==1)throw new TypeError(`Expected \`milliseconds\` to be a positive number, got \`${r}\``);if(r===Number.POSITIVE_INFINITY){A(n);return}if(E={customTimers:{setTimeout,clearTimeout},...E},E.signal){const{signal:B}=E;B.aborted&&I(getAbortedReason(B)),B.addEventListener("abort",()=>{I(getAbortedReason(B))})}S=E.customTimers.setTimeout.call(void 0,()=>{if(typeof _=="function"){try{A(_())}catch(N){I(N)}return}const B=typeof _=="string"?_:`Promise timed out after ${r} milliseconds`,O=_ instanceof Error?_:new TimeoutError(B);typeof n.cancel=="function"&&n.cancel(),I(O)},r),(async()=>{try{A(await n)}catch(B){I(B)}finally{E.customTimers.clearTimeout.call(void 0,S)}})()});return C.clear=()=>{clearTimeout(S),S=void 0},C}function lowerBound(n,r,_){let E=0,S=n.length;for(;S>0;){const C=Math.trunc(S/2);let A=E+C;_(n[A],r)<=0?(E=++A,S-=C+1):S=C}return E}var __classPrivateFieldGet$1=function(n,r,_,E){if(_==="a"&&!E)throw new TypeError("Private accessor was defined without a getter");if(typeof r=="function"?n!==r||!E:!r.has(n))throw new TypeError("Cannot read private member from an object whose class did not declare it");return _==="m"?E:_==="a"?E.call(n):E?E.value:r.get(n)},_PriorityQueue_queue;class PriorityQueue{constructor(){_PriorityQueue_queue.set(this,[])}enqueue(r,_){_={priority:0,..._};const E={priority:_.priority,run:r};if(this.size&&__classPrivateFieldGet$1(this,_PriorityQueue_queue,"f")[this.size-1].priority>=_.priority){__classPrivateFieldGet$1(this,_PriorityQueue_queue,"f").push(E);return}const S=lowerBound(__classPrivateFieldGet$1(this,_PriorityQueue_queue,"f"),E,(C,A)=>A.priority-C.priority);__classPrivateFieldGet$1(this,_PriorityQueue_queue,"f").splice(S,0,E)}dequeue(){const r=__classPrivateFieldGet$1(this,_PriorityQueue_queue,"f").shift();return r?.run}filter(r){return __classPrivateFieldGet$1(this,_PriorityQueue_queue,"f").filter(_=>_.priority===r.priority).map(_=>_.run)}get size(){return __classPrivateFieldGet$1(this,_PriorityQueue_queue,"f").length}}_PriorityQueue_queue=new WeakMap;var __classPrivateFieldSet=function(n,r,_,E,S){if(E==="m")throw new TypeError("Private method is not writable");if(E==="a"&&!S)throw new TypeError("Private accessor was defined without a setter");if(typeof r=="function"?n!==r||!S:!r.has(n))throw new TypeError("Cannot write private member to an object whose class did not declare it");return E==="a"?S.call(n,_):S?S.value=_:r.set(n,_),_},__classPrivateFieldGet=function(n,r,_,E){if(_==="a"&&!E)throw new TypeError("Private accessor was defined without a getter");if(typeof r=="function"?n!==r||!E:!r.has(n))throw new TypeError("Cannot read private member from an object whose class did not declare it");return _==="m"?E:_==="a"?E.call(n):E?E.value:r.get(n)},_PQueue_instances,_PQueue_carryoverConcurrencyCount,_PQueue_isIntervalIgnored,_PQueue_intervalCount,_PQueue_intervalCap,_PQueue_interval,_PQueue_intervalEnd,_PQueue_intervalId,_PQueue_timeoutId,_PQueue_queue,_PQueue_queueClass,_PQueue_pending,_PQueue_concurrency,_PQueue_isPaused,_PQueue_throwOnTimeout,_PQueue_doesIntervalAllowAnother_get,_PQueue_doesConcurrentAllowAnother_get,_PQueue_next,_PQueue_onResumeInterval,_PQueue_isIntervalPaused_get,_PQueue_tryToStartAnother,_PQueue_initializeIntervalIfNeeded,_PQueue_onInterval,_PQueue_processQueue,_PQueue_throwOnAbort,_PQueue_onEvent;class AbortError extends Error{}class PQueue extends EventEmitter$1{constructor(r){var _,E,S,C;if(super(),_PQueue_instances.add(this),_PQueue_carryoverConcurrencyCount.set(this,void 0),_PQueue_isIntervalIgnored.set(this,void 0),_PQueue_intervalCount.set(this,0),_PQueue_intervalCap.set(this,void 0),_PQueue_interval.set(this,void 0),_PQueue_intervalEnd.set(this,0),_PQueue_intervalId.set(this,void 0),_PQueue_timeoutId.set(this,void 0),_PQueue_queue.set(this,void 0),_PQueue_queueClass.set(this,void 0),_PQueue_pending.set(this,0),_PQueue_concurrency.set(this,void 0),_PQueue_isPaused.set(this,void 0),_PQueue_throwOnTimeout.set(this,void 0),Object.defineProperty(this,"timeout",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),r={carryoverConcurrencyCount:!1,intervalCap:Number.POSITIVE_INFINITY,interval:0,concurrency:Number.POSITIVE_INFINITY,autoStart:!0,queueClass:PriorityQueue,...r},!(typeof r.intervalCap=="number"&&r.intervalCap>=1))throw new TypeError(`Expected \`intervalCap\` to be a number from 1 and up, got \`${(E=(_=r.intervalCap)===null||_===void 0?void 0:_.toString())!==null&&E!==void 0?E:""}\` (${typeof r.intervalCap})`);if(r.interval===void 0||!(Number.isFinite(r.interval)&&r.interval>=0))throw new TypeError(`Expected \`interval\` to be a finite number >= 0, got \`${(C=(S=r.interval)===null||S===void 0?void 0:S.toString())!==null&&C!==void 0?C:""}\` (${typeof r.interval})`);__classPrivateFieldSet(this,_PQueue_carryoverConcurrencyCount,r.carryoverConcurrencyCount,"f"),__classPrivateFieldSet(this,_PQueue_isIntervalIgnored,r.intervalCap===Number.POSITIVE_INFINITY||r.interval===0,"f"),__classPrivateFieldSet(this,_PQueue_intervalCap,r.intervalCap,"f"),__classPrivateFieldSet(this,_PQueue_interval,r.interval,"f"),__classPrivateFieldSet(this,_PQueue_queue,new r.queueClass,"f"),__classPrivateFieldSet(this,_PQueue_queueClass,r.queueClass,"f"),this.concurrency=r.concurrency,this.timeout=r.timeout,__classPrivateFieldSet(this,_PQueue_throwOnTimeout,r.throwOnTimeout===!0,"f"),__classPrivateFieldSet(this,_PQueue_isPaused,r.autoStart===!1,"f")}get concurrency(){return __classPrivateFieldGet(this,_PQueue_concurrency,"f")}set concurrency(r){if(!(typeof r=="number"&&r>=1))throw new TypeError(`Expected \`concurrency\` to be a number from 1 and up, got \`${r}\` (${typeof r})`);__classPrivateFieldSet(this,_PQueue_concurrency,r,"f"),__classPrivateFieldGet(this,_PQueue_instances,"m",_PQueue_processQueue).call(this)}async add(r,_={}){return _={timeout:this.timeout,throwOnTimeout:__classPrivateFieldGet(this,_PQueue_throwOnTimeout,"f"),..._},new Promise((E,S)=>{__classPrivateFieldGet(this,_PQueue_queue,"f").enqueue(async()=>{var C,A,I;__classPrivateFieldSet(this,_PQueue_pending,(A=__classPrivateFieldGet(this,_PQueue_pending,"f"),A++,A),"f"),__classPrivateFieldSet(this,_PQueue_intervalCount,(I=__classPrivateFieldGet(this,_PQueue_intervalCount,"f"),I++,I),"f");try{if(!((C=_.signal)===null||C===void 0)&&C.aborted)throw new AbortError("The task was aborted.");let B=r({signal:_.signal});_.timeout&&(B=pTimeout(Promise.resolve(B),_.timeout)),_.signal&&(B=Promise.race([B,__classPrivateFieldGet(this,_PQueue_instances,"m",_PQueue_throwOnAbort).call(this,_.signal)]));const O=await B;E(O),this.emit("completed",O)}catch(B){if(B instanceof TimeoutError&&!_.throwOnTimeout){E();return}S(B),this.emit("error",B)}finally{__classPrivateFieldGet(this,_PQueue_instances,"m",_PQueue_next).call(this)}},_),this.emit("add"),__classPrivateFieldGet(this,_PQueue_instances,"m",_PQueue_tryToStartAnother).call(this)})}async addAll(r,_){return Promise.all(r.map(async E=>this.add(E,_)))}start(){return __classPrivateFieldGet(this,_PQueue_isPaused,"f")?(__classPrivateFieldSet(this,_PQueue_isPaused,!1,"f"),__classPrivateFieldGet(this,_PQueue_instances,"m",_PQueue_processQueue).call(this),this):this}pause(){__classPrivateFieldSet(this,_PQueue_isPaused,!0,"f")}clear(){__classPrivateFieldSet(this,_PQueue_queue,new(__classPrivateFieldGet(this,_PQueue_queueClass,"f")),"f")}async onEmpty(){__classPrivateFieldGet(this,_PQueue_queue,"f").size!==0&&await __classPrivateFieldGet(this,_PQueue_instances,"m",_PQueue_onEvent).call(this,"empty")}async onSizeLessThan(r){__classPrivateFieldGet(this,_PQueue_queue,"f").size<r||await __classPrivateFieldGet(this,_PQueue_instances,"m",_PQueue_onEvent).call(this,"next",()=>__classPrivateFieldGet(this,_PQueue_queue,"f").size<r)}async onIdle(){__classPrivateFieldGet(this,_PQueue_pending,"f")===0&&__classPrivateFieldGet(this,_PQueue_queue,"f").size===0||await __classPrivateFieldGet(this,_PQueue_instances,"m",_PQueue_onEvent).call(this,"idle")}get size(){return __classPrivateFieldGet(this,_PQueue_queue,"f").size}sizeBy(r){return __classPrivateFieldGet(this,_PQueue_queue,"f").filter(r).length}get pending(){return __classPrivateFieldGet(this,_PQueue_pending,"f")}get isPaused(){return __classPrivateFieldGet(this,_PQueue_isPaused,"f")}}_PQueue_carryoverConcurrencyCount=new WeakMap,_PQueue_isIntervalIgnored=new WeakMap,_PQueue_intervalCount=new WeakMap,_PQueue_intervalCap=new WeakMap,_PQueue_interval=new WeakMap,_PQueue_intervalEnd=new WeakMap,_PQueue_intervalId=new WeakMap,_PQueue_timeoutId=new WeakMap,_PQueue_queue=new WeakMap,_PQueue_queueClass=new WeakMap,_PQueue_pending=new WeakMap,_PQueue_concurrency=new WeakMap,_PQueue_isPaused=new WeakMap,_PQueue_throwOnTimeout=new WeakMap,_PQueue_instances=new WeakSet,_PQueue_doesIntervalAllowAnother_get=function n(){return __classPrivateFieldGet(this,_PQueue_isIntervalIgnored,"f")||__classPrivateFieldGet(this,_PQueue_intervalCount,"f")<__classPrivateFieldGet(this,_PQueue_intervalCap,"f")},_PQueue_doesConcurrentAllowAnother_get=function n(){return __classPrivateFieldGet(this,_PQueue_pending,"f")<__classPrivateFieldGet(this,_PQueue_concurrency,"f")},_PQueue_next=function n(){var r;__classPrivateFieldSet(this,_PQueue_pending,(r=__classPrivateFieldGet(this,_PQueue_pending,"f"),r--,r),"f"),__classPrivateFieldGet(this,_PQueue_instances,"m",_PQueue_tryToStartAnother).call(this),this.emit("next")},_PQueue_onResumeInterval=function n(){__classPrivateFieldGet(this,_PQueue_instances,"m",_PQueue_onInterval).call(this),__classPrivateFieldGet(this,_PQueue_instances,"m",_PQueue_initializeIntervalIfNeeded).call(this),__classPrivateFieldSet(this,_PQueue_timeoutId,void 0,"f")},_PQueue_isIntervalPaused_get=function n(){const r=Date.now();if(__classPrivateFieldGet(this,_PQueue_intervalId,"f")===void 0){const _=__classPrivateFieldGet(this,_PQueue_intervalEnd,"f")-r;if(_<0)__classPrivateFieldSet(this,_PQueue_intervalCount,__classPrivateFieldGet(this,_PQueue_carryoverConcurrencyCount,"f")?__classPrivateFieldGet(this,_PQueue_pending,"f"):0,"f");else return __classPrivateFieldGet(this,_PQueue_timeoutId,"f")===void 0&&__classPrivateFieldSet(this,_PQueue_timeoutId,setTimeout(()=>{__classPrivateFieldGet(this,_PQueue_instances,"m",_PQueue_onResumeInterval).call(this)},_),"f"),!0}return!1},_PQueue_tryToStartAnother=function n(){if(__classPrivateFieldGet(this,_PQueue_queue,"f").size===0)return __classPrivateFieldGet(this,_PQueue_intervalId,"f")&&clearInterval(__classPrivateFieldGet(this,_PQueue_intervalId,"f")),__classPrivateFieldSet(this,_PQueue_intervalId,void 0,"f"),this.emit("empty"),__classPrivateFieldGet(this,_PQueue_pending,"f")===0&&this.emit("idle"),!1;if(!__classPrivateFieldGet(this,_PQueue_isPaused,"f")){const r=!__classPrivateFieldGet(this,_PQueue_instances,"a",_PQueue_isIntervalPaused_get);if(__classPrivateFieldGet(this,_PQueue_instances,"a",_PQueue_doesIntervalAllowAnother_get)&&__classPrivateFieldGet(this,_PQueue_instances,"a",_PQueue_doesConcurrentAllowAnother_get)){const _=__classPrivateFieldGet(this,_PQueue_queue,"f").dequeue();return _?(this.emit("active"),_(),r&&__classPrivateFieldGet(this,_PQueue_instances,"m",_PQueue_initializeIntervalIfNeeded).call(this),!0):!1}}return!1},_PQueue_initializeIntervalIfNeeded=function n(){__classPrivateFieldGet(this,_PQueue_isIntervalIgnored,"f")||__classPrivateFieldGet(this,_PQueue_intervalId,"f")!==void 0||(__classPrivateFieldSet(this,_PQueue_intervalId,setInterval(()=>{__classPrivateFieldGet(this,_PQueue_instances,"m",_PQueue_onInterval).call(this)},__classPrivateFieldGet(this,_PQueue_interval,"f")),"f"),__classPrivateFieldSet(this,_PQueue_intervalEnd,Date.now()+__classPrivateFieldGet(this,_PQueue_interval,"f"),"f"))},_PQueue_onInterval=function n(){__classPrivateFieldGet(this,_PQueue_intervalCount,"f")===0&&__classPrivateFieldGet(this,_PQueue_pending,"f")===0&&__classPrivateFieldGet(this,_PQueue_intervalId,"f")&&(clearInterval(__classPrivateFieldGet(this,_PQueue_intervalId,"f")),__classPrivateFieldSet(this,_PQueue_intervalId,void 0,"f")),__classPrivateFieldSet(this,_PQueue_intervalCount,__classPrivateFieldGet(this,_PQueue_carryoverConcurrencyCount,"f")?__classPrivateFieldGet(this,_PQueue_pending,"f"):0,"f"),__classPrivateFieldGet(this,_PQueue_instances,"m",_PQueue_processQueue).call(this)},_PQueue_processQueue=function n(){for(;__classPrivateFieldGet(this,_PQueue_instances,"m",_PQueue_tryToStartAnother).call(this););},_PQueue_throwOnAbort=async function n(r){return new Promise((_,E)=>{r.addEventListener("abort",()=>{E(new AbortError("The task was aborted."))},{once:!0})})},_PQueue_onEvent=async function n(r,_){return new Promise(E=>{const S=()=>{_&&!_()||(this.off(r,S),E())};this.on(r,S)})};const IPNS_PREFIX$1=fromString$2("/ipns/");function isIPNSKey(n){return equals(n.subarray(0,IPNS_PREFIX$1.byteLength),IPNS_PREFIX$1)}const peerIdFromRoutingKey$1=n=>peerIdFromBytes(n.slice(IPNS_PREFIX$1.length));class DelegatedRoutingV1HttpApiClientContentRouting{client;constructor(r){this.client=r}async*findProviders(r,_={}){yield*map$1(this.client.getProviders(r,_),E=>({id:E.ID,multiaddrs:E.Addrs??[],protocols:[]}))}async provide(){}async put(r,_,E){if(!isIPNSKey(r))return;const S=peerIdFromRoutingKey$1(r),C=unmarshal$1(_);await this.client.putIPNS(S,C,E)}async get(r,_){if(!isIPNSKey(r))throw new CodeError("Not found","ERR_NOT_FOUND");const E=peerIdFromRoutingKey$1(r);try{const S=await this.client.getIPNS(E,_);return marshal(S)}catch(S){throw S.code==="ERR_BAD_RESPONSE"?new CodeError("Not found","ERR_NOT_FOUND"):S}}}class DelegatedRoutingV1HttpApiClientPeerRouting{client;constructor(r){this.client=r}async findPeer(r,_={}){const E=await first(this.client.getPeers(r,_));if(E!=null)return{id:E.ID,multiaddrs:E.Addrs,protocols:[]};throw new CodeError("Not found","ERR_NOT_FOUND")}async*getClosestPeers(r,_={}){}}const log$2=logger("delegated-routing-v1-http-api-client"),defaultValues$2={concurrentRequests:4,timeout:3e4};class DefaultDelegatedRoutingV1HttpApiClient{started;httpQueue;shutDownController;clientUrl;timeout;contentRouting;peerRouting;constructor(r,_={}){this.started=!1,this.shutDownController=new AbortController,setMaxListeners(1/0,this.shutDownController.signal),this.httpQueue=new PQueue({concurrency:_.concurrentRequests??defaultValues$2.concurrentRequests}),this.clientUrl=r instanceof URL?r:new URL(r),this.timeout=_.timeout??defaultValues$2.timeout,this.contentRouting=new DelegatedRoutingV1HttpApiClientContentRouting(this),this.peerRouting=new DelegatedRoutingV1HttpApiClientPeerRouting(this)}get[contentRouting](){return this.contentRouting}get[peerRouting](){return this.peerRouting}isStarted(){return this.started}start(){this.started=!0}stop(){this.httpQueue.clear(),this.shutDownController.abort(),this.started=!1}async*getProviders(r,_={}){log$2("getProviders starts: %c",r);const E=anySignal([this.shutDownController.signal,_.signal,AbortSignal.timeout(this.timeout)]),S=pDefer(),C=pDefer();this.httpQueue.add(async()=>(S.resolve(),C.promise));try{await S.promise;const A=`${this.clientUrl}routing/v1/providers/${r.toString()}`,B=await fetch(A,{headers:{Accept:"application/x-ndjson"},signal:E});if(B.body==null)throw new CodeError("Routing response had no body","ERR_BAD_RESPONSE");if(B.headers.get("Content-Type")==="application/json"){const N=await B.json();for(const U of N.Providers){const j=this.#e(U);j!=null&&(yield j)}}else for await(const N of parse(browserReadableStreamToIt(B.body))){const U=this.#e(N);U!=null&&(yield U)}}catch(A){log$2.error("getProviders errored:",A)}finally{E.clear(),C.resolve(),log$2("getProviders finished: %c",r)}}async*getPeers(r,_={}){log$2("getPeers starts: %c",r);const E=anySignal([this.shutDownController.signal,_.signal,AbortSignal.timeout(this.timeout)]),S=pDefer(),C=pDefer();this.httpQueue.add(async()=>(S.resolve(),C.promise));try{await S.promise;const A=`${this.clientUrl}routing/v1/peers/${r.toCID().toString()}`,B=await fetch(A,{headers:{Accept:"application/x-ndjson"},signal:E});if(B.body==null)throw new CodeError("Routing response had no body","ERR_BAD_RESPONSE");if(B.headers.get("Content-Type")==="application/json"){const N=await B.json();for(const U of N.Peers){const j=this.#t(r,U);j!=null&&(yield j)}}else for await(const N of parse(browserReadableStreamToIt(B.body))){const U=this.#t(r,N);U!=null&&(yield U)}}catch(A){log$2.error("getPeers errored:",A)}finally{E.clear(),C.resolve(),log$2("getPeers finished: %c",r)}}async getIPNS(r,_={}){log$2("getIPNS starts: %c",r);const E=anySignal([this.shutDownController.signal,_.signal,AbortSignal.timeout(this.timeout)]),S=pDefer(),C=pDefer();this.httpQueue.add(async()=>(S.resolve(),C.promise));try{await S.promise;const A=`${this.clientUrl}routing/v1/ipns/${r.toCID().toString()}`,B=await fetch(A,{headers:{Accept:"application/vnd.ipfs.ipns-record"},signal:E});if(B.body==null)throw new CodeError("GET ipns response had no body","ERR_BAD_RESPONSE");const O=new Uint8Array(await B.arrayBuffer());return await ipnsValidator$1(peerIdToRoutingKey(r),O),unmarshal$1(O)}finally{E.clear(),C.resolve(),log$2("getIPNS finished: %c",r)}}async putIPNS(r,_,E={}){log$2("getIPNS starts: %c",r);const S=anySignal([this.shutDownController.signal,E.signal,AbortSignal.timeout(this.timeout)]),C=pDefer(),A=pDefer();this.httpQueue.add(async()=>(C.resolve(),A.promise));try{await C.promise;const I=marshal(_),B=`${this.clientUrl}routing/v1/ipns/${r.toCID().toString()}`;if((await fetch(B,{method:"PUT",headers:{"Content-Type":"application/vnd.ipfs.ipns-record"},body:I,signal:S})).status!==200)throw new CodeError("PUT ipns response had status other than 200","ERR_BAD_RESPONSE")}finally{S.clear(),A.resolve(),log$2("getIPNS finished: %c",r)}}#e(r){if(r.Schema==="peer")return r.ID=peerIdFromString(r.ID),r.Addrs=r.Addrs.map(multiaddr),r.Protocols=r.Protocols??[],r;if(r.Schema==="bitswap")return{Schema:"peer",ID:peerIdFromString(r.ID),Addrs:r.Addrs.map(multiaddr),Protocols:r.Protocol!=null?[r.Protocol]:[]};if(r.ID!=null&&Array.isArray(r.Addrs))return{Schema:"peer",ID:peerIdFromString(r.ID),Addrs:r.Addrs.map(multiaddr),Protocols:Array.isArray(r.Protocols)?r.Protocols:[]}}#t(r,_){if(_.Schema==="peer"&&(_.ID=peerIdFromString(_.ID),_.Addrs=_.Addrs.map(multiaddr),r.equals(_.ID)))return _}}function createDelegatedRoutingV1HttpApiClient(n,r={}){return new DefaultDelegatedRoutingV1HttpApiClient(new URL(n),r)}const createEd25519PeerId=async()=>{const n=await generateKeyPair$3("Ed25519"),r=await createFromPrivKey(n);if(r.type==="Ed25519")return r;throw new Error(`Generated unexpected PeerId type "${r.type}"`)};async function createFromPrivKey(n){return peerIdFromKeys$1(marshalPublicKey(n.public),marshalPrivateKey(n))}var Netmask_1;(function(){var n,r,_,E,S,C,A,I;I=function(B){var O,N,U,j;return O=(B&255<<24)>>>24,N=(B&255<<16)>>>16,U=(B&65280)>>>8,j=B&255,[O,N,U,j].join(".")},A=function(B){var O,N,U,j,z,Z;for(O=[],U=j=0;j<=3&&B.length!==0;U=++j){if(U>0){if(B[0]!==".")throw new Error("Invalid IP");B=B.substring(1)}Z=r(B),z=Z[0],N=Z[1],B=B.substring(N),O.push(z)}if(B.length!==0)throw new Error("Invalid IP");switch(O.length){case 1:if(O[0]>4294967295)throw new Error("Invalid IP");return O[0]>>>0;case 2:if(O[0]>255||O[1]>16777215)throw new Error("Invalid IP");return(O[0]<<24|O[1])>>>0;case 3:if(O[0]>255||O[1]>255||O[2]>65535)throw new Error("Invalid IP");return(O[0]<<24|O[1]<<16|O[2])>>>0;case 4:if(O[0]>255||O[1]>255||O[2]>255||O[3]>255)throw new Error("Invalid IP");return(O[0]<<24|O[1]<<16|O[2]<<8|O[3])>>>0;default:throw new Error("Invalid IP")}},_=function(B){return B.charCodeAt(0)},E=_("0"),C=_("a"),S=_("A"),r=function(B){var O,N,U,j,z;for(j=0,O=10,N="9",U=0,B.length>1&&B[U]==="0"&&(B[U+1]==="x"||B[U+1]==="X"?(U+=2,O=16):"0"<=B[U+1]&&B[U+1]<="9"&&(U++,O=8,N="7")),z=U;U<B.length;){if("0"<=B[U]&&B[U]<=N)j=j*O+(_(B[U])-E)>>>0;else if(O===16)if("a"<=B[U]&&B[U]<="f")j=j*O+(10+_(B[U])-C)>>>0;else if("A"<=B[U]&&B[U]<="F")j=j*O+(10+_(B[U])-S)>>>0;else break;else break;if(j>4294967295)throw new Error("too large");U++}if(U===z)throw new Error("empty octet");return[j,U]},n=function(){function B(O,N){var U,j,z;if(typeof O!="string")throw new Error("Missing `net' parameter");if(N||(z=O.split("/",2),O=z[0],N=z[1]),N||(N=32),typeof N=="string"&&N.indexOf(".")>-1){try{this.maskLong=A(N)}catch{throw new Error("Invalid mask: "+N)}for(U=j=32;j>=0;U=--j)if(this.maskLong===4294967295<<32-U>>>0){this.bitmask=U;break}}else if(N||N===0)this.bitmask=parseInt(N,10),this.maskLong=0,this.bitmask>0&&(this.maskLong=4294967295<<32-this.bitmask>>>0);else throw new Error("Invalid mask: empty");try{this.netLong=(A(O)&this.maskLong)>>>0}catch{throw new Error("Invalid net address: "+O)}if(!(this.bitmask<=32))throw new Error("Invalid mask for ip4: "+N);this.size=Math.pow(2,32-this.bitmask),this.base=I(this.netLong),this.mask=I(this.maskLong),this.hostmask=I(~this.maskLong),this.first=this.bitmask<=30?I(this.netLong+1):this.base,this.last=this.bitmask<=30?I(this.netLong+this.size-2):I(this.netLong+this.size-1),this.broadcast=this.bitmask<=30?I(this.netLong+this.size-1):void 0}return B.prototype.contains=function(O){return typeof O=="string"&&(O.indexOf("/")>0||O.split(".").length!==4)&&(O=new B(O)),O instanceof B?this.contains(O.base)&&this.contains(O.broadcast||O.last):(A(O)&this.maskLong)>>>0===(this.netLong&this.maskLong)>>>0},B.prototype.next=function(O){return O==null&&(O=1),new B(I(this.netLong+this.size*O),this.mask)},B.prototype.forEach=function(O){var N,U,j;for(j=A(this.first),U=A(this.last),N=0;j<=U;)O(I(j),j,N),N++,j++},B.prototype.toString=function(){return this.base+"/"+this.bitmask},B}(),Netmask_1=n}).call(commonjsGlobal);const PRIVATE_IP_RANGES=["0.0.0.0/8","10.0.0.0/8","100.64.0.0/10","127.0.0.0/8","169.254.0.0/16","172.16.0.0/12","192.0.0.0/24","192.0.0.0/29","192.0.0.8/32","192.0.0.9/32","192.0.0.10/32","192.0.0.170/32","192.0.0.171/32","192.0.2.0/24","192.31.196.0/24","192.52.193.0/24","192.88.99.0/24","192.168.0.0/16","192.175.48.0/24","198.18.0.0/15","198.51.100.0/24","203.0.113.0/24","240.0.0.0/4","255.255.255.255/32"],NETMASK_RANGES=PRIVATE_IP_RANGES.map(n=>new Netmask_1(n));function ipv4Check(n){for(const r of NETMASK_RANGES)if(r.contains(n))return!0;return!1}function ipv6Check(n){return/^::$/.test(n)||/^::1$/.test(n)||/^::f{4}:([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})$/.test(n)||/^::f{4}:0.([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})$/.test(n)||/^64:ff9b::([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})$/.test(n)||/^100::([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4})$/.test(n)||/^2001::([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4})$/.test(n)||/^2001:2[0-9a-fA-F]:([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4})$/.test(n)||/^2001:db8:([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4})$/.test(n)||/^2002:([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4}):?([0-9a-fA-F]{0,4})$/.test(n)||/^f[c-d]([0-9a-fA-F]{2,2}):/i.test(n)||/^fe[8-9a-bA-B][0-9a-fA-F]:/i.test(n)||/^ff([0-9a-fA-F]{2,2}):/i.test(n)}function isPrivateIp(n){return isIPv4(n)?ipv4Check(n):isIPv6(n)?ipv6Check(n):void 0}const PROTOCOL_PREFIX$1="libp2p",PROTOCOL_NAME$1="autonat",PROTOCOL_VERSION$1="1.0.0",TIMEOUT$1=3e4,STARTUP_DELAY=5e3,REFRESH_INTERVAL=6e4,MAX_INBOUND_STREAMS$1=1,MAX_OUTBOUND_STREAMS$1=1;var Message$3;(function(n){(function(S){S.DIAL="DIAL",S.DIAL_RESPONSE="DIAL_RESPONSE"})(n.MessageType||(n.MessageType={}));let r;(function(S){S[S.DIAL=0]="DIAL",S[S.DIAL_RESPONSE=1]="DIAL_RESPONSE"})(r||(r={})),function(S){S.codec=()=>enumeration(r)}(n.MessageType||(n.MessageType={})),function(S){S.OK="OK",S.E_DIAL_ERROR="E_DIAL_ERROR",S.E_DIAL_REFUSED="E_DIAL_REFUSED",S.E_BAD_REQUEST="E_BAD_REQUEST",S.E_INTERNAL_ERROR="E_INTERNAL_ERROR"}(n.ResponseStatus||(n.ResponseStatus={}));let _;(function(S){S[S.OK=0]="OK",S[S.E_DIAL_ERROR=100]="E_DIAL_ERROR",S[S.E_DIAL_REFUSED=101]="E_DIAL_REFUSED",S[S.E_BAD_REQUEST=200]="E_BAD_REQUEST",S[S.E_INTERNAL_ERROR=300]="E_INTERNAL_ERROR"})(_||(_={})),function(S){S.codec=()=>enumeration(_)}(n.ResponseStatus||(n.ResponseStatus={})),function(S){let C;S.codec=()=>(C==null&&(C=message((A,I,B={})=>{if(B.lengthDelimited!==!1&&I.fork(),A.id!=null&&(I.uint32(10),I.bytes(A.id)),A.addrs!=null)for(const O of A.addrs)I.uint32(18),I.bytes(O);B.lengthDelimited!==!1&&I.ldelim()},(A,I)=>{const B={addrs:[]},O=I==null?A.len:A.pos+I;for(;A.pos<O;){const N=A.uint32();switch(N>>>3){case 1:B.id=A.bytes();break;case 2:B.addrs.push(A.bytes());break;default:A.skipType(N&7);break}}return B})),C),S.encode=A=>encodeMessage(A,S.codec()),S.decode=A=>decodeMessage$1(A,S.codec())}(n.PeerInfo||(n.PeerInfo={})),function(S){let C;S.codec=()=>(C==null&&(C=message((A,I,B={})=>{B.lengthDelimited!==!1&&I.fork(),A.peer!=null&&(I.uint32(10),n.PeerInfo.codec().encode(A.peer,I)),B.lengthDelimited!==!1&&I.ldelim()},(A,I)=>{const B={},O=I==null?A.len:A.pos+I;for(;A.pos<O;){const N=A.uint32();switch(N>>>3){case 1:B.peer=n.PeerInfo.codec().decode(A,A.uint32());break;default:A.skipType(N&7);break}}return B})),C),S.encode=A=>encodeMessage(A,S.codec()),S.decode=A=>decodeMessage$1(A,S.codec())}(n.Dial||(n.Dial={})),function(S){let C;S.codec=()=>(C==null&&(C=message((A,I,B={})=>{B.lengthDelimited!==!1&&I.fork(),A.status!=null&&(I.uint32(8),n.ResponseStatus.codec().encode(A.status,I)),A.statusText!=null&&(I.uint32(18),I.string(A.statusText)),A.addr!=null&&(I.uint32(26),I.bytes(A.addr)),B.lengthDelimited!==!1&&I.ldelim()},(A,I)=>{const B={},O=I==null?A.len:A.pos+I;for(;A.pos<O;){const N=A.uint32();switch(N>>>3){case 1:B.status=n.ResponseStatus.codec().decode(A);break;case 2:B.statusText=A.string();break;case 3:B.addr=A.bytes();break;default:A.skipType(N&7);break}}return B})),C),S.encode=A=>encodeMessage(A,S.codec()),S.decode=A=>decodeMessage$1(A,S.codec())}(n.DialResponse||(n.DialResponse={}));let E;n.codec=()=>(E==null&&(E=message((S,C,A={})=>{A.lengthDelimited!==!1&&C.fork(),S.type!=null&&(C.uint32(8),n.MessageType.codec().encode(S.type,C)),S.dial!=null&&(C.uint32(18),n.Dial.codec().encode(S.dial,C)),S.dialResponse!=null&&(C.uint32(26),n.DialResponse.codec().encode(S.dialResponse,C)),A.lengthDelimited!==!1&&C.ldelim()},(S,C)=>{const A={},I=C==null?S.len:S.pos+C;for(;S.pos<I;){const B=S.uint32();switch(B>>>3){case 1:A.type=n.MessageType.codec().decode(S);break;case 2:A.dial=n.Dial.codec().decode(S,S.uint32());break;case 3:A.dialResponse=n.DialResponse.codec().decode(S,S.uint32());break;default:S.skipType(B&7);break}}return A})),E),n.encode=S=>encodeMessage(S,n.codec()),n.decode=S=>decodeMessage$1(S,n.codec())})(Message$3||(Message$3={}));const REQUIRED_SUCCESSFUL_DIALS=4;class AutoNATService{components;startupDelay;refreshInterval;protocol;timeout;maxInboundStreams;maxOutboundStreams;verifyAddressTimeout;started;log;constructor(r,_){this.components=r,this.log=r.logger.forComponent("libp2p:autonat"),this.started=!1,this.protocol=`/${_.protocolPrefix??PROTOCOL_PREFIX$1}/${PROTOCOL_NAME$1}/${PROTOCOL_VERSION$1}`,this.timeout=_.timeout??TIMEOUT$1,this.maxInboundStreams=_.maxInboundStreams??MAX_INBOUND_STREAMS$1,this.maxOutboundStreams=_.maxOutboundStreams??MAX_OUTBOUND_STREAMS$1,this.startupDelay=_.startupDelay??STARTUP_DELAY,this.refreshInterval=_.refreshInterval??REFRESH_INTERVAL,this._verifyExternalAddresses=this._verifyExternalAddresses.bind(this)}isStarted(){return this.started}async start(){this.started||(await this.components.registrar.handle(this.protocol,r=>{this.handleIncomingAutonatStream(r).catch(_=>{this.log.error("error handling incoming autonat stream",_)})},{maxInboundStreams:this.maxInboundStreams,maxOutboundStreams:this.maxOutboundStreams}),this.verifyAddressTimeout=setTimeout(this._verifyExternalAddresses,this.startupDelay),this.started=!0)}async stop(){await this.components.registrar.unhandle(this.protocol),clearTimeout(this.verifyAddressTimeout),this.started=!1}async handleIncomingAutonatStream(r){const _=AbortSignal.timeout(this.timeout),E=()=>{r.stream.abort(new CodeError$4("handleIncomingAutonatStream timeout",ERR_TIMEOUT))};_.addEventListener("abort",E,{once:!0}),setMaxListeners$2(1/0,_);const S=this.components.addressManager.getAddresses().map(C=>C.toOptions().host);try{const C=this;await pipe(r.stream,A=>decode$4(A),async function*(A){const I=await first(A);if(I==null){C.log("no message received"),yield Message$3.encode({type:Message$3.MessageType.DIAL_RESPONSE,dialResponse:{status:Message$3.ResponseStatus.E_BAD_REQUEST,statusText:"No message was sent"}});return}let B;try{B=Message$3.decode(I)}catch(X){C.log.error("could not decode message",X),yield Message$3.encode({type:Message$3.MessageType.DIAL_RESPONSE,dialResponse:{status:Message$3.ResponseStatus.E_BAD_REQUEST,statusText:"Could not decode message"}});return}const O=B.dial;if(O==null){C.log.error("dial was missing from message"),yield Message$3.encode({type:Message$3.MessageType.DIAL_RESPONSE,dialResponse:{status:Message$3.ResponseStatus.E_BAD_REQUEST,statusText:"No Dial message found in message"}});return}let N;const U=O.peer;if(U==null||U.id==null){C.log.error("PeerId missing from message"),yield Message$3.encode({type:Message$3.MessageType.DIAL_RESPONSE,dialResponse:{status:Message$3.ResponseStatus.E_BAD_REQUEST,statusText:"missing peer info"}});return}try{N=peerIdFromBytes$1(U.id)}catch(X){C.log.error("invalid PeerId",X),yield Message$3.encode({type:Message$3.MessageType.DIAL_RESPONSE,dialResponse:{status:Message$3.ResponseStatus.E_BAD_REQUEST,statusText:"bad peer id"}});return}if(C.log("incoming request from %p",N),!r.connection.remotePeer.equals(N)){C.log("target peer %p did not equal sending peer %p",N,r.connection.remotePeer),yield Message$3.encode({type:Message$3.MessageType.DIAL_RESPONSE,dialResponse:{status:Message$3.ResponseStatus.E_BAD_REQUEST,statusText:"peer id mismatch"}});return}const j=U.addrs.map(X=>multiaddr(X)).filter(X=>{const Q=X.toOptions().host===r.connection.remoteAddr.toOptions().host;return C.log.trace("request to dial %a was sent from %a is same host %s",X,r.connection.remoteAddr,Q),Q}).filter(X=>{const Q=X.toOptions().host,se=!(isPrivateIp(Q)??!1);return C.log.trace("host %s was public %s",Q,se),se}).filter(X=>{const Q=X.toOptions().host,se=!S.includes(Q);return C.log.trace("host %s was not our host %s",Q,se),se}).filter(X=>{const Q=!!C.components.transportManager.transportForMultiaddr(X);return C.log.trace("transport for %a is supported %s",X,Q),Q}).map(X=>(X.getPeerId()==null&&(X=X.encapsulate(`/p2p/${N.toString()}`)),X));if(j.length===0){C.log("no valid multiaddrs for %p in message",N),yield Message$3.encode({type:Message$3.MessageType.DIAL_RESPONSE,dialResponse:{status:Message$3.ResponseStatus.E_DIAL_REFUSED,statusText:"no dialable addresses"}});return}C.log("dial multiaddrs %s for peer %p",j.map(X=>X.toString()).join(", "),N);let z="",Z=j[0];for await(const X of j){let Q;Z=X;try{if(Q=await C.components.connectionManager.openConnection(X,{signal:_}),!Q.remoteAddr.equals(X))throw C.log.error("tried to dial %a but dialed %a",X,Q.remoteAddr),new Error("Unexpected remote address");C.log("Success %p",N),yield Message$3.encode({type:Message$3.MessageType.DIAL_RESPONSE,dialResponse:{status:Message$3.ResponseStatus.OK,addr:Q.remoteAddr.decapsulateCode(getProtocol("p2p").code).bytes}});return}catch(se){C.log("could not dial %p",N,se),z=se.message}finally{Q!=null&&await Q.close()}}yield Message$3.encode({type:Message$3.MessageType.DIAL_RESPONSE,dialResponse:{status:Message$3.ResponseStatus.E_DIAL_ERROR,statusText:z,addr:Z.bytes}})},A=>encode$6(A),r.stream)}catch(C){this.log.error("error handling incoming autonat stream",C)}finally{_.removeEventListener("abort",E)}}_verifyExternalAddresses(){this.verifyExternalAddresses().catch(r=>{this.log.error("error verifying external address",r)})}async verifyExternalAddresses(){if(clearTimeout(this.verifyAddressTimeout),!this.isStarted())return;const r=this.components.addressManager,_=r.getObservedAddrs().filter(C=>{const A=C.toOptions();return!(isPrivateIp(A.host)??!1)});if(_.length===0){this.log("no public addresses found, not requesting verification"),this.verifyAddressTimeout=setTimeout(this._verifyExternalAddresses,this.refreshInterval);return}const E=AbortSignal.timeout(this.timeout);setMaxListeners$2(1/0,E);const S=this;try{this.log("verify multiaddrs %s",_.map(U=>U.toString()).join(", "));const C=Message$3.encode({type:Message$3.MessageType.DIAL,dial:{peer:{id:this.components.peerId.toBytes(),addrs:_.map(U=>U.bytes)}}}),I=(await createEd25519PeerId()).toBytes(),B={},O=[],N=async U=>{let j=()=>{};try{this.log("asking %p to verify multiaddr",U.id);const z=await S.components.connectionManager.openConnection(U.id,{signal:E}),Z=await z.newStream(this.protocol,{signal:E});j=()=>{Z.abort(new CodeError$4("verifyAddress timeout",ERR_TIMEOUT))},E.addEventListener("abort",j,{once:!0});const X=await pipe([C],se=>encode$6(se),Z,se=>decode$4(se),async se=>first(se));if(X==null){this.log("no response received from %p",z.remotePeer);return}const Q=Message$3.decode(X);if(Q.type!==Message$3.MessageType.DIAL_RESPONSE||Q.dialResponse==null){this.log("invalid autonat response from %p",z.remotePeer);return}if(Q.dialResponse.status===Message$3.ResponseStatus.OK){const se=z.remoteAddr.toOptions();let oe;if(se.family===4)oe=se.host.split(".")[0];else if(se.family===6)oe=se.host.split(":")[0];else{this.log('remote address "%s" was not IP4 or IP6?',se.host);return}if(O.includes(oe)){this.log("already have response from network segment %d - %s",oe,se.host);return}O.push(oe)}return Q.dialResponse}catch(z){this.log.error("error asking remote to verify multiaddr",z)}finally{E.removeEventListener("abort",j)}};for await(const U of parallel(map$1(this.components.peerRouting.getClosestPeers(I,{signal:E}),j=>async()=>N(j)),{concurrency:REQUIRED_SUCCESSFUL_DIALS}))try{if(U==null)continue;const j=U.addr==null?_[0]:multiaddr(U.addr);if(this.log("autonat response for %a is %s",j,U.status),U.status===Message$3.ResponseStatus.E_BAD_REQUEST||U.status===Message$3.ResponseStatus.E_DIAL_REFUSED||U.addr==null&&_.length>1)continue;if(!_.some(Z=>Z.equals(j))){this.log("peer reported %a as %s but it was not in our observed address list",j,U.status);continue}const z=j.toString();if(B[z]==null&&(B[z]={success:0,failure:0}),U.status===Message$3.ResponseStatus.OK?B[z].success++:U.status===Message$3.ResponseStatus.E_DIAL_ERROR&&B[z].failure++,B[z].success===REQUIRED_SUCCESSFUL_DIALS){this.log("%a is externally dialable",j),r.confirmObservedAddr(j);return}if(B[z].failure===REQUIRED_SUCCESSFUL_DIALS){this.log("%a is not externally dialable",j),r.removeObservedAddr(j);return}}catch(j){this.log.error("could not verify external address",j)}}finally{this.verifyAddressTimeout=setTimeout(this._verifyExternalAddresses,this.refreshInterval)}}}function autoNAT(n={}){return r=>new AutoNATService(r,n)}const DNS4=base$2("dns4"),DNS6=base$2("dns6"),DNSADDR=base$2("dnsaddr"),DNS$2=or$1(base$2("dns"),DNSADDR,DNS4,DNS6),IP$1=or$1(base$2("ip4"),base$2("ip6")),TCP$1=or$1(and$1(IP$1,base$2("tcp")),and$1(DNS$2,base$2("tcp"))),UDP=and$1(IP$1,base$2("udp")),UTP=and$1(UDP,base$2("utp")),QUIC=and$1(UDP,base$2("quic")),QUICV1=and$1(UDP,base$2("quic-v1")),_WebSockets$1=or$1(and$1(TCP$1,base$2("ws")),and$1(DNS$2,base$2("ws"))),WebSockets$1=or$1(and$1(_WebSockets$1,base$2("p2p")),_WebSockets$1),_WebSocketsSecure$1=or$1(and$1(TCP$1,base$2("wss")),and$1(DNS$2,base$2("wss")),and$1(TCP$1,base$2("tls"),base$2("ws")),and$1(DNS$2,base$2("tls"),base$2("ws"))),WebSocketsSecure=or$1(and$1(_WebSocketsSecure$1,base$2("p2p")),_WebSocketsSecure$1),HTTP=or$1(and$1(TCP$1,base$2("http")),and$1(IP$1,base$2("http")),and$1(DNS$2,base$2("http"))),HTTPS=or$1(and$1(TCP$1,base$2("https")),and$1(IP$1,base$2("https")),and$1(DNS$2,base$2("https"))),_WebRTCDirect$1=and$1(UDP,base$2("webrtc-direct"),base$2("certhash")),WebRTCDirect$1=or$1(and$1(_WebRTCDirect$1,base$2("p2p")),_WebRTCDirect$1),_WebTransport$1=and$1(QUICV1,base$2("webtransport"),base$2("certhash"),base$2("certhash")),WebTransport$2=or$1(and$1(_WebTransport$1,base$2("p2p")),_WebTransport$1),P2PWebRTCStar=or$1(and$1(WebSockets$1,base$2("p2p-webrtc-star"),base$2("p2p")),and$1(WebSocketsSecure,base$2("p2p-webrtc-star"),base$2("p2p")),and$1(WebSockets$1,base$2("p2p-webrtc-star")),and$1(WebSocketsSecure,base$2("p2p-webrtc-star"))),P2PWebRTCDirect=or$1(and$1(HTTP,base$2("p2p-webrtc-direct"),base$2("p2p")),and$1(HTTPS,base$2("p2p-webrtc-direct"),base$2("p2p")),and$1(HTTP,base$2("p2p-webrtc-direct")),and$1(HTTPS,base$2("p2p-webrtc-direct"))),Reliable=or$1(_WebSockets$1,_WebSocketsSecure$1,HTTP,HTTPS,P2PWebRTCStar,P2PWebRTCDirect,TCP$1,UTP,QUIC,DNS$2,WebRTCDirect$1,WebTransport$2),_P2P$1=or$1(and$1(Reliable,base$2("p2p")),P2PWebRTCStar,P2PWebRTCDirect,WebRTCDirect$1,WebTransport$2,base$2("p2p")),_Circuit$1=or$1(and$1(_P2P$1,base$2("p2p-circuit"),_P2P$1),and$1(_P2P$1,base$2("p2p-circuit")),and$1(base$2("p2p-circuit"),_P2P$1),and$1(Reliable,base$2("p2p-circuit")),and$1(base$2("p2p-circuit"),Reliable),base$2("p2p-circuit")),CircuitRecursive=()=>or$1(and$1(_Circuit$1,CircuitRecursive),_Circuit$1),Circuit$1=CircuitRecursive(),P2P=or$1(and$1(Circuit$1,_P2P$1,Circuit$1),and$1(_P2P$1,Circuit$1),and$1(Circuit$1,_P2P$1),Circuit$1,_P2P$1);function makeMatchesFunction(n){function r(_){let E;try{E=multiaddr(_)}catch{return!1}const S=n(E.protoNames());return S===null?!1:S===!0||S===!1?S:S.length===0}return r}function and$1(...n){function r(_){if(_.length<n.length)return null;let E=_;return n.some(S=>(E=typeof S=="function"?S().partialMatch(_):S.partialMatch(_),Array.isArray(E)&&(_=E),E===null)),E}return{toString:function(){return"{ "+n.join(" ")+" }"},input:n,matches:makeMatchesFunction(r),partialMatch:r}}function or$1(...n){function r(E){let S=null;return n.some(C=>{const A=typeof C=="function"?C().partialMatch(E):C.partialMatch(E);return A!=null?(S=A,!0):!1}),S}return{toString:function(){return"{ "+n.join(" ")+" }"},input:n,matches:makeMatchesFunction(r),partialMatch:r}}function base$2(n){const r=n;function _(S){let C;try{C=multiaddr(S)}catch{return!1}const A=C.protoNames();return A.length===1&&A[0]===r}function E(S){return S.length===0?null:S[0]===r?S.slice(1):null}return{toString:function(){return r},matches:_,partialMatch:E}}const DEFAULT_BOOTSTRAP_TAG_NAME="bootstrap",DEFAULT_BOOTSTRAP_TAG_VALUE=50,DEFAULT_BOOTSTRAP_TAG_TTL=12e4,DEFAULT_BOOTSTRAP_DISCOVERY_TIMEOUT=1e3;class Bootstrap extends TypedEventEmitter{static tag="bootstrap";log;timer;list;timeout;components;_init;constructor(r,_={list:[]}){if(_.list==null||_.list.length===0)throw new Error("Bootstrap requires a list of peer addresses");super(),this.components=r,this.log=r.logger.forComponent("libp2p:bootstrap"),this.timeout=_.timeout??DEFAULT_BOOTSTRAP_DISCOVERY_TIMEOUT,this.list=[];for(const E of _.list){if(!P2P.matches(E)){this.log.error("Invalid multiaddr");continue}const S=multiaddr(E),C=S.getPeerId();if(C==null){this.log.error("Invalid bootstrap multiaddr without peer id");continue}const A={id:peerIdFromString$1(C),multiaddrs:[S]};this.list.push(A)}this._init=_}[peerDiscoverySymbol]=this;[Symbol.toStringTag]="@libp2p/bootstrap";isStarted(){return!!this.timer}start(){this.isStarted()||(this.log("Starting bootstrap node discovery, discovering peers after %s ms",this.timeout),this.timer=setTimeout(()=>{this._discoverBootstrapPeers().catch(r=>{this.log.error(r)})},this.timeout))}async _discoverBootstrapPeers(){if(this.timer!=null)for(const r of this.list){if(await this.components.peerStore.merge(r.id,{tags:{[this._init.tagName??DEFAULT_BOOTSTRAP_TAG_NAME]:{value:this._init.tagValue??DEFAULT_BOOTSTRAP_TAG_VALUE,ttl:this._init.tagTTL??DEFAULT_BOOTSTRAP_TAG_TTL}}}),this.timer==null)return;this.safeDispatchEvent("peer",{detail:r})}}stop(){this.timer!=null&&clearTimeout(this.timer),this.timer=void 0}}function bootstrap(n){return r=>new Bootstrap(r,n)}const codes$6={ERR_SIGNATURE_NOT_VALID:"ERR_SIGNATURE_NOT_VALID"};var Envelope;(function(n){let r;n.codec=()=>(r==null&&(r=message((_,E,S={})=>{S.lengthDelimited!==!1&&E.fork(),_.publicKey!=null&&_.publicKey.byteLength>0&&(E.uint32(10),E.bytes(_.publicKey)),_.payloadType!=null&&_.payloadType.byteLength>0&&(E.uint32(18),E.bytes(_.payloadType)),_.payload!=null&&_.payload.byteLength>0&&(E.uint32(26),E.bytes(_.payload)),_.signature!=null&&_.signature.byteLength>0&&(E.uint32(42),E.bytes(_.signature)),S.lengthDelimited!==!1&&E.ldelim()},(_,E)=>{const S={publicKey:new Uint8Array(0),payloadType:new Uint8Array(0),payload:new Uint8Array(0),signature:new Uint8Array(0)},C=E==null?_.len:_.pos+E;for(;_.pos<C;){const A=_.uint32();switch(A>>>3){case 1:S.publicKey=_.bytes();break;case 2:S.payloadType=_.bytes();break;case 3:S.payload=_.bytes();break;case 5:S.signature=_.bytes();break;default:_.skipType(A&7);break}}return S})),r),n.encode=_=>encodeMessage(_,n.codec()),n.decode=_=>decodeMessage$1(_,n.codec())})(Envelope||(Envelope={}));class RecordEnvelope{static createFromProtobuf=async r=>{const _=Envelope.decode(r),E=await peerIdFromKeys$1(_.publicKey);return new RecordEnvelope({peerId:E,payloadType:_.payloadType,payload:_.payload,signature:_.signature})};static seal=async(r,_)=>{if(_.privateKey==null)throw new Error("Missing private key");const E=r.domain,S=r.codec,C=r.marshal(),A=formatSignaturePayload(E,S,C),B=await(await unmarshalPrivateKey$1(_.privateKey)).sign(A.subarray());return new RecordEnvelope({peerId:_,payloadType:S,payload:C,signature:B})};static openAndCertify=async(r,_)=>{const E=await RecordEnvelope.createFromProtobuf(r);if(!await E.validate(_))throw new CodeError$4("envelope signature is not valid for the given domain",codes$6.ERR_SIGNATURE_NOT_VALID);return E};peerId;payloadType;payload;signature;marshaled;constructor(r){const{peerId:_,payloadType:E,payload:S,signature:C}=r;this.peerId=_,this.payloadType=E,this.payload=S,this.signature=C}marshal(){if(this.peerId.publicKey==null)throw new Error("Missing public key");return this.marshaled==null&&(this.marshaled=Envelope.encode({publicKey:this.peerId.publicKey,payloadType:this.payloadType,payload:this.payload.subarray(),signature:this.signature})),this.marshaled}equals(r){return equals$1(this.marshal(),r.marshal())}async validate(r){const _=formatSignaturePayload(r,this.payloadType,this.payload);if(this.peerId.publicKey==null)throw new Error("Missing public key");return unmarshalPublicKey$1(this.peerId.publicKey).verify(_.subarray(),this.signature)}}const formatSignaturePayload=(n,r,_)=>{const E=fromString$3(n),S=encode$b(E.byteLength),C=encode$b(r.length),A=encode$b(_.length);return new Uint8ArrayList(S,E,C,r,A,_)};function arrayEquals$1(n,r){const _=(E,S)=>E.toString().localeCompare(S.toString());return n.length!==r.length?!1:(r.sort(_),n.sort(_).every((E,S)=>r[S].equals(E)))}const ENVELOPE_DOMAIN_PEER_RECORD="libp2p-peer-record",ENVELOPE_PAYLOAD_TYPE_PEER_RECORD=Uint8Array.from([3,1]);var PeerRecord$1;(function(n){(function(_){let E;_.codec=()=>(E==null&&(E=message((S,C,A={})=>{A.lengthDelimited!==!1&&C.fork(),S.multiaddr!=null&&S.multiaddr.byteLength>0&&(C.uint32(10),C.bytes(S.multiaddr)),A.lengthDelimited!==!1&&C.ldelim()},(S,C)=>{const A={multiaddr:new Uint8Array(0)},I=C==null?S.len:S.pos+C;for(;S.pos<I;){const B=S.uint32();switch(B>>>3){case 1:A.multiaddr=S.bytes();break;default:S.skipType(B&7);break}}return A})),E),_.encode=S=>encodeMessage(S,_.codec()),_.decode=S=>decodeMessage$1(S,_.codec())})(n.AddressInfo||(n.AddressInfo={}));let r;n.codec=()=>(r==null&&(r=message((_,E,S={})=>{if(S.lengthDelimited!==!1&&E.fork(),_.peerId!=null&&_.peerId.byteLength>0&&(E.uint32(10),E.bytes(_.peerId)),_.seq!=null&&_.seq!==0n&&(E.uint32(16),E.uint64(_.seq)),_.addresses!=null)for(const C of _.addresses)E.uint32(26),n.AddressInfo.codec().encode(C,E);S.lengthDelimited!==!1&&E.ldelim()},(_,E)=>{const S={peerId:new Uint8Array(0),seq:0n,addresses:[]},C=E==null?_.len:_.pos+E;for(;_.pos<C;){const A=_.uint32();switch(A>>>3){case 1:S.peerId=_.bytes();break;case 2:S.seq=_.uint64();break;case 3:S.addresses.push(n.AddressInfo.codec().decode(_,_.uint32()));break;default:_.skipType(A&7);break}}return S})),r),n.encode=_=>encodeMessage(_,n.codec()),n.decode=_=>decodeMessage$1(_,n.codec())})(PeerRecord$1||(PeerRecord$1={}));class PeerRecord{static createFromProtobuf=r=>{const _=PeerRecord$1.decode(r),E=peerIdFromBytes$1(_.peerId),S=(_.addresses??[]).map(A=>multiaddr(A.multiaddr)),C=_.seq;return new PeerRecord({peerId:E,multiaddrs:S,seqNumber:C})};static DOMAIN=ENVELOPE_DOMAIN_PEER_RECORD;static CODEC=ENVELOPE_PAYLOAD_TYPE_PEER_RECORD;peerId;multiaddrs;seqNumber;domain=PeerRecord.DOMAIN;codec=PeerRecord.CODEC;marshaled;constructor(r){const{peerId:_,multiaddrs:E,seqNumber:S}=r;this.peerId=_,this.multiaddrs=E??[],this.seqNumber=S??BigInt(Date.now())}marshal(){return this.marshaled==null&&(this.marshaled=PeerRecord$1.encode({peerId:this.peerId.toBytes(),seq:BigInt(this.seqNumber),addresses:this.multiaddrs.map(r=>({multiaddr:r.bytes}))})),this.marshaled}equals(r){return!(!(r instanceof PeerRecord)||!this.peerId.equals(r.peerId)||this.seqNumber!==r.seqNumber||!arrayEquals$1(this.multiaddrs,r.multiaddrs))}}function pbStream(n,r){const _=lpStream(n,r),E={read:async(S,C)=>{const A=await _.read(C);return S.decode(A)},write:async(S,C,A)=>{await _.write(C.encode(S),A)},writeV:async(S,C,A)=>{await _.writeV(S.map(I=>C.encode(I)),A)},pb:S=>({read:async C=>E.read(S,C),write:async(C,A)=>E.write(C,S,A),writeV:async(C,A)=>E.writeV(C,S,A),unwrap:()=>E}),unwrap:()=>_.unwrap()};return E}const CIRCUIT_PROTO_CODE=290,RELAY_RENDEZVOUS_NS="/libp2p/relay",DEFAULT_RESERVATION_CONCURRENCY=1,RELAY_TAG="circuit-relay-relay";BigInt(1<<17);const RELAY_V2_HOP_CODEC="/libp2p/circuit/relay/0.2.0/hop",RELAY_V2_STOP_CODEC="/libp2p/circuit/relay/0.2.0/stop",MAX_CONNECTIONS$1=300,ERR_RELAYED_DIAL="ERR_RELAYED_DIAL",ERR_HOP_REQUEST_FAILED="ERR_HOP_REQUEST_FAILED";var HopMessage;(function(n){(function(E){E.RESERVE="RESERVE",E.CONNECT="CONNECT",E.STATUS="STATUS"})(n.Type||(n.Type={}));let r;(function(E){E[E.RESERVE=0]="RESERVE",E[E.CONNECT=1]="CONNECT",E[E.STATUS=2]="STATUS"})(r||(r={})),function(E){E.codec=()=>enumeration(r)}(n.Type||(n.Type={}));let _;n.codec=()=>(_==null&&(_=message((E,S,C={})=>{C.lengthDelimited!==!1&&S.fork(),E.type!=null&&(S.uint32(8),n.Type.codec().encode(E.type,S)),E.peer!=null&&(S.uint32(18),Peer$2.codec().encode(E.peer,S)),E.reservation!=null&&(S.uint32(26),Reservation.codec().encode(E.reservation,S)),E.limit!=null&&(S.uint32(34),Limit.codec().encode(E.limit,S)),E.status!=null&&(S.uint32(40),Status.codec().encode(E.status,S)),C.lengthDelimited!==!1&&S.ldelim()},(E,S)=>{const C={},A=S==null?E.len:E.pos+S;for(;E.pos<A;){const I=E.uint32();switch(I>>>3){case 1:C.type=n.Type.codec().decode(E);break;case 2:C.peer=Peer$2.codec().decode(E,E.uint32());break;case 3:C.reservation=Reservation.codec().decode(E,E.uint32());break;case 4:C.limit=Limit.codec().decode(E,E.uint32());break;case 5:C.status=Status.codec().decode(E);break;default:E.skipType(I&7);break}}return C})),_),n.encode=E=>encodeMessage(E,n.codec()),n.decode=E=>decodeMessage$1(E,n.codec())})(HopMessage||(HopMessage={}));var StopMessage;(function(n){(function(E){E.CONNECT="CONNECT",E.STATUS="STATUS"})(n.Type||(n.Type={}));let r;(function(E){E[E.CONNECT=0]="CONNECT",E[E.STATUS=1]="STATUS"})(r||(r={})),function(E){E.codec=()=>enumeration(r)}(n.Type||(n.Type={}));let _;n.codec=()=>(_==null&&(_=message((E,S,C={})=>{C.lengthDelimited!==!1&&S.fork(),E.type!=null&&(S.uint32(8),n.Type.codec().encode(E.type,S)),E.peer!=null&&(S.uint32(18),Peer$2.codec().encode(E.peer,S)),E.limit!=null&&(S.uint32(26),Limit.codec().encode(E.limit,S)),E.status!=null&&(S.uint32(32),Status.codec().encode(E.status,S)),C.lengthDelimited!==!1&&S.ldelim()},(E,S)=>{const C={},A=S==null?E.len:E.pos+S;for(;E.pos<A;){const I=E.uint32();switch(I>>>3){case 1:C.type=n.Type.codec().decode(E);break;case 2:C.peer=Peer$2.codec().decode(E,E.uint32());break;case 3:C.limit=Limit.codec().decode(E,E.uint32());break;case 4:C.status=Status.codec().decode(E);break;default:E.skipType(I&7);break}}return C})),_),n.encode=E=>encodeMessage(E,n.codec()),n.decode=E=>decodeMessage$1(E,n.codec())})(StopMessage||(StopMessage={}));var Peer$2;(function(n){let r;n.codec=()=>(r==null&&(r=message((_,E,S={})=>{if(S.lengthDelimited!==!1&&E.fork(),_.id!=null&&_.id.byteLength>0&&(E.uint32(10),E.bytes(_.id)),_.addrs!=null)for(const C of _.addrs)E.uint32(18),E.bytes(C);S.lengthDelimited!==!1&&E.ldelim()},(_,E)=>{const S={id:new Uint8Array(0),addrs:[]},C=E==null?_.len:_.pos+E;for(;_.pos<C;){const A=_.uint32();switch(A>>>3){case 1:S.id=_.bytes();break;case 2:S.addrs.push(_.bytes());break;default:_.skipType(A&7);break}}return S})),r),n.encode=_=>encodeMessage(_,n.codec()),n.decode=_=>decodeMessage$1(_,n.codec())})(Peer$2||(Peer$2={}));var Reservation;(function(n){let r;n.codec=()=>(r==null&&(r=message((_,E,S={})=>{if(S.lengthDelimited!==!1&&E.fork(),_.expire!=null&&_.expire!==0n&&(E.uint32(8),E.uint64(_.expire)),_.addrs!=null)for(const C of _.addrs)E.uint32(18),E.bytes(C);_.voucher!=null&&(E.uint32(26),E.bytes(_.voucher)),S.lengthDelimited!==!1&&E.ldelim()},(_,E)=>{const S={expire:0n,addrs:[]},C=E==null?_.len:_.pos+E;for(;_.pos<C;){const A=_.uint32();switch(A>>>3){case 1:S.expire=_.uint64();break;case 2:S.addrs.push(_.bytes());break;case 3:S.voucher=_.bytes();break;default:_.skipType(A&7);break}}return S})),r),n.encode=_=>encodeMessage(_,n.codec()),n.decode=_=>decodeMessage$1(_,n.codec())})(Reservation||(Reservation={}));var Limit;(function(n){let r;n.codec=()=>(r==null&&(r=message((_,E,S={})=>{S.lengthDelimited!==!1&&E.fork(),_.duration!=null&&(E.uint32(8),E.uint32(_.duration)),_.data!=null&&(E.uint32(16),E.uint64(_.data)),S.lengthDelimited!==!1&&E.ldelim()},(_,E)=>{const S={},C=E==null?_.len:_.pos+E;for(;_.pos<C;){const A=_.uint32();switch(A>>>3){case 1:S.duration=_.uint32();break;case 2:S.data=_.uint64();break;default:_.skipType(A&7);break}}return S})),r),n.encode=_=>encodeMessage(_,n.codec()),n.decode=_=>decodeMessage$1(_,n.codec())})(Limit||(Limit={}));var Status;(function(n){n.UNUSED="UNUSED",n.OK="OK",n.RESERVATION_REFUSED="RESERVATION_REFUSED",n.RESOURCE_LIMIT_EXCEEDED="RESOURCE_LIMIT_EXCEEDED",n.PERMISSION_DENIED="PERMISSION_DENIED",n.CONNECTION_FAILED="CONNECTION_FAILED",n.NO_RESERVATION="NO_RESERVATION",n.MALFORMED_MESSAGE="MALFORMED_MESSAGE",n.UNEXPECTED_MESSAGE="UNEXPECTED_MESSAGE"})(Status||(Status={}));var __StatusValues;(function(n){n[n.UNUSED=0]="UNUSED",n[n.OK=100]="OK",n[n.RESERVATION_REFUSED=200]="RESERVATION_REFUSED",n[n.RESOURCE_LIMIT_EXCEEDED=201]="RESOURCE_LIMIT_EXCEEDED",n[n.PERMISSION_DENIED=202]="PERMISSION_DENIED",n[n.CONNECTION_FAILED=203]="CONNECTION_FAILED",n[n.NO_RESERVATION=204]="NO_RESERVATION",n[n.MALFORMED_MESSAGE=400]="MALFORMED_MESSAGE",n[n.UNEXPECTED_MESSAGE=401]="UNEXPECTED_MESSAGE"})(__StatusValues||(__StatusValues={}));(function(n){n.codec=()=>enumeration(__StatusValues)})(Status||(Status={}));var ReservationVoucher;(function(n){let r;n.codec=()=>(r==null&&(r=message((_,E,S={})=>{S.lengthDelimited!==!1&&E.fork(),_.relay!=null&&_.relay.byteLength>0&&(E.uint32(10),E.bytes(_.relay)),_.peer!=null&&_.peer.byteLength>0&&(E.uint32(18),E.bytes(_.peer)),_.expiration!=null&&_.expiration!==0n&&(E.uint32(24),E.uint64(_.expiration)),S.lengthDelimited!==!1&&E.ldelim()},(_,E)=>{const S={relay:new Uint8Array(0),peer:new Uint8Array(0),expiration:0n},C=E==null?_.len:_.pos+E;for(;_.pos<C;){const A=_.uint32();switch(A>>>3){case 1:S.relay=_.bytes();break;case 2:S.peer=_.bytes();break;case 3:S.expiration=_.uint64();break;default:_.skipType(A&7);break}}return S})),r),n.encode=_=>encodeMessage(_,n.codec()),n.decode=_=>decodeMessage$1(_,n.codec())})(ReservationVoucher||(ReservationVoucher={}));async function namespaceToCid(n){const r=new TextEncoder().encode(n),_=await sha256$6.digest(r);return CID.createV0(_)}function getExpirationMilliseconds(n){const r=n*BigInt(1e3),_=new Date().getTime();return Number(r-BigInt(_))}function mapIterable(n,r){const _={[Symbol.iterator]:()=>_,next:()=>{const E=n.next(),S=E.value;return E.done===!0||S==null?{done:!0,value:void 0}:{done:!1,value:r(S)}}};return _}class PeerMap{map;constructor(r){if(this.map=new Map,r!=null)for(const[_,E]of r.entries())this.map.set(_.toString(),E)}[Symbol.iterator](){return this.entries()}clear(){this.map.clear()}delete(r){return this.map.delete(r.toString())}entries(){return mapIterable(this.map.entries(),r=>[peerIdFromString$1(r[0]),r[1]])}forEach(r){this.map.forEach((_,E)=>{r(_,peerIdFromString$1(E),this)})}get(r){return this.map.get(r.toString())}has(r){return this.map.has(r.toString())}set(r,_){this.map.set(r.toString(),_)}keys(){return mapIterable(this.map.keys(),r=>peerIdFromString$1(r))}values(){return this.map.values()}get size(){return this.map.size}}class PeerSet{set;constructor(r){if(this.set=new Set,r!=null)for(const _ of r)this.set.add(_.toString())}get size(){return this.set.size}[Symbol.iterator](){return this.values()}add(r){this.set.add(r.toString())}clear(){this.set.clear()}delete(r){this.set.delete(r.toString())}entries(){return mapIterable(this.set.entries(),r=>{const _=peerIdFromString$1(r[0]);return[_,_]})}forEach(r){this.set.forEach(_=>{const E=peerIdFromString$1(_);r(E,E,this)})}has(r){return this.set.has(r.toString())}values(){return mapIterable(this.set.values(),r=>peerIdFromString$1(r))}intersection(r){const _=new PeerSet;for(const E of r)this.has(E)&&_.add(E);return _}difference(r){const _=new PeerSet;for(const E of this)r.has(E)||_.add(E);return _}union(r){const _=new PeerSet;for(const E of r)_.add(E);for(const E of this)_.add(E);return _}}class RelayDiscovery extends TypedEventEmitter{peerId;peerStore;contentRouting;registrar;started;topologyId;log;constructor(r){super(),this.log=r.logger.forComponent("libp2p:circuit-relay:discover-relays"),this.started=!1,this.peerId=r.peerId,this.peerStore=r.peerStore,this.contentRouting=r.contentRouting,this.registrar=r.registrar}isStarted(){return this.started}async start(){this.topologyId=await this.registrar.register(RELAY_V2_HOP_CODEC,{notifyOnTransient:!0,onConnect:r=>{this.safeDispatchEvent("relay:discover",{detail:r})}}),this.started=!0}afterStart(){this.discover().catch(r=>{this.log.error("error discovering relays",r)})}stop(){this.topologyId!=null&&this.registrar.unregister(this.topologyId),this.started=!1}async discover(){this.log("searching peer store for relays");const r=await this.peerStore.all({filters:[_=>_.protocols.includes(RELAY_V2_HOP_CODEC)],orders:[()=>Math.random()<.5?1:-1]});for(const _ of r)this.log("found relay peer %p in content peer store",_.id),this.safeDispatchEvent("relay:discover",{detail:_.id});this.log("found %d relay peers in peer store",r.length);try{this.log("searching content routing for relays");const _=await namespaceToCid(RELAY_RENDEZVOUS_NS);let E=0;for await(const S of this.contentRouting.findProviders(_))if(S.multiaddrs.length>0&&!S.id.equals(this.peerId)){const C=S.id;E++,await this.peerStore.merge(C,{multiaddrs:S.multiaddrs}),this.log("found relay peer %p in content routing",C),this.safeDispatchEvent("relay:discover",{detail:C})}this.log("found %d relay peers in content routing",E)}catch(_){this.log.error("failed when finding relays on the network",_)}}}class PeerQueue extends Queue{has(r){return this.find(r)!=null}find(r){return this.queue.find(_=>r.equals(_.options.peerId))}}const REFRESH_WINDOW=60*1e3*10,REFRESH_TIMEOUT=60*1e3*5,REFRESH_TIMEOUT_MIN=30*1e3;class ReservationStore extends TypedEventEmitter{peerId;connectionManager;transportManager;peerStore;events;reserveQueue;reservations;maxDiscoveredRelays;maxReservationQueueLength;reservationCompletionTimeout;started;log;constructor(r,_){super(),this.log=r.logger.forComponent("libp2p:circuit-relay:transport:reservation-store"),this.peerId=r.peerId,this.connectionManager=r.connectionManager,this.transportManager=r.transportManager,this.peerStore=r.peerStore,this.events=r.events,this.reservations=new PeerMap,this.maxDiscoveredRelays=_?.discoverRelays??0,this.maxReservationQueueLength=_?.maxReservationQueueLength??100,this.reservationCompletionTimeout=_?.reservationCompletionTimeout??1e4,this.started=!1,this.reserveQueue=new PeerQueue({concurrency:_?.reservationConcurrency??DEFAULT_RESERVATION_CONCURRENCY,metricName:"libp2p_relay_reservation_queue",metrics:r.metrics}),this.events.addEventListener("peer:disconnect",E=>{this.#t(E.detail)})}isStarted(){return this.started}start(){this.started=!0}stop(){this.reserveQueue.clear(),this.reservations.forEach(({timeout:r})=>{clearTimeout(r)}),this.reservations.clear(),this.started=!1}async addRelay(r,_){if(this.peerId.equals(r)){this.log("not trying to use self as relay");return}if(this.reserveQueue.size>this.maxReservationQueueLength){this.log("not adding relay as the queue is full");return}if(this.reserveQueue.has(r)){this.log("relay peer is already in the reservation queue");return}this.log("add relay %p",r),await this.reserveQueue.add(async()=>{try{const E=this.reservations.get(r);if(E!=null){if(getExpirationMilliseconds(E.reservation.expire)>REFRESH_WINDOW){this.log("already have reservation on relay peer %p and it expires in more than 10 minutes",r);return}clearTimeout(E.timeout),this.reservations.delete(r)}if(_==="discovered"&&[...this.reservations.values()].reduce((N,U)=>(U.type==="discovered"&&N++,N),0)>=this.maxDiscoveredRelays){this.log("already have enough discovered relays");return}const S=AbortSignal.timeout(this.reservationCompletionTimeout),C=await this.connectionManager.openConnection(r,{signal:S});if(C.remoteAddr.protoNames().includes("p2p-circuit")){this.log("not creating reservation over relayed connection");return}const A=await this.#e(C,{signal:S});this.log("created reservation on relay peer %p",r);const I=getExpirationMilliseconds(A.expire),B=Math.min(Math.max(I-REFRESH_TIMEOUT,REFRESH_TIMEOUT_MIN),Math.pow(2,31)-1),O=setTimeout(()=>{this.addRelay(r,_).catch(N=>{this.log.error("could not refresh reservation to relay %p",r,N)})},B);this.reservations.set(r,{timeout:O,reservation:A,type:_}),await this.peerStore.merge(r,{tags:{[RELAY_TAG]:{value:1,ttl:I}}}),await this.transportManager.listen([multiaddr(`/p2p/${r.toString()}/p2p-circuit`)])}catch(E){this.log.error("could not reserve slot on %p",r,E);const S=this.reservations.get(r);S!=null&&clearTimeout(S.timeout),this.reservations.delete(r)}},{peerId:r})}hasReservation(r){return this.reservations.has(r)}getReservation(r){return this.reservations.get(r)?.reservation}async#e(r,_){_.signal?.throwIfAborted(),this.log("requesting reservation from %p",r.remotePeer);const E=await r.newStream(RELAY_V2_HOP_CODEC,_),C=pbStream(E).pb(HopMessage);await C.write({type:HopMessage.Type.RESERVE},_);let A;try{A=await C.read(_)}catch(B){throw this.log.error("error parsing reserve message response from %p because",r.remotePeer,B),E.abort(B),B}finally{await E.close()}if(A.status===Status.OK&&A.reservation!=null){let B=!1;const O=r.remoteAddr.bytes;for(const N of A.reservation.addrs)if(equals$1(O,N)){B=!0;break}return B||A.reservation.addrs.push(O),A.reservation}const I=`reservation failed with status ${A.status??"undefined"}`;throw this.log.error(I),new Error(I)}#t(r){const _=this.reservations.get(r);_!=null&&(this.log("connection to relay %p closed, removing reservation from local store",r),clearTimeout(_.timeout),this.reservations.delete(r),this.safeDispatchEvent("relay:removed",{detail:r}),this.reservations.size<this.maxDiscoveredRelays&&(this.log("not enough relays %d/%d",this.reservations.size,this.maxDiscoveredRelays),this.safeDispatchEvent("relay:not-enough-relays",{})))}}function streamToMaConnection(n){const{stream:r,remoteAddr:_,logger:E}=n,S=E.forComponent("libp2p:stream:converter");let C=!1,A=!1;const I=r.close.bind(r);r.close=async j=>{await I(j),U(!0)};const B=r.abort.bind(r);r.abort=j=>{B(j),U(!0)};const O=r.sink.bind(r);r.sink=async j=>{try{await O(j)}catch(z){z.type!=="aborted"&&S.error("%s error in sink",_,z)}finally{A=!0,U()}};const N={log:S,sink:r.sink,source:async function*(){try{for await(const j of r.source)j instanceof Uint8Array?yield j:yield*j}finally{C=!0,U()}}(),remoteAddr:_,timeline:{open:Date.now(),close:void 0},close:r.close,abort:r.abort};function U(j){j===!0&&(C=!0,A=!0),C&&A&&N.timeline.close==null&&(N.timeline.close=Date.now())}return N}class CircuitRelayTransportListener extends TypedEventEmitter{connectionManager;relayStore;listeningAddrs;log;constructor(r){super(),this.log=r.logger.forComponent("libp2p:circuit-relay:transport:listener"),this.connectionManager=r.connectionManager,this.relayStore=r.relayStore,this.listeningAddrs=new PeerMap,this.relayStore.addEventListener("relay:removed",this._onRemoveRelayPeer)}_onRemoveRelayPeer=r=>{this.#e(r.detail)};async listen(r){this.log("listen on %a",r);const _=r.decapsulate("/p2p-circuit"),E=await this.connectionManager.openConnection(_);if(!this.relayStore.hasReservation(E.remotePeer)){this.log("making reservation on peer %p",E.remotePeer),await this.relayStore.addRelay(E.remotePeer,"configured");return}const S=this.relayStore.getReservation(E.remotePeer);if(S==null)throw new CodeError$4("Did not have reservation after making reservation","ERR_NO_RESERVATION");if(this.listeningAddrs.has(E.remotePeer)){this.log("already listening on relay %p",E.remotePeer);return}this.listeningAddrs.set(E.remotePeer,S.addrs.map(C=>multiaddr(C).encapsulate("/p2p-circuit"))),this.safeDispatchEvent("listening",{})}getAddrs(){return[...this.listeningAddrs.values()].flat()}async close(){}#e(r){const _=this.listeningAddrs.has(r);this.log("relay peer removed %p - had reservation",r,_),this.listeningAddrs.delete(r),_&&(this.log.trace("removing relay event listener for peer %p",r),this.relayStore.removeEventListener("relay:removed",this._onRemoveRelayPeer),this.safeDispatchEvent("close",{}))}}function createListener$1(n){return new CircuitRelayTransportListener(n)}const isValidStop=n=>{if(n.peer==null)return!1;try{n.peer.addrs.forEach(multiaddr)}catch{return!1}return!0},defaults={maxInboundStopStreams:MAX_CONNECTIONS$1,maxOutboundStopStreams:MAX_CONNECTIONS$1,stopTimeout:3e4};class CircuitRelayTransport{discovery;registrar;peerStore;connectionManager;transportManager;peerId;upgrader;addressManager;connectionGater;reservationStore;logger;maxInboundStopStreams;maxOutboundStopStreams;stopTimeout;started;log;constructor(r,_){this.log=r.logger.forComponent("libp2p:circuit-relay:transport"),this.registrar=r.registrar,this.peerStore=r.peerStore,this.connectionManager=r.connectionManager,this.transportManager=r.transportManager,this.logger=r.logger,this.peerId=r.peerId,this.upgrader=r.upgrader,this.addressManager=r.addressManager,this.connectionGater=r.connectionGater,this.maxInboundStopStreams=_.maxInboundStopStreams??defaults.maxInboundStopStreams,this.maxOutboundStopStreams=_.maxOutboundStopStreams??defaults.maxOutboundStopStreams,this.stopTimeout=_.stopTimeout??defaults.stopTimeout,_.discoverRelays!=null&&_.discoverRelays>0&&(this.discovery=new RelayDiscovery(r),this.discovery.addEventListener("relay:discover",E=>{this.reservationStore.addRelay(E.detail,"discovered").catch(S=>{this.log.error("could not add discovered relay %p",E.detail,S)})})),this.reservationStore=new ReservationStore(r,_),this.reservationStore.addEventListener("relay:not-enough-relays",()=>{this.discovery?.discover().catch(E=>{this.log.error("could not discover relays",E)})}),this.started=!1}isStarted(){return this.started}async start(){this.reservationStore.start(),await this.registrar.handle(RELAY_V2_STOP_CODEC,r=>{this.onStop(r).catch(_=>{this.log.error("error while handling STOP protocol",_),r.stream.abort(_)})},{maxInboundStreams:this.maxInboundStopStreams,maxOutboundStreams:this.maxOutboundStopStreams,runOnTransientConnection:!0}),await this.discovery?.start(),this.started=!0}afterStart(){this.discovery?.afterStart()}async stop(){this.discovery?.stop(),this.reservationStore.stop(),await this.registrar.unhandle(RELAY_V2_STOP_CODEC),this.started=!1}[transportSymbol]=!0;[Symbol.toStringTag]="libp2p/circuit-relay-v2";async dial(r,_={}){if(r.protoCodes().filter(Z=>Z===CIRCUIT_PROTO_CODE).length!==1){const Z="Invalid circuit relay address";throw this.log.error(Z,r),new CodeError$4(Z,ERR_RELAYED_DIAL)}const E=r.toString().split("/p2p-circuit"),S=multiaddr(E[0]),C=multiaddr(E[E.length-1]),A=S.getPeerId(),I=C.getPeerId();if(A==null||I==null){const Z=`Circuit relay dial to ${r.toString()} failed as address did not have peer ids`;throw this.log.error(Z),new CodeError$4(Z,ERR_RELAYED_DIAL)}const B=peerIdFromString$1(A),O=peerIdFromString$1(I);let N=!1,j=this.connectionManager.getConnections(B)[0];j==null&&(await this.peerStore.merge(B,{multiaddrs:[S]}),j=await this.connectionManager.openConnection(B,_),N=!0);let z;try{return z=await j.newStream(RELAY_V2_HOP_CODEC),await this.connectV2({stream:z,connection:j,destinationPeer:O,destinationAddr:C,relayAddr:S,ma:r,disconnectOnFailure:N})}catch(Z){throw this.log.error("circuit relay dial to destination %p via relay %p failed",O,B,Z),z?.abort(Z),N&&await j.close(),Z}}async connectV2({stream:r,connection:_,destinationPeer:E,destinationAddr:S,relayAddr:C,ma:A,disconnectOnFailure:I}){try{const B=pbStream(r),O=B.pb(HopMessage);await O.write({type:HopMessage.Type.CONNECT,peer:{id:E.toBytes(),addrs:[multiaddr(S).bytes]}});const N=await O.read();if(N.status!==Status.OK)throw new CodeError$4(`failed to connect via relay with status ${N?.status?.toString()??"undefined"}`,ERR_HOP_REQUEST_FAILED);const U=streamToMaConnection({stream:B.unwrap(),remoteAddr:A,localAddr:C.encapsulate(`/p2p-circuit/p2p/${this.peerId.toString()}`),logger:this.logger});return this.log("new outbound transient connection %a",U.remoteAddr),await this.upgrader.upgradeOutbound(U,{transient:!0})}catch(B){throw this.log.error(`Circuit relay dial to destination ${E.toString()} via relay ${_.remotePeer.toString()} failed`,B),I&&await _.close(),B}}createListener(r){return createListener$1({connectionManager:this.connectionManager,relayStore:this.reservationStore,logger:this.logger})}filter(r){return r=Array.isArray(r)?r:[r],r.filter(_=>Circuit$1.matches(_))}async onStop({connection:r,stream:_}){if(!this.reservationStore.hasReservation(r.remotePeer))try{this.log("dialed via relay we did not have a reservation on, start listening on that relay address"),await this.transportManager.listen([r.remoteAddr.encapsulate("/p2p-circuit")])}catch(N){this.log.error("failed to listen on a relay peer we were dialed via but did not have a reservation on",N)}const E=AbortSignal.timeout(this.stopTimeout),S=pbStream(_).pb(StopMessage),C=await S.read({signal:E});if(this.log("new circuit relay v2 stop stream from %p with type %s",r.remotePeer,C.type),C?.type===void 0){this.log.error("type was missing from circuit v2 stop protocol request from %s",r.remotePeer),await S.write({type:StopMessage.Type.STATUS,status:Status.MALFORMED_MESSAGE},{signal:E}),await _.close();return}if(C.type!==StopMessage.Type.CONNECT){this.log.error("invalid stop connect request via peer %p",r.remotePeer),await S.write({type:StopMessage.Type.STATUS,status:Status.UNEXPECTED_MESSAGE},{signal:E}),await _.close();return}if(!isValidStop(C)){this.log.error("invalid stop connect request via peer %p",r.remotePeer),await S.write({type:StopMessage.Type.STATUS,status:Status.MALFORMED_MESSAGE},{signal:E}),await _.close();return}const A=peerIdFromBytes$1(C.peer.id);if(await this.connectionGater.denyInboundRelayedConnection?.(r.remotePeer,A)===!0){this.log.error("connection gater denied inbound relayed connection from %p",r.remotePeer),await S.write({type:StopMessage.Type.STATUS,status:Status.PERMISSION_DENIED},{signal:E}),await _.close();return}this.log.trace("sending success response to %p",r.remotePeer),await S.write({type:StopMessage.Type.STATUS,status:Status.OK},{signal:E});const I=r.remoteAddr.encapsulate(`/p2p-circuit/p2p/${A.toString()}`),B=this.addressManager.getAddresses()[0],O=streamToMaConnection({stream:S.unwrap().unwrap(),remoteAddr:I,localAddr:B,logger:this.logger});this.log("new inbound transient connection %a",O.remoteAddr),await this.upgrader.upgradeInbound(O,{transient:!0}),this.log("%s connection %a upgraded","inbound",O.remoteAddr)}}function circuitRelayTransport(n={}){return r=>new CircuitRelayTransport(r,n)}const createAbortError=()=>{const n=new Error("Delay aborted");return n.name="AbortError",n},clearMethods=new WeakMap;function createDelay({clearTimeout:n,setTimeout:r}={}){return(_,{value:E,signal:S}={})=>{if(S?.aborted)return Promise.reject(createAbortError());let C,A,I;const B=n??clearTimeout,O=()=>{B(C),I(createAbortError())},N=()=>{S&&S.removeEventListener("abort",O)},U=new Promise((j,z)=>{A=()=>{N(),j(E)},I=z,C=(r??setTimeout)(A,_)});return S&&S.addEventListener("abort",O,{once:!0}),clearMethods.set(U,()=>{B(C),C=null,A()}),U}}const delay=createDelay();var HolePunch;(function(n){(function(E){E.UNUSED="UNUSED",E.CONNECT="CONNECT",E.SYNC="SYNC"})(n.Type||(n.Type={}));let r;(function(E){E[E.UNUSED=0]="UNUSED",E[E.CONNECT=100]="CONNECT",E[E.SYNC=300]="SYNC"})(r||(r={})),function(E){E.codec=()=>enumeration(r)}(n.Type||(n.Type={}));let _;n.codec=()=>(_==null&&(_=message((E,S,C={})=>{if(C.lengthDelimited!==!1&&S.fork(),E.type!=null&&(S.uint32(8),n.Type.codec().encode(E.type,S)),E.observedAddresses!=null)for(const A of E.observedAddresses)S.uint32(18),S.bytes(A);C.lengthDelimited!==!1&&S.ldelim()},(E,S)=>{const C={observedAddresses:[]},A=S==null?E.len:E.pos+S;for(;E.pos<A;){const I=E.uint32();switch(I>>>3){case 1:C.type=n.Type.codec().decode(E);break;case 2:C.observedAddresses.push(E.bytes());break;default:E.skipType(I&7);break}}return C})),_),n.encode=E=>encodeMessage(E,n.codec()),n.decode=E=>decodeMessage$1(E,n.codec())})(HolePunch||(HolePunch={}));const toParts=n=>n.toString().split("/").slice(1),func=n=>({match:r=>r.length<1?!1:n(r[0])?r.slice(1):!1,pattern:"fn"}),literal=n=>({match:r=>func(_=>_===n).match(r),pattern:n}),string$1=()=>({match:n=>func(r=>typeof r=="string").match(n),pattern:"{string}"}),number=()=>({match:n=>func(r=>!isNaN(parseInt(r))).match(n),pattern:"{number}"}),peerId=()=>({match:n=>{if(n.length<2||n[0]!=="p2p"&&n[0]!=="ipfs")return!1;if(n[1].startsWith("Q")||n[1].startsWith("1"))try{base58btc.decode(`z${n[1]}`)}catch{return!1}else return!1;return n.slice(2)},pattern:"/p2p/{peerid}"}),certhash$1=()=>({match:n=>{if(n.length<2||n[0]!=="certhash")return!1;try{base64url$2.decode(n[1])}catch{return!1}return n.slice(2)},pattern:"/certhash/{certhash}"}),optional=n=>({match:r=>{const _=n.match(r);return _===!1?r:_},pattern:`optional(${n.pattern})`}),or=(...n)=>({match:r=>{let _;for(const E of n){const S=E.match(r);S!==!1&&(_==null||S.length<_.length)&&(_=S)}return _??!1},pattern:`or(${n.map(r=>r.pattern).join(", ")})`}),and=(...n)=>({match:r=>{for(const _ of n){const E=_.match(r);if(E===!1)return!1;r=E}return r},pattern:`and(${n.map(r=>r.pattern).join(", ")})`});function fmt(...n){function r(S){let C=toParts(S);for(const A of n){const I=A.match(C);if(I===!1)return!1;C=I}return C}function _(S){return r(S)!==!1}function E(S){const C=r(S);return C===!1?!1:C.length===0}return{matches:_,exactMatch:E}}const _DNS4=and(literal("dns4"),string$1()),_DNS6=and(literal("dns6"),string$1()),_DNSADDR=and(literal("dnsaddr"),string$1()),_DNS=and(literal("dns"),string$1()),DNS$1=fmt(or(_DNS,_DNSADDR,_DNS4,_DNS6)),_IP4=and(literal("ip4"),func(isIPv4)),_IP6=and(literal("ip6"),func(isIPv6)),_IP=or(_IP4,_IP6),_IP_OR_DOMAIN=or(_IP,_DNS,_DNS4,_DNS6,_DNSADDR),IP_OR_DOMAIN=fmt(_IP_OR_DOMAIN),IP=fmt(_IP),_TCP=and(_IP_OR_DOMAIN,literal("tcp"),number()),_UDP=and(_IP_OR_DOMAIN,literal("udp"),number()),TCP_OR_UDP=or(_TCP,_UDP),_QUIC=and(_UDP,literal("quic")),_QUICV1=and(_UDP,literal("quic-v1")),QUIC_V0_OR_V1=or(_QUIC,_QUICV1),_WEB=or(_IP_OR_DOMAIN,_TCP,_UDP,_QUIC,_QUICV1),_WebSockets=or(and(_WEB,literal("ws"),optional(peerId()))),_WebSocketsSecure=or(and(_WEB,literal("wss"),optional(peerId())),and(_WEB,literal("tls"),literal("ws"),optional(peerId()))),_WebRTCDirect=and(TCP_OR_UDP,literal("webrtc-direct"),certhash$1(),optional(certhash$1()),optional(peerId())),WebRTCDirect=fmt(_WebRTCDirect),_WebTransport=and(_QUICV1,literal("webtransport"),certhash$1(),certhash$1(),optional(peerId())),WebTransport$1=fmt(_WebTransport),_P2P=or(_WebSockets,_WebSocketsSecure,and(_TCP,optional(peerId())),and(QUIC_V0_OR_V1,optional(peerId())),and(_IP_OR_DOMAIN,optional(peerId())),_WebRTCDirect,_WebTransport,peerId()),_Circuit=and(_P2P,literal("p2p-circuit"),peerId()),Circuit=fmt(_Circuit),_WebRTC=or(and(_P2P,literal("p2p-circuit"),literal("webrtc"),peerId()),and(_P2P,literal("webrtc"),optional(peerId())),literal("webrtc")),WebRTC=fmt(_WebRTC);or(and(_IP_OR_DOMAIN,literal("tcp"),number(),literal("http"),optional(peerId())),and(_IP_OR_DOMAIN,literal("http"),optional(peerId())));or(and(_IP_OR_DOMAIN,literal("tcp"),or(and(literal("443"),literal("http")),and(number(),literal("https"))),optional(peerId())),and(_IP_OR_DOMAIN,literal("tls"),literal("http"),optional(peerId())),and(_IP_OR_DOMAIN,literal("https"),optional(peerId())));function isPublicAndDialable(n,r){return Circuit.matches(n)||r.transportForMultiaddr(n)==null?!1:DNS$1.matches(n)?!0:IP.matches(n)?isPrivateIp(n.toOptions().host)===!1:!1}const MAX_DCUTR_MESSAGE_SIZE=1024*4,DCUTR_DIAL_PRIORITY=100,defaultValues$1={timeout:5e3,retries:3,maxInboundStreams:1,maxOutboundStreams:1};class DefaultDCUtRService{started;timeout;retries;maxInboundStreams;maxOutboundStreams;peerStore;registrar;connectionManager;addressManager;transportManager;topologyId;log;constructor(r,_){this.log=r.logger.forComponent("libp2p:dcutr"),this.started=!1,this.peerStore=r.peerStore,this.registrar=r.registrar,this.addressManager=r.addressManager,this.connectionManager=r.connectionManager,this.transportManager=r.transportManager,this.timeout=_.timeout??defaultValues$1.timeout,this.retries=_.retries??defaultValues$1.retries,this.maxInboundStreams=_.maxInboundStreams??defaultValues$1.maxInboundStreams,this.maxOutboundStreams=_.maxOutboundStreams??defaultValues$1.maxOutboundStreams}isStarted(){return this.started}async start(){this.started||(this.topologyId=await this.registrar.register(multicodec,{notifyOnTransient:!0,onConnect:(r,_)=>{_.transient&&_.direction==="inbound"&&this.upgradeInbound(_).catch(E=>{this.log.error("error during outgoing DCUtR attempt",E)})}}),await this.registrar.handle(multicodec,r=>{this.handleIncomingUpgrade(r.stream,r.connection).catch(_=>{this.log.error("error during incoming DCUtR attempt",_),r.stream.abort(_)})},{maxInboundStreams:this.maxInboundStreams,maxOutboundStreams:this.maxOutboundStreams,runOnTransientConnection:!0}),this.started=!0)}async stop(){await this.registrar.unhandle(multicodec),this.topologyId!=null&&this.registrar.unregister(this.topologyId),this.started=!1}async upgradeInbound(r){if(await this.attemptUnilateralConnectionUpgrade(r))return;let _;for(let E=0;E<this.retries;E++){const S={signal:AbortSignal.timeout(this.timeout)};try{_=await r.newStream([multicodec],{signal:S.signal,runOnTransientConnection:!0});const C=pbStream(_,{maxDataLength:MAX_DCUTR_MESSAGE_SIZE}).pb(HolePunch);this.log("B sending connect to %p",r.remotePeer);const A=Date.now();await C.write({type:HolePunch.Type.CONNECT,observedAddresses:this.addressManager.getAddresses().map(U=>U.bytes)},S),this.log("B receiving connect from %p",r.remotePeer);const I=await C.read(S);if(I.type!==HolePunch.Type.CONNECT)throw this.log("A sent wrong message type"),new CodeError$4("DCUtR message type was incorrect",ERR_INVALID_MESSAGE);const B=this.getDialableMultiaddrs(I.observedAddresses);if(B.length===0)throw this.log("A did not have any dialable multiaddrs"),new CodeError$4("DCUtR connect message had no multiaddrs",ERR_INVALID_MESSAGE);const O=Date.now()-A;this.log("A sending sync, rtt %dms",O),await C.write({type:HolePunch.Type.SYNC,observedAddresses:[]},S),this.log("A waiting for half RTT"),await delay(O/2),this.log("B dialing",B);const N=await this.connectionManager.openConnection(B,{signal:S.signal,priority:DCUTR_DIAL_PRIORITY});this.log("DCUtR to %p succeeded to address %a, closing relayed connection",r.remotePeer,N.remoteAddr),await r.close(S);break}catch(C){if(this.log.error("error while attempting DCUtR on attempt %d of %d",E+1,this.retries,C),_?.abort(C),E===this.retries)throw C}finally{_!=null&&await _.close(S)}}}async attemptUnilateralConnectionUpgrade(r){const E=(await this.peerStore.get(r.remotePeer)).addresses.map(S=>{const C=S.multiaddr;return C.getPeerId()==null?C.encapsulate(`/p2p/${r.remotePeer}`):C}).filter(S=>isPublicAndDialable(S,this.transportManager));if(E.length>0){const S=AbortSignal.timeout(this.timeout);try{this.log("attempting unilateral connection upgrade to %a",E);const C=await this.connectionManager.openConnection(E,{signal:S,force:!0});if(C.transient)throw new Error("Could not open a new, non-transient, connection");return this.log("unilateral connection upgrade to %p succeeded via %a, closing relayed connection",r.remotePeer,C.remoteAddr),await r.close({signal:S}),!0}catch(C){this.log.error("unilateral connection upgrade to %p on addresses %a failed",r.remotePeer,E,C)}}else this.log("peer %p has no public addresses, not attempting unilateral connection upgrade",r.remotePeer);return!1}async handleIncomingUpgrade(r,_){const E={signal:AbortSignal.timeout(this.timeout)};try{const S=pbStream(r,{maxDataLength:MAX_DCUTR_MESSAGE_SIZE}).pb(HolePunch);this.log("A receiving connect");const C=await S.read(E);if(C.type!==HolePunch.Type.CONNECT)throw this.log("B sent wrong message type"),new CodeError$4("DCUtR message type was incorrect",ERR_INVALID_MESSAGE);if(C.observedAddresses.length===0)throw this.log("B sent no multiaddrs"),new CodeError$4("DCUtR connect message had no multiaddrs",ERR_INVALID_MESSAGE);const A=this.getDialableMultiaddrs(C.observedAddresses);if(A.length===0)throw this.log("B had no dialable multiaddrs"),new CodeError$4("DCUtR connect message had no dialable multiaddrs",ERR_INVALID_MESSAGE);if(this.log("A sending connect"),await S.write({type:HolePunch.Type.CONNECT,observedAddresses:this.addressManager.getAddresses().map(O=>O.bytes)}),this.log("A receiving sync"),(await S.read(E)).type!==HolePunch.Type.SYNC)throw new CodeError$4("DCUtR message type was incorrect",ERR_INVALID_MESSAGE);this.log("A dialing",A);const B=await this.connectionManager.openConnection(A,{signal:E.signal,priority:DCUTR_DIAL_PRIORITY,force:!0});this.log("DCUtR to %p succeeded via %a, closing relayed connection",_.remotePeer,B.remoteAddr),await _.close(E)}catch(S){this.log.error("incoming DCUtR from %p failed",_.remotePeer,S),r.abort(S)}finally{await r.close(E)}}getDialableMultiaddrs(r){const _=[];for(const E of r)if(!(E==null||E.length===0))try{const S=multiaddr(E);if(!isPublicAndDialable(S,this.transportManager))continue;_.push(S)}catch{}return _}}const multicodec="/libp2p/dcutr";function dcutr(n={}){return r=>new DefaultDCUtRService(r,n)}const IDENTIFY_PROTOCOL_VERSION="0.1.0",MULTICODEC_IDENTIFY_PROTOCOL_NAME="id",MULTICODEC_IDENTIFY_PUSH_PROTOCOL_NAME="id/push",MULTICODEC_IDENTIFY_PROTOCOL_VERSION="1.0.0",MULTICODEC_IDENTIFY_PUSH_PROTOCOL_VERSION="1.0.0";var Identify$1;(function(n){let r;n.codec=()=>(r==null&&(r=message((_,E,S={})=>{if(S.lengthDelimited!==!1&&E.fork(),_.protocolVersion!=null&&(E.uint32(42),E.string(_.protocolVersion)),_.agentVersion!=null&&(E.uint32(50),E.string(_.agentVersion)),_.publicKey!=null&&(E.uint32(10),E.bytes(_.publicKey)),_.listenAddrs!=null)for(const C of _.listenAddrs)E.uint32(18),E.bytes(C);if(_.observedAddr!=null&&(E.uint32(34),E.bytes(_.observedAddr)),_.protocols!=null)for(const C of _.protocols)E.uint32(26),E.string(C);_.signedPeerRecord!=null&&(E.uint32(66),E.bytes(_.signedPeerRecord)),S.lengthDelimited!==!1&&E.ldelim()},(_,E)=>{const S={listenAddrs:[],protocols:[]},C=E==null?_.len:_.pos+E;for(;_.pos<C;){const A=_.uint32();switch(A>>>3){case 5:S.protocolVersion=_.string();break;case 6:S.agentVersion=_.string();break;case 1:S.publicKey=_.bytes();break;case 2:S.listenAddrs.push(_.bytes());break;case 4:S.observedAddr=_.bytes();break;case 3:S.protocols.push(_.string());break;case 8:S.signedPeerRecord=_.bytes();break;default:_.skipType(A&7);break}}return S})),r),n.encode=_=>encodeMessage(_,n.codec()),n.decode=_=>decodeMessage$1(_,n.codec())})(Identify$1||(Identify$1={}));const MAX_IDENTIFY_MESSAGE_SIZE=1024*8,defaultValues={protocolPrefix:"ipfs",timeout:6e4,maxInboundStreams:1,maxOutboundStreams:1,maxPushIncomingStreams:1,maxPushOutgoingStreams:1,maxObservedAddresses:10,maxIdentifyMessageSize:8192,runOnConnectionOpen:!0,runOnTransientConnection:!0};class Identify{identifyProtocolStr;identifyPushProtocolStr;host;started;timeout;peerId;peerStore;registrar;connectionManager;addressManager;maxInboundStreams;maxOutboundStreams;maxPushIncomingStreams;maxPushOutgoingStreams;maxIdentifyMessageSize;maxObservedAddresses;events;runOnTransientConnection;log;constructor(r,_={}){this.started=!1,this.peerId=r.peerId,this.peerStore=r.peerStore,this.registrar=r.registrar,this.addressManager=r.addressManager,this.connectionManager=r.connectionManager,this.events=r.events,this.log=r.logger.forComponent("libp2p:identify"),this.identifyProtocolStr=`/${_.protocolPrefix??defaultValues.protocolPrefix}/${MULTICODEC_IDENTIFY_PROTOCOL_NAME}/${MULTICODEC_IDENTIFY_PROTOCOL_VERSION}`,this.identifyPushProtocolStr=`/${_.protocolPrefix??defaultValues.protocolPrefix}/${MULTICODEC_IDENTIFY_PUSH_PROTOCOL_NAME}/${MULTICODEC_IDENTIFY_PUSH_PROTOCOL_VERSION}`,this.timeout=_.timeout??defaultValues.timeout,this.maxInboundStreams=_.maxInboundStreams??defaultValues.maxInboundStreams,this.maxOutboundStreams=_.maxOutboundStreams??defaultValues.maxOutboundStreams,this.maxPushIncomingStreams=_.maxPushIncomingStreams??defaultValues.maxPushIncomingStreams,this.maxPushOutgoingStreams=_.maxPushOutgoingStreams??defaultValues.maxPushOutgoingStreams,this.maxIdentifyMessageSize=_.maxIdentifyMessageSize??defaultValues.maxIdentifyMessageSize,this.maxObservedAddresses=_.maxObservedAddresses??defaultValues.maxObservedAddresses,this.runOnTransientConnection=_.runOnTransientConnection??defaultValues.runOnTransientConnection,this.host={protocolVersion:`${_.protocolPrefix??defaultValues.protocolPrefix}/${IDENTIFY_PROTOCOL_VERSION}`,agentVersion:_.agentVersion??`${r.nodeInfo.name}/${r.nodeInfo.version}`},(_.runOnConnectionOpen??defaultValues.runOnConnectionOpen)&&r.events.addEventListener("connection:open",E=>{const S=E.detail;this.identify(S).catch(C=>{this.log.error("error during identify trigged by connection:open",C)})}),r.events.addEventListener("self:peer:update",E=>{this.push().catch(S=>{this.log.error(S)})}),this.host.agentVersion===`${r.nodeInfo.name}/${r.nodeInfo.version}`&&(isNode||isElectronMain?this.host.agentVersion+=` UserAgent=${globalThis.process.version}`:(isBrowser||isWebWorker||isElectronRenderer||isReactNative)&&(this.host.agentVersion+=` UserAgent=${globalThis.navigator.userAgent}`))}isStarted(){return this.started}async start(){this.started||(await this.peerStore.merge(this.peerId,{metadata:{AgentVersion:fromString$3(this.host.agentVersion),ProtocolVersion:fromString$3(this.host.protocolVersion)}}),await this.registrar.handle(this.identifyProtocolStr,r=>{this._handleIdentify(r).catch(_=>{this.log.error(_)})},{maxInboundStreams:this.maxInboundStreams,maxOutboundStreams:this.maxOutboundStreams,runOnTransientConnection:this.runOnTransientConnection}),await this.registrar.handle(this.identifyPushProtocolStr,r=>{this._handlePush(r).catch(_=>{this.log.error(_)})},{maxInboundStreams:this.maxPushIncomingStreams,maxOutboundStreams:this.maxPushOutgoingStreams,runOnTransientConnection:this.runOnTransientConnection}),this.started=!0)}async stop(){await this.registrar.unhandle(this.identifyProtocolStr),await this.registrar.unhandle(this.identifyPushProtocolStr),this.started=!1}async pushToConnections(r){const _=this.addressManager.getAddresses().map(N=>N.decapsulateCode(getProtocol("p2p").code)),E=new PeerRecord({peerId:this.peerId,multiaddrs:_}),S=await RecordEnvelope.seal(E,this.peerId),C=this.registrar.getProtocols(),A=await this.peerStore.get(this.peerId),I=toString$4(A.metadata.get("AgentVersion")??fromString$3(this.host.agentVersion)),B=toString$4(A.metadata.get("ProtocolVersion")??fromString$3(this.host.protocolVersion)),O=r.map(async N=>{let U;const j=AbortSignal.timeout(this.timeout);setMaxListeners$2(1/0,j);try{U=await N.newStream(this.identifyPushProtocolStr,{signal:j,runOnTransientConnection:this.runOnTransientConnection}),await pbStream(U,{maxDataLength:this.maxIdentifyMessageSize??MAX_IDENTIFY_MESSAGE_SIZE}).pb(Identify$1).write({listenAddrs:_.map(Z=>Z.bytes),signedPeerRecord:S.marshal(),protocols:C,agentVersion:I,protocolVersion:B},{signal:j}),await U.close({signal:j})}catch(z){this.log.error("could not push identify update to peer",z),U?.abort(z)}});await Promise.all(O)}async push(){if(!this.isStarted())return;const r=[];await Promise.all(this.connectionManager.getConnections().map(async _=>{try{if(!(await this.peerStore.get(_.remotePeer)).protocols.includes(this.identifyPushProtocolStr))return;r.push(_)}catch(E){if(E.code!==ERR_NOT_FOUND)throw E}})),await this.pushToConnections(r)}async _identify(r,_={}){let E;if(_.signal==null){const S=AbortSignal.timeout(this.timeout);setMaxListeners$2(1/0,S),_={..._,signal:S}}try{E=await r.newStream(this.identifyProtocolStr,{..._,runOnTransientConnection:this.runOnTransientConnection});const C=await pbStream(E,{maxDataLength:this.maxIdentifyMessageSize??MAX_IDENTIFY_MESSAGE_SIZE}).pb(Identify$1).read(_);return await E.close(_),C}catch(S){throw this.log.error("error while reading identify message",S),E?.abort(S),S}}async identify(r,_={}){const E=await this._identify(r,_),{publicKey:S,protocols:C,observedAddr:A}=E;if(S==null)throw new CodeError$4("public key was missing from identify message","ERR_MISSING_PUBLIC_KEY");const I=await peerIdFromKeys$1(S);if(!r.remotePeer.equals(I))throw new CodeError$4("identified peer does not match the expected peer","ERR_INVALID_PEER");if(this.peerId.equals(I))throw new CodeError$4("identified peer is our own peer id?","ERR_INVALID_PEER");const B=getCleanMultiaddr(A);return this.log("identify completed for peer %p and protocols %o",I,C),this.log("our observed address is %a",B),B!=null&&this.addressManager.getObservedAddrs().length<(this.maxObservedAddresses??1/0)&&(this.log("storing our observed address %a",B),this.addressManager.addObservedAddr(B)),this.#e(r,E)}async _handleIdentify(r){const{connection:_,stream:E}=r,S=AbortSignal.timeout(this.timeout);setMaxListeners$2(1/0,S);try{const C=this.peerId.publicKey??new Uint8Array(0),A=await this.peerStore.get(this.peerId),I=this.addressManager.getAddresses().map(U=>U.decapsulateCode(getProtocol("p2p").code));let B=A.peerRecordEnvelope;if(I.length>0&&B==null){const U=new PeerRecord({peerId:this.peerId,multiaddrs:I});B=(await RecordEnvelope.seal(U,this.peerId)).marshal().subarray()}let O=_.remoteAddr.bytes;IP_OR_DOMAIN.matches(_.remoteAddr)||(O=void 0),await pbStream(E).pb(Identify$1).write({protocolVersion:this.host.protocolVersion,agentVersion:this.host.agentVersion,publicKey:C,listenAddrs:I.map(U=>U.bytes),signedPeerRecord:B,observedAddr:O,protocols:A.protocols},{signal:S}),await E.close({signal:S})}catch(C){this.log.error("could not respond to identify request",C),E.abort(C)}}async _handlePush(r){const{connection:_,stream:E}=r;try{if(this.peerId.equals(_.remotePeer))throw new Error("received push from ourselves?");const S={signal:AbortSignal.timeout(this.timeout)},A=await pbStream(E,{maxDataLength:this.maxIdentifyMessageSize??MAX_IDENTIFY_MESSAGE_SIZE}).pb(Identify$1).read(S);await E.close(S),await this.#e(_,A)}catch(S){this.log.error("received invalid message",S),E.abort(S);return}this.log("handled push from %p",_.remotePeer)}async#e(r,_){if(this.log("received identify from %p",r.remotePeer),_==null)throw new CodeError$4("message was null or undefined","ERR_INVALID_MESSAGE");const E={};if(_.listenAddrs.length>0&&(E.addresses=_.listenAddrs.map(A=>({isCertified:!1,multiaddr:multiaddr(A)}))),_.protocols.length>0&&(E.protocols=_.protocols),_.publicKey!=null&&(E.publicKey=_.publicKey,!(await peerIdFromKeys$1(_.publicKey)).equals(r.remotePeer)))throw new CodeError$4("public key did not match remote PeerId","ERR_INVALID_PUBLIC_KEY");let S;if(_.signedPeerRecord!=null){this.log("received signedPeerRecord from %p",r.remotePeer);let A=_.signedPeerRecord;const I=await RecordEnvelope.openAndCertify(A,PeerRecord.DOMAIN);let B=PeerRecord.createFromProtobuf(I.payload);if(!B.peerId.equals(I.peerId))throw new CodeError$4("signing key does not match PeerId in the PeerRecord","ERR_INVALID_SIGNING_KEY");if(!r.remotePeer.equals(B.peerId))throw new CodeError$4("signing key does not match remote PeerId","ERR_INVALID_PEER_RECORD_KEY");let O;try{O=await this.peerStore.get(B.peerId)}catch(N){if(N.code!=="ERR_NOT_FOUND")throw N}if(O!=null&&(E.metadata=O.metadata,O.peerRecordEnvelope!=null)){const N=await RecordEnvelope.createFromProtobuf(O.peerRecordEnvelope),U=PeerRecord.createFromProtobuf(N.payload);U.seqNumber>=B.seqNumber&&(this.log("sequence number was lower or equal to existing sequence number - stored: %d received: %d",U.seqNumber,B.seqNumber),B=U,A=O.peerRecordEnvelope)}E.peerRecordEnvelope=A,E.addresses=B.multiaddrs.map(N=>({isCertified:!0,multiaddr:N})),S={seq:B.seqNumber,addresses:B.multiaddrs}}else this.log("%p did not send a signed peer record",r.remotePeer);if(this.log("patching %p with",r.remotePeer,E),await this.peerStore.patch(r.remotePeer,E),_.agentVersion!=null||_.protocolVersion!=null){const A={};_.agentVersion!=null&&(A.AgentVersion=fromString$3(_.agentVersion)),_.protocolVersion!=null&&(A.ProtocolVersion=fromString$3(_.protocolVersion)),this.log("merging %p metadata",r.remotePeer,A),await this.peerStore.merge(r.remotePeer,{metadata:A})}const C={peerId:r.remotePeer,protocolVersion:_.protocolVersion,agentVersion:_.agentVersion,publicKey:_.publicKey,listenAddrs:_.listenAddrs.map(A=>multiaddr(A)),observedAddr:_.observedAddr==null?void 0:multiaddr(_.observedAddr),protocols:_.protocols,signedPeerRecord:S,connection:r};return this.events.safeDispatchEvent("peer:identify",{detail:C}),C}}function getCleanMultiaddr(n){if(n!=null&&n.length>0)try{return multiaddr(n)}catch{}}function identify(n={}){return r=>new Identify(r,n)}const second=1e3,minute=60*second,hour=60*minute,MAX_RECORD_AGE=36*hour,PROTOCOL$1="/ipfs/kad/1.0.0",RECORD_KEY_PREFIX="/dht/record",PROVIDER_KEY_PREFIX="/dht/provider",PROVIDERS_LRU_CACHE_SIZE=256,PROVIDERS_VALIDITY=24*hour,PROVIDERS_CLEANUP_INTERVAL=hour,K=20,ALPHA=3,QUERY_SELF_INTERVAL=5*minute,QUERY_SELF_INITIAL_INTERVAL=second,QUERY_SELF_TIMEOUT=5*second,TABLE_REFRESH_INTERVAL=5*minute,TABLE_REFRESH_QUERY_TIMEOUT=30*second,DEFAULT_QUERY_TIMEOUT=30*second;var Record$1;(function(n){let r;n.codec=()=>(r==null&&(r=message((_,E,S={})=>{S.lengthDelimited!==!1&&E.fork(),_.key!=null&&(E.uint32(10),E.bytes(_.key)),_.value!=null&&(E.uint32(18),E.bytes(_.value)),_.author!=null&&(E.uint32(26),E.bytes(_.author)),_.signature!=null&&(E.uint32(34),E.bytes(_.signature)),_.timeReceived!=null&&(E.uint32(42),E.string(_.timeReceived)),S.lengthDelimited!==!1&&E.ldelim()},(_,E)=>{const S={},C=E==null?_.len:_.pos+E;for(;_.pos<C;){const A=_.uint32();switch(A>>>3){case 1:{S.key=_.bytes();break}case 2:{S.value=_.bytes();break}case 3:{S.author=_.bytes();break}case 4:{S.signature=_.bytes();break}case 5:{S.timeReceived=_.string();break}default:{_.skipType(A&7);break}}}return S})),r),n.encode=_=>encodeMessage(_,n.codec()),n.decode=_=>decodeMessage$1(_,n.codec())})(Record$1||(Record$1={}));var MessageType;(function(n){n.PUT_VALUE="PUT_VALUE",n.GET_VALUE="GET_VALUE",n.ADD_PROVIDER="ADD_PROVIDER",n.GET_PROVIDERS="GET_PROVIDERS",n.FIND_NODE="FIND_NODE",n.PING="PING"})(MessageType||(MessageType={}));var __MessageTypeValues;(function(n){n[n.PUT_VALUE=0]="PUT_VALUE",n[n.GET_VALUE=1]="GET_VALUE",n[n.ADD_PROVIDER=2]="ADD_PROVIDER",n[n.GET_PROVIDERS=3]="GET_PROVIDERS",n[n.FIND_NODE=4]="FIND_NODE",n[n.PING=5]="PING"})(__MessageTypeValues||(__MessageTypeValues={}));(function(n){n.codec=()=>enumeration(__MessageTypeValues)})(MessageType||(MessageType={}));var ConnectionType;(function(n){n.NOT_CONNECTED="NOT_CONNECTED",n.CONNECTED="CONNECTED",n.CAN_CONNECT="CAN_CONNECT",n.CANNOT_CONNECT="CANNOT_CONNECT"})(ConnectionType||(ConnectionType={}));var __ConnectionTypeValues;(function(n){n[n.NOT_CONNECTED=0]="NOT_CONNECTED",n[n.CONNECTED=1]="CONNECTED",n[n.CAN_CONNECT=2]="CAN_CONNECT",n[n.CANNOT_CONNECT=3]="CANNOT_CONNECT"})(__ConnectionTypeValues||(__ConnectionTypeValues={}));(function(n){n.codec=()=>enumeration(__ConnectionTypeValues)})(ConnectionType||(ConnectionType={}));var PeerInfo;(function(n){let r;n.codec=()=>(r==null&&(r=message((_,E,S={})=>{if(S.lengthDelimited!==!1&&E.fork(),_.id!=null&&_.id.byteLength>0&&(E.uint32(10),E.bytes(_.id)),_.multiaddrs!=null)for(const C of _.multiaddrs)E.uint32(18),E.bytes(C);_.connection!=null&&(E.uint32(24),ConnectionType.codec().encode(_.connection,E)),S.lengthDelimited!==!1&&E.ldelim()},(_,E)=>{const S={id:alloc$1(0),multiaddrs:[]},C=E==null?_.len:_.pos+E;for(;_.pos<C;){const A=_.uint32();switch(A>>>3){case 1:{S.id=_.bytes();break}case 2:{S.multiaddrs.push(_.bytes());break}case 3:{S.connection=ConnectionType.codec().decode(_);break}default:{_.skipType(A&7);break}}}return S})),r),n.encode=_=>encodeMessage(_,n.codec()),n.decode=_=>decodeMessage$1(_,n.codec())})(PeerInfo||(PeerInfo={}));var Message$2;(function(n){let r;n.codec=()=>(r==null&&(r=message((_,E,S={})=>{if(S.lengthDelimited!==!1&&E.fork(),_.type!=null&&__MessageTypeValues[_.type]!==0&&(E.uint32(8),MessageType.codec().encode(_.type,E)),_.clusterLevel!=null&&(E.uint32(80),E.int32(_.clusterLevel)),_.key!=null&&(E.uint32(18),E.bytes(_.key)),_.record!=null&&(E.uint32(26),E.bytes(_.record)),_.closer!=null)for(const C of _.closer)E.uint32(66),PeerInfo.codec().encode(C,E);if(_.providers!=null)for(const C of _.providers)E.uint32(74),PeerInfo.codec().encode(C,E);S.lengthDelimited!==!1&&E.ldelim()},(_,E)=>{const S={type:MessageType.PUT_VALUE,closer:[],providers:[]},C=E==null?_.len:_.pos+E;for(;_.pos<C;){const A=_.uint32();switch(A>>>3){case 1:{S.type=MessageType.codec().decode(_);break}case 10:{S.clusterLevel=_.int32();break}case 2:{S.key=_.bytes();break}case 3:{S.record=_.bytes();break}case 8:{S.closer.push(PeerInfo.codec().decode(_,_.uint32()));break}case 9:{S.providers.push(PeerInfo.codec().decode(_,_.uint32()));break}default:{_.skipType(A&7);break}}}return S})),r),n.encode=_=>encodeMessage(_,n.codec()),n.decode=_=>decodeMessage$1(_,n.codec())})(Message$2||(Message$2={}));function sendQueryEvent(n,r={}){const _={...n,name:"SEND_QUERY",type:0,messageName:n.type,messageType:n.type};return r.onProgress?.(new CustomEvent$1("kad-dht:query:send-query",{detail:_})),_}function peerResponseEvent(n,r={}){const _={...n,name:"PEER_RESPONSE",type:1,messageName:n.messageType,closer:n.closer!=null?n.closer:[],providers:n.providers!=null?n.providers:[]};return r.onProgress?.(new CustomEvent$1("kad-dht:query:peer-response",{detail:_})),_}function finalPeerEvent(n,r={}){const _={...n,name:"FINAL_PEER",type:2};return r.onProgress?.(new CustomEvent$1("kad-dht:query:final-peer",{detail:_})),_}function queryErrorEvent(n,r={}){const _={...n,name:"QUERY_ERROR",type:3};return r.onProgress?.(new CustomEvent$1("kad-dht:query:query-error",{detail:_})),_}function providerEvent(n,r={}){const _={...n,name:"PROVIDER",type:4};return r.onProgress?.(new CustomEvent$1("kad-dht:query:provider",{detail:_})),_}function valueEvent(n,r={}){const _={...n,name:"VALUE",type:5};return r.onProgress?.(new CustomEvent$1("kad-dht:query:value",{detail:_})),_}function dialPeerEvent(n,r={}){const _={...n,name:"DIAL_PEER",type:7};return r.onProgress?.(new CustomEvent$1("kad-dht:query:dial-peer",{detail:_})),_}var Record;(function(n){let r;n.codec=()=>(r==null&&(r=message((_,E,S={})=>{S.lengthDelimited!==!1&&E.fork(),_.key!=null&&_.key.byteLength>0&&(E.uint32(10),E.bytes(_.key)),_.value!=null&&_.value.byteLength>0&&(E.uint32(18),E.bytes(_.value)),_.timeReceived!=null&&_.timeReceived!==""&&(E.uint32(42),E.string(_.timeReceived)),S.lengthDelimited!==!1&&E.ldelim()},(_,E)=>{const S={key:new Uint8Array(0),value:new Uint8Array(0),timeReceived:""},C=E==null?_.len:_.pos+E;for(;_.pos<C;){const A=_.uint32();switch(A>>>3){case 1:S.key=_.bytes();break;case 2:S.value=_.bytes();break;case 5:S.timeReceived=_.string();break;default:_.skipType(A&7);break}}return S})),r),n.encode=_=>encodeMessage(_,n.codec()),n.decode=_=>decodeMessage$1(_,n.codec())})(Record||(Record={}));function toRFC3339(n){const r=n.getUTCFullYear(),_=String(n.getUTCMonth()+1).padStart(2,"0"),E=String(n.getUTCDate()).padStart(2,"0"),S=String(n.getUTCHours()).padStart(2,"0"),C=String(n.getUTCMinutes()).padStart(2,"0"),A=String(n.getUTCSeconds()).padStart(2,"0"),I=n.getUTCMilliseconds(),B=String(I*1e3*1e3).padStart(9,"0");return`${r}-${_}-${E}T${S}:${C}:${A}.${B}Z`}function parseRFC3339$1(n){const r=new RegExp("(\\d{4})-(\\d{2})-(\\d{2})T(\\d{2}):(\\d{2}):(\\d{2})\\.(\\d+)Z"),_=String(n).trim().match(r);if(_==null)throw new Error("Invalid format");const E=parseInt(_[1],10),S=parseInt(_[2],10)-1,C=parseInt(_[3],10),A=parseInt(_[4],10),I=parseInt(_[5],10),B=parseInt(_[6],10),O=parseInt(_[7].slice(0,-6),10);return new Date(Date.UTC(E,S,C,A,I,B,O))}class Libp2pRecord{key;value;timeReceived;constructor(r,_,E){if(!(r instanceof Uint8Array))throw new Error("key must be a Uint8Array");if(!(_ instanceof Uint8Array))throw new Error("value must be a Uint8Array");this.key=r,this.value=_,this.timeReceived=E}serialize(){return Record.encode(this.prepareSerialize())}prepareSerialize(){return{key:this.key,value:this.value,timeReceived:toRFC3339(this.timeReceived)}}static deserialize(r){const _=Record.decode(r);return new Libp2pRecord(_.key,_.value,new Date(_.timeReceived))}static fromDeserialized(r){const _=parseRFC3339$1(r.timeReceived);if(r.key==null)throw new Error("key missing from deserialized object");if(r.value==null)throw new Error("value missing from deserialized object");return new Libp2pRecord(r.key,r.value,_)}}function bestRecord(n,r,_){if(_.length===0){const A="No records given";throw new CodeError$4(A,"ERR_NO_RECORDS_RECEIVED")}const S=toString$4(r).split("/");if(S.length<3){const A="Record key does not have a selector function";throw new CodeError$4(A,"ERR_NO_SELECTOR_FUNCTION_FOR_RECORD_KEY")}const C=n[S[1].toString()];if(C==null){const A=`No selector function configured for key type "${S[1]}"`;throw new CodeError$4(A,"ERR_UNRECOGNIZED_KEY_PREFIX")}return _.length===1?0:C(r,_)}function publickKey(n,r){return 0}const selectors={pk:publickKey};async function verifyRecord(n,r){const _=r.key,S=toString$4(_).split("/");if(S.length<3)return;const C=n[S[1].toString()];if(C==null){const A=`No validator available for key type "${S[1]}"`;throw new CodeError$4(A,"ERR_INVALID_RECORD_KEY_TYPE")}await C(_,r.value)}const validatePublicKeyRecord=async(n,r)=>{if(!(n instanceof Uint8Array))throw new CodeError$4('"key" must be a Uint8Array',"ERR_INVALID_RECORD_KEY_NOT_BUFFER");if(n.byteLength<5)throw new CodeError$4("invalid public key record","ERR_INVALID_RECORD_KEY_TOO_SHORT");if(toString$4(n.subarray(0,4))!=="/pk/")throw new CodeError$4("key was not prefixed with /pk/","ERR_INVALID_RECORD_KEY_BAD_PREFIX");const E=n.slice(4),S=await sha256$6.digest(r);if(!equals$1(E,S.bytes))throw new CodeError$4("public key does not match passed in key","ERR_INVALID_RECORD_HASH_MISMATCH")},validators={pk:validatePublicKeyRecord},PK_PREFIX=fromString$3("/pk/");function removePrivateAddressesMapper(n){return{...n,multiaddrs:n.multiaddrs.filter(r=>{const[[_,E]]=r.stringTuples();if(_===53||_===54||_===55)return E!=="localhost";if(_!==4&&_!==6||E==null)return!1;const S=isPrivateIp(E);return S==null?!0:!S})}}async function convertBuffer(n){return(await sha256$6.digest(n)).digest}async function convertPeerId(n){return convertBuffer(n.toBytes())}function bufferToRecordKey(n){return new Key(`${RECORD_KEY_PREFIX}/${toString$4(n,"base32")}`,!1)}function keyForPublicKey(n){return concat$4([PK_PREFIX,n.toBytes()])}function isPublicKeyKey(n){return toString$4(n.subarray(0,4))==="/pk/"}function fromPublicKeyKey(n){return peerIdFromBytes$1(n.subarray(4))}function createPutRecord(n,r){const _=new Date;return new Libp2pRecord(n,r,_).serialize()}function debounce$1(n,r=100){let _;return()=>{clearTimeout(_),_=setTimeout(()=>{n()},r)}}const P2P_CIRCUIT_CODE=290,DNS4_CODE=54,DNS6_CODE=55,DNSADDR_CODE=56,IP4_CODE=4,IP6_CODE=41;function multiaddrIsPublic(n){const r=n.stringTuples();for(const _ of r)if(_[0]===P2P_CIRCUIT_CODE)return!1;if(r[0][0]===DNS4_CODE||r[0][0]===DNS6_CODE||r[0][0]===DNSADDR_CODE)return!0;if(r[0][0]===IP4_CODE||r[0][0]===IP6_CODE){const _=isPrivateIp(`${r[0][1]}`);return _==null||!_}return!1}class ContentFetching{log;components;validators;selectors;peerRouting;queryManager;network;constructor(r,_){const{validators:E,selectors:S,peerRouting:C,queryManager:A,network:I,logPrefix:B}=_;this.components=r,this.log=r.logger.forComponent(`${B}:content-fetching`),this.validators=E,this.selectors=S,this.peerRouting=C,this.queryManager=A,this.network=I}async putLocal(r,_){const E=bufferToRecordKey(r);await this.components.datastore.put(E,_)}async getLocal(r){this.log("getLocal %b",r);const _=bufferToRecordKey(r);this.log("fetching record for key %k",_);const E=await this.components.datastore.get(_);this.log("found %k in local datastore",_);const S=Libp2pRecord.deserialize(E);return await verifyRecord(this.validators,S),S}async*sendCorrectionRecord(r,_,E,S={}){this.log("sendCorrection for %b",r);const C=createPutRecord(r,E);for(const{value:A,from:I}of _){if(equals$1(A,E)){this.log("record was ok");continue}if(this.components.peerId.equals(I)){try{const N=bufferToRecordKey(r);this.log(`Storing corrected record for key ${N.toString()}`),await this.components.datastore.put(N,C.subarray())}catch(N){this.log.error("Failed error correcting self",N)}continue}let B=!1;const O={type:MessageType.PUT_VALUE,key:r,record:C};for await(const N of this.network.sendRequest(I,O,S))N.name==="PEER_RESPONSE"&&N.record!=null&&equals$1(N.record.value,Libp2pRecord.deserialize(C).value)&&(B=!0),yield N;B||(yield queryErrorEvent({from:I,error:new CodeError$4("value not put correctly","ERR_PUT_VALUE_INVALID")},S)),this.log.error("Failed error correcting entry")}}async*put(r,_,E={}){this.log("put key %b value %b",r,_);const S=createPutRecord(r,_),C=bufferToRecordKey(r);this.log(`storing record for key ${C.toString()}`),await this.components.datastore.put(C,S.subarray()),yield*pipe(this.peerRouting.getClosestPeers(r,{signal:E.signal}),A=>map$1(A,I=>async()=>{if(I.name!=="FINAL_PEER")return[I];const B=[],O={type:MessageType.PUT_VALUE,key:r,record:S};this.log("send put to %p",I.peer.id);for await(const N of this.network.sendRequest(I.peer.id,O,E))B.push(N),N.name==="PEER_RESPONSE"&&(N.record!=null&&equals$1(N.record.value,Libp2pRecord.deserialize(S).value)||B.push(queryErrorEvent({from:I.peer.id,error:new CodeError$4("value not put correctly","ERR_PUT_VALUE_INVALID")},E)));return B}),A=>parallel(A,{ordered:!1,concurrency:ALPHA}),async function*(A){for await(const I of A)yield*I})}async*get(r,_={}){this.log("get %b",r);const E=[];for await(const I of this.getMany(r,_))I.name==="VALUE"&&E.push(I),yield I;if(E.length===0)return;const S=E.map(I=>I.value);let C=0;try{C=bestRecord(this.selectors,r,S)}catch(I){if(I.code!=="ERR_NO_SELECTOR_FUNCTION_FOR_RECORD_KEY")throw I}const A=S[C];if(this.log("GetValue %b %b",r,A),A==null)throw new CodeError$4("best value was not found","ERR_NOT_FOUND");yield*this.sendCorrectionRecord(r,E,A,_),yield E[C]}async*getMany(r,_={}){this.log("getMany values for %b",r);try{const C=await this.getLocal(r);yield valueEvent({value:C.value,from:this.components.peerId},_)}catch(C){this.log("error getting local value for %b",r,C)}const E=this,S=async function*({peer:C,signal:A}){for await(const I of E.peerRouting.getValueOrPeers(C,r,{signal:A}))yield I,I.name==="PEER_RESPONSE"&&I.record!=null&&(yield valueEvent({from:C,value:I.record.value},_))};yield*this.queryManager.run(r,S,_)}}function toPbPeerInfo(n,r){return{id:n.id.toBytes(),multiaddrs:(n.multiaddrs??[]).map(E=>E.bytes),connection:r}}function fromPbPeerInfo(n){if(n.id==null)throw new Error("Invalid peer in message");return{id:peerIdFromBytes$1(n.id),multiaddrs:(n.multiaddrs??[]).map(r=>multiaddr(r))}}class ContentRouting{log;components;network;peerRouting;queryManager;routingTable;providers;constructor(r,_){const{network:E,peerRouting:S,queryManager:C,routingTable:A,providers:I,logPrefix:B}=_;this.components=r,this.log=r.logger.forComponent(`${B}:content-routing`),this.network=E,this.peerRouting=S,this.queryManager=C,this.routingTable=A,this.providers=I}async*provide(r,_,E={}){this.log("provide %s",r),await this.providers.addProvider(r,this.components.peerId);const S={type:MessageType.ADD_PROVIDER,key:r.multihash.bytes,providers:[toPbPeerInfo({id:this.components.peerId,multiaddrs:_})]};let C=0;const A=I=>async()=>{if(I.name!=="FINAL_PEER")return[I];const B=[];this.log("putProvider %s to %p",r,I.peer.id);try{this.log("sending provider record for %s to %p",r,I.peer.id);for await(const O of this.network.sendMessage(I.peer.id,S,E))O.name==="PEER_RESPONSE"&&(this.log("sent provider record for %s to %p",r,I.peer.id),C++),B.push(O)}catch(O){this.log.error("error sending provide record to peer %p",I.peer.id,O),B.push(queryErrorEvent({from:I.peer.id,error:O},E))}return B};yield*pipe(this.peerRouting.getClosestPeers(r.multihash.bytes,E),I=>map$1(I,B=>A(B)),I=>parallel(I,{ordered:!1,concurrency:ALPHA}),async function*(I){for await(const B of I)yield*B}),this.log("sent provider records to %d peers",C)}async*findProviders(r,_){const E=this.routingTable.kBucketSize,S=r.multihash.bytes,C=this;this.log("findProviders %c",r);const A=await this.providers.getProviders(r);if(A.length>0){const O=[];for(const N of A.slice(0,E))try{const U=await this.components.peerStore.get(N);O.push({id:N,multiaddrs:U.addresses.map(({multiaddr:j})=>j)})}catch(U){if(U.code!=="ERR_NOT_FOUND")throw U;this.log("no peer store entry for %p",N)}yield peerResponseEvent({from:this.components.peerId,messageType:MessageType.GET_PROVIDERS,providers:O},_),yield providerEvent({from:this.components.peerId,providers:O},_)}if(A.length>=E)return;const I=async function*({peer:O,signal:N}){const U={type:MessageType.GET_PROVIDERS,key:S};yield*C.network.sendRequest(O,U,{..._,signal:N})},B=new PeerSet(A);for await(const O of this.queryManager.run(S,I,_))if(yield O,O.name==="PEER_RESPONSE"){this.log("Found %d provider entries for %c and %d closer peers",O.providers.length,r,O.closer.length);const N=[];for(const U of O.providers)B.has(U.id)||(B.add(U.id),N.push(U));if(N.length>0&&(yield providerEvent({from:O.from,providers:N},_)),B.size===E)return}}}class Network extends TypedEventEmitter{log;protocol;running;components;constructor(r,_){super();const{protocol:E}=_;this.components=r,this.log=r.logger.forComponent(`${_.logPrefix}:network`),this.running=!1,this.protocol=E}async start(){this.running||(this.running=!0)}async stop(){this.running=!1}isStarted(){return this.running}async*sendRequest(r,_,E={}){if(!this.running)return;const S=_.type;if(S==null)throw new CodeError$3("Message type was missing","ERR_INVALID_PARAMETERS");this.log("sending %s to %p",_.type,r),yield dialPeerEvent({peer:r},E),yield sendQueryEvent({to:r,type:S},E);try{const A=await(await this.components.connectionManager.openConnection(r,E)).newStream(this.protocol,E),I=await this._writeReadMessage(A,_,E);yield peerResponseEvent({from:r,messageType:I.type,closer:I.closer.map(fromPbPeerInfo),providers:I.providers.map(fromPbPeerInfo),record:I.record==null?void 0:Libp2pRecord.deserialize(I.record)},E)}catch(C){this.log.error("could not send %s to %p",_.type,r,C),yield queryErrorEvent({from:r,error:C},E)}finally{}}async*sendMessage(r,_,E={}){if(!this.running)return;const S=_.type;if(S==null)throw new CodeError$3("Message type was missing","ERR_INVALID_PARAMETERS");this.log("sending %s to %p",_.type,r),yield dialPeerEvent({peer:r},E),yield sendQueryEvent({to:r,type:S},E);try{const A=await(await this.components.connectionManager.openConnection(r,E)).newStream(this.protocol,E);await this._writeMessage(A,_,E),yield peerResponseEvent({from:r,messageType:S},E)}catch(C){yield queryErrorEvent({from:r,error:C},E)}finally{}}async _writeMessage(r,_,E){const S=pbStream(r);await S.write(_,Message$2,E),await S.unwrap().close(E)}async _writeReadMessage(r,_,E){const S=pbStream(r);await S.write(_,Message$2,E);const C=await S.read(Message$2,E);return await S.unwrap().close(E),C.closer.forEach(A=>{this.safeDispatchEvent("peer",{detail:fromPbPeerInfo(A)})}),C.providers.forEach(A=>{this.safeDispatchEvent("peer",{detail:fromPbPeerInfo(A)})}),C}}class PeerDistanceList{originDhtKey;capacity;peerDistances;constructor(r,_){this.originDhtKey=r,this.capacity=_,this.peerDistances=[]}get length(){return this.peerDistances.length}get peers(){return this.peerDistances.map(r=>r.peerId)}async add(r){if(this.peerDistances.find(S=>S.peerId.equals(r))!=null)return;const _=await convertPeerId(r),E={peerId:r,distance:xor(this.originDhtKey,_)};this.peerDistances.push(E),this.peerDistances.sort((S,C)=>compare(S.distance,C.distance)),this.peerDistances=this.peerDistances.slice(0,this.capacity)}async anyCloser(r){if(r.length===0)return!1;if(this.length===0)return!0;const _=await Promise.all(r.map(convertPeerId)),E=this.peerDistances[this.peerDistances.length-1].distance;for(const S of _){const C=xor(this.originDhtKey,S);if(compare(C,E)<0)return!0}return!1}}class PeerRouting{log;routingTable;network;validators;queryManager;peerStore;peerId;constructor(r,_){const{routingTable:E,network:S,validators:C,queryManager:A,logPrefix:I}=_;this.routingTable=E,this.network=S,this.validators=C,this.queryManager=A,this.peerStore=r.peerStore,this.peerId=r.peerId,this.log=r.logger.forComponent(`${I}:peer-routing`)}async findPeerLocal(r){let _;const E=await this.routingTable.find(r);if(E!=null){this.log("findPeerLocal found %p in routing table",r);try{_=await this.peerStore.get(E)}catch(S){if(S.code!=="ERR_NOT_FOUND")throw S}}if(_==null)try{_=await this.peerStore.get(r)}catch(S){if(S.code!=="ERR_NOT_FOUND")throw S}if(_!=null)return this.log("findPeerLocal found %p in peer store",r),{id:_.id,multiaddrs:_.addresses.map(S=>S.multiaddr)}}async*_getValueSingle(r,_,E={}){const S={type:MessageType.GET_VALUE,key:_};yield*this.network.sendRequest(r,S,E)}async*getPublicKeyFromNode(r,_={}){const E=keyForPublicKey(r);for await(const S of this._getValueSingle(r,E,_))if(yield S,S.name==="PEER_RESPONSE"&&S.record!=null){const C=await peerIdFromKeys$1(marshalPublicKey({bytes:S.record.value}));if(!C.equals(r))throw new CodeError$4("public key does not match id","ERR_PUBLIC_KEY_DOES_NOT_MATCH_ID");if(C.publicKey==null)throw new CodeError$4("public key missing","ERR_PUBLIC_KEY_MISSING");yield valueEvent({from:r,value:C.publicKey},_)}throw new CodeError$4(`Node not responding with its public key: ${r.toString()}`,"ERR_INVALID_RECORD")}async*findPeer(r,_={}){if(this.log("findPeer %p",r),_.useCache!==!1){const S=await this.findPeerLocal(r);if(S!=null){this.log("found local"),yield finalPeerEvent({from:this.peerId,peer:S},_);return}}let E=!1;if(_.useNetwork!==!1){const S=this,C=async function*({peer:A,signal:I}){const B={type:MessageType.FIND_NODE,key:r.toBytes()};for await(const O of S.network.sendRequest(A,B,{..._,signal:I}))if(yield O,O.name==="PEER_RESPONSE"){const N=O.closer.find(U=>U.id.equals(r));N!=null&&(yield finalPeerEvent({from:O.from,peer:N},_))}};for await(const A of this.queryManager.run(r.toBytes(),C,_))A.name==="FINAL_PEER"&&(E=!0),yield A}E||(yield queryErrorEvent({from:this.peerId,error:new CodeError$4("Not found","ERR_NOT_FOUND")},_))}async*getClosestPeers(r,_={}){this.log("getClosestPeers to %b",r);const E=await convertBuffer(r),S=this.routingTable.closestPeers(E),C=this,A=new PeerDistanceList(E,this.routingTable.kBucketSize);await Promise.all(S.map(async B=>{await A.add(B)}));const I=async function*({peer:B,signal:O}){C.log("closerPeersSingle %s from %p",toString$4(r,"base32"),B);const N={type:MessageType.FIND_NODE,key:r};yield*C.network.sendRequest(B,N,{..._,signal:O})};for await(const B of this.queryManager.run(r,I,_))yield B,B.name==="PEER_RESPONSE"&&await Promise.all(B.closer.map(async O=>{await A.add(O.id)}));this.log("found %d peers close to %b",A.length,r);for(const B of A.peers)try{const O=await this.peerStore.get(B);yield finalPeerEvent({from:this.peerId,peer:{id:B,multiaddrs:O.addresses.map(({multiaddr:N})=>N)}},_)}catch(O){if(O.code!=="ERR_NOT_FOUND")throw O}}async*getValueOrPeers(r,_,E={}){for await(const S of this._getValueSingle(r,_,E)){if(S.name==="PEER_RESPONSE"&&S.record!=null)try{await this._verifyRecordOnline(S.record)}catch{const A="invalid record received, discarded";this.log(A),yield queryErrorEvent({from:S.from,error:new CodeError$4(A,"ERR_INVALID_RECORD")},E);continue}yield S}}async _verifyRecordOnline(r){if(r.timeReceived==null)throw new CodeError$4("invalid record received","ERR_INVALID_RECORD");await verifyRecord(this.validators,new Libp2pRecord(r.key,r.value,r.timeReceived))}async getCloserPeersOffline(r,_){const E=await convertBuffer(r),S=this.routingTable.closestPeers(E),C=[];for(const A of S)if(!A.equals(_))try{const I=await this.peerStore.get(A);C.push({id:A,multiaddrs:I.addresses.map(({multiaddr:B})=>B)})}catch(I){if(I.code!=="ERR_NOT_FOUND")throw I}return C.length>0?this.log("getCloserPeersOffline found %d peer(s) closer to %b than %p",C.length,r,_):this.log("getCloserPeersOffline could not find peer closer to %b than %p",r,_),C}}var hashlru=function(n){if(!n)throw Error("hashlru must have a max value, of type number, greater than 0");var r=0,_=Object.create(null),E=Object.create(null);function S(C,A){_[C]=A,r++,r>=n&&(r=0,E=_,_=Object.create(null))}return{has:function(C){return _[C]!==void 0||E[C]!==void 0},remove:function(C){_[C]!==void 0&&(_[C]=void 0),E[C]!==void 0&&(E[C]=void 0)},get:function(C){var A=_[C];if(A!==void 0)return A;if((A=E[C])!==void 0)return S(C,A),A},set:function(C,A){_[C]!==void 0?_[C]=A:S(C,A)},clear:function(){_=Object.create(null),E=Object.create(null)}}};const hashlru$1=getDefaultExportFromCjs(hashlru);class Providers{log;datastore;cache;cleanupInterval;provideValidity;syncQueue;started;cleaner;constructor(r,_={}){const{cacheSize:E,cleanupInterval:S,provideValidity:C}=_;this.log=r.logger.forComponent("libp2p:kad-dht:providers"),this.datastore=r.datastore,this.cleanupInterval=S??PROVIDERS_CLEANUP_INTERVAL,this.provideValidity=C??PROVIDERS_VALIDITY,this.cache=hashlru$1(E??PROVIDERS_LRU_CACHE_SIZE),this.syncQueue=new PQueue$1({concurrency:1}),this.started=!1}isStarted(){return this.started}async start(){this.started||(this.started=!0,this.cleaner=setInterval(()=>{this._cleanup().catch(r=>{this.log.error(r)})},this.cleanupInterval))}async stop(){this.started=!1,this.cleaner!=null&&(clearInterval(this.cleaner),this.cleaner=void 0)}async _cleanup(){await this.syncQueue.add(async()=>{const r=Date.now();let _=0,E=0;const S=new Map,C=this.datastore.batch(),A=this.datastore.query({prefix:PROVIDER_KEY_PREFIX});for await(const I of A)try{const{cid:B,peerId:O}=parseProviderKey(I.key),N=readTime(I.value).getTime(),U=Date.now(),j=U-N,z=j>this.provideValidity;if(this.log("comparing: %d - %d = %d > %d %s",U,N,j,this.provideValidity,z?"(expired)":""),z){E++,C.delete(I.key);const Z=S.get(B)??new Set;Z.add(O),S.set(B,Z)}_++}catch(B){this.log.error(B.message)}S.size>0?(this.log("deleting %d / %d entries",E,_),await C.commit()):this.log("nothing to delete");for(const[I,B]of S){const O=makeProviderKey(I),N=this.cache.get(O);if(N!=null){for(const U of B)N.delete(U);N.size===0?this.cache.remove(O):this.cache.set(O,N)}}this.log("Cleanup successful (%dms)",Date.now()-r)})}async _getProvidersMap(r){const _=makeProviderKey(r);let E=this.cache.get(_);return E==null&&(E=await loadProviders(this.datastore,r),this.cache.set(_,E)),E}async addProvider(r,_){await this.syncQueue.add(async()=>{this.log("%p provides %s",_,r);const E=await this._getProvidersMap(r);this.log("loaded %s provs",E.size);const S=new Date;E.set(_.toString(),S);const C=makeProviderKey(r);this.cache.set(C,E),await writeProviderEntry(this.datastore,r,_,S)})}async getProviders(r){return this.syncQueue.add(async()=>(this.log("get providers for %s",r),[...(await this._getProvidersMap(r)).keys()].map(E=>peerIdFromString$1(E))),{throwOnTimeout:!0})}}function makeProviderKey(n){const r=typeof n=="string"?n:toString$4(n.multihash.bytes,"base32");return`${PROVIDER_KEY_PREFIX}/${r}`}async function writeProviderEntry(n,r,_,E){const S=[makeProviderKey(r),"/",_.toString()].join(""),C=new Key(S),A=encode$b(E.getTime());await n.put(C,A)}function parseProviderKey(n){const r=n.toString().split("/");if(r.length!==5)throw new Error(`incorrectly formatted provider entry key in datastore: ${n.toString()}`);return{cid:r[3],peerId:r[4]}}async function loadProviders(n,r){const _=new Map,E=n.query({prefix:makeProviderKey(r)});for await(const S of E){const{peerId:C}=parseProviderKey(S.key);_.set(C,readTime(S.value))}return _}function readTime(n){return new Date(decode$b(n))}async function*queueToGenerator(n,r,_,E){const S=pushable$1({objectMode:!0}),C=U=>{E("clean up queue, results %d, queue size %d, pending tasks %d",S.readableLength,n.size,n.pending),n.clear(),S.end(U)},A=U=>{U!=null&&S.push(U)},I=U=>{E("queue error",U),C(U)},B=()=>{E("queue idle"),C()},O=()=>{E("abort queue"),C(new CodeError$4("Query aborted","ERR_QUERY_ABORTED"))},N=()=>{C()};n.on("completed",A),n.on("error",I),n.on("idle",B),r.addEventListener("abort",O),_.addEventListener("cleanup",N);try{yield*S}finally{n.removeListener("completed",A),n.removeListener("error",I),n.removeListener("idle",B),r.removeEventListener("abort",O),_.removeEventListener("cleanup",N)}}const MAX_XOR=BigInt("0xFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF");async function*queryPath(n){const{key:r,startingPeer:_,ourPeerId:E,signal:S,query:C,alpha:A,pathIndex:I,numPaths:B,cleanUp:O,queryFuncTimeout:N,log:U,peersSeen:j}=n,z=new PQueue$1({concurrency:A}),Z=await convertBuffer(r);function X(Q,se){if(Q==null)return;j.add(Q);const oe=BigInt("0x"+toString$4(xor(se,Z),"base16"));z.add(async()=>{const ue=[S];N!=null&&ue.push(AbortSignal.timeout(N));const we=anySignal(ue);try{for await(const Te of C({key:r,peer:Q,signal:we,pathIndex:I,numPaths:B})){if(we.aborted)return;if(Te.name==="PEER_RESPONSE")for(const xe of Te.closer){if(j.has(xe.id)){U("already seen %p in query",xe.id);continue}if(E.equals(xe.id)){U("not querying ourselves");continue}const Re=await convertPeerId(xe.id);if(BigInt("0x"+toString$4(xor(Re,Z),"base16"))>oe){U("skipping %p as they are not closer to %b than %p",xe.id,r,Q);continue}U("querying closer peer %p",xe.id),X(xe.id,Re)}z.emit("completed",Te)}}catch(Te){if(!S.aborted)return queryErrorEvent({from:Q,error:Te},n)}finally{we.clear()}},{priority:MAX_XOR-oe}).catch(ue=>{U.error(ue)})}X(_,await convertPeerId(_)),yield*queueToGenerator(z,S,O,U)}class QueryManager{disjointPaths;alpha;shutDownController;running;queries;logger;peerId;routingTable;initialQuerySelfHasRun;logPrefix;metrics;constructor(r,_){const{disjointPaths:E=K,alpha:S=ALPHA,logPrefix:C}=_;this.logPrefix=C,this.disjointPaths=E??K,this.running=!1,this.alpha=S??ALPHA,this.queries=0,this.initialQuerySelfHasRun=_.initialQuerySelfHasRun,this.routingTable=_.routingTable,this.logger=r.logger,this.peerId=r.peerId,r.metrics!=null&&(this.metrics={runningQueries:r.metrics.registerMetric(`${C.replaceAll(":","_")}_running_queries`),queryTime:r.metrics.registerMetric(`${C.replaceAll(":","_")}_query_time_seconds`)}),this.shutDownController=new AbortController,setMaxListeners$2(1/0,this.shutDownController.signal)}isStarted(){return this.running}async start(){this.running=!0}async stop(){this.running=!1,this.shutDownController.abort()}async*run(r,_,E={}){if(!this.running)throw new Error("QueryManager not started");const S=this.metrics?.queryTime.timer();if(E.signal==null){const U=AbortSignal.timeout(DEFAULT_QUERY_TIMEOUT);setMaxListeners$2(1/0,U),E={...E,signal:U}}const C=new AbortController;setMaxListeners$2(1/0,C.signal);const A=anySignal([this.shutDownController.signal,C.signal,E.signal]);setMaxListeners$2(1/0,A);const I=this.logger.forComponent(`${this.logPrefix}:query:`+toString$4(r,"base58btc")),B=Date.now(),O=new TypedEventEmitter;let N=!1;try{E.isSelfQuery!==!0&&this.initialQuerySelfHasRun!=null&&(I("waiting for initial query-self query before continuing"),await raceSignal(this.initialQuerySelfHasRun.promise,A),this.initialQuerySelfHasRun=void 0),I("query:start"),this.queries++,this.metrics?.runningQueries.update(this.queries);const U=await convertBuffer(r),j=this.routingTable.closestPeers(U),z=j.slice(0,Math.min(this.disjointPaths,j.length));if(j.length===0){I.error("Running query with no peers");return}const Z=new PeerSet,X=z.map((Q,se)=>queryPath({key:r,startingPeer:Q,ourPeerId:this.peerId,signal:A,query:_,pathIndex:se,numPaths:z.length,alpha:this.alpha,cleanUp:O,queryFuncTimeout:E.queryFuncTimeout,log:I,peersSeen:Z,onProgress:E.onProgress}));for await(const Q of merge$1(...X))Q.name==="QUERY_ERROR"&&I.error("query error",Q.error),yield Q;N=!0}catch(U){if(!(!this.running&&U.code==="ERR_QUERY_ABORTED"))throw U}finally{N||(I("query exited early"),C.abort()),A.clear(),this.queries--,this.metrics?.runningQueries.update(this.queries),S?.(),O.dispatchEvent(new CustomEvent$1("cleanup")),I("query:done in %dms",Date.now()-B)}}}function isAsyncIterable(n){return n[Symbol.asyncIterator]!=null}function length(n){if(isAsyncIterable(n))return(async()=>{let r=0;for await(const _ of n)r++;return r})();{let r=0;for(const _ of n)r++;return r}}const normalizeEmitter=n=>{const r=n.addEventListener||n.on||n.addListener,_=n.removeEventListener||n.off||n.removeListener;if(!r||!_)throw new TypeError("Emitter is not compatible");return{addListener:r.bind(n),removeListener:_.bind(n)}};function pEventMultiple(n,r,_){let E;const S=new Promise((C,A)=>{if(_={rejectionEvents:["error"],multiArgs:!1,resolveImmediately:!1,..._},!(_.count>=0&&(_.count===Number.POSITIVE_INFINITY||Number.isInteger(_.count))))throw new TypeError("The `count` option should be at least 0 or more");_.signal?.throwIfAborted();const I=[r].flat(),B=[],{addListener:O,removeListener:N}=normalizeEmitter(n),U=(...z)=>{const Z=_.multiArgs?z:z[0];_.filter&&!_.filter(Z)||(B.push(Z),_.count===B.length&&(E(),C(B)))},j=z=>{E(),A(z)};E=()=>{for(const z of I)N(z,U);for(const z of _.rejectionEvents)N(z,j)};for(const z of I)O(z,U);for(const z of _.rejectionEvents)O(z,j);_.signal&&_.signal.addEventListener("abort",()=>{j(_.signal.reason)},{once:!0}),_.resolveImmediately&&C(B)});if(S.cancel=E,typeof _.timeout=="number"){const C=pTimeout$1(S,{milliseconds:_.timeout});return C.cancel=E,C}return S}function pEvent(n,r,_){typeof _=="function"&&(_={filter:_}),_={..._,count:1,resolveImmediately:!1};const E=pEventMultiple(n,r,_),S=E.then(C=>C[0]);return S.cancel=E.cancel,S}class QuerySelf{log;peerId;peerRouting;routingTable;count;interval;initialInterval;queryTimeout;started;timeoutId;controller;initialQuerySelfHasRun;querySelfPromise;constructor(r,_){const{peerRouting:E,logPrefix:S,count:C,interval:A,queryTimeout:I,routingTable:B}=_;this.peerId=r.peerId,this.log=r.logger.forComponent(`${S}:query-self`),this.started=!1,this.peerRouting=E,this.routingTable=B,this.count=C??K,this.interval=A??QUERY_SELF_INTERVAL,this.initialInterval=_.initialInterval??QUERY_SELF_INITIAL_INTERVAL,this.queryTimeout=I??QUERY_SELF_TIMEOUT,this.initialQuerySelfHasRun=_.initialQuerySelfHasRun}isStarted(){return this.started}start(){this.started||(this.started=!0,clearTimeout(this.timeoutId),this.timeoutId=setTimeout(()=>{this.querySelf().catch(r=>{this.log.error("error running self-query",r)})},this.initialInterval))}stop(){this.started=!1,this.timeoutId!=null&&clearTimeout(this.timeoutId),this.controller!=null&&this.controller.abort()}async querySelf(){if(!this.started){this.log("skip self-query because we are not started");return}if(this.querySelfPromise!=null)return this.log("joining existing self query"),this.querySelfPromise.promise;if(this.querySelfPromise=pDefer(),this.started){this.controller=new AbortController;const r=anySignal([this.controller.signal,AbortSignal.timeout(this.queryTimeout)]);setMaxListeners$2(1/0,r);try{this.routingTable.size===0&&(this.log("routing table was empty, waiting for some peers before running query"),await pEvent(this.routingTable,"peer:add",{signal:r})),this.log("run self-query, look for %d peers timing out after %dms",this.count,this.queryTimeout);const _=Date.now(),E=await pipe(this.peerRouting.getClosestPeers(this.peerId.toBytes(),{signal:r,isSelfQuery:!0}),S=>take(S,this.count),async S=>length(S));this.log("self-query found %d peers in %dms",E,Date.now()-_)}catch(_){this.log.error("self-query error",_)}finally{r.clear(),this.initialQuerySelfHasRun!=null&&(this.initialQuerySelfHasRun.resolve(),this.initialQuerySelfHasRun=void 0)}}this.querySelfPromise.resolve(),this.querySelfPromise=void 0,this.started&&(this.timeoutId=setTimeout(()=>{this.querySelf().catch(r=>{this.log.error("error running self-query",r)})},this.interval))}}function arrayEquals(n,r){if(n===r)return!0;if(n.length!==r.length)return!1;for(let _=0,E=n.length;_<E;++_)if(n[_]!==r[_])return!1;return!0}function createNode(){return{contacts:[],dontSplit:!1,left:null,right:null}}function ensureInt8(n,r){if(!(r instanceof Uint8Array))throw new TypeError(n+" is not a Uint8Array")}class KBucket extends TypedEventEmitter{localNodeId;root;numberOfNodesPerKBucket;numberOfNodesToPing;distance;arbiter;constructor(r){super(),this.localNodeId=r.localNodeId,this.numberOfNodesPerKBucket=r.numberOfNodesPerKBucket??20,this.numberOfNodesToPing=r.numberOfNodesToPing??3,this.distance=r.distance??KBucket.distance,this.arbiter=r.arbiter??KBucket.arbiter,ensureInt8("option.localNodeId as parameter 1",this.localNodeId),this.root=createNode()}static arbiter(r,_){return(r.vectorClock??0)>(_.vectorClock??0)?r:_}static distance(r,_){let E=0,S=0;const C=Math.min(r.length,_.length),A=Math.max(r.length,_.length);for(;S<C;++S)E=E*256+(r[S]^_[S]);for(;S<A;++S)E=E*256+255;return E}add(r){ensureInt8("contact.id",r?.id);let _=0,E=this.root;for(;E.contacts===null;)E=this._determineNode(E,r.id,_++);const S=this._indexOf(E,r.id);return S>=0?(this._update(E,S,r),this):E.contacts.length<this.numberOfNodesPerKBucket?(E.contacts.push(r),this.safeDispatchEvent("added",{detail:r}),this):E.dontSplit?(this.safeDispatchEvent("ping",{detail:{oldContacts:E.contacts.slice(0,this.numberOfNodesToPing),newContact:r}}),this):(this._split(E,_),this.add(r))}closest(r,_=1/0){if(ensureInt8("id",r),!Number.isInteger(_)&&_!==1/0||_<=0)throw new TypeError("n is not positive number");let E=[];for(let S=[this.root],C=0;S.length>0&&E.length<_;){const A=S.pop();if(A!=null)if(A.contacts===null){const I=this._determineNode(A,r,C++);S.push(A.left===I?A.right:A.left),S.push(I)}else E=E.concat(A.contacts)}return E.map(S=>({distance:this.distance(S.id,r),contact:S})).sort((S,C)=>S.distance-C.distance).slice(0,_).map(S=>S.contact)}count(){let r=0;for(const _=[this.root];_.length>0;){const E=_.pop();E!=null&&(E.contacts===null?_.push(E.right,E.left):r+=E.contacts.length)}return r}_determineNode(r,_,E){const S=E>>3,C=E%8;return _.length<=S&&C!==0?r.left:_[S]&1<<7-C?r.right:r.left}get(r){ensureInt8("id",r);let _=0,E=this.root;for(;E.contacts===null;)E=this._determineNode(E,r,_++);const S=this._indexOf(E,r);return S>=0?E.contacts[S]:void 0}_indexOf(r,_){for(let E=0;E<r.contacts.length;++E)if(arrayEquals(r.contacts[E].id,_))return E;return-1}remove(r){ensureInt8("the id as parameter 1",r);let _=0,E=this.root;for(;E.contacts===null;)E=this._determineNode(E,r,_++);const S=this._indexOf(E,r);if(S>=0){const C=E.contacts.splice(S,1)[0];this.safeDispatchEvent("removed",{detail:C})}return this}_split(r,_){r.left=createNode(),r.right=createNode();for(const C of r.contacts)this._determineNode(r,C.id,_).contacts.push(C);r.contacts=null;const E=this._determineNode(r,this.localNodeId,_),S=r.left===E?r.right:r.left;S.dontSplit=!0}toArray(){let r=[];for(const _=[this.root];_.length>0;){const E=_.pop();E!=null&&(E.contacts===null?_.push(E.right,E.left):r=r.concat(E.contacts))}return r}*toIterable(){for(const r=[this.root];r.length>0;){const _=r.pop();_!=null&&(_.contacts===null?r.push(_.right,_.left):yield*_.contacts)}}_update(r,_,E){if(!arrayEquals(r.contacts[_].id,E.id))throw new Error("wrong index for _update");const S=r.contacts[_],C=this.arbiter(S,E);C===S&&S!==E||(r.contacts.splice(_,1),r.contacts.push(C),this.safeDispatchEvent("updated",{detail:{incumbent:S,selection:C}}))}}const KAD_CLOSE_TAG_NAME="kad-close",KAD_CLOSE_TAG_VALUE=50,KBUCKET_SIZE=20,PING_TIMEOUT=1e4,PING_CONCURRENCY=10;class RoutingTable extends TypedEventEmitter{kBucketSize;kb;pingQueue;log;components;pingTimeout;pingConcurrency;running;protocol;tagName;tagValue;metrics;constructor(r,_){super();const{kBucketSize:E,pingTimeout:S,logPrefix:C,pingConcurrency:A,protocol:I,tagName:B,tagValue:O}=_;this.components=r,this.log=r.logger.forComponent(`${C}:routing-table`),this.kBucketSize=E??KBUCKET_SIZE,this.pingTimeout=S??PING_TIMEOUT,this.pingConcurrency=A??PING_CONCURRENCY,this.running=!1,this.protocol=I,this.tagName=B??KAD_CLOSE_TAG_NAME,this.tagValue=O??KAD_CLOSE_TAG_VALUE,this.pingQueue=new PeerQueue({concurrency:this.pingConcurrency,metricName:`${C.replaceAll(":","_")}_ping_queue`,metrics:this.components.metrics}),this.pingQueue.addEventListener("error",N=>{this.log.error("error pinging peer",N.detail)}),this.components.metrics!=null&&(this.metrics={routingTableSize:this.components.metrics.registerMetric(`${C.replaceAll(":","_")}_routing_table_size`)})}isStarted(){return this.running}async start(){this.running=!0;const r=new KBucket({localNodeId:await convertPeerId(this.components.peerId),numberOfNodesPerKBucket:this.kBucketSize,numberOfNodesToPing:1});this.kb=r,r.addEventListener("ping",_=>{this._onPing(_).catch(E=>{this.log.error("could not process k-bucket ping event",E)})}),this._tagPeers(r)}async stop(){this.running=!1,this.pingQueue.clear(),this.kb=void 0}_tagPeers(r){let _=new PeerSet;const E=debounce$1(()=>{const S=new PeerSet(r.closest(r.localNodeId,KBUCKET_SIZE).map(I=>I.peer)),C=S.difference(_),A=_.difference(S);Promise.resolve().then(async()=>{for(const I of C)await this.components.peerStore.merge(I,{tags:{[this.tagName]:{value:this.tagValue}}});for(const I of A)await this.components.peerStore.merge(I,{tags:{[this.tagName]:void 0}})}).catch(I=>{this.log.error("Could not update peer tags",I)}),_=S});r.addEventListener("added",S=>{E(),this.safeDispatchEvent("peer:add",{detail:S.detail.peer})}),r.addEventListener("removed",S=>{E(),this.safeDispatchEvent("peer:remove",{detail:S.detail.peer})})}async _onPing(r){if(!this.running)return;const{oldContacts:_,newContact:E}=r.detail,C=(await Promise.all(_.map(async A=>{const I=this.pingQueue.find(A.peer);return I!=null?I.join():this.pingQueue.add(async()=>{let B;try{const O={signal:AbortSignal.timeout(this.pingTimeout)};this.log("pinging old contact %p",A.peer),B=await(await this.components.connectionManager.openConnection(A.peer,O)).newStream(this.protocol,O);const U=pbStream(B);await U.write({type:MessageType.PING},Message$2,O);const j=await U.read(Message$2,O);if(await U.unwrap().close(),j.type!==MessageType.PING)throw new CodeError$4(`Incorrect message type received, expected PING got ${j.type}`,"ERR_BAD_PING_RESPONSE");return!0}catch(O){return this.running&&this.kb!=null&&(this.log.error("could not ping peer %p",A.peer,O),this.log("evicting old contact after ping failed %p",A.peer),this.kb.remove(A.id)),B?.abort(O),!1}finally{this.metrics?.routingTableSize.update(this.size)}},{peerId:A.peer})}))).filter(A=>A).length;this.running&&C<_.length&&this.kb!=null&&(this.log("adding new contact %p",E.peer),this.kb.add(E))}get size(){return this.kb==null?0:this.kb.count()}async find(r){const _=await convertPeerId(r),E=this.closestPeer(_);if(E!=null&&r.equals(E))return E}closestPeer(r){const _=this.closestPeers(r,1);if(_.length>0)return _[0]}closestPeers(r,_=this.kBucketSize){return this.kb==null?[]:this.kb.closest(r,_).map(S=>S.peer)}async add(r){if(this.kb==null)throw new Error("RoutingTable is not started");const _=await convertPeerId(r);this.kb.add({id:_,peer:r}),this.log("added %p with kad id %b",r,_),this.metrics?.routingTableSize.update(this.size)}async remove(r){if(this.kb==null)throw new Error("RoutingTable is not started");const _=await convertPeerId(r);this.kb.remove(_),this.metrics?.routingTableSize.update(this.size)}}const GENERATED_PREFIXES=[77591,22417,43971,28421,740,29829,71467,228973,196661,78537,27689,36431,44415,14362,19456,106025,96308,2882,49509,21149,87173,131409,75844,23676,121838,30291,17492,2953,7564,110620,129477,127283,53113,72417,165166,109690,21200,102125,24049,71504,90342,25307,72039,26812,26715,32264,133800,71161,88956,171987,51779,24425,16671,30251,186294,247761,14202,2121,8465,35024,4876,85917,169730,3638,256836,96184,943,18678,6583,52907,35807,112254,214097,18796,11595,9243,23554,887,268203,382004,24590,111335,11625,16619,29039,102425,69006,97976,92362,32552,63717,41433,128974,137630,59943,10019,13986,35430,33665,108037,43799,43280,38195,29078,58629,18265,14425,46832,235538,40830,77881,110717,58937,3463,325358,51300,47623,117252,19007,10170,20540,91237,294813,4951,79841,56232,36270,128547,69209,66275,100156,32063,73531,34439,80937,28892,44466,88595,216307,32583,49620,16605,82127,45807,21630,78726,20235,40163,111007,96926,5567,72083,21665,58844,39419,179767,48328,42662,51550,5251,37811,49608,81056,50854,55513,20922,18891,197409,164656,32593,71449,220474,58919,85682,67854,13758,35066,3565,61905,214793,119572,141419,21504,10302,27354,67003,46131,32668,15165,64871,34450,17821,2757,11452,34189,5160,12257,85523,560,53385,65887,119549,135620,312353,115979,122356,10867,193231,124537,54783,90675,120791,4715,142253,50943,17271,43358,25331,4917,120566,34580,12878,33786,160528,32523,4869,301307,104817,81491,23276,8832,97911,31265,52065,7998,49622,9715,43998,34091,84587,20664,69041,29419,53205,10838,58288,116145,6185,5154,141795,35924,21307,144738,43730,12085,8279,10002,119,133779,199668,72938,31768,39176,67875,38453,9700,44144,4121,116048,41733,12868,82669,92308,128,34262,11332,7712,90764,36141,13553,71312,77470,117314,96549,49135,23602,54468,28605,6327,62308,17171,67531,21319,14105,894,107722,46157,8503,51069,100472,45138,15246,14577,35609,191464,1757,13364,161349,32067,91705,81144,52339,5408,91066,21983,14157,100545,4372,26630,129112,1423,29676,213626,4397,88436,99190,6877,49958,26122,114348,60661,29818,293118,50042,179738,16400,163423,89627,31040,43973,36638,45952,5153,1894,109322,1898,134021,12402,112077,68309,190269,69866,31938,107383,11522,105232,11248,14868,39852,71707,186525,16530,38162,106212,11700,5130,16608,26998,59586,108399,230033,43683,48135,82179,2073,5015,196684,189293,16378,23452,8301,35640,11632,214551,29240,57644,33137,91949,55157,52384,117313,5090,17717,89668,49363,82238,241035,66216,29066,184088,97206,62820,26595,4241,135635,173672,8202,459,71355,146294,29587,3008,135385,141203,14803,6634,45094,69362,50925,546,51884,62011,83296,234584,44515,56050,89476,87751,19373,12691,149923,19794,13833,35846,87557,58339,2884,19145,25647,12224,11024,77338,64608,122297,53025,7205,36189,36294,170779,21750,7739,173883,75192,35664,224240,113121,30181,26267,27036,117827,92015,106516,55628,203549,67949,60462,60844,35911,20457,1820,920,19773,8738,73173,181993,38521,98254,76257,46008,92796,5384,26868,151566,22124,2411,15919,186872,180021,28099,152961,78811,80237,62352,102653,74259,184890,16792,123702,224945,29940,19512,75283,14059,112691,92811,233329,20411,138569,53341,109802,50600,134528,66747,5529,166531,31578,64732,67189,1596,126357,967,167999,206598,109752,119431,207825,78791,91938,10301,27311,24233,252343,28831,32812,66002,112267,90895,8786,8095,16824,22866,21813,60507,174833,19549,130985,117051,52110,6938,81923,123864,38061,919,18680,53534,46739,112893,161529,85429,26761,11900,81121,91968,15390,217947,56524,1713,6654,37089,85630,138866,61850,16491,75577,16884,98296,73523,6140,44645,6062,36366,29844,57946,37932,42472,5266,20834,19309,33753,127182,134259,35810,41805,45878,312001,14881,47757,49251,120050,44252,3708,25856,107864,120347,1228,36550,41682,34496,47025,8393,173365,246526,12894,161607,35670,90785,126572,2095,124731,157033,58694,554,12786,9642,4817,16136,47864,174698,66992,4639,69284,10625,40710,27763,51738,30404,264105,137904,109882,52487,42824,57514,2740,10479,146799,107390,16586,88038,174951,9410,16185,44158,5568,40658,46108,12763,97385,26175,108859,664,230732,67470,46663,14395,50750,141320,93140,15361,47997,55784,6791,307840,118569,107326,18056,58281,260415,54691,8790,73332,45633,7511,45674,143373,14031,11799,94491,35646,96544,14560,26049,32983,25791,83814,42094,231370,63955,139212,2359,169908,3108,183486,105867,28197,32941,124968,26402,88267,149768,23053,3078,19091,52924,25383,19209,111548,97361,3959,24880,235061,9099,24921,161254,151405,20508,7159,34381,20133,11434,74036,19974,34769,36585,1076,22454,17354,38727,235160,111547,96454,117448,156940,91330,37299,7310,26915,117060,51369,22620,61861,322264,106850,111694,15091,2624,40345,300446,177064,1707,27389,54792,327783,132669,183543,59003,17744,20603,151134,106923,53084,71803,279424,319816,11579,21946,16728,38274,72711,5085,83391,88646,40159,25027,34680,10752,12988,54126,30365,18338,100445,230674,44874,84974,143877,123253,139372,28082,91477,144002,13096,219729,46016,50029,42377,14601,6660,58244,58978,23918,88206,113611,64452,17541,41032,10942,12021,49189,10978,40175,37156,10947,71709,106894,112538,57007,137486,150608,152719,40615,7746,279716,13101,19524,28708,40578,72320,1096,182051,94527,51275,22833,45164,81917,77519,48508,5421,140302,37845,149830,5587,27579,5357,428725,248187,6326,206760,39814,32585,89923,44341,288753,284443,96368,31201,94189,119504,20359,52073,103216,179,27934,32801,96035,34111,34309,101326,18198,20704,210266,37643,27880,141873,106e3,19414,56614,167714,66483,107885,86602,4379,20796,75467,4987,5017,118857,26003,34308,114428,29198,6686,29697,73632,3739,69795,16798,41504,7207,30722,21436,36735,28067,28545,3239,11221,36031,41889,100010,19247,317673,29495,174554,6424,129725,53845,94986,7955,59676,2604,191497,19735,102214,62954,23844,11872,179525,261436,34492,428,78404,142035,16747,17246,27578,37021,33672,57944,26056,135760,2369,61674,122066,31327,19374,157065,40553,130982,69619,71290,38855,72100,92903,95940,51422,165999,65713,57873,50726,7288,20272,2081,42326,22624,81120,57914,79352,19447,1684,72302,11774,302559,161481,96396,13692,414988,3721,79066,56627,46883,21150,11747,12184,5856,113458,176117,84416,52079,27933,3354,59765,141359,2212,216309,2555,23458,196722,142463,45701,44548,28798,19418,215,29916,9396,10574,114226,84475,13520,18694,34056,4524,90302,62930,13539,19407,77209,7728,38088,9535,2263,23875,183945,17750,26274,67172,10585,28042,22199,7478,51331,66030,26774,192929,31434,25850,50197,52926,178158,4679,181256,70184,229600,9959,105594,72158,73974,2726,35085,78087,23284,35568,51713,155676,5401,27254,11966,17569,223253,71993,103357,111477,55722,30504,26034,46774,35392,36285,214814,41143,163465,1051,16094,81044,6636,76489,179102,20712,39178,35683,125177,54219,30617,52994,25324,50123,2543,87529,58995,10688,125199,12388,60158,125481,131646,7642,133350,65874,3438,97277,101450,10075,56344,116821,50778,60547,98016,106135,13859,14255,16300,77373,173521,8285,45932,37426,4054,114295,55947,7703,39114,52,51119,128135,19714,60715,9554,50492,88180,2823,118271,52993,122625,97919,23859,37895,25040,33614,32102,20431,3577,9275,15686,43031,157741,110358,1884,40291,125391,13736,5008,64881,87336,77381,70711,43032,49155,118587,70494,4318,10168,30126,12580,10524,280104,104001,145413,2862,84140,6603,106005,13566,12780,11251,42830,571,179910,82443,13146,469,42714,32591,265217,424024,92553,54721,134100,6007,15242,114681,59030,16718,85465,200214,85982,55174,165013,23493,56964,82529,109150,32706,27568,82442,5350,14976,13165,44890,60021,21343,33978,17264,4655,22328,27819,75730,16567,55483,14510,17926,45827,150609,3704,7385,272531,161543,76904,122163,52405,2039,19165,41623,14423,228354,3369,176360,85491,7122,35789,303724,4465,13628,2233,55311,118771,20713,10006,221519,45115,71021,35650,29775,7337,10864,20665,21142,1746,15080,1624,32449,10905,105743,229797,7701,3940,22997,178467,57208,389057,39683,59403,63344,63125,54847,69691,18336,56448,3362,37202,18282,29648,138224,35867,10495,5911,28814,26653,31514,176702,26550,45621,11734,4525,40543,73944,121080,27858,155561,14887,44670,30742,8796,107455,113472,56369,75581,183777,240095,133699,153299,8768,160464,26058,49078,103971,21875,71486,44888,17156,9678,89541,123019,102337,3972,83930,21245,87852,109660,287918,183019,686,10100,39177,283941,11274,24736,26793,26214,25995,77011,141580,4070,23742,46285,46632,30700,26669,19056,35951,115575,174034,56097,35463,87425,24575,44245,38701,82317,85922,281616,100333,147697,61503,7730,84330,8530,59917,61597,17173,9092,32658,90288,193136,39023,20381,56654,31132,7779,1919,1375,117128,30819,11169,40938,23935,115201,101155,151034,4835,11231,74550,89388,59951,91704,107312,167882,115062,12732,72738,88703,464019,158267,57995,60496,737,14371,123867,4174,243339,159946,7568,16025,134556,110916,38103,191,80226,88794,29688,27230,10454,76308,57647,77409,113483,66864,14745,19808,12023,46583,84805,16015,17102,2231,20611,3547,95740,250131,34559,108894,8498,15853,159169,148920,20942,2813,93160,45188,210613,45531,52587,149062,39782,28194,57849,60965,84954,89766,84453,100927,16501,27658,165311,103841,54192,207341,19558,20084,319622,5672,205467,98462,61849,36279,13609,147177,24726,165015,209489,59591,31157,6551,117580,75060,141146,277310,21072,22023,106474,63041,137443,122965,68371,5383,42146,98961,113467,30863,23794,4843,99630,30392,82679,13699,241612,33601,93146,24319,18643,32155,95669,40440,15333,34089,67799,142144,58245,38633,114531,117400,77861,188726,5507,2568,8853,10987,107222,2663,2421,11530,13345,30075,41785,118661,104786,17459,12490,16281,71936,193555,17431,5944,71758,26485,77317,20803,367167,158,7362,93430,11735,172445,46002,11532,54482,930,62911,2235,23004,179236,4764,101859,208113,22477,55163,95579,14098,67320,162556,90709,156949,3826,57492,4025,34092,87442,104565,6718,186015,28214,14209,10039,107186,233912,58877,81637,55265,39828,6194,145813,50831,105849,4974,88319,122296,10272,197216,95714,51540,72418,23324,91555,8743,140452,250249,51666,34124,7229,38592,129641,78169,174242,22464,149964,51450,14034,10026,95376,26190,120062,14401,8700,265,31386,143573,7203,229889,61567,4227,140981,2466,72052,10787,10062,30958,6099,38471,30103,23202,208101,70847,467,58934,32271,32984,36637,24107,30771,17109,73353,13650,2098,157040,67366,66904,106018,265380,107238,18535,44025,32681,144983,62505,91295,56120,3082,77508,10322,63023,36700,81885,224127,16721,45023,239261,111272,13852,7866,149243,204199,32309,22084,42029,38316,126644,104973,14406,43454,67322,61310,15789,40285,24026,181047,6301,70927,23319,115823,27248,66693,115875,278566,63007,146844,56841,59007,87368,180001,22370,42114,80605,12022,10374,308,25079,14689,12618,63368,7936,264973,212291,136713,95999,105801,18965,32075,48700,52230,35119,96912,32992,8586,16606,101333,101812,14969,39930,759,193090,27387,42914,12937,5058,62646,64528,38624,25743,37502,3716,4435,30352,178687,26461,132611,42002,138442,35833,59582,16345,8048,60319,49349,309,47800,49739,90482,26405,34470,63786,32479,85028,39866,47846,11649,23934,29466,2816,42864,31828,7410,74885,49632,47629,111801,90749,19536,18767,105764,59606,21223,10746,76298,22220,39408,7190,79654,64856,11602,82156,272765,17079,70089,245473,51813,184407,384678,1576,122249,5064,27481,6188,25790,74361,27541,318284,45430,31488,620,93579,45723,192118,22670,51913,4162,70244,35966,26397,16199,50899,209613,121702,287507,2993,36101,132229,67345,33062,76295,118628,78705,52316,34375,107083,107454,44863,127561,33964,3073,154010,190914,55967,39074,6272,31047,5550,41123,26154,98638,47110,19998,148091,50229,31329,59900,195442,19106,61347,73497,70015,682,45850,25776,38022,148951,6288,37411,232526,109277,27286,32342,9262,5220,16651,23175,46740,129438,78614,121925,66914,88710,127952,5563,21500,34521,10739,14863,191006,62956,17359,16749,67027,56284,69134,43301,35039,58883,54466,60823,404451,75743,59856,86979,7923,34273,83785,32142,7693,268986,197428,282681,17049,22346,22990,92245,107180,3357,37104,96724,49153,7683,31197,43267,82231,164276,23696,20848,188364,22309,24821,158707,1018,22514,70922,27792,45589,59709,10765,736,35218,63479,51987,24275,63588,55361,92929,81964,4658,20122,12330,44058,13065,311456,72224,8337,211229,38979,22590,138478,52757,32595,133600,8838,31549,94412,43391,90056,1585,94802,127271,6223,31889,137038,132910,2165,57616,230152,6080,10748,36737,74579,134062,50525,180532,119270,34556,76155,82394,52595,29258,31435,87820,67996,26943,183878,38007,2410,13526,180297,69856,3503,187396,167700,7838,16701,9199,56267,3661,37407,65994,23767,5708,62508,221700,67088,86978,46776,84434,32088,5612,9149,88244,21685,95151,46750,189612,2979,506311,2594,3628,40074,105039,78243,28523,6651,38058,71999,30992,12764,68261,108991,6165,26450,61961,13400,22426,7490,60890,109623,2070,12958,50355,67979,257096,7213,42578,52121,35716,65461,7516,124758,39268,302,64712,14977,1467,219452,2840,34229,11121,21602,19270,63574,8024,1532,17331,79839,78885,52029,180767,57957,6069,91265,61380,55767,8927,32881,287603,22149,35029,68876,6428,199567,46926,13412,104132,21434,366616,45060,110046,81924,128910,45886,52821,130416,29416,77342,21762,67329,121432,79924,11724,38625,81006,102033,28338,13326,3250,82056,82526,38212,21112,12382,111495,3263,7414,86274,93490,40844,30224,45212,24019,48411,71367,24941,76729,57776,3769,38114,202019,197745,31953,237533,33270,201580,255648,100798,44741,32241,98468,106931,10085,15090,170358,33154,66787,18819,69760,25061,234005,82660,6295,131975,16874,9076,4094,25005,17740,40908,19533,220019,44330,99792,50040,19619,13950,55228,24423,31253,95308,103177,184795,28590,82285,5059,3210,75525,49894,70007,56178,10580,36051,139681,21617,98736,3555,106306,164189,37352,63915,47824,24883,145530,61904,28444,11483,19837,145446,30420,112972,85939,11835,191233,2262,20705,58630,1753,148334,1197,144714,6887,11223,107667,60879,77914,4151,57417,81594,96681,169430,1784,20444,95138,254041,27038,596,7117,72808,13759,3353,126776,21074,55322,27081,36942,39547,139830,179275,4453,713,8722,71399,19204,25785,22794,23923,104114,11291,25458,102309,88396,75288,230440,206396,104551,58447,130857,37247,94734,31548,176529,226077,65159,20104,10096,66881,94191,237909,27109,37404,1520,27421,25220,113003,23423,24884,50585,6286,231877,150800,11789,3226,90004,60642,5053,202400,61442,132531,175329,57138,30116,103847,9973,75367,16452,32360,59119,21246,10191,164804,23305,61051,37348,154530,13214,5468,50403,66754,130976,50559,80515,14436,155492,84017,5472,43107,41240,2890,90431,70188,382,76234,48040,50211,281038,237007,32115,142178,1536,22761,96429,1811,31243,1679,49143,55209,17402,235054,61494,7462,77030,34925,87609,78002,9499,9027,73289,201078,101379,63544,27666,5469,10642,30029,49816,132979,95620,58086,351930,116300,2110,2043,30845,6154,11279,16727,4122,2277,27281,4971,3650,39060,61970,65951,39674,75686,38151,11370,130809,177895,32665,63725,122267,7857,39618,118483,44792,157755,178624,136994,24260,41308,22471,12404,21707,12486,30473,52781,50246,20247,39065,909,56825,103158,128603,31542,1089,41935,32744,12428,37963,84420,33134,72921,208449,42622,168151,127335,147107,46699,38216,12591,94342,85814,31423,24944,2605,87542,67473,192551,4496,56321,91819,17630,6300,256183,114569,202090,33209,35289,34897,24967,40520,43470,5344,10199,34810,14283,10381,10017,62923,49924,23233,64539,13051,35686,19698,11570,135555,120868,44924,87065,52318,52335,47586,140906,245885,109834,78668,9065,46990,25258,72022,61243,40838,4545,146387,10537,11557,17470,36930,68104,46711,24264,79401,81043,18225,120488,24746,84338,81652,28266,13776,21878,46973,1047,230465,73357,95777,24973,210160,62210,58404,110633,169651,6937,41870,9909,26822,191062,76553,27519,96256,239070,2478,205678,67955,58532,20601,50120,19148,78501,195724,110740,8249,109665,27446,30568,57631,31425,49752,32820,65504,50079,3663,102256,219898,23849,211315,14645,4359,91767,9528,12449,49366,7941,49763,107848,8930,27086,50686,9744,10447,81935,39513,46514,1670,29229,6172,22312,137280,97759,9806,14445,22976,56458,73391,34983,93760,174219,52573,33149,59747,2429,136277,75123,165263,91040,7446,57632,48633,97140,246081,84766,151684,79918,93268,120346,54059,54875,77858,32996,103590,45276,11968,19600,25849,17159,132907,42828,16817,4913,99462,103303,27395,5737,74184,20749,21160,14377,77062,131403,158735,10999,27799,77785,9320,34366,51593,61070,33746,47048,29268,36675,30262,53297,9832,82e3,20188,122292,39917,7331,18160,68301,185935,134830,15031,4935,10004,165845,185534,46923,30109,44134,122631,18874,22903,112790,26561,18549,348902,82871,140345,255565,135390,63556,103747,145055,179600,145662,296111,61661,211987,23952,52342,126343,48450,32919,44277,82185,9591,62139,205363,376969,394874,108461,18040,120885,14798,39863,16571,16794,58271,81025,55206,14640,118656,6361,44092,85970,6262,153863,108244,180200,72264,79947,38044,10050,5735,61221,80712,5471,115689,11391,11661,184257,20010,60116,30320,19327,134598,45455,27542,18004,125092,452272,1549,91523,46567,180063,156026,2608,11174,58848,37788,65907,80194,30490,5786,40775,119519,106241,11323,156297,8425,61495,2617,29675,2425,59886,112582,49142,59618,4863,50597,86710,50650,168632,27693,85641,83643,18993,25768,84284,28090,93592,36627,312804,43381,9887,9402,100931,97165,3311,173330,66805,28935,4963,184460,3201,78102,19126,21607,37496,24938,22615,16153,32862,134792,153318,61120,6067,2812,12826,12792,23825,37559,64662,202250,102694,155488,85881,149193,46233,65383,15521,106982,11358,176786,25752,39717,34208,24510,32464,77742,39371,72028,138229,60688,71386,102834,132477,2208,11548,63670,271279,28351,30338,38620,32491,99845,143885,152266,13252,2825,178663,108097,1775,78201,14897,113573,163346,62292,171129,22183,96598,38733,64971,166776,117445,9968,146393,44677,74867,20908,97328,12761,25656,26785,9148,112344,26115,99176,110121,22437,49547,6180,79320,5835,31392,43328,33377,75870,119860,69497,80273,7325,155219,43167,111173,28347,20222,3763,71752,55041,47252,14618,28088,15012,97805,194698,54636,2036,41349,6173,96604,61530,51859,43782,13361,24334,22668,24792,7070,23441,16789,3209,36211,208475,26242,32880,122181,182407,21444,31060,88459,29929,77907,12716,10934,97005,20599,31690,8403,58445,30303,22700,10336,86731,103115,337709,72556,46788,112566,47684,67089,53548,36874,56487,41387,125985,26893,40071,106683,73712,18787,40105,72992,67246,137276,50802,36790,70328,138827,22466,39263,183295,29858,50975,9322,57397,10654,24364,30383,55799,41600,23584,127295,296610,129078,143558,244131,86397,36049,1085,80677,3820,108139,5476,34767,24683,7758,13060,7239,131671,250593,59556,103392,29810,4188,252323,39404,116877,7651,43600,40338,13554,157253,39196,25978,144387,61211,234,50104,6129,10449,93777,9240,356378,274148,4439,72970,3724,147770,78680,62570,115877,40027,40547,36817,224392,64609,34795,165027,67440,2477,37206,23431,50754,164797,46018,94995,170982,27051,7957,22767,3674,27900,56419,18930,60701,41302,2692,84749,339721,61996,111094,80221,50129,1045,8153,62945,19202,8250,37208,37418,32560,79477,41106,88569,33963,36693,5892,30570,1581,66471,49647,11922,160717,29442,5643,114865,82962,95982,132098,22633,22838,94726,54556,28566,205039,162340,33216,16849,35847,221339,94851,26533,71469,1805,3804,12935,45483,71020,36310,65381,192960,34240,35165,59773,1248,46954,155332,96864,4246,388800,16129,57133,74592,44807,442014,38203,42574,80818,91592,26377,36424,65760,977,77387,22628,147610,28018,30561,98454,6969,119628,63648,18170,36854,26601,64018,22027,37279,51395,152934,21153,9430,58760,194742,5330,55115,34158,28917,174111,13171,122326,1526,43896,66094,25325,4234,148354,11450,275,18999,112191,44365,22723,68409,8733,57746,96565,75007,14196,108844,29475,88599,177563,100792,106156,86323,93726,14248,135341,194131,40126,47099,14779,8272,39597,95983,171398,65882,28052,10393,47213,40689,22120,72212,106829,34964,109146,753,648,21660,30047,17527,181025,5619,145357,4085,216883,9359,186951,24779,53931,24545,36197,223296,62628,168101,4243,107313,30321,26642,13049,51059,31027,107912,807,73550,26551,84369,122422,165872,49754,74213,234264,33151,52014,33100,87183,22365,52500,40013,23302,5652,72723,21404,26107,48434,587,94049,168493,96418,32871,70860,31709,25128,443,71597,166253,15670,70994,26341,133675,28280,75491,54756,47955,56028,26182,11952,113272,472197,64640,110753,17919,337,50642,22576,142,87371,53391,93210,126694,15285,19642,85667,14148,1506,42092,52962,33243,11970,20734,135843,57044,58880,13002,219134,22876,64754,232519,4257,43120,321573,24799,64526,124728,52579,81472,70831,276848,17403,74359,23021,182101,74597,23744,148267,12055,7976,5349,11772,67540,167347,65318,18720,127832,108238,22828,90233,9987,259080,118185,73209,79270,13775,90100,137742,90799,70569,15699,19961,9087,67475,57872,39731,8810,134897,131868,146849,19898,3334,2281,167061,91073,60356,467742,74712,188,53179,137679,92769,29241,9537,132595,80119,1041,88962,5976,40171,44911,102859,139059,104558,98987,47761,19272,71472,113864,175377,73338,10857,23402,23758,1591,139864,5644,4076,118760,16427,134198,18853,20291,100849,37423,22038,36677,19071,195521,57445,11069,31869,55718,66882,148490,44,41296,75242,49704,166810,9906,20943,122258,49112,105667,15969,10344,6408,187694,21399,72742,58970,14867,14376,81889,41856,23225,15042,56993,16074,131389,74276,72407,53875,383108,53597,37363,68993,44854,122548,430927,198279,38430,80409,12245,2981,628,2818,17760,37437,238229,7968,46892,2200,3730,34190,65983,37959,112291,87850,70827,6522,20750,73913,111621,41652,19587,2780,58668,25916,85259,18200,168962,95781,42445,102050,7776,57662,103313,47742,96358,41964,66174,100396,29069,204735,19679,27978,7479,40264,22534,61183,36081,107436,58223,14680,23002,101311,24716,124108,12908,5646,31750,40380,14215,232799,102772,14122,96775,61398,50917,12096,149880,67833,598749,124194,155871,49216,790,14677,65319,56917,7440,145744,95701,12206,49405,129269,76199,45732,9767,11058,9047,210885,11051,7392,26307,2130,8132,147526,20802,232698,115660,50060,59789,57344,107623,80343,112676,23291,9866,160971,34032,118291,15719,59730,164911,28975,2659,58046,78480,21854,66209,53863,109085,116045,29021,46481,107552,22130,18764,70254,31272,11300,52460,43933,84738,20721,53869,190840,79673,105300,7561,321817,66924,13940,33281,101046,183181,32176,71878,5678,62924,79535,56646,40303,19559,27703,93042,73368,42187,3670,37376,46440,7023,36816,109628,20680,5940,276440,275233,170848,112093,136996,14984,20226,111441,77693,112960,48577,39370,55707,50314,123404,26570,54281,61372,123391,4857,35928,246740,132507,106646,44241,7196,92258,9825,37688,51197,303141,5590,15476,132986,10955,85782,34486,26696,7991,28813,18858,39546,11703,11365,38185,5716,93555,11925,40121,60002,6985,10976,171384,3887,43394,13337,56346,6381,252336,39573,75042,53711,1028,31781,44295,95925,131713,7214,68125,43571,70954,213234,1628,8760,13391,65485,17320,56038,1710,25248,60803,57399,19839,3870,326,281556,50945,72400,21460,316244,75619,56246,98775,481,13513,55765,50427,7388,123519,32929,57908,27124,61316,101097,57467,30228,48792,10788,20402,37318,50526,155730,34456,158065,145305,17832,43733,64052,4506,35072,205355,177028,184004,187081,68616,35938,83703,10367,36892,93186,260137,51934,89970,4985,23445,26755,21558,7948,78741,23376,124405,85594,68596,57536,49351,12619,56593,132668,99924,109728,71844,71935,196018,65464,17617,14987,89701,143773,33997,8687,22701,33258,2914,4436,72108,85610,9671,49067,2327,82988,1361,1672,44033,35777,30269,24057,10605,82236,616,15793,13919,47249,112086,116698,9484,80207,90574,33304,68624,93127,56101,42210,160929,4827,38995,38095,4701,125119,5027,33680,9236,231236,14135,87837,23318,70261,78893,30151,81482,14332,1084,74256,27532,46644,79185,3148,62615,6981,55672,31668,36825,1849,14536,37446,14738,23779,43058,162749,72199,1168,21346,5592,85932,85302,9668,18351,57135,150360,2080,228015,77953,34670,119302,151751,31009,106725,84265,45214,59289,74178,113071,263206,111009,4021,44449,188119,192629,123592,392506,292847,114487,12831,205858,9852,20780,79648,75767,357014,97721,18166,21005,67950,33226,204009,16536,2987,11335,66717,144910,47950,17262,55060,15063,2934,51038,26775,178497,66008,3427,49433,128592,20036,157553,63861,3089,23015,51210,28696,35933,49942,71135,231518,99620,17248,21835,176536,20676,16944,38700,165831,233253,295625,36723,13023,52745,10907,19423,67972,125868,95473,82875,1183,108455,52685,33417,64095,21433,52438,33191,127809,44505,211823,7810,2752,95548,162031,7185,91196,47563,61721,33359,17897,23682,42806,178101,22874,49707,199897,75419,82456,8618,11171,79712,116847,18783,44190,46564,5346,59046,95032,7893,14916,3214,26800,24172,121453,34362,10250,17408,18888,4840,68696,22831,13162,36005,32512,14800,62357,41723,45046,27247,37486,5372,2564,34261,298500,66509,133920,89138,31305,117697,19097,108304,81386,84106,23802,46411,63304,946,51417,41777,41041,19501,115864,60743,294354,37955,94165,18116,1156,17937,20645,57114,90804,58042,48643,92288,9861,2557,88546,61333,101008,12853,5148,87856,4152,144503,73841,18718,9789,147565,10846,42085,12789,30223,8993,56352,67203,2448,28215,6052,23540,126319,75933,36689,80235,23231,23561,21383,38800,77548,102798,21234,31468,158608,46188,63960,191679,8051,67014,11185,170078,42186,28827,34777,41930,212079,12421,34750,24111,110344,73918,45171,70826,141949,40063,23979,24254,37309,26724,27179,24718,83648,54938,14591,17425,29525,102675,48975,48654,12316,8929,60640,41709,50168,63264,89812,50716,48632,38755,138583,160123,55579,71829,24230,233277,46322,39650,166388,34718,24108,98252,7031,106695,62498,18258,35062,217827,78731,34824,33354,19520,60852,2432,60224,8587,2836,62955,702,20227,42285,40560,95592,62486,11094,53035,143291,18842,46177,77994,1770,9657,107422,172915,32655,128716,25886,25164,156740,119928,165875,85817,11007,89110,33956,12652,65156,180266,8494,36889,19958,20955,96,1264,118288,135769,44754,86671,5632,19026,168220,289120,33569,93821,66144,70635,7687,5642,2714,55445,56636,71545,184182,93133,7332,37389,12643,52315,22729,11014,158742,17050,152889,50178,34601,41945,52136,9948,26914,63548,95721,115951,40759,8960,158258,38938,49232,48325,42234,81523,253019,66128,40978,20048,238048,38760,62928,122560,118532,43687,137472,163689,26680,9878,17448,51035,16211,60834,36749,29178,14241,59868,150086,2305,26477,42422,34342,165341,83279,33894,14257,29928,12743,13957,125571,89134,66712,10952,16507,147839,30146,7249,16565,45399,39874,114565,215780,31990,230881,171477,102,196546,44538,10880,84948,281705,86651,10617,31395,2342,453658,43569,60561,132901,21845,17727,58556,258242,22262,58728,4008,77997,11806,37431,30599,81375,109137,185787,114085,217292,97453,169085,30593,60212,11544,102056,65580,2384,91655,4855,95725,7295,157994,16228,20669,53276,141590,105246,17334,25440,76067,17967,39321,38911,11362,28559,63807,21627,26468,85816,40120,1025,15234,58319,69516,66512,124548,75845,78873,22137,46681,51242,85683,32909,76747,35555,43396,101465,1765,73094,1077,2962,39028,66777,57831,42048,15828,13962,36041,63657,52412,5242,58846,2141,5506,219012,134451,3936,182230,17558,17153,152237,22621,49377,170216,35257,68233,65374,6510,11126,212151,7184,2480,22517,3437,33073,30156,16557,3768,55067,86829,91e3,12350,148650,66017,79424,70885,49066,28250,21369,51213,34533,11510,3258,18176,18465,84413,6315,36411,163765,4346,356,107618,598,13727,285026,162695,8749,14583,7132,63521,184253,32378,25991,5604,30961,53675,4874,84693,5086,34811,26978,56564,7904,33519,51221,113942,69253,6664,125563,22055,220680,102008,742,51930,19494,176108,44424,35123,13025,75685,11759,74335,22250,181453,131147,16984,132115,154311,11991,76452,52609,85351,196,30969,9198,74919,2529,56838,71779,29187,116304,3504,62330,41190,86153,28393,254926,104228,105189,13264,84359,3574,12415,8534,57147,10175,188174,59504,60932,66318,16407,107921,17638,99103,49278,28403,39786,145865,8462,3558,43406,142271,29139,21989,36552,93955,72365,7176,13556,106185,37957,321774,17782,129017,51154,27938,24952,1935,39366,2791,33489,41582,56078,24558,9311,5449,218786,27808,190429,68013,36020,86003,29735,3404,87348,119357,115714,2324,86796,81973,40992,43376,93621,28784,16808,36367,2517,2909,191926,24978,55303,53308,205724,60068,3098,21375,64784,23949,26579,63121,12319,80145,39967,97861,6757,70143,67642,37082,34698,69140,122883,46151,62187,80934,429,19437,135071,137885,222647,13331,154065,327,61778,74257,40116,37493,14855,85079,237641,42342,102164,199965,71204,4662,29368,5042,113914,122214,8955,13149,102503,43173,5659,163787,69003,307084,63392,171080,21390,81918,86666,36622,24126,28887,5736,28054,207170,163428,79891,346467,95363,38980,111806,80828,9200,19288,294896,114468,87405,111715,141705,7015,72754,68463,48738,243147,33397,101210,37051,98801,82847,20397,4940,185559,18716,54718,83491,11725,40803,1128,12128,23060,5174,7745,67007,46701,1571,27807,180186,256996,18975,16837,7877,212758,250379,15440,87954,57755,24719,124057,83461,258,50864,8874,29038,71289,31627,15429,9005,4061,113851,107716,82819,13651,79656,117851,17539,111446,12938,39724,190787,4352,15402,21070,62708,8539,23777,73853,13552,38810,86117,16285,56400,1718,75342,142863,29033,378,110113,180321,32586,23606,26393,160984,207987,23783,8406,16904,24596,47274,11693,46539,60524,78595,48423,31718,20170,9009,146268,15183,191060,172765,1349,138436,37365,10970,40509,225817,20021,70394,152138,21541,66559,66544,89352,2725,17258,91345,7313,3815,115868,8660,40362,4071,103524,39388,118275,21950,6549,38226,32754,209574,29201,43495,18028,20296,40597,18370,47520,202450,24134,2219,8195,69545,38041,136934,46374,19041,159811,84865,58620,846,98749,13569,30714,97246,32186,4479,27355,92973,35214,151491,75963,37631,1561,27200,238083,23182,60756,12291,25766,39355,102333,87362,65741,59906,19538,201575,48772,102938,24438,292580,39964,66366,9004,61379,50548,37622,38732,28379,68180,76622,17488,69849,5963,7219,48143,43413,55358,540,58691,29506,19245,52193,48621,5518,13048,118625,44755,191081,42061,89197,2259,60665,66994,71210,51232,3585,142096,55024,7892,8345,58653,463307,65658,64319,137941,136323,53499,12746,43492,6978,95163,29925,60175,5128,7352,41463,184756,121146,20473,18426,4598,5309,54580,14277,121151,10691,56711,43880,63409,76682,11830,172218,264898,32632,66536,81062,31649,25788,92774,60222,11100,63159,9432,224657,25240,53613,152,138620,163829,2397,85345,12501,37507,64932,38575,43522,65789,80198,78796,35226,3851,108891,73311,3060,28391,93671,39663,46142,30982,66041,37281,68157,26553,71872,81142,211527,39747,118119,22695,2859,11066,20232,168911,7933,197005,17066,111071,44434,133994,120798,12766,227798,45756,132852,29917,36076,55352,65281,129800,41958,18944,84678,18580,168093,132621,39997,54092,27740,32354,3770,114118,103242,43918,15899,18574,145944,3190,123469,219903,24169,100571,62403,16776,92779,14535,17168,16475,14304,37231,1712,28218,242754,61688,28980,1318,51359,222657,99200,67989,31772,23932,35351,201251,49041,27306,19128,40135,3986,77333,19649,120683,151927,21081,7076,78375,77501,101599,8011,89585,96715,58179,5378,102138,106793,26051,217276,4197,16297,27014,46721,13322,22806,5278,29629,70632,9647,71519,58818,40603,128530,8903,36770,56900,31483,26935,43845,34265,34920,87658,6114,84767,64250,47318,50720,19264,162514,33357,13117,6705,46696,75032,71054,87004,42035,69138,11903,99854,102328,19611,34525,69312,6431,49842,101600,133178,108751,41829,89939,225664,48916,99556,9195,130387,5960,36857,116724,53518,94002,39077,53996,6945,22261,64291,8314,152785,57588,16522,9091,5048,87671,35441,39509,1945,12423,158923,178413,37549,14095,1475,73188,62878,4819,24012,68534,42606,4010,120809,57497,59564,101758,103718,32701,80116,12345,95834,46918,21468,53213,15665,31200,3867,5140,96013,250744,21016,10069,13968,35449,180829,27683,39704,59956,22893,3115,26293,32785,75934,62445,141162,62720,2018,83638,19949,114012,95006,3330,99829,130935,309272,9565,55874,121727,37017,23586,319858,40970,27602,8625,112329,61060,100088,118525,25922,16232,1907,60671,51583,44553,80993,5262,94679,8676,940,20736,11823,3020,16476,12340,152600,97416,3703,25744,66826,16245,16876,46446,84798,74227,176020,45192,61955,75496,23946,23626,40372,26036,6149,11822,30582,16541,41914,82385,232823,40921,80773,14930,3631,7517,39619,4348,36180,126106,138939,62611,1477,113512,47321,25052,14546,118881,29060,23589,128322,36795,18401,137921,104699,267929,36194,172791,18113,4766,188215,30083,332586,94089,5805,77909,22194,68234,154976,43220,40660,70001,184893,138095,11128,103010,22663,5108,212615,8485,5565,49222,54614,26530,42639,16319,55062,152662,105595,21114,22216,10294,68158,10436,86950,7206,62115,3977,3657,59874,456,118617,18156,106663,112229,80992,17442,8217,55551,5133,34344,251927,51153,39364,201321,7816,66803,23057,156724,145664,14276,95705,979,2796,6875,13429,212525,50602,26276,28284,3424,19465,52397,46963,31420,51399,206476,92317,48851,637,100820,83349,10317,60227,21972,6908,282439,32857,224767,95629,83882,42106,87338,69757,29840,68709,37665,45244,114577,49188,175943,54009,186746,106158,70168,3358,234002,50555,9221,129338,9562,20118,32923,78479,118280,65752,4977,10474,102174,60947,129006,10570,83451,8598,8078,159367,123785,80438,16742,5905,5281,181513,42402,6977,163136,93179,42191,14968,50421,112401,105440,33456,57347,121611,4221,94954,36517,24046,27796,6255,33394,72990,135408,116627,1233,57874,25654,95419,68156,401399,313338,55208,45573,93124,119251,47200,38196,11909,130667,45391,73904,64964,167846,4137,115606,52036,62214,7969,160925,7187,1132,134835,40309,73195,64494,80472,444841,61111,26500,45323,40743,53625,52797,22659,15631,29739,36706,28841,39147,102836,26794,10536,14845,87305,45874,12241,127587,83833,57183,79722,30844,41304,84655,20825,92500,3722,25655,27811,10157,81634,31362,34088,92487,70123,22190,185100,72658,139035,192523,88241,2078,230490,44528,85638,100198,22088,29982,291233,241062,13865,4445,137791,37835,107218,31726,19718,38234,72528,23046,19177,66695,5109,17251,28077,5617,21554,47839,72425,133825,1486,73065,181275,141508,21768,62971,63082,2512,34200,9904,120309,6392,91243,68416,268253,41199,116757,138551,185526,41246,28986,4093,19057,17295,4148,245766,122360,35356,112075,20301,75441,10998,7977,19769,62922,937,63547,100196,26427,157820,20983,236696,22935,8140,90315,156004,47204,140973,7726,45097,52725,22636,23436,257282,105247,522,88389,216031,202204,46812,211666,19693,68828,81691,45925,11256,30292,372,5236,167826,88328,232776,151611,5360,82104,18841,80393,25465,18285,20320,72377,31730,33160,45803,38715,27705,37379,24163,18360,103586,4015,32305,269494,91252,20080,36567,54650,7797,57073,12650,31164,42209,6375,261663,105528,81661,106002,2800,5375,17247,43151,4442,15727,194619,100855,144898,62320,78465,39929,16454,1967,28311,61363,17219,9395,8745,121445,76939,80385,162380,22009,54191,44248,16299,122830,48151,74429,78291,64755,14238,44966,2511,17712,67954,93583,829,105899,49935,84750,11591,33185,85447,42717,27409,208542,28965,62052,52525,5597,25694,65594,16343,63224,276188,12475,9331,127507,38522,57287,24128,133161,79723,105548,133695,48917,27558,43278,46520,13778,141954,110785,83366,17715,46317,105763,66298,147013,41086,94180,16478,220447,44611,730,19722,78975,117889,125643,26254,16574,18480,65006,15806,38549,246418,46052,36056,8440,34984,30170,3163,59800,4458,115442,4283,41970,33507,104078,1653,22,121158,276486,3655,6338,24048,133421,23641,2161,24422,36006,8086,10675,181474,12307,29514,59143,14729,52509,87128,122470,19446,80852,33314,24573,119864,14237,9652,57779,6612,51851,15284,98871,90581,124466,156831,21190,22015,71380,161906,87247,69201,18392,17908,108470,72962,40719,14338,17911,95260,43339,20610,78916,20710,72451,11315,31448,17263,58853,178878,48111,116002,45497,80506,82605,85880,36300,121755,25215,36118,301929,88728,405223,276136,553,34704,212438,49970,78329,922,20711,25036,257130,38295,145369,18128,15385,30829,55656,48345,8012,3561,28004,122041,192900,58338,112508,41085,29976,87040,47117,23905,4336,92061,138880,97407,42083,172121,6256,25192,172671,5,93568,1420,12677,31605,56743,40620,6015,78415,231077,31298,80026,13902,19048,24924,170586,32955,176119,87859,36731,6773,27711,24658,26475,115216,133207,93250,95820,88522,8317,5714,124047,55219,86860,19677,23961,22928,162209,8904,225992,359835,56084,96201,29392,96558,86071,93643,55114,13347,8183,95129,82012,2017,123336,34219,115554,157159,47747,101684,41008,18735,193781,104151,226906,7552,179874,124113,31159,21162,44010,14771,51268,166128,31382,73124,77438,92830,205709,12113,1292,38937,13114,1334,2118,15597,69581,14449,21934,76618,48728,67038,14967,51495,24243,87736,147249,26720,11119,46063,43749,5843,44147,152629,133428,65703,14269,45604,57982,28672,55616,45957,8438,95433,37698,220862,132034,39456,61870,4161,26501,73560,56418,9845,4654,20916,10456,88920,119358,9015,65931,96507,48029,38534,21676,109081,43078,34943,25089,6131,28766,23665,5477,10255,16695,67,45778,42443,42770,29534,23733,100513,62617,42630,48746,14191,43753,50295,26007,8792,57243,43119,54725,164253,58250,112304,131796,25165,4651,3188,24831,47748,3705,19540,13211,102095,5593,18699,23666,32005,117571,33541,60584,74573,86311,99443,25172,27222,168938,7143,11853,53560,18834,19960,86522,28217,53266,117700,72989,34323,18721,66450,34346,74056,47217,202002,46269,9429,68582,75458,37823,82843,96652,32549,145144,27958,19820,158086,31955,201406,135379,31207,192545,12950,51704,9094,248263,76147,64028,110009,79407,89345,99284,223492,47966,26848,15359,201137,2861,110507,71231,72297,31851,118777,71039,151051,240855,16333,50766,14727,7939,4149,80908,418780,88378,59276,1327,7284,38576,79814,65820,42199,84860,49574,62596,12396,70598,40117,8648,7994,16836,7630,14047,359699,106878,525,29037,28064,13380,11675,50669,74216,103539,180314,27449,56299,172344,19274,7301,246099,32043,19422,36506,129317,6806,30140,4614,46639,66926,932,86600,6322,27847,233103,10541,39025,34887,3517,12972,26220,2031,66561,115015,48658,47596,12714,33845,3893,16165,35237,89983,14769,11962,147224,47018,29977,27979,5552,82338,86023,131368,1218,24853,237840,132193,15455,40873,3668,65351,53388,15229,59889,272245,47934,11858,34347,18038,90853,86981,300602,19343,114181,29362,84921,6095,106059,79472,38015,1206,48741,6208,8e4,21916,17423,6002,108083,24479,34931,56661,9511,26995,100694,163853,35997,81254,58321,18919,171890,86877,91341,74503,70477,53412,7027,59281,39892,131302,5864,15947,61301,67466,162369,47956,27874,35624,282324,21270,111847,102548,41482,30955,116737,28264,8592,55458,22301,75090,29821,30697,51709,3041,19208,8038,24634,30467,87509,126428,19389,18814,152686,20701,83474,45832,80891,105808,11378,153223,120770,98186,150633,49838,9141,12755,30962,5260,74490,21256,31678,65062,33326,289838,187831,20595,89768,2805,58535,10844,70085,12090,2451,138068,98544,24461,4511,6754,41684,28203,3383,65355,82833,30161,83924,234361,128424,28921,222594,33975,125491,34069,11508,67464,144226,41850,98703,34371,7901,21254,38398,65651,23549,53883,213340,123269,12028,71764,177701,28758,2623,68395,11549,15232,68603,9660,63116,36079,57093,31198,20475,48467,89984,35619,186847,107469,31389,43631,73867,41949,68841,114250,1605,30564,63403,17588,27680,99533,12641,70325,50428,73426,78379,11855,91651,72081,91720,60198,15743,12065,83398,140046,6761,46598,45900,5068,886,62448,148968,37347,19405,9680,15819,43496,63370,75667,163700,37639,3633,22774,34341,183131,134335,37200,23915,7054,14194,12970,26438,13350,285521,25594,8219,104410,91039,168804,138480,149734,15907,33818,61132,60082,4622,110187,56736,13551,73571,3945,73463,65498,17758,263266,17593,2710,27585,54469,38200,45367,63754,28881,3473,12791,98287,31895,65787,4463,94536,24951,36332,59901,28803,52130,86403,7668,181822,74831,18977,9850,177206,145485,109798,7292,31421,26280,77211,58511,12507,127004,11113,147,8729,56208,43066,79926,129937,31345,83947,39915,46146,98763,42566,1337,13192,18323,105163,80570,117753,16555,72883,11077,159438,40764,70933,83329,26066,12276,72059,21655,173836,126713,69454,153482,91585,70644,102558,110483,6764,127864,190133,3961,101798,20945,71138,82402,90884,69669,44753,923,16939,59700,164258,25969,27082,31399,43846,6306,246093,51342,6153,151581,202801,182731,56475,162188,89426,141356,14355,121815,27536,28023,65257,77523,106668,127314,24947,12790,38796,169698,23555,10725,44573,183083,42088,62716,43265,105958,32050,44067,50118,1668,3874,6243,318411,16599,1691,94999,52378,28671,216728,123258,2059,34969,69225,5913,136280,171443,141515,91662,22175,135282,80020,92270,1663,4808,4482,3495,34691,5226,109830,108512,17342,107488,11606,123190,100247,29666,146527,113014,15794,30894,13224,39585,243192,22351,9903,7836,47699,11078,25468,122291,48821,26780,122679,75521,81450,630,4895,92900,55074,74293,17441,3563,111657,103102,51613,12318,52370,36191,68245,34269,40445,41354,122901,168604,182500,62012,42557,11259,24428,115113,86345,12362,3909,78430,86852,134602,20459,47853,93879,22577,7659,3688,38555,13349,17381,56715,91639,12493,10895,92438,3142,37057,28928,2004,36427,32268,34222,209974,10432,67436,41989,173518,107930,27079,62729,30908,55558,5828,45031,14902,53546,8204,144263,60255,14520,88212,86582,109589,69356,8064,47449,8505,66558,16886,4844,52817,111260,215129,12941,91118,650,20770,6273,73089,40618,62790,2873,35002,14023,97208,19386,102646,36993,143736,135457,35385,113601,17893,32627,84439,100619,56016,6581,57264,172160,45452,111710,203627,70131,24100,322787,1996,35665,70078,22358,90922,83658,4097,63200,58499,14542,99153,52159,6615,12414,63415,31986,16823,1579,65405,137809,8841,16898,48082,259,33014,42375,12260,179850,73667,91389,98882,29532,17311,326251,41092,5928,20742,44964,48019,43505,9317,49265,6643,192712,48424,163487,19861,20113,70848,31928,105333,23685,78563,14638,54755,7158,24142,44018,20774,125255,20331,24280,10163,1285,2336,39851,4299,117269,46714,63816,87779,159624,11731,9971,990,137317,108831,50994,74554,162680,23640,131597,146962,170620,34829,91205,21184,1913,63616,18427,93136,156592,17519,67565,115882,138220,78622,88535,18115,2711,33554,109492,54298,971,24914,25863,36363,45715,27099,194995,14299,178181,111488,72395,322385,157719,130787,11897,81843,83999,11369,49280,118604,40922,61332,110343,53407,75639,40582,300440,54722,25637,13694,48248,48278,194521,56203,52779,48783,72627,10953,376,16733,280238,26351,230789,15132,25168,137270,3588,63704,73376,94031,74284,19443,159557,9697,39901,13351,119050,15406,146455,3460,29556,75195,37673,102524,92329,47289,98413,15311,100684,56345,7116,95480,11590,7200,167,23610,58426,17730,136656,27944,53151,2701,8824,103124,3017,90744,113588,53216,79736,65940,26931,498,29568,80540,143543,21292,1740,59268,16561,180816,42323,50174,40890,52866,10703,57169,4700,17191,4424,93511,49698,166650,26972,48631,165169,82879,69326,202970,4007,2376,231325,139592,22119,62851,37504,68816,58345,67398,186643,43331,277416,53749,15746,23102,17432,4793,151138,48822,54265,48203,198688,14305,54287,2291,18018,113378,123260,7180,97549,87027,120085,2920,76080,8190,102005,5641,64580,14955,59802,54028,58884,19367,81779,412567,85957,97053,103637,78871,29364,27637,141728,4767,30686,112738,130146,42745,12730,105040,14844,232,210944,36581,152317,135543,29744,3129,55647,58149,46319,27265,17499,28005,59948,7170,34138,5702,293047,110892,408,91760,218674,18469,46095,81403,14389,4610,35672,73060,11006,74848,104820,118143,190357,20043,105358,141735,5115,27093,45924,123073,52599,29433,9616,238350,78610,24851,58858,26769,31969,24613,18294,4982,32735,39639,143563,112073,202205,12567,4873,88601,44897,81503,101648,81362,34662,85277,17574,48173,21435,221188,40215,39576,80786,26544,64668,81841,10731,37733,247986,149188,127703,495,18382,54388,72446,43071,30974,198723,89608,41360,190,33045,8386,31658,19992,237838,119015,137622,50890,100913,6460,116233,267230,26621,104129,65114,14190,41542,14888,85962,23342,23041,26453,43725,71809,45186,4770,46452,53894,56616,221286,18973,9038,109299,55365,19366,26863,18808,60909,69353,41738,83463,12100,68561,72860,3980,13796,49340,12332,31311,27418,4255,53430,18976,45523,510,14224,30477,26581,4530,3651,101663,139840,22709,150861,31996,63923,120623,262522,3076,10528,2929,14672,130238,18087,9816,121894,100308,25085,55111,14565,18952,53293,2042,369988,23674,61789,133529,28783,108293,35477,47119,36448,71049,40015,33055,78598,198442,1833,159937,40654,77444,189245,113153,8621,18599,38553,35223,166072,2375,11659,21786,89523,6032,12116,63046,159398,18454,3678,32521,47626,11411,103527,38896,42946,15696,26370,10185,8413,37080,165583,4331,63555,14907,72220,50056,6623,62236,36565,49783,10049,17503,100581,55951,146244,24724,9626,17969,25524,109300,173965,99994,101056,46459,43647,53737,277968,8347,123521,74858,33829,44762,77574,877,81377,222525,123532,30602,43881,53145,2973,16284,81940,61281,127044,63620,9875,14756,114829,19032,9202,52759,119141,23928,120551,19607,3599,33401,76821,73233,117430,39968,36539,7071,5446,121735,194059,15206,45283,6706,15603,65615,1207,165723,92275,34773,104447,8396,32353,205240,164323,13600,60555,79205,25532,22907,33410,57480,107111,69630,32137,47832,70913,33161,20321,2371,117348,10714,86246,1625,11763,17900,268,78457,99175,97940,101092,86660,32221,14041,128504,125080,53744,124263,31017,13897,403,31859,21964,5633,111630,5547,77329,17961,18241,84995,25984,12983,67491,62168,47262,5241,297,51191,7351,8967,147212,82060,16821,782,11033,82431,62957,5026,43459,77963,203477,53528,6247,191852,87774,74164,215654,13467,1522,219964,28589,244104,16242,117821,67725,72570,156792,17186,15979,26990,44128,193014,35276,57125,16212,166451,68017,6905,77608,16364,53777,75921,76426,37975,26203,269296,64099,84122,12077,38533,830,4407,20139,963,43028,38902,42911,37503,83343,85045,16979,1165,60835,137387,58380,86990,110066,134540,56331,193845,81238,17922,163093,38744,110641,12502,56404,34862,26865,125964,12965,111648,25547,7771,27196,136980,9555,29551,107158,57885,18831,37705,35505,101742,13970,102109,62548,124657,23328,11124,89592,146376,248050,6241,22033,18337,80685,29898,11908,216623,67721,106162,146610,21377,15085,91552,42041,62560,122532,125336,102365,121537,142559,29693,223919,11515,110495,18776,22494,5895,185059,103592,229351,51220,100102,37027,257855,29359,54123,36066,106493,12244,79258,32002,432,56205,94836,90182,6726,14762,29391,48938,26864,38083,60364,3310,60192,14766,205567,57504,110760,22649,24666,46333,21517,3430,13135,28873,27052,158809,11597,20529,6695,23138,22960,37137,45574,6545,305877,43423,26153,24769,59844,14501,10430,134352,56169,13213,103432,49523,35181,13435,12408,129475,64620,230854,77390,51990,15653,83248,33466,44571,117828,51481,2187,10559,68019,18021,54895,48247,18354,33737,4554,108595,37288,39767,116707,9175,3726,108877,21616,83684,49862,1938,8543,276466,20134,108498,48770,102254,31914,131520,185291,100559,51890,209,19526,76471,50544,71814,99351,8172,198526,28816,20419,9109,98389,136777,76479,75596,30635,165417,48216,120220,25955,211071,39314,24308,32164,2559,146280,43403,9233,17947,90585,1786,86920,125662,2457,64741,32152,32918,122882,78538,44001,31723,56426,23375,103172,88177,145697,52506,49319,68016,31664,41488,18486,110400,7030,28241,986,109199,19900,42147,56864,65287,49183,7858,24e3,30453,840,16673,25907,68916,89927,6309,158335,36407,199737,130464,13137,59603,201778,195292,21015,42466,179062,172561,89492,11075,180407,31868,72493,20998,60217,9865,19530,39274,130266,54539,21623,12535,13505,40641,73375,4087,85633,2153,3117,70680,55788,92096,47509,98493,37490,271936,151475,3032,16171,96642,34106,78425,125761,19591,3366,19316,54508,24183,50786,194248,91528,33253,34622,108355,41741,705,3814,3883,108929,13203,67831,10142,59754,68208,29128,84820,56880,38794,24972,48571,40821,40476,18137,164254,24064,236309,79181,11282,395,39169,2013,51587,28551,9645,701,109513,115899,113566,12762,62045,58322,103726,41343,40866,244102,143816,2490,70346,40973,52618,15412,30720,104315,38917,42027,93676,17513,107418,20706,123890,13399,97727,24044,87962,65606,44250,98044,65276,74790,101473,19350,91570,1326,87790,172042,7577,100813,86896,85891,41512,108130,27794,14875,71431,12835,156250,58135,3759,22476,42176,115873,34686,56523,73643,108505,51491,20838,12721,32863,45700,29496,13700,34294,55360,29206,155942,123812,7706,163234,203,132720,49358,144431,8130,175788,35818,3270,76832,25710,54095,97274,28779,94621,74396,19092,128242,58067,20885,14670,93255,15107,63291,23654,126900,129421,59294,262659,9798,3251,67344,28600,44629,50672,29072,26999,31526,23183,49175,165843,175455,17282,175411,32022,45989,30298,90690,78118,83156,23749,35636,31317,7069,80381,94561,133756,14960,97404,6138,41065,78041,32843,16601,34123,9559,146529,123377,96395,54441,42012,84257,123541,10745,22139,106459,11720,150883,172651,154996,110538,4728,53447,25704,2009,71152,119354,21166,66604,1429,216162,8637,122250,63520,27180,29172,36124,276428,107787,77184,4680,14952,104903,24418,14793,51561,52931,8371,26342,48526,7118,92066,67280,40653,8847,34597,105438,14198,50163,61188,146286,50315,41205,170829,161496,585,197359,95056,1687,365794,91349,48507,5804,49263,5146,104902,96365,117343,132222,46084,96919,16875,8073,262381,79982,52663,13928,16056,153908,15145,109256,132308,18763,24904,167644,13618,40750,18686,147124,114709,150038,52849,2938,12568,48617,8778,5459,44202,44591,74914,17183,248689,13878,7822,80060,23116,194037,18487,2067,7798,43077,33678,244028,31320,74273,2794,19466,8218,36280,183997,48124,19416,29656,19280,98734,7715,18311,30701,133602,150307,126956,7378,2933,79903,13178,12593,86571,26604,92446,13574,44205,65699,427599,21118,8245,14407,27877,47936,33542,7916,26460,117762,21596,37818,2249,127359,209394,60044,47677,308089,36791,154971,31417,6998,150042,174360,12255,43009,29335,48739,3912,101398,53340,2580,146939,151295,45360,125275,15273,45383,27456,48761,23314,8750,60801,85823,104759,27894,123685,66968,39480,26917,55290,83305,2696,98390,57569,145853,340733,4919,20024,52268,30884,7413,203685,70989,112855,4129,50536,349518,68205,332641,159581,135361,236026,37563,176404,64899,6578,122033,63871,1850,85234,82089,66124,74145,121098,107351,12687,36881,117334,13136,14698,85933,93866,18047,32620,310,15094,46e3,88451,23632,36645,27940,87618,80520,58892,20976,27702,140090,96075,67841,103292,238964,87778,107338,17019,83427,67522,7302,8261,47570,116787,8730,80484,61772,174422,56005,131193,52875,14588,28471,59817,9586,15720,158155,51307,109734,15196,11025,59331,3884,52626,102602,84797,25158,27314,4437,20488,76214,189248,35023,114952,157376,2827,62439,102878,129749,36405,10329,109339,108633,36662,1254,13267,5470,87105,58004,15397,10434,159667,21864,52022,179464,3013,32147,31496,116832,18494,105502,129227,107267,50033,13481,9954,24267,22141,16257,116154,36185,950,115685,11305,176708,2048,178671,112573,287867,162328,497663,95170,50979,193861,50987,30368,136257,31830,46549,15119,169876,23788,17462,249887,57377,1949,35448,14791,43769,210091,3783,34612,282103,88380,245190,5457,20491,98908,11402,86899,117916,16028,162584,60644,320177,156096,31065,55876,22e3,77655,9992,23397,13757,317623,63978,215255,2443,17648,93231,27388,104529,93807,55505,140477,12046,112040,70887,40152,94365,112353,25063,114679,266061,71248,119555,15589,2244,617,14129,211431,70110,100652,7777,4383,85911,89221,21010,120615,58357,86405,37554,41647,18,15143,69662,60491,14714,186134,148344,42347,5410,168175,44535,42449,343894,129417,99682,20659,27272,140483,63455,222159,17536,13722,42637,62324,11976,114691,148109,2283,32057,182393,4295,147364,33705,2075,44303,30274,28331,63740,69740,29148,10346,44862,33716,73937,153333,12930,38784,247159,2515,41053,20256,83368,256189,54639,115240,5096,24661,175419,153552,26516,141,138176,63885,34115,47222,55709,2765,28479,38875,236608,12229,22921,77291,54426,45388,2860,57787,114579,295139,105782,17826,71066,19119,54364,69385,16568,12323,28057,33346,34919,124763,155533,101386,31644,8627,49001,303600,29868,63213,9103,77280,71333,9696,138789,37059,24823,5057,21352,32368,114208,56803,19424,10445,58514,8661,209508,26187,171838,10460,63454,14016,122504,41328,21329,46618,32493,38225,7855,31763,7945,29876,8734,6438,24205,97490,139977,130740,47323,33195,85390,57194,13813,60600,21313,96251,7699,27584,170521,139271,1363,4402,336738,129223,84983,69150,13147,3590,163929,207225,155260,55916,20288,4503,8398,98490,11773,27512,37113,84976,86558,28365,11756,116005,182148,13733,115313,47644,67208,85069,9347,14995,226141,14704,101835,41159,35314,13113,63526,214039,29978,50446,83339,17440,129441,72522,118641,97816,24907,73844,15717,118884,167255,96509,162793,30847,36849,51297,78974,77793,10427,1873,2972,9999,35074,28190,64297,146836,46298,60038,163007,108919,61219,2403,75022,127339,4233,110389,69022,9833,128097,88016,79390,222936,22570,94657,28462,56956,38803,81536,30474,152794,19566,16481,147408,74574,81895,20731,1918,1366,76367,187321,54494,24366,21690,61696,33283,107477,77499,31112,414383,74362,18463,218441,120929,59848,258629,201924,69269,454,19989,13054,59894,3623,58908,20681,35723,78523,102680,38988,184112,108087,50944,132704,52966,21699,18860,96349,201411,82697,85395,95658,5093,6427,177894,44191,32755,26961,155739,6249,31310,81030,26574,84311,120155,86730,113535,7424,48888,13516,45747,98098,20077,183995,81945,43210,26704,40420,75831,45648,11180,6855,57927,65528,124096,34851,2598,156633,107572,127352,38169,123845,60142,62722,105584,232364,23211,68120,1601,22169,89299,747,258039,80572,7258,152249,11862,101204,8834,121434,33761,19175,133142,46343,40178,48723,3589,41977,30210,38868,62257,10087,82658,87827,90646,16415,47552,351723,28298,72225,91146,272760,1701,11295,1652,109651,300747,51863,198800,29446,11794,32345,37538,22356,33102,37590,113544,37970,11478,179743,25454,103417,59905,221970,105196,145604,7817,164809,102360,16974,75840,255333,56902,6659,1954,645,59400,67769,7689,18675,5215,13793,20536,27852,3387,29523,259718,16860,94625,43143,29245,15848,233581,22685,63631,78557,22836,133302,84513,1348,51826,47129,98836,58284,1830,1749,94642,10933,6145,12506,10975,13879,103781,144434,10268,28409,32346,52968,121567,107374,77268,23686,35097,10501,155275,15303,47136,21102,168741,55332,90385,15996,84817,681,137803,25054,142275,6163,38175,8056,124296,240642,65621,4934,178205,16101,62803,60964,18230,100622,76465,44689,14545,9543,47514,16852,93380,28048,12047,107106,37575,101485,77047,57326,34819,96137,76916,6469,46264,115983,75768,87668,69942,13027,165,8373,114231,26434,52844,42799,182044,23580,146254,38081,43236,33883,146220,382894,14606,46035,36481,166621,35417,95382,2957,59384,60428,36358,66343,75378,22267,22950,83528,17577,56474,25285,4619,179691,75355,95836,53295,34588,171410,4487,14679,84208,44015,18562,109133,54101,11531,86052,174479,303157,28095,9953,35642,14564,39802,16145,77606,117406,53038,121117,53624,22062,1212,7632,127157,237292,189087,10478,127345,102515,181997,86752,87623,10966,121602,68783,68681,83042,114380,138349,191305,67176,50085,39016,1427,42384,1412,67118,122616,72389,25260,2237,13576,137346,19938,20304,2191,68759,5373,61364,238507,75814,23931,69565,38993,131741,38364,12528,87762,5679,129853,5310,186831,32653,90338,260176,389531,108118,26843,43985,50175,30563,25106,56965,18130,140428,4542,165503,117991,24219,229605,1819,129663,1240,3797,76093,18398,71339,51919,93043,27175,47060,216257,6483,35051,1217,16512,80798,129064,13225,69339,8548,237079,72298,2575,34280,51379,117910,55671,53345,247552,29486,39328,140821,34681,57045,60177,5004,90269,78522,2479,322607,48474,61296,13057,31558,4678,59271,6699,27044,31988,35944,12503,83480,4389,136508,3781,114121,70279,4488,155829,42214,2898,68191,75695,305850,45041,74344,106509,30087,17429,93292,12477,290,23080,114802,35714,18751,26554,105424,17775,2144,2412,100610,65192,113975,52975,180272,135050,129815,76238,106483,21440,63186,4260,46189,9711,28249,4169,23429,23390,8324,141585,63809,67668,38457,38063,39226,59972,1189,203916,62368,14403,16949,61767,85801,1739,40147,35049,76757,33124,62102,15780,103593,103009,53484,22952,67973,114645,6566,5245,50462,7601,8288,3513,194571,80276,1908,54592,5124,58571,2513,6800,273997,193904,1119,17991,117245,2508,129156,82366,26278,71465,63341,56943,39662,106116,94966,156875,9736,2204,122308,94418,27134,1280,24539,49022,45314,3764,50904,46424,30699,28087,293839,9400,33646,40165,822,147499,50263,116179,29085,11863,31314,5578,17797,5104,12454,1604,15342,219206,10232,67800,94261,25872,13565,90339,78971,75377,26649,41184,47695,11514,35369,20767,14227,41953,309396,148270,147938,33074,14453,27499,109019,39018,25738,240196,158931,52820,8612,95853,21524,137010,84901,70869,70021,116794,48404,38771,6732,1070,70990,187297,49140,5238,576,3564,253975,16027,16483,2811,37775,19034,25259,4053,2e3,70083,95774,19713,33431,92703,91314,42381,288770,48194,95985,3991,77418,13406,241328,245086,56533,35275,62725,9246,51924,70181,95331,16163,31410,79016,39312,120878,119371,275987,80124,27712,9186,220,23598,146167,85209,68238,282190,57048,31273,30555,80913,17594,75779,59160,135002,101219,189377,29225,96735,60126,62522,104e3,27620,86814,17240,147533,11001,5425,43682,410,49460,87270,69480,46315,59448,1816,76201,9431,11788,87960,29063,65539,47347,11678,33846,7008,196704,9895,6753,8633,120892,59970,572824,115934,6646,202559,892,48351,37611,251282,57823,67263,57750,26527,34485,90747,7685,88370,6144,64182,1709,41969,21458,62327,181657,49247,225330,122600,114574,107124,85361,111833,63243,71420,15655,191178,72430,18063,51425,54002,12364,53225,86557,18193,97580,41232,138398,67821,128724,8944,233212,101353,52099,42127,14006,120107,32789,32132,3498,18123,33758,56058,5779,128760,59888,98869,18445,84702,51911,13234,218379,20093,39031,8074,70195,20708,23462,24355,131384,60189,26390,10403,41060,7140,10781,49410,42261,87202,82566,41663,43105,60276,2768,5733,74176,28329,2297,145430,131632,83615,122915,105441,655,224102,5284,136426,67763,16294,188511,32538,61049,27893,3394,13951,159099,28542,17930,145360,9492,190122,32285,78855,26440,13570,58648,73908,4239,124561,2444,74172,53131,11468,10794,73566,11623,35343,64710,30481,4163,10328,38309,29901,10538,154377,76132,92405,24839,11679,3465,13449,11637,7824,2337,57754,1260,14458,41118,19878,38661,13416,159180,37074,163164,54137,28627,52134,184900,8520,40385,29546,30502,22386,66527,107458,6850,24022,47983,30603,35083,8934,304066,39500,9,28261,33026,77251,9374,44833,116312,34990,29236,63563,125639,135405,165398,159055,55690,88141,69643,236964,31983,25572,20436,36746,60896,31850,16179,11828,5888,3043,66368,9750,31167,7915,53111,36430,1333,64344,93659,20061,60596,180191,51630,6792,30244,43509,101058,22409,420,44210,109783,43223,27030,72477,72831,32679,29235,7675,47556,12258,39907,149412,84926,118247,24692,71717,105038,86009,45941,41189,89453,29856,52543,30627,226798,67303,59230,67415,34408,1367,99685,16867,128419,52147,4111,125381,117881,16173,44093,102224,31575,23234,24870,83790,127407,239098,3200,994,1255,100903,242275,117266,55116,38205,16140,29662,11307,40414,208793,123355,56470,4862,75600,30119,58218,70828,24075,26974,7802,192353,4851,5475,78720,66596,3409,28573,64396,30381,30690,59859,88256,5406,99945,103064,34463,37727,24238,86643,60088,4057,23741,5967,162904,38240,28356,93858,25510,122879,6897,3278,7057,11971,4400,35461,211413,21395,59615,39471,87233,55795,128426,3051,22470,41950,14705,3974,180108,80476,78442,204996,91987,15634,67610,139015,142373,35611,51134,10387,4353,153456,57749,181039,14183,68447,151532,21107,36452,20551,3186,46247,46383,129666,88736,140662,146243,2066,8360,7978,64818,106963,17896,47801,10723,114821,223295,74192,3293,3393,16987,74064,11277,91622,4270,29828,27951,387869,103235,1374,61988,120083,477,145892,128378,11779,211263,61354,18221,17869,46530,83061,108538,157981,90608,67199,95080,49064,195814,12302,66307,10348,231346,160732,112859,63633,146558,21271,31037,198802,47622,12862,95710,3910,77850,73961,85585,34752,61e3,4082,24595,103679,71107,8208,79568,150019,16615,24961,139857,32664,197366,4559,54735,32696,4126,162019,75698,13916,70108,159638,19834,9349,24675,175560,49643,18206,52459,27992,10809,88865,401975,133172,29e3,34558,30915,3658,25834,42430,36562,125265,18182,10155,40149,97082,208980,19575,60853,90529,66545,9600,789,46420,2317,88593,55595,98980,115302,5742,169155,1073,177901,3472,11189,63711,78643,65472,50459,127979,93,42202,67053,21720,157650,11145,141378,42033,22824,85705,79114,35584,15974,1510,54172,28562,12451,104226,19190,97151,73024,20948,5151,81741,21499,29006,84183,198074,54003,45120,170125,26240,35177,28389,64863,79974,60778,176915,232183,45342,2038,80253,41564,40703,32689,5430,100689,5366,23007,134279,14266,26712,73993,24934,64242,52113,102887,61801,46415,201049,54251,62133,122757,164883,30815,139966,2319,30842,766,13362,10287,134518,86111,81665,82440,28333,43019,18963,8804,161944,23439,102144,101145,80029,39052,248708,30350,117340,11878,128467,974,138625,63961,5237,74778,61834,67040,43814,13690,65947,33809,232476,115258,181745,28824,94013,9510,10246,93722,81976,7217,114383,3493,16014,69045,72692,12145,80981,9507,6692,1620,60820,330444,35474,33962,4797,7053,295463,46445,27026,12491,77988,49524,35675,90947,29114,166705,101385,133782,32704,6186,84595,176031,185623,45966,151302,63069,1699,107491,947,15458,74452,196212,6046,10498,12163,10239,35191,243951,9277,9090,29539,54460,22820,26514,112549,60372,51753,48756,21812,70861,260326,41,44222,10441,16961,48148,138771,216194,5914,52153,53400,212036,56519,26245,10117,45888,15294,138019,90913,26368,43842,42111,23348,6082,194845,161089,156206,51546,11647,30759,302912,262094,8635,78876,26535,35283,54183,31183,85484,147873,12989,5197,6356,72894,65347,20150,27370,73787,1493,45918,12366,190217,20724,13858,10981,67449,81213,7553,14115,72242,271517,11842,48310,88743,143726,22177,3290,243231,58452,62937,12592,1654,40066,33477,13751,9921,128442,15868,7106,75236,83773,10775,36938,10482,170465,17368,17469,161508,32752,98340,800,19824,264456,3901,87319,2867,26782,9630,113102,185815,24197,44584,86366,40224,3636,140916,31731,267731,9567,53678,72984,29389,27963,17106,50282,284911,60170,8322,12608,23374,89652,5268,39044,229766,8869,151350,31436,177342,12269,183212,120418,116270,2843,78888,69192,7865,184099,1086,129897,18383,70508,20242,18508,229924,124569,35749,50589,55626,9884,83115,40971,30671,18135,14452,38861,17844,201826,5549,26413,17189,13561,38539,10679,143331,3314,36785,171194,49685,187713,67506,4618,104039,17060,195080,50648,33159,19238,67559,134840,28599,157523,17130,38064,117398,94355,31918,13575,34538,40326,13997,3494,348283,62481,26862,3603,104426,244363,153709,112487,304612,199674,41239,35545,54869,293005,28223,26277,26899,4533,18518,15492,38587,80488,70485,160395,263,60162,11382,222152,4696,250751,51921,182609,10707,48463,46243,1227,49111,111564,46502,33342,56846,68541,63559,858,139927,16654,229375,76759,26478,33205,95828,23399,92945,2637,35630,28470,143992,50214,14174,21456,166191,65665,1711,21594,78019,97599,111701,36,147151,110246,189022,43021,30397,40757,131935,42065,73335,48039,26596,28984,15102,2361,7421,202167,69744,43766,52826,3642,83304,33873,75140,63169,192389,36551,92748,13039,123959,233220,21738,84447,77230,20228,187852,19095,25799,92136,108774,29237,53947,2299,118106,2687,8830,42331,202924,33667,2023,73763,30704,19363,19779,16737,35629,48081,24068,101013,162338,291912,13749,24745,328289,167679,70086,48299,23306,16732,17801,43322,54589,3586,63653,43624,53474,925,109177,251316,43805,13082,19511,86565,142182,92461,17117,101033,103319,64589,4022,4351,235897,5352,82705,107142,46391,156084,5860,61365,10558,13045,7717,18357,33922,12590,33065,6928,46993,783,46937,67846,8952,26295,6107,119656,18799,17458,50747,4229,179559,112727,118080,20683,41464,125468,51560,49749,44231,7359,35339,62988,136487,67015,5208,29150,24956,105186,48858,6143,18097,6972,16404,73489,58742,97196,36357,164616,5834,32267,13746,147733,15113,132091,34127,106298,39729,106426,22294,9780,15602,36213,71502,42808,66802,599,60755,5851,39120,67363,108623,126368,72770,91263,32486,30596,151717,7951,52002,43103,11768,68942,40901,39344,24037,127500,116890,48403,16926,86750,17745,48648,159545,34460,58419,5634,114317,67865,31462,23352,24010,98185,125708,69686,68337,13610,26271,70691,2980,4768,27225,102402,75453,28106,8104,6931,1176,6274,6475,112635,22498,6176,238686,26832,28893,90319,14441,15682,15087,39517,45270,109134,104440,45965,47645,81772,7876,52683,87720,12898,4505,185665,2769,113401,15664,57592,105229,137381,97059,119268,6876,43309,33886,128363,35476,144249,67013,143587,83367,25703,91436,59347,53236,2289,16519,19844,46309,58558,99834,23313,218816,231303,36388,51333,183535,109792,139277,54306,90139,18235,8275,32710,37677,82464,86025,92204,88842,117723,37570,128723,234242,76350,73795,34896,148247,58424,11105,11744,45746,63372,17118,49772,199520,81902,38004,22911,33752,3125,1995,53792,4689,26909,108150,146062,69674,41811,161444,84855,8999,28561,16731,93937,3189,21967,24890,22943,1356,145300,51569,28802,517,118679,31703,40607,48098,108854,25003,10233,73969,177495,5248,24516,215347,146192,48712,60626,69188,40735,5866,586,101541,6509,47590,52129,5969,222045,110933,25733,24223,65339,62812,2414,155418,35819,16022,78423,43138,20995,128255,240673,46745,236093,72176,57085,97841,61248,107,36068,193177,105427,55726,215229,20446,47228,100420,87091,14429,121708,23605,21157,187721,21880,2997,203976,99166,95068,25877,7724,98925,83401,4829,13182,18229,13718,239662,38653,116505,153497,30589,89029,38962,181302,43853,78872,180301,4786,248240,7401,106136,112590,77745,19731,60880,77789,125748,135487,5975,48627,34084,12419,215770,47557,254582,10364,106495,21856,67539,88981,38805,21428,48732,42316,12149,16078,52808,25327,51322,33850,51147,12253,122354,46077,56483,254553,115417,81834,150991,94662,86668,7381,12841,100650,18218,15741,22372,68294,50705,15535,84660,61887,22553,72299,31361,24824,17743,46820,64288,31582,77006,111674,116384,30760,80920,86149,77192,51979,79691,60342,122805,103800,240873,160744,233114,78962,54920,8608,3484,316104,72548,24337,5088,230040,21926,10172,36838,26,86221,83458,102176,12062,17571,41929,41170,28428,68239,41750,103930,2634,18313,53019,34825,97837,63115,24606,73157,152474,14715,91439,37033,109806,140259,30668,174760,380,135597,95673,136073,65073,134249,13829,17279,122305,4420,46444,10237,64848,203623,70728,10349,182885,65075,24519,25783,40318,34139,22222,63394,55266,102764,41422,20126,65100,90408,53640,35128,48932,11192,38935,96839,34782,39492,19396,41332,6250,5511,19492,51304,25936,104466,54099,73771,86115,5080,7669,30891,111700,13931,25276,72289,135447,14820,258641,25265,31005,281179,75286,393,95359,14623,13584,6680,101227,80173,44933,76666,54542,13244,39348,458,25379,109451,134348,81143,6959,65554,12027,51311,8716,57589,140731,28467,23316,17272,30458,25980,55229,77197,83798,28302,114784,7428,34548,26241,14712,39336,103304,18928,54080,12870,334,87722,15208,16895,142098,114262,39820,83913,57817,28682,7721,14900,108672,11250,62246,42849,415188,1724,26555,24549,25505,26443,107450,145899,61035,43528,6901,60726,65906,267741,21338,147590,42079,18924,73017,135236,15393,5206,4026,84185,1531,5988,113890,82647,303391,7386,69844,71611,189865,76523,31877,13315,19314,198575,32821,1928,67641,25913,104475,103489,3297,70391,18406,15446,113347,19295,93790,27856,1792,167471,116449,8541,4408,41757,63233,25765,86680,64501,27034,24816,34975,6079,4486,49693,36229,16917,21581,62426,27862,11612,54284,35702,194034,355,24277,48262,87411,70504,310164,118018,12516,47559,43502,57433,107139,9290,66533,80863,14634,34312,91725,28606,21342,67241,72355,43244,375789,37402,174015,105070,8342,44167,67494,1890,16365,11723,271002,1865,47918,8350,45564,27742,25110,125803,8553,49504,81925,62211,4534,15491,19011,80373,206920,667,102405,128623,245524,5553,113309,192739,65766,19567,22832,261958,29679,21293,71134,20962,105123,24721,860,21752,33448,18372,157167,94822,35770,173224,232737,75729,28937,46828,28062,25453,5207,140366,36665,30652,6169,67920,150458,92040,23186,184604,92330,20891,176492,49427,27828,38305,42495,143982,49560,25503,90043,29747,65328,47830,12932,11068,77721,9003,25213,94205,140426,46090,89945,138173,192691,33329,112232,129905,35709,27514,1841,19957,31411,127476,53572,17497,173549,55063,175135,19841,69314,5192,237921,117660,150697,4060,273045,50414,98940,65348,153665,164423,58804,156695,48994,213928,86036,28608,8355,39574,34540,16927,135680,18374,151587,10830,53805,16878,16623,4282,48030,8537,14986,46102,13062,72897,72,33050,108227,39451,45935,651,113320,40535,95176,57450,48843,5003,19019,10407,211163,3848,1068,4988,32091,30095,41692,15099,43602,107434,50744,7627,171349,16313,150832,352665,207750,33937,38256,51091,156e3,87889,90663,84175,24908,114900,50365,31494,83829,5398,169342,47521,54818,18935,8356,43094,41212,174536,10082,92550,6678,60614,23355,69721,14796,34149,128830,58187,3179,208,40325,28399,225029,401412,51150,31580,207268,6657,10993,69818,64282,289845,23308,12961,38447,6681,52944,31855,2572,47646,120728,179148,37240,45196,218274,4816,3695,21961,50084,35209,18073,51452,27004,6100,33941,1377,84831,171214,85,141510,9078,99227,32610,6417,11718,49868,65579,87902,73018,49062,46280,61742,21512,40862,107733,15941,29168,157765,144919,14487,5767,158014,140070,7241,573,71584,16921,223566,40331,179473,35081,47926,140885,41508,52104,59180,42310,32811,29048,123517,102413,80208,10104,14746,12649,153641,126022,37965,113017,4171,83,142592,2809,6362,50416,71323,116894,260776,16204,1524,5760,30351,12658,20703,54403,36083,45408,74772,4946,14485,50759,111222,10890,2195,167147,92962,130534,16283,177256,35016,15472,210156,151187,73922,117691,43250,52051,37392,24811,24358,30830,5775,818,21969,1476,127322,151783,58392,31021,106913,65215,89407,90802,28531,11690,20234,95249,44602,37256,18707,11928,5161,4410,26571,51903,49768,22008,25252,65780,209499,68769,203726,13249,137363,48845,86823,6658,5674,31881,1083,1823,108676,34518,166752,13791,14287,91576,91429,8665,11529,26401,16191,91972,30964,5254,28486,54697,79613,66520,18447,22870,45203,194466,22822,51703,12278,76716,44595,73455,33546,12235,144843,36154,51247,11116,33040,3180,225753,60864,1972,28469,12891,28879,10338,144157,56294,353058,38302,41447,87532,110616,27065,168438,6557,1213,50804,144643,24817,2390,136531,38174,247513,16190,4059,122791,131994,137430,39506,57650,16305,5188,54309,106128,20628,88071,67394,395446,250285,66176,91254,1399,114196,43915,60230,44853,27206,106353,43013,18733,345105,226453,51202,16607,57106,117175,35492,10476,89598,127439,15187,39624,13688,61570,10615,31111,59370,6238,175252,32143,224492,41388,95408,34384,148238,78307,38959,9340,160091,61443,15737,11216,41244,170,38299,102443,113097,26382,14027,33707,3957,76300,66160,19431,18900,6952,1717,108656,82206,188021,257335,27295,43999,41210,31777,46956,57457,12657,11489,15697,48060,204748,53583,82422,284790,30503,137341,8120,19615,220311,15991,10217,63424,9808,67431,70976,98221,4491,15177,28535,144789,751,13230,2394,1504,33977,132104,30316,22230,931,97193,185240,24826,22687,174322,15307,22988,1390,188745,180325,29580,59068,74903,18994,29195,79,15436,7622,38462,11566,138710,44828,45774,37768,99236,68137,84083,19282,22698,17134,74807,126662,173497,46248,16938,119735,3212,28292,213652,49013,9975,32180,45660,86250,4801,68788,95490,77482,113751,11994,44624,94452,46839,128497,100316,5798,58588,73184,202987,65417,37790,88524,1606,43156,97964,105717,34947,11203,100060,37742,130074,93653,107799,94311,196106,41347,8035,10780,16390,27883,118236,167395,1979,25006,19375,31628,18916,144723,78502,114047,103107,86492,107686,5844,20934,206963,23556,22591,16562,146333,20167,10471,117434,33085,2863,9740,36669,41849,37271,22790,18209,28979,8231,12952,54408,21731,25130,45208,55748,138120,75826,414,29593,9925,292865,25999,683,123149,7036,92159,86055,61827,103680,23176,54918,58466,57578,13305,5709,86479,16697,31064,17660,200919,10770,49793,33423,32370,52047,16488,62555,6459,8426,83493,7763,59725,82812,18628,67760,79405,68557,9612,7673,28102,56517,69620,171797,32458,29541,15870,81109,32080,207644,71495,21202,11039,91036,61230,2810,130800,32260,4613,60590,37112,75214,33979,126402,155062,30642,63875,12810,194463,82799,47664,16725,36685,43367,61099,449,172150,102867,21691,301838,36745,7130,18671,57316,34852,38034,54182,35578,65900,99486,19771,3456,2658,16914,99866,28390,28109,8262,21147,34353,20006,4228,137085,1675,203023,283196,198286,214375,163329,290603,152574,40471,83506,30068,14730,23177,131539,34759,27668,32178,71896,104799,116305,85430,119262,42860,25160,8911,23428,49437,105322,6519,16203,6349,74711,1230,38045,8540,75165,44736,25909,51026,317034,4984,32281,91312,27060,44431,17817,45363,155937,239085,35697,59784,91993,29531,126740,213757,76560,167776,285273,24262,8237,65030,41160,74437,48804,118916,13159,37842,1031,75349,1478,11655,108777,23435,277425,101734,67469,70231,124711,43532,28514,65526,54956,1e3,21882,17728,25302,40952,52214,149632,1999,2111,3259,63362,89961,220561,39777,26335,9063,10572,12416,34551,34623,38604,24723,5947,15588,69927,66252,119177,69173,46629,28714,70715,212408,20521,406913,74380,11716,50659,50862,37009,88460,130101,7210,53853,538,65120,151950,55806,163748,52837,13153,21100,16674,64536,6091,138201,44837,58547,3723,163,2177,32288,85454,34033,8497,14282,25742,10535,10741,79559,117493,243787,49337,100718,79495,40139,42956,7551,55433,15421,31509,23034,45081,547,61176,53434,328001,8470,36263,30145,4519,74173,53935,11845,73774,60211,78025,3,4102,73782,109293,315332,48412,26683,13714,6865,20128,18490,104141,325,39470,171970,115860,15707,7268,73301,74336,31370,2368,111827,107757,136231,142844,97138,96638,84053,38691,23801,1588,10573,122098,77039,240,186135,146101,11996,18143,112963,46171,155836,348769,47795,121213,116266,132515,3344,144804,31286,99187,255838,129694,35894,48779,55235,148582,71967,65282,15174,13920,47080,6147,108242,157593,125025,7136,1286,28957,127956,28402,98813,20805,7532,109417,40610,5041,32958,15142,18408,108596,33543,50517,27748,80114,233434,91447,487,37094,100048,30541,43477,10639,89862,155868,37667,8726,60684,237903,73408,99589,12190,38739,97348,3914,13594,2680,149016,13907,30171,28343,23530,115225,61104,35821,147679,14337,4297,244282,24085,326976,56428,7851,21303,131620,71446,83253,68692,111870,5224,15813,38197,49026,45057,13660,3306,76345,40671,27905,91072,996,68527,62085,91351,122634,55109,168209,2024,27560,112707,17352,8306,167115,169921,166958,5031,46020,11844,67284,19130,76185,6920,32849,5450,14610,22451,21002,17392,31872,66682,84796,13709,40210,59898,12029,8719,53564,21462,91884,21647,88379,194428,12754,37797,132826,160016,22567,54383,53186,77611,31107,8339,4694,19185,90355,23597,17222,140675,28442,23668,55977,9128,61555,28774,155229,17658,9390,24379,69357,15752,127381,239631,62460,93181,55913,45133,140155,18676,25249,33164,29581,82837,67223,22362,29975,7317,52813,1943,29613,20012,207130,49617,49651,5636,15334,36313,29226,28084,95247,72072,19e3,224932,15811,114,32127,38097,37508,88507,37225,27359,91626,12193,69279,20608,11055,88156,92808,2152,57259,55275,72789,24475,104414,1708,9882,3818,48661,66897,1631,34806,227930,85815,87753,18321,250664,72733,25107,206797,50891,8082,196411,92596,96764,152823,65514,22819,387277,62176,51225,40329,15563,189,3659,73670,64357,51793,275136,33482,86653,74615,67058,11318,125720,15388,22388,8267,1730,102663,170910,40784,7144,85373,13040,7088,94309,583,44224,140424,77439,18496,164026,36578,4722,9151,5824,63365,26510,35199,40500,79277,32495,44614,35233,9566,203293,152144,7097,2330,183480,98629,13423,330887,44130,68600,30939,97829,31012,345465,56747,94879,4939,160027,149761,99423,46099,32251,15332,8761,96094,128555,5763,235318,222223,55729,30241,55420,201746,3987,81382,8259,49325,23287,7719,24633,251100,92311,18591,110533,64759,170260,393860,7175,21144,132887,3593,75346,101277,91109,16387,259187,11627,57459,173829,44694,55780,49797,89192,120443,62622,3904,14814,23887,1027,112258,64955,99800,11132,66353,36202,48624,18158,88481,96882,43059,11040,2455,7077,21651,181159,99126,100434,61388,68186,19161,110468,120052,8819,55324,41494,7014,37689,3618,87729,92615,207943,9823,128657,12587,15857,6379,67628,51216,71775,157617,63244,1503,3864,218754,110864,5769,21492,7243,1192,87921,85529,31512,18537,42698,35350,73510,84474,34301,8991,21013,35034,566,38832,19838,35586,37216,39413,55006,12178,59742,856,84563,6900,25632,17437,49786,30723,13847,70845,4044,7843,23944,235976,55530,48942,6518,20939,73769,192653,52936,95207,23895,132542,142982,22632,87452,48042,54018,178468,10728,26230,23559,363,81269,142012,5718,346258,31456,84333,246476,51018,66692,101804,120570,39962,30373,70593,2864,60541,19425,54209,104092,7201,31545,48018,25865,15442,46257,40443,8328,6451,111782,47527,97754,33046,470,245116,31095,39,91934,87208,73470,36708,36521,12801,70624,36272,8892,79768,12427,55454,103756,5908,52390,62962,22720,141138,94634,41689,128402,126390,6628,106394,35527,134394,82727,254651,194502,148064,89549,3202,28359,957,21954,27906,49840,142747,8307,24206,48978,1186,71728,133038,71474,91306,6333,110959,74600,70387,18983,62609,56057,22970,1147,135850,1321,28834,3578,59715,102227,32827,81415,99952,55636,257598,390,22702,35701,85872,402916,39216,189795,14929,19467,10112,144422,61514,5279,63421,134686,41436,8424,51925,10598,132295,124416,4604,194739,210929,57866,31829,51626,50007,9976,91878,61906,56168,81906,60918,61859,40017,23059,16887,40927,62064,12785,32893,32913,21782,93965,20169,44387,79084,38463,11457,93950,27127,157050,2697,337088,5116,54128,48255,33279,8821,27352,25515,124022,65710,28906,38557,33390,1722,104435,72215,38551,12094,30978,25113,6671,37355,175109,42862,98024,65406,221276,59624,118012,64637,78760,86697,21426,1639,40350,12584,67193,84144,31396,7863,143011,69629,63112,9454,28666,65798,46372,134721,6314,51402,30837,151922,2847,38676,38008,92823,136245,17540,5504,109295,205242,37606,5211,214892,1586,20670,208711,137743,19328,40652,16995,20023,14657,154919,34422,12996,13918,38221,47690,16398,2959,37680,89122,6721,198469,91876,172043,83898,101992,26084,94570,3635,76958,22853,76497,38266,176590,168403,44464,142840,79180,184594,1984,41806,83147,11985,6546,366068,59732,24533,271505,8736,39084,222992,93429,28962,58985,86665,8432,30028,14548,32439,54424,165029,55175,27458,69046,121277,46168,33732,20661,24581,135574,123110,37556,79260,72611,16957,12939,46162,58238,44907,72936,253758,41324,32518,96480,11949,124438,65280,43256,34107,53533,43531,37037,28366,45970,32741,173438,6121,194202,62969,26355,30314,58370,28455,1848,50519,82830,90393,21761,295490,10936,256940,133568,44050,20269,4089,27457,21610,219460,36743,14821,101388,52005,13124,30979,140816,167362,26054,18458,60789,34917,40447,26606,33422,9066,3452,83614,5761,20263,137238,25038,91310,101,52322,74548,42572,38084,214054,186568,31802,17665,30620,141936,37730,14420,4265,187218,49640,188208,51441,55388,96452,66659,40869,42039,60967,221027,19234,178581,29105,96050,9165,196118,157335,3738,40354,117436,2965,34136,59659,15570,50843,230035,31444,71260,43886,18316,5387,38500,168508,17406,32174,8828,103373,143806,90367,3560,18719,122310,16508,26719,2541,105429,6645,37998,73190,10591,235916,49737,87112,233941,53188,32193,79154,4544,52905,126477,7580,63501,57314,3216,31337,6541,103083,60846,49,9756,15481,1355,43840,14319,13743,27486,10222,73114,230718,418644,16706,6674,279748,23058,45273,295831,86306,2743,5535,88773,21829,35253,120938,31153,3169,16839,42847,8751,80974,33942,36867,35514,16485,26474,77775,56877,5391,48346,3882,108713,31403,27804,55248,26235,43821,136104,40118,175507,28034,203908,18732,1788,34030,106427,36958,54359,7251,44936,15356,69139,455,157915,22173,140291,50348,43275,82066,49621,54952,15216,36226,96695,66855,6936,1987,8227,196087,4631,68827,99004,47541,110265,17953,147605,110242,58520,31312,38724,329975,642,3155,34497,75937,6207,73843,6120,17249,51429,117746,3218,910,68961,319671,14938,29555,34700,1649,66673,72268,9655,76800,153087,6941,210168,27130,35398,1780,73242,3135,56689,19556,165307,8765,35967,121458,13333,70453,17350,117253,22265,13340,44265,39869,441,3742,135025,23581,33309,16543,17731,13291,157637,283005,21408,101360,63887,52312,83873,5338,233779,23759,186949,34531,177320,38069,156465,91004,19353,59852,68160,14891,1338,1072,29823,1950,28901,81407,313445,73038,84807,162348,240257,37162,138934,16111,58013,41253,102951,16457,96056,19541,56402,67217,41638,94381,89674,29481,37456,80815,151579,13937,13683,132537,19699,134545,67020,29816,222341,141235,427578,48868,129557,233342,23077,87871,16213,18728,16184,9469,37913,19680,2798,171356,178328,13216,50049,72690,71904,124644,55455,7504,29052,41036,266546,19899,30391,188755,8659,59469,16,104298,112943,53865,76203,138226,68857,139953,14125,107625,119795,173133,4398,50273,48808,54390,16466,122086,31835,67035,50971,48859,7508,46427,66477,73021,84615,39985,83076,46779,201569,53336,36443,60865,168164,143810,51393,25548,169307,32896,24485,38424,21837,29087,275813,51674,6714,64883,46169,187369,55186,76192,12852,12018,62134,31067,118303,16542,12125,10579,4928,26291,43854,7091,10946,253716,109062,39283,17261,113012,258512,47764,125126,32646,55892,80279,201623,149872,3192,385,1208,48750,5376,58738,22335,5427,82416,47811,32435,143086,38930,94128,59975,156037,37977,38224,62485,7698,50405,71027,16462,21559,136153,34131,107506,162069,63703,3101,215029,40407,4178,3774,9187,80019,17880,97926,67579,2600,18405,8351,47924,86638,70820,92206,86453,29610,42241,119200,3198,15466,67813,57863,35454,4779,99518,4649,104641,144269,33730,38073,65864,6838,109456,193298,154007,5623,45741,30846,182578,25573,157224,1543,58575,138703,146140,44971,49356,18275,59064,20300,13122,11848,24453,11973,9797,86843,2919,25530,49210,1130,161220,76788,75373,85604,34926,36014,17777,17255,51533,11676,92226,51845,119859,21525,5936,18507,28050,1140,31418,14857,34207,47859,10750,36382,32079,106909,59426,87757,38393,110042,15965,97104,33757,35344,97993,53979,33651,45407,41884,82515,173089,7177,58371,35365,47543,51927,35587,10670,23544,29306,84233,39976,76076,62097,9007,8668,28119,78281,120790,19835,143020,54968,18670,64959,20649,34469,42570,33001,136570,87796,120044,1106,58700,63951,127623,12805,83057,40212,31773,49850,7361,54336,347524,101314,23751,19569,48791,29174,49369,20467,7465,75842,38281,623,112457,60210,28849,51003,94720,6426,90047,85560,43761,3579,85105,34607,90410,118528,7224,42907,111163,18168,6960,161135,191298,5247,100584,127552,171568,20121,91173,12636,54615,20199,63730,98105,2396,40387,14438,125012,4765,33235,12865,45299,37728,82098,77872,114037,59253,19675,24838,398016,102561,11446,17069,57508,178277,65836,99941,26114,2585,271882,136866,50126,11027,155648,118367,14585,8910,123015,335383,40434,41016,53021,14439,87098,176860,201543,121888,2358,9286,5739,22666,54270,37884,169381,33984,93859,16124,89364,72207,51639,76366,99029,65812,2198,12147,174891,194289,6986,30252,88822,21284,11445,288337,160821,33034,100869,43852,25761,52882,1144,103809,1924,84458,86079,43411,13542,139276,18141,34978,41298,7276,26481,173800,33210,17951,142652,33616,33677,2210,19941,98568,2486,192414,80136,12058,235883,50963,249638,29572,27221,47034,6124,72107,63346,97620,158513,299699,40388,23235,37176,224244,198386,121323,67992,23827,63170,17838,106622,158590,26807,5345,23489,91891,55474,74834,37981,13058,5977,72552,34706,26828,145172,19904,21367,34043,960,77092,91381,4733,47446,7680,41697,5170,16960,14741,46101,13656,473,51842,37433,11103,11551,121951,13191,97536,165932,50397,51628,129028,9069,44885,6590,59195,47045,32940,225472,90345,21833,13303,29407,96615,141951,5198,6028,18395,7181,3861,14966,156358,167182,36529,55253,25942,173153,30959,27261,50691,150176,162201,38467,48462,80602,42163,118482,168,108756,26011,17166,54149,456538,22512,91374,13816,90358,131615,18132,226707,1824,28139,26860,42253,93877,77351,65575,8980,80574,22020,27948,40422,91324,76376,13528,39281,91685,82215,122541,144066,1983,193851,17283,26320,2739,194978,4790,26845,42627,61300,65815,174612,55133,4200,191130,79771,158321,52280,166796,221620,62461,11278,4067,88152,83409,31717,121367,13522,47325,37945,10406,174348,249321,154101,64912,29938,51775,17220,15776,166138,78890,84425,54121,42861,16368,24572,291647,10197,32073,22651,11677,97509,26952,35787,18424,41910,71614,94977,72318,41594,70024,275419,37702,60199,7335,39107,61315,18271,18394,33768,87884,104277,123724,7277,56288,71981,189803,49320,3352,6798,14240,8954,69220,94433,57372,28620,68863,193727,85575,42309,41667,67689,42081,22543,44824,12719,28540,114236,101553,27638,27296,4300,5353,4663,19379,94098,3758,95888,95144,80344,87320,28447,259518,12718,71391,152731,37063,24132,31911,104896,15672,103782,1521,4945,72541,23717,122632,15619,87175,206120,29428,189780,61416,28350,44457,972,1175,47233,198738,95789,41907,21953,97034,59341,22864,53713,16873,32971,20693,20954,31336,21477,16169,38370,16412,9019,3841,24599,21938,17085,6484,81198,76413,5849,72514,12320,65247,276175,37234,59796,52642,16312,57349,198507,94148,46134,18958,125552,1747,18725,151873,14901,5490,68287,29470,3689,64794,40814,26018,25692,54450,2703,88278,124886,173087,174e3,24159,179477,24276,46004,201876,209202,445,52876,31948,30206,157610,39180,18439,44124,50469,5774,96278,222758,200216,50290,45486,20435,46986,46276,140133,142326,15569,13363,47522,92583,2182,7135,16853,22998,30272,4952,63263,35623,39096,53789,44864,20053,110392,124213,4630,16087,28221,127787,25839,77481,44693,13464,113146,6983,27069,55717,50102,4760,7107,26186,66507,59145,36032,104182,71328,29425,64317,50781,47465,94298,69706,74899,22754,120756,25108,93077,56834,73286,39928,16218,41699,176763,7555,70819,50083,26895,23315,26014,16773,123079,41712,5719,31516,90427,158540,85051,183128,40864,27505,55392,9058,45224,96857,30901,136622,96557,56304,120061,11501,151448,5773,89743,7769,86069,2935,18471,41628,10114,33660,110170,49479,26745,92846,33221,26731,18795,87076,8550,2100,29972,120289,3077,72490,33784,2630,208722,50861,63483,79029,6419,39467,14302,45286,64207,9686,67513,44170,1050,77246,59266,17055,53801,7150,11111,42432,4278,94579,362117,36175,42902,41933,39002,98489,22913,74161,84773,57036,17556,162288,74485,178760,93867,73635,128860,50362,261,67455,80001,46080,35662,4368,25247,19230,74393,22588,1822,27682,235324,13798,85998,13194,235067,23514,71669,147632,23191,134748,214683,105101,1518,25489,247114,7380,54842,26922,3971,26361,20844,68642,170517,77339,123255,8963,77818,150998,48466,36806,2732,23261,11741,236162,18243,126216,28690,50546,16385,92760,197383,246558,201295,88255,67588,71687,176076,172653,169058,33906,63747,24835,157621,43338,30050,46152,132741,2770,51371,94835,6614,15112,11749,56936,1250,19027,399017,58036,100215,23388,55815,308768,124152,94803,9521,64186,8971,28,30427,62163,7616,103838,35079,29203,131235,7743,17389,10882,37420,61460,228512,85363,41581,131077,62822,119647,10130,54445,26925,19968,29016,24446,74028,24176,61448,67185,9254,8563,119129,9771,99184,37716,39514,10532,221512,258753,218630,55980,23394,32141,61924,66749,32411,3741,36475,26678,77010,44946,91203,128749,116953,20476,49625,53116,13735,102335,29376,51946,83407,67892,59212,34685,21083,1546,112982,32972,74397,1078,190545,16082,86140,58591,89611,101531,10061,105104,76319,20035,17551,52611,169061,190842,100780,23907,90413,115619,9675,34710,193435,49443,129734,11183,258877,16318,136182,126808,44635,27304,192375,2599,125648,47051,12091,23814,721,58800,40137,66726,97930,60877,74487,7942,54326,9841,41428,13762,8211,85383,6950,99177,79806,201786,296464,124087,13144,29741,41721,47634,55088,254286,106408,17041,99064,12942,64086,45233,14005,2612,55827,255,7984,13980,38574,12776,46654,73499,249951,2101,26676,25996,132326,116415,119062,50449,31033,23038,11589,179252,20007,14860,129270,21143,17796,144715,60106,70758,69842,34674,282133,44014,16774,57268,38528,24053,46373,201667,28327,471023,51889,102667,21193,114909,84132,69317,96723,67969,16134,68145,15058,28765,32035,2524,101089,98664,25045,76571,14957,86040,118506,262428,154764,81573,39681,283900,73287,127825,544,80448,52347,38512,175971,15180,45467,33086,46552,48894,81107,43213,36672,54025,76703,8053,7608,13299,56619,20752,238099,54164,105133,1444,32942,953,37564,8e3,66316,119463,106817,404,13667,149108,128597,31267,10269,49836,106150,1484,52330,76965,160486,171648,38456,31263,22424,37738,66245,67467,143369,60471,75610,20895,115528,86070,60854,40796,49347,18989,15030,11371,37578,15779,79867,10187,86462,46402,155626,93200,40229,7090,57547,108053,99598,11088,47505,41218,206017,2173,20988,30219,22919,80563,57566,42369,93141,41675,2407,182519,120495,27154,16702,29456,14349,7958,16688,117177,140375,42467,261919,74916,153569,10836,34742,49526,7621,105997,12212,2270,392377,7755,17959,25086,232152,138791,33847,13860,35316,5811,1344,71259,50452,207539,92635,50359,5821,33674,30255,2086,2587,96264,17543,42,6029,9580,43007,139248,82831,12917,29607,25786,51467,42137,85161,100698,31561,88989,121990,278500,3602,109344,37982,15279,116442,28936,30880,87894,58079,128661,126731,67392,28051,146885,4861,16216,97344,42827,147561,153948,22684,21335,47685,1853,43349,15185,59642,10229,25520,187921,108972,5579,98037,24945,6697,19193,63734,137934,75056,89740,19767,224268,56138,63643,151661,39313,70618,84031,89723,84074,13703,85626,35460,8867,64845,3439,57906,99776,63968,49270,81130,34356,16210,23547,36446,34090,140028,72439,2221,22163,57058,363492,113754,18913,95451,48663,54464,54037,176097,68425,3023,34906,29482,117389,341780,80431,58330,16753,92616,60907,94846,147486,4498,48646,7773,46801,7778,18946,464978,47558,33223,177444,7328,15626,63337,94700,11743,9351,255024,39098,16447,42647,96230,39769,58840,10068,63439,35800,65843,58823,413844,9156,51258,7434,61791,85018,6872,3692,28096,7121,33024,6009,75532,31997,192535,9661,3304,9547,14753,31987,25314,55689,15896,20430,39472,31340,99744,25398,115569,54883,28719,205423,23071,57855,64638,149867,25671,82403,37616,20668,39989,77996,74948,140555,175248,64810,36515,46595,4958,248773,24045,28728,136673,168704,20804,114833,100325,27135,21205,96151,153134,45992,7093,13992,76047,1980,19432,145001,75159,87462,17710,1013,45556,34297,144882,20648,26061,11319,129567,108555,18872,464580,33386,22717,65948,167189,5603,135042,79542,8801,202632,18114,91882,5973,5239,67315,4431,60916,47819,71693,32597,32606,18183,45072,80329,76385,24749,51305,40314,156514,14693,130345,13168,66214,18029,12858,34801,27628,14544,10823,40522,40185,33739,148694,23548,9923,61012,28859,17933,19442,34364,99849,164107,141167,30629,21054,6744,36491,8096,42474,41706,155060,30650,10600,163442,1143,96655,61390,52359,7559,51568,64256,203854,4467,22453,14504,436398,7878,6980,8293,63610,293747,16167,35763,19627,147603,15419,18032,110744,51346,33681,54571,40472,48615,39073,21604,13754,173027,92560,11083,47299,63062,11813,52007,29883,9734,139722,15953,1550,20651,13616,49306,16113,90089,92326,7584,30712,72424,164858,6831,152871,55746,197721,34167,196442,6022,112107,55215,7538,123381,4920,43539,77165,8939,50392,34192,20225,79762,22505,58667,40770,29788,97180,82835,4568,8579,13273,363569,35898,49983,436,36598,3237,131691,62418,35591,8101,4073,379438,65218,76072,33887,2968,27573,212619,288680,68278,72851,150504,217896,6913,121339,22017,35340,51072,43616,75043,31437,10833,81487,4364,22968,41454,106687,85446,19863,109625,149241,524,141850,214404,54376,657,237023,9401,108137,53800,32474,49712,53334,126876,27337,45552,177696,8269,15036,12097,42240,2328,125374,119295,99715,2500,19624,39441,27220,102691,60957,94543,39101,18566,67362,13975,78230,25017,34017,239007,90027,39351,41681,35354,43822,1043,916,58587,141983,94818,38799,75459,41114,67432,16195,36606,59568,22272,126769,31424,68659,12287,134302,257977,5756,207285,95637,47248,117689,19583,77451,22373,12200,54993,117118,34244,29386,34562,53819,71267,64172,77665,49368,7716,59301,25749,45426,194789,17297,2650,1766,32501,45198,20403,20984,6600,14171,94604,19037,5402,29896,9938,59935,109708,88081,145182,44844,39167,352626,164173,35374,45982,6122,154,73419,220487,53834,53601,17992,8609,229321,5610,68098,66815,71012,95069,140968,27396,8957,134489,24656,86659,56598,134852,17316,123838,255436,6613,41610,138033,81452,32023,32396,123687,63398,8693,29712,30407,19296,121188,3551,36099,20032,111948,56624,16547,27453,35916,15378,52039,56849,13489,22214,73177,53097,277349,2157,14029,187886,10260,141743,246460,91880,50869,3788,49486,133566,54950,33120,129337,53768,18333,9525,26902,312251,10297,9020,70759,16647,112432,59260,84609,9818,82766,73569,468,46001,75780,55028,52106,11498,43645,108069,17150,17753,29417,16705,31799,9606,289,122254,115975,8620,6133,255357,56908,14456,133464,43554,79224,11247,29630,160,12756,25464,65960,350428,62521,321796,100359,67358,35169,46172,113128,48988,88868,31094,33266,6847,60887,98188,49659,69117,92977,220228,13947,80181,35103,62170,97351,13475,2440,199768,19498,36597,46971,25234,67806,62881,84717,73648,181966,10488,94149,21550,26655,63436,48375,14405,165650,9621,24439,28043,42735,4490,29963,56674,45373,1934,262446,50855,67098,26898,5261,52696,40644,33900,9440,180286,87162,22940,19704,26936,69769,10254,101759,27406,12243,48e3,73926,113215,54935,5726,192787,4312,106216,9366,11550,52949,23457,212271,277152,133895,108374,6191,96477,29980,218916,58024,54696,40853,91124,65894,91170,65908,252552,6793,29212,15389,44516,122515,52617,35058,9017,103536,39510,49136,19242,130652,662077,74699,47024,31422,8517,73351,24399,13867,128360,4810,4434,61779,111983,61036,17798,110240,59722,102960,39688,10001,23803,23039,176498,56659,44814,134295,17188,77577,74466,226175,102472,154333,63900,111747,18062,41171,79669,32773,408933,42562,28931,30907,107388,43487,2946,240310,23938,24354,319,184983,7927,6488,1422,10790,68809,68209,64775,4361,202,17123,59634,51200,44391,18188,17843,2619,74278,3230,9540,47187,21702,36274,56894,43907,16310,34790,16866,6150,5561,13587,107545,108873,126867,86986,28640,33427,19017,5762,80637,17430,46903,2047,131055,25958,13558,5444,47152,13900,44563,122857,45348,70863,39593,54332,38068,33637,318,40310,143467,18502,24520,11377,62013,28942,27246,28269,83545,17999,59015,90707,30065,15161,34720,1263,37008,2012,6060,98575,92933,5721,299,199555,24578,29223,2985,743,115825,109523,136657,47454,26378,53586,3733,174945,93340,244456,5693,37386,28782,89767,27545,23573,18798,136425,34320,84778,20041,48453,38215,7477,71958,40621,8773,5874,187927,105965,51100,43533,18083,8443,10180,43597,2003,183999,69689,12216,129696,146188,62389,34044,68410,12765,43273,26949,266807,3345,34477,79197,5688,47539,213110,21634,22257,50092,32222,42346,39530,63668,98,134978,74022,5152,59088,174145,37220,9934,9545,118937,5724,87240,19875,15784,40143,23263,87513,181654,285152,37881,263241,4966,43934,10433,186657,6470,74416,225854,25908,142677,246262,32280,6192,75890,45546,143264,135305,29742,47013,77787,11732,126658,8763,37950,21806,57557,113464,89465,108995,164574,23894,22996,23169,15369,23117,17642,130607,40503,36239,280990,44666,9981,40427,147487,26869,168452,32886,32991,46798,240839,15111,70502,65697,88548,44145,28701,48767,31139,206777,35659,181164,166262,14554,171445,31786,66523,76607,17956,6507,31279,90476,116611,167918,6560,1243,115324,80128,41867,55897,187323,37069,32596,189444,145931,13390,105530,65709,26805,6999,55714,41300,22915,68951,22138,21120,22264,10058,19945,33635,56123,99085,10032,5818,6016,46649,57476,35264,94413,112522,262288,93686,83038,14341,23204,28807,66084,77987,6101,126673,7133,38126,5923,122091,170240,97772,46874,215746,43948,41622,3272,55596,8332,146411,251315,13533,8561,81521,115449,48616,175175,2063,186556,3036,134537,75772,29728,82360,22973,186559,86348,89100,38388,82297,45610,2613,87082,9986,177812,57884,23591,47485,42543,33582,44713,74439,257444,252451,31825,35631,38540,33066,5147,13973,4343,51830,70378,22827,26448,95560,36896,241741,48067,203953,298860,61620,20450,3220,67272,6586,107662,100160,108684,6929,57226,4762,7457,1320,40404,77204,99309,62750,208653,59977,44e3,74315,34332,5819,172217,64904,114077,18147,84012,1791,98456,90930,21446,116669,103938,7422,85140,59713,5768,326211,16239,75411,13229,29398,10758,236107,1539,112472,95979,152154,151294,306,21196,38146,10700,6891,84282,109646,56492,40539,6589,119491,51354,30685,140209,136906,29622,73617,49553,70525,51671,166869,139616,74395,37439,49595,45678,11959,33211,86560,52434,9282,62690,112155,130810,5243,108261,99970,265613,72551,80049,6391,33365,90721,66737,69872,87011,1860,9032,112544,60905,37371,89015,140351,19076,850,373531,2802,36725,218795,72062,28990,16550,24614,7815,6187,26336,33373,32162,42791,73555,32062,23386,10244,56392,49442,27076,136262,12412,14883,1134,33675,97153,199281,15608,100152,74072,47942,254301,36451,16026,10687,65067,56708,254030,30290,50490,13864,57941,259331,35588,23485,43486,24869,21620,92971,22072,88645,1048,182050,13343,32452,14825,19509,3325,216938,45740,99716,189082,53740,78245,25609,24311,176777,47340,308354,40669,66085,14102,125339,9225,128709,97207,1271,200933,78439,113451,88975,18324,46521,11819,18570,141756,72512,170020,52754,63550,118515,103073,93330,32736,50499,14722,31600,68452,398867,29316,172786,18417,104924,2606,5670,84818,16288,67106,59580,82929,607401,291,85829,359,15897,35830,50696,65630,52672,22115,356968,29895,40837,231192,34024,38957,26722,406,23335,124952,72068,68804,13268,147101,164740,276569,162596,66943,11569,26654,66358,4777,23229,102127,5848,978,2921,59666,5371,28212,90108,42938,39320,2499,4271,108792,33510,125072,71653,65239,38250,66357,38577,13964,86251,35708,50755,36010,29448,12209,3844,38222,206337,100876,67827,137088,14167,252225,84163,195270,1306,5703,54198,779,46802,22028,51124,86759,70560,113164,35685,162145,45471,34561,422,2611,6464,47486,19223,38246,9191,18331,89942,243642,212364,15893,17518,22617,6409,30046,126182,59716,36560,104428,18846,26592,19458,50793,147333,30826,1388,27647,10922,14495,33545,19269,135828,39727,41601,46931,233379,49169,131130,182112,16276,82381,118209,142445,128310,19672,28740,82907,33436,3118,102206,28723,24819,41937,38854,5157,3881,111491,1142,9776,421673,152241,29309,14961,87854,6054,15424,3796,82656,54996,2108,55367,239450,154525,9643,118103,106041,64601,68549,48707,30266,25772,18740,9462,229669,91798,112152,191327,14493,72828,8175,66636,236474,25817,87351,129027,76653,20422,22983,71240,27846,44661,12399,46158,77704,53101,35032,11072,17300,109294,33638,24408,1895,11241,760,17584,82479,125877,63150,141075,34259,23274,81698,15732,43577,48340,91584,14688,16379,24481,150280,96420,262050,48635,43727,61819,56268,72003,88178,17281,79912,13218,122519,125295,166396,11811,2171,118930,67746,17636,178278,174656,95661,173039,83845,79689,17473,98555,127696,203415,54730,22925,232239,9309,12136,175026,20740,180188,10747,39816,314017,266131,10040,175732,112550,220651,31974,37393,888,23008,86799,4303,64905,148467,75337,251,3284,370102,50264,9835,5438,23655,4481,29851,329,12855,7162,64931,78141,12804,42372,296771,83547,18624,34874,86271,3360,48665,77735,88767,11463,63527,28889,22258,29140,194315,113924,25499,6406,31334,1845,4802,49184,43455,35469,127594,92970,61038,115005,38840,87761,106838,8811,20572,55637,11162,96721,132425,108925,2948,125457,36356,3502,75270,27622,127192,2561,123095,49394,61155,16897,110064,9699,89448,53356,19628,220310,21622,83036,9885,112214,6087,26713,17901,161912,91492,3440,68594,9266,92238,8087,6866,150194,72175,80701,13459,31836,43243,239700,95846,44749,50647,21945,230538,120612,132371,244604,5193,105637,34661,41341,68775,85393,1874,8771,33718,49672,77403,595452,99507,6490,58895,128742,7704,39239,73217,43816,62824,37804,199976,22361,80005,87514,94832,14089,4574,139975,59142,75523,100268,43906,53442,15152,2547,186002,17011,19513,204282,3343,60568,128318,119250,4298,51871,41336,71759,21921,45074,98169,145889,99427,11350,1237,5520,28799,7803,53702,21026,136352,38293,128690,12158,90132,44600,10184,26957,39459,126025,78904,82999,59373,39301,150198,120529,153042,20177,50089,14764,271571,30530,123161,38975,101562,22941,5648,124654,109243,69817,71675,49162,106884,21241,107795,30258,16572,188262,141456,7688,60718,8271,11044,32440,104608,103419,236109,93156,43293,128929,42107,67180,25201,115254,185488,130954,72813,167547,20537,39969,38432,22582,184022,1139,27199,5655,17767,97412,122606,209377,27070,35871,326617,188954,42680,73512,80911,22629,3011,95021,315242,157737,383,41821,41808,19335,27950,15674,25677,110950,35375,76835,59108,57370,35262,16569,160415,37706,78086,32041,49691,137143,9782,172080,50148,77917,6323,10110,69172,17711,21795,59511,76184,135114,31046,132319,59105,157578,20549,80778,57649,158421,65143,4575,72235,21899,10797,92745,34035,106079,80159,4508,78304,25350,75457,46458,32937,25623,47,8531,104751,84953,8138,36508,187199,66310,115274,13253,32461,38536,1916,42007,187160,35055,26325,84394,35963,94216,45590,97782],MAX_COMMON_PREFIX_LENGTH=15;class RoutingTableRefresh{log;peerRouting;routingTable;refreshInterval;refreshQueryTimeout;commonPrefixLengthRefreshedAt;refreshTimeoutId;constructor(r,_){const{peerRouting:E,routingTable:S,refreshInterval:C,refreshQueryTimeout:A,logPrefix:I}=_;this.log=r.logger.forComponent(`${I}:routing-table:refresh`),this.peerRouting=E,this.routingTable=S,this.refreshInterval=C??TABLE_REFRESH_INTERVAL,this.refreshQueryTimeout=A??TABLE_REFRESH_QUERY_TIMEOUT,this.commonPrefixLengthRefreshedAt=[],this.refreshTable=this.refreshTable.bind(this)}async start(){this.log(`refreshing routing table every ${this.refreshInterval}ms`),this.refreshTable(!0)}async stop(){this.refreshTimeoutId!=null&&clearTimeout(this.refreshTimeoutId)}refreshTable(r=!1){this.log("refreshing routing table");const _=this._maxCommonPrefix(),E=this._getTrackedCommonPrefixLengthsForRefresh(_);this.log(`max common prefix length ${_}`),this.log(`tracked CPLs [ ${E.map(S=>S.toISOString()).join(", ")} ]`),Promise.all(E.map(async(S,C)=>{try{if(await this._refreshCommonPrefixLength(C,S,r),this._numPeersForCpl(_)===0){const A=Math.min(2*(C+1),E.length-1);for(let I=C+1;I<A+1;I++)try{await this._refreshCommonPrefixLength(I,S,r)}catch(B){this.log.error(B)}}}catch(A){this.log.error(A)}})).catch(S=>{this.log.error(S)}).then(()=>{this.refreshTimeoutId=setTimeout(this.refreshTable,this.refreshInterval),this.refreshTimeoutId.unref!=null&&this.refreshTimeoutId.unref()}).catch(S=>{this.log.error(S)})}async _refreshCommonPrefixLength(r,_,E){if(!E&&_.getTime()>Date.now()-this.refreshInterval){this.log("not running refresh for cpl %s as time since last refresh not above interval",r);return}const S=await this._generateRandomPeerId(r);this.log("starting refreshing cpl %s with key %p (routing table size was %s)",r,S,this.routingTable.size);const C=await length(this.peerRouting.getClosestPeers(S.toBytes(),{signal:AbortSignal.timeout(this.refreshQueryTimeout)}));this.log(`found ${C} peers that were close to imaginary peer %p`,S),this.log("finished refreshing cpl %s with key %p (routing table size is now %s)",r,S,this.routingTable.size)}_getTrackedCommonPrefixLengthsForRefresh(r){r>MAX_COMMON_PREFIX_LENGTH&&(r=MAX_COMMON_PREFIX_LENGTH);const _=[];for(let E=0;E<=r;E++)_[E]=this.commonPrefixLengthRefreshedAt[E]??new Date;return _}async _generateRandomPeerId(r){if(this.routingTable.kb==null)throw new Error("Routing table not started");const _=randomBytes$1(2),E=(_[1]<<8)+_[0],S=await this._makePeerId(this.routingTable.kb.localNodeId,E,r);return peerIdFromBytes$1(S)}async _makePeerId(r,_,E){if(E>MAX_COMMON_PREFIX_LENGTH)throw new Error(`Cannot generate peer ID for common prefix length greater than ${MAX_COMMON_PREFIX_LENGTH}`);const A=new DataView(r.buffer,r.byteOffset,r.byteLength).getUint16(0,!1)^32768>>E,I=65535<<16-(E+1),B=A&I|_&~I,O=GENERATED_PREFIXES[B],N=new ArrayBuffer(34),U=new DataView(N,0,N.byteLength);return U.setUint8(0,sha256$6.code),U.setUint8(1,32),U.setUint32(2,O,!1),new Uint8Array(U.buffer,U.byteOffset,U.byteLength)}_maxCommonPrefix(){let r=0;for(const _ of this._prefixLengths())_>r&&(r=_);return r}_numPeersForCpl(r){let _=0;for(const E of this._prefixLengths())E===r&&_++;return _}*_prefixLengths(){if(this.routingTable.kb!=null)for(const{id:r}of this.routingTable.kb.toIterable()){const _=xor(this.routingTable.kb.localNodeId,r);let E=0;for(const S of _)if(S===0)E++;else break;yield E}}}class AddProviderHandler{providers;log;constructor(r,_){this.log=r.logger.forComponent(`${_.logPrefix}:rpc:handlers:add-provider`),this.providers=_.providers}async handle(r,_){if(this.log("start"),_.key==null||_.key.length===0)throw new CodeError$4("Missing key","ERR_MISSING_KEY");let E;try{E=CID.decode(_.key)}catch{throw new CodeError$4("Invalid CID","ERR_INVALID_CID")}(_.providers==null||_.providers.length===0)&&this.log.error("no providers found in message"),await Promise.all(_.providers.map(async S=>{if(!r.equals(S.id)){this.log("invalid provider peer %p from %p",S.id,r);return}if(S.multiaddrs.length<1){this.log("no valid addresses for provider %p. Ignore",r);return}this.log("received provider %p for %s (addrs %s)",r,E,S.multiaddrs.map(C=>multiaddr(C).toString())),await this.providers.addProvider(E,peerIdFromBytes$1(S.id))}))}}class FindNodeHandler{peerRouting;peerInfoMapper;peerId;addressManager;log;constructor(r,_){const{peerRouting:E,logPrefix:S}=_;this.log=r.logger.forComponent(`${S}:rpc:handlers:find-node`),this.peerId=r.peerId,this.addressManager=r.addressManager,this.peerRouting=E,this.peerInfoMapper=_.peerInfoMapper}async handle(r,_){this.log("incoming request from %p for peers closer to %b",r,_.key);let E=[];if(_.key==null)throw new CodeError$4("Invalid FIND_NODE message received - key was missing","ERR_INVALID_MESSAGE");equals$1(this.peerId.toBytes(),_.key)?E=[{id:this.peerId,multiaddrs:this.addressManager.getAddresses().map(C=>C.decapsulateCode(getProtocol("p2p").code))}]:E=await this.peerRouting.getCloserPeersOffline(_.key,r);const S={type:MessageType.FIND_NODE,clusterLevel:_.clusterLevel,closer:E.map(this.peerInfoMapper).filter(({multiaddrs:C})=>C.length).map(C=>({id:C.id.toBytes(),multiaddrs:C.multiaddrs.map(A=>A.bytes)})),providers:[]};return S.closer.length===0&&this.log("could not find any peers closer to %b than %p",_.key,r),S}}class GetProvidersHandler{peerRouting;providers;peerStore;peerInfoMapper;log;constructor(r,_){const{peerRouting:E,providers:S,logPrefix:C}=_;this.log=r.logger.forComponent(`${C}:rpc:handlers:get-providers`),this.peerStore=r.peerStore,this.peerRouting=E,this.providers=S,this.peerInfoMapper=_.peerInfoMapper}async handle(r,_){if(_.key==null)throw new CodeError$4("Invalid FIND_NODE message received - key was missing","ERR_INVALID_MESSAGE");let E;try{E=CID.decode(_.key)}catch{throw new CodeError$4("Invalid CID","ERR_INVALID_CID")}this.log("%p asking for providers for %s",r,E);const[S,C]=await Promise.all([this.providers.getProviders(E),this.peerRouting.getCloserPeersOffline(_.key,r)]),A=await this._getPeers(S),I=await this._getPeers(C.map(({id:O})=>O)),B={type:MessageType.GET_PROVIDERS,key:_.key,clusterLevel:_.clusterLevel,closer:I.map(this.peerInfoMapper).filter(({multiaddrs:O})=>O.length).map(O=>({id:O.id.toBytes(),multiaddrs:O.multiaddrs.map(N=>N.bytes)})),providers:A.map(this.peerInfoMapper).filter(({multiaddrs:O})=>O.length).map(O=>({id:O.id.toBytes(),multiaddrs:O.multiaddrs.map(N=>N.bytes)}))};return this.log("got %s providers %s closerPeers",B.providers.length,B.closer.length),B}async _getAddresses(r){return[]}async _getPeers(r){const _=[];for(const E of r)try{const S=await this.peerStore.get(E),C=this.peerInfoMapper({id:E,multiaddrs:S.addresses.map(({multiaddr:A})=>A)});C.multiaddrs.length>0&&_.push(C)}catch(S){if(S.code!=="ERR_NOT_FOUND")throw S}return _}}class GetValueHandler{peerStore;datastore;peerRouting;log;constructor(r,_){this.log=r.logger.forComponent(`${_.logPrefix}:rpc:handlers:get-value`),this.peerStore=r.peerStore,this.datastore=r.datastore,this.peerRouting=_.peerRouting}async handle(r,_){const E=_.key;if(this.log("%p asked for key %b",r,E),E==null||E.length===0)throw new CodeError$4("Invalid key","ERR_INVALID_KEY");const S={type:MessageType.GET_VALUE,key:E,clusterLevel:_.clusterLevel,closer:[],providers:[]};if(isPublicKeyKey(E)){this.log("is public key");const I=fromPublicKeyKey(E);let B;try{const O=await this.peerStore.get(I);if(O.id.publicKey==null)throw new CodeError$4("No public key found in key book","ERR_NOT_FOUND");B=O.id.publicKey}catch(O){if(O.code!=="ERR_NOT_FOUND")throw O}if(B!=null)return this.log("returning found public key"),S.record=new Libp2pRecord(E,B,new Date).serialize(),S}const[C,A]=await Promise.all([this._checkLocalDatastore(E),this.peerRouting.getCloserPeersOffline(E,r)]);return C!=null&&(this.log("had record for %b in local datastore",E),S.record=C.serialize()),A.length>0&&(this.log("had %s closer peers in routing table",A.length),S.closer=A.map(I=>({id:I.id.toBytes(),multiaddrs:I.multiaddrs.map(B=>B.bytes)}))),S}async _checkLocalDatastore(r){this.log("checkLocalDatastore looking for %b",r);const _=bufferToRecordKey(r);let E;try{E=await this.datastore.get(_)}catch(C){if(C.code==="ERR_NOT_FOUND")return;throw C}const S=Libp2pRecord.deserialize(E);if(S==null)throw new CodeError$4("Invalid record","ERR_INVALID_RECORD");if(S.timeReceived==null||Date.now()-S.timeReceived.getTime()>MAX_RECORD_AGE){await this.datastore.delete(_);return}return S}}class PingHandler{log;constructor(r,_){this.log=r.logger.forComponent(`${_.logPrefix}:rpc:handlers:ping`)}async handle(r,_){return this.log("ping from %p",r),_}}class PutValueHandler{components;validators;log;constructor(r,_){const{validators:E}=_;this.components=r,this.log=r.logger.forComponent(`${_.logPrefix}:rpc:handlers:put-value`),this.validators=E}async handle(r,_){const E=_.key;if(this.log("%p asked us to store value for key %b",r,E),_.record==null){const S=`Empty record from: ${r.toString()}`;throw this.log.error(S),new CodeError$4(S,"ERR_EMPTY_RECORD")}try{const S=Libp2pRecord.deserialize(_.record);await verifyRecord(this.validators,S),S.timeReceived=new Date;const C=bufferToRecordKey(S.key);await this.components.datastore.put(C,S.serialize().subarray()),this.log("put record for %b into datastore under key %k",E,C)}catch(S){this.log("did not put record for key %b into datastore %o",E,S)}return _}}class RPC{handlers;routingTable;log;constructor(r,_){const{providers:E,peerRouting:S,validators:C,logPrefix:A,peerInfoMapper:I}=_;this.log=r.logger.forComponent(`${A}:rpc`),this.routingTable=_.routingTable,this.handlers={[MessageType.GET_VALUE.toString()]:new GetValueHandler(r,{peerRouting:S,logPrefix:A}),[MessageType.PUT_VALUE.toString()]:new PutValueHandler(r,{validators:C,logPrefix:A}),[MessageType.FIND_NODE.toString()]:new FindNodeHandler(r,{peerRouting:S,logPrefix:A,peerInfoMapper:I}),[MessageType.ADD_PROVIDER.toString()]:new AddProviderHandler(r,{providers:E,logPrefix:A}),[MessageType.GET_PROVIDERS.toString()]:new GetProvidersHandler(r,{peerRouting:S,providers:E,logPrefix:A,peerInfoMapper:I}),[MessageType.PING.toString()]:new PingHandler(r,{logPrefix:A})}}async handleMessage(r,_){try{await this.routingTable.add(r)}catch(S){this.log.error("Failed to update the kbucket store",S)}const E=this.handlers[_.type];if(E==null){this.log.error(`no handler found for message type: ${_.type}`);return}return E.handle(r,_)}onIncomingStream(r){Promise.resolve().then(async()=>{const{stream:_,connection:E}=r,S=E.remotePeer;try{await this.routingTable.add(S)}catch(A){this.log.error(A)}const C=this;await pipe(_,A=>decode$4(A),async function*(A){for await(const I of A){const B=Message$2.decode(I);C.log("incoming %s from %p",B.type,S);const O=await C.handleMessage(S,B);O!=null&&(yield Message$2.encode(O))}},A=>encode$6(A),_)}).catch(_=>{this.log.error(_)})}}class TopologyListener extends TypedEventEmitter{log;components;protocol;running;registrarId;constructor(r,_){super();const{protocol:E,logPrefix:S}=_;this.components=r,this.log=r.logger.forComponent(`${S}:topology-listener`),this.running=!1,this.protocol=E}isStarted(){return this.running}async start(){this.running||(this.running=!0,this.registrarId=await this.components.registrar.register(this.protocol,{onConnect:r=>{this.log("observed peer %p with protocol %s",r,this.protocol),this.dispatchEvent(new CustomEvent$1("peer",{detail:r}))}}))}async stop(){this.running=!1,this.registrarId!=null&&(this.components.registrar.unregister(this.registrarId),this.registrarId=void 0)}}class DHTContentRouting{dht;constructor(r){this.dht=r}async provide(r,_={}){await drain(this.dht.provide(r,_))}async*findProviders(r,_={}){for await(const E of this.dht.findProviders(r,_))E.name==="PROVIDER"&&(yield*E.providers)}async put(r,_,E){await drain(this.dht.put(r,_,E))}async get(r,_){for await(const E of this.dht.get(r,_))if(E.name==="VALUE")return E.value;throw new CodeError$4("Not found","ERR_NOT_FOUND")}}class DHTPeerRouting{dht;constructor(r){this.dht=r}async findPeer(r,_={}){for await(const E of this.dht.findPeer(r,_))if(E.name==="FINAL_PEER")return E.peer;throw new CodeError$4("Not found","ERR_NOT_FOUND")}async*getClosestPeers(r,_={}){for await(const E of this.dht.getClosestPeers(r,_))E.name==="FINAL_PEER"&&(yield E.peer)}}const DEFAULT_MAX_INBOUND_STREAMS$1=32,DEFAULT_MAX_OUTBOUND_STREAMS$1=64;class KadDHT extends TypedEventEmitter{protocol;routingTable;providers;network;peerRouting;components;log;running;kBucketSize;clientMode;validators;selectors;queryManager;contentFetching;contentRouting;routingTableRefresh;rpc;topologyListener;querySelf;maxInboundStreams;maxOutboundStreams;dhtContentRouting;dhtPeerRouting;peerInfoMapper;constructor(r,_){super();const{kBucketSize:E,clientMode:S,validators:C,selectors:A,querySelfInterval:I,protocol:B,logPrefix:O,pingTimeout:N,pingConcurrency:U,maxInboundStreams:j,maxOutboundStreams:z,providers:Z}=_,X=O??"libp2p:kad-dht";this.running=!1,this.components=r,this.log=r.logger.forComponent(X),this.protocol=B??PROTOCOL$1,this.kBucketSize=E??20,this.clientMode=S??!0,this.maxInboundStreams=j??DEFAULT_MAX_INBOUND_STREAMS$1,this.maxOutboundStreams=z??DEFAULT_MAX_OUTBOUND_STREAMS$1,this.peerInfoMapper=_.peerInfoMapper??removePrivateAddressesMapper,this.routingTable=new RoutingTable(r,{kBucketSize:E,pingTimeout:N,pingConcurrency:U,protocol:this.protocol,logPrefix:X}),this.providers=new Providers(r,Z??{}),this.validators={...validators,...C},this.selectors={...selectors,...A},this.network=new Network(r,{protocol:this.protocol,logPrefix:X});const Q=pDefer();_.allowQueryWithZeroPeers===!0&&Q.resolve(),this.queryManager=new QueryManager(r,{disjointPaths:Math.ceil(this.kBucketSize/2),logPrefix:X,initialQuerySelfHasRun:Q,routingTable:this.routingTable}),this.peerRouting=new PeerRouting(r,{routingTable:this.routingTable,network:this.network,validators:this.validators,queryManager:this.queryManager,logPrefix:X}),this.contentFetching=new ContentFetching(r,{validators:this.validators,selectors:this.selectors,peerRouting:this.peerRouting,queryManager:this.queryManager,network:this.network,logPrefix:X}),this.contentRouting=new ContentRouting(r,{network:this.network,peerRouting:this.peerRouting,queryManager:this.queryManager,routingTable:this.routingTable,providers:this.providers,logPrefix:X}),this.routingTableRefresh=new RoutingTableRefresh(r,{peerRouting:this.peerRouting,routingTable:this.routingTable,logPrefix:X}),this.rpc=new RPC(r,{routingTable:this.routingTable,providers:this.providers,peerRouting:this.peerRouting,validators:this.validators,logPrefix:X,peerInfoMapper:this.peerInfoMapper}),this.topologyListener=new TopologyListener(r,{protocol:this.protocol,logPrefix:X}),this.querySelf=new QuerySelf(r,{peerRouting:this.peerRouting,interval:I,initialInterval:_.initialQuerySelfInterval,logPrefix:X,initialQuerySelfHasRun:Q,routingTable:this.routingTable}),this.network.addEventListener("peer",se=>{const oe=se.detail;this.onPeerConnect(oe).catch(ue=>{this.log.error("could not add %p to routing table",oe.id,ue)}),this.dispatchEvent(new CustomEvent$1("peer",{detail:oe}))}),this.topologyListener.addEventListener("peer",se=>{const oe=se.detail;Promise.resolve().then(async()=>{const ue=await this.components.peerStore.get(oe),we={id:oe,multiaddrs:ue.addresses.map(({multiaddr:Te})=>Te),protocols:ue.protocols};await this.onPeerConnect(we)}).catch(ue=>{this.log.error("could not add %p to routing table",oe,ue)})}),this.dhtPeerRouting=new DHTPeerRouting(this),this.dhtContentRouting=new DHTContentRouting(this),_.clientMode==null&&r.events.addEventListener("self:peer:update",se=>{this.log("received update of self-peer info"),Promise.resolve().then(async()=>{const oe=se.detail.peer.addresses.some(({multiaddr:we})=>multiaddrIsPublic(we)),ue=this.getMode();oe&&ue==="client"?await this.setMode("server"):ue==="server"&&!oe&&await this.setMode("client")}).catch(oe=>{this.log.error("error setting dht server mode",oe)})})}get[contentRoutingSymbol](){return this.dhtContentRouting}get[peerRoutingSymbol](){return this.dhtPeerRouting}get[peerDiscoverySymbol](){return this}async onPeerConnect(r){if(this.log("peer %p connected",r.id),r=this.peerInfoMapper(r),r.multiaddrs.length===0){this.log("ignoring %p as there were no valid addresses in %s after filtering",r.id,r.multiaddrs.map(_=>_.toString()));return}try{await this.routingTable.add(r.id)}catch(_){this.log.error("could not add %p to routing table",r.id,_)}}isStarted(){return this.running}getMode(){return this.clientMode?"client":"server"}async setMode(r){await this.components.registrar.unhandle(this.protocol),r==="client"?(this.log("enabling client mode"),this.clientMode=!0):(this.log("enabling server mode"),this.clientMode=!1,await this.components.registrar.handle(this.protocol,this.rpc.onIncomingStream.bind(this.rpc),{maxInboundStreams:this.maxInboundStreams,maxOutboundStreams:this.maxOutboundStreams}))}async start(){this.running=!0,await this.setMode(this.clientMode?"client":"server"),this.querySelf.start(),await Promise.all([this.providers.start(),this.queryManager.start(),this.network.start(),this.routingTable.start(),this.topologyListener.start(),this.routingTableRefresh.start()])}async stop(){this.running=!1,this.querySelf.stop(),await Promise.all([this.providers.stop(),this.queryManager.stop(),this.network.stop(),this.routingTable.stop(),this.routingTableRefresh.stop(),this.topologyListener.stop()])}async*put(r,_,E={}){yield*this.contentFetching.put(r,_,E)}async*get(r,_={}){yield*this.contentFetching.get(r,_)}async*provide(r,_={}){yield*this.contentRouting.provide(r,this.components.addressManager.getAddresses(),_)}async*findProviders(r,_={}){yield*this.contentRouting.findProviders(r,_)}async*findPeer(r,_={}){yield*this.peerRouting.findPeer(r,_)}async*getClosestPeers(r,_={}){yield*this.peerRouting.getClosestPeers(r,_)}async refreshRoutingTable(){this.routingTableRefresh.refreshTable(!0)}}var EventTypes;(function(n){n[n.SEND_QUERY=0]="SEND_QUERY",n[n.PEER_RESPONSE=1]="PEER_RESPONSE",n[n.FINAL_PEER=2]="FINAL_PEER",n[n.QUERY_ERROR=3]="QUERY_ERROR",n[n.PROVIDER=4]="PROVIDER",n[n.VALUE=5]="VALUE",n[n.ADD_PEER=6]="ADD_PEER",n[n.DIAL_PEER=7]="DIAL_PEER"})(EventTypes||(EventTypes={}));function kadDHT(n){return r=>new KadDHT(r,n)}function isHighSurrogate$1(n){return n>=55296&&n<=56319}function isLowSurrogate$1(n){return n>=56320&&n<=57343}var truncate$2=function n(r,_,E){if(typeof _!="string")throw new Error("Input must be string");for(var S=_.length,C=0,A,I,B=0;B<S;B+=1){if(A=_.charCodeAt(B),I=_[B],isHighSurrogate$1(A)&&isLowSurrogate$1(_.charCodeAt(B+1))&&(B+=1,I+=_[B]),C+=r(I),C===E)return _.slice(0,B+1);if(C>E)return _.slice(0,B-I.length+1)}return _};function isHighSurrogate(n){return n>=55296&&n<=56319}function isLowSurrogate(n){return n>=56320&&n<=57343}var browser$2=function n(r){if(typeof r!="string")throw new Error("Input must be string");for(var _=r.length,E=0,S=null,C=null,A=0;A<_;A++)S=r.charCodeAt(A),isLowSurrogate(S)?C!=null&&isHighSurrogate(C)?E+=1:E+=3:S<=127?E+=1:S>=128&&S<=2047?E+=2:S>=2048&&S<=65535&&(E+=3),C=S;return E},truncate$1=truncate$2,getLength=browser$2,browser$1=truncate$1.bind(null,getLength),truncate=browser$1,illegalRe=/[\/\?<>\\:\*\|"]/g,controlRe=/[\x00-\x1f\x80-\x9f]/g,reservedRe=/^\.+$/,windowsReservedRe=/^(con|prn|aux|nul|com[0-9]|lpt[0-9])(\..*)?$/i,windowsTrailingRe=/[\. ]+$/;function sanitize(n,r){if(typeof n!="string")throw new Error("Input must be string");var _=n.replace(illegalRe,r).replace(controlRe,r).replace(reservedRe,r).replace(windowsReservedRe,r).replace(windowsTrailingRe,r);return truncate(_,255)}var sanitizeFilename=function(n,r){var _=r&&r.replacement||"",E=sanitize(n,_);return _===""?E:sanitize(E,"")};const sanitize$1=getDefaultExportFromCjs(sanitizeFilename);var codes$5;(function(n){n.ERR_INVALID_PARAMETERS="ERR_INVALID_PARAMETERS",n.ERR_INVALID_KEY_NAME="ERR_INVALID_KEY_NAME",n.ERR_INVALID_KEY_TYPE="ERR_INVALID_KEY_TYPE",n.ERR_KEY_ALREADY_EXISTS="ERR_KEY_ALREADY_EXISTS",n.ERR_INVALID_KEY_SIZE="ERR_INVALID_KEY_SIZE",n.ERR_KEY_NOT_FOUND="ERR_KEY_NOT_FOUND",n.ERR_OLD_KEY_NAME_INVALID="ERR_OLD_KEY_NAME_INVALID",n.ERR_NEW_KEY_NAME_INVALID="ERR_NEW_KEY_NAME_INVALID",n.ERR_PASSWORD_REQUIRED="ERR_PASSWORD_REQUIRED",n.ERR_PEM_REQUIRED="ERR_PEM_REQUIRED",n.ERR_CANNOT_READ_KEY="ERR_CANNOT_READ_KEY",n.ERR_MISSING_PRIVATE_KEY="ERR_MISSING_PRIVATE_KEY",n.ERR_INVALID_OLD_PASS_TYPE="ERR_INVALID_OLD_PASS_TYPE",n.ERR_INVALID_NEW_PASS_TYPE="ERR_INVALID_NEW_PASS_TYPE",n.ERR_INVALID_PASS_LENGTH="ERR_INVALID_PASS_LENGTH"})(codes$5||(codes$5={}));const keyPrefix="/pkcs8/",infoPrefix="/info/",privates=new WeakMap,NIST={minKeyLength:112/8,minSaltLength:128/8,minIterationCount:1e3},defaultOptions$4={dek:{keyLength:512/8,iterationCount:1e4,salt:"you should override this value with a crypto secure random number",hash:"sha2-512"}};function validateKeyName(n){return n==null||typeof n!="string"?!1:n===sanitize$1(n.trim())&&n.length>0}async function randomDelay(){const _=Math.random()*800+200;await new Promise(E=>setTimeout(E,_))}function DsName(n){return new Key(keyPrefix+n)}function DsInfoName(n){return new Key(infoPrefix+n)}class DefaultKeychain{components;init;log;constructor(r,_){if(this.components=r,this.log=r.logger.forComponent("libp2p:keychain"),this.init=mergeOptions$9(defaultOptions$4,_),this.init.pass!=null&&this.init.pass?.length<20)throw new Error("pass must be least 20 characters");if(this.init.dek?.keyLength!=null&&this.init.dek.keyLength<NIST.minKeyLength)throw new Error(`dek.keyLength must be least ${NIST.minKeyLength} bytes`);if(this.init.dek?.salt?.length!=null&&this.init.dek.salt.length<NIST.minSaltLength)throw new Error(`dek.saltLength must be least ${NIST.minSaltLength} bytes`);if(this.init.dek?.iterationCount!=null&&this.init.dek.iterationCount<NIST.minIterationCount)throw new Error(`dek.iterationCount must be least ${NIST.minIterationCount}`);const E=this.init.pass!=null&&this.init.dek?.salt!=null?pbkdf2(this.init.pass,this.init.dek?.salt,this.init.dek?.iterationCount,this.init.dek?.keyLength,this.init.dek?.hash):"";privates.set(this,{dek:E})}static generateOptions(){const r=Object.assign({},defaultOptions$4),_=Math.ceil(NIST.minSaltLength/3)*3;return r.dek.salt=toString$4(randomBytes$1(_),"base64"),r}static get options(){return defaultOptions$4}async createKey(r,_,E=2048){if(!validateKeyName(r)||r==="self")throw await randomDelay(),new CodeError$4("Invalid key name",codes$5.ERR_INVALID_KEY_NAME);if(typeof _!="string")throw await randomDelay(),new CodeError$4("Invalid key type",codes$5.ERR_INVALID_KEY_TYPE);const S=DsName(r);if(await this.components.datastore.has(S))throw await randomDelay(),new CodeError$4("Key name already exists",codes$5.ERR_KEY_ALREADY_EXISTS);switch(_.toLowerCase()){case"rsa":if(!Number.isSafeInteger(E)||E<2048)throw await randomDelay(),new CodeError$4("Invalid RSA key size",codes$5.ERR_INVALID_KEY_SIZE);break}let A;try{const I=await generateKeyPair$3(_,E),B=await I.id(),O=privates.get(this);if(O==null)throw new CodeError$4("dek missing",codes$5.ERR_INVALID_PARAMETERS);const N=O.dek,U=await I.export(N);A={name:r,id:B};const j=this.components.datastore.batch();j.put(S,fromString$3(U)),j.put(DsInfoName(r),fromString$3(JSON.stringify(A))),await j.commit()}catch(I){throw await randomDelay(),I}return A}async listKeys(){const r={prefix:infoPrefix},_=[];for await(const E of this.components.datastore.query(r))_.push(JSON.parse(toString$4(E.value)));return _}async findKeyById(r){try{const E=(await this.listKeys()).find(S=>S.id===r);if(E==null)throw new CodeError$4(`Key with id '${r}' does not exist.`,codes$5.ERR_KEY_NOT_FOUND);return E}catch(_){throw await randomDelay(),_}}async findKeyByName(r){if(!validateKeyName(r))throw await randomDelay(),new CodeError$4(`Invalid key name '${r}'`,codes$5.ERR_INVALID_KEY_NAME);const _=DsInfoName(r);try{const E=await this.components.datastore.get(_);return JSON.parse(toString$4(E))}catch(E){throw await randomDelay(),this.log.error(E),new CodeError$4(`Key '${r}' does not exist.`,codes$5.ERR_KEY_NOT_FOUND)}}async removeKey(r){if(!validateKeyName(r)||r==="self")throw await randomDelay(),new CodeError$4(`Invalid key name '${r}'`,codes$5.ERR_INVALID_KEY_NAME);const _=DsName(r),E=await this.findKeyByName(r),S=this.components.datastore.batch();return S.delete(_),S.delete(DsInfoName(r)),await S.commit(),E}async renameKey(r,_){if(!validateKeyName(r)||r==="self")throw await randomDelay(),new CodeError$4(`Invalid old key name '${r}'`,codes$5.ERR_OLD_KEY_NAME_INVALID);if(!validateKeyName(_)||_==="self")throw await randomDelay(),new CodeError$4(`Invalid new key name '${_}'`,codes$5.ERR_NEW_KEY_NAME_INVALID);const E=DsName(r),S=DsName(_),C=DsInfoName(r),A=DsInfoName(_);if(await this.components.datastore.has(S))throw await randomDelay(),new CodeError$4(`Key '${_}' already exists`,codes$5.ERR_KEY_ALREADY_EXISTS);try{const B=await this.components.datastore.get(E),O=await this.components.datastore.get(C),N=JSON.parse(toString$4(O));N.name=_;const U=this.components.datastore.batch();return U.put(S,B),U.put(A,fromString$3(JSON.stringify(N))),U.delete(E),U.delete(C),await U.commit(),N}catch(B){throw await randomDelay(),B}}async exportKey(r,_){if(!validateKeyName(r))throw await randomDelay(),new CodeError$4(`Invalid key name '${r}'`,codes$5.ERR_INVALID_KEY_NAME);if(_==null)throw await randomDelay(),new CodeError$4("Password is required",codes$5.ERR_PASSWORD_REQUIRED);const E=DsName(r);try{const S=await this.components.datastore.get(E),C=toString$4(S),A=privates.get(this);if(A==null)throw new CodeError$4("dek missing",codes$5.ERR_INVALID_PARAMETERS);const I=A.dek;return await(await importKey(C,I)).export(_)}catch(S){throw await randomDelay(),S}}async exportPeerId(r){const _="temporary-password",E=await this.exportKey(r,_),S=await importKey(E,_);return peerIdFromKeys$1(S.public.bytes,S.bytes)}async importKey(r,_,E){if(!validateKeyName(r)||r==="self")throw await randomDelay(),new CodeError$4(`Invalid key name '${r}'`,codes$5.ERR_INVALID_KEY_NAME);if(_==null)throw await randomDelay(),new CodeError$4("PEM encoded key is required",codes$5.ERR_PEM_REQUIRED);const S=DsName(r);if(await this.components.datastore.has(S))throw await randomDelay(),new CodeError$4(`Key '${r}' already exists`,codes$5.ERR_KEY_ALREADY_EXISTS);let A;try{A=await importKey(_,E)}catch{throw await randomDelay(),new CodeError$4("Cannot read the key, most likely the password is wrong",codes$5.ERR_CANNOT_READ_KEY)}let I;try{I=await A.id();const N=privates.get(this);if(N==null)throw new CodeError$4("dek missing",codes$5.ERR_INVALID_PARAMETERS);const U=N.dek;_=await A.export(U)}catch(N){throw await randomDelay(),N}const B={name:r,id:I},O=this.components.datastore.batch();return O.put(S,fromString$3(_)),O.put(DsInfoName(r),fromString$3(JSON.stringify(B))),await O.commit(),B}async importPeer(r,_){try{if(!validateKeyName(r))throw new CodeError$4(`Invalid key name '${r}'`,codes$5.ERR_INVALID_KEY_NAME);if(_==null)throw new CodeError$4("PeerId is required",codes$5.ERR_MISSING_PRIVATE_KEY);if(_.privateKey==null)throw new CodeError$4("PeerId.privKey is required",codes$5.ERR_MISSING_PRIVATE_KEY);const E=await unmarshalPrivateKey$1(_.privateKey),S=DsName(r);if(await this.components.datastore.has(S))throw await randomDelay(),new CodeError$4(`Key '${r}' already exists`,codes$5.ERR_KEY_ALREADY_EXISTS);const A=privates.get(this);if(A==null)throw new CodeError$4("dek missing",codes$5.ERR_INVALID_PARAMETERS);const I=A.dek,B=await E.export(I),O={name:r,id:_.toString()},N=this.components.datastore.batch();return N.put(S,fromString$3(B)),N.put(DsInfoName(r),fromString$3(JSON.stringify(O))),await N.commit(),O}catch(E){throw await randomDelay(),E}}async getPrivateKey(r){if(!validateKeyName(r))throw await randomDelay(),new CodeError$4(`Invalid key name '${r}'`,codes$5.ERR_INVALID_KEY_NAME);try{const _=DsName(r),E=await this.components.datastore.get(_);return toString$4(E)}catch(_){throw await randomDelay(),this.log.error(_),new CodeError$4(`Key '${r}' does not exist.`,codes$5.ERR_KEY_NOT_FOUND)}}async rotateKeychainPass(r,_){if(typeof r!="string")throw await randomDelay(),new CodeError$4(`Invalid old pass type '${typeof r}'`,codes$5.ERR_INVALID_OLD_PASS_TYPE);if(typeof _!="string")throw await randomDelay(),new CodeError$4(`Invalid new pass type '${typeof _}'`,codes$5.ERR_INVALID_NEW_PASS_TYPE);if(_.length<20)throw await randomDelay(),new CodeError$4(`Invalid pass length ${_.length}`,codes$5.ERR_INVALID_PASS_LENGTH);this.log("recreating keychain");const E=privates.get(this);if(E==null)throw new CodeError$4("dek missing",codes$5.ERR_INVALID_PARAMETERS);const S=E.dek;this.init.pass=_;const C=_!=null&&this.init.dek?.salt!=null?pbkdf2(_,this.init.dek.salt,this.init.dek?.iterationCount,this.init.dek?.keyLength,this.init.dek?.hash):"";privates.set(this,{dek:C});const A=await this.listKeys();for(const I of A){const B=await this.components.datastore.get(DsName(I.name)),O=toString$4(B),N=await importKey(O,S),U=C.toString(),j=await N.export(U),z=this.components.datastore.batch(),Z={name:I.name,id:I.id};z.put(DsName(I.name),fromString$3(j)),z.put(DsInfoName(I.name),fromString$3(JSON.stringify(Z))),await z.commit()}this.log("keychain reconstructed")}}function keychain(n={}){return r=>new DefaultKeychain(r,n)}class RateLimiter{memoryStorage;points;duration;blockDuration;execEvenly;execEvenlyMinDelayMs;keyPrefix;constructor(r={}){this.points=r.points??4,this.duration=r.duration??1,this.blockDuration=r.blockDuration??0,this.execEvenly=r.execEvenly??!1,this.execEvenlyMinDelayMs=r.execEvenlyMinDelayMs??this.duration*1e3/this.points,this.keyPrefix=r.keyPrefix??"rlflx",this.memoryStorage=new MemoryStorage}async consume(r,_=1,E={}){const S=this.getKey(r),C=this._getKeySecDuration(E);let A=this.memoryStorage.incrby(S,_,C);if(A.remainingPoints=Math.max(this.points-A.consumedPoints,0),A.consumedPoints>this.points)throw this.blockDuration>0&&A.consumedPoints<=this.points+_&&(A=this.memoryStorage.set(S,A.consumedPoints,this.blockDuration)),new CodeError$4("Rate limit exceeded","ERR_RATE_LIMIT_EXCEEDED",A);if(this.execEvenly&&A.msBeforeNext>0&&!A.isFirstInDuration){let I=Math.ceil(A.msBeforeNext/(A.remainingPoints+2));I<this.execEvenlyMinDelayMs&&(I=A.consumedPoints*this.execEvenlyMinDelayMs),await delay(I)}return A}penalty(r,_=1,E={}){const S=this.getKey(r),C=this._getKeySecDuration(E),A=this.memoryStorage.incrby(S,_,C);return A.remainingPoints=Math.max(this.points-A.consumedPoints,0),A}reward(r,_=1,E={}){const S=this.getKey(r),C=this._getKeySecDuration(E),A=this.memoryStorage.incrby(S,-_,C);return A.remainingPoints=Math.max(this.points-A.consumedPoints,0),A}block(r,_){const E=_*1e3,S=this.points+1;return this.memoryStorage.set(this.getKey(r),S,_),{remainingPoints:0,msBeforeNext:E===0?-1:E,consumedPoints:S,isFirstInDuration:!1}}set(r,_,E=0){const S=(E>=0?E:this.duration)*1e3;return this.memoryStorage.set(this.getKey(r),_,E),{remainingPoints:0,msBeforeNext:S===0?-1:S,consumedPoints:_,isFirstInDuration:!1}}get(r){const _=this.memoryStorage.get(this.getKey(r));return _!=null&&(_.remainingPoints=Math.max(this.points-_.consumedPoints,0)),_}delete(r){this.memoryStorage.delete(this.getKey(r))}_getKeySecDuration(r){return r?.customDuration!=null&&r.customDuration>=0?r.customDuration:this.duration}getKey(r){return this.keyPrefix.length>0?`${this.keyPrefix}:${r}`:r}parseKey(r){return r.substring(this.keyPrefix.length)}}class MemoryStorage{storage;constructor(){this.storage=new Map}incrby(r,_,E){const S=this.storage.get(r);if(S!=null){const C=S.expiresAt!=null?S.expiresAt.getTime()-new Date().getTime():-1;return S.expiresAt==null||C>0?(S.value+=_,{remainingPoints:0,msBeforeNext:C,consumedPoints:S.value,isFirstInDuration:!1}):this.set(r,_,E)}return this.set(r,_,E)}set(r,_,E){const S=E*1e3,C=this.storage.get(r);C!=null&&clearTimeout(C.timeoutId);const A={value:_,expiresAt:S>0?new Date(Date.now()+S):void 0};return this.storage.set(r,A),S>0&&(A.timeoutId=setTimeout(()=>{this.storage.delete(r)},S),A.timeoutId.unref!=null&&A.timeoutId.unref()),{remainingPoints:0,msBeforeNext:S===0?-1:S,consumedPoints:A.value,isFirstInDuration:!0}}get(r){const _=this.storage.get(r);if(_!=null)return{remainingPoints:0,msBeforeNext:_.expiresAt!=null?_.expiresAt.getTime()-new Date().getTime():-1,consumedPoints:_.value,isFirstInDuration:!1}}delete(r){const _=this.storage.get(r);return _!=null?(_.timeoutId!=null&&clearTimeout(_.timeoutId),this.storage.delete(r),!0):!1}}var MessageTypes;(function(n){n[n.NEW_STREAM=0]="NEW_STREAM",n[n.MESSAGE_RECEIVER=1]="MESSAGE_RECEIVER",n[n.MESSAGE_INITIATOR=2]="MESSAGE_INITIATOR",n[n.CLOSE_RECEIVER=3]="CLOSE_RECEIVER",n[n.CLOSE_INITIATOR=4]="CLOSE_INITIATOR",n[n.RESET_RECEIVER=5]="RESET_RECEIVER",n[n.RESET_INITIATOR=6]="RESET_INITIATOR"})(MessageTypes||(MessageTypes={}));const MessageTypeNames=Object.freeze({0:"NEW_STREAM",1:"MESSAGE_RECEIVER",2:"MESSAGE_INITIATOR",3:"CLOSE_RECEIVER",4:"CLOSE_INITIATOR",5:"RESET_RECEIVER",6:"RESET_INITIATOR"}),InitiatorMessageTypes=Object.freeze({NEW_STREAM:MessageTypes.NEW_STREAM,MESSAGE:MessageTypes.MESSAGE_INITIATOR,CLOSE:MessageTypes.CLOSE_INITIATOR,RESET:MessageTypes.RESET_INITIATOR}),ReceiverMessageTypes=Object.freeze({MESSAGE:MessageTypes.MESSAGE_RECEIVER,CLOSE:MessageTypes.CLOSE_RECEIVER,RESET:MessageTypes.RESET_RECEIVER}),MAX_MSG_SIZE=1<<20,MAX_MSG_QUEUE_SIZE=4<<20;class Decoder{_buffer;_headerInfo;_maxMessageSize;_maxUnprocessedMessageQueueSize;constructor(r=MAX_MSG_SIZE,_=MAX_MSG_QUEUE_SIZE){this._buffer=new Uint8ArrayList,this._headerInfo=null,this._maxMessageSize=r,this._maxUnprocessedMessageQueueSize=_}write(r){if(r==null||r.length===0)return[];if(this._buffer.append(r),this._buffer.byteLength>this._maxUnprocessedMessageQueueSize)throw Object.assign(new Error("unprocessed message queue size too large!"),{code:"ERR_MSG_QUEUE_TOO_BIG"});const _=[];for(;this._buffer.length!==0;){if(this._headerInfo==null)try{this._headerInfo=this._decodeHeader(this._buffer)}catch(O){if(O.code==="ERR_MSG_TOO_BIG")throw O;break}const{id:E,type:S,length:C,offset:A}=this._headerInfo;if(this._buffer.length-A<C)break;const B={id:E,type:S};(S===MessageTypes.NEW_STREAM||S===MessageTypes.MESSAGE_INITIATOR||S===MessageTypes.MESSAGE_RECEIVER)&&(B.data=this._buffer.sublist(A,A+C)),_.push(B),this._buffer.consume(A+C),this._headerInfo=null}return _}_decodeHeader(r){const{value:_,offset:E}=readVarInt(r),{value:S,offset:C}=readVarInt(r,E),A=_&7;if(MessageTypeNames[A]==null)throw new Error(`Invalid type received: ${A}`);if(S>this._maxMessageSize)throw Object.assign(new Error("message size too large!"),{code:"ERR_MSG_TOO_BIG"});return{id:_>>3,type:A,offset:E+C,length:S}}}const MSB=128,REST=127;function readVarInt(n,r=0){let _=0,E=0,S=r,C;const A=n.length;do{if(S>=A||E>49)throw r=0,new RangeError("Could not decode varint");C=n.get(S++),_+=E<28?(C&REST)<<E:(C&REST)*Math.pow(2,E),E+=7}while(C>=MSB);return r=S-r,{value:_,offset:r}}const POOL_SIZE=10*1024;class Encoder{_pool;_poolOffset;constructor(){this._pool=allocUnsafe$1(POOL_SIZE),this._poolOffset=0}write(r,_){const E=this._pool;let S=this._poolOffset;encode$b(r.id<<3|r.type,E,S),S+=encodingLength(r.id<<3|r.type),(r.type===MessageTypes.NEW_STREAM||r.type===MessageTypes.MESSAGE_INITIATOR||r.type===MessageTypes.MESSAGE_RECEIVER)&&r.data!=null?(encode$b(r.data.length,E,S),S+=encodingLength(r.data.length)):(encode$b(0,E,S),S+=encodingLength(0));const C=E.subarray(this._poolOffset,S);POOL_SIZE-S<100?(this._pool=allocUnsafe$1(POOL_SIZE),this._poolOffset=0):this._poolOffset=S,_.append(C),(r.type===MessageTypes.NEW_STREAM||r.type===MessageTypes.MESSAGE_INITIATOR||r.type===MessageTypes.MESSAGE_RECEIVER)&&r.data!=null&&_.append(r.data)}}const encoder=new Encoder;async function*encode$3(n){for await(const r of n){const _=new Uint8ArrayList;encoder.write(r,_),yield _}}class MplexStream extends AbstractStream{name;streamId;send;types;maxDataSize;constructor(r){super(r),this.types=r.direction==="outbound"?InitiatorMessageTypes:ReceiverMessageTypes,this.send=r.send,this.name=r.name,this.streamId=r.streamId,this.maxDataSize=r.maxDataSize}async sendNewStream(){await this.send({id:this.streamId,type:InitiatorMessageTypes.NEW_STREAM,data:new Uint8ArrayList(fromString$3(this.name))})}async sendData(r){for(r=r.sublist();r.byteLength>0;){const _=Math.min(r.byteLength,this.maxDataSize);await this.send({id:this.streamId,type:this.types.MESSAGE,data:r.sublist(0,_)}),r.consume(_)}}async sendReset(){await this.send({id:this.streamId,type:this.types.RESET})}async sendCloseWrite(){await this.send({id:this.streamId,type:this.types.CLOSE})}async sendCloseRead(){}}function createStream$1(n){const{id:r,name:_,send:E,onEnd:S,type:C="initiator",maxMsgSize:A=MAX_MSG_SIZE}=n;return new MplexStream({id:C==="initiator"?`i${r}`:`r${r}`,streamId:r,name:`${_??r}`,direction:C==="initiator"?"outbound":"inbound",maxDataSize:A,onEnd:S,send:E,log:n.logger.forComponent(`libp2p:mplex:stream:${C}:${r}`)})}const MAX_STREAMS_INBOUND_STREAMS_PER_CONNECTION=1024,MAX_STREAMS_OUTBOUND_STREAMS_PER_CONNECTION=1024,MAX_STREAM_BUFFER_SIZE=1024*1024*4,DISCONNECT_THRESHOLD=5,CLOSE_TIMEOUT$2=500;function printMessage(n){const r={...n,type:`${MessageTypeNames[n.type]} (${n.type})`};return n.type===MessageTypes.NEW_STREAM&&(r.data=toString$4(n.data instanceof Uint8Array?n.data:n.data.subarray())),(n.type===MessageTypes.MESSAGE_INITIATOR||n.type===MessageTypes.MESSAGE_RECEIVER)&&(r.data=toString$4(n.data instanceof Uint8Array?n.data:n.data.subarray(),"base16")),r}class MplexStreamMuxer{protocol="/mplex/6.7.0";sink;source;log;_streamId;_streams;_init;_source;closeController;rateLimiter;closeTimeout;logger;constructor(r,_){_=_??{},this.log=r.logger.forComponent("libp2p:mplex"),this.logger=r.logger,this._streamId=0,this._streams={initiators:new Map,receivers:new Map},this._init=_,this.closeTimeout=_.closeTimeout??CLOSE_TIMEOUT$2,this.sink=this._createSink(),this._source=pushable$1({objectMode:!0,onEnd:()=>{for(const E of this._streams.initiators.values())E.destroy();for(const E of this._streams.receivers.values())E.destroy()}}),this.source=pipe(this._source,E=>encode$3(E)),this.closeController=new AbortController,this.rateLimiter=new RateLimiter({points:_.disconnectThreshold??DISCONNECT_THRESHOLD,duration:1})}get streams(){const r=[];for(const _ of this._streams.initiators.values())r.push(_);for(const _ of this._streams.receivers.values())r.push(_);return r}newStream(r){if(this.closeController.signal.aborted)throw new Error("Muxer already closed");const _=this._streamId++;r=r==null?_.toString():r.toString();const E=this._streams.initiators;return this._newStream({id:_,name:r,type:"initiator",registry:E})}async close(r){if(this.closeController.signal.aborted)return;const _=r?.signal??AbortSignal.timeout(this.closeTimeout);try{await Promise.all(this.streams.map(async E=>E.close({signal:_}))),this._source.end(),await this._source.onEmpty({signal:_}),this.closeController.abort()}catch(E){this.abort(E)}}abort(r){this.closeController.signal.aborted||(this.streams.forEach(_=>{_.abort(r)}),this.closeController.abort(r))}_newReceiverStream(r){const{id:_,name:E}=r,S=this._streams.receivers;return this._newStream({id:_,name:E,type:"receiver",registry:S})}_newStream(r){const{id:_,name:E,type:S,registry:C}=r;if(this.log("new %s stream %s",S,_),S==="initiator"&&this._streams.initiators.size===(this._init.maxOutboundStreams??MAX_STREAMS_OUTBOUND_STREAMS_PER_CONNECTION))throw new CodeError$4("Too many outbound streams open","ERR_TOO_MANY_OUTBOUND_STREAMS");if(C.has(_))throw new Error(`${S} stream ${_} already exists!`);const B=createStream$1({id:_,name:E,send:async O=>{this.log.enabled&&this.log.trace("%s stream %s send",S,_,printMessage(O)),this._source.push(O)},type:S,onEnd:()=>{this.log("%s stream with id %s and protocol %s ended",S,_,B.protocol),C.delete(_),this._init.onStreamEnd!=null&&this._init.onStreamEnd(B)},maxMsgSize:this._init.maxMsgSize,logger:this.logger});return C.set(_,B),B}_createSink(){return async _=>{const E=()=>{closeSource(_,this.log)};this.closeController.signal.addEventListener("abort",E);try{const S=new Decoder(this._init.maxMsgSize,this._init.maxUnprocessedMessageQueueSize);for await(const C of _)for(const A of S.write(C))await this._handleIncoming(A);this._source.end()}catch(S){this.log("error in sink",S),this._source.end(S)}finally{this.closeController.signal.removeEventListener("abort",E)}}}async _handleIncoming(r){const{id:_,type:E}=r;if(this.log.enabled&&this.log.trace("incoming message",printMessage(r)),r.type===MessageTypes.NEW_STREAM){if(this._streams.receivers.size===(this._init.maxInboundStreams??MAX_STREAMS_INBOUND_STREAMS_PER_CONNECTION)){this.log("too many inbound streams open"),this._source.push({id:_,type:MessageTypes.RESET_RECEIVER});try{await this.rateLimiter.consume("new-stream",1)}catch{this.log("rate limit hit when opening too many new streams over the inbound stream limit - closing remote connection"),this.abort(new Error("Too many open streams"));return}return}const I=this._newReceiverStream({id:_,name:toString$4(r.data instanceof Uint8Array?r.data:r.data.subarray())});this._init.onIncomingStream!=null&&this._init.onIncomingStream(I);return}const C=((E&1)===1?this._streams.initiators:this._streams.receivers).get(_);if(C==null){this.log("missing stream %s for message type %s",_,MessageTypeNames[E]);try{await this.rateLimiter.consume("missing-stream",1)}catch{this.log("rate limit hit when receiving messages for streams that do not exist - closing remote connection"),this.abort(new Error("Too many messages for missing streams"));return}return}const A=this._init.maxStreamBufferSize??MAX_STREAM_BUFFER_SIZE;try{switch(E){case MessageTypes.MESSAGE_INITIATOR:case MessageTypes.MESSAGE_RECEIVER:if(C.sourceReadableLength()>A)throw this._source.push({id:r.id,type:E===MessageTypes.MESSAGE_INITIATOR?MessageTypes.RESET_RECEIVER:MessageTypes.RESET_INITIATOR}),new CodeError$4("Input buffer full - increase Mplex maxBufferSize to accommodate slow consumers","ERR_STREAM_INPUT_BUFFER_FULL");C.sourcePush(r.data);break;case MessageTypes.CLOSE_INITIATOR:case MessageTypes.CLOSE_RECEIVER:C.remoteCloseWrite();break;case MessageTypes.RESET_INITIATOR:case MessageTypes.RESET_RECEIVER:C.reset();break;default:this.log("unknown message type %s",E)}}catch(I){this.log.error("error while processing message",I),C.abort(I)}}}class Mplex{protocol="/mplex/6.7.0";_init;components;constructor(r,_={}){this.components=r,this._init=_}createStreamMuxer(r={}){return new MplexStreamMuxer(this.components,{...r,...this._init})}}function mplex(n={}){return r=>new Mplex(r,n)}const PING_LENGTH=32,PROTOCOL_VERSION="1.0.0",PROTOCOL_NAME="ping",PROTOCOL_PREFIX="ipfs",TIMEOUT=1e4,MAX_INBOUND_STREAMS=2,MAX_OUTBOUND_STREAMS=1,ERR_WRONG_PING_ACK="ERR_WRONG_PING_ACK";class PingService{protocol;components;started;timeout;maxInboundStreams;maxOutboundStreams;runOnTransientConnection;log;constructor(r,_={}){this.components=r,this.log=r.logger.forComponent("libp2p:ping"),this.started=!1,this.protocol=`/${_.protocolPrefix??PROTOCOL_PREFIX}/${PROTOCOL_NAME}/${PROTOCOL_VERSION}`,this.timeout=_.timeout??TIMEOUT,this.maxInboundStreams=_.maxInboundStreams??MAX_INBOUND_STREAMS,this.maxOutboundStreams=_.maxOutboundStreams??MAX_OUTBOUND_STREAMS,this.runOnTransientConnection=_.runOnTransientConnection??!0,this.handleMessage=this.handleMessage.bind(this)}async start(){await this.components.registrar.handle(this.protocol,this.handleMessage,{maxInboundStreams:this.maxInboundStreams,maxOutboundStreams:this.maxOutboundStreams,runOnTransientConnection:this.runOnTransientConnection}),this.started=!0}async stop(){await this.components.registrar.unhandle(this.protocol),this.started=!1}isStarted(){return this.started}handleMessage(r){this.log("incoming ping from %p",r.connection.remotePeer);const{stream:_}=r,E=Date.now();pipe(_,_).catch(S=>{this.log.error("incoming ping from %p failed with error",r.connection.remotePeer,S)}).finally(()=>{const S=Date.now()-E;this.log("incoming ping from %p complete in %dms",r.connection.remotePeer,S)})}async ping(r,_={}){this.log("pinging %p",r);const E=Date.now(),S=randomBytes$1(PING_LENGTH),C=await this.components.connectionManager.openConnection(r,_);let A,I=()=>{};if(_.signal==null){const B=AbortSignal.timeout(this.timeout);_={..._,signal:B}}try{A=await C.newStream(this.protocol,{..._,runOnTransientConnection:this.runOnTransientConnection}),I=()=>{A?.abort(new CodeError$4("ping timeout",ERR_TIMEOUT))},_.signal?.addEventListener("abort",I,{once:!0});const B=await pipe([S],A,async N=>first(N)),O=Date.now()-E;if(B==null)throw new CodeError$4(`Did not receive a ping ack after ${O}ms`,ERR_WRONG_PING_ACK);if(!equals$1(S,B.subarray()))throw new CodeError$4(`Received wrong ping ack after ${O}ms`,ERR_WRONG_PING_ACK);return this.log("ping %p complete in %dms",C.remotePeer,O),O}catch(B){throw this.log.error("error while pinging %p",C.remotePeer,B),A?.abort(B),B}finally{_.signal?.removeEventListener("abort",I),A!=null&&await A.close()}}}function ping(n={}){return r=>new PingService(r,n)}var codes$4;(function(n){n.ERR_ALREADY_ABORTED="ERR_ALREADY_ABORTED",n.ERR_DATA_CHANNEL="ERR_DATA_CHANNEL",n.ERR_CONNECTION_CLOSED="ERR_CONNECTION_CLOSED",n.ERR_HASH_NOT_SUPPORTED="ERR_HASH_NOT_SUPPORTED",n.ERR_INVALID_MULTIADDR="ERR_INVALID_MULTIADDR",n.ERR_INVALID_FINGERPRINT="ERR_INVALID_FINGERPRINT",n.ERR_INVALID_PARAMETERS="ERR_INVALID_PARAMETERS",n.ERR_NOT_IMPLEMENTED="ERR_NOT_IMPLEMENTED",n.ERR_TOO_MANY_INBOUND_PROTOCOL_STREAMS="ERR_TOO_MANY_INBOUND_PROTOCOL_STREAMS",n.ERR_TOO_MANY_OUTBOUND_PROTOCOL_STREAMS="ERR_TOO_MANY_OUTBOUND_PROTOCOL_STREAMS"})(codes$4||(codes$4={}));class WebRTCTransportError extends CodeError$4{constructor(r,_){super(`WebRTC transport error: ${r}`,_??""),this.name="WebRTCTransportError"}}class DataChannelError extends WebRTCTransportError{constructor(r,_){super(`[stream: ${r}] data channel error: ${_}`,codes$4.ERR_DATA_CHANNEL),this.name="WebRTC/DataChannelError"}}function dataChannelError(n,r){return new DataChannelError(n,r)}class InappropriateMultiaddrError extends WebRTCTransportError{constructor(r){super(`There was a problem with the Multiaddr which was passed in: ${r}`,codes$4.ERR_INVALID_MULTIADDR),this.name="WebRTC/InappropriateMultiaddrError"}}function inappropriateMultiaddr(n){return new InappropriateMultiaddrError(n)}class InvalidArgumentError extends WebRTCTransportError{constructor(r){super(`There was a problem with a provided argument: ${r}`,codes$4.ERR_INVALID_PARAMETERS),this.name="WebRTC/InvalidArgumentError"}}function invalidArgument(n){return new InvalidArgumentError(n)}class InvalidFingerprintError extends WebRTCTransportError{constructor(r,_){super(`Invalid fingerprint "${r}" within ${_}`,codes$4.ERR_INVALID_FINGERPRINT),this.name="WebRTC/InvalidFingerprintError"}}function invalidFingerprint(n,r){return new InvalidFingerprintError(n,r)}class UnimplementedError extends WebRTCTransportError{constructor(r){super(`A method (${r}) was called though it has been intentionally left unimplemented.`,codes$4.ERR_NOT_IMPLEMENTED),this.name="WebRTC/UnimplementedError"}}function unimplemented(n){return new UnimplementedError(n)}class UnsupportedHashAlgorithmError extends WebRTCTransportError{constructor(r){super(`unsupported hash algorithm: ${r}`,codes$4.ERR_HASH_NOT_SUPPORTED),this.name="WebRTC/UnsupportedHashAlgorithmError"}}function unsupportedHashAlgorithm(n){return new UnsupportedHashAlgorithmError(n)}var __spreadArray=function(n,r,_){if(_||arguments.length===2)for(var E=0,S=r.length,C;E<S;E++)(C||!(E in r))&&(C||(C=Array.prototype.slice.call(r,0,E)),C[E]=r[E]);return n.concat(C||Array.prototype.slice.call(r))},BrowserInfo=function(){function n(r,_,E){this.name=r,this.version=_,this.os=E,this.type="browser"}return n}(),NodeInfo=function(){function n(r){this.version=r,this.type="node",this.name="node",this.os=browser$1$1.platform}return n}(),SearchBotDeviceInfo=function(){function n(r,_,E,S){this.name=r,this.version=_,this.os=E,this.bot=S,this.type="bot-device"}return n}(),BotInfo=function(){function n(){this.type="bot",this.bot=!0,this.name="bot",this.version=null,this.os=null}return n}(),ReactNativeInfo=function(){function n(){this.type="react-native",this.name="react-native",this.version=null,this.os=null}return n}(),SEARCHBOX_UA_REGEX=/alexa|bot|crawl(er|ing)|facebookexternalhit|feedburner|google web preview|nagios|postrank|pingdom|slurp|spider|yahoo!|yandex/,SEARCHBOT_OS_REGEX=/(nuhk|curl|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask\ Jeeves\/Teoma|ia_archiver)/,REQUIRED_VERSION_PARTS=3,userAgentRules=[["aol",/AOLShield\/([0-9\._]+)/],["edge",/Edge\/([0-9\._]+)/],["edge-ios",/EdgiOS\/([0-9\._]+)/],["yandexbrowser",/YaBrowser\/([0-9\._]+)/],["kakaotalk",/KAKAOTALK\s([0-9\.]+)/],["samsung",/SamsungBrowser\/([0-9\.]+)/],["silk",/\bSilk\/([0-9._-]+)\b/],["miui",/MiuiBrowser\/([0-9\.]+)$/],["beaker",/BeakerBrowser\/([0-9\.]+)/],["edge-chromium",/EdgA?\/([0-9\.]+)/],["chromium-webview",/(?!Chrom.*OPR)wv\).*Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["chrome",/(?!Chrom.*OPR)Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["phantomjs",/PhantomJS\/([0-9\.]+)(:?\s|$)/],["crios",/CriOS\/([0-9\.]+)(:?\s|$)/],["firefox",/Firefox\/([0-9\.]+)(?:\s|$)/],["fxios",/FxiOS\/([0-9\.]+)/],["opera-mini",/Opera Mini.*Version\/([0-9\.]+)/],["opera",/Opera\/([0-9\.]+)(?:\s|$)/],["opera",/OPR\/([0-9\.]+)(:?\s|$)/],["pie",/^Microsoft Pocket Internet Explorer\/(\d+\.\d+)$/],["pie",/^Mozilla\/\d\.\d+\s\(compatible;\s(?:MSP?IE|MSInternet Explorer) (\d+\.\d+);.*Windows CE.*\)$/],["netfront",/^Mozilla\/\d\.\d+.*NetFront\/(\d.\d)/],["ie",/Trident\/7\.0.*rv\:([0-9\.]+).*\).*Gecko$/],["ie",/MSIE\s([0-9\.]+);.*Trident\/[4-7].0/],["ie",/MSIE\s(7\.0)/],["bb10",/BB10;\sTouch.*Version\/([0-9\.]+)/],["android",/Android\s([0-9\.]+)/],["ios",/Version\/([0-9\._]+).*Mobile.*Safari.*/],["safari",/Version\/([0-9\._]+).*Safari/],["facebook",/FB[AS]V\/([0-9\.]+)/],["instagram",/Instagram\s([0-9\.]+)/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Mobile/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Gecko\)$/],["curl",/^curl\/([0-9\.]+)$/],["searchbot",SEARCHBOX_UA_REGEX]],operatingSystemRules=[["iOS",/iP(hone|od|ad)/],["Android OS",/Android/],["BlackBerry OS",/BlackBerry|BB10/],["Windows Mobile",/IEMobile/],["Amazon OS",/Kindle/],["Windows 3.11",/Win16/],["Windows 95",/(Windows 95)|(Win95)|(Windows_95)/],["Windows 98",/(Windows 98)|(Win98)/],["Windows 2000",/(Windows NT 5.0)|(Windows 2000)/],["Windows XP",/(Windows NT 5.1)|(Windows XP)/],["Windows Server 2003",/(Windows NT 5.2)/],["Windows Vista",/(Windows NT 6.0)/],["Windows 7",/(Windows NT 6.1)/],["Windows 8",/(Windows NT 6.2)/],["Windows 8.1",/(Windows NT 6.3)/],["Windows 10",/(Windows NT 10.0)/],["Windows ME",/Windows ME/],["Windows CE",/Windows CE|WinCE|Microsoft Pocket Internet Explorer/],["Open BSD",/OpenBSD/],["Sun OS",/SunOS/],["Chrome OS",/CrOS/],["Linux",/(Linux)|(X11)/],["Mac OS",/(Mac_PowerPC)|(Macintosh)/],["QNX",/QNX/],["BeOS",/BeOS/],["OS/2",/OS\/2/]];function detect(n){return n?parseUserAgent(n):typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"?new ReactNativeInfo:typeof navigator<"u"?parseUserAgent(navigator.userAgent):getNodeVersion()}function matchUserAgent(n){return n!==""&&userAgentRules.reduce(function(r,_){var E=_[0],S=_[1];if(r)return r;var C=S.exec(n);return!!C&&[E,C]},!1)}function parseUserAgent(n){var r=matchUserAgent(n);if(!r)return null;var _=r[0],E=r[1];if(_==="searchbot")return new BotInfo;var S=E[1]&&E[1].split(".").join("_").split("_").slice(0,3);S?S.length<REQUIRED_VERSION_PARTS&&(S=__spreadArray(__spreadArray([],S,!0),createVersionParts(REQUIRED_VERSION_PARTS-S.length),!0)):S=[];var C=S.join("."),A=detectOS(n),I=SEARCHBOT_OS_REGEX.exec(n);return I&&I[1]?new SearchBotDeviceInfo(_,C,A,I[1]):new BrowserInfo(_,C,A)}function detectOS(n){for(var r=0,_=operatingSystemRules.length;r<_;r++){var E=operatingSystemRules[r],S=E[0],C=E[1],A=C.exec(n);if(A)return S}return null}function getNodeVersion(){var n=typeof browser$1$1<"u"&&browser$1$1.version;return n?new NodeInfo(browser$1$1.version.slice(1)):null}function createVersionParts(n){for(var r=[],_=0;_<n;_++)r.push("0");return r}const browser=detect(),isFirefox=browser!=null&&browser.name==="firefox",nopSource=async function*n(){},nopSink=async n=>{},DATA_CHANNEL_DRAIN_TIMEOUT=30*1e3;function drainAndClose(n,r,_=DATA_CHANNEL_DRAIN_TIMEOUT,E){n.readyState==="open"&&Promise.resolve().then(async()=>{if(n.bufferedAmount>0){E.log("%s drain channel with %d buffered bytes",r,n.bufferedAmount);const S=pDefer();let C=!1;n.bufferedAmountLowThreshold=0;const A=()=>{C||(E.log("%s drain channel closed before drain",r),S.resolve())};n.addEventListener("close",A,{once:!0}),n.addEventListener("bufferedamountlow",()=>{C=!0,n.removeEventListener("close",A),S.resolve()}),await pTimeout$1(S.promise,{milliseconds:_})}}).then(async()=>{n.readyState==="open"&&n.close()}).catch(S=>{E.log.error("error closing outbound stream",S)})}class WebRTCMultiaddrConnection{log;peerConnection;remoteAddr;timeline;metrics;source=nopSource();sink=nopSink;constructor(r,_){this.log=r.logger.forComponent("libp2p:webrtc:maconn"),this.remoteAddr=_.remoteAddr,this.timeline=_.timeline,this.peerConnection=_.peerConnection;const E=this.peerConnection.connectionState;this.peerConnection.onconnectionstatechange=()=>{this.log.trace("peer connection state change",this.peerConnection.connectionState,"initial state",E),(this.peerConnection.connectionState==="disconnected"||this.peerConnection.connectionState==="failed"||this.peerConnection.connectionState==="closed")&&(this.timeline.close=Date.now())}}async close(r){this.log.trace("closing connection"),this.peerConnection.close(),this.timeline.close=Date.now(),this.metrics?.increment({close:!0})}abort(r){this.log.error("closing connection due to error",r),this.peerConnection.close(),this.timeline.close=Date.now(),this.metrics?.increment({abort:!0})}}var Message$1;(function(n){(function(E){E.FIN="FIN",E.STOP_SENDING="STOP_SENDING",E.RESET="RESET",E.FIN_ACK="FIN_ACK"})(n.Flag||(n.Flag={}));let r;(function(E){E[E.FIN=0]="FIN",E[E.STOP_SENDING=1]="STOP_SENDING",E[E.RESET=2]="RESET",E[E.FIN_ACK=3]="FIN_ACK"})(r||(r={})),function(E){E.codec=()=>enumeration(r)}(n.Flag||(n.Flag={}));let _;n.codec=()=>(_==null&&(_=message((E,S,C={})=>{C.lengthDelimited!==!1&&S.fork(),E.flag!=null&&(S.uint32(8),n.Flag.codec().encode(E.flag,S)),E.message!=null&&(S.uint32(18),S.bytes(E.message)),C.lengthDelimited!==!1&&S.ldelim()},(E,S)=>{const C={},A=S==null?E.len:E.pos+S;for(;E.pos<A;){const I=E.uint32();switch(I>>>3){case 1:C.flag=n.Flag.codec().decode(E);break;case 2:C.message=E.bytes();break;default:E.skipType(I&7);break}}return C})),_),n.encode=E=>encodeMessage(E,n.codec()),n.decode=E=>decodeMessage$1(E,n.codec())})(Message$1||(Message$1={}));const MAX_BUFFERED_AMOUNT=16*1024*1024,BUFFERED_AMOUNT_LOW_TIMEOUT=30*1e3,PROTOBUF_OVERHEAD=5,VARINT_LENGTH=2,MAX_MESSAGE_SIZE=16*1024,FIN_ACK_TIMEOUT=5e3,OPEN_TIMEOUT=5e3;class WebRTCStream extends AbstractStream{channel;incomingData;maxBufferedAmount;bufferedAmountLowEventTimeout;maxMessageSize;receiveFinAck;finAckTimeout;openTimeout;constructor(r){const _=r.onEnd;switch(r.onEnd=S=>{this.log.trace("readable and writeable ends closed",this.status),Promise.resolve(async()=>{if(!(this.timeline.abort!=null||this.timeline.reset!==null))try{await pTimeout$1(this.receiveFinAck.promise,{milliseconds:this.finAckTimeout})}catch(C){this.log.error("error receiving FIN_ACK",C)}}).then(()=>{this.incomingData.end(),_?.(S)}).catch(C=>{this.log.error("error ending stream",C)})},super(r),this.channel=r.channel,this.channel.binaryType="arraybuffer",this.incomingData=pushable$1(),this.bufferedAmountLowEventTimeout=r.bufferedAmountLowEventTimeout??BUFFERED_AMOUNT_LOW_TIMEOUT,this.maxBufferedAmount=r.maxBufferedAmount??MAX_BUFFERED_AMOUNT,this.maxMessageSize=(r.maxMessageSize??MAX_MESSAGE_SIZE)-PROTOBUF_OVERHEAD-VARINT_LENGTH,this.receiveFinAck=pDefer(),this.finAckTimeout=r.closeTimeout??FIN_ACK_TIMEOUT,this.openTimeout=r.openTimeout??OPEN_TIMEOUT,this.channel.readyState){case"open":this.timeline.open=new Date().getTime();break;case"closed":case"closing":(this.timeline.close===void 0||this.timeline.close===0)&&(this.timeline.close=Date.now());break;case"connecting":break;default:throw this.log.error("unknown datachannel state %s",this.channel.readyState),new CodeError$4("Unknown datachannel state","ERR_INVALID_STATE")}this.channel.onopen=S=>{this.timeline.open=new Date().getTime()},this.channel.onclose=S=>{this.receiveFinAck.resolve(),this.close().catch(C=>{this.log.error("error closing stream after channel closed",C)})},this.channel.onerror=S=>{const C=S.error;this.abort(C)},this.channel.onmessage=async S=>{const{data:C}=S;C===null||C.byteLength===0||this.incomingData.push(new Uint8Array(C,0,C.byteLength))};const E=this;Promise.resolve().then(async()=>{for await(const S of decode$4(this.incomingData)){const C=E.processIncomingProtobuf(S);C!=null&&E.sourcePush(new Uint8ArrayList(C))}}).catch(S=>{this.log.error("error processing incoming data channel messages",S)})}sendNewStream(){}async _sendMessage(r,_=!0){if(_&&this.channel.bufferedAmount>this.maxBufferedAmount)try{this.log('channel buffer is %d, wait for "bufferedamountlow" event',this.channel.bufferedAmount),await pEvent(this.channel,"bufferedamountlow",{timeout:this.bufferedAmountLowEventTimeout})}catch(E){throw E instanceof TimeoutError$1?new CodeError$4(`Timed out waiting for DataChannel buffer to clear after ${this.bufferedAmountLowEventTimeout}ms`,"ERR_BUFFER_CLEAR_TIMEOUT"):E}if(this.channel.readyState==="closed"||this.channel.readyState==="closing")throw new CodeError$4(`Invalid datachannel state - ${this.channel.readyState}`,"ERR_INVALID_STATE");this.channel.readyState!=="open"&&(this.log('channel state is "%s" and not "open", waiting for "open" event before sending data',this.channel.readyState),await pEvent(this.channel,"open",{timeout:this.openTimeout}),this.log('channel state is now "%s", sending data',this.channel.readyState)),this.channel.send(r.subarray())}async sendData(r){for(r=r.sublist();r.byteLength>0;){const _=Math.min(r.byteLength,this.maxMessageSize),E=r.subarray(0,_),S=Message$1.encode({message:E}),C=encode$6.single(S);await this._sendMessage(C),r.consume(_)}}async sendReset(){await this._sendFlag(Message$1.Flag.RESET)}async sendCloseWrite(r){if(await this._sendFlag(Message$1.Flag.FIN)){this.log.trace("awaiting FIN_ACK");try{await raceSignal(this.receiveFinAck.promise,r?.signal,{errorMessage:"sending close-write was aborted before FIN_ACK was received",errorCode:"ERR_FIN_ACK_NOT_RECEIVED"})}catch(E){this.log.error("failed to await FIN_ACK",E)}}else this.log.trace("sending FIN failed, not awaiting FIN_ACK");this.receiveFinAck.resolve()}async sendCloseRead(){await this._sendFlag(Message$1.Flag.STOP_SENDING)}processIncomingProtobuf(r){const _=Message$1.decode(r);if(_.flag!==void 0&&(this.log.trace('incoming flag %s, write status "%s", read status "%s"',_.flag,this.writeStatus,this.readStatus),_.flag===Message$1.Flag.FIN&&(this.remoteCloseWrite(),this.log.trace("sending FIN_ACK"),this._sendFlag(Message$1.Flag.FIN_ACK).catch(E=>{this.log.error("error sending FIN_ACK immediately",E)})),_.flag===Message$1.Flag.RESET&&this.reset(),_.flag===Message$1.Flag.STOP_SENDING&&this.remoteCloseRead(),_.flag===Message$1.Flag.FIN_ACK&&(this.log.trace("received FIN_ACK"),this.receiveFinAck.resolve())),this.readStatus==="ready")return _.message}async _sendFlag(r){if(this.channel.readyState!=="open")return this.log.trace('not sending flag %s because channel is "%s" and not "open"',this.channel.readyState,r.toString()),!1;this.log.trace("sending flag %s",r.toString());const _=Message$1.encode({flag:r}),E=encode$6.single(_);try{return await this._sendMessage(E,!1),!0}catch(S){this.log.error("could not send flag %s",r.toString(),S)}return!1}}function createStream(n){const{channel:r,direction:_}=n;return new WebRTCStream({id:_==="inbound"?`i${r.id}`:`r${r.id}`,log:n.logger.forComponent(`libp2p:webrtc:stream:${_}:${r.id}`),...n})}const PROTOCOL="/webrtc";class DataChannelMuxerFactory{protocol;peerConnection;bufferedStreams=[];metrics;dataChannelOptions;components;log;constructor(r,_){this.components=r,this.peerConnection=_.peerConnection,this.metrics=_.metrics,this.protocol=_.protocol??PROTOCOL,this.dataChannelOptions=_.dataChannelOptions??{},this.log=r.logger.forComponent("libp2p:webrtc:datachannelmuxerfactory"),this.peerConnection.ondatachannel=({channel:E})=>{if(this.log.trace('incoming early datachannel with channel id %d and label "%s"',E.id),E.label==="init"){this.log.trace("closing early init channel"),E.close();return}const S={},C=createStream({channel:E,direction:"inbound",onEnd:A=>{S.onEnd(A)},logger:r.logger,...this.dataChannelOptions});S.stream=C,S.channel=E,S.onEnd=()=>{this.bufferedStreams=this.bufferedStreams.filter(A=>A.stream.id!==C.id)},this.bufferedStreams.push(S)}}createStreamMuxer(r){return new DataChannelMuxer(this.components,{...r,peerConnection:this.peerConnection,dataChannelOptions:this.dataChannelOptions,metrics:this.metrics,streams:this.bufferedStreams,protocol:this.protocol})}}class DataChannelMuxer{init;streams;protocol;log;peerConnection;dataChannelOptions;metrics;logger;constructor(r,_){this.init=_,this.log=r.logger.forComponent("libp2p:webrtc:muxer"),this.logger=r.logger,this.streams=_.streams.map(E=>E.stream),this.peerConnection=_.peerConnection,this.protocol=_.protocol??PROTOCOL,this.metrics=_.metrics,this.dataChannelOptions=_.dataChannelOptions??{},this.peerConnection.ondatachannel=({channel:E})=>{if(this.log.trace("incoming datachannel with channel id %d",E.id),E.label==="init"){this.log.trace("closing init channel"),E.close();return}const S=createStream({channel:E,direction:"inbound",onEnd:()=>{this.log("incoming channel %s ended with state %s",E.id,E.readyState),this.#e(S,E)},logger:this.logger,...this.dataChannelOptions});this.streams.push(S),this.metrics?.increment({incoming_stream:!0}),_?.onIncomingStream?.(S)},this.init.streams.length>0&&queueMicrotask(()=>{this.init.streams.forEach(E=>{E.onEnd=()=>{this.log("incoming early channel %s ended with state %s",E.channel.id,E.channel.readyState),this.#e(E.stream,E.channel)},this.metrics?.increment({incoming_stream:!0}),this.init?.onIncomingStream?.(E.stream)})})}#e(r,_){this.log.trace("stream %s %s %s onEnd",r.direction,r.id,r.protocol),drainAndClose(_,`${r.direction} ${r.id} ${r.protocol}`,this.dataChannelOptions.drainTimeout,{log:this.log}),this.streams=this.streams.filter(E=>E.id!==r.id),this.metrics?.increment({stream_end:!0}),this.init?.onStreamEnd?.(r)}async close(r){try{await Promise.all(this.streams.map(async _=>_.close(r)))}catch(_){this.abort(_)}}abort(r){for(const _ of this.streams)_.abort(r)}source=nopSource();sink=nopSink;newStream(){const r=this.peerConnection.createDataChannel("");this.log.trace("opened outgoing datachannel with channel id %s",r.id);const _=createStream({channel:r,direction:"outbound",onEnd:()=>{this.log("outgoing channel %s ended with state %s",r.id,r.readyState),this.#e(_,r)},logger:this.logger,...this.dataChannelOptions});return this.streams.push(_),this.metrics?.increment({outgoing_stream:!0}),_}}const RTCPeerConnection=globalThis.RTCPeerConnection,RTCSessionDescription=globalThis.RTCSessionDescription,RTCIceCandidate=globalThis.RTCIceCandidate;var Message;(function(n){(function(E){E.SDP_OFFER="SDP_OFFER",E.SDP_ANSWER="SDP_ANSWER",E.ICE_CANDIDATE="ICE_CANDIDATE"})(n.Type||(n.Type={}));let r;(function(E){E[E.SDP_OFFER=0]="SDP_OFFER",E[E.SDP_ANSWER=1]="SDP_ANSWER",E[E.ICE_CANDIDATE=2]="ICE_CANDIDATE"})(r||(r={})),function(E){E.codec=()=>enumeration(r)}(n.Type||(n.Type={}));let _;n.codec=()=>(_==null&&(_=message((E,S,C={})=>{C.lengthDelimited!==!1&&S.fork(),E.type!=null&&(S.uint32(8),n.Type.codec().encode(E.type,S)),E.data!=null&&(S.uint32(18),S.string(E.data)),C.lengthDelimited!==!1&&S.ldelim()},(E,S)=>{const C={},A=S==null?E.len:E.pos+S;for(;E.pos<A;){const I=E.uint32();switch(I>>>3){case 1:C.type=n.Type.codec().decode(E);break;case 2:C.data=E.string();break;default:E.skipType(I&7);break}}return C})),_),n.encode=E=>encodeMessage(E,n.codec()),n.decode=E=>decodeMessage$1(E,n.codec())})(Message||(Message={}));const readCandidatesUntilConnected=async(n,r,_)=>{try{const E=pDefer();for(resolveOnConnected(n,E);;){const S=await Promise.race([E.promise,r.read({signal:_.signal})]);if(S==null)break;if(S.type!==Message.Type.ICE_CANDIDATE)throw new CodeError$4("ICE candidate message expected","ERR_NOT_ICE_CANDIDATE");const C=JSON.parse(S.data??"null");if(C===""||C===null){_.log.trace("end-of-candidates received");continue}const A=new RTCIceCandidate(C);_.log.trace("%s received new ICE candidate",_.direction,A);try{await n.addIceCandidate(A)}catch(I){_.log.error("%s bad candidate received",_.direction,C,I)}}}catch(E){if(_.log.error("%s error parsing ICE candidate",_.direction,E),_.signal?.aborted===!0)throw E}};function getConnectionState(n){return isFirefox?n.iceConnectionState:n.connectionState}function resolveOnConnected(n,r){n[isFirefox?"oniceconnectionstatechange":"onconnectionstatechange"]=_=>{switch(getConnectionState(n)){case"connected":r.resolve();break;case"failed":case"disconnected":case"closed":r.reject(new CodeError$4("RTCPeerConnection was closed","ERR_CONNECTION_CLOSED_BEFORE_CONNECTED"));break}}}async function initiateConnection({peerConnection:n,signal:r,metrics:_,multiaddr:E,connectionManager:S,transportManager:C,log:A}){const{baseAddr:I}=splitAddr(E);_?.dialerEvents.increment({open:!0}),A.trace("dialing base address: %a",I);const B=I.getPeerId();if(B==null)throw new CodeError$4("Relay peer was missing","ERR_INVALID_ADDRESS");const O=S.getConnections(peerIdFromString$1(B));let N,U=!1;O.length===0?(N=await C.dial(I,{signal:r}),U=!0):N=O[0];try{const j=await N.newStream(SIGNALING_PROTO_ID,{signal:r,runOnTransientConnection:!0}),z=pbStream(j).pb(Message);try{const Z=n.createDataChannel("init");n.onicecandidate=({candidate:oe})=>{const ue=JSON.stringify(oe?.toJSON()??null);A.trace("initiator sending ICE candidate %s",ue),z.write({type:Message.Type.ICE_CANDIDATE,data:ue},{signal:r}).catch(we=>{A.error("error sending ICE candidate",we)})},n.onicecandidateerror=oe=>{A.error("initiator ICE candidate error",oe)};const X=await n.createOffer().catch(oe=>{throw A.error("could not execute createOffer",oe),new CodeError$4("Failed to set createOffer","ERR_SDP_HANDSHAKE_FAILED")});A.trace("initiator send SDP offer %s",X.sdp),await z.write({type:Message.Type.SDP_OFFER,data:X.sdp},{signal:r}),await n.setLocalDescription(X).catch(oe=>{throw A.error("could not execute setLocalDescription",oe),new CodeError$4("Failed to set localDescription","ERR_SDP_HANDSHAKE_FAILED")});const Q=await z.read({signal:r});if(Q.type!==Message.Type.SDP_ANSWER)throw new CodeError$4("Remote should send an SDP answer","ERR_SDP_HANDSHAKE_FAILED");A.trace("initiator receive SDP answer %s",Q.data);const se=new RTCSessionDescription({type:"answer",sdp:Q.data});return await n.setRemoteDescription(se).catch(oe=>{throw A.error("could not execute setRemoteDescription",oe),new CodeError$4("Failed to set remoteDescription","ERR_SDP_HANDSHAKE_FAILED")}),A.trace("initiator read candidates until connected"),await readCandidatesUntilConnected(n,z,{direction:"initiator",signal:r,log:A}),A.trace("initiator connected, closing init channel"),Z.close(),A.trace("initiator closing signalling stream"),await z.unwrap().unwrap().close({signal:r}),A.trace("initiator connected to remote address %s",E),{remoteAddress:E}}catch(Z){throw n.close(),j.abort(Z),Z}finally{n.onicecandidate=null,n.onicecandidateerror=null}}finally{if(U)try{await N.close({signal:r})}catch(j){N.abort(j)}}}class WebRTCPeerListener extends TypedEventEmitter{peerId;transportManager;shutdownController;constructor(r,_){super(),this.peerId=r.peerId,this.transportManager=r.transportManager,this.shutdownController=_.shutdownController}async listen(){this.safeDispatchEvent("listening",{})}getAddrs(){return this.transportManager.getListeners().filter(r=>r!==this).map(r=>r.getAddrs().filter(_=>Circuit$1.matches(_)).map(_=>_.encapsulate(`/webrtc/p2p/${this.peerId}`))).flat()}async close(){this.shutdownController.abort(),this.safeDispatchEvent("close",{})}}async function handleIncomingStream({peerConnection:n,stream:r,signal:_,connection:E,log:S}){S.trace("new inbound signaling stream");const C=pbStream(r).pb(Message);try{n.onicecandidate=({candidate:N})=>{const U=JSON.stringify(N?.toJSON()??null);S.trace("recipient sending ICE candidate %s",U),C.write({type:Message.Type.ICE_CANDIDATE,data:U},{signal:_}).catch(j=>{S.error("error sending ICE candidate",j)})};const I=await C.read({signal:_});if(I.type!==Message.Type.SDP_OFFER)throw new CodeError$4(`expected message type SDP_OFFER, received: ${I.type??"undefined"} `,"ERR_SDP_HANDSHAKE_FAILED");S.trace("recipient receive SDP offer %s",I.data);const B=new RTCSessionDescription({type:"offer",sdp:I.data});await n.setRemoteDescription(B).catch(N=>{throw S.error("could not execute setRemoteDescription",N),new CodeError$4("Failed to set remoteDescription","ERR_SDP_HANDSHAKE_FAILED")});const O=await n.createAnswer().catch(N=>{throw S.error("could not execute createAnswer",N),new CodeError$4("Failed to create answer","ERR_SDP_HANDSHAKE_FAILED")});S.trace("recipient send SDP answer %s",O.sdp),await C.write({type:Message.Type.SDP_ANSWER,data:O.sdp},{signal:_}),await n.setLocalDescription(O).catch(N=>{throw S.error("could not execute setLocalDescription",N),new CodeError$4("Failed to set localDescription","ERR_SDP_HANDSHAKE_FAILED")}),S.trace("recipient read candidates until connected"),await readCandidatesUntilConnected(n,C,{direction:"recipient",signal:_,log:S})}catch(I){if(n.connectionState!=="connected")throw S.error("error while handling signaling stream from peer %a",E.remoteAddr,I),n.close(),I;S("error while handling signaling stream from peer %a, ignoring as the RTCPeerConnection is already connected",E.remoteAddr,I)}const A=multiaddr(`/webrtc/p2p/${E.remoteAddr.getPeerId()}`);return S.trace("recipient connected to remote address %s",A),{remoteAddress:A}}const WEBRTC_TRANSPORT="/webrtc",CIRCUIT_RELAY_TRANSPORT="/p2p-circuit",SIGNALING_PROTO_ID="/webrtc-signaling/0.0.1",INBOUND_CONNECTION_TIMEOUT=30*1e3;class WebRTCTransport{components;init;log;_started=!1;metrics;shutdownController;constructor(r,_={}){this.components=r,this.init=_,this.log=r.logger.forComponent("libp2p:webrtc"),this.shutdownController=new AbortController,setMaxListeners$2(1/0,this.shutdownController.signal),r.metrics!=null&&(this.metrics={dialerEvents:r.metrics.registerCounterGroup("libp2p_webrtc_dialer_events_total",{label:"event",help:"Total count of WebRTC dialer events by type"}),listenerEvents:r.metrics.registerCounterGroup("libp2p_webrtc_listener_events_total",{label:"event",help:"Total count of WebRTC listener events by type"})})}isStarted(){return this._started}async start(){await this.components.registrar.handle(SIGNALING_PROTO_ID,r=>{this._onProtocol(r).catch(_=>{this.log.error("failed to handle incoming connect from %p",r.connection.remotePeer,_)})},{runOnTransientConnection:!0}),this._started=!0}async stop(){await this.components.registrar.unhandle(SIGNALING_PROTO_ID),this._started=!1}createListener(r){return new WebRTCPeerListener(this.components,{shutdownController:this.shutdownController})}[Symbol.toStringTag]="@libp2p/webrtc";[transportSymbol]=!0;filter(r){return r.filter(WebRTC.exactMatch)}async dial(r,_){this.log.trace("dialing address: %a",r);const E=new RTCPeerConnection(this.init.rtcConfiguration),S=new DataChannelMuxerFactory(this.components,{peerConnection:E,dataChannelOptions:this.init.dataChannel}),{remoteAddress:C}=await initiateConnection({peerConnection:E,multiaddr:r,dataChannelOptions:this.init.dataChannel,signal:_.signal,connectionManager:this.components.connectionManager,transportManager:this.components.transportManager,log:this.log}),A=new WebRTCMultiaddrConnection(this.components,{peerConnection:E,timeline:{open:Date.now()},remoteAddr:C,metrics:this.metrics?.dialerEvents}),I=await _.upgrader.upgradeOutbound(A,{skipProtection:!0,skipEncryption:!0,muxerFactory:S});return this._closeOnShutdown(E,A),I}async _onProtocol({connection:r,stream:_}){const E=AbortSignal.timeout(this.init.inboundConnectionTimeout??INBOUND_CONNECTION_TIMEOUT),S=new RTCPeerConnection(this.init.rtcConfiguration),C=new DataChannelMuxerFactory(this.components,{peerConnection:S,dataChannelOptions:this.init.dataChannel});try{const{remoteAddress:A}=await handleIncomingStream({peerConnection:S,connection:r,stream:_,signal:E,log:this.log}),I=new WebRTCMultiaddrConnection(this.components,{peerConnection:S,timeline:{open:new Date().getTime()},remoteAddr:A,metrics:this.metrics?.listenerEvents});this._closeOnShutdown(S,I),await this.components.upgrader.upgradeInbound(I,{skipEncryption:!0,skipProtection:!0,muxerFactory:C}),await _.close({signal:E})}catch(A){throw _.abort(A),A}}_closeOnShutdown(r,_){const E=()=>{_.close().catch(S=>{this.log.error("could not close WebRTCMultiaddrConnection",S)})};this.shutdownController.signal.addEventListener("abort",E),r.addEventListener("close",()=>{this.shutdownController.signal.removeEventListener("abort",E)})}}function splitAddr(n){const r=n.toString().split(WEBRTC_TRANSPORT+"/");if(r.length!==2)throw new CodeError$4("webrtc protocol was not present in multiaddr",codes$4.ERR_INVALID_MULTIADDR);if(!r[0].includes(CIRCUIT_RELAY_TRANSPORT))throw new CodeError$4("p2p-circuit protocol was not present in multiaddr",codes$4.ERR_INVALID_MULTIADDR);let _=multiaddr(r[0]);const S=multiaddr("/"+r[1]).getPeerId();if(S==null)throw new CodeError$4("destination peer id was missing",codes$4.ERR_INVALID_MULTIADDR);const C=_.protos().pop();if(C===void 0)throw new CodeError$4("invalid multiaddr",codes$4.ERR_INVALID_MULTIADDR);return C.name!=="p2p"&&(_=_.encapsulate(`/p2p/${S}`)),{baseAddr:_,peerId:peerIdFromString$1(S)}}const NOISE_MSG_MAX_LENGTH_BYTES=65535,NOISE_MSG_MAX_LENGTH_BYTES_WITHOUT_TAG=NOISE_MSG_MAX_LENGTH_BYTES-16,DUMP_SESSION_KEYS=!!globalThis.process?.env?.DUMP_SESSION_KEYS,pureJsCrypto={hashSHA256(n){return sha256$2(n.subarray())},getHKDF(n,r){const _=extract(sha256$2,r,n),S=expand(sha256$2,_,void 0,96),C=S.subarray(0,32),A=S.subarray(32,64),I=S.subarray(64,96);return[C,A,I]},generateX25519KeyPair(){const n=x25519.utils.randomPrivateKey();return{publicKey:x25519.getPublicKey(n),privateKey:n}},generateX25519KeyPairFromSeed(n){return{publicKey:x25519.getPublicKey(n),privateKey:n}},generateX25519SharedKey(n,r){return x25519.getSharedSecret(n.subarray(),r.subarray())},chaCha20Poly1305Encrypt(n,r,_,E){return chacha20poly1305(E,r,_).encrypt(n.subarray())},chaCha20Poly1305Decrypt(n,r,_,E,S){return chacha20poly1305(E,r,_).decrypt(n.subarray(),S)}},defaultCrypto=pureJsCrypto;function wrapCrypto(n){return{generateKeypair:n.generateX25519KeyPair,dh:(r,_)=>n.generateX25519SharedKey(r.privateKey,_).subarray(0,32),encrypt:n.chaCha20Poly1305Encrypt,decrypt:n.chaCha20Poly1305Decrypt,hash:n.hashSHA256,hkdf:n.getHKDF}}const uint16BEEncode=n=>{const r=allocUnsafe$1(2);return r[0]=n>>8,r[1]=n,r};uint16BEEncode.bytes=2;const uint16BEDecode=n=>{if(n.length<2)throw RangeError("Could not decode int16BE");if(n instanceof Uint8Array){let r=0;return r+=n[0]<<8,r+=n[1],r}return n.getUint16(0)};uint16BEDecode.bytes=2;function registerMetrics(n){return{xxHandshakeSuccesses:n.registerCounter("libp2p_noise_xxhandshake_successes_total",{help:"Total count of noise xxHandshakes successes_"}),xxHandshakeErrors:n.registerCounter("libp2p_noise_xxhandshake_error_total",{help:"Total count of noise xxHandshakes errors"}),encryptedPackets:n.registerCounter("libp2p_noise_encrypted_packets_total",{help:"Total count of noise encrypted packets successfully"}),decryptedPackets:n.registerCounter("libp2p_noise_decrypted_packets_total",{help:"Total count of noise decrypted packets"}),decryptErrors:n.registerCounter("libp2p_noise_decrypt_errors_total",{help:"Total count of noise decrypt errors"})}}function logLocalStaticKeys(n,r){!r.enabled||!DUMP_SESSION_KEYS||(n?(r(`LOCAL_STATIC_PUBLIC_KEY ${toString$4(n.publicKey,"hex")}`),r(`LOCAL_STATIC_PRIVATE_KEY ${toString$4(n.privateKey,"hex")}`)):r("Missing local static keys."))}function logLocalEphemeralKeys(n,r){!r.enabled||!DUMP_SESSION_KEYS||(n?(r(`LOCAL_PUBLIC_EPHEMERAL_KEY ${toString$4(n.publicKey,"hex")}`),r(`LOCAL_PRIVATE_EPHEMERAL_KEY ${toString$4(n.privateKey,"hex")}`)):r("Missing local ephemeral keys."))}function logRemoteStaticKey(n,r){!r.enabled||!DUMP_SESSION_KEYS||r(n?`REMOTE_STATIC_PUBLIC_KEY ${toString$4(n.subarray(),"hex")}`:"Missing remote static public key.")}function logRemoteEphemeralKey(n,r){!r.enabled||!DUMP_SESSION_KEYS||r(n?`REMOTE_EPHEMERAL_PUBLIC_KEY ${toString$4(n.subarray(),"hex")}`:"Missing remote ephemeral keys.")}function logCipherState(n,r,_){!_.enabled||!DUMP_SESSION_KEYS||(_(`CIPHER_STATE_1 ${n.n.getUint64()} ${n.k&&toString$4(n.k,"hex")}`),_(`CIPHER_STATE_2 ${r.n.getUint64()} ${r.k&&toString$4(r.k,"hex")}`))}class UnexpectedPeerError extends Error{code;constructor(r="Unexpected Peer"){super(r),this.code=UnexpectedPeerError.code}static code="ERR_UNEXPECTED_PEER"}class InvalidCryptoExchangeError extends Error{code;constructor(r="Invalid crypto exchange"){super(r),this.code=InvalidCryptoExchangeError.code}static code="ERR_INVALID_CRYPTO_EXCHANGE"}const MIN_NONCE=0,MAX_NONCE=4294967295,ERR_MAX_NONCE="Cipherstate has reached maximum n, a new handshake must be performed";class Nonce{n;bytes;view;constructor(r=MIN_NONCE){this.n=r,this.bytes=alloc$1(12),this.view=new DataView(this.bytes.buffer,this.bytes.byteOffset,this.bytes.byteLength),this.view.setUint32(4,r,!0)}increment(){this.n++,this.view.setUint32(4,this.n,!0)}getBytes(){return this.bytes}getUint64(){return this.n}assertValue(){if(this.n>MAX_NONCE)throw new Error(ERR_MAX_NONCE)}}const ZEROLEN=alloc$1(0);class CipherState{k;n;crypto;constructor(r,_=void 0,E=0){this.crypto=r,this.k=_,this.n=new Nonce(E)}hasKey(){return!!this.k}encryptWithAd(r,_){if(!this.hasKey())return _;this.n.assertValue();const E=this.crypto.encrypt(_,this.n.getBytes(),r,this.k);return this.n.increment(),E}decryptWithAd(r,_,E){if(!this.hasKey())return _;this.n.assertValue();const S=this.crypto.decrypt(_,this.n.getBytes(),r,this.k,E);return this.n.increment(),S}}class SymmetricState{cs;ck;h;crypto;constructor(r,_){this.crypto=r;const E=fromString$3(_,"utf-8");this.h=hashProtocolName(r,E),this.ck=this.h,this.cs=new CipherState(r)}mixKey(r){const[_,E]=this.crypto.hkdf(this.ck,r);this.ck=_,this.cs=new CipherState(this.crypto,E)}mixHash(r){this.h=this.crypto.hash(new Uint8ArrayList(this.h,r))}encryptAndHash(r){const _=this.cs.encryptWithAd(this.h,r);return this.mixHash(_),_}decryptAndHash(r){const _=this.cs.decryptWithAd(this.h,r);return this.mixHash(r),_}split(){const[r,_]=this.crypto.hkdf(this.ck,ZEROLEN);return[new CipherState(this.crypto,r),new CipherState(this.crypto,_)]}}class AbstractHandshakeState{ss;s;e;rs;re;initiator;crypto;constructor(r){const{crypto:_,protocolName:E,prologue:S,initiator:C,s:A,e:I,rs:B,re:O}=r;this.crypto=_,this.ss=new SymmetricState(_,E),this.ss.mixHash(S),this.initiator=C,this.s=A,this.e=I,this.rs=B,this.re=O}writeE(){if(this.e)throw new Error("ephemeral keypair is already set");const r=this.crypto.generateKeypair();return this.ss.mixHash(r.publicKey),this.e=r,r.publicKey}writeS(){if(!this.s)throw new Error("static keypair is not set");return this.ss.encryptAndHash(this.s.publicKey)}writeEE(){if(!this.e)throw new Error("ephemeral keypair is not set");if(!this.re)throw new Error("remote ephemeral public key is not set");this.ss.mixKey(this.crypto.dh(this.e,this.re))}writeES(){if(this.initiator){if(!this.e)throw new Error("ephemeral keypair is not set");if(!this.rs)throw new Error("remote static public key is not set");this.ss.mixKey(this.crypto.dh(this.e,this.rs))}else{if(!this.s)throw new Error("static keypair is not set");if(!this.re)throw new Error("remote ephemeral public key is not set");this.ss.mixKey(this.crypto.dh(this.s,this.re))}}writeSE(){if(this.initiator){if(!this.s)throw new Error("static keypair is not set");if(!this.re)throw new Error("remote ephemeral public key is not set");this.ss.mixKey(this.crypto.dh(this.s,this.re))}else{if(!this.e)throw new Error("ephemeral keypair is not set");if(!this.rs)throw new Error("remote static public key is not set");this.ss.mixKey(this.crypto.dh(this.e,this.rs))}}readE(r,_=0){if(this.re)throw new Error("remote ephemeral public key is already set");if(r.byteLength<_+32)throw new Error("message is not long enough");this.re=r.sublist(_,_+32),this.ss.mixHash(this.re)}readS(r,_=0){if(this.rs)throw new Error("remote static public key is already set");const E=32+(this.ss.cs.hasKey()?16:0);if(r.byteLength<_+E)throw new Error("message is not long enough");const S=r.sublist(_,_+E);return this.rs=this.ss.decryptAndHash(S),E}readEE(){this.writeEE()}readES(){this.writeES()}readSE(){this.writeSE()}}class XXHandshakeState extends AbstractHandshakeState{writeMessageA(r){return new Uint8ArrayList(this.writeE(),this.ss.encryptAndHash(r))}writeMessageB(r){const _=this.writeE();this.writeEE();const E=this.writeS();return this.writeES(),new Uint8ArrayList(_,E,this.ss.encryptAndHash(r))}writeMessageC(r){const _=this.writeS();return this.writeSE(),new Uint8ArrayList(_,this.ss.encryptAndHash(r))}readMessageA(r){try{return this.readE(r),this.ss.decryptAndHash(r.sublist(32))}catch(_){throw new InvalidCryptoExchangeError(`handshake stage 0 validation fail: ${_.message}`)}}readMessageB(r){try{this.readE(r),this.readEE();const _=this.readS(r,32);return this.readES(),this.ss.decryptAndHash(r.sublist(32+_))}catch(_){throw new InvalidCryptoExchangeError(`handshake stage 1 validation fail: ${_.message}`)}}readMessageC(r){try{const _=this.readS(r);return this.readSE(),this.ss.decryptAndHash(r.sublist(_))}catch(_){throw new InvalidCryptoExchangeError(`handshake stage 2 validation fail: ${_.message}`)}}}function hashProtocolName(n,r){if(r.length<=32){const _=alloc$1(32);return _.set(r),_}else return n.hash(r)}var NoiseExtensions;(function(n){let r;n.codec=()=>(r==null&&(r=message((_,E,S={})=>{if(S.lengthDelimited!==!1&&E.fork(),_.webtransportCerthashes!=null)for(const C of _.webtransportCerthashes)E.uint32(10),E.bytes(C);S.lengthDelimited!==!1&&E.ldelim()},(_,E)=>{const S={webtransportCerthashes:[]},C=E==null?_.len:_.pos+E;for(;_.pos<C;){const A=_.uint32();switch(A>>>3){case 1:{S.webtransportCerthashes.push(_.bytes());break}default:{_.skipType(A&7);break}}}return S})),r),n.encode=_=>encodeMessage(_,n.codec()),n.decode=_=>decodeMessage$1(_,n.codec())})(NoiseExtensions||(NoiseExtensions={}));var NoiseHandshakePayload;(function(n){let r;n.codec=()=>(r==null&&(r=message((_,E,S={})=>{S.lengthDelimited!==!1&&E.fork(),_.identityKey!=null&&_.identityKey.byteLength>0&&(E.uint32(10),E.bytes(_.identityKey)),_.identitySig!=null&&_.identitySig.byteLength>0&&(E.uint32(18),E.bytes(_.identitySig)),_.extensions!=null&&(E.uint32(34),NoiseExtensions.codec().encode(_.extensions,E)),S.lengthDelimited!==!1&&E.ldelim()},(_,E)=>{const S={identityKey:alloc$1(0),identitySig:alloc$1(0)},C=E==null?_.len:_.pos+E;for(;_.pos<C;){const A=_.uint32();switch(A>>>3){case 1:{S.identityKey=_.bytes();break}case 2:{S.identitySig=_.bytes();break}case 4:{S.extensions=NoiseExtensions.codec().decode(_,_.uint32());break}default:{_.skipType(A&7);break}}}return S})),r),n.encode=_=>encodeMessage(_,n.codec()),n.decode=_=>decodeMessage$1(_,n.codec())})(NoiseHandshakePayload||(NoiseHandshakePayload={}));async function createHandshakePayload(n,r,_){const E=await n.sign(getSignaturePayload(r));return NoiseHandshakePayload.encode({identityKey:n.public.bytes,identitySig:E,extensions:_})}async function decodeHandshakePayload(n,r,_){try{const E=NoiseHandshakePayload.decode(n);if(_){const A=_.subarray();if(!equals$1(A,E.identityKey))throw new Error(`Payload identity key ${toString$4(E.identityKey,"hex")} does not match expected remote identity key ${toString$4(A,"hex")}`)}if(!r)throw new Error("Remote static does not exist");const S=getSignaturePayload(r);if(!await unmarshalPublicKey$1(E.identityKey).verify(S,E.identitySig))throw new Error("Invalid payload signature");return E}catch(E){throw new UnexpectedPeerError(E.message)}}function getSignaturePayload(n){const r=fromString$3("noise-libp2p-static-key:");return n instanceof Uint8Array?concat$4([r,n],r.length+n.length):(n.prepend(r),n)}async function performHandshakeInitiator(n){const{log:r,connection:_,crypto:E,privateKey:S,prologue:C,s:A,remoteIdentityKey:I,extensions:B}=n,O=await createHandshakePayload(S,A.publicKey,B),N=new XXHandshakeState({crypto:E,protocolName:"Noise_XX_25519_ChaChaPoly_SHA256",initiator:!0,prologue:C,s:A});logLocalStaticKeys(N.s,r),r.trace("Stage 0 - Initiator starting to send first message."),await _.write(N.writeMessageA(ZEROLEN)),r.trace("Stage 0 - Initiator finished sending first message."),logLocalEphemeralKeys(N.e,r),r.trace("Stage 1 - Initiator waiting to receive first message from responder...");const U=N.readMessageB(await _.read());r.trace("Stage 1 - Initiator received the message."),logRemoteEphemeralKey(N.re,r),logRemoteStaticKey(N.rs,r),r.trace("Initiator going to check remote's signature...");const j=await decodeHandshakePayload(U,N.rs,I);r.trace("All good with the signature!"),r.trace("Stage 2 - Initiator sending third handshake message."),await _.write(N.writeMessageC(O)),r.trace("Stage 2 - Initiator sent message with signed payload.");const[z,Z]=N.ss.split();return logCipherState(z,Z,r),{payload:j,encrypt:X=>z.encryptWithAd(ZEROLEN,X),decrypt:(X,Q)=>Z.decryptWithAd(ZEROLEN,X,Q)}}async function performHandshakeResponder(n){const{log:r,connection:_,crypto:E,privateKey:S,prologue:C,s:A,remoteIdentityKey:I,extensions:B}=n,O=await createHandshakePayload(S,A.publicKey,B),N=new XXHandshakeState({crypto:E,protocolName:"Noise_XX_25519_ChaChaPoly_SHA256",initiator:!1,prologue:C,s:A});logLocalStaticKeys(N.s,r),r.trace("Stage 0 - Responder waiting to receive first message."),N.readMessageA(await _.read()),r.trace("Stage 0 - Responder received first message."),logRemoteEphemeralKey(N.re,r),r.trace("Stage 1 - Responder sending out first message with signed payload and static key."),await _.write(N.writeMessageB(O)),r.trace("Stage 1 - Responder sent the second handshake message with signed payload."),logLocalEphemeralKeys(N.e,r),r.trace("Stage 2 - Responder waiting for third handshake message...");const U=N.readMessageC(await _.read());r.trace("Stage 2 - Responder received the message, finished handshake.");const j=await decodeHandshakePayload(U,N.rs,I),[z,Z]=N.ss.split();return logCipherState(z,Z,r),{payload:j,encrypt:X=>Z.encryptWithAd(ZEROLEN,X),decrypt:(X,Q)=>z.decryptWithAd(ZEROLEN,X,Q)}}const CHACHA_TAG_LENGTH=16;function encryptStream(n,r){return async function*(_){for await(const E of _)for(let S=0;S<E.length;S+=NOISE_MSG_MAX_LENGTH_BYTES_WITHOUT_TAG){let C=S+NOISE_MSG_MAX_LENGTH_BYTES_WITHOUT_TAG;C>E.length&&(C=E.length);let A;E instanceof Uint8Array?A=n.encrypt(E.subarray(S,C)):A=n.encrypt(E.sublist(S,C)),r?.encryptedPackets.increment(),yield new Uint8ArrayList(uint16BEEncode(A.byteLength),A)}}}function decryptStream(n,r){return async function*(_){for await(const E of _)for(let S=0;S<E.length;S+=NOISE_MSG_MAX_LENGTH_BYTES){let C=S+NOISE_MSG_MAX_LENGTH_BYTES;if(C>E.length&&(C=E.length),C-CHACHA_TAG_LENGTH<S)throw new Error("Invalid chunk");const A=E.sublist(S,C),I=E.subarray(S,C-CHACHA_TAG_LENGTH);try{const B=n.decrypt(A,I);r?.decryptedPackets.increment(),yield B}catch(B){throw r?.decryptErrors.increment(),B}}}}class Noise{protocol="/noise";crypto;prologue;staticKey;extensions;metrics;components;constructor(r,_={}){const{staticNoiseKey:E,extensions:S,crypto:C,prologueBytes:A}=_,{metrics:I}=r;this.components=r;const B=C??defaultCrypto;this.crypto=wrapCrypto(B),this.extensions=S,this.metrics=I?registerMetrics(I):void 0,E?this.staticKey=B.generateX25519KeyPairFromSeed(E):this.staticKey=B.generateX25519KeyPair(),this.prologue=A??alloc$1(0)}async secureOutbound(r,_,E){const S=lpStream(_,{lengthEncoder:uint16BEEncode,lengthDecoder:uint16BEDecode,maxDataLength:NOISE_MSG_MAX_LENGTH_BYTES});if(!r.privateKey)throw new CodeError$4("local peerId does not contain private key","ERR_NO_PRIVATE_KEY");const C=await unmarshalPrivateKey$1(r.privateKey),A=E?.publicKey,I=await this.performHandshakeInitiator(S,C,A),B=await this.createSecureConnection(S,I);return _.source=B.source,_.sink=B.sink,{conn:_,remoteExtensions:I.payload.extensions,remotePeer:await peerIdFromKeys$1(I.payload.identityKey)}}async secureInbound(r,_,E){const S=lpStream(_,{lengthEncoder:uint16BEEncode,lengthDecoder:uint16BEDecode,maxDataLength:NOISE_MSG_MAX_LENGTH_BYTES});if(!r.privateKey)throw new CodeError$4("local peerId does not contain private key","ERR_NO_PRIVATE_KEY");const C=await unmarshalPrivateKey$1(r.privateKey),A=E?.publicKey,I=await this.performHandshakeResponder(S,C,A),B=await this.createSecureConnection(S,I);return _.source=B.source,_.sink=B.sink,{conn:_,remoteExtensions:I.payload.extensions,remotePeer:await peerIdFromKeys$1(I.payload.identityKey)}}async performHandshakeInitiator(r,_,E){let S;try{S=await performHandshakeInitiator({connection:r,privateKey:_,remoteIdentityKey:E,log:this.components.logger.forComponent("libp2p:noise:xxhandshake"),crypto:this.crypto,prologue:this.prologue,s:this.staticKey,extensions:this.extensions}),this.metrics?.xxHandshakeSuccesses.increment()}catch(C){throw this.metrics?.xxHandshakeErrors.increment(),C}return S}async performHandshakeResponder(r,_,E){let S;try{S=await performHandshakeResponder({connection:r,privateKey:_,remoteIdentityKey:E,log:this.components.logger.forComponent("libp2p:noise:xxhandshake"),crypto:this.crypto,prologue:this.prologue,s:this.staticKey,extensions:this.extensions}),this.metrics?.xxHandshakeSuccesses.increment()}catch(C){throw this.metrics?.xxHandshakeErrors.increment(),C}return S}async createSecureConnection(r,_){const[E,S]=duplexPair(),C=r.unwrap();return await pipe(E,encryptStream(_,this.metrics),C,A=>decode$4(A,{lengthDecoder:uint16BEDecode}),decryptStream(_,this.metrics),E),S}}function noise(n={}){return r=>new Noise(r,n)}var src$2={exports:{}};function base$1(n){if(n.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),_=0;_<r.length;_++)r[_]=255;for(var E=0;E<n.length;E++){var S=n.charAt(E),C=S.charCodeAt(0);if(r[C]!==255)throw new TypeError(S+" is ambiguous");r[C]=E}var A=n.length,I=n.charAt(0),B=Math.log(A)/Math.log(256),O=Math.log(256)/Math.log(A);function N(z){if(z instanceof Uint8Array||(ArrayBuffer.isView(z)?z=new Uint8Array(z.buffer,z.byteOffset,z.byteLength):Array.isArray(z)&&(z=Uint8Array.from(z))),!(z instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(z.length===0)return"";for(var Z=0,X=0,Q=0,se=z.length;Q!==se&&z[Q]===0;)Q++,Z++;for(var oe=(se-Q)*O+1>>>0,ue=new Uint8Array(oe);Q!==se;){for(var we=z[Q],Te=0,xe=oe-1;(we!==0||Te<X)&&xe!==-1;xe--,Te++)we+=256*ue[xe]>>>0,ue[xe]=we%A>>>0,we=we/A>>>0;if(we!==0)throw new Error("Non-zero carry");X=Te,Q++}for(var Re=oe-X;Re!==oe&&ue[Re]===0;)Re++;for(var Ne=I.repeat(Z);Re<oe;++Re)Ne+=n.charAt(ue[Re]);return Ne}function U(z){if(typeof z!="string")throw new TypeError("Expected String");if(z.length===0)return new Uint8Array;var Z=0;if(z[Z]!==" "){for(var X=0,Q=0;z[Z]===I;)X++,Z++;for(var se=(z.length-Z)*B+1>>>0,oe=new Uint8Array(se);z[Z];){var ue=r[z.charCodeAt(Z)];if(ue===255)return;for(var we=0,Te=se-1;(ue!==0||we<Q)&&Te!==-1;Te--,we++)ue+=A*oe[Te]>>>0,oe[Te]=ue%256>>>0,ue=ue/256>>>0;if(ue!==0)throw new Error("Non-zero carry");Q=we,Z++}if(z[Z]!==" "){for(var xe=se-Q;xe!==se&&oe[xe]===0;)xe++;for(var Re=new Uint8Array(X+(se-xe)),Ne=X;xe!==se;)Re[Ne++]=oe[xe++];return Re}}}function j(z){var Z=U(z);if(Z)return Z;throw new Error("Non-base"+A+" character")}return{encode:N,decodeUnsafe:U,decode:j}}var src$1=base$1;const textDecoder=new TextDecoder,decodeText$1=n=>textDecoder.decode(n),textEncoder=new TextEncoder,encodeText$2=n=>textEncoder.encode(n);function concat$2(n,r){const _=new Uint8Array(r);let E=0;for(const S of n)_.set(S,E),E+=S.length;return _}var util={decodeText:decodeText$1,encodeText:encodeText$2,concat:concat$2};const{encodeText:encodeText$1}=util;let Base$1=class{constructor(r,_,E,S){this.name=r,this.code=_,this.codeBuf=encodeText$1(this.code),this.alphabet=S,this.codec=E(S)}encode(r){return this.codec.encode(r)}decode(r){for(const _ of r)if(this.alphabet&&this.alphabet.indexOf(_)<0)throw new Error(`invalid character '${_}' in '${r}'`);return this.codec.decode(r)}};var base=Base$1;const decode$2=(n,r,_)=>{const E={};for(let O=0;O<r.length;++O)E[r[O]]=O;let S=n.length;for(;n[S-1]==="=";)--S;const C=new Uint8Array(S*_/8|0);let A=0,I=0,B=0;for(let O=0;O<S;++O){const N=E[n[O]];if(N===void 0)throw new SyntaxError("Invalid character "+n[O]);I=I<<_|N,A+=_,A>=8&&(A-=8,C[B++]=255&I>>A)}if(A>=_||255&I<<8-A)throw new SyntaxError("Unexpected end of data");return C},encode$2=(n,r,_)=>{const E=r[r.length-1]==="=",S=(1<<_)-1;let C="",A=0,I=0;for(let B=0;B<n.length;++B)for(I=I<<8|n[B],A+=8;A>_;)A-=_,C+=r[S&I>>A];if(A&&(C+=r[S&I<<_-A]),E)for(;C.length*_&7;)C+="=";return C},rfc4648$1=n=>r=>({encode(_){return encode$2(_,r,n)},decode(_){return decode$2(_,r,n)}});var rfc4648_1={rfc4648:rfc4648$1};const baseX=src$1,Base=base,{rfc4648}=rfc4648_1,{decodeText,encodeText}=util,identity$1=()=>({encode:decodeText,decode:encodeText}),constants$1=[["identity","\0",identity$1,""],["base2","0",rfc4648(1),"01"],["base8","7",rfc4648(3),"01234567"],["base10","9",baseX,"0123456789"],["base16","f",rfc4648(4),"0123456789abcdef"],["base16upper","F",rfc4648(4),"0123456789ABCDEF"],["base32hex","v",rfc4648(5),"0123456789abcdefghijklmnopqrstuv"],["base32hexupper","V",rfc4648(5),"0123456789ABCDEFGHIJKLMNOPQRSTUV"],["base32hexpad","t",rfc4648(5),"0123456789abcdefghijklmnopqrstuv="],["base32hexpadupper","T",rfc4648(5),"0123456789ABCDEFGHIJKLMNOPQRSTUV="],["base32","b",rfc4648(5),"abcdefghijklmnopqrstuvwxyz234567"],["base32upper","B",rfc4648(5),"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567"],["base32pad","c",rfc4648(5),"abcdefghijklmnopqrstuvwxyz234567="],["base32padupper","C",rfc4648(5),"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567="],["base32z","h",rfc4648(5),"ybndrfg8ejkmcpqxot1uwisza345h769"],["base36","k",baseX,"0123456789abcdefghijklmnopqrstuvwxyz"],["base36upper","K",baseX,"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"],["base58btc","z",baseX,"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"],["base58flickr","Z",baseX,"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"],["base64","m",rfc4648(6),"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"],["base64pad","M",rfc4648(6),"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="],["base64url","u",rfc4648(6),"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_"],["base64urlpad","U",rfc4648(6),"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_="]],names$2=constants$1.reduce((n,r)=>(n[r[0]]=new Base(r[0],r[1],r[2],r[3]),n),{}),codes$3=constants$1.reduce((n,r)=>(n[r[1]]=names$2[r[0]],n),{});var constants_1={names:names$2,codes:codes$3};(function(n,r){const _=constants_1,{encodeText:E,decodeText:S,concat:C}=util;function A(X,Q){if(!Q)throw new Error("requires an encoded Uint8Array");const{name:se,codeBuf:oe}=U(X);return N(se,Q),C([oe,Q],oe.length+Q.length)}function I(X,Q){const se=U(X),oe=E(se.encode(Q));return C([se.codeBuf,oe],se.codeBuf.length+oe.length)}function B(X){X instanceof Uint8Array&&(X=S(X));const Q=X[0];return["f","F","v","V","t","T","b","B","c","C","h","k","K"].includes(Q)&&(X=X.toLowerCase()),U(X[0]).decode(X.substring(1))}function O(X){if(X instanceof Uint8Array&&(X=S(X)),Object.prototype.toString.call(X)!=="[object String]")return!1;try{return U(X[0]).name}catch{return!1}}function N(X,Q){U(X).decode(S(Q))}function U(X){if(Object.prototype.hasOwnProperty.call(_.names,X))return _.names[X];if(Object.prototype.hasOwnProperty.call(_.codes,X))return _.codes[X];throw new Error(`Unsupported encoding: ${X}`)}function j(X){return X instanceof Uint8Array&&(X=S(X)),U(X[0])}r=n.exports=A,r.encode=I,r.decode=B,r.isEncoded=O,r.encoding=U,r.encodingFromData=j;const z=Object.freeze(_.names),Z=Object.freeze(_.codes);r.names=z,r.codes=Z})(src$2,src$2.exports);var srcExports=src$2.exports;const names$1=Object.freeze({identity:0,sha1:17,"sha2-256":18,"sha2-512":19,"sha3-512":20,"sha3-384":21,"sha3-256":22,"sha3-224":23,"shake-128":24,"shake-256":25,"keccak-224":26,"keccak-256":27,"keccak-384":28,"keccak-512":29,blake3:30,"murmur3-128":34,"murmur3-32":35,"dbl-sha2-256":86,md4:212,md5:213,bmt:214,"sha2-256-trunc254-padded":4114,"ripemd-128":4178,"ripemd-160":4179,"ripemd-256":4180,"ripemd-320":4181,x11:4352,kangarootwelve:7425,"sm3-256":21325,"blake2b-8":45569,"blake2b-16":45570,"blake2b-24":45571,"blake2b-32":45572,"blake2b-40":45573,"blake2b-48":45574,"blake2b-56":45575,"blake2b-64":45576,"blake2b-72":45577,"blake2b-80":45578,"blake2b-88":45579,"blake2b-96":45580,"blake2b-104":45581,"blake2b-112":45582,"blake2b-120":45583,"blake2b-128":45584,"blake2b-136":45585,"blake2b-144":45586,"blake2b-152":45587,"blake2b-160":45588,"blake2b-168":45589,"blake2b-176":45590,"blake2b-184":45591,"blake2b-192":45592,"blake2b-200":45593,"blake2b-208":45594,"blake2b-216":45595,"blake2b-224":45596,"blake2b-232":45597,"blake2b-240":45598,"blake2b-248":45599,"blake2b-256":45600,"blake2b-264":45601,"blake2b-272":45602,"blake2b-280":45603,"blake2b-288":45604,"blake2b-296":45605,"blake2b-304":45606,"blake2b-312":45607,"blake2b-320":45608,"blake2b-328":45609,"blake2b-336":45610,"blake2b-344":45611,"blake2b-352":45612,"blake2b-360":45613,"blake2b-368":45614,"blake2b-376":45615,"blake2b-384":45616,"blake2b-392":45617,"blake2b-400":45618,"blake2b-408":45619,"blake2b-416":45620,"blake2b-424":45621,"blake2b-432":45622,"blake2b-440":45623,"blake2b-448":45624,"blake2b-456":45625,"blake2b-464":45626,"blake2b-472":45627,"blake2b-480":45628,"blake2b-488":45629,"blake2b-496":45630,"blake2b-504":45631,"blake2b-512":45632,"blake2s-8":45633,"blake2s-16":45634,"blake2s-24":45635,"blake2s-32":45636,"blake2s-40":45637,"blake2s-48":45638,"blake2s-56":45639,"blake2s-64":45640,"blake2s-72":45641,"blake2s-80":45642,"blake2s-88":45643,"blake2s-96":45644,"blake2s-104":45645,"blake2s-112":45646,"blake2s-120":45647,"blake2s-128":45648,"blake2s-136":45649,"blake2s-144":45650,"blake2s-152":45651,"blake2s-160":45652,"blake2s-168":45653,"blake2s-176":45654,"blake2s-184":45655,"blake2s-192":45656,"blake2s-200":45657,"blake2s-208":45658,"blake2s-216":45659,"blake2s-224":45660,"blake2s-232":45661,"blake2s-240":45662,"blake2s-248":45663,"blake2s-256":45664,"skein256-8":45825,"skein256-16":45826,"skein256-24":45827,"skein256-32":45828,"skein256-40":45829,"skein256-48":45830,"skein256-56":45831,"skein256-64":45832,"skein256-72":45833,"skein256-80":45834,"skein256-88":45835,"skein256-96":45836,"skein256-104":45837,"skein256-112":45838,"skein256-120":45839,"skein256-128":45840,"skein256-136":45841,"skein256-144":45842,"skein256-152":45843,"skein256-160":45844,"skein256-168":45845,"skein256-176":45846,"skein256-184":45847,"skein256-192":45848,"skein256-200":45849,"skein256-208":45850,"skein256-216":45851,"skein256-224":45852,"skein256-232":45853,"skein256-240":45854,"skein256-248":45855,"skein256-256":45856,"skein512-8":45857,"skein512-16":45858,"skein512-24":45859,"skein512-32":45860,"skein512-40":45861,"skein512-48":45862,"skein512-56":45863,"skein512-64":45864,"skein512-72":45865,"skein512-80":45866,"skein512-88":45867,"skein512-96":45868,"skein512-104":45869,"skein512-112":45870,"skein512-120":45871,"skein512-128":45872,"skein512-136":45873,"skein512-144":45874,"skein512-152":45875,"skein512-160":45876,"skein512-168":45877,"skein512-176":45878,"skein512-184":45879,"skein512-192":45880,"skein512-200":45881,"skein512-208":45882,"skein512-216":45883,"skein512-224":45884,"skein512-232":45885,"skein512-240":45886,"skein512-248":45887,"skein512-256":45888,"skein512-264":45889,"skein512-272":45890,"skein512-280":45891,"skein512-288":45892,"skein512-296":45893,"skein512-304":45894,"skein512-312":45895,"skein512-320":45896,"skein512-328":45897,"skein512-336":45898,"skein512-344":45899,"skein512-352":45900,"skein512-360":45901,"skein512-368":45902,"skein512-376":45903,"skein512-384":45904,"skein512-392":45905,"skein512-400":45906,"skein512-408":45907,"skein512-416":45908,"skein512-424":45909,"skein512-432":45910,"skein512-440":45911,"skein512-448":45912,"skein512-456":45913,"skein512-464":45914,"skein512-472":45915,"skein512-480":45916,"skein512-488":45917,"skein512-496":45918,"skein512-504":45919,"skein512-512":45920,"skein1024-8":45921,"skein1024-16":45922,"skein1024-24":45923,"skein1024-32":45924,"skein1024-40":45925,"skein1024-48":45926,"skein1024-56":45927,"skein1024-64":45928,"skein1024-72":45929,"skein1024-80":45930,"skein1024-88":45931,"skein1024-96":45932,"skein1024-104":45933,"skein1024-112":45934,"skein1024-120":45935,"skein1024-128":45936,"skein1024-136":45937,"skein1024-144":45938,"skein1024-152":45939,"skein1024-160":45940,"skein1024-168":45941,"skein1024-176":45942,"skein1024-184":45943,"skein1024-192":45944,"skein1024-200":45945,"skein1024-208":45946,"skein1024-216":45947,"skein1024-224":45948,"skein1024-232":45949,"skein1024-240":45950,"skein1024-248":45951,"skein1024-256":45952,"skein1024-264":45953,"skein1024-272":45954,"skein1024-280":45955,"skein1024-288":45956,"skein1024-296":45957,"skein1024-304":45958,"skein1024-312":45959,"skein1024-320":45960,"skein1024-328":45961,"skein1024-336":45962,"skein1024-344":45963,"skein1024-352":45964,"skein1024-360":45965,"skein1024-368":45966,"skein1024-376":45967,"skein1024-384":45968,"skein1024-392":45969,"skein1024-400":45970,"skein1024-408":45971,"skein1024-416":45972,"skein1024-424":45973,"skein1024-432":45974,"skein1024-440":45975,"skein1024-448":45976,"skein1024-456":45977,"skein1024-464":45978,"skein1024-472":45979,"skein1024-480":45980,"skein1024-488":45981,"skein1024-496":45982,"skein1024-504":45983,"skein1024-512":45984,"skein1024-520":45985,"skein1024-528":45986,"skein1024-536":45987,"skein1024-544":45988,"skein1024-552":45989,"skein1024-560":45990,"skein1024-568":45991,"skein1024-576":45992,"skein1024-584":45993,"skein1024-592":45994,"skein1024-600":45995,"skein1024-608":45996,"skein1024-616":45997,"skein1024-624":45998,"skein1024-632":45999,"skein1024-640":46e3,"skein1024-648":46001,"skein1024-656":46002,"skein1024-664":46003,"skein1024-672":46004,"skein1024-680":46005,"skein1024-688":46006,"skein1024-696":46007,"skein1024-704":46008,"skein1024-712":46009,"skein1024-720":46010,"skein1024-728":46011,"skein1024-736":46012,"skein1024-744":46013,"skein1024-752":46014,"skein1024-760":46015,"skein1024-768":46016,"skein1024-776":46017,"skein1024-784":46018,"skein1024-792":46019,"skein1024-800":46020,"skein1024-808":46021,"skein1024-816":46022,"skein1024-824":46023,"skein1024-832":46024,"skein1024-840":46025,"skein1024-848":46026,"skein1024-856":46027,"skein1024-864":46028,"skein1024-872":46029,"skein1024-880":46030,"skein1024-888":46031,"skein1024-896":46032,"skein1024-904":46033,"skein1024-912":46034,"skein1024-920":46035,"skein1024-928":46036,"skein1024-936":46037,"skein1024-944":46038,"skein1024-952":46039,"skein1024-960":46040,"skein1024-968":46041,"skein1024-976":46042,"skein1024-984":46043,"skein1024-992":46044,"skein1024-1000":46045,"skein1024-1008":46046,"skein1024-1016":46047,"skein1024-1024":46048,"poseidon-bls12_381-a2-fc1":46081,"poseidon-bls12_381-a2-fc1-sc":46082});var constants={names:names$1};const identity=from$5({prefix:"\0",name:"identity",encode:n=>toString$a(n),decode:n=>fromString$7(n)}),identityBase=Object.freeze(Object.defineProperty({__proto__:null,identity},Symbol.toStringTag,{value:"Module"})),base2=rfc4648$4({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1}),base2$1=Object.freeze(Object.defineProperty({__proto__:null,base2},Symbol.toStringTag,{value:"Module"})),base8=rfc4648$4({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3}),base8$1=Object.freeze(Object.defineProperty({__proto__:null,base8},Symbol.toStringTag,{value:"Module"})),base10=baseX$3({prefix:"9",name:"base10",alphabet:"0123456789"}),base10$1=Object.freeze(Object.defineProperty({__proto__:null,base10},Symbol.toStringTag,{value:"Module"})),base16=rfc4648$4({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),base16upper=rfc4648$4({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4}),base16$1=Object.freeze(Object.defineProperty({__proto__:null,base16,base16upper},Symbol.toStringTag,{value:"Module"})),base36=baseX$3({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),base36upper=baseX$3({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"}),base36$1=Object.freeze(Object.defineProperty({__proto__:null,base36,base36upper},Symbol.toStringTag,{value:"Module"})),base64=rfc4648$4({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),base64pad=rfc4648$4({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),base64url=rfc4648$4({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),base64urlpad=rfc4648$4({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6}),base64$1=Object.freeze(Object.defineProperty({__proto__:null,base64,base64pad,base64url,base64urlpad},Symbol.toStringTag,{value:"Module"})),alphabet=Array.from(""),alphabetBytesToChars=alphabet.reduce((n,r,_)=>(n[_]=r,n),[]),alphabetCharsToBytes=alphabet.reduce((n,r,_)=>(n[r.codePointAt(0)]=_,n),[]);function encode$1(n){return n.reduce((r,_)=>(r+=alphabetBytesToChars[_],r),"")}function decode$1(n){const r=[];for(const _ of n){const E=alphabetCharsToBytes[_.codePointAt(0)];if(E===void 0)throw new Error(`Non-base256emoji character: ${_}`);r.push(E)}return new Uint8Array(r)}const base256emoji=from$5({prefix:"",name:"base256emoji",encode:encode$1,decode:decode$1}),base256emoji$1=Object.freeze(Object.defineProperty({__proto__:null,base256emoji},Symbol.toStringTag,{value:"Module"}));new TextEncoder;new TextDecoder;const bases={...identityBase,...base2$1,...base8$1,...base10$1,...base16$1,...base32$5,...base36$1,...base58$2,...base64$1,...base256emoji$1};function asUint8Array(n){return globalThis.Buffer!=null?new Uint8Array(n.buffer,n.byteOffset,n.byteLength):n}function allocUnsafe(n=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?asUint8Array(globalThis.Buffer.allocUnsafe(n)):new Uint8Array(n)}function createCodec(n,r,_,E){return{name:n,prefix:r,encoder:{name:n,prefix:r,encode:_},decoder:{decode:E}}}const string=createCodec("utf8","u",n=>"u"+new TextDecoder("utf8").decode(n),n=>new TextEncoder().encode(n.substring(1))),ascii=createCodec("ascii","a",n=>{let r="a";for(let _=0;_<n.length;_++)r+=String.fromCharCode(n[_]);return r},n=>{n=n.substring(1);const r=allocUnsafe(n.length);for(let _=0;_<n.length;_++)r[_]=n.charCodeAt(_);return r}),BASES={utf8:string,"utf-8":string,hex:bases.base16,latin1:ascii,ascii,binary:ascii,...bases};function toString(n,r="utf8"){const _=BASES[r];if(!_)throw new Error(`Unsupported encoding "${r}"`);return(r==="utf8"||r==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(n.buffer,n.byteOffset,n.byteLength).toString("utf8"):_.encoder.encode(n).substring(1)}const toString$1=Object.freeze(Object.defineProperty({__proto__:null,toString},Symbol.toStringTag,{value:"Module"})),require$$3=getAugmentedNamespace(toString$1);function fromString(n,r="utf8"){const _=BASES[r];if(!_)throw new Error(`Unsupported encoding "${r}"`);return(r==="utf8"||r==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?asUint8Array(globalThis.Buffer.from(n,"utf-8")):_.decoder.decode(`${_.prefix}${n}`)}const fromString$1=Object.freeze(Object.defineProperty({__proto__:null,fromString},Symbol.toStringTag,{value:"Module"})),require$$4=getAugmentedNamespace(fromString$1);function concat(n,r){r||(r=n.reduce((S,C)=>S+C.length,0));const _=allocUnsafe(r);let E=0;for(const S of n)_.set(S,E),E+=S.length;return asUint8Array(_)}const concat$1=Object.freeze(Object.defineProperty({__proto__:null,concat},Symbol.toStringTag,{value:"Module"})),require$$5=getAugmentedNamespace(concat$1),multibase=srcExports,varint=varint$3,{names}=constants,{toString:uint8ArrayToString}=require$$3,{fromString:uint8ArrayFromString}=require$$4,{concat:uint8ArrayConcat}=require$$5,codes$2={};for(const n in names){const r=n;codes$2[names[r]]=r}Object.freeze(codes$2);function toHexString(n){if(!(n instanceof Uint8Array))throw new Error("must be passed a Uint8Array");return uint8ArrayToString(n,"base16")}function fromHexString(n){return uint8ArrayFromString(n,"base16")}function toB58String(n){if(!(n instanceof Uint8Array))throw new Error("must be passed a Uint8Array");return uint8ArrayToString(multibase.encode("base58btc",n)).slice(1)}function fromB58String(n){const r=n instanceof Uint8Array?uint8ArrayToString(n):n;return multibase.decode("z"+r)}function decode(n){if(!(n instanceof Uint8Array))throw new Error("multihash must be a Uint8Array");if(n.length<2)throw new Error("multihash too short. must be > 2 bytes.");const r=varint.decode(n);if(!isValidCode(r))throw new Error(`multihash unknown function code: 0x${r.toString(16)}`);n=n.slice(varint.decode.bytes);const _=varint.decode(n);if(_<0)throw new Error(`multihash invalid length: ${_}`);if(n=n.slice(varint.decode.bytes),n.length!==_)throw new Error(`multihash length inconsistent: 0x${uint8ArrayToString(n,"base16")}`);return{code:r,name:codes$2[r],length:_,digest:n}}function encode(n,r,_){if(!n||r===void 0)throw new Error("multihash encode requires at least two args: digest, code");const E=coerceCode(r);if(!(n instanceof Uint8Array))throw new Error("digest should be a Uint8Array");if(_==null&&(_=n.length),_&&n.length!==_)throw new Error("digest length should be equal to specified length.");const S=varint.encode(E),C=varint.encode(_);return uint8ArrayConcat([S,C,n],S.length+C.length+n.length)}function coerceCode(n){let r=n;if(typeof n=="string"){if(names[n]===void 0)throw new Error(`Unrecognized hash function named: ${n}`);r=names[n]}if(typeof r!="number")throw new Error(`Hash function code should be a number. Got: ${r}`);if(codes$2[r]===void 0&&!isAppCode(r))throw new Error(`Unrecognized function code: ${r}`);return r}function isAppCode(n){return n>0&&n<16}function isValidCode(n){return!!(isAppCode(n)||codes$2[n])}function validate$1(n){decode(n)}function prefix(n){return validate$1(n),n.subarray(0,2)}var src={names,codes:codes$2,toHexString,fromHexString,toB58String,fromB58String,decode,encode,coerceCode,isAppCode,validate:validate$1,prefix,isValidCode};const mbdecoder=Object.values(bases$2).map(n=>n.decoder).reduce((n,r)=>n.or(r));function getLocalFingerprint(n,r){const _=n.getConfiguration().certificates?.at(0);if(_==null||_.getFingerprints==null){r.log.trace("fetching fingerprint from local SDP");const S=n.localDescription;return S==null?void 0:getFingerprintFromSdp(S.sdp)}if(r.log.trace("fetching fingerprint from local certificate"),_.getFingerprints().length===0)return;const E=_.getFingerprints()[0].value;if(E==null)throw invalidFingerprint("","no fingerprint on local certificate");return E}const fingerprintRegex=/^a=fingerprint:(?:\w+-[0-9]+)\s(?<fingerprint>(:?[0-9a-fA-F]{2})+)$/m;function getFingerprintFromSdp(n){return n.match(fingerprintRegex)?.groups?.fingerprint}function ipv(n){for(const r of n.protoNames())if(r.startsWith("ip"))return r.toUpperCase();return"IP6"}function certhash(n){const _=n.stringTuples().filter(E=>E[0]===CERTHASH_CODE).map(E=>E[1])[0];if(_===void 0||_==="")throw inappropriateMultiaddr(`Couldn't find a certhash component of multiaddr: ${n.toString()}`);return _}function decodeCerthash(n){const r=mbdecoder.decode(n);return src.decode(r)}function ma2Fingerprint(n){const r=decodeCerthash(certhash(n)),_=toSupportedHashFunction(r.name),E=r.digest.reduce((C,A)=>C+A.toString(16).padStart(2,"0"),""),S=E.match(/.{1,2}/g);if(S==null)throw invalidFingerprint(E,n.toString());return[`${_.toUpperCase()} ${S.join(":").toUpperCase()}`,E]}function toSupportedHashFunction(n){switch(n){case"sha1":return"sha-1";case"sha2-256":return"sha-256";case"sha2-512":return"sha-512";default:throw unsupportedHashAlgorithm(n)}}function ma2sdp(n,r){const{host:_,port:E}=n.toOptions(),S=ipv(n),[C]=ma2Fingerprint(n);return`v=0
o=- 0 0 IN ${S} ${_}
s=-
c=IN ${S} ${_}
t=0 0
a=ice-lite
m=application ${E} UDP/DTLS/SCTP webrtc-datachannel
a=mid:0
a=setup:passive
a=ice-ufrag:${r}
a=ice-pwd:${r}
a=fingerprint:${C}
a=sctp-port:5000
a=max-message-size:16384
a=candidate:1467250027 1 UDP 1467250027 ${_} ${E} typ host\r
`}function fromMultiAddr(n,r){return{type:"answer",sdp:ma2sdp(n,r)}}function munge(n,r){if(n.sdp===void 0)throw invalidArgument("Can't munge a missing SDP");return n.sdp=n.sdp.replace(/\na=ice-ufrag:[^\n]*\n/,`
a=ice-ufrag:`+r+`
`).replace(/\na=ice-pwd:[^\n]*\n/,`
a=ice-pwd:`+r+`
`),n}const charset=Array.from("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"),genUfrag=n=>[...Array(n)].map(()=>charset.at(Math.floor(Math.random()*charset.length))).join(""),HANDSHAKE_TIMEOUT_MS=1e4;getProtocol("webrtc-direct").code;const CERTHASH_CODE=getProtocol("certhash").code;class WebRTCDirectTransport{log;metrics;components;init;constructor(r,_={}){this.log=r.logger.forComponent("libp2p:webrtc-direct"),this.components=r,this.init=_,r.metrics!=null&&(this.metrics={dialerEvents:r.metrics.registerCounterGroup("libp2p_webrtc-direct_dialer_events_total",{label:"event",help:"Total count of WebRTC-direct dial events by type"})})}async dial(r,_){const E=await this._connect(r,_);return this.log("dialing address: %a",r),E}createListener(r){throw unimplemented("WebRTCTransport.createListener")}filter(r){return r.filter(WebRTCDirect.exactMatch)}[Symbol.toStringTag]="@libp2p/webrtc-direct";[transportSymbol]=!0;async _connect(r,_){const E=new AbortController,S=E.signal,C=r.getPeerId();if(C===null)throw inappropriateMultiaddr("we need to have the remote's PeerId");const A=peerIdFromString$1(C),I=decodeCerthash(certhash(r)),B=await RTCPeerConnection.generateCertificate({name:"ECDSA",namedCurve:"P-256",hash:toSupportedHashFunction(I.name)}),O=new RTCPeerConnection({certificates:[B]});try{const N=new Promise((Ne,Fe)=>{const ht=O.createDataChannel("",{negotiated:!0,id:0}),nt=setTimeout(()=>{const Ee=`Data channel was never opened: state: ${ht.readyState}`;this.log.error(Ee),this.metrics?.dialerEvents.increment({open_error:!0}),Fe(dataChannelError("data",Ee))},HANDSHAKE_TIMEOUT_MS);ht.onopen=Ee=>{clearTimeout(nt),Ne(ht)},ht.onerror=Ee=>{clearTimeout(nt);const _e=`Error opening a data channel for handshaking: ${Ee.target?.toString()??"not specified"}`;this.log.error(_e),this.metrics?.dialerEvents.increment({unknown_error:!0}),Fe(dataChannelError("data",_e))}}),U="libp2p+webrtc+v1/"+genUfrag(32),j=await O.createOffer(),z=munge(j,U);await O.setLocalDescription(z);const Z=fromMultiAddr(r,U);await O.setRemoteDescription(Z);const X=await N,Q=this.components.peerId,se=this.generateNoisePrologue(O,I.code,r),oe=noise({prologueBytes:se})(this.components),ue=createStream({channel:X,direction:"inbound",logger:this.components.logger,...this.init.dataChannel??{}}),we={...ue,sink:ue.sink.bind(ue),source:async function*(){for await(const Ne of ue.source)for(const Fe of Ne)yield Fe}()},Te=new WebRTCMultiaddrConnection(this.components,{peerConnection:O,remoteAddr:r,timeline:{open:Date.now()},metrics:this.metrics?.dialerEvents}),xe=isFirefox?"iceconnectionstatechange":"connectionstatechange";O.addEventListener(xe,()=>{switch(O.connectionState){case"failed":case"disconnected":case"closed":Te.close().catch(Ne=>{this.log.error("error closing connection",Ne)}).finally(()=>{E.abort()});break;default:break}},{signal:S}),this.metrics?.dialerEvents.increment({peer_connection:!0});const Re=new DataChannelMuxerFactory(this.components,{peerConnection:O,metrics:this.metrics?.dialerEvents,dataChannelOptions:this.init.dataChannel});return await oe.secureInbound(Q,we,A),await _.upgrader.upgradeOutbound(Te,{skipProtection:!0,skipEncryption:!0,muxerFactory:Re})}catch(N){throw O.close(),N}}generateNoisePrologue(r,_,E){if(r.getConfiguration().certificates?.length===0)throw invalidArgument("no local certificate");const S=getLocalFingerprint(r,{log:this.log});if(S==null)throw invalidArgument("no local fingerprint found");const C=S.trim().toLowerCase().replaceAll(":",""),A=fromString$3(C,"hex"),I=src.encode(A,_),B=mbdecoder.decode(certhash(E)),O=fromString$3("libp2p-webrtc-noise:");return concat$4([O,I,B])}}function webRTCDirect(n){return r=>new WebRTCDirectTransport(r,n)}function webRTC(n){return r=>new WebRTCTransport(r,n)}const ASSUME_HTTP_CODES=[getProtocol("tcp").code,getProtocol("dns").code,getProtocol("dnsaddr").code,getProtocol("dns4").code,getProtocol("dns6").code];function extractSNI(n){let r;try{r=getProtocol("sni").code}catch{return null}for(const[_,E]of n)if(_===r&&E!==void 0)return E;return null}function hasTLS(n){return n.some(([r,_])=>r===getProtocol("tls").code)}function interpretNext(n,r,_){const E=interpreters[getProtocol(n).name];if(E===void 0)throw new Error(`Can't interpret protocol ${getProtocol(n).name}`);const S=E(r,_);return n===getProtocol("ip6").code?`[${S}]`:S}const interpreters={ip4:(n,r)=>n,ip6:(n,r)=>r.length===0?n:`[${n}]`,tcp:(n,r)=>{const _=r.pop();if(_===void 0)throw new Error("Unexpected end of multiaddr");return`tcp://${interpretNext(_[0],_[1]??"",r)}:${n}`},udp:(n,r)=>{const _=r.pop();if(_===void 0)throw new Error("Unexpected end of multiaddr");return`udp://${interpretNext(_[0],_[1]??"",r)}:${n}`},dnsaddr:(n,r)=>n,dns4:(n,r)=>n,dns6:(n,r)=>n,dns:(n,r)=>n,ipfs:(n,r)=>{const _=r.pop();if(_===void 0)throw new Error("Unexpected end of multiaddr");return`${interpretNext(_[0],_[1]??"",r)}/ipfs/${n}`},p2p:(n,r)=>{const _=r.pop();if(_===void 0)throw new Error("Unexpected end of multiaddr");return`${interpretNext(_[0],_[1]??"",r)}/p2p/${n}`},http:(n,r)=>{const _=hasTLS(r),E=extractSNI(r);if(_&&E!==null)return`https://${E}`;const S=_?"https://":"http://",C=r.pop();if(C===void 0)throw new Error("Unexpected end of multiaddr");let A=interpretNext(C[0],C[1]??"",r);return A=A.replace("tcp://",""),`${S}${A}`},tls:(n,r)=>{const _=r.pop();if(_===void 0)throw new Error("Unexpected end of multiaddr");return interpretNext(_[0],_[1]??"",r)},sni:(n,r)=>{const _=r.pop();if(_===void 0)throw new Error("Unexpected end of multiaddr");return interpretNext(_[0],_[1]??"",r)},https:(n,r)=>{const _=r.pop();if(_===void 0)throw new Error("Unexpected end of multiaddr");let E=interpretNext(_[0],_[1]??"",r);return E=E.replace("tcp://",""),`https://${E}`},ws:(n,r)=>{const _=hasTLS(r),E=extractSNI(r);if(_&&E!==null)return`wss://${E}`;const S=_?"wss://":"ws://",C=r.pop();if(C===void 0)throw new Error("Unexpected end of multiaddr");let A=interpretNext(C[0],C[1]??"",r);return A=A.replace("tcp://",""),`${S}${A}`},wss:(n,r)=>{const _=r.pop();if(_===void 0)throw new Error("Unexpected end of multiaddr");let E=interpretNext(_[0],_[1]??"",r);return E=E.replace("tcp://",""),`wss://${E}`},"p2p-websocket-star":(n,r)=>{const _=r.pop();if(_===void 0)throw new Error("Unexpected end of multiaddr");return`${interpretNext(_[0],_[1]??"",r)}/p2p-websocket-star`},"p2p-webrtc-star":(n,r)=>{const _=r.pop();if(_===void 0)throw new Error("Unexpected end of multiaddr");return`${interpretNext(_[0],_[1]??"",r)}/p2p-webrtc-star`},"p2p-webrtc-direct":(n,r)=>{const _=r.pop();if(_===void 0)throw new Error("Unexpected end of multiaddr");return`${interpretNext(_[0],_[1]??"",r)}/p2p-webrtc-direct`}};function multiaddrToUri(n,r){const E=multiaddr(n).stringTuples(),S=E.pop();if(S===void 0)throw new Error("Unexpected end of multiaddr");const C=getProtocol(S[0]),A=interpreters[C.name];if(A==null)throw new Error(`No interpreter found for ${C.name}`);let I=A(S[1]??"",E);return r?.assumeHttp!==!1&&ASSUME_HTTP_CODES.includes(S[0])&&(I=I.replace(/^.*:\/\//,""),S[1]==="443"?I=`https://${I}`:I=`http://${I}`),(I.startsWith("http://")||I.startsWith("https://"))&&(I=new URL(I).toString(),I.endsWith("/")&&(I=I.substring(0,I.length-1))),I}const ready=async n=>{if(n.readyState>=2)throw new Error("socket closed");n.readyState!==1&&await new Promise((r,_)=>{function E(){n.removeEventListener("open",S),n.removeEventListener("error",C)}function S(){E(),r()}function C(A){E(),_(A.error??new Error(`connect ECONNREFUSED ${n.url}`))}n.addEventListener("open",S),n.addEventListener("error",C)})},sink=(n,r)=>(r=r??{},r.closeOnEnd=r.closeOnEnd!==!1,async E=>{for await(const S of E){try{await ready(n)}catch(C){if(C.message==="socket closed")break;throw C}if(n.readyState===n.CLOSING||n.readyState===n.CLOSED)break;n.send(S)}r.closeOnEnd!=null&&n.readyState<=1&&await new Promise((S,C)=>{n.addEventListener("close",A=>{if(A.wasClean||A.code===1006)S();else{const I=Object.assign(new Error("ws error"),{event:A});C(I)}}),setTimeout(()=>{n.close()})})});var dom={},eventIterator={};Object.defineProperty(eventIterator,"__esModule",{value:!0});class EventQueue{constructor(){this.pullQueue=[],this.pushQueue=[],this.eventHandlers={},this.isPaused=!1,this.isStopped=!1}push(r){if(this.isStopped)return;const _={value:r,done:!1};if(this.pullQueue.length){const E=this.pullQueue.shift();E&&E.resolve(_)}else this.pushQueue.push(Promise.resolve(_)),this.highWaterMark!==void 0&&this.pushQueue.length>=this.highWaterMark&&!this.isPaused&&(this.isPaused=!0,this.eventHandlers.highWater?this.eventHandlers.highWater():console&&console.warn(`EventIterator queue reached ${this.pushQueue.length} items`))}stop(){if(!this.isStopped){this.isStopped=!0,this.remove();for(const r of this.pullQueue)r.resolve({value:void 0,done:!0});this.pullQueue.length=0}}fail(r){if(!this.isStopped)if(this.isStopped=!0,this.remove(),this.pullQueue.length){for(const _ of this.pullQueue)_.reject(r);this.pullQueue.length=0}else{const _=Promise.reject(r);_.catch(()=>{}),this.pushQueue.push(_)}}remove(){Promise.resolve().then(()=>{this.removeCallback&&this.removeCallback()})}[Symbol.asyncIterator](){return{next:r=>{const _=this.pushQueue.shift();return _?(this.lowWaterMark!==void 0&&this.pushQueue.length<=this.lowWaterMark&&this.isPaused&&(this.isPaused=!1,this.eventHandlers.lowWater&&this.eventHandlers.lowWater()),_):this.isStopped?Promise.resolve({value:void 0,done:!0}):new Promise((E,S)=>{this.pullQueue.push({resolve:E,reject:S})})},return:()=>(this.isStopped=!0,this.pushQueue.length=0,this.remove(),Promise.resolve({value:void 0,done:!0}))}}}let EventIterator$1=class{constructor(r,{highWaterMark:_=100,lowWaterMark:E=1}={}){const S=new EventQueue;S.highWaterMark=_,S.lowWaterMark=E,S.removeCallback=r({push:C=>S.push(C),stop:()=>S.stop(),fail:C=>S.fail(C),on:(C,A)=>{S.eventHandlers[C]=A}})||(()=>{}),this[Symbol.asyncIterator]=()=>S[Symbol.asyncIterator](),Object.freeze(this)}};eventIterator.EventIterator=EventIterator$1;eventIterator.default=EventIterator$1;Object.defineProperty(dom,"__esModule",{value:!0});const event_iterator_1=eventIterator;var EventIterator=dom.EventIterator=event_iterator_1.EventIterator;function subscribe(n,r,_){return new event_iterator_1.EventIterator(({push:E})=>(this.addEventListener(n,E,r),()=>this.removeEventListener(n,E,r)),_)}dom.subscribe=subscribe;dom.default=event_iterator_1.EventIterator;function isArrayBuffer(n){return n instanceof ArrayBuffer||n?.constructor?.name==="ArrayBuffer"&&typeof n?.byteLength=="number"}const source=n=>{n.binaryType="arraybuffer";const r=async()=>{await new Promise((C,A)=>{if(E){C();return}if(S!=null){A(S);return}const I=N=>{n.removeEventListener("open",B),n.removeEventListener("error",O),N()},B=()=>{I(C)},O=N=>{I(()=>{A(N.error??new Error(`connect ECONNREFUSED ${n.url}`))})};n.addEventListener("open",B),n.addEventListener("error",O)})},_=async function*(){const C=new EventIterator(({push:A,stop:I,fail:B})=>{const O=U=>{let j=null;typeof U.data=="string"&&(j=fromString$3(U.data)),isArrayBuffer(U.data)&&(j=new Uint8Array(U.data)),U.data instanceof Uint8Array&&(j=U.data),j!=null&&A(j)},N=U=>{B(U.error??new Error("Socket error"))};return n.addEventListener("message",O),n.addEventListener("error",N),n.addEventListener("close",I),()=>{n.removeEventListener("message",O),n.removeEventListener("error",N),n.removeEventListener("close",I)}},{highWaterMark:1/0});await r();for await(const A of C)yield isArrayBuffer(A)?new Uint8Array(A):A}();let E=n.readyState===1,S;return n.addEventListener("open",()=>{E=!0,S=null}),n.addEventListener("close",()=>{E=!1,S=null}),n.addEventListener("error",C=>{E||(S=C.error??new Error(`connect ECONNREFUSED ${n.url}`))}),Object.assign(_,{connected:r})},duplex=(n,r)=>{r=r??{};const _=source(n);let E=r.remoteAddress,S=r.remotePort;if(n.url!=null)try{const A=new URL(n.url);E=A.hostname,S=parseInt(A.port,10)}catch{}if(E==null||S==null)throw new Error("Remote connection did not have address and/or port");return{sink:sink(n,r),source:_,connected:async()=>{await _.connected()},close:async()=>{(n.readyState===n.CONNECTING||n.readyState===n.OPEN)&&await new Promise(A=>{n.addEventListener("close",()=>{A()}),n.close()})},destroy:()=>{n.terminate!=null?n.terminate():n.close()},remoteAddress:E,remotePort:S,socket:n}},WebSocket$1=WebSocket,map={"http:":"ws:","https:":"wss:"},defaultProtocol="ws:",wsurl=(n,r)=>{if(n.startsWith("//")&&(n=`${r?.protocol??defaultProtocol}${n}`),n.startsWith("/")&&r!=null){const E=r.protocol??defaultProtocol,S=r.host,C=r.port!=null&&S?.endsWith(`:${r.port}`)!==!0?`:${r.port}`:"";n=`${E}//${S}${C}${n}`}const _=new URL(n);for(const[E,S]of Object.entries(map))_.protocol===E&&(_.protocol=S);return _};function connect(n,r){const _=typeof window>"u"?void 0:window.location;r=r??{};const E=wsurl(n,_),S=new WebSocket$1(E.toString(),r.websocket);return duplex(S,r)}const CODE_P2P=421,CODE_CIRCUIT=290,CLOSE_TIMEOUT$1=500;function all(n){return n.filter(r=>{if(r.protoCodes().includes(CODE_CIRCUIT))return!1;const _=r.decapsulateCode(CODE_P2P);return WebSockets$1.matches(_)||WebSocketsSecure.matches(_)})}function wss(n){return n.filter(r=>{if(r.protoCodes().includes(CODE_CIRCUIT))return!1;const _=r.decapsulateCode(CODE_P2P);return WebSocketsSecure.matches(_)})}function createListener(){throw new Error("WebSocket Servers can not be created in the browser!")}function socketToMaConn(n,r,_){const E=_.logger.forComponent("libp2p:websockets:maconn"),S={log:E,async sink(C){try{await n.sink(async function*(){for await(const A of C)A instanceof Uint8Array?yield A:yield A.subarray()}())}catch(A){A.type!=="aborted"&&E.error(A)}},source:n.source,remoteAddr:r,timeline:{open:Date.now()},async close(C={}){const A=Date.now();if(C.signal==null){const B=AbortSignal.timeout(CLOSE_TIMEOUT$1);C={...C,signal:B}}const I=()=>{const{host:B,port:O}=S.remoteAddr.toOptions();E("timeout closing stream to %s:%s after %dms, destroying it manually",B,O,Date.now()-A),this.abort(new CodeError$4("Socket close timeout","ERR_SOCKET_CLOSE_TIMEOUT"))};C.signal?.addEventListener("abort",I);try{await n.close()}catch(B){E.error("error closing WebSocket gracefully",B),this.abort(B)}finally{C.signal?.removeEventListener("abort",I),S.timeline.close=Date.now()}},abort(C){const{host:A,port:I}=S.remoteAddr.toOptions();E("timeout closing stream to %s:%s due to error",A,I,C),n.destroy(),S.timeline.close=Date.now()}};return n.socket.addEventListener("close",()=>{S.timeline.close==null&&(S.timeline.close=Date.now())},{once:!0}),S}class WebSockets{log;init;logger;constructor(r,_){this.log=r.logger.forComponent("libp2p:websockets"),this.logger=r.logger,this.init=_}[Symbol.toStringTag]="@libp2p/websockets";[transportSymbol]=!0;async dial(r,_){this.log("dialing %s",r),_=_??{};const E=await this._connect(r,_),S=socketToMaConn(E,r,{logger:this.logger});this.log("new outbound connection %s",S.remoteAddr);const C=await _.upgrader.upgradeOutbound(S);return this.log("outbound connection %s upgraded",S.remoteAddr),C}async _connect(r,_){if(_?.signal?.aborted===!0)throw new AbortError$5;const E=r.toOptions();this.log("dialing %s:%s",E.host,E.port);const S=pDefer(),C=connect(multiaddrToUri(r),this.init);if(C.socket.addEventListener("error",()=>{const B=new CodeError$4(`Could not connect to ${r.toString()}`,"ERR_CONNECTION_FAILED");this.log.error("connection error:",B),S.reject(B)}),_.signal==null)return await Promise.race([C.connected(),S.promise]),this.log("connected %s",r),C;let A;const I=new Promise((B,O)=>{if(A=()=>{O(new AbortError$5),C.close().catch(N=>{this.log.error("error closing raw socket",N)})},_?.signal?.aborted===!0){A();return}_?.signal?.addEventListener("abort",A)});try{await Promise.race([I,S.promise,C.connected()])}finally{A!=null&&_?.signal?.removeEventListener("abort",A)}return this.log("connected %s",r),C}createListener(r){return createListener({logger:this.logger},{...this.init,...r})}filter(r){return r=Array.isArray(r)?r:[r],this.init?.filter!=null?this.init?.filter(r):isBrowser||isWebWorker?wss(r):all(r)}}function webSockets(n={}){return r=>new WebSockets(r,n)}async function webtransportBiDiStreamToStream(n,r,_,E,S,C){const A=C.forComponent(`libp2p:webtransport:stream:${_}:${r}`),I=n.writable.getWriter(),B=n.readable.getReader();await I.ready;function O(){const Z=E.findIndex(X=>X===z);Z!==-1&&(E.splice(Z,1),z.timeline.close=Date.now(),S?.(z))}let N=!1,U=!1;(async function(){const Z=await I.closed.catch(X=>X);if(Z!=null){const X=Z.message;X.includes("aborted by the remote server")||X.includes("STOP_SENDING")||A.error(`WebTransport writer closed unexpectedly: streamId=${r} err=${Z.message}`)}N=!0,N&&U&&O()})().catch(()=>{A.error("WebTransport failed to cleanup closed stream")}),async function(){const Z=await B.closed.catch(X=>X);Z!=null&&A.error(`WebTransport reader closed unexpectedly: streamId=${r} err=${Z.message}`),U=!0,N&&U&&O()}().catch(()=>{A.error("WebTransport failed to cleanup closed stream")});let j=!1;const z={id:r,status:"open",writeStatus:"ready",readStatus:"ready",abort(Z){N||(I.abort(Z).catch(X=>{A.error("could not abort stream",X)}),N=!0),U=!0,this.status="aborted",this.writeStatus="closed",this.readStatus="closed",this.timeline.reset=this.timeline.close=this.timeline.closeRead=this.timeline.closeWrite=Date.now(),O()},async close(Z){this.status="closing",await Promise.all([z.closeRead(Z),z.closeWrite(Z)]),O(),this.status="closed",this.timeline.close=Date.now()},async closeRead(Z){if(!U){this.readStatus="closing";try{await B.cancel()}catch(X){X.toString().includes("RESET_STREAM")===!0&&(N=!0)}this.timeline.closeRead=Date.now(),this.readStatus="closed",U=!0}N&&O()},async closeWrite(Z){if(!N){N=!0,this.writeStatus="closing";try{await I.close()}catch(X){X.toString().includes("RESET_STREAM")===!0&&(U=!0)}this.timeline.closeWrite=Date.now(),this.writeStatus="closed"}U&&O()},direction:_,timeline:{open:Date.now()},metadata:{},source:async function*(){for(;;){const Z=await B.read();if(Z.done){U=!0,N&&O();return}yield new Uint8ArrayList(Z.value)}}(),sink:async function(Z){if(j)throw new Error("sink already called on stream");j=!0;try{this.writeStatus="writing";for await(const X of Z)if(X instanceof Uint8Array)await I.write(X);else for(const Q of X)await I.write(Q);this.writeStatus="done"}finally{this.timeline.closeWrite=Date.now(),this.writeStatus="closed",await z.closeWrite()}},log:A};return z}function inertDuplex(){return{source:{[Symbol.asyncIterator](){return{async next(){return new Promise(()=>{})}}}},sink:async n=>new Promise(()=>{})}}function isSubset(n,r){return r.filter(E=>!!n.find(S=>equals$1(E,S))).length===r.length}const multibaseDecoder=Object.values(bases$2).map(n=>n.decoder).reduce((n,r)=>n.or(r));function decodeCerthashStr(n){return decode$h(multibaseDecoder.decode(n))}function parseMultiaddr(n){if(!WebTransport$1.matches(n))throw new CodeError$4("Invalid multiaddr, was not a WebTransport address","ERR_INVALID_MULTIADDR");const r=n.stringTuples(),_=r.filter(([A,I])=>A===getProtocol("certhash").code).map(([A,I])=>decodeCerthashStr(I??"")),E=r.filter(([A,I])=>A===getProtocol("p2p").code).map(([A,I])=>peerIdFromString$1(I??""))[0],S=n.toOptions();let C=S.host;return S.family===6&&C?.includes(":")&&(C=`[${C}]`),{url:`https://${C}:${S.port}`,certhashes:_,remotePeer:E}}class WebTransportTransport{log;components;config;metrics;constructor(r,_={}){this.log=r.logger.forComponent("libp2p:webtransport"),this.components=r,this.config={maxInboundStreams:_.maxInboundStreams??1e3},r.metrics!=null&&(this.metrics={dialerEvents:r.metrics.registerCounterGroup("libp2p_webtransport_dialer_events_total",{label:"event",help:"Total count of WebTransport dialer events by type"})})}[Symbol.toStringTag]="@libp2p/webtransport";[transportSymbol]=!0;async dial(r,_){_?.signal?.throwIfAborted(),this.log("dialing %s",r);const E=this.components.peerId;if(E===void 0)throw new Error("Need a local peerid");_=_??{};const{url:S,certhashes:C,remotePeer:A}=parseMultiaddr(r);if(A==null)throw new Error("Need a target peerid");if(C.length===0)throw new Error("Expected multiaddr to contain certhashes");let I,B,O=()=>{},N=!1,U=!1,j=!1;try{this.metrics?.dialerEvents.increment({pending:!0});const z=new WebTransport(`${S}/.well-known/libp2p-webtransport?type=noise`,{serverCertificateHashes:C.map(Z=>({algorithm:"sha-256",value:Z.digest}))});if(O=Z=>{if(!N)try{this.metrics?.dialerEvents.increment({[Z]:!0}),z.close()}catch(X){this.log.error("error closing wt session",X)}finally{B!=null&&(B.timeline.close=Date.now()),N=!0}},I=()=>{O(U?"noise_timeout":"ready_timeout")},_.signal?.addEventListener("abort",I,{once:!0}),await Promise.race([z.closed,z.ready]),U=!0,this.metrics?.dialerEvents.increment({ready:!0}),z.closed.catch(Z=>{this.log.error("error on remote wt session close",Z)}).finally(()=>{O("remote_close")}),!await this.authenticateWebTransport(z,E,A,C))throw new Error("Failed to authenticate webtransport");return this.metrics?.dialerEvents.increment({open:!0}),B={close:async()=>{this.log("Closing webtransport"),O("close")},abort:Z=>{this.log("aborting webtransport due to passed err",Z),O("abort")},remoteAddr:r,timeline:{open:Date.now()},log:this.components.logger.forComponent("libp2p:webtransport:maconn"),...inertDuplex()},j=!0,await _.upgrader.upgradeOutbound(B,{skipEncryption:!0,muxerFactory:this.webtransportMuxer(z),skipProtection:!0})}catch(z){throw this.log.error("caught wt session err",z),O(j?"upgrade_error":U?"noise_error":"ready_error"),z}finally{I!=null&&_.signal?.removeEventListener("abort",I)}}async authenticateWebTransport(r,_,E,S){const C=await r.createBidirectionalStream(),A=C.writable.getWriter(),I=C.readable.getReader();await A.ready;const B={source:async function*(){for(;;){const U=await I.read();if(U.value!=null&&(yield U.value),U.done)break}}(),sink:async function(U){for await(const j of U)j instanceof Uint8Array?await A.write(j):await A.write(j.subarray())}},O=noise()(this.components),{remoteExtensions:N}=await O.secureOutbound(_,B,E);if(A.close().catch(U=>{this.log.error(`Failed to close authentication stream writer: ${U.message}`)}),I.cancel().catch(U=>{this.log.error(`Failed to close authentication stream reader: ${U.message}`)}),!isSubset(N?.webtransportCerthashes??[],S.map(U=>U.bytes)))throw new Error("Our certhashes are not a subset of the remote's reported certhashes");return!0}webtransportMuxer(r){let _=0;const E=this.config,S=this;return{protocol:"webtransport",createStreamMuxer:C=>{typeof C=="function"&&(C={onIncomingStream:C});const A=[];return async function(){//! TODO unclear how to add backpressure here?
const B=r.incomingBidirectionalStreams.getReader();for(;;){const{done:O,value:N}=await B.read();if(O)break;if(A.length>=E.maxInboundStreams)N.writable.close().catch(U=>{S.log.error(`Failed to close inbound stream that crossed our maxInboundStream limit: ${U.message}`)}),N.readable.cancel().catch(U=>{S.log.error(`Failed to close inbound stream that crossed our maxInboundStream limit: ${U.message}`)});else{const U=await webtransportBiDiStreamToStream(N,String(_++),"inbound",A,C?.onStreamEnd,S.components.logger);A.push(U),C?.onIncomingStream?.(U)}}}().catch(()=>{this.log.error("WebTransport failed to receive incoming stream")}),{protocol:"webtransport",streams:A,newStream:async B=>{const O=await r.createBidirectionalStream(),N=await webtransportBiDiStreamToStream(O,String(_++),C?.direction??"outbound",A,C?.onStreamEnd,S.components.logger);return A.push(N),N},close:async B=>{this.log("Closing webtransport muxer"),await Promise.all(A.map(async O=>O.close(B)))},abort:B=>{this.log("Aborting webtransport muxer with err:",B);for(const O of A)O.abort(B)},...inertDuplex()}}}}createListener(r){throw new Error("Webtransport servers are not supported in Node or the browser")}filter(r){return r.filter(WebTransport$1.exactMatch)}}function webTransport(n={}){return r=>new WebTransportTransport(r,n)}const ERR_IPNS_EXPIRED_RECORD="ERR_IPNS_EXPIRED_RECORD",ERR_UNRECOGNIZED_VALIDITY="ERR_UNRECOGNIZED_VALIDITY",ERR_SIGNATURE_VERIFICATION="ERR_SIGNATURE_VERIFICATION",ERR_UNRECOGNIZED_FORMAT="ERR_UNRECOGNIZED_FORMAT",ERR_UNDEFINED_PARAMETER="ERR_UNDEFINED_PARAMETER",ERR_INVALID_RECORD_DATA="ERR_INVALID_RECORD_DATA",ERR_INVALID_VALUE="ERR_INVALID_VALUE",ERR_INVALID_EMBEDDED_KEY="ERR_INVALID_EMBEDDED_KEY",ERR_RECORD_TOO_LARGE="ERR_RECORD_TOO_LARGE";var IpnsEntry;(function(n){(function(E){E.EOL="EOL"})(n.ValidityType||(n.ValidityType={}));let r;(function(E){E[E.EOL=0]="EOL"})(r||(r={})),function(E){E.codec=()=>enumeration(r)}(n.ValidityType||(n.ValidityType={}));let _;n.codec=()=>(_==null&&(_=message((E,S,C={})=>{C.lengthDelimited!==!1&&S.fork(),E.value!=null&&(S.uint32(10),S.bytes(E.value)),E.signatureV1!=null&&(S.uint32(18),S.bytes(E.signatureV1)),E.validityType!=null&&(S.uint32(24),n.ValidityType.codec().encode(E.validityType,S)),E.validity!=null&&(S.uint32(34),S.bytes(E.validity)),E.sequence!=null&&(S.uint32(40),S.uint64(E.sequence)),E.ttl!=null&&(S.uint32(48),S.uint64(E.ttl)),E.pubKey!=null&&(S.uint32(58),S.bytes(E.pubKey)),E.signatureV2!=null&&(S.uint32(66),S.bytes(E.signatureV2)),E.data!=null&&(S.uint32(74),S.bytes(E.data)),C.lengthDelimited!==!1&&S.ldelim()},(E,S)=>{const C={},A=S==null?E.len:E.pos+S;for(;E.pos<A;){const I=E.uint32();switch(I>>>3){case 1:C.value=E.bytes();break;case 2:C.signatureV1=E.bytes();break;case 3:C.validityType=n.ValidityType.codec().decode(E);break;case 4:C.validity=E.bytes();break;case 5:C.sequence=E.uint64();break;case 6:C.ttl=E.uint64();break;case 7:C.pubKey=E.bytes();break;case 8:C.signatureV2=E.bytes();break;case 9:C.data=E.bytes();break;default:E.skipType(I&7);break}}return C})),_),n.encode=E=>encodeMessage(E,n.codec()),n.decode=E=>decodeMessage$1(E,n.codec())})(IpnsEntry||(IpnsEntry={}));const log$1=logger$2("ipns:utils"),IPNS_PREFIX=fromString$3("/ipns/"),LIBP2P_CID_CODEC=114;function parseRFC3339(n){const r=new RegExp("(\\d{4})-(\\d{2})-(\\d{2})T(\\d{2}):(\\d{2}):(\\d{2})\\.(\\d+)Z"),_=String(n).trim().match(r);if(_==null)throw new Error("Invalid format");const E=parseInt(_[1],10),S=parseInt(_[2],10)-1,C=parseInt(_[3],10),A=parseInt(_[4],10),I=parseInt(_[5],10),B=parseInt(_[6],10),O=parseInt(_[7].padEnd(6,"0").slice(0,3),10);return new Date(Date.UTC(E,S,C,A,I,B,O))}const extractPublicKey=async(n,r)=>{if(r==null||n==null){const E=new Error("one or more of the provided parameters are not defined");throw log$1.error(E),errCode$1(E,ERR_UNDEFINED_PARAMETER)}let _;if(r.pubKey!=null){try{_=unmarshalPublicKey$1(r.pubKey)}catch(S){throw log$1.error(S),S}if(!(await peerIdFromKeys$1(r.pubKey)).equals(n))throw errCode$1(new Error("Embedded public key did not match PeerID"),ERR_INVALID_EMBEDDED_KEY)}else n.publicKey!=null&&(_=unmarshalPublicKey$1(n.publicKey));if(_!=null)return _;throw errCode$1(new Error("no public key is available"),ERR_UNDEFINED_PARAMETER)},ipnsRecordDataForV2Sig=n=>{const r=fromString$3("ipns-signature:");return concat$4([r,n])};function unmarshal(n){const r=IpnsEntry.decode(n);if(r.sequence!=null&&(r.sequence=BigInt(r.sequence)),r.ttl!=null&&(r.ttl=BigInt(r.ttl)),r.signatureV2==null||r.data==null)throw errCode$1(new Error("missing data or signatureV2"),ERR_SIGNATURE_VERIFICATION);const _=parseCborData(r.data),E=normalizeValue(_.Value);let S;try{S=NanoDate.fromDate(parseRFC3339(toString$4(_.Validity)))}catch{throw log$1.error("unrecognized validity format (not an rfc3339 format)"),errCode$1(new Error("unrecognized validity format (not an rfc3339 format)"),ERR_UNRECOGNIZED_FORMAT)}if(r.value!=null&&r.signatureV1!=null)return validateCborDataMatchesPbData(r),{value:E,validityType:IpnsEntry.ValidityType.EOL,validity:S,sequence:_.Sequence,ttl:_.TTL,pubKey:r.pubKey,signatureV1:r.signatureV1,signatureV2:r.signatureV2,data:r.data};if(r.signatureV2!=null)return{value:E,validityType:IpnsEntry.ValidityType.EOL,validity:S,sequence:_.Sequence,ttl:_.TTL,pubKey:r.pubKey,signatureV2:r.signatureV2,data:r.data};throw new Error("invalid record: does not include signatureV1 or signatureV2")}const peerIdFromRoutingKey=n=>peerIdFromBytes$1(n.slice(IPNS_PREFIX.length)),parseCborData=n=>{const r=decode$l(n);if(r.ValidityType===0)r.ValidityType=IpnsEntry.ValidityType.EOL;else throw errCode$1(new Error("Unknown validity type"),ERR_UNRECOGNIZED_VALIDITY);return Number.isInteger(r.Sequence)&&(r.Sequence=BigInt(r.Sequence)),Number.isInteger(r.TTL)&&(r.TTL=BigInt(r.TTL)),r},normalizeValue=n=>{if(n!=null){if(isPeerId$1(n))return`/ipns/${n.toCID().toString(base36$4)}`;if(n instanceof Uint8Array){const E=toString$4(n);E.startsWith("/")&&(n=E)}const r=n.toString().trim();if(r.startsWith("/")&&r.length>1)return r;const _=CID.asCID(n);if(_!=null)return _.code===LIBP2P_CID_CODEC?`/ipns/${_.toString(base36$4)}`:`/ipfs/${_.toV1().toString()}`;try{return n instanceof Uint8Array?`/ipfs/${CID.decode(n).toV1().toString()}`:`/ipfs/${CID.parse(r).toV1().toString()}`}catch{}}throw errCode$1(new Error("Value must be a valid content path starting with /"),ERR_INVALID_VALUE)},validateCborDataMatchesPbData=n=>{if(n.data==null)throw errCode$1(new Error("Record data is missing"),ERR_INVALID_RECORD_DATA);const r=parseCborData(n.data);if(!equals$1(r.Value,n.value??new Uint8Array(0)))throw errCode$1(new Error('Field "value" did not match between protobuf and CBOR'),ERR_SIGNATURE_VERIFICATION);if(!equals$1(r.Validity,n.validity??new Uint8Array(0)))throw errCode$1(new Error('Field "validity" did not match between protobuf and CBOR'),ERR_SIGNATURE_VERIFICATION);if(r.ValidityType!==n.validityType)throw errCode$1(new Error('Field "validityType" did not match between protobuf and CBOR'),ERR_SIGNATURE_VERIFICATION);if(r.Sequence!==n.sequence)throw errCode$1(new Error('Field "sequence" did not match between protobuf and CBOR'),ERR_SIGNATURE_VERIFICATION);if(r.TTL!==n.ttl)throw errCode$1(new Error('Field "ttl" did not match between protobuf and CBOR'),ERR_SIGNATURE_VERIFICATION)};function ipnsSelector(n,r){const _=r.map((E,S)=>({record:unmarshal(E),index:S}));return _.sort((E,S)=>{const C=E.record.sequence,A=S.record.sequence;if(C>A)return-1;if(C<A)return 1;const I=E.record.validity.toDate(),B=S.record.validity.toDate();return I.getTime()>B.getTime()?-1:I.getTime()<B.getTime()?1:0}),_[0].index}const log=logger$2("ipns:validator"),MAX_RECORD_SIZE=1024*10,validate=async(n,r)=>{const _=unmarshal(r);let E;try{const S=ipnsRecordDataForV2Sig(_.data);E=await n.verify(S,_.signatureV2)}catch{E=!1}if(!E)throw log.error("record signature verification failed"),errCode$1(new Error("record signature verification failed"),ERR_SIGNATURE_VERIFICATION);if(_.validityType===IpnsEntry.ValidityType.EOL){if(_.validity.toDate().getTime()<Date.now())throw log.error("record has expired"),errCode$1(new Error("record has expired"),ERR_IPNS_EXPIRED_RECORD)}else if(_.validityType!=null)throw log.error("unrecognized validity type"),errCode$1(new Error("unrecognized validity type"),ERR_UNRECOGNIZED_VALIDITY);log("ipns record for %s is valid",_.value)};async function ipnsValidator(n,r){if(r.byteLength>MAX_RECORD_SIZE)throw errCode$1(new Error("record too large"),ERR_RECORD_TOO_LARGE);const _=peerIdFromRoutingKey(n),E=unmarshal(r),S=await extractPublicKey(_,E);await validate(S,r)}const version$1="1.3.0",name$1="libp2p",version="3.0.1",name="helia",bootstrapConfig={list:["/dnsaddr/bootstrap.libp2p.io/p2p/QmNnooDu7bfjPFoTZYxMNLWUQJyrVwtbZg5gBMjTezGAJN","/dnsaddr/bootstrap.libp2p.io/p2p/QmQCU2EcMqAqQPR2i9bChDtGNJchTbq5TbXJJ16u19uLTa","/dnsaddr/bootstrap.libp2p.io/p2p/QmbLHAnMoJPWSCR5Zhtx6BHJX9KiKNN6tpvbUcqanj75Nb","/dnsaddr/bootstrap.libp2p.io/p2p/QmcZf59bWwK5XFi76CZX8cbJ4BhTzzA3gU1ZjYZcYW3dwt","/ip4/104.131.131.82/tcp/4001/p2p/QmaCpDMGvV2BGHeYERUEnRQAwe3N8SzbUtfsmvsqQLuvuJ"]};function libp2pDefaults(n={}){return{peerId:n.peerId,addresses:{listen:["/webrtc"]},transports:[circuitRelayTransport({discoverRelays:1}),webRTC(),webRTCDirect(),webTransport(),webSockets()],connectionEncryption:[noise$1()],streamMuxers:[yamux(),mplex()],peerDiscovery:[bootstrap(bootstrapConfig)],services:{autoNAT:autoNAT(),dcutr:dcutr(),delegatedRouting:()=>createDelegatedRoutingV1HttpApiClient("https://delegated-ipfs.dev"),dht:kadDHT({clientMode:!0,validators:{ipns:ipnsValidator},selectors:{ipns:ipnsSelector}}),identify:identify({agentVersion:`${name}/${version} ${name$1}/${version$1} UserAgent=${globalThis.navigator.userAgent}`}),keychain:keychain(n.keychain),ping:ping(),pubsub:gossipsub()}}}const codes$1={ERR_INVALID_PARAMETERS:"ERR_INVALID_PARAMETERS"};var Peer$1;(function(n){(function(_){let E;_.codec=()=>(E==null&&(E=message((S,C,A={})=>{A.lengthDelimited!==!1&&C.fork(),S.key!=null&&S.key!==""&&(C.uint32(10),C.string(S.key)),S.value!=null&&S.value.byteLength>0&&(C.uint32(18),C.bytes(S.value)),A.lengthDelimited!==!1&&C.ldelim()},(S,C)=>{const A={key:"",value:new Uint8Array(0)},I=C==null?S.len:S.pos+C;for(;S.pos<I;){const B=S.uint32();switch(B>>>3){case 1:A.key=S.string();break;case 2:A.value=S.bytes();break;default:S.skipType(B&7);break}}return A})),E),_.encode=S=>encodeMessage(S,_.codec()),_.decode=S=>decodeMessage$1(S,_.codec())})(n.Peer$metadataEntry||(n.Peer$metadataEntry={})),function(_){let E;_.codec=()=>(E==null&&(E=message((S,C,A={})=>{A.lengthDelimited!==!1&&C.fork(),S.key!=null&&S.key!==""&&(C.uint32(10),C.string(S.key)),S.value!=null&&(C.uint32(18),Tag.codec().encode(S.value,C)),A.lengthDelimited!==!1&&C.ldelim()},(S,C)=>{const A={key:""},I=C==null?S.len:S.pos+C;for(;S.pos<I;){const B=S.uint32();switch(B>>>3){case 1:A.key=S.string();break;case 2:A.value=Tag.codec().decode(S,S.uint32());break;default:S.skipType(B&7);break}}return A})),E),_.encode=S=>encodeMessage(S,_.codec()),_.decode=S=>decodeMessage$1(S,_.codec())}(n.Peer$tagsEntry||(n.Peer$tagsEntry={}));let r;n.codec=()=>(r==null&&(r=message((_,E,S={})=>{if(S.lengthDelimited!==!1&&E.fork(),_.addresses!=null)for(const C of _.addresses)E.uint32(10),Address.codec().encode(C,E);if(_.protocols!=null)for(const C of _.protocols)E.uint32(18),E.string(C);if(_.publicKey!=null&&(E.uint32(34),E.bytes(_.publicKey)),_.peerRecordEnvelope!=null&&(E.uint32(42),E.bytes(_.peerRecordEnvelope)),_.metadata!=null&&_.metadata.size!==0)for(const[C,A]of _.metadata.entries())E.uint32(50),n.Peer$metadataEntry.codec().encode({key:C,value:A},E);if(_.tags!=null&&_.tags.size!==0)for(const[C,A]of _.tags.entries())E.uint32(58),n.Peer$tagsEntry.codec().encode({key:C,value:A},E);S.lengthDelimited!==!1&&E.ldelim()},(_,E)=>{const S={addresses:[],protocols:[],metadata:new Map,tags:new Map},C=E==null?_.len:_.pos+E;for(;_.pos<C;){const A=_.uint32();switch(A>>>3){case 1:S.addresses.push(Address.codec().decode(_,_.uint32()));break;case 2:S.protocols.push(_.string());break;case 4:S.publicKey=_.bytes();break;case 5:S.peerRecordEnvelope=_.bytes();break;case 6:{const I=n.Peer$metadataEntry.codec().decode(_,_.uint32());S.metadata.set(I.key,I.value);break}case 7:{const I=n.Peer$tagsEntry.codec().decode(_,_.uint32());S.tags.set(I.key,I.value);break}default:_.skipType(A&7);break}}return S})),r),n.encode=_=>encodeMessage(_,n.codec()),n.decode=_=>decodeMessage$1(_,n.codec())})(Peer$1||(Peer$1={}));var Address;(function(n){let r;n.codec=()=>(r==null&&(r=message((_,E,S={})=>{S.lengthDelimited!==!1&&E.fork(),_.multiaddr!=null&&_.multiaddr.byteLength>0&&(E.uint32(10),E.bytes(_.multiaddr)),_.isCertified!=null&&(E.uint32(16),E.bool(_.isCertified)),S.lengthDelimited!==!1&&E.ldelim()},(_,E)=>{const S={multiaddr:new Uint8Array(0)},C=E==null?_.len:_.pos+E;for(;_.pos<C;){const A=_.uint32();switch(A>>>3){case 1:S.multiaddr=_.bytes();break;case 2:S.isCertified=_.bool();break;default:_.skipType(A&7);break}}return S})),r),n.encode=_=>encodeMessage(_,n.codec()),n.decode=_=>decodeMessage$1(_,n.codec())})(Address||(Address={}));var Tag;(function(n){let r;n.codec=()=>(r==null&&(r=message((_,E,S={})=>{S.lengthDelimited!==!1&&E.fork(),_.value!=null&&_.value!==0&&(E.uint32(8),E.uint32(_.value)),_.expiry!=null&&(E.uint32(16),E.uint64(_.expiry)),S.lengthDelimited!==!1&&E.ldelim()},(_,E)=>{const S={value:0},C=E==null?_.len:_.pos+E;for(;_.pos<C;){const A=_.uint32();switch(A>>>3){case 1:S.value=_.uint32();break;case 2:S.expiry=_.uint64();break;default:_.skipType(A&7);break}}return S})),r),n.encode=_=>encodeMessage(_,n.codec()),n.decode=_=>decodeMessage$1(_,n.codec())})(Tag||(Tag={}));function bytesToPeer(n,r){const _=Peer$1.decode(r);_.publicKey!=null&&n.publicKey==null&&(n=peerIdFromPeerId({...n,publicKey:n.publicKey}));const E=new Map,S=BigInt(Date.now());for(const[C,A]of _.tags.entries())A.expiry!=null&&A.expiry<S||E.set(C,A);return{..._,id:n,addresses:_.addresses.map(({multiaddr:C,isCertified:A})=>({multiaddr:multiaddr(C),isCertified:A??!1})),metadata:_.metadata,peerRecordEnvelope:_.peerRecordEnvelope??void 0,tags:E}}const NAMESPACE_COMMON="/peers/";function peerIdToDatastoreKey(n){if(!isPeerId$1(n)||n.type==null)throw new CodeError$4("Invalid PeerId",codes$1.ERR_INVALID_PARAMETERS);const r=n.toCID().toString();return new Key(`${NAMESPACE_COMMON}${r}`)}async function dedupeFilterAndSortAddresses(n,r,_){const E=new Map;for(const S of _){if(S==null)continue;if(S.multiaddr instanceof Uint8Array&&(S.multiaddr=multiaddr(S.multiaddr)),!isMultiaddr(S.multiaddr))throw new CodeError$4("Multiaddr was invalid",codes$1.ERR_INVALID_PARAMETERS);if(!await r(n,S.multiaddr))continue;const C=S.isCertified??!1,A=S.multiaddr.toString(),I=E.get(A);I!=null?S.isCertified=I.isCertified||C:E.set(A,{multiaddr:S.multiaddr,isCertified:C})}return[...E.values()].sort((S,C)=>S.multiaddr.toString().localeCompare(C.multiaddr.toString())).map(({isCertified:S,multiaddr:C})=>({isCertified:S,multiaddr:C.bytes}))}async function toPeerPB(n,r,_,E){if(r==null)throw new CodeError$4("Invalid PeerData",codes$1.ERR_INVALID_PARAMETERS);if(r.publicKey!=null&&n.publicKey!=null&&!equals$1(r.publicKey,n.publicKey))throw new CodeError$4("publicKey bytes do not match peer id publicKey bytes",codes$1.ERR_INVALID_PARAMETERS);const S=E.existingPeer;if(S!=null&&!n.equals(S.id))throw new CodeError$4("peer id did not match existing peer id",codes$1.ERR_INVALID_PARAMETERS);let C=S?.addresses??[],A=new Set(S?.protocols??[]),I=S?.metadata??new Map,B=S?.tags??new Map,O=S?.peerRecordEnvelope;if(_==="patch"){if((r.multiaddrs!=null||r.addresses!=null)&&(C=[],r.multiaddrs!=null&&C.push(...r.multiaddrs.map(U=>({isCertified:!1,multiaddr:U}))),r.addresses!=null&&C.push(...r.addresses)),r.protocols!=null&&(A=new Set(r.protocols)),r.metadata!=null){const U=r.metadata instanceof Map?[...r.metadata.entries()]:Object.entries(r.metadata);I=createSortedMap(U,{validate:validateMetadata})}if(r.tags!=null){const U=r.tags instanceof Map?[...r.tags.entries()]:Object.entries(r.tags);B=createSortedMap(U,{validate:validateTag,map:mapTag})}r.peerRecordEnvelope!=null&&(O=r.peerRecordEnvelope)}if(_==="merge"){if(r.multiaddrs!=null&&C.push(...r.multiaddrs.map(U=>({isCertified:!1,multiaddr:U}))),r.addresses!=null&&C.push(...r.addresses),r.protocols!=null&&(A=new Set([...A,...r.protocols])),r.metadata!=null){const U=r.metadata instanceof Map?[...r.metadata.entries()]:Object.entries(r.metadata);for(const[j,z]of U)z==null?I.delete(j):I.set(j,z);I=createSortedMap([...I.entries()],{validate:validateMetadata})}if(r.tags!=null){const U=r.tags instanceof Map?[...r.tags.entries()]:Object.entries(r.tags),j=new Map(B);for(const[z,Z]of U)Z==null?j.delete(z):j.set(z,Z);B=createSortedMap([...j.entries()],{validate:validateTag,map:mapTag})}r.peerRecordEnvelope!=null&&(O=r.peerRecordEnvelope)}const N={addresses:await dedupeFilterAndSortAddresses(n,E.addressFilter??(async()=>!0),C),protocols:[...A.values()].sort((U,j)=>U.localeCompare(j)),metadata:I,tags:B,publicKey:S?.id.publicKey??r.publicKey??n.publicKey,peerRecordEnvelope:O};return n.type!=="RSA"&&delete N.publicKey,N}function createSortedMap(n,r){const _=new Map;for(const[E,S]of n)S!=null&&r.validate(E,S);for(const[E,S]of n.sort(([C],[A])=>C.localeCompare(A)))S!=null&&_.set(E,r.map?.(E,S)??S);return _}function validateMetadata(n,r){if(typeof n!="string")throw new CodeError$4("Metadata key must be a string",codes$1.ERR_INVALID_PARAMETERS);if(!(r instanceof Uint8Array))throw new CodeError$4("Metadata value must be a Uint8Array",codes$1.ERR_INVALID_PARAMETERS)}function validateTag(n,r){if(typeof n!="string")throw new CodeError$4("Tag name must be a string",codes$1.ERR_INVALID_PARAMETERS);if(r.value!=null){if(parseInt(`${r.value}`,10)!==r.value)throw new CodeError$4("Tag value must be an integer",codes$1.ERR_INVALID_PARAMETERS);if(r.value<0||r.value>100)throw new CodeError$4("Tag value must be between 0-100",codes$1.ERR_INVALID_PARAMETERS)}if(r.ttl!=null){if(parseInt(`${r.ttl}`,10)!==r.ttl)throw new CodeError$4("Tag ttl must be an integer",codes$1.ERR_INVALID_PARAMETERS);if(r.ttl<0)throw new CodeError$4("Tag ttl must be between greater than 0",codes$1.ERR_INVALID_PARAMETERS)}}function mapTag(n,r){let _;return r.expiry!=null&&(_=r.expiry),r.ttl!=null&&(_=BigInt(Date.now()+Number(r.ttl))),{value:r.value??0,expiry:_}}function decodePeer(n,r,_){const E=n.toString().split("/")[2],S=base32.decode(E),C=peerIdFromBytes$1(S),A=_.get(C);if(A!=null)return A;const I=bytesToPeer(C,r);return _.set(C,I),I}function mapQuery(n,r){return n==null?{}:{prefix:NAMESPACE_COMMON,filters:(n.filters??[]).map(_=>({key:E,value:S})=>_(decodePeer(E,S,r))),orders:(n.orders??[]).map(_=>(E,S)=>_(decodePeer(E.key,E.value,r),decodePeer(S.key,S.value,r)))}}class PersistentStore{peerId;datastore;lock;addressFilter;constructor(r,_={}){this.peerId=r.peerId,this.datastore=r.datastore,this.addressFilter=_.addressFilter,this.lock=createMortice({name:"peer-store",singleProcess:!0})}async has(r){return this.datastore.has(peerIdToDatastoreKey(r))}async delete(r){if(this.peerId.equals(r))throw new CodeError$4("Cannot delete self peer",codes$1.ERR_INVALID_PARAMETERS);await this.datastore.delete(peerIdToDatastoreKey(r))}async load(r){const _=await this.datastore.get(peerIdToDatastoreKey(r));return bytesToPeer(r,_)}async save(r,_){const{existingBuf:E,existingPeer:S}=await this.#e(r),C=await toPeerPB(r,_,"patch",{addressFilter:this.addressFilter});return this.#t(r,C,E,S)}async patch(r,_){const{existingBuf:E,existingPeer:S}=await this.#e(r),C=await toPeerPB(r,_,"patch",{addressFilter:this.addressFilter,existingPeer:S});return this.#t(r,C,E,S)}async merge(r,_){const{existingBuf:E,existingPeer:S}=await this.#e(r),C=await toPeerPB(r,_,"merge",{addressFilter:this.addressFilter,existingPeer:S});return this.#t(r,C,E,S)}async*all(r){const _=new PeerMap;for await(const{key:E,value:S}of this.datastore.query(mapQuery(r??{},_))){const C=decodePeer(E,S,_);C.id.equals(this.peerId)||(yield C)}}async#e(r){try{const _=await this.datastore.get(peerIdToDatastoreKey(r)),E=bytesToPeer(r,_);return{existingBuf:_,existingPeer:E}}catch(_){if(_.code!=="ERR_NOT_FOUND")throw _}return{}}async#t(r,_,E,S){const C=Peer$1.encode(_);return E!=null&&equals$1(C,E)?{peer:bytesToPeer(r,C),previous:S,updated:!1}:(await this.datastore.put(peerIdToDatastoreKey(r),C),{peer:bytesToPeer(r,C),previous:S,updated:!0})}}class PersistentPeerStore{store;events;peerId;log;constructor(r,_={}){this.log=r.logger.forComponent("libp2p:peer-store"),this.events=r.events,this.peerId=r.peerId,this.store=new PersistentStore(r,_)}async forEach(r,_){this.log.trace("forEach await read lock");const E=await this.store.lock.readLock();this.log.trace("forEach got read lock");try{for await(const S of this.store.all(_))r(S)}finally{this.log.trace("forEach release read lock"),E()}}async all(r){this.log.trace("all await read lock");const _=await this.store.lock.readLock();this.log.trace("all got read lock");try{return await all$1(this.store.all(r))}finally{this.log.trace("all release read lock"),_()}}async delete(r){this.log.trace("delete await write lock");const _=await this.store.lock.writeLock();this.log.trace("delete got write lock");try{await this.store.delete(r)}finally{this.log.trace("delete release write lock"),_()}}async has(r){this.log.trace("has await read lock");const _=await this.store.lock.readLock();this.log.trace("has got read lock");try{return await this.store.has(r)}finally{this.log.trace("has release read lock"),_()}}async get(r){this.log.trace("get await read lock");const _=await this.store.lock.readLock();this.log.trace("get got read lock");try{return await this.store.load(r)}finally{this.log.trace("get release read lock"),_()}}async save(r,_){this.log.trace("save await write lock");const E=await this.store.lock.writeLock();this.log.trace("save got write lock");try{const S=await this.store.save(r,_);return this.#e(r,S),S.peer}finally{this.log.trace("save release write lock"),E()}}async patch(r,_){this.log.trace("patch await write lock");const E=await this.store.lock.writeLock();this.log.trace("patch got write lock");try{const S=await this.store.patch(r,_);return this.#e(r,S),S.peer}finally{this.log.trace("patch release write lock"),E()}}async merge(r,_){this.log.trace("merge await write lock");const E=await this.store.lock.writeLock();this.log.trace("merge got write lock");try{const S=await this.store.merge(r,_);return this.#e(r,S),S.peer}finally{this.log.trace("merge release write lock"),E()}}async consumePeerRecord(r,_){const E=await RecordEnvelope.openAndCertify(r,PeerRecord.DOMAIN);if(_?.equals(E.peerId)===!1)return this.log("envelope peer id was not the expected peer id - expected: %p received: %p",_,E.peerId),!1;const S=PeerRecord.createFromProtobuf(E.payload);let C;try{C=await this.get(E.peerId)}catch(A){if(A.code!=="ERR_NOT_FOUND")throw A}if(C?.peerRecordEnvelope!=null){const A=await RecordEnvelope.createFromProtobuf(C.peerRecordEnvelope),I=PeerRecord.createFromProtobuf(A.payload);if(I.seqNumber>=S.seqNumber)return this.log("sequence number was lower or equal to existing sequence number - stored: %d received: %d",I.seqNumber,S.seqNumber),!1}return await this.patch(S.peerId,{peerRecordEnvelope:r,addresses:S.multiaddrs.map(A=>({isCertified:!0,multiaddr:A}))}),!0}#e(r,_){_.updated&&(this.peerId.equals(r)?this.events.safeDispatchEvent("self:peer:update",{detail:_}):this.events.safeDispatchEvent("peer:update",{detail:_}))}}function debounce(n,r){let _;return function(){const E=function(){_=void 0,n()};clearTimeout(_),_=setTimeout(E,r)}}const defaultAddressFilter=n=>n;function stripPeerId(n,r){const _=n.getPeerId();return _!=null&&peerIdFromString$1(_).equals(r)&&(n=n.decapsulate(multiaddr(`/p2p/${r.toString()}`))),n}class DefaultAddressManager{log;components;listen;announce;observed;announceFilter;constructor(r,_={}){const{listen:E=[],announce:S=[]}=_;this.components=r,this.log=r.logger.forComponent("libp2p:address-manager"),this.listen=E.map(C=>C.toString()),this.announce=new Set(S.map(C=>C.toString())),this.observed=new Map,this.announceFilter=_.announceFilter??defaultAddressFilter,this._updatePeerStoreAddresses=debounce(this._updatePeerStoreAddresses.bind(this),1e3),r.events.addEventListener("transport:listening",()=>{this._updatePeerStoreAddresses()}),r.events.addEventListener("transport:close",()=>{this._updatePeerStoreAddresses()})}_updatePeerStoreAddresses(){const r=this.getAnnounceAddrs().concat(this.components.transportManager.getAddrs()).concat([...this.observed.entries()].filter(([_,E])=>E.confident).map(([_])=>multiaddr(_))).map(_=>_.getPeerId()===this.components.peerId.toString()?_.decapsulate(`/p2p/${this.components.peerId.toString()}`):_);this.components.peerStore.patch(this.components.peerId,{multiaddrs:r}).catch(_=>{this.log.error("error updating addresses",_)})}getListenAddrs(){return Array.from(this.listen).map(r=>multiaddr(r))}getAnnounceAddrs(){return Array.from(this.announce).map(r=>multiaddr(r))}getObservedAddrs(){return Array.from(this.observed).map(([r])=>multiaddr(r))}addObservedAddr(r){r=stripPeerId(r,this.components.peerId);const _=r.toString();this.observed.has(_)||this.observed.set(_,{confident:!1})}confirmObservedAddr(r){r=stripPeerId(r,this.components.peerId);const _=r.toString(),S=(this.observed.get(_)??{confident:!1}).confident;this.observed.set(_,{confident:!0}),S||this._updatePeerStoreAddresses()}removeObservedAddr(r){r=stripPeerId(r,this.components.peerId);const _=r.toString();this.observed.delete(_)}getAddresses(){let r=this.getAnnounceAddrs().map(E=>E.toString());r.length===0&&(r=this.components.transportManager.getAddrs().map(E=>E.toString())),r=r.concat(Array.from(this.observed).filter(([E,S])=>S.confident).map(([E])=>E));const _=new Set(r);return this.announceFilter(Array.from(_).map(E=>multiaddr(E))).map(E=>E.protos().pop()?.path===!0||E.getPeerId()===this.components.peerId.toString()?E:E.encapsulate(`/p2p/${this.components.peerId.toString()}`))}}class DefaultComponents{components={};_started=!1;constructor(r={}){this.components={};for(const[_,E]of Object.entries(r))this.components[_]=E;this.components.logger==null&&(this.components.logger=defaultLogger())}isStarted(){return this._started}async _invokeStartableMethod(r){await Promise.all(Object.values(this.components).filter(_=>isStartable(_)).map(async _=>{await _[r]?.()}))}async beforeStart(){await this._invokeStartableMethod("beforeStart")}async start(){await this._invokeStartableMethod("start"),this._started=!0}async afterStart(){await this._invokeStartableMethod("afterStart")}async beforeStop(){await this._invokeStartableMethod("beforeStop")}async stop(){await this._invokeStartableMethod("stop"),this._started=!1}async afterStop(){await this._invokeStartableMethod("afterStop")}}const OPTIONAL_SERVICES=["metrics","connectionProtector","dns"],NON_SERVICE_PROPERTIES=["components","isStarted","beforeStart","start","afterStart","beforeStop","stop","afterStop","then","_invokeStartableMethod"];function defaultComponents(n={}){const r=new DefaultComponents(n);return new Proxy(r,{get(E,S,C){if(typeof S=="string"&&!NON_SERVICE_PROPERTIES.includes(S)){const A=r.components[S];if(A==null&&!OPTIONAL_SERVICES.includes(S))throw new CodeError$4(`${S} not set`,"ERR_SERVICE_MISSING");return A}return Reflect.get(E,S,C)},set(E,S,C){return typeof S=="string"?r.components[S]=C:Reflect.set(E,S,C),!0}})}function connectionGater(n={}){return{denyDialPeer:async()=>!1,denyDialMultiaddr:async r=>{const _=r.stringTuples();return _[0][0]===4||_[0][0]===41?!!isPrivateIp(`${_[0][1]}`):!1},denyInboundConnection:async()=>!1,denyOutboundConnection:async()=>!1,denyInboundEncryptedConnection:async()=>!1,denyOutboundEncryptedConnection:async()=>!1,denyInboundUpgradedConnection:async()=>!1,denyOutboundUpgradedConnection:async()=>!1,filterMultiaddrForPeer:async()=>!0,...n}}function isPrivate(n){try{const{address:r}=n.nodeAddress();return!!isPrivateIp(r)}catch{return!0}}function publicAddressesFirst(n,r){const _=isPrivate(n.multiaddr),E=isPrivate(r.multiaddr);return _&&!E?1:!_&&E?-1:0}function certifiedAddressesFirst(n,r){return n.isCertified&&!r.isCertified?-1:!n.isCertified&&r.isCertified?1:0}function circuitRelayAddressesLast(n,r){const _=Circuit.exactMatch(n.multiaddr),E=Circuit.exactMatch(r.multiaddr);return _&&!E?1:!_&&E?-1:0}function defaultAddressSort(n,r){const _=publicAddressesFirst(n,r);if(_!==0)return _;const E=circuitRelayAddressesLast(n,r);return E!==0?E:certifiedAddressesFirst(n,r)}function getTypes(n){const r=[RecordType.A];return n==null?r:Array.isArray(n)?n.length===0?r:n:[n]}const DEFAULT_TTL=60;function toDNSResponse(n){return{Status:n.Status??0,TC:n.TC??n.flag_tc??!1,RD:n.RD??n.flag_rd??!1,RA:n.RA??n.flag_ra??!1,AD:n.AD??n.flag_ad??!1,CD:n.CD??n.flag_cd??!1,Question:(n.Question??n.questions??[]).map(r=>({name:r.name,type:RecordType[r.type]})),Answer:(n.Answer??n.answers??[]).map(r=>({name:r.name,type:RecordType[r.type],TTL:r.TTL??r.ttl??DEFAULT_TTL,data:r.data instanceof Uint8Array?toString$4(r.data):r.data}))}}const DEFAULT_QUERY_CONCURRENCY=4;function dnsJsonOverHttps(n,r={}){const _=new PQueue$1({concurrency:r.queryConcurrency??DEFAULT_QUERY_CONCURRENCY});return async(E,S={})=>{const C=new URLSearchParams;C.set("name",E),getTypes(S.types).forEach(I=>{C.append("type",I.toString())}),S.onProgress?.(new CustomProgressEvent("dns:query",{detail:E}));const A=await _.add(async()=>{const I=await fetch(`${n}?${C}`,{headers:{accept:"application/dns-json"},signal:S?.signal});if(I.status!==200)throw new Error(`Unexpected HTTP status: ${I.status} - ${I.statusText}`);const B=toDNSResponse(await I.json());return S.onProgress?.(new CustomProgressEvent("dns:response",{detail:B})),B},{signal:S.signal});if(A==null)throw new Error("No DNS response received");return A}}function defaultResolver(){return[dnsJsonOverHttps("https://cloudflare-dns.com/dns-query"),dnsJsonOverHttps("https://dns.google/resolve")]}class CachedAnswers{lru;constructor(r){this.lru=hashlru$1(r)}get(r,_){let E=!0;const S=[];for(const C of _){const A=this.getAnswers(r,C);if(A.length===0){E=!1;break}S.push(...A)}if(E)return toDNSResponse({answers:S})}getAnswers(r,_){const E=`${r.toLowerCase()}-${_}`,S=this.lru.get(E);if(S!=null){const C=S.filter(A=>A.expires>Date.now()).map(({expires:A,value:I})=>({...I,TTL:Math.round((A-Date.now())/1e3),type:RecordType[I.type]}));return C.length===0&&this.lru.remove(E),C}return[]}add(r,_){const E=`${r.toLowerCase()}-${_.type}`,S=this.lru.get(E)??[];S.push({expires:Date.now()+(_.TTL??DEFAULT_TTL)*1e3,value:_}),this.lru.set(E,S)}remove(r,_){const E=`${r.toLowerCase()}-${_}`;this.lru.remove(E)}clear(){this.lru.clear()}}function cache(n){return new CachedAnswers(n)}const DEFAULT_ANSWER_CACHE_SIZE=1e3;class DNS{resolvers;cache;constructor(r){this.resolvers={},this.cache=cache(r.cacheSize??DEFAULT_ANSWER_CACHE_SIZE),Object.entries(r.resolvers??{}).forEach(([_,E])=>{Array.isArray(E)||(E=[E]),_.endsWith(".")||(_=`${_}.`),this.resolvers[_]=E}),this.resolvers["."]==null&&(this.resolvers["."]=defaultResolver())}async query(r,_={}){const E=getTypes(_.types),S=_.cached!==!1?this.cache.get(r,E):void 0;if(S!=null)return _.onProgress?.(new CustomProgressEvent("dns:cache",{detail:S})),S;const C=`${r.split(".").pop()}.`,A=(this.resolvers[C]??this.resolvers["."]).sort(()=>Math.random()>.5?-1:1),I=[];for(const B of A){if(_.signal?.aborted===!0)break;try{const O=await B(r,{..._,types:E});for(const N of O.Answer)this.cache.add(r,N);return O}catch(O){I.push(O),_.onProgress?.(new CustomProgressEvent("dns:error",{detail:O}))}}throw I.length===1?I[0]:new AggregateError(I,`DNS lookup of ${r} ${E} failed`)}}var RecordType;(function(n){n[n.A=1]="A",n[n.CNAME=5]="CNAME",n[n.TXT=16]="TXT",n[n.AAAA=28]="AAAA"})(RecordType||(RecordType={}));function dns(n={}){return new DNS(n)}const MAX_RECURSIVE_DEPTH=32,{code:dnsaddrCode}=getProtocol("dnsaddr"),dnsaddrResolver=async function n(r,_={}){const E=_.maxRecursiveDepth??MAX_RECURSIVE_DEPTH;if(E===0)throw new CodeError$4("Max recursive depth reached","ERR_MAX_RECURSIVE_DEPTH_REACHED");const[,S]=r.stringTuples().find(([O])=>O===dnsaddrCode)??[],A=await(_?.dns??dns()).query(`_dnsaddr.${S}`,{signal:_?.signal,types:[RecordType.TXT]}),I=r.getPeerId(),B=[];for(const O of A.Answer){const N=O.data.split("=")[1];if(N==null||I!=null&&!N.includes(I))continue;const U=multiaddr(N);if(N.startsWith("/dnsaddr")){const j=await U.resolve({..._,maxRecursiveDepth:E-1});B.push(...j.map(z=>z.toString()))}else B.push(U.toString())}return B};var messages$1;(function(n){n.NOT_STARTED_YET="The libp2p node is not started yet",n.ERR_PROTECTOR_REQUIRED="Private network is enforced, but no protector was provided",n.NOT_FOUND="Not found"})(messages$1||(messages$1={}));var codes;(function(n){n.ERR_PROTECTOR_REQUIRED="ERR_PROTECTOR_REQUIRED",n.ERR_PEER_DIAL_INTERCEPTED="ERR_PEER_DIAL_INTERCEPTED",n.ERR_CONNECTION_INTERCEPTED="ERR_CONNECTION_INTERCEPTED",n.ERR_INVALID_PROTOCOLS_FOR_STREAM="ERR_INVALID_PROTOCOLS_FOR_STREAM",n.ERR_CONNECTION_ENDED="ERR_CONNECTION_ENDED",n.ERR_CONNECTION_FAILED="ERR_CONNECTION_FAILED",n.ERR_NODE_NOT_STARTED="ERR_NODE_NOT_STARTED",n.ERR_ALREADY_ABORTED="ERR_ALREADY_ABORTED",n.ERR_TOO_MANY_ADDRESSES="ERR_TOO_MANY_ADDRESSES",n.ERR_NO_VALID_ADDRESSES="ERR_NO_VALID_ADDRESSES",n.ERR_RELAYED_DIAL="ERR_RELAYED_DIAL",n.ERR_DIALED_SELF="ERR_DIALED_SELF",n.ERR_DISCOVERED_SELF="ERR_DISCOVERED_SELF",n.ERR_DUPLICATE_TRANSPORT="ERR_DUPLICATE_TRANSPORT",n.ERR_ENCRYPTION_FAILED="ERR_ENCRYPTION_FAILED",n.ERR_HOP_REQUEST_FAILED="ERR_HOP_REQUEST_FAILED",n.ERR_INVALID_KEY="ERR_INVALID_KEY",n.ERR_INVALID_MESSAGE="ERR_INVALID_MESSAGE",n.ERR_INVALID_PARAMETERS="ERR_INVALID_PARAMETERS",n.ERR_INVALID_PEER="ERR_INVALID_PEER",n.ERR_MUXER_UNAVAILABLE="ERR_MUXER_UNAVAILABLE",n.ERR_NOT_FOUND="ERR_NOT_FOUND",n.ERR_TRANSPORT_UNAVAILABLE="ERR_TRANSPORT_UNAVAILABLE",n.ERR_TRANSPORT_DIAL_FAILED="ERR_TRANSPORT_DIAL_FAILED",n.ERR_UNSUPPORTED_PROTOCOL="ERR_UNSUPPORTED_PROTOCOL",n.ERR_PROTOCOL_HANDLER_ALREADY_REGISTERED="ERR_PROTOCOL_HANDLER_ALREADY_REGISTERED",n.ERR_INVALID_MULTIADDR="ERR_INVALID_MULTIADDR",n.ERR_SIGNATURE_NOT_VALID="ERR_SIGNATURE_NOT_VALID",n.ERR_FIND_SELF="ERR_FIND_SELF",n.ERR_NO_ROUTERS_AVAILABLE="ERR_NO_ROUTERS_AVAILABLE",n.ERR_CONNECTION_NOT_MULTIPLEXED="ERR_CONNECTION_NOT_MULTIPLEXED",n.ERR_NO_DIAL_TOKENS="ERR_NO_DIAL_TOKENS",n.ERR_INVALID_CMS="ERR_INVALID_CMS",n.ERR_MISSING_KEYS="ERR_MISSING_KEYS",n.ERR_NO_KEY="ERR_NO_KEY",n.ERR_INVALID_KEY_NAME="ERR_INVALID_KEY_NAME",n.ERR_INVALID_KEY_TYPE="ERR_INVALID_KEY_TYPE",n.ERR_KEY_ALREADY_EXISTS="ERR_KEY_ALREADY_EXISTS",n.ERR_INVALID_KEY_SIZE="ERR_INVALID_KEY_SIZE",n.ERR_KEY_NOT_FOUND="ERR_KEY_NOT_FOUND",n.ERR_OLD_KEY_NAME_INVALID="ERR_OLD_KEY_NAME_INVALID",n.ERR_NEW_KEY_NAME_INVALID="ERR_NEW_KEY_NAME_INVALID",n.ERR_PASSWORD_REQUIRED="ERR_PASSWORD_REQUIRED",n.ERR_PEM_REQUIRED="ERR_PEM_REQUIRED",n.ERR_CANNOT_READ_KEY="ERR_CANNOT_READ_KEY",n.ERR_MISSING_PRIVATE_KEY="ERR_MISSING_PRIVATE_KEY",n.ERR_MISSING_PUBLIC_KEY="ERR_MISSING_PUBLIC_KEY",n.ERR_INVALID_OLD_PASS_TYPE="ERR_INVALID_OLD_PASS_TYPE",n.ERR_INVALID_NEW_PASS_TYPE="ERR_INVALID_NEW_PASS_TYPE",n.ERR_INVALID_PASS_LENGTH="ERR_INVALID_PASS_LENGTH",n.ERR_NOT_IMPLEMENTED="ERR_NOT_IMPLEMENTED",n.ERR_WRONG_PING_ACK="ERR_WRONG_PING_ACK",n.ERR_INVALID_RECORD="ERR_INVALID_RECORD",n.ERR_ALREADY_SUCCEEDED="ERR_ALREADY_SUCCEEDED",n.ERR_NO_HANDLER_FOR_PROTOCOL="ERR_NO_HANDLER_FOR_PROTOCOL",n.ERR_TOO_MANY_OUTBOUND_PROTOCOL_STREAMS="ERR_TOO_MANY_OUTBOUND_PROTOCOL_STREAMS",n.ERR_TOO_MANY_INBOUND_PROTOCOL_STREAMS="ERR_TOO_MANY_INBOUND_PROTOCOL_STREAMS",n.ERR_CONNECTION_DENIED="ERR_CONNECTION_DENIED",n.ERR_TRANSFER_LIMIT_EXCEEDED="ERR_TRANSFER_LIMIT_EXCEEDED"})(codes||(codes={}));const DefaultConfig={addresses:{listen:[],announce:[],noAnnounce:[],announceFilter:n=>n},connectionManager:{resolvers:{dnsaddr:dnsaddrResolver},addressSorter:defaultAddressSort},transportManager:{faultTolerance:FaultTolerance.FATAL_ALL}};async function validateConfig(n){const r=mergeOptions$9(DefaultConfig,n);if(r.connectionProtector===null&&globalThis.process?.env?.LIBP2P_FORCE_PNET!=null)throw new CodeError$4(messages$1.ERR_PROTECTOR_REQUIRED,codes.ERR_PROTECTOR_REQUIRED);if(!(await peerIdFromKeys$1(r.privateKey.public.bytes,r.privateKey.bytes)).equals(r.peerId))throw new CodeError$4("Private key doesn't match peer id",codes.ERR_INVALID_KEY);return r}function getPeerAddress(n){if(isPeerId$1(n))return{peerId:n,multiaddrs:[]};Array.isArray(n)||(n=[n]);let r;if(n.length>0){const _=n[0].getPeerId();r=_==null?void 0:peerIdFromString$1(_),n.forEach(E=>{if(!isMultiaddr(E))throw new CodeError$4("Invalid Multiaddr",codes.ERR_INVALID_MULTIADDR);const S=E.getPeerId();if(S==null){if(r!=null)throw new CodeError$4("Multiaddrs must all have the same peer id or have no peer id",codes.ERR_INVALID_PARAMETERS)}else{const C=peerIdFromString$1(S);if(r==null||!r.equals(C))throw new CodeError$4("Multiaddrs must all have the same peer id or have no peer id",codes.ERR_INVALID_PARAMETERS)}})}return{peerId:r,multiaddrs:n}}const DIAL_TIMEOUT=3e4,INBOUND_UPGRADE_TIMEOUT=3e4,MAX_PEER_ADDRS_TO_DIAL=25,AUTO_DIAL_INTERVAL=5e3,AUTO_DIAL_CONCURRENCY=25,AUTO_DIAL_PRIORITY=0,AUTO_DIAL_MAX_QUEUE_LENGTH=100,AUTO_DIAL_DISCOVERED_PEERS_DEBOUNCE=10,INBOUND_CONNECTION_THRESHOLD=5,MAX_INCOMING_PENDING_CONNECTIONS=10,LAST_DIAL_FAILURE_KEY="last-dial-failure",MIN_CONNECTIONS=5,MAX_CONNECTIONS=100,MAX_PARALLEL_DIALS=50,AUTO_DIAL_PEER_RETRY_THRESHOLD=1e3*60*7,defaultOptions$3={minConnections:MIN_CONNECTIONS,maxQueueLength:AUTO_DIAL_MAX_QUEUE_LENGTH,autoDialConcurrency:AUTO_DIAL_CONCURRENCY,autoDialPriority:AUTO_DIAL_PRIORITY,autoDialInterval:AUTO_DIAL_INTERVAL,autoDialPeerRetryThreshold:AUTO_DIAL_PEER_RETRY_THRESHOLD,autoDialDiscoveredPeersDebounce:AUTO_DIAL_DISCOVERED_PEERS_DEBOUNCE};class AutoDial{connectionManager;peerStore;queue;minConnections;autoDialPriority;autoDialIntervalMs;autoDialMaxQueueLength;autoDialPeerRetryThresholdMs;autoDialDiscoveredPeersDebounce;autoDialInterval;started;running;log;constructor(r,_){this.connectionManager=r.connectionManager,this.peerStore=r.peerStore,this.minConnections=_.minConnections??defaultOptions$3.minConnections,this.autoDialPriority=_.autoDialPriority??defaultOptions$3.autoDialPriority,this.autoDialIntervalMs=_.autoDialInterval??defaultOptions$3.autoDialInterval,this.autoDialMaxQueueLength=_.maxQueueLength??defaultOptions$3.maxQueueLength,this.autoDialPeerRetryThresholdMs=_.autoDialPeerRetryThreshold??defaultOptions$3.autoDialPeerRetryThreshold,this.autoDialDiscoveredPeersDebounce=_.autoDialDiscoveredPeersDebounce??defaultOptions$3.autoDialDiscoveredPeersDebounce,this.log=r.logger.forComponent("libp2p:connection-manager:auto-dial"),this.started=!1,this.running=!1,this.queue=new PeerQueue({concurrency:_.autoDialConcurrency??defaultOptions$3.autoDialConcurrency,metricName:"libp2p_autodial_queue",metrics:r.metrics}),this.queue.addEventListener("error",S=>{this.log.error("error during auto-dial",S.detail)}),r.events.addEventListener("connection:close",()=>{this.autoDial().catch(S=>{this.log.error(S)})});let E;r.events.addEventListener("peer:discovery",()=>{clearTimeout(E),E=setTimeout(()=>{this.autoDial().catch(S=>{this.log.error(S)})},this.autoDialDiscoveredPeersDebounce)})}isStarted(){return this.started}start(){this.started=!0}afterStart(){this.autoDial().catch(r=>{this.log.error("error while autodialing",r)})}stop(){this.queue.clear(),clearTimeout(this.autoDialInterval),this.started=!1,this.running=!1}async autoDial(){if(!this.started||this.running)return;const r=this.connectionManager.getConnectionsMap(),_=r.size;if(_>=this.minConnections){this.minConnections>0&&this.log.trace("have enough connections %d/%d",_,this.minConnections);return}if(this.queue.size>this.autoDialMaxQueueLength){this.log("not enough connections %d/%d but auto dial queue is full",_,this.minConnections),this.sheduleNextAutodial();return}this.running=!0,this.log("not enough connections %d/%d - will dial peers to increase the number of connections",_,this.minConnections);const E=new PeerSet(this.connectionManager.getDialQueue().map(O=>O.peerId).filter(Boolean)),S=await this.peerStore.all({filters:[O=>O.addresses.length===0?(this.log.trace("not autodialing %p because they have no addresses",O.id),!1):r.has(O.id)?(this.log.trace("not autodialing %p because they are already connected",O.id),!1):E.has(O.id)?(this.log.trace("not autodialing %p because they are already being dialed",O.id),!1):this.queue.has(O.id)?(this.log.trace("not autodialing %p because they are already being autodialed",O.id),!1):!0]}),C=S.sort(()=>Math.random()>.5?1:-1),A=new PeerMap;for(const O of C)A.has(O.id)||A.set(O.id,[...O.tags.values()].reduce((N,U)=>N+U.value,0));const B=C.sort((O,N)=>{const U=A.get(O.id)??0,j=A.get(N.id)??0;return U>j?-1:U<j?1:0}).filter(O=>{const N=O.metadata.get(LAST_DIAL_FAILURE_KEY);if(N==null)return!0;const U=parseInt(toString$4(N));return isNaN(U)?!0:Date.now()-U>this.autoDialPeerRetryThresholdMs});this.log("selected %d/%d peers to dial",B.length,S.length);for(const O of B)this.queue.add(async()=>{const N=this.connectionManager.getConnectionsMap().size;if(N>=this.minConnections){this.log("got enough connections now %d/%d",N,this.minConnections),this.queue.clear();return}this.log("connecting to a peerStore stored peer %p",O.id),await this.connectionManager.openConnection(O.id,{priority:this.autoDialPriority})},{peerId:O.id}).catch(N=>{this.log.error("could not connect to peerStore stored peer",N)});this.running=!1,this.sheduleNextAutodial()}sheduleNextAutodial(){this.started&&(this.autoDialInterval=setTimeout(()=>{this.autoDial().catch(r=>{this.log.error("error while autodialing",r)})},this.autoDialIntervalMs))}}const defaultOptions$2={maxConnections:MAX_CONNECTIONS,allow:[]};class ConnectionPruner{maxConnections;connectionManager;peerStore;allow;events;log;constructor(r,_={}){this.maxConnections=_.maxConnections??defaultOptions$2.maxConnections,this.allow=_.allow??defaultOptions$2.allow,this.connectionManager=r.connectionManager,this.peerStore=r.peerStore,this.events=r.events,this.log=r.logger.forComponent("libp2p:connection-manager:connection-pruner"),r.events.addEventListener("connection:open",()=>{this.maybePruneConnections().catch(E=>{this.log.error(E)})})}async maybePruneConnections(){const r=this.connectionManager.getConnections(),_=r.length,E=Math.max(_-this.maxConnections,0);if(this.log("checking max connections limit %d/%d",_,this.maxConnections),_<=this.maxConnections)return;this.log("max connections limit exceeded %d/%d, pruning %d connection(s)",_,this.maxConnections,E);const S=new PeerMap;for(const I of r){const B=I.remotePeer;if(!S.has(B)){S.set(B,0);try{const O=await this.peerStore.get(B);S.set(B,[...O.tags.values()].reduce((N,U)=>N+U.value,0))}catch(O){O.code!=="ERR_NOT_FOUND"&&this.log.error("error loading peer tags",O)}}}const C=r.sort((I,B)=>{const O=S.get(I.remotePeer)??0,N=S.get(B.remotePeer)??0;if(O>N)return 1;if(O<N)return-1;const U=I.timeline.open,j=B.timeline.open;return U<j?1:U>j?-1:0}),A=[];for(const I of C)if(this.log("too many connections open - closing a connection to %p",I.remotePeer),this.allow.some(O=>I.remoteAddr.toString().startsWith(O.toString()))||A.push(I),A.length===E)break;await Promise.all(A.map(async I=>{try{await I.close()}catch(B){this.log.error(B)}})),this.events.safeDispatchEvent("connection:prune",{detail:A})}}async function resolveMultiaddrs(n,r){let _=!1;for(const S of resolvers.keys())if(_=n.protoNames().includes(S),_)break;if(!_)return[n];const E=await n.resolve(r);return r.log("resolved %s to",n,E.map(S=>S.toString())),E}const defaultOptions$1={addressSorter:defaultAddressSort,maxParallelDials:MAX_PARALLEL_DIALS,maxPeerAddrsToDial:MAX_PEER_ADDRS_TO_DIAL,dialTimeout:DIAL_TIMEOUT,resolvers:{dnsaddr:dnsaddrResolver}};class DialQueue{queue;components;addressSorter;maxPeerAddrsToDial;dialTimeout;shutDownController;connections;log;constructor(r,_={}){this.addressSorter=_.addressSorter??defaultOptions$1.addressSorter,this.maxPeerAddrsToDial=_.maxPeerAddrsToDial??defaultOptions$1.maxPeerAddrsToDial,this.dialTimeout=_.dialTimeout??defaultOptions$1.dialTimeout,this.connections=_.connections??new PeerMap,this.log=r.logger.forComponent("libp2p:connection-manager:dial-queue"),this.components=r,this.shutDownController=new AbortController,setMaxListeners$2(1/0,this.shutDownController.signal);for(const[E,S]of Object.entries(_.resolvers??{}))resolvers.set(E,S);this.queue=new Queue({concurrency:_.maxParallelDials??defaultOptions$1.maxParallelDials,metricName:"libp2p_dial_queue",metrics:r.metrics}),this.queue.addEventListener("error",E=>{this.log.error("error in dial queue",E.detail)})}start(){this.shutDownController=new AbortController,setMaxListeners$2(1/0,this.shutDownController.signal)}stop(){this.shutDownController.abort(),this.queue.abort()}async dial(r,_={}){const{peerId:E,multiaddrs:S}=getPeerAddress(r),C=Array.from(this.connections.values()).flat().find(I=>_.force===!0?!1:I.remotePeer.equals(E)?!0:S.find(B=>B.equals(I.remoteAddr)));if(C!=null)return this.log("already connected to %a",C.remoteAddr),C;const A=this.queue.queue.find(I=>{if(E?.equals(I.options.peerId)===!0)return!0;const B=I.options.multiaddrs;if(B==null)return!1;for(const O of S)if(B.has(O.toString()))return!0;return!1});if(A!=null){this.log("joining existing dial target for %p",E);for(const I of S)A.options.multiaddrs.add(I.toString());return A.join(_)}return this.log("creating dial target for %p",E,S.map(I=>I.toString())),this.queue.add(async I=>{const B=this.createDialAbortController(I?.signal);let O;try{O=await this.calculateMultiaddrs(E,I?.multiaddrs,{...I,signal:B}),O.map(({multiaddr:N})=>N.toString()).forEach(N=>{I?.multiaddrs.add(N)})}catch(N){throw B.clear(),N}try{let N=0;const U=[];for(const j of O){if(N===this.maxPeerAddrsToDial)throw this.log("dialed maxPeerAddrsToDial (%d) addresses for %p, not trying any others",N,E),new CodeError$4("Peer had more than maxPeerAddrsToDial",codes.ERR_TOO_MANY_ADDRESSES);N++;try{const z=await this.components.transportManager.dial(j.multiaddr,{...I,signal:B});return this.log("dial to %a succeeded",j.multiaddr),z}catch(z){if(this.log.error("dial failed to %a",j.multiaddr,z),E!=null)try{await this.components.peerStore.patch(E,{metadata:{[LAST_DIAL_FAILURE_KEY]:fromString$3(Date.now().toString())}})}catch(Z){this.log.error("could not update last dial failure key for %p",E,Z)}if(B.aborted)throw new CodeError$4(z.message,ERR_TIMEOUT);U.push(z)}}throw U.length===1?U[0]:new AggregateCodeError(U,"All multiaddr dials failed",codes.ERR_TRANSPORT_DIAL_FAILED)}finally{B.clear()}},{peerId:E,priority:_.priority,multiaddrs:new Set(S.map(I=>I.toString())),signal:_.signal})}createDialAbortController(r){const _=anySignal([AbortSignal.timeout(this.dialTimeout),this.shutDownController.signal,r]);return setMaxListeners$2(1/0,_),_}async calculateMultiaddrs(r,_=new Set,E={}){const S=[..._].map(U=>({multiaddr:multiaddr(U),isCertified:!1}));if(r!=null){if(this.components.peerId.equals(r))throw new CodeError$4("Tried to dial self",codes.ERR_DIALED_SELF);if(await this.components.connectionGater.denyDialPeer?.(r)===!0)throw new CodeError$4("The dial request is blocked by gater.allowDialPeer",codes.ERR_PEER_DIAL_INTERCEPTED);if(S.length===0){this.log("loading multiaddrs for %p",r);try{const U=await this.components.peerStore.get(r);S.push(...U.addresses),this.log("loaded multiaddrs for %p",r,S.map(({multiaddr:j})=>j.toString()))}catch(U){if(U.code!==codes.ERR_NOT_FOUND)throw U}}if(S.length===0){this.log("looking up multiaddrs for %p in the peer routing",r);try{const U=await this.components.peerRouting.findPeer(r);this.log("found multiaddrs for %p in the peer routing",r,S.map(({multiaddr:j})=>j.toString())),S.push(...U.multiaddrs.map(j=>({multiaddr:j,isCertified:!1})))}catch(U){U.code!==codes.ERR_NO_ROUTERS_AVAILABLE&&this.log.error("looking up multiaddrs for %p in the peer routing failed",r,U)}}}let C=(await Promise.all(S.map(async U=>{const j=await resolveMultiaddrs(U.multiaddr,{dns:this.components.dns,...E,log:this.log});return j.length===1&&j[0].equals(U.multiaddr)?U:j.map(z=>({multiaddr:z,isCertified:!1}))}))).flat();if(r!=null){const U=`/p2p/${r.toString()}`;C=C.map(j=>j.multiaddr.protos().pop()?.path===!0?j:j.multiaddr.getPeerId()==null?{multiaddr:j.multiaddr.encapsulate(U),isCertified:j.isCertified}:j)}const A=C.filter(U=>{if(this.components.transportManager.transportForMultiaddr(U.multiaddr)==null)return!1;const j=U.multiaddr.getPeerId();return r!=null&&j!=null?r.equals(j):!0}),I=new Map;for(const U of A){const j=U.multiaddr.toString(),z=I.get(j);if(z!=null){z.isCertified=z.isCertified||U.isCertified||!1;continue}I.set(j,U)}const B=[...I.values()];if(B.length===0)throw new CodeError$4("The dial request has no valid addresses",codes.ERR_NO_VALID_ADDRESSES);const O=[];for(const U of B)this.components.connectionGater.denyDialMultiaddr!=null&&await this.components.connectionGater.denyDialMultiaddr(U.multiaddr)||O.push(U);const N=O.sort(this.addressSorter);if(N.length===0)throw new CodeError$4("The connection gater denied all addresses in the dial request",codes.ERR_NO_VALID_ADDRESSES);return this.log.trace("addresses for %p before filtering",r??"unknown peer",C.map(({multiaddr:U})=>U.toString())),this.log.trace("addresses for %p after filtering",r??"unknown peer",N.map(({multiaddr:U})=>U.toString())),N}}const DEFAULT_DIAL_PRIORITY=50,defaultOptions={minConnections:MIN_CONNECTIONS,maxConnections:MAX_CONNECTIONS,inboundConnectionThreshold:INBOUND_CONNECTION_THRESHOLD,maxIncomingPendingConnections:MAX_INCOMING_PENDING_CONNECTIONS,autoDialConcurrency:AUTO_DIAL_CONCURRENCY,autoDialPriority:AUTO_DIAL_PRIORITY,autoDialMaxQueueLength:AUTO_DIAL_MAX_QUEUE_LENGTH};class DefaultConnectionManager{started;connections;allow;deny;maxIncomingPendingConnections;incomingPendingConnections;maxConnections;dialQueue;autoDial;connectionPruner;inboundConnectionRateLimiter;peerStore;metrics;events;log;constructor(r,_={}){this.maxConnections=_.maxConnections??defaultOptions.maxConnections;const E=_.minConnections??defaultOptions.minConnections;if(this.maxConnections<E)throw new CodeError$4("Connection Manager maxConnections must be greater than minConnections",codes.ERR_INVALID_PARAMETERS);this.connections=new PeerMap,this.started=!1,this.peerStore=r.peerStore,this.metrics=r.metrics,this.events=r.events,this.log=r.logger.forComponent("libp2p:connection-manager"),this.onConnect=this.onConnect.bind(this),this.onDisconnect=this.onDisconnect.bind(this),this.events.addEventListener("connection:open",this.onConnect),this.events.addEventListener("connection:close",this.onDisconnect),this.allow=(_.allow??[]).map(S=>multiaddr(S)),this.deny=(_.deny??[]).map(S=>multiaddr(S)),this.incomingPendingConnections=0,this.maxIncomingPendingConnections=_.maxIncomingPendingConnections??defaultOptions.maxIncomingPendingConnections,this.inboundConnectionRateLimiter=new RateLimiter({points:_.inboundConnectionThreshold??defaultOptions.inboundConnectionThreshold,duration:1}),this.autoDial=new AutoDial({connectionManager:this,peerStore:r.peerStore,events:r.events,logger:r.logger},{minConnections:E,autoDialConcurrency:_.autoDialConcurrency??defaultOptions.autoDialConcurrency,autoDialPriority:_.autoDialPriority??defaultOptions.autoDialPriority,maxQueueLength:_.autoDialMaxQueueLength??defaultOptions.autoDialMaxQueueLength}),this.connectionPruner=new ConnectionPruner({connectionManager:this,peerStore:r.peerStore,events:r.events,logger:r.logger},{maxConnections:this.maxConnections,allow:this.allow}),this.dialQueue=new DialQueue(r,{addressSorter:_.addressSorter??defaultAddressSort,maxParallelDials:_.maxParallelDials??MAX_PARALLEL_DIALS,maxPeerAddrsToDial:_.maxPeerAddrsToDial??MAX_PEER_ADDRS_TO_DIAL,dialTimeout:_.dialTimeout??DIAL_TIMEOUT,resolvers:_.resolvers??{dnsaddr:dnsaddrResolver},connections:this.connections})}isStarted(){return this.started}async start(){this.metrics?.registerMetricGroup("libp2p_connection_manager_connections",{calculate:()=>{const r={inbound:0,outbound:0};for(const _ of this.connections.values())for(const E of _)E.direction==="inbound"?r.inbound++:r.outbound++;return r}}),this.metrics?.registerMetricGroup("libp2p_protocol_streams_total",{label:"protocol",calculate:()=>{const r={};for(const _ of this.connections.values())for(const E of _)for(const S of E.streams){const C=`${S.direction} ${S.protocol??"unnegotiated"}`;r[C]=(r[C]??0)+1}return r}}),this.metrics?.registerMetricGroup("libp2p_connection_manager_protocol_streams_per_connection_90th_percentile",{label:"protocol",calculate:()=>{const r={};for(const E of this.connections.values())for(const S of E){const C={};for(const A of S.streams){const I=`${A.direction} ${A.protocol??"unnegotiated"}`;C[I]=(C[I]??0)+1}for(const[A,I]of Object.entries(C))r[A]=r[A]??[],r[A].push(I)}const _={};for(let[E,S]of Object.entries(r)){S=S.sort((A,I)=>A-I);const C=Math.floor(S.length*.9);_[E]=S[C]}return _}}),this.dialQueue.start(),this.autoDial.start(),this.started=!0,this.log("started")}async afterStart(){Promise.resolve().then(async()=>{const r=await this.peerStore.all({filters:[_=>_.tags.has(KEEP_ALIVE)]});await Promise.all(r.map(async _=>{await this.openConnection(_.id).catch(E=>{this.log.error(E)})}))}).catch(r=>{this.log.error(r)}),this.autoDial.afterStart()}async stop(){this.dialQueue.stop(),this.autoDial.stop();const r=[];for(const _ of this.connections.values())for(const E of _)r.push((async()=>{try{await E.close()}catch(S){this.log.error(S)}})());this.log("closing %d connections",r.length),await Promise.all(r),this.connections.clear(),this.log("stopped")}onConnect(r){this._onConnect(r).catch(_=>{this.log.error(_)})}async _onConnect(r){const{detail:_}=r;if(!this.started){await _.close();return}const E=_.remotePeer,S=this.connections.get(E);let C=!1;S!=null?S.push(_):(C=!0,this.connections.set(E,[_])),E.publicKey!=null&&E.type==="RSA"&&await this.peerStore.patch(E,{publicKey:E.publicKey}),C&&this.events.safeDispatchEvent("peer:connect",{detail:_.remotePeer})}onDisconnect(r){const{detail:_}=r;if(!this.started)return;const E=_.remotePeer;let S=this.connections.get(E);S!=null&&S.length>1?(S=S.filter(C=>C.id!==_.id),this.connections.set(E,S)):S!=null&&(this.connections.delete(E),this.events.safeDispatchEvent("peer:disconnect",{detail:_.remotePeer}))}getConnections(r){if(r!=null)return this.connections.get(r)??[];let _=[];for(const E of this.connections.values())_=_.concat(E);return _}getConnectionsMap(){return this.connections}async openConnection(r,_={}){if(!this.isStarted())throw new CodeError$4("Not started",codes.ERR_NODE_NOT_STARTED);_.signal?.throwIfAborted();const{peerId:E}=getPeerAddress(r);if(E!=null&&_.force!==!0){this.log("dial %p",E);const I=this.getConnections(E).find(B=>!B.transient);if(I!=null)return this.log("had an existing non-transient connection to %p",E),I}const S=await this.dialQueue.dial(r,{..._,priority:_.priority??DEFAULT_DIAL_PRIORITY});let C=this.connections.get(S.remotePeer);C==null&&(C=[],this.connections.set(S.remotePeer,C));let A=!1;for(const I of C)I.id===S.id&&(A=!0);return A||C.push(S),S}async closeConnections(r,_={}){const E=this.connections.get(r)??[];await Promise.all(E.map(async S=>{try{await S.close(_)}catch(C){S.abort(C)}}))}async acceptIncomingConnection(r){if(this.deny.some(S=>r.remoteAddr.toString().startsWith(S.toString())))return this.log("connection from %a refused - connection remote address was in deny list",r.remoteAddr),!1;if(this.allow.some(S=>r.remoteAddr.toString().startsWith(S.toString())))return this.incomingPendingConnections++,!0;if(this.incomingPendingConnections===this.maxIncomingPendingConnections)return this.log("connection from %a refused - incomingPendingConnections exceeded by host",r.remoteAddr),!1;if(r.remoteAddr.isThinWaistAddress()){const S=r.remoteAddr.nodeAddress().address;try{await this.inboundConnectionRateLimiter.consume(S,1)}catch{return this.log("connection from %a refused - inboundConnectionThreshold exceeded by host %s",r.remoteAddr,S),!1}}return this.getConnections().length<this.maxConnections?(this.incomingPendingConnections++,!0):(this.log("connection from %a refused - maxConnections exceeded",r.remoteAddr),!1)}afterUpgradeInbound(){this.incomingPendingConnections--}getDialQueue(){const r={queued:"queued",running:"active",errored:"error",complete:"success"};return this.dialQueue.queue.queue.map(_=>({id:_.id,status:r[_.status],peerId:_.options.peerId,multiaddrs:[..._.options.multiaddrs].map(E=>multiaddr(E))}))}}class CompoundContentRouting{routers;started;components;constructor(r,_){this.routers=_.routers??[],this.started=!1,this.components=r}isStarted(){return this.started}async start(){this.started=!0}async stop(){this.started=!1}async*findProviders(r,_={}){if(this.routers.length===0)throw new CodeError$4("No content routers available",codes.ERR_NO_ROUTERS_AVAILABLE);const E=this,S=new PeerSet;for await(const C of merge$1(...E.routers.map(A=>A.findProviders(r,_))))C!=null&&(C.multiaddrs.length>0&&await this.components.peerStore.merge(C.id,{multiaddrs:C.multiaddrs}),!S.has(C.id)&&(S.add(C.id),yield C))}async provide(r,_={}){if(this.routers.length===0)throw new CodeError$4("No content routers available",codes.ERR_NO_ROUTERS_AVAILABLE);await Promise.all(this.routers.map(async E=>{await E.provide(r,_)}))}async put(r,_,E){if(!this.isStarted())throw new CodeError$4(messages$1.NOT_STARTED_YET,codes.ERR_NODE_NOT_STARTED);await Promise.all(this.routers.map(async S=>{await S.put(r,_,E)}))}async get(r,_){if(!this.isStarted())throw new CodeError$4(messages$1.NOT_STARTED_YET,codes.ERR_NODE_NOT_STARTED);return Promise.any(this.routers.map(async E=>E.get(r,_)))}}class DefaultPeerRouting{log;peerId;peerStore;routers;constructor(r,_={}){this.log=r.logger.forComponent("libp2p:peer-routing"),this.peerId=r.peerId,this.peerStore=r.peerStore,this.routers=_.routers??[]}async findPeer(r,_){if(this.routers.length===0)throw new CodeError$4("No peer routers available",codes.ERR_NO_ROUTERS_AVAILABLE);if(r.toString()===this.peerId.toString())throw new CodeError$4("Should not try to find self",codes.ERR_FIND_SELF);const E=this,S=merge$1(...this.routers.map(C=>async function*(){try{yield await C.findPeer(r,_)}catch(A){E.log.error(A)}}()));for await(const C of S)if(C!=null)return C.multiaddrs.length>0&&await this.peerStore.merge(C.id,{multiaddrs:C.multiaddrs}),C;throw new CodeError$4(messages$1.NOT_FOUND,codes.ERR_NOT_FOUND)}async*getClosestPeers(r,_={}){if(this.routers.length===0)throw new CodeError$4("No peer routers available",codes.ERR_NO_ROUTERS_AVAILABLE);const E=this,S=new PeerSet;for await(const C of parallel(async function*(){const A=merge$1(...E.routers.map(I=>I.getClosestPeers(r,_)));for await(let I of A)yield async()=>{if(I.multiaddrs.length===0)try{I=await E.findPeer(I.id,{..._,useCache:!1})}catch(B){E.log.error("could not find peer multiaddrs",B);return}return I}}()))C!=null&&(C.multiaddrs.length>0&&await this.peerStore.merge(C.id,{multiaddrs:C.multiaddrs}),!S.has(C.id)&&(S.add(C.id),yield C))}}const DEFAULT_MAX_INBOUND_STREAMS=32,DEFAULT_MAX_OUTBOUND_STREAMS=64;class DefaultRegistrar{log;topologies;handlers;components;constructor(r){this.log=r.logger.forComponent("libp2p:registrar"),this.topologies=new Map,this.handlers=new Map,this.components=r,this._onDisconnect=this._onDisconnect.bind(this),this._onPeerUpdate=this._onPeerUpdate.bind(this),this._onPeerIdentify=this._onPeerIdentify.bind(this),this.components.events.addEventListener("peer:disconnect",this._onDisconnect),this.components.events.addEventListener("peer:update",this._onPeerUpdate),this.components.events.addEventListener("peer:identify",this._onPeerIdentify)}getProtocols(){return Array.from(new Set([...this.handlers.keys()])).sort()}getHandler(r){const _=this.handlers.get(r);if(_==null)throw new CodeError$4(`No handler registered for protocol ${r}`,codes.ERR_NO_HANDLER_FOR_PROTOCOL);return _}getTopologies(r){const _=this.topologies.get(r);return _==null?[]:[..._.values()]}async handle(r,_,E){if(this.handlers.has(r))throw new CodeError$4(`Handler already registered for protocol ${r}`,codes.ERR_PROTOCOL_HANDLER_ALREADY_REGISTERED);const S=mergeOptions$9.bind({ignoreUndefined:!0})({maxInboundStreams:DEFAULT_MAX_INBOUND_STREAMS,maxOutboundStreams:DEFAULT_MAX_OUTBOUND_STREAMS},E);this.handlers.set(r,{handler:_,options:S}),await this.components.peerStore.merge(this.components.peerId,{protocols:[r]})}async unhandle(r){(Array.isArray(r)?r:[r]).forEach(E=>{this.handlers.delete(E)}),await this.components.peerStore.patch(this.components.peerId,{protocols:this.getProtocols()})}async register(r,_){if(_==null)throw new CodeError$4("invalid topology",codes.ERR_INVALID_PARAMETERS);const E=`${(Math.random()*1e9).toString(36)}${Date.now()}`;let S=this.topologies.get(r);return S==null&&(S=new Map,this.topologies.set(r,S)),S.set(E,_),E}unregister(r){for(const[_,E]of this.topologies.entries())E.has(r)&&(E.delete(r),E.size===0&&this.topologies.delete(_))}_onDisconnect(r){const _=r.detail;this.components.peerStore.get(_).then(E=>{for(const S of E.protocols){const C=this.topologies.get(S);if(C!=null)for(const A of C.values())A.onDisconnect?.(_)}}).catch(E=>{E.code!==codes.ERR_NOT_FOUND&&this.log.error("could not inform topologies of disconnecting peer %p",_,E)})}_onPeerUpdate(r){const{peer:_,previous:E}=r.detail,S=(E?.protocols??[]).filter(C=>!_.protocols.includes(C));for(const C of S){const A=this.topologies.get(C);if(A!=null)for(const I of A.values())I.onDisconnect?.(_.id)}}_onPeerIdentify(r){const _=r.detail.protocols,E=r.detail.connection,S=r.detail.peerId;for(const C of _){const A=this.topologies.get(C);if(A!=null)for(const I of A.values())E.transient&&I.notifyOnTransient!==!0||I.onConnect?.(S,E)}}}class DefaultTransportManager{log;components;transports;listeners;faultTolerance;started;constructor(r,_={}){this.log=r.logger.forComponent("libp2p:transports"),this.components=r,this.started=!1,this.transports=new Map,this.listeners=trackedMap({name:"libp2p_transport_manager_listeners",metrics:this.components.metrics}),this.faultTolerance=_.faultTolerance??FaultTolerance.FATAL_ALL}add(r){const _=r[Symbol.toStringTag];if(_==null)throw new CodeError$4("Transport must have a valid tag",codes.ERR_INVALID_KEY);if(this.transports.has(_))throw new CodeError$4(`There is already a transport with the tag ${_}`,codes.ERR_DUPLICATE_TRANSPORT);this.log("adding transport %s",_),this.transports.set(_,r),this.listeners.has(_)||this.listeners.set(_,[])}isStarted(){return this.started}start(){this.started=!0}async afterStart(){const r=this.components.addressManager.getListenAddrs();await this.listen(r)}async stop(){const r=[];for(const[_,E]of this.listeners)for(this.log("closing listeners for %s",_);E.length>0;){const S=E.pop();S!=null&&r.push(S.close())}await Promise.all(r),this.log("all listeners closed");for(const _ of this.listeners.keys())this.listeners.set(_,[]);this.started=!1}async dial(r,_){const E=this.transportForMultiaddr(r);if(E==null)throw new CodeError$4(`No transport available for address ${String(r)}`,codes.ERR_TRANSPORT_UNAVAILABLE);try{return await E.dial(r,{..._,upgrader:this.components.upgrader})}catch(S){throw S.code==null&&(S.code=codes.ERR_TRANSPORT_DIAL_FAILED),S}}getAddrs(){let r=[];for(const _ of this.listeners.values())for(const E of _)r=[...r,...E.getAddrs()];return r}getTransports(){return Array.of(...this.transports.values())}getListeners(){return Array.of(...this.listeners.values()).flat()}transportForMultiaddr(r){for(const _ of this.transports.values())if(_.filter([r]).length>0)return _}async listen(r){if(!this.isStarted())throw new CodeError$4("Not started",codes.ERR_NODE_NOT_STARTED);if(r==null||r.length===0){this.log("no addresses were provided for listening, this node is dial only");return}const _=[];for(const[E,S]of this.transports.entries()){const C=S.filter(r),A=[];for(const O of C){this.log("creating listener for %s on %a",E,O);const N=S.createListener({upgrader:this.components.upgrader});let U=this.listeners.get(E)??[];U==null&&(U=[],this.listeners.set(E,U)),U.push(N),N.addEventListener("listening",()=>{this.components.events.safeDispatchEvent("transport:listening",{detail:N})}),N.addEventListener("close",()=>{const j=U.findIndex(z=>z===N);U.splice(j,1),this.components.events.safeDispatchEvent("transport:close",{detail:N})}),A.push(N.listen(O))}if(A.length===0){_.push(E);continue}if((await Promise.allSettled(A)).find(O=>O.status==="fulfilled")==null&&this.faultTolerance!==FaultTolerance.NO_FATAL)throw new CodeError$4(`Transport (${E}) could not listen on any available address`,codes.ERR_NO_VALID_ADDRESSES)}if(_.length===this.transports.size){const E=`no valid addresses were provided for transports [${_.join(", ")}]`;if(this.faultTolerance===FaultTolerance.FATAL_ALL)throw new CodeError$4(E,codes.ERR_NO_VALID_ADDRESSES);this.log(`libp2p in dial mode only: ${E}`)}}async remove(r){const _=this.listeners.get(r)??[];this.log.trace("removing transport %s",r);const E=[];for(this.log.trace("closing listeners for %s",r);_.length>0;){const S=_.pop();S!=null&&E.push(S.close())}await Promise.all(E),this.transports.delete(r),this.listeners.delete(r)}async removeAll(){const r=[];for(const _ of this.transports.keys())r.push(this.remove(_));await Promise.all(r)}}const PROTOCOL_ID="/multistream/1.0.0",MAX_PROTOCOL_LENGTH=1024,NewLine=fromString$3(`
`);async function write(n,r,_){await n.write(r,_)}async function writeAll(n,r,_){await n.writeV(r,_)}async function read(n,r){const _=await n.read(r);if(_.byteLength===0||_.get(_.byteLength-1)!==NewLine[0])throw r.log.error("Invalid mss message - missing newline",_),new CodeError$4("missing newline","ERR_INVALID_MULTISTREAM_SELECT_MESSAGE");return _.sublist(0,-1)}async function readString(n,r){const _=await read(n,r);return toString$4(_.subarray())}async function select(n,r,_){if(r=Array.isArray(r)?[...r]:[r],r.length===1&&_.negotiateFully===!1)return optimisticSelect(n,r[0],_);const E=lpStream(n,{..._,maxDataLength:MAX_PROTOCOL_LENGTH}),S=r.shift();if(S==null)throw new Error("At least one protocol must be specified");_.log.trace('select: write ["%s", "%s"]',PROTOCOL_ID,S);const C=fromString$3(`${PROTOCOL_ID}
`),A=fromString$3(`${S}
`);await writeAll(E,[C,A],_),_.log.trace("select: reading multistream-select header");let I=await readString(E,_);if(_.log.trace('select: read "%s"',I),I===PROTOCOL_ID&&(_.log.trace("select: reading protocol response"),I=await readString(E,_),_.log.trace('select: read "%s"',I)),I===S)return{stream:E.unwrap(),protocol:S};for(const B of r){_.log.trace('select: write "%s"',B),await write(E,fromString$3(`${B}
`),_),_.log.trace("select: reading protocol response");const O=await readString(E,_);if(_.log.trace('select: read "%s" for "%s"',O,B),O===B)return{stream:E.unwrap(),protocol:B}}throw new CodeError$4("protocol selection failed","ERR_UNSUPPORTED_PROTOCOL")}function optimisticSelect(n,r,_){const E=n.sink.bind(n),S=n.source;let C=!1,A=!1;const I=pDefer();let B=!1,O=!1;const N=pDefer();let U=!1,j=!1;const z=pDefer(),Z=lpStream({sink:E,source:S},{..._,maxDataLength:MAX_PROTOCOL_LENGTH});n.sink=async oe=>{const{sink:ue}=Z.unwrap();await ue(async function*(){let we=!1;for await(const Te of oe){if(O&&await N.promise,B)yield Te;else{O=!0,_.log.trace('optimistic: write ["%s", "%s", data(%d)] in sink',PROTOCOL_ID,r,Te.byteLength);const xe=`${r}
`;yield new Uint8ArrayList(Uint8Array.from([19]),fromString$3(`${PROTOCOL_ID}
`),encode$b(xe.length),fromString$3(xe),Te).subarray(),_.log.trace('optimistic: wrote ["%s", "%s", data(%d)] in sink',PROTOCOL_ID,r,Te.byteLength),B=!0,O=!1,N.resolve(),X().catch(Re=>{_.log.error("could not finish optimistic protocol negotiation of %s",r,Re)})}we=!0}we||await X()}())};async function X(){if(A){_.log.trace("optimistic: already negotiating %s stream",r),await I.promise;return}A=!0;try{B||(_.log.trace("optimistic: doing send protocol for %s stream",r),await Q()),U||(_.log.trace("optimistic: doing read protocol for %s stream",r),await se())}finally{A=!1,C=!0,I.resolve()}}async function Q(){if(O){await N.promise;return}O=!0;try{_.log.trace('optimistic: write ["%s", "%s", data] in source',PROTOCOL_ID,r),await Z.writeV([fromString$3(`${PROTOCOL_ID}
`),fromString$3(`${r}
`)]),_.log.trace('optimistic: wrote ["%s", "%s", data] in source',PROTOCOL_ID,r)}finally{B=!0,O=!1,N.resolve()}}async function se(){if(j){await z.promise;return}j=!0;try{_.log.trace("optimistic: reading multistream select header");let oe=await readString(Z,_);if(_.log.trace('optimistic: read multistream select header "%s"',oe),oe===PROTOCOL_ID&&(oe=await readString(Z,_)),_.log.trace('optimistic: read protocol "%s", expecting "%s"',oe,r),oe!==r)throw new CodeError$4("protocol selection failed","ERR_UNSUPPORTED_PROTOCOL")}finally{U=!0,j=!1,z.resolve()}}if(n.source=async function*(){await X(),_.log.trace('optimistic: reading data from "%s" stream',r),yield*Z.unwrap().source}(),n.closeRead!=null){const oe=n.closeRead.bind(n);n.closeRead=async ue=>{C||await X().catch(we=>{_.log.error("could not negotiate protocol before close read",we)}),await oe(ue)}}if(n.closeWrite!=null){const oe=n.closeWrite.bind(n);n.closeWrite=async ue=>{C||await X().catch(we=>{_.log.error("could not negotiate protocol before close write",we)}),await oe(ue)}}if(n.close!=null){const oe=n.close.bind(n);n.close=async ue=>{const we=[];O&&we.push(N.promise),j&&we.push(z.promise),we.length>0?await raceSignal(Promise.all(we),ue?.signal):(C=!0,A=!1,I.resolve()),await oe(ue)}}return{stream:n,protocol:r}}async function handle(n,r,_){r=Array.isArray(r)?r:[r],_.log.trace("handle: available protocols %s",r);const E=lpStream(n,{..._,maxDataLength:MAX_PROTOCOL_LENGTH,maxLengthLength:2});for(;;){_.log.trace("handle: reading incoming string");const S=await readString(E,_);if(_.log.trace('handle: read "%s"',S),S===PROTOCOL_ID){_.log.trace('handle: respond with "%s" for "%s"',PROTOCOL_ID,S),await write(E,fromString$3(`${PROTOCOL_ID}
`),_),_.log.trace('handle: responded with "%s" for "%s"',PROTOCOL_ID,S);continue}if(r.includes(S))return _.log.trace('handle: respond with "%s" for "%s"',S,S),await write(E,fromString$3(`${S}
`),_),_.log.trace('handle: responded with "%s" for "%s"',S,S),{stream:E.unwrap(),protocol:S};if(S==="ls"){const C=new Uint8ArrayList(...r.map(A=>encode$6.single(fromString$3(`${A}
`))),fromString$3(`
`));_.log.trace('handle: respond with "%s" for %s',r,S),await write(E,C,_),_.log.trace('handle: responded with "%s" for %s',r,S);continue}_.log('handle: respond with "na" for "%s"',S),await write(E,fromString$3(`na
`),_),_.log('handle: responded with "na" for "%s"',S)}}const CLOSE_TIMEOUT=500;class ConnectionImpl{id;remoteAddr;remotePeer;direction;timeline;multiplexer;encryption;status;transient;log;tags;_newStream;_close;_abort;_getStreams;constructor(r){const{remoteAddr:_,remotePeer:E,newStream:S,close:C,abort:A,getStreams:I}=r;this.id=`${parseInt(String(Math.random()*1e9)).toString(36)}${Date.now()}`,this.remoteAddr=_,this.remotePeer=E,this.direction=r.direction,this.status="open",this.timeline=r.timeline,this.multiplexer=r.multiplexer,this.encryption=r.encryption,this.transient=r.transient??!1,this.log=r.logger.forComponent(`libp2p:connection:${this.direction}:${this.id}`),this.remoteAddr.getPeerId()==null&&(this.remoteAddr=this.remoteAddr.encapsulate(`/p2p/${this.remotePeer}`)),this._newStream=S,this._close=C,this._abort=A,this._getStreams=I,this.tags=[]}[Symbol.toStringTag]="Connection";[connectionSymbol]=!0;get streams(){return this._getStreams()}async newStream(r,_){if(this.status==="closing")throw new CodeError$4("the connection is being closed","ERR_CONNECTION_BEING_CLOSED");if(this.status==="closed")throw new CodeError$4("the connection is closed","ERR_CONNECTION_CLOSED");if(Array.isArray(r)||(r=[r]),this.transient&&_?.runOnTransientConnection!==!0)throw new CodeError$4("Cannot open protocol stream on transient connection","ERR_TRANSIENT_CONNECTION");const E=await this._newStream(r,_);return E.direction="outbound",E}async close(r={}){if(!(this.status==="closed"||this.status==="closing")){if(this.log("closing connection to %a",this.remoteAddr),this.status="closing",r.signal==null){const _=AbortSignal.timeout(CLOSE_TIMEOUT);setMaxListeners$2(1/0,_),r={...r,signal:_}}try{this.log.trace("closing all streams"),await Promise.all(this.streams.map(async _=>_.close(r))),this.log.trace("closing underlying transport"),await this._close(r),this.log.trace("updating timeline with close time"),this.status="closed",this.timeline.close=Date.now()}catch(_){this.log.error("error encountered during graceful close of connection to %a",this.remoteAddr,_),this.abort(_)}}}abort(r){this.log.error("aborting connection to %a due to error",this.remoteAddr,r),this.status="closing",this.streams.forEach(_=>{_.abort(r)}),this.log.error("all streams aborted",this.streams.length),this._abort(r),this.timeline.close=Date.now(),this.status="closed"}}function createConnection(n){return new ConnectionImpl(n)}const DEFAULT_PROTOCOL_SELECT_TIMEOUT=3e4;function findIncomingStreamLimit(n,r){try{const{options:_}=r.getHandler(n);return _.maxInboundStreams}catch(_){if(_.code!==codes.ERR_NO_HANDLER_FOR_PROTOCOL)throw _}return DEFAULT_MAX_INBOUND_STREAMS}function findOutgoingStreamLimit(n,r,_={}){try{const{options:E}=r.getHandler(n);if(E.maxOutboundStreams!=null)return E.maxOutboundStreams}catch(E){if(E.code!==codes.ERR_NO_HANDLER_FOR_PROTOCOL)throw E}return _.maxOutboundStreams??DEFAULT_MAX_OUTBOUND_STREAMS}function countStreams(n,r,_){let E=0;return _.streams.forEach(S=>{S.direction===r&&S.protocol===n&&E++}),E}class DefaultUpgrader{components;connectionEncryption;muxers;inboundUpgradeTimeout;events;constructor(r,_){this.components=r,this.connectionEncryption=new Map,_.connectionEncryption.forEach(E=>{this.connectionEncryption.set(E.protocol,E)}),this.muxers=new Map,_.muxers.forEach(E=>{this.muxers.set(E.protocol,E)}),this.inboundUpgradeTimeout=_.inboundUpgradeTimeout??INBOUND_UPGRADE_TIMEOUT,this.events=r.events}async shouldBlockConnection(r,_,E){const S=this.components.connectionGater[E];if(S!==void 0&&await S(r,_))throw new CodeError$4(`The multiaddr connection is blocked by gater.${E}`,codes.ERR_CONNECTION_INTERCEPTED)}async upgradeInbound(r,_){if(!await this.components.connectionManager.acceptIncomingConnection(r))throw new CodeError$4("connection denied",codes.ERR_CONNECTION_DENIED);let S,C,A,I,B;const O=AbortSignal.timeout(this.inboundUpgradeTimeout),N=()=>{r.abort(new CodeError$4("inbound upgrade timeout",ERR_TIMEOUT))};O.addEventListener("abort",N,{once:!0}),setMaxListeners$2(1/0,O);try{if(await this.components.connectionGater.denyInboundConnection?.(r)===!0)throw new CodeError$4("The multiaddr connection is blocked by gater.acceptConnection",codes.ERR_CONNECTION_INTERCEPTED);this.components.metrics?.trackMultiaddrConnection(r),r.log("starting the inbound connection upgrade");let U=r;if(_?.skipProtection!==!0){const j=this.components.connectionProtector;j!=null&&(r.log("protecting the inbound connection"),U=await j.protect(r))}try{if(S=U,_?.skipEncryption!==!0){({conn:S,remotePeer:C,protocol:B}=await this._encryptInbound(U));const j={...U,...S};await this.shouldBlockConnection(C,j,"denyInboundEncryptedConnection")}else{const j=r.remoteAddr.getPeerId();if(j==null)throw new CodeError$4("inbound connection that skipped encryption must have a peer id",codes.ERR_INVALID_MULTIADDR);const z=peerIdFromString$1(j);B="native",C=z}if(A=S,_?.muxerFactory!=null)I=_.muxerFactory;else if(this.muxers.size>0){const j=await this._multiplexInbound({...U,...S},this.muxers);I=j.muxerFactory,A=j.stream}}catch(j){throw r.log.error("failed to upgrade inbound connection",j),j}return await this.shouldBlockConnection(C,r,"denyInboundUpgradedConnection"),r.log("successfully upgraded inbound connection"),this._createConnection({cryptoProtocol:B,direction:"inbound",maConn:r,upgradedConn:A,muxerFactory:I,remotePeer:C,transient:_?.transient})}finally{O.removeEventListener("abort",N),this.components.connectionManager.afterUpgradeInbound()}}async upgradeOutbound(r,_){const E=r.remoteAddr.getPeerId();let S;E!=null&&(S=peerIdFromString$1(E),await this.shouldBlockConnection(S,r,"denyOutboundConnection"));let C,A,I,B,O;this.components.metrics?.trackMultiaddrConnection(r),r.log("starting the outbound connection upgrade");let N=r;if(_?.skipProtection!==!0){const U=this.components.connectionProtector;U!=null&&(N=await U.protect(r))}try{if(C=N,_?.skipEncryption!==!0){({conn:C,remotePeer:A,protocol:B}=await this._encryptOutbound(N,S));const U={...N,...C};await this.shouldBlockConnection(A,U,"denyOutboundEncryptedConnection")}else{if(S==null)throw new CodeError$4("Encryption was skipped but no peer id was passed",codes.ERR_INVALID_PEER);B="native",A=S}if(I=C,_?.muxerFactory!=null)O=_.muxerFactory;else if(this.muxers.size>0){const U=await this._multiplexOutbound({...N,...C},this.muxers);O=U.muxerFactory,I=U.stream}}catch(U){throw r.log.error("failed to upgrade outbound connection",U),await r.close(U),U}return await this.shouldBlockConnection(A,r,"denyOutboundUpgradedConnection"),r.log("successfully upgraded outbound connection"),this._createConnection({cryptoProtocol:B,direction:"outbound",maConn:r,upgradedConn:I,muxerFactory:O,remotePeer:A,transient:_?.transient})}_createConnection(r){const{cryptoProtocol:_,direction:E,maConn:S,upgradedConn:C,remotePeer:A,muxerFactory:I,transient:B}=r;let O,N,U;I!=null&&(O=I.createStreamMuxer({direction:E,onIncomingStream:Z=>{U!=null&&Promise.resolve().then(async()=>{const X=this.components.registrar.getProtocols(),{stream:Q,protocol:se}=await handle(Z,X,{log:Z.log,yieldBytes:!1});if(U==null)return;U.log("incoming stream opened on %s",se);const oe=findIncomingStreamLimit(se,this.components.registrar);if(countStreams(se,"inbound",U)===oe){const we=new CodeError$4(`Too many inbound protocol streams for protocol "${se}" - limit ${oe}`,codes.ERR_TOO_MANY_INBOUND_PROTOCOL_STREAMS);throw Z.abort(we),we}Z.source=Q.source,Z.sink=Q.sink,Z.protocol=se,Q.closeWrite!=null&&(Z.closeWrite=Q.closeWrite),Q.closeRead!=null&&(Z.closeRead=Q.closeRead),Q.close!=null&&(Z.close=Q.close),await this.components.peerStore.merge(A,{protocols:[se]}),this.components.metrics?.trackProtocolStream(Z,U),this._onStream({connection:U,stream:Z,protocol:se})}).catch(async X=>{U.log.error("error handling incoming stream id %s",Z.id,X.message,X.code,X.stack),Z.timeline.close==null&&await Z.close()})}}),N=async(Z,X={})=>{if(O==null)throw new CodeError$4("Stream is not multiplexed",codes.ERR_MUXER_UNAVAILABLE);U.log("starting new stream for protocols %s",Z);const Q=await O.newStream();U.log.trace("started new stream %s for protocols %s",Q.id,Z);try{if(X.signal==null){Q.log("no abort signal was passed while trying to negotiate protocols %s falling back to default timeout",Z);const Te=AbortSignal.timeout(DEFAULT_PROTOCOL_SELECT_TIMEOUT);setMaxListeners$2(1/0,Te),X={...X,signal:Te}}Q.log.trace("selecting protocol from protocols %s",Z);const{stream:se,protocol:oe}=await select(Q,Z,{...X,log:Q.log,yieldBytes:!0});Q.log("selected protocol %s",oe);const ue=findOutgoingStreamLimit(oe,this.components.registrar,X);if(countStreams(oe,"outbound",U)>=ue){const Te=new CodeError$4(`Too many outbound protocol streams for protocol "${oe}" - limit ${ue}`,codes.ERR_TOO_MANY_OUTBOUND_PROTOCOL_STREAMS);throw Q.abort(Te),Te}return await this.components.peerStore.merge(A,{protocols:[oe]}),Q.source=se.source,Q.sink=se.sink,Q.protocol=oe,se.closeWrite!=null&&(Q.closeWrite=se.closeWrite),se.closeRead!=null&&(Q.closeRead=se.closeRead),se.close!=null&&(Q.close=se.close),this.components.metrics?.trackProtocolStream(Q,U),Q}catch(se){throw U.log.error("could not create new stream for protocols %s",Z,se),Q.timeline.close==null&&Q.abort(se),se.code!=null?se:new CodeError$4(String(se),codes.ERR_UNSUPPORTED_PROTOCOL)}},Promise.all([O.sink(C.source),C.sink(O.source)]).catch(Z=>{U.log.error("error piping data through muxer",Z)}));const j=S.timeline;S.timeline=new Proxy(j,{set:(...Z)=>(U!=null&&Z[1]==="close"&&Z[2]!=null&&j.close==null&&(async()=>{try{U.status==="open"&&await U.close()}catch(X){U.log.error("error closing connection after timeline close",X)}finally{this.events.safeDispatchEvent("connection:close",{detail:U})}})().catch(X=>{U.log.error("error thrown while dispatching connection:close event",X)}),Reflect.set(...Z))}),S.timeline.upgraded=Date.now();const z=()=>{throw new CodeError$4("connection is not multiplexed",codes.ERR_CONNECTION_NOT_MULTIPLEXED)};return U=createConnection({remoteAddr:S.remoteAddr,remotePeer:A,status:"open",direction:E,timeline:S.timeline,multiplexer:O?.protocol,encryption:_,transient:B,logger:this.components.logger,newStream:N??z,getStreams:()=>O!=null?O.streams:[],close:async Z=>{O!=null&&(U.log.trace("close muxer"),await O.close(Z)),U.log.trace("close maconn"),await S.close(Z),U.log.trace("closed maconn")},abort:Z=>{S.abort(Z),O?.abort(Z)}}),this.events.safeDispatchEvent("connection:open",{detail:U}),U}_onStream(r){const{connection:_,stream:E,protocol:S}=r,{handler:C,options:A}=this.components.registrar.getHandler(S);if(_.transient&&A.runOnTransientConnection!==!0)throw new CodeError$4("Cannot open protocol stream on transient connection","ERR_TRANSIENT_CONNECTION");C({connection:_,stream:E})}async _encryptInbound(r){const _=Array.from(this.connectionEncryption.keys());r.log("handling inbound crypto protocol selection",_);try{const{stream:E,protocol:S}=await handle(r,_,{log:r.log}),C=this.connectionEncryption.get(S);if(C==null)throw new Error(`no crypto module found for ${S}`);return r.log("encrypting inbound connection using",S),{...await C.secureInbound(this.components.peerId,E),protocol:S}}catch(E){throw r.log.error("encrypting inbound connection to %p failed",E),new CodeError$4(E.message,codes.ERR_ENCRYPTION_FAILED)}}async _encryptOutbound(r,_){const E=Array.from(this.connectionEncryption.keys());r.log("selecting outbound crypto protocol",E);try{r.log.trace("selecting encrypter from %s",E);const{stream:S,protocol:C}=await select(r,E,{log:r.log,yieldBytes:!0}),A=this.connectionEncryption.get(C);if(A==null)throw new Error(`no crypto module found for ${C}`);return r.log("encrypting outbound connection to %p using %s",_,A),{...await A.secureOutbound(this.components.peerId,S,_),protocol:C}}catch(S){throw r.log.error("encrypting outbound connection to %p failed",S),new CodeError$4(S.message,codes.ERR_ENCRYPTION_FAILED)}}async _multiplexOutbound(r,_){const E=Array.from(_.keys());r.log("outbound selecting muxer %s",E);try{r.log.trace("selecting stream muxer from %s",E);const{stream:S,protocol:C}=await select(r,E,{log:r.log,yieldBytes:!0});r.log("selected %s as muxer protocol",C);const A=_.get(C);return{stream:S,muxerFactory:A}}catch(S){throw r.log.error("error multiplexing outbound connection",S),new CodeError$4(String(S),codes.ERR_MUXER_UNAVAILABLE)}}async _multiplexInbound(r,_){const E=Array.from(_.keys());r.log("inbound handling muxers %s",E);try{const{stream:S,protocol:C}=await handle(r,E,{log:r.log}),A=_.get(C);return{stream:S,muxerFactory:A}}catch(S){throw r.log.error("error multiplexing inbound connection",S),new CodeError$4(String(S),codes.ERR_MUXER_UNAVAILABLE)}}}class Libp2pNode extends TypedEventEmitter{peerId;peerStore;contentRouting;peerRouting;metrics;services;logger;status;components;log;constructor(r){super(),this.status="stopped";const _=new TypedEventEmitter,E=_.dispatchEvent.bind(_);_.dispatchEvent=I=>{const B=E(I),O=this.dispatchEvent(new CustomEvent$1(I.type,{detail:I.detail}));return B||O},setMaxListeners$2(1/0,_),this.peerId=r.peerId,this.logger=r.logger??defaultLogger(),this.log=this.logger.forComponent("libp2p"),this.services={};const S=this.components=defaultComponents({peerId:r.peerId,privateKey:r.privateKey,nodeInfo:r.nodeInfo??{name:name$1,version:version$1},logger:this.logger,events:_,datastore:r.datastore??new MemoryDatastore,connectionGater:connectionGater(r.connectionGater),dns:r.dns});this.peerStore=this.configureComponent("peerStore",new PersistentPeerStore(S,{addressFilter:this.components.connectionGater.filterMultiaddrForPeer,...r.peerStore})),r.metrics!=null&&(this.metrics=this.configureComponent("metrics",r.metrics(this.components))),S.events.addEventListener("peer:update",I=>{if(I.detail.previous==null){const B={id:I.detail.peer.id,multiaddrs:I.detail.peer.addresses.map(O=>O.multiaddr)};S.events.safeDispatchEvent("peer:discovery",{detail:B})}}),r.connectionProtector!=null&&this.configureComponent("connectionProtector",r.connectionProtector(S)),this.components.upgrader=new DefaultUpgrader(this.components,{connectionEncryption:(r.connectionEncryption??[]).map((I,B)=>this.configureComponent(`connection-encryption-${B}`,I(this.components))),muxers:(r.streamMuxers??[]).map((I,B)=>this.configureComponent(`stream-muxers-${B}`,I(this.components))),inboundUpgradeTimeout:r.connectionManager.inboundUpgradeTimeout}),this.configureComponent("transportManager",new DefaultTransportManager(this.components,r.transportManager)),this.configureComponent("connectionManager",new DefaultConnectionManager(this.components,r.connectionManager)),this.configureComponent("registrar",new DefaultRegistrar(this.components)),this.configureComponent("addressManager",new DefaultAddressManager(this.components,r.addresses));const C=(r.peerRouters??[]).map((I,B)=>this.configureComponent(`peer-router-${B}`,I(this.components)));this.peerRouting=this.components.peerRouting=this.configureComponent("peerRouting",new DefaultPeerRouting(this.components,{routers:C}));const A=(r.contentRouters??[]).map((I,B)=>this.configureComponent(`content-router-${B}`,I(this.components)));if(this.contentRouting=this.components.contentRouting=this.configureComponent("contentRouting",new CompoundContentRouting(this.components,{routers:A})),(r.peerDiscovery??[]).forEach((I,B)=>{this.configureComponent(`peer-discovery-${B}`,I(this.components)).addEventListener("peer",N=>{this.#e(N)})}),r.transports?.forEach((I,B)=>{this.components.transportManager.add(this.configureComponent(`transport-${B}`,I(this.components)))}),r.services!=null)for(const I of Object.keys(r.services)){const B=r.services[I],O=B(this.components);if(O==null){this.log.error("service factory %s returned null or undefined instance",I);continue}this.services[I]=O,this.configureComponent(I,O),O[contentRoutingSymbol]!=null&&(this.log("registering service %s for content routing",I),A.push(O[contentRoutingSymbol])),O[peerRoutingSymbol]!=null&&(this.log("registering service %s for peer routing",I),C.push(O[peerRoutingSymbol])),O[peerDiscoverySymbol]!=null&&(this.log("registering service %s for peer discovery",I),O[peerDiscoverySymbol].addEventListener?.("peer",N=>{this.#e(N)}))}}configureComponent(r,_){return _==null&&this.log.error("component %s was null or undefined",r),this.components[r]=_,_}async start(){if(this.status==="stopped"){this.status="starting",this.log("libp2p is starting");try{await this.components.beforeStart?.(),await this.components.start(),await this.components.afterStart?.(),this.status="started",this.safeDispatchEvent("start",{detail:this}),this.log("libp2p has started")}catch(r){throw this.log.error("An error occurred starting libp2p",r),this.status="started",await this.stop(),r}}}async stop(){this.status==="started"&&(this.log("libp2p is stopping"),this.status="stopping",await this.components.beforeStop?.(),await this.components.stop(),await this.components.afterStop?.(),this.status="stopped",this.safeDispatchEvent("stop",{detail:this}),this.log("libp2p has stopped"))}getConnections(r){return this.components.connectionManager.getConnections(r)}getDialQueue(){return this.components.connectionManager.getDialQueue()}getPeers(){const r=new PeerSet;for(const _ of this.components.connectionManager.getConnections())r.add(_.remotePeer);return Array.from(r)}async dial(r,_={}){return this.components.connectionManager.openConnection(r,{priority:75,..._})}async dialProtocol(r,_,E={}){if(_==null)throw new CodeError$4("no protocols were provided to open a stream",codes.ERR_INVALID_PROTOCOLS_FOR_STREAM);if(_=Array.isArray(_)?_:[_],_.length===0)throw new CodeError$4("no protocols were provided to open a stream",codes.ERR_INVALID_PROTOCOLS_FOR_STREAM);return(await this.dial(r,E)).newStream(_,E)}getMultiaddrs(){return this.components.addressManager.getAddresses()}getProtocols(){return this.components.registrar.getProtocols()}async hangUp(r,_={}){isMultiaddr(r)&&(r=peerIdFromString$1(r.getPeerId()??"")),await this.components.connectionManager.closeConnections(r,_)}async getPublicKey(r,_={}){if(this.log("getPublicKey %p",r),r.publicKey!=null)return r.publicKey;try{const C=await this.peerStore.get(r);if(C.id.publicKey!=null)return C.id.publicKey}catch(C){if(C.code!==codes.ERR_NOT_FOUND)throw C}const E=concat$4([fromString$3("/pk/"),r.multihash.digest]),S=await this.contentRouting.get(E,_);return unmarshalPublicKey$1(S),await this.peerStore.patch(r,{publicKey:S}),S}async handle(r,_,E){Array.isArray(r)||(r=[r]),await Promise.all(r.map(async S=>{await this.components.registrar.handle(S,_,E)}))}async unhandle(r){Array.isArray(r)||(r=[r]),await Promise.all(r.map(async _=>{await this.components.registrar.unhandle(_)}))}async register(r,_){return this.components.registrar.register(r,_)}unregister(r){this.components.registrar.unregister(r)}#e(r){const{detail:_}=r;if(_.id.toString()===this.peerId.toString()){this.log.error(new Error(codes.ERR_DISCOVERED_SELF));return}this.components.peerStore.merge(_.id,{multiaddrs:_.multiaddrs}).catch(E=>{this.log.error(E)})}}async function createLibp2pNode(n={}){const r=n.peerId??=await createEd25519PeerId();if(r.privateKey==null)throw new CodeError$4("peer id was missing private key","ERR_MISSING_PRIVATE_KEY");return n.privateKey??=await unmarshalPrivateKey$1(r.privateKey),new Libp2pNode(await validateConfig(n))}async function createLibp2p$1(n={}){const r=await createLibp2pNode(n);return n.start!==!1&&await r.start(),r}async function createLibp2p(n){let r=n.libp2p?.peerId;const _=n.logger??defaultLogger();if(r==null){const S=keychain(n.keychain)({datastore:n.datastore,logger:_}),C=new Key("/pkcs8/self");await n.datastore.has(C)&&(r=await S.exportPeerId("self"))}const E=libp2pDefaults(n);return n=n??{},createLibp2p$1({...E,...n.libp2p,start:!1})}async function createHelia(n={}){const r=n.datastore??new MemoryDatastore,_=n.blockstore??new MemoryBlockstore;let E;isLibp2p(n.libp2p)?E=n.libp2p:E=await createLibp2p({...n,libp2p:n.libp2p,datastore:r});const S=new HeliaImpl({...n,libp2p:E,datastore:r,blockstore:_});return n.start!==!1&&await S.start(),S}function isLibp2p(n){return n==null?!1:["dial","dialProtocol","hangUp","handle","unhandle","getMultiaddrs","getProtocols"].every(_=>typeof n[_]=="function")}class LevelBlockstore extends BaseBlockstore{db;opts;base;constructor(r,_={}){super(),this.db=typeof r=="string"?new Level(r,{..._,keyEncoding:"utf8",valueEncoding:"view"}):r,this.opts={createIfMissing:!0,compression:!1,..._},this.base=_.base??base32upper}#e(r){return`/${this.base.encoder.encode(r.multihash.bytes)}`}#t(r){return CID.createV1(code$6,decode$h(this.base.decoder.decode(r.substring(1))))}async open(){try{await this.db.open(this.opts)}catch(r){throw Errors.openFailedError(r)}}async put(r,_){try{return await this.db.put(this.#e(r),_),r}catch(E){throw Errors.putFailedError(E)}}async get(r){let _;try{_=await this.db.get(this.#e(r))}catch(E){throw E.notFound!=null?Errors.notFoundError(E):Errors.getFailedError(E)}return _}async has(r){try{await this.db.get(this.#e(r))}catch(_){if(_.notFound!=null)return!1;throw _}return!0}async delete(r){try{await this.db.del(this.#e(r))}catch(_){throw Errors.deleteFailedError(_)}}async close(){await this.db.close()}async*getAll(r){for await(const{key:_,value:E}of this.#r({values:!0}))yield{cid:this.#t(_),block:E}}async*#r(r){const _={keys:!0,keyEncoding:"buffer",values:r.values};if(r.prefix!=null){const S=r.prefix.toString();_.gte=S,_.lt=S+""}const E=this.db.iterator(_);try{for await(const[S,C]of E)yield{key:new TextDecoder().decode(S),value:C}}finally{await E.close()}}}class BitswapBlockBroker{bitswap;started;constructor(r,_={}){const{libp2p:E,blockstore:S,hashers:C}=r;this.bitswap=createBitswap(E,S,{hashLoader:{getHasher:async A=>{let I;if(typeof A=="string"?I=Object.values(C).find(B=>B.name===A):I=C[A],I!=null)return I;throw new Error(`Could not load hasher for code/name "${A}"`)}},..._}),this.started=!1}isStarted(){return this.started}async start(){await this.bitswap.start(),this.started=!0}async stop(){await this.bitswap.stop(),this.started=!1}announce(r,_,E){this.bitswap.notify(r,_,E)}async retrieve(r,{validateFn:_,...E}={}){return this.bitswap.want(r,E)}}function bitswap(n={}){return r=>new BitswapBlockBroker(r,n)}var Peer;(function(n){let r;n.codec=()=>(r==null&&(r=message((_,E,S={})=>{if(S.lengthDelimited!==!1&&E.fork(),_.publicKey!=null&&_.publicKey.byteLength>0&&(E.uint32(10),E.bytes(_.publicKey)),_.addrs!=null)for(const C of _.addrs)E.uint32(18),E.bytes(C);S.lengthDelimited!==!1&&E.ldelim()},(_,E)=>{const S={publicKey:alloc$3(0),addrs:[]},C=E==null?_.len:_.pos+E;for(;_.pos<C;){const A=_.uint32();switch(A>>>3){case 1:{S.publicKey=_.bytes();break}case 2:{S.addrs.push(_.bytes());break}default:{_.skipType(A&7);break}}}return S})),r),n.encode=_=>encodeMessage(_,n.codec()),n.decode=_=>decodeMessage$1(_,n.codec())})(Peer||(Peer={}));const TOPIC="_peer-discovery._p2p._pubsub";class PubSubPeerDiscovery extends TypedEventEmitter{[peerDiscoverySymbol]=!0;[Symbol.toStringTag]="@libp2p/pubsub-peer-discovery";interval;listenOnly;topics;intervalId;components;log;constructor(r,_={}){super();const{interval:E,topics:S,listenOnly:C}=_;this.components=r,this.interval=E??1e4,this.listenOnly=C??!1,this.log=r.logger.forComponent("libp2p:discovery:pubsub"),Array.isArray(S)&&S.length>0?this.topics=S:this.topics=[TOPIC],this._onMessage=this._onMessage.bind(this)}isStarted(){return this.intervalId!=null}start(){}afterStart(){if(this.intervalId!=null)return;const r=this.components.pubsub;if(r==null)throw new Error("PubSub not configured");for(const _ of this.topics)r.subscribe(_),r.addEventListener("message",this._onMessage);this.listenOnly||(this._broadcast(),this.intervalId=setInterval(()=>{this._broadcast()},this.interval))}beforeStop(){const r=this.components.pubsub;if(r==null)throw new Error("PubSub not configured");for(const _ of this.topics)r.unsubscribe(_),r.removeEventListener("message",this._onMessage)}stop(){this.intervalId!=null&&(clearInterval(this.intervalId),this.intervalId=void 0)}_broadcast(){const r=this.components.peerId;if(r.publicKey==null)throw new Error("PeerId was missing public key");const _={publicKey:r.publicKey,addrs:this.components.addressManager.getAddresses().map(C=>C.bytes)},E=Peer.encode(_),S=this.components.pubsub;if(S==null)throw new Error("PubSub not configured");for(const C of this.topics){if(S.getSubscribers(C).length===0){this.log("skipping broadcasting our peer data on topic %s because there are no peers present",C);continue}this.log("broadcasting our peer data on topic %s",C),S.publish(C,E)}}_onMessage(r){if(!this.isStarted())return;const _=r.detail;if(!this.topics.includes(_.topic))return;const E=Peer.decode(_.data);peerIdFromKeys$1(E.publicKey).then(S=>{S.equals(this.components.peerId)||(this.log("discovered peer %p on %s",S,_.topic),this.safeDispatchEvent("peer",{detail:{id:S,multiaddrs:E.addrs.map(C=>multiaddr(C))}}))}).catch(S=>{this.log.error(S)})}}function pubsubPeerDiscovery(n={}){return r=>new PubSubPeerDiscovery(r,n)}const ADRESSES_NUDS_RELAI=["/ip4/164.90.222.145/udp/9090/webrtc-direct/certhash/uEiAJOkKT64u6jmXV5YxncCoER5WXSO2HYE23Xpap651xMw/p2p/12D3KooWJ7P1yeoxB5mq3TwQh8YgmVhankjtT4rsVGZPUyf617aR","/ip4/164.90.222.145/udp/9091/quic-v1/p2p/12D3KooWJ7P1yeoxB5mq3TwQh8YgmVhankjtT4rsVGZPUyf617aR","/ip4/164.90.222.145/tcp/9092/p2p/12D3KooWJ7P1yeoxB5mq3TwQh8YgmVhankjtT4rsVGZPUyf617aR"],obtOptionsLibp2pNode=async()=>{const{tcp:n}=await __vitePreload(()=>import("./index-BljJQh6Q.js"),__vite__mapDeps([2,3])),{mdns:r}=await __vitePreload(()=>import("./index-CqGV8aGV.js"),__vite__mapDeps([4,3]));return{addresses:{listen:["/ip4/0.0.0.0/tcp/0/ws","/webrtc","/webtransport","/webrtc-direct"]},transports:[webSockets({filter:all}),webRTC({rtcConfiguration:{iceServers:[{urls:["stun:stun.l.google.com:19302","stun:global.stun.twilio.com:3478"]}]}}),webTransport(),webRTCDirect(),n(),circuitRelayTransport({discoverRelays:1})],connectionEncryption:[noise()],streamMuxers:[yamux()],connectionGater:{denyDialMultiaddr:()=>!1},peerDiscovery:[r(),bootstrap({list:ADRESSES_NUDS_RELAI,timeout:0}),pubsubPeerDiscovery({interval:1e3,topics:["constellation._peer-discovery._p2p._pubsub"],listenOnly:!1})],services:{identify:identify(),autoNAT:autoNAT(),dcutr:dcutr(),pubsub:gossipsub({allowPublishToZeroPeers:!0}),dht:kadDHT({clientMode:!1})}}},obtOptionsLibp2plectionPrincipal=async()=>{const{tcp:n}=await __vitePreload(()=>import("./index-BljJQh6Q.js"),__vite__mapDeps([2,3])),{mdns:r}=await __vitePreload(()=>import("./index-CqGV8aGV.js"),__vite__mapDeps([4,3]));return{addresses:{listen:["/ip4/0.0.0.0/tcp/0/ws","/webrtc","/webtransport"]},transports:[webSockets({filter:all}),webRTC({rtcConfiguration:{iceServers:[{urls:["stun:stun.l.google.com:19302","stun:global.stun.twilio.com:3478"]}]}}),webTransport(),webRTCDirect(),n(),circuitRelayTransport({discoverRelays:1})],connectionEncryption:[noise()],streamMuxers:[yamux()],connectionGater:{denyDialMultiaddr:()=>!1},peerDiscovery:[r(),bootstrap({list:ADRESSES_NUDS_RELAI,timeout:0}),pubsubPeerDiscovery({interval:1e3,topics:["constellation._peer-discovery._p2p._pubsub"],listenOnly:!1})],services:{identify:identify(),autoNAT:autoNAT(),dcutr:dcutr(),pubsub:gossipsub({allowPublishToZeroPeers:!0}),dht:kadDHT({clientMode:!1})}}},obtOptionsLibp2pNavigateur=async()=>({addresses:{listen:["/webrtc","/webtransport"]},transports:[webSockets({filter:all}),webRTC({rtcConfiguration:{iceServers:[{urls:["stun:stun.l.google.com:19302","stun:global.stun.twilio.com:3478"]}]}}),webRTCDirect(),webTransport(),circuitRelayTransport({discoverRelays:1})],connectionEncryption:[noise()],streamMuxers:[yamux()],connectionGater:{denyDialMultiaddr:()=>!1},peerDiscovery:[bootstrap({list:ADRESSES_NUDS_RELAI,timeout:0}),pubsubPeerDiscovery({interval:1e3,topics:["constellation._peer-discovery._p2p._pubsub"],listenOnly:!1})],services:{identify:identify(),autoNAT:autoNAT(),dcutr:dcutr(),pubsub:gossipsub({allowPublishToZeroPeers:!0}),dht:kadDHT({clientMode:!0})}}),obtOptionsLibp2pTravailleurWeb=async()=>({addresses:{listen:["/webrtc"]},transports:[webSockets({filter:all}),webTransport(),circuitRelayTransport({discoverRelays:1})],connectionEncryption:[noise()],streamMuxers:[yamux()],connectionGater:{denyDialMultiaddr:()=>!1},peerDiscovery:[bootstrap({list:ADRESSES_NUDS_RELAI,timeout:0})],services:{identify:identify(),pubsub:gossipsub({allowPublishToZeroPeers:!0})}}),obtConfigLibp2pPlateforme=async()=>{let n;return isBrowser||isElectronRenderer?n=await obtOptionsLibp2pNavigateur():isWebWorker?n=await obtOptionsLibp2pTravailleurWeb():isElectronMain?n=await obtOptionsLibp2plectionPrincipal():isNode?n=await obtOptionsLibp2pNode():(console.warn("Plateforme non reconnue. On utilisera la configuration navigateur."),n=await obtOptionsLibp2pNavigateur()),n};async function initSFIP({dossier:n,configLibp2p:r={}}){const _=await obtConfigLibp2pPlateforme(),E=await createLibp2p$1(mergeOptions$9(r,{..._})),C={blockstore:new LevelBlockstore(`${n}/blocks`),libp2p:E,blockBrokers:[bitswap()]};return createHelia({...C})}const index=Object.freeze(Object.defineProperty({__proto__:null,initSFIP},Symbol.toStringTag,{value:"Module"})),estOrbiteDB=n=>{if(!n)return!1;const r=n;return r.id&&typeof r.open=="function"&&typeof r.stop=="function"&&r.ipfs},schmaStructureBdCompte={type:"object",properties:{protocoles:{type:"string",nullable:!0},profil:{type:"string",nullable:!0},motsClefs:{type:"string",nullable:!0},variables:{type:"string",nullable:!0},bds:{type:"string",nullable:!0},projets:{type:"string",nullable:!0},nues:{type:"string",nullable:!0},favoris:{type:"string",nullable:!0},rseau:{type:"string",nullable:!0},automatisations:{type:"string",nullable:!0}},required:[]},schmaStructureNomsDispositifs={type:"object",additionalProperties:{type:"object",properties:{nom:{type:"string",nullable:!0},type:{type:"string",nullable:!0}}},required:[]},DLAI_EXPIRATION_INVITATIONS=1e3*60*5,obtDossierConstellation=async n=>{if(n.dossier&&n.dossier!=="dv")return n.dossier;if(isNode||isElectronMain){const r=(await __vitePreload(()=>import("env-paths"),__vite__mapDeps([]))).default,{join:_}=await __vitePreload(()=>Promise.resolve().then(()=>path$1),void 0),E=r("constl",{suffix:""});return _(E.data,n.dossier==="dv"?"constl-dv":"constl")}else return"./constl"};class ClientConstellation{_opts;vnements;orbite;sfip;pingles;profil;bds;tableaux;variables;rseau;favoris;projets;recherche;motsClefs;automatisations;nues;licences;protocoles;_orbiteExterne;_sfipExterne;idCompte;encryption;sujet_rseau;motsDePasseRejoindreCompte;ennikkai;verrouObtIdBd;constructor(r={}){this._opts=r,this.vnements=new eventsExports.EventEmitter,this.sujet_rseau=r.sujetRseau||"rseau-constellation",this.motsDePasseRejoindreCompte={},this.verrouObtIdBd=new s$1,this._orbiteExterne=this._sfipExterne=!1,this.encryption=new EncryptionLocalFirst,this.ennikkai=new ({}),this.pingles=new pingles({client:this}),this.profil=new Profil({client:this}),this.motsClefs=new MotsClefs({client:this}),this.tableaux=new Tableaux({client:this}),this.variables=new Variables({client:this}),this.bds=new BDs({client:this}),this.projets=new Projets({client:this}),this.nues=new Nues({client:this}),this.favoris=new Favoris({client:this}),this.automatisations=new Automatisations({client:this}),this.recherche=new Recherche({client:this}),this.licences=new Licences({client:this}),this.rseau=new Rseau({client:this}),this.protocoles=new Protocoles({client:this})}async dossier(){return await obtDossierConstellation(this._opts)}async _initialiser(){const{sfip:r,orbite:_}=await this._gnrerSFIPetOrbite();this.sfip=r,this.orbite=gestionnaireOrbiteGnral.obtGestionnaireOrbite({orbite:_}),this.vnements.emit("sfipEtOrbitePrts",{sfip:r,orbite:this.orbite});const E={type:nomType,write:this.orbite.identity.id,nom:"racine"};this.idCompte=await this.obtDeStockageLocal({clef:"idCompte",parCompte:!1})||void 0,this.idCompte||(this.idCompte=await this.crerBdIndpendante({type:"keyvalue",optionsAccs:E,nom:"racine"}),await this.nommerDispositif({type:this.dtecterTypeDispositif()}),await this.sauvegarderAuStockageLocal({clef:"idCompte",val:this.idCompte,parCompte:!1})),await this.rseau.initialiser(),await this.protocoles.tablirProtocoles({protocoles:this._opts.protocoles}),await this.pingler(),this.vnements.emit("comptePrt",{idCompte:this.idCompte})}dtecterTypeDispositif(){if(isElectronMain)return"ordinateur";if(isNode)return"serveur";if(isBrowser)return["Pad","Kindle","Nexus","Nook","PlayBook"].find(r=>plateforme.product?.includes(r))?"tablette":plateforme.name?.includes("Mobile")||["Phone","Android","iOS"].find(r=>plateforme.os?.family?.includes(r))?"tlphone":"navigateur"}async attendreSfipEtOrbite(){return this.sfip&&this.orbite?{sfip:this.sfip,orbite:this.orbite}:new Promise(r=>{this.vnements.once("sfipEtOrbitePrts",r)})}async attendreInitialise(){return this.idCompte?{idCompte:this.idCompte}:new Promise(r=>{this.vnements.once("comptePrt",r)})}async _gnrerSFIPetOrbite(){const{orbite:r}=this._opts;let _,E;if(r)if(estOrbiteDB(r))this._sfipExterne=this._orbiteExterne=!0,_=r.ipfs,E=r;else{const{initOrbite:S}=await __vitePreload(()=>Promise.resolve().then(()=>orbite),void 0);r.ipfs?(this._sfipExterne=!0,_=r.ipfs):_=await initSFIP({dossier:join(await this.dossier(),"sfip")}),E=await S({sfip:_,dossierOrbite:r.directory||join(await this.dossier(),"orbite")}),_=E.ipfs}else{const{initSFIP:S}=await __vitePreload(()=>Promise.resolve().then(()=>index),void 0);_=await S({dossier:join(await this.dossier(),"sfip")});const{initOrbite:C}=await __vitePreload(()=>Promise.resolve().then(()=>orbite),void 0);E=await C({sfip:_,dossierOrbite:join(await this.dossier(),"orbite")})}return{sfip:_,orbite:E}}async obtOptionsAccs(){return{write:await this.obtIdCompte()}}async pingler(){await this.pingles.pinglerBd({id:await this.obtIdCompte()}),await Promise.all([this.profil,this.automatisations,this.bds,this.variables,this.projets,this.nues,this.motsClefs,this.rseau,this.favoris].map(async r=>r&&await r.pingler()))}async ouvrirBd({id:r,type:_,options:E}){const{orbite:S}=await this.attendreSfipEtOrbite();return await S.ouvrirBd({id:r,type:_,options:E})}async ouvrirBdType({id:r,type:_,schma:E,options:S}){const{orbite:C}=await this.attendreSfipEtOrbite();return await C.ouvrirBdType({id:r,type:_,schma:E,options:S})}async signer({message:r}){const{orbite:_}=await this.attendreSfipEtOrbite(),E=_.identity,S=await _.identity.sign(E,r),C=_.identity.publicKey;return{signature:S,clefPublique:C}}async vrifierSignature({signature:r,message:_}){if(!r||!r.clefPublique||!r.signature)return!1;const{orbite:E}=await this.attendreSfipEtOrbite();return await E.identity.verify(r.signature,r.clefPublique,_)}async suivreDispositifs({f:r,idCompte:_}){const E=async({id:S})=>{const{orbite:C}=await this.attendreSfipEtOrbite(),{bd:A,fOublier:I}=await C.ouvrirBdType({id:S,type:"keyvalue",schma:schmaStructureBdCompte}),B=A.access,O=B.type;if(O==="ipfs")return await r(B.write),await I(),faisRien;if(O==="contrleur-constellation"){const N=B,U=async()=>{const j=N.gestRles._rles[MODRATEUR];await r(j)};return N.gestRles.on("misJour",U),U(),async()=>{N.gestRles.off("misJour",U),await I()}}else return await I(),faisRien};return await suivreBdDeFonction({fRacine:async({fSuivreRacine:S})=>_?(await S(_),faisRien):await this.suivreIdCompte({f:S}),f:ignorerNonDfinis(r),fSuivre:E})}async nommerDispositif({idDispositif:r,nom:_,type:E}){const S=r||await this.obtIdDispositif(),C=await this.obtIdBd({nom:"nomsDispositifs",racine:await this.obtIdCompte(),type:"keyvalue"}),{bd:A,fOublier:I}=await this.ouvrirBdType({id:C,type:"keyvalue",schma:schmaStructureNomsDispositifs});if(_||E){const B={};_&&(B.nom=_),E&&(B.type=E),await A.set(S,B)}else await A.del(S);await I()}async suivreNomsDispositifs({idCompte:r,f:_}){const E=r||await this.obtIdCompte();return await this.suivreBdDicDeClef({id:E,schma:schmaStructureNomsDispositifs,clef:"nomsDispositifs",f:_})}async suivreNomDispositif({idCompte:r,idDispositif:_,f:E}){return await this.suivreNomsDispositifs({idCompte:r,f:async S=>{const C=S[_];if(C)return await E(C)}})}async gnrerInvitationRejoindreCompte(){const r=await this.obtIdCompte(),_=await this.encryption.clefAlatoire();return this.motsDePasseRejoindreCompte[_]=Date.now(),{idCompte:r,codeSecret:_}}async rvoquerInvitationRejoindreCompte({codeSecret:r}){r?delete this.motsDePasseRejoindreCompte[r]:this.motsDePasseRejoindreCompte={}}async considrerRequteRejoindreCompte({requte:r}){const{idDispositif:_,empreinteVrification:E}=r,S=Date.now();for(const C of Object.keys(this.motsDePasseRejoindreCompte)){const A=this.motsDePasseRejoindreCompte[C];S-A<DLAI_EXPIRATION_INVITATIONS&&this.empreinteInvitation({idDispositif:_,codeSecret:C})===E&&(delete this.motsDePasseRejoindreCompte[C],await this.ajouterDispositif({idDispositif:_}))}}empreinteInvitation({idDispositif:r,codeSecret:_}){return Base64.stringify(sha256(r+_))}async demanderEtPuisRejoindreCompte({idCompte:r,codeSecret:_}){await this.rseau.envoyerDemandeRejoindreCompte({idCompte:r,codeSecret:_}),await this.rejoindreCompte({idCompte:r})}async ajouterDispositif({idDispositif:r}){const{idCompte:_}=await this.attendreInitialise(),{bd:E,fOublier:S}=await this.ouvrirBd({id:_});E.access.grant(MODRATEUR,r),await S()}async enleverDispositif({idDispositif:r}){const{idCompte:_}=await this.attendreInitialise(),{bd:E,fOublier:S}=await this.ouvrirBd({id:_});await E.access.revoke(MODRATEUR,r),await S()}async rejoindreCompte({idCompte:r}){if(!isValidAddress(r))throw new Error(`Adresse compte "${r}" non valide`);let _;const{bd:E,fOublier:S}=await this.ouvrirBdType({id:r,type:"keyvalue",schma:schmaStructureBdCompte}),C=E.access,A=await this.obtIdDispositif(),I=await C.suivreIdsOrbiteAutorisescriture(B=>_=B.includes(A));await new Promise(B=>{const O=async()=>{_&&(clearInterval(N),await I(),await S(),B())},N=setInterval(()=>{O()},10);O()}),this.idCompte=r,await this.sauvegarderAuStockageLocal({clef:"idCompte",val:r,parCompte:!1}),this.vnements.emit("comptePrt",{idCompte:r})}async donnerAccs({idBd:r,identit:_,rle:E=MEMBRE}){if(!isValidAddress(_))throw new Error(`Identit "${_}" non valide.`);const{bd:S,fOublier:C}=await this.ouvrirBd({id:r}),A=S.access;A.type===nomType&&A.grant(E,_),await C()}async suivreIdCompte({f:r}){const _=async({idCompte:E})=>{await r(E)};return this.vnements.on("comptePrt",_),this.idCompte&&await _({idCompte:this.idCompte}),async()=>{this.vnements.off("comptePrt",_)}}async obtIdSFIP(){const{sfip:r}=await this.attendreSfipEtOrbite();return r.libp2p.peerId}async obtIdDispositif(){const{orbite:r}=await this.attendreSfipEtOrbite();return r.identity.id}async obtIdentitOrbite(){const{orbite:r}=await this.attendreSfipEtOrbite();return r.identity}async obtIdCompte(){const{idCompte:r}=await this.attendreInitialise();return r}async copierContenuBdDic({bdBase:r,nouvelleBd:_,clef:E,schma:S}){const C=await r.get(E);if(typeof C!="string")return;const{bd:A,fOublier:I}=await this.ouvrirBdType({id:C,type:"keyvalue",schma:S}),B=await _.get(E);if(!B)throw new Error("La nouvelle BD n'existait pas.");if(typeof B!="string")throw new Error(`${B} n'est pas une adresse Orbite.`);const{bd:O,fOublier:N}=await this.ouvrirBdType({id:B,type:"keyvalue",schma:S}),U=await A.all();await Promise.all(U.map(async j=>{await O.put(j.key,j.value)})),I(),N()}async combinerBds({idBdBase:r,idBd2:_}){const{bd:E,fOublier:S}=await this.ouvrirBd({id:r}),C=E.type;switch(await S(),C){case"keyvalue":{const{bd:A,fOublier:I}=await this.ouvrirBd({id:r,type:"keyvalue"}),{bd:B,fOublier:O}=await this.ouvrirBd({id:_,type:"keyvalue"});await this.combinerBdsDict({bdBase:A,bd2:B}),await I(),await O();break}case"set":{const{bd:A,fOublier:I}=await this.ouvrirBd({id:r,type:"set"}),{bd:B,fOublier:O}=await this.ouvrirBd({id:_,type:"set"});await this.combinerBdsEnsemble({bdBase:A,bd2:B}),await I(),await O();break}default:throw new Error(`Type de BD ${C} non support.`)}}async combinerBdsDict({bdBase:r,bd2:_}){const E=Object.fromEntries((await _.all()).map(S=>[S.key,S.value]));for(const[S,C]of Object.entries(E)){const A=await r.get(S);A!==C&&(A===void 0?await r.put(S,C):isValidAddress(A)&&isValidAddress(C)&&await this.combinerBds({idBdBase:A,idBd2:C}))}}async combinerBdsEnsemble({bdBase:r,bd2:_,index:E}){const S=await r.all(),C=await _.all();for(const A of C){const I=A.value;if(E){if(typeof I!="object")throw new Error(`Erreur combinaison ensembles : ${typeof I}`);const B=S.find(O=>typeof O.value=="object"&&E.every(N=>O.value[N]===I[N]));if(!B)await r.add(I);else{const O=B.value;if(!deepEqual$1(O,I)){const N=Object.assign({},O);for(const[U,j]of Object.entries(I))N[U]===void 0?N[U]=j:deepEqual$1(N[U],j)||isValidAddress(N[U])&&isValidAddress(j)&&await this.combinerBds({idBdBase:N[U],idBd2:j});await r.del(B.value),await r.add(N)}}}else S.some(B=>deepEqual$1(B.value,I))||await r.add(I)}}async suivreBd({id:r,f:_,type:E,schma:S}){if(!isValidAddress(r))throw new Error(`Adresse "${r}" non valide.`);const C=[],A={};let I=!1;const B=()=>{(S?E==="set"?this.ouvrirBdType({id:r,type:E,schma:S}):E==="keyvalue"?this.ouvrirBdType({id:r,type:E,schma:S}):E==="ordered-keyvalue"?this.ouvrirBdType({id:r,type:E,schma:S}):this.ouvrirBd({id:r,type:E}):this.ouvrirBd({id:r})).then(({bd:U,fOublier:j})=>{C.push(j);const z=()=>{const Z=v4(),X=_(U);(se=>!!se&&!!se.then)(X)&&(A[Z]=X,X.then(()=>{delete A[Z]}))};U.events.on("update",z),C.push(async()=>{U.events.off("update",z)}),z()}).catch(U=>{if(!I)if(String(U).includes("ipfs unable to find")||String(U).includes("aborted"))B();else throw console.error(U),new Error(U)})};return B(),async()=>{I=!0,await Promise.all(C.map(N=>N())),await Promise.all(Object.values(A))}}async suivreBdDeClef({id:r,clef:_,f:E,fSuivre:S}){return await suivreBdDeFonction({fRacine:async({fSuivreRacine:A})=>{const I=async B=>{const O=await B.get(_);return await A(O)};return await this.suivreBd({id:r,f:I,type:"keyvalue"})},f:E,fSuivre:S})}async suivreBdDic({id:r,schma:_,f:E}){const S=async C=>{const A=C?Object.fromEntries((await C.all()).map(I=>[I.key,I.value])):{};await E(A)};return await this.suivreBd({id:r,type:"keyvalue",schma:_,f:S})}async suivreBdDicOrdonne({id:r,schma:_,f:E}){const S=async C=>{const A=await C.all();await E(A)};return await this.suivreBd({id:r,type:"ordered-keyvalue",schma:_,f:S})}async suivreBdDicDeClef({id:r,clef:_,schma:E,f:S}){const C=async I=>{await S(I||{})},A=async({id:I,fSuivreBd:B})=>await this.suivreBdDic({id:I,schma:E,f:B});return await this.suivreBdDeClef({id:r,clef:_,f:C,fSuivre:A})}async suivreBdDicOrdonneDeClef({id:r,clef:_,schma:E,f:S}){const C=async I=>{await S(I||[])},A=async({id:I,fSuivreBd:B})=>await this.suivreBdDicOrdonne({id:I,schma:E,f:B});return await this.suivreBdDeClef({id:r,clef:_,f:C,fSuivre:A})}async suivreBdListeDeClef({id:r,clef:_,f:E,schma:S,renvoyerValeur:C=!0}){if(C){const A=async B=>{await E(B||[])},I=async({id:B,fSuivreBd:O})=>await this.suivreBdListe({id:B,f:O,schma:S,renvoyerValeur:C});return await this.suivreBdDeClef({id:r,clef:_,f:A,fSuivre:I})}else{const A=async B=>{await E(B||[])},I=async({id:B,fSuivreBd:O})=>await this.suivreBdListe({id:B,f:O,schma:S,renvoyerValeur:!1});return await this.suivreBdDeClef({id:r,clef:_,f:A,fSuivre:I})}}async suivreBdListe({id:r,f:_,schma:E,renvoyerValeur:S=!0}){return await this.suivreBd({id:r,type:"set",schma:E,f:async C=>{const A=S?(await C.all()).map(I=>I.value):await C.all();await _(A)}})}async suivreTypeObjet({idObjet:r,f:_}){const E=async A=>{let I;const{type:B}=A;B?I=["motClef","variable","bd","projet","nue"].includes(B)?B:void 0:A.bds?I="projet":A.tableaux?I="bd":A.catgorie?I="variable":A.nom&&(I="motClef"),await _(I)},S={type:"object",properties:{type:{type:"string",nullable:!0}},additionalProperties:!0};return await this.suivreBdDic({id:r,schma:S,f:E})}async suivreEmpreinteTtesBdRcursive({idBd:r,f:_}){const E=async B=>{const O=await B.log.heads();return O[O.length-1]?.hash||""},S=B=>Base64.stringify(md5(B));return await suivreBdsDeFonctionListe({fListe:async B=>await this.suivreBdsRcursives({idBd:r,f:async O=>await B(O)}),f:async B=>{await _(S(B.sort().join()))},fBranche:async(B,O)=>await this.suivreBd({id:B,f:async N=>{const U=await E(N);await O(U)}})})}async suivreBdsDeBdListe({id:r,f:_,fBranche:E,fIdBdDeBranche:S=I=>I,fRduction:C=I=>[...new Set(I.flat())],fCode:A=I=>I}){return await suivreBdsDeFonctionListe({fListe:async B=>await this.suivreBdListe({id:r,f:B}),f:_,fBranche:E,fIdBdDeBranche:S,fRduction:C,fCode:A})}async suivreBdsDeBdDic({id:r,f:_,fBranche:E,fIdBdDeBranche:S=I=>I,fRduction:C=I=>[...new Set(I.flat())],fCode:A=I=>I}){return await suivreBdsDeFonctionListe({fListe:async B=>await this.suivreBd({id:r,f:async O=>await B((await O.all()).map(N=>N.value))}),f:_,fBranche:E,fIdBdDeBranche:S,fRduction:C,fCode:A})}async suivreBdsDeFonctionRecherche({fListe:r,f:_,fBranche:E,fIdBdDeBranche:S=I=>I,fRduction:C=I=>[...new Set(I.flat())],fCode:A=I=>I}){let I;const B=async U=>{I&&await I(U)};return{fOublier:await suivreBdsDeFonctionListe({fListe:async U=>{const{fOublier:j,fChangerProfondeur:z}=await r(U);return I=z,j},f:_,fBranche:E,fIdBdDeBranche:S,fRduction:C,fCode:A}),fChangerProfondeur:B}}async suivreBdSelonCondition({fRacine:r,fCondition:_,f:E}){const S=async({id:C,fSuivreBd:A})=>await _(C,async I=>{A(I?C:void 0)});return await suivreBdDeFonction({fRacine:async({fSuivreRacine:C})=>await r(C),f:ignorerNonDfinis(E),fSuivre:S})}async suivreBdsSelonCondition({fListe:r,fCondition:_,f:E}){return await suivreBdsDeFonctionListe({fListe:r,f:async A=>{const I=A.filter(B=>B.tat).map(B=>B.id);return await E(I)},fBranche:async(A,I)=>await _(A,async O=>await I({id:A,tat:O}))})}async obtFichierSFIP({id:r,max:_}){return await toBuffer$2(await this.obtItrableAsyncSFIP({id:r}),_)}async obtItrableAsyncSFIP({id:r}){const{sfip:_}=await this.attendreSfipEtOrbite(),E=unixfs(_),S=r.split("/")[0];return E.cat(CID.parse(S))}async ajouterSFIP({contenu:r,nomFichier:_}){const{sfip:E}=await this.attendreSfipEtOrbite();return(await unixfs(E).addFile({content:r})).toString()+"/"+_}obtClefStockageClient({clef:r,parCompte:_=!0}){return _?`${this.idCompte.slice(this.idCompte.length-23,this.idCompte.length-8)} : ${r}`:r}async obtDeStockageLocal({clef:r,parCompte:_=!0}){const E=this.obtClefStockageClient({clef:r,parCompte:_});return(await obtStockageLocal(await this.dossier())).getItem(E)}async sauvegarderAuStockageLocal({clef:r,val:_,parCompte:E=!0}){const S=this.obtClefStockageClient({clef:r,parCompte:E});return(await obtStockageLocal(await this.dossier())).setItem(S,_)}async effacerDeStockageLocal({clef:r,parCompte:_=!0}){const E=this.obtClefStockageClient({clef:r,parCompte:_});return(await obtStockageLocal(await this.dossier())).removeItem(E)}async obtIdBd({nom:r,racine:_,type:E}){const S={type:"object",properties:{[r]:{type:"string"}},additionalProperties:!0,required:[]},{bd:C,fOublier:A}=typeof _=="string"?await this.ouvrirBdType({id:_,type:"keyvalue",schma:S}):{bd:_,fOublier:faisRien},I=C.address+":"+r;await this.verrouObtIdBd.acquire(I);let B=await C.get(r);const O=await this.obtDeStockageLocal({clef:I});if(typeof B=="string"&&O&&B!==O)try{await this.combinerBds({idBdBase:B,idBd2:O}),await this.effacerBd({id:O}),await this.sauvegarderAuStockageLocal({clef:I,val:B})}catch{}if(typeof B=="string"&&E)try{const{fOublier:N}=await this.ouvrirBd({id:B,type:E});return await N(),this.verrouObtIdBd.release(I),B}catch{throw this.verrouObtIdBd.release(I),new Error("Bd n'existe pas: "+r+" "+B)}if(!B&&E){const N=C.access,{orbite:U}=await this.attendreSfipEtOrbite();if(await N.estAutoris(U.identity.id)){const z=await this.obtOpsAccs({idBd:C.address});if(B=await this.crerBdIndpendante({type:E,optionsAccs:z}),!B)throw new Error("Bd non gnre");await C.set(r,B)}}return typeof B=="string"&&await this.sauvegarderAuStockageLocal({clef:I,val:B}),A&&await A(),this.verrouObtIdBd.release(I),typeof B=="string"?B:void 0}async crerBdIndpendante({type:r,optionsAccs:_,nom:E}){const{orbite:S}=await this.attendreSfipEtOrbite();return _=_||await this.obtOptionsAccs(),await S.crerBdIndpendante({type:r,nom:E,options:{AccessController:ContrleurConstellation(_)}})}async effacerBd({id:r}){return await this.orbite?.effacerBd({id:r})}async obtOpsAccs({idBd:r}){const{bd:_,fOublier:E}=await this.ouvrirBd({id:r}),S=_.access;return await E(),{address:S.bd.address,write:S.write}}async suivrePermission({idObjet:r,f:_}){const{bd:E,fOublier:S}=await this.ouvrirBd({id:r}),C=E.access,A=C.type;if(A==="ipfs"){const I=await this.obtIdDispositif();return await _(C.write.includes(I)?MEMBRE:void 0),await S(),faisRien}else if(A===nomType){const I=async O=>{const N=O.filter(j=>j.idCompte===this.idCompte).map(j=>j.rle),U=N.includes(MODRATEUR)?MODRATEUR:N.includes(MEMBRE)?MEMBRE:void 0;await _(U)},B=await C.suivreUtilisateursAutoriss(I);return async()=>{await B(),await S()}}else throw new Error(`Type d'accs ${A} non reconnu.`)}async suivrePermissioncrire({id:r,f:_}){const E=async S=>{await _(S!==void 0)};return await this.suivrePermission({idObjet:r,f:E})}async suivreAccsBd({id:r,f:_}){const E=async S=>{const C=S.access,A=C.type;if(A==="ipfs"){const I=C.write.map(B=>({idCompte:B,rle:MODRATEUR}));await _(I)}else if(A===nomType)return await C.suivreUtilisateursAutoriss(_);return faisRien};return await this.suivreBd({id:r,f:E})}async suivreBdsRcursives({idBd:r,f:_}){const E={},S=async()=>{await _(Object.keys(E))},C=new s$1,A=async N=>{delete E[N],await Promise.all(Object.keys(E).map(async U=>{E[U]&&(E[U].requtes.delete(N),E[U].requtes.size||await E[U].fOublier())}))},I=["copiDe"],B=async(N,U)=>{const j=oe=>oe.map(ue=>typeof ue=="string"?[ue]:Array.isArray(ue)?ue:typeof ue=="object"?Object.values(ue):[]).flat().filter(ue=>isValidAddress(ue)),z=async oe=>{let ue=[];typeof oe=="object"?(ue=j(Object.entries(oe).filter(xe=>!I.includes(xe[0])).map(xe=>xe[1])),ue.push(...j(Object.keys(oe)))):Array.isArray(oe)?ue=j(oe):typeof oe=="string"&&(ue=[oe]);const we=ue.filter(xe=>!E[N].sousBds.includes(xe)),Te=E[N].sousBds.filter(xe=>!ue.includes(xe));E[N].sousBds=ue,await Promise.all(Te.map(async xe=>{E[xe]?.requtes.delete(N),E[xe]?.requtes.size||await E[xe]?.fOublier()})),await Promise.all(we.map(async xe=>await B(xe,N))),S()};if(await C.acquire(N),E[N]){E[N].requtes.add(U);return}const{bd:Z,fOublier:X}=await this.ouvrirBd({id:N}),{type:Q}=Z;await X(),E[N]={requtes:new Set([U]),sousBds:[],fOublier:async()=>{await se(),await A(N)}};let se;Q==="keyvalue"?se=await this.suivreBdDic({id:N,f:z}):Q==="ordered-keyvalue"?se=await this.suivreBdDicOrdonne({id:N,f:z}):Q==="set"?se=await this.suivreBdListe({id:N,f:z}):se=faisRien,C.release(N),S()};return await B(r,""),async()=>{await Promise.all(Object.values(E).map(N=>N.fOublier()))}}async fermerCompte(){this.rseau&&await this.rseau.fermer(),this.favoris&&await this.favoris.fermer(),this.automatisations&&await this.automatisations.fermer()}async fermer(){await this.attendreInitialise();const{orbite:r}=await this.attendreSfipEtOrbite();await(await obtStockageLocal(await this.dossier())).fermer?.(),await this.fermerCompte(),await this.pingles.fermer(),await r.fermer({arrterOrbite:!this._orbiteExterne}),this.sfip&&!this._sfipExterne&&await this.sfip.stop()}async effacerDispositif(){if(await this.fermer(),indexedDB)if(indexedDB.databases){const r=await indexedDB.databases();await Promise.all(r.map(_=>{_.name&&indexedDB.deleteDatabase(_.name)}))}else console.warn("On a pas pu tout effacer.");else{const r=await __vitePreload(()=>Promise.resolve().then(()=>__viteBrowserExternal),void 0);(await obtStockageLocal(await this.dossier())).clear(),r.rmdirSync(await this.dossier())}}async exporterDispositif({nomFichier:r}){if(isNode||isElectronMain){const _=await __vitePreload(()=>Promise.resolve().then(()=>__viteBrowserExternal),void 0),E=await __vitePreload(()=>Promise.resolve().then(()=>path$1),void 0),S=({dossier:A,zip:I})=>{_.readdirSync(A).map(O=>{if(_.statSync(O)?.isDirectory())S({dossier:E.join(A,O),zip:I.folder(O)});else{const U=_.createReadStream(E.join(A,O));I.file(O,U)}})},C=new JSZip;S({dossier:await this.dossier(),zip:C}),await sauvegarderFichierZip({fichierZip:C,nomFichier:r})}else if(indexedDB){const _=({bd:S,zip:C})=>{const{name:A}=S;if(A){const I=C.folder(A);if(!I)throw new Error(A);const O=indexedDB.open(A).result.objectStoreNames;[...Array(O.length).keys()].map(U=>O.item(U)).filter(U=>!!U).map(U=>I.file(U,new indexedDbStream.IndexedDbReadStream({databaseName:A,objectStoreName:U})))}},E=new JSZip;if(indexedDB.databases){const S=await indexedDB.databases(),C=E.folder("bdIndexe");if(!C)throw new Error("Erreur Bd Indexe...");S.forEach(A=>{_({bd:A,zip:C})}),E.file("stockageLocal",JSON.stringify(await exporterStockageLocal(await this.dossier())))}await sauvegarderFichierZip({fichierZip:E,nomFichier:r})}else throw new Error("Sauvegarde non implmente.")}async rtablirDispositif(){throw await this.effacerDispositif(),isNode||isElectronMain?new Error("Non implment"):new Error("Non implment")}static async crer(r={}){const _=new ClientConstellation(r);return await _._initialiser(),_}}__decorate([cacheSuivi],ClientConstellation.prototype,"suivreDispositifs",null);__decorate([cacheSuivi],ClientConstellation.prototype,"suivreIdCompte",null);__decorate([cacheSuivi],ClientConstellation.prototype,"suivreEmpreinteTtesBdRcursive",null);__decorate([cacheSuivi],ClientConstellation.prototype,"suivrePermission",null);__decorate([cacheSuivi],ClientConstellation.prototype,"suivrePermissioncrire",null);__decorate([cacheSuivi],ClientConstellation.prototype,"suivreAccsBd",null);__decorate([cacheSuivi],ClientConstellation.prototype,"suivreBdsRcursives",null);class GestionnaireClient{ipa;_messagesEnAttente;prt;dicFRetourSuivi;opts;fMessage;fErreur;_verrou;constructor(r,_,E={}){this.fMessage=r,this.fErreur=_,this.opts=E instanceof ClientConstellation?{}:E,E instanceof ClientConstellation&&(this.ipa=E),this.dicFRetourSuivi={},this.prt=!1,this._messagesEnAttente=[],this._verrou=new s$1,this.init()}async init(){if(await this._verrou.acquire("init"),this.ipa){this._verrou.release("init");return}this.ipa=await ClientConstellation.crer(this.opts),this._messagesEnAttente.forEach(r=>this._grerMessage(r)),this.prt=!0,this._verrou.release("init")}async grerMessage(r){this.prt?await this._grerMessage(r):this._messagesEnAttente.unshift(r)}async _grerMessage(r){const{type:_}=r;switch(_){case"suivre":{const{id:E,fonction:S,args:C,nomArgFonction:A}=r;this.ipa||this.fErreur("IPA non initialis",E);const I=this.extraireFonctionIPA(S,E);if(!I)return;const B=O=>{const N={type:"suivre",id:E,donnes:O};this.fMessage(N)};C[A]=B;try{const O=await I(C),N=typeof O=="function"?{fOublier:O}:O;this.dicFRetourSuivi[E]=N;const U={type:"suivrePrt",id:E};typeof O!="function"&&(U.fonctions=Object.keys(O)),this.fMessage(U)}catch(O){this.fErreur(O.toString()+O.stack.toString(),E)}break}case"action":{const{id:E,fonction:S,args:C}=r;this.ipa||this.fErreur("IPA non initialis",E);const A=this.extraireFonctionIPA(S,E);if(!A)return;try{const I=await A(C),B={type:"action",id:E,rsultat:I};this.fMessage(B)}catch(I){this.fErreur(I.toString()+I.stack.toString(),E)}break}case"retour":{const{id:E,fonction:S,args:C}=r,A=this.dicFRetourSuivi[E];A&&await A[S](C),S==="fOublier"&&delete this.dicFRetourSuivi[E];break}default:{this.fErreur(`Type de requte ${_} non reconnu dans message ${r}`,r.id);break}}}extraireFonctionIPA(r,_){const E=`Fonction ClientConstellation.${r.join(".")} n'existe pas ou n'est pas une fonction.`;let S=this.ipa;for(const[C,A]of r.entries()){if(C===r.length-1)if(typeof S=="object"&&A in S&&S[A])S=S[A].bind(S);else{this.fErreur(E,_);return}else if(typeof S=="object"&&A in S&&S[A])S=S[A];else{this.fErreur(E,_);return}if(!S){this.fErreur(E,_);return}}if(typeof S!="function"){this.fErreur(E,_);return}return S}async fermer(){await this.init(),await this.ipa.fermer()}}class MandataireClientProc extends ClientMandatairifiable{client;constructor(r={}){super(),this.client=new GestionnaireClient(_=>{this.vnements.emit("message",_)},(_,E)=>{const S={type:"erreur",id:E,erreur:_};this.vnements.emit("message",S)},r)}envoyerMessage(r){this.client.grerMessage(r)}}const gnrerMandataireProc=(n={})=>gnrerMandataire(new MandataireClientProc(n)),constellation={install:n=>{const r=gnrerMandataireProc();n.config.globalProperties.$constl=r,n.provide("constl",r)}},en={accueil:{titre:"SC6.8: Using distributed databases in your citizen science research",changerLangue:"Change language"},obtConstellation:{titre:"Get Constellation",options:{tlcharger:"Download",navig:"Browser app",docu:"Read docs",codeSource:"Source code"}},donnes:{titre:"Download sample data",tlcharger:"Download data",lienDynamique:"Copy link",crdits:"Data source:"},dmo:{titre:"Live demo!",sousTitre:"You are now a citizen scientist",choisirStation:"Choose a station on the map, or else take a picture",plusDePhotos:"No more photos to analyse",effacerDonnes:"Clear my data",indicePrcip:"Input rainfall (mm)",indiceTlcharger:"Download data",nouvellePhoto:"New photo",soumettre:"Submit",numroInvalid:"Invalid number",graphique:{aucuneDonne:"No data yet"},source:"Data from SmartPhones4Water.",merci:"Thank you!"},code:{titre:"Dynamic data access",options:{appli:"Access in app",python:"Python Code",r:"R Code",julia:"Julia Code"},conclusion:"The Constellation team hopes to hear from you!",contact:"julien.malard@mail.mcgill.ca"}},messages={en,:{accueil:{titre:"  .:     ",changerLangue:" "},obtConstellation:{titre:" ",options:{tlcharger:" ",navig:" ",docu:" ",codeSource:" "}},donnes:{titre:"  ",tlcharger:" ",lienDynamique:" ",crdits:" :"},dmo:{titre:" ",sousTitre:"    !",choisirStation:"    ,     ",plusDePhotos:"      ",effacerDonnes:"  ",indicePrcip:"  (. .)",indiceTlcharger:"",nouvellePhoto:" ",soumettre:"",numroInvalid:" ",graphique:{aucuneDonne:"   "},source:"     .",merci:"!"},code:{titre:"  ",options:{appli:" ",python:" ",r:" ",julia:" "},conclusion:"      ",contact:"julien.malard@mail.mcgill.ca"}}},kilimukku=_({:"en",_:"en",_:messages});function registerPlugins(n){n.use(vuetify),n.use(routeur),n.use(constellation),n.use(kilimukku)}const _sfc_main$1=defineComponent$1({__name:"BtnMenuLangues",setup(n){const{isRtl:r}=useRtl();return(_,E)=>(openBlock(),createBlock(VBtn,{style:normalizeStyle(["position: absolute;"+(unref(r)?"left:":"right:")+"20px; top: 20px",{"z-index":"100"}]),icon:"mdi-earth",size:"small"},{default:withCtx(()=>[createVNode(VIcon,{size:"large"}),createVNode(_sfc_main$d)]),_:1},8,["style"]))}}),makeVAppProps=propsFactory({...makeComponentProps(),...makeLayoutProps({fullHeight:!0}),...makeThemeProps()},"VApp"),VApp=genericComponent()({name:"VApp",props:makeVAppProps(),setup(n,r){let{slots:_}=r;const E=provideTheme(n),{layoutClasses:S,getLayoutItem:C,items:A,layoutRef:I}=createLayout(n),{rtlClasses:B}=useRtl();return useRender(()=>createVNode("div",{ref:I,class:["v-application",E.themeClasses.value,S.value,B.value,n.class],style:[n.style]},[createVNode("div",{class:"v-application__wrap"},[_.default?.()])])),{getLayoutItem:C,items:A,theme:E}}}),makeVLocaleProviderProps=propsFactory({locale:String,fallbackLocale:String,messages:Object,rtl:{type:Boolean,default:void 0},...makeComponentProps()},"VLocaleProvider"),VLocaleProvider=genericComponent()({name:"VLocaleProvider",props:makeVLocaleProviderProps(),setup(n,r){let{slots:_}=r;const{rtlClasses:E}=provideLocale(n);return useRender(()=>createVNode("div",{class:["v-locale-provider",E.value,n.class],style:n.style},[_.default?.()])),{}}}),makeVMainProps=propsFactory({scrollable:Boolean,...makeComponentProps(),...makeTagProps({tag:"main"})},"VMain"),VMain=genericComponent()({name:"VMain",props:makeVMainProps(),setup(n,r){let{slots:_}=r;const{mainStyles:E}=useLayout(),{ssrBootStyles:S}=useSsrBoot();return useRender(()=>createVNode(n.tag,{class:["v-main",{"v-main--scrollable":n.scrollable},n.class],style:[E.value,S.value,n.style]},{default:()=>[n.scrollable?createVNode("div",{class:"v-main__scroller"},[_.default?.()]):_.default?.()]})),{}}}),_sfc_main=defineComponent$1({__name:"App",setup(n){const{__:r}=_(),_=r();return(E,S)=>{const C=_sfc_main$1,A=resolveComponent("router-view");return openBlock(),createBlock(VApp,null,{default:withCtx(()=>[createVNode(VLocaleProvider,{rtl:unref(_)},{default:withCtx(()=>[createVNode(VMain,null,{default:withCtx(()=>[createVNode(C),createVNode(A,null,{default:withCtx(({Component:I})=>[createVNode(Transition$1,{name:"fade"},{default:withCtx(()=>[(openBlock(),createBlock(resolveDynamicComponent(I)))]),_:2},1024)]),_:1})]),_:1})]),_:1},8,["rtl"])]),_:1})}}}),app=createApp(_sfc_main);registerPlugins(app);app.mount("#app");export{AbortError$5 as A,Buffer$4 as B,CodeError$4 as C,TypedEventEmitter as T,_debug as _,commonjsGlobal as a,global$1 as b,crypto$3 as c,browser$1$1 as d,requireCryptoBrowserify as e,getDefaultExportFromCjs as f,getAugmentedNamespace as g,isIPv6 as h,isIPv4 as i,path as j,TCP$1 as k,buffer$2 as l,multiaddr as m,net as n,eventsExports as o,path$1 as p,peerIdFromString$1 as q,require$$1$2 as r,getProtocol as s,transportSymbol as t,isPrivate as u,peerDiscoverySymbol as v,CustomEvent$1 as w};
